var Us=Object.defineProperty;var Vs=(T,n,a)=>n in T?Us(T,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):T[n]=a;var Gt=(T,n,a)=>Vs(T,typeof n!="symbol"?n+"":n,a);import{s as $s,u as qs,a as Mn,r as ae,b as Ws,t as lr,g as Ys,o as Ks,c as hi,w as ot,d as ta,e as Gs,f as Zs,h as ye,i as je,j as tn,k as Xs,l as Js,m as Ia,n as Ne,p as jn,q as rt,v as Ui,x as xn,y as Qs,z as on,A as St,B as jt,C as wi,D as pe,E as ue,F as Bt,G as qe,H as $,I as ce,J as Na,_ as _t,K as tt,L as _n,M as el,N as cr,O as tl,P as Zt,Q as na,R as _e,S as nl,T as Vi,U as Je,V as pt,W as Lt,X as Wt,Y as sn,Z as $i,$ as Ei,a0 as Un,a1 as ja,a2 as hr,a3 as il,a4 as pi,a5 as rl,a6 as qi,a7 as al,a8 as ol,a9 as ia,aa as ra,ab as sl}from"./Dp-Aei3E.js";import{_ as pr,a as Ba,b as ll,c as cl,d as ul,N as dl}from"./BhyYl5Xx.js";const fl=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],hl=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],pl="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Xt=[];let ml=class{constructor(){Gt(this,"_data",new ei);Gt(this,"_hash",new ei([...fl]));Gt(this,"_nDataBytes",0);Gt(this,"_minBufferSize",0)}finalize(n){n&&this._append(n);const a=this._nDataBytes*8,s=this._data.sigBytes*8;return this._data.words[s>>>5]|=128<<24-s%32,this._data.words[(s+64>>>9<<4)+14]=Math.floor(a/4294967296),this._data.words[(s+64>>>9<<4)+15]=a,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(n,a){const s=this._hash.words;let c=s[0],f=s[1],m=s[2],h=s[3],y=s[4],C=s[5],S=s[6],d=s[7];for(let u=0;u<64;u++){if(u<16)Xt[u]=n[a+u]|0;else{const x=Xt[u-15],A=(x<<25|x>>>7)^(x<<14|x>>>18)^x>>>3,v=Xt[u-2],O=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;Xt[u]=A+Xt[u-7]+O+Xt[u-16]}const p=y&C^~y&S,g=c&f^c&m^f&m,E=(c<<30|c>>>2)^(c<<19|c>>>13)^(c<<10|c>>>22),b=(y<<26|y>>>6)^(y<<21|y>>>11)^(y<<7|y>>>25),k=d+b+p+hl[u]+Xt[u],M=E+g;d=S,S=C,C=y,y=h+k|0,h=m,m=f,f=c,c=k+M|0}s[0]=s[0]+c|0,s[1]=s[1]+f|0,s[2]=s[2]+m|0,s[3]=s[3]+h|0,s[4]=s[4]+y|0,s[5]=s[5]+C|0,s[6]=s[6]+S|0,s[7]=s[7]+d|0}_append(n){typeof n=="string"&&(n=ei.fromUtf8(n)),this._data.concat(n),this._nDataBytes+=n.sigBytes}_process(n){let a,s=this._data.sigBytes/64;n?s=Math.ceil(s):s=Math.max((s|0)-this._minBufferSize,0);const c=s*16,f=Math.min(c*4,this._data.sigBytes);if(c){for(let m=0;m<c;m+=16)this._doProcessBlock(this._data.words,m);a=this._data.words.splice(0,c),this._data.sigBytes-=f}return new ei(a,f)}},ei=class za{constructor(n,a){Gt(this,"words");Gt(this,"sigBytes");n=this.words=n||[],this.sigBytes=a===void 0?n.length*4:a}static fromUtf8(n){const a=unescape(encodeURIComponent(n)),s=a.length,c=[];for(let f=0;f<s;f++)c[f>>>2]|=(a.charCodeAt(f)&255)<<24-f%4*8;return new za(c,s)}toBase64(){const n=[];for(let a=0;a<this.sigBytes;a+=3){const s=this.words[a>>>2]>>>24-a%4*8&255,c=this.words[a+1>>>2]>>>24-(a+1)%4*8&255,f=this.words[a+2>>>2]>>>24-(a+2)%4*8&255,m=s<<16|c<<8|f;for(let h=0;h<4&&a*8+h*6<this.sigBytes*8;h++)n.push(pl.charAt(m>>>6*(3-h)&63))}return n.join("")}concat(n){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let a=0;a<n.sigBytes;a++){const s=n.words[a>>>2]>>>24-a%4*8&255;this.words[this.sigBytes+a>>>2]|=s<<24-(this.sigBytes+a)%4*8}else for(let a=0;a<n.sigBytes;a+=4)this.words[this.sigBytes+a>>>2]=n.words[a>>>2];this.sigBytes+=n.sigBytes}};function gl(T){return new ml().finalize(T).toBase64()}function vl(T){return gl($s(T))}const bl=T=>T==="defer"||T===!1;function yl(...T){var E;const n=typeof T[T.length-1]=="string"?T.pop():void 0;typeof T[0]!="string"&&T.unshift(n);let[a,s,c={}]=T;if(typeof a!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof s!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const f=qs(),m=s,h=()=>Mn.value,y=()=>f.isHydrating?f.payload.data[a]:f.static.data[a];c.server??(c.server=!0),c.default??(c.default=h),c.getCachedData??(c.getCachedData=y),c.lazy??(c.lazy=!1),c.immediate??(c.immediate=!0),c.deep??(c.deep=Mn.deep),c.dedupe??(c.dedupe="cancel");const C=c.getCachedData(a,f),S=C!=null;if(!f._asyncData[a]||!c.immediate){(E=f.payload._errors)[a]??(E[a]=Mn.errorValue);const b=c.deep?ae:Ws;f._asyncData[a]={data:b(S?C:c.default()),pending:ae(!S),error:lr(f.payload._errors,a),status:ae("idle"),_default:c.default}}const d={...f._asyncData[a]};delete d._default,d.refresh=d.execute=(b={})=>{if(f._asyncDataPromises[a]){if(bl(b.dedupe??c.dedupe))return f._asyncDataPromises[a];f._asyncDataPromises[a].cancelled=!0}if(b._initial||f.isHydrating&&b._initial!==!1){const M=b._initial?C:c.getCachedData(a,f);if(M!=null)return Promise.resolve(M)}d.pending.value=!0,d.status.value="pending";const k=new Promise((M,x)=>{try{M(m(f))}catch(A){x(A)}}).then(async M=>{if(k.cancelled)return f._asyncDataPromises[a];let x=M;c.transform&&(x=await c.transform(M)),c.pick&&(x=El(x,c.pick)),f.payload.data[a]=x,d.data.value=x,d.error.value=Mn.errorValue,d.status.value="success"}).catch(M=>{if(k.cancelled)return f._asyncDataPromises[a];d.error.value=Zs(M),d.data.value=ye(c.default()),d.status.value="error"}).finally(()=>{k.cancelled||(d.pending.value=!1,delete f._asyncDataPromises[a])});return f._asyncDataPromises[a]=k,f._asyncDataPromises[a]},d.clear=()=>wl(f,a);const u=()=>d.refresh({_initial:!0}),p=c.server!==!1&&f.payload.serverRendered;{const b=Ys();if(b&&p&&c.immediate&&!b.sp&&(b.sp=[]),b&&!b._nuxtOnBeforeMountCbs){b._nuxtOnBeforeMountCbs=[];const x=b._nuxtOnBeforeMountCbs;Ks(()=>{x.forEach(A=>{A()}),x.splice(0,x.length)}),hi(()=>x.splice(0,x.length))}p&&f.isHydrating&&(d.error.value||C!=null)?(d.pending.value=!1,d.status.value=d.error.value?"error":"success"):b&&(f.payload.serverRendered&&f.isHydrating||c.lazy)&&c.immediate?b._nuxtOnBeforeMountCbs.push(u):c.immediate&&u();const k=Gs();if(c.watch){const x=ot(c.watch,()=>d.refresh());k&&ta(x)}const M=f.hook("app:data:refresh",async x=>{(!x||x.includes(a))&&await d.refresh()});k&&ta(M)}const g=Promise.resolve(f._asyncDataPromises[a]).then(()=>d);return Object.assign(g,d),g}function wl(T,n){n in T.payload.data&&(T.payload.data[n]=void 0),n in T.payload._errors&&(T.payload._errors[n]=Mn.errorValue),T._asyncData[n]&&(T._asyncData[n].data.value=void 0,T._asyncData[n].error.value=Mn.errorValue,T._asyncData[n].pending.value=!1,T._asyncData[n].status.value="idle"),n in T._asyncDataPromises&&(T._asyncDataPromises[n]&&(T._asyncDataPromises[n].cancelled=!0),T._asyncDataPromises[n]=void 0)}function El(T,n){const a={};for(const s of n)a[s]=T[s];return a}function Sl(T,n,a){const[s={},c]=typeof n=="string"?[{},n]:[n,a],f=je(()=>tn(T)),m=s.key||vl([c,typeof f.value=="string"?f.value:"",...Cl(s)]);if(!m||typeof m!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+m);const h=m===c?"$f"+m:m;if(!s.baseURL&&typeof f.value=="string"&&f.value[0]==="/"&&f.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:y,lazy:C,default:S,transform:d,pick:u,watch:p,immediate:g,getCachedData:E,deep:b,dedupe:k,...M}=s,x=Xs({...Js,...M,cache:typeof s.cache=="boolean"?void 0:s.cache}),A={server:y,lazy:C,default:S,transform:d,pick:u,immediate:g,getCachedData:E,deep:b,dedupe:k,watch:p===!1?[]:[x,f,...p||[]]};let v;return yl(h,()=>{var B;(B=v==null?void 0:v.abort)==null||B.call(v,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),v=typeof AbortController<"u"?new AbortController:{};const I=tn(s.timeout);let R;return I&&(R=setTimeout(()=>v.abort(new DOMException("Request aborted due to timeout.","AbortError")),I),v.signal.onabort=()=>clearTimeout(R)),(s.$fetch||globalThis.$fetch)(f.value,{signal:v.signal,...x}).finally(()=>{clearTimeout(R)})},A)}function Cl(T){var a;const n=[((a=tn(T.method))==null?void 0:a.toUpperCase())||"GET",tn(T.baseURL)];for(const s of[T.params||T.query]){const c=tn(s);if(!c)continue;const f={};for(const[m,h]of Object.entries(c))f[tn(m)]=tn(h);n.push(f)}return n}const Tl={wrapper:"w-full flex flex-col gap-2",indicator:{container:{base:"flex flex-row justify-end",width:"min-w-fit",transition:"transition-all"},align:"text-end",width:"w-fit",color:"text-gray-400 dark:text-gray-500",size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base","2xl":"text-base"}},progress:{base:"block appearance-none border-none overflow-hidden",width:"w-full [&::-webkit-progress-bar]:w-full",size:{"2xs":"h-px",xs:"h-0.5",sm:"h-1",md:"h-2",lg:"h-3",xl:"h-4","2xl":"h-5"},rounded:"rounded-full [&::-webkit-progress-bar]:rounded-full",track:"[&::-webkit-progress-bar]:bg-gray-200 [&::-webkit-progress-bar]:dark:bg-gray-700 [@supports(selector(&::-moz-progress-bar))]:bg-gray-200 [@supports(selector(&::-moz-progress-bar))]:dark:bg-gray-700",bar:"[&::-webkit-progress-value]:rounded-full [&::-webkit-progress-value]:transition-all [&::-webkit-progress-value]:ease-in-out [&::-moz-progress-bar]:rounded-full",color:"text-{color}-500 dark:text-{color}-400",background:"[&::-webkit-progress-value]:bg-current [&::-moz-progress-bar]:bg-current",indeterminate:{base:"indeterminate:relative",rounded:"indeterminate:after:rounded-full [&:indeterminate::-webkit-progress-value]:rounded-full [&:indeterminate::-moz-progress-bar]:rounded-full"}},steps:{base:"grid grid-cols-1",color:"text-{color}-500 dark:text-{color}-400",size:{"2xs":"text-xs",xs:"text-xs",sm:"text-sm",md:"text-sm",lg:"text-sm",xl:"text-base","2xl":"text-base"}},step:{base:"transition-all opacity-0 truncate row-start-1 col-start-1",align:"text-end",active:"opacity-100",first:"text-gray-500 dark:text-gray-400"},animation:{carousel:"bar-animation-carousel","carousel-inverse":"bar-animation-carousel-inverse",swing:"bar-animation-swing",elastic:"bar-animation-elastic"},default:{color:"primary",size:"md",animation:"carousel"}},Fa=Ia("messageStore",()=>{const T=ae([]),n=ae(0),a=ae(!0),s=ae(1),c=ae(15),f=Ne(),m=ae(!1),h=ae(null),y=ae([]),C=ae([]),S=ae(null);return{messages:T,total:n,hasMore:a,page:s,pageSize:c,loading:m,siteConfig:h,reset:()=>{T.value=[],n.value=0,a.value=!0,s.value=1,m.value=!1},getMessages:async R=>{if(!m.value){m.value=!0;try{const P=await xn("messages/page",R,{credentials:"include"});if(!P)return f.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const B=P.data.items.filter(W=>!T.value.some(G=>G.id===W.id));return R.page===1?T.value=P.data.items:T.value=[...T.value,...B],n.value=P.data.total,s.value=R.page,c.value=R.pageSize,a.value=T.value.length<n.value,P.data}catch(P){console.error("获取笔记列表失败:",P),f.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3})}finally{m.value=!1}}},deleteMessage:async R=>{try{const P=await Qs(`messages/${R}`,{credentials:"include"});return!P||P.code!==1?(f.add({title:"删除笔记失败",description:P==null?void 0:P.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(T.value=T.value.filter(B=>B.id!==R),n.value-=1,P)}catch(P){throw console.error("删除笔记失败:",P),P}},updateMessage:async(R,P)=>{try{const B=await Ui(`messages/${R}`,{content:P},{credentials:"include"});if(!B||B.code!==1)return f.add({title:"更新笔记失败",description:B==null?void 0:B.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const W=T.value.findIndex(G=>G.id===R);return W!==-1&&(T.value[W]=B.data),B}catch(B){throw console.error("更新笔记失败:",B),B}},getSiteConfig:async()=>{try{const R=await jn("site/config",{credentials:"include"});return!R||R.code!==1?(f.add({title:"获取网站配置失败",description:(R==null?void 0:R.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(h.value=R.data,rt(),R.data)}catch(R){throw console.error("获取网站配置失败:",R),R}},updateSiteConfig:async(R,P)=>{try{const B=await Ui("site/config",{[R]:P},{credentials:"include"});return!B||B.code!==1?(f.add({title:"更新配置失败",description:B==null?void 0:B.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(h.value={...h.value,[R]:P},B.data)}catch(B){throw console.error("更新配置失败:",B),B}},tags:y,images:C,getAllTags:async()=>{try{const R=await jn("messages/tags",{credentials:"include"});return!R||R.code!==1?(f.add({title:"获取标签列表失败",description:(R==null?void 0:R.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(y.value=R.data,R.data)}catch(R){throw console.error("获取标签列表失败:",R),R}},getMessagesByTag:async R=>{try{const P=await jn(`messages/tags/${encodeURIComponent(R)}`,{credentials:"include"});return!P||P.code!==1?(f.add({title:"获取标签消息失败",description:(P==null?void 0:P.msg)||"请稍后重试",color:"red",timeout:2e3}),null):P.data}catch(P){throw console.error("获取标签消息失败:",P),P}},getAllImages:async()=>{try{const R=await jn("messages/images",{credentials:"include"});return!R||R.code!==1?(f.add({title:"获取图片列表失败",description:(R==null?void 0:R.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(C.value=R.data,R.data)}catch(R){throw console.error("获取图片列表失败:",R),R}},notifyConfig:S,getNotifyConfig:async()=>{try{const R=await jn("notify/config",{credentials:"include"});return!R||R.code!==1?(f.add({title:"获取推送配置失败",description:(R==null?void 0:R.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(S.value=R.data,R.data)}catch(R){throw console.error("获取推送配置失败:",R),R}},updateNotifyConfig:async R=>{try{const P=await Ui("notify/config",R,{credentials:"include"});return!P||P.code!==1?(f.add({title:"更新推送配置失败",description:(P==null?void 0:P.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(S.value=P.data,P.data)}catch(P){throw console.error("更新推送配置失败:",P),P}},testNotify:async R=>{try{const P=await xn(`notify/test?type=${R}`,{},{credentials:"include"});if(!P||P.code!==1)throw new Error((P==null?void 0:P.msg)||"测试失败");return P.data}catch(P){throw console.error("推送测试失败:",P),P}},createMessage:async R=>{try{const P=await xn("messages",R,{credentials:"include"});if(!P||P.code!==1)throw new Error((P==null?void 0:P.msg)||"创建消息失败");if(R.notify)try{const B=on().public.baseApi,W={content:R.content,images:R.image_url?[`${B}${R.image_url}`].filter(Boolean):[],format:"markdown"},G=await xn("notify/send",W,{credentials:"include"});(!G||G.code!==1)&&console.warn("推送失败:",G==null?void 0:G.msg)}catch(B){console.error("消息推送失败:",B)}return f.add({title:"成功",description:"发布成功",color:"green",timeout:2e3}),P.data}catch(P){throw console.error("创建消息失败:",P),P}}}}),Ua=()=>{const T=Fa(),n=Ne();return{save:async f=>{try{const m=await xn("messages",f);if(!m||m.code!==1)return console.log(m==null?void 0:m.code),n.add({title:"添加失败",description:String(m==null?void 0:m.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const h=m.data;return T.messages.unshift(h),n.add({title:"保存成功",description:"消息已保存",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),m.data}catch(m){console.error(m)}},uploadImage:async f=>{try{const m=new FormData;m.append("image",f);const h=await xn("images/upload",m);return!h||h.code!==1?(console.log(h==null?void 0:h.code),n.add({title:"上传失败",description:String(h==null?void 0:h.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):h.data}catch(m){return console.error("上传图片错误:",m),null}},deleteMessage:async f=>{try{const m=await T.deleteMessage(f);if(m&&m.code===1)return n.add({title:"删除成功",description:"笔记已删除",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),!0}catch(m){console.error(m)}}}},ie=(T,n=1e4)=>(T=parseFloat(T+"")||0,Math.round((T+Number.EPSILON)*n)/n),ur=function(T){if(!(T&&T instanceof Element&&T.offsetParent))return!1;const n=T.scrollHeight>T.clientHeight,a=window.getComputedStyle(T).overflowY,s=a.indexOf("hidden")!==-1,c=a.indexOf("visible")!==-1;return n&&!s&&!c},gi=function(T,n=void 0){return!(!T||T===document.body||n&&T===n)&&(ur(T)?T:gi(T.parentElement,n))},At=function(T){var n=new DOMParser().parseFromString(T,"text/html").body;if(n.childElementCount>1){for(var a=document.createElement("div");n.firstChild;)a.appendChild(n.firstChild);return a}return n.firstChild},mr=T=>`${T||""}`.split(" ").filter(n=>!!n),Dt=(T,n,a)=>{T&&mr(n).forEach(s=>{T.classList.toggle(s,a||!1)})};class yn{constructor(n){Object.defineProperty(this,"pageX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nativePointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nativePointer=n,this.pageX=n.pageX,this.pageY=n.pageY,this.clientX=n.clientX,this.clientY=n.clientY,this.id=self.Touch&&n instanceof Touch?n.identifier:-1,this.time=Date.now()}}const wn={passive:!1};class kl{constructor(n,{start:a=()=>!0,move:s=()=>{},end:c=()=>{}}){Object.defineProperty(this,"element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"startPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.element=n,this.startCallback=a,this.moveCallback=s,this.endCallback=c;for(const f of["onPointerStart","onTouchStart","onMove","onTouchEnd","onPointerEnd","onWindowBlur"])this[f]=this[f].bind(this);this.element.addEventListener("mousedown",this.onPointerStart,wn),this.element.addEventListener("touchstart",this.onTouchStart,wn),this.element.addEventListener("touchmove",this.onMove,wn),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchcancel",this.onTouchEnd)}onPointerStart(n){if(!n.buttons||n.button!==0)return;const a=new yn(n);this.currentPointers.some(s=>s.id===a.id)||this.triggerPointerStart(a,n)&&(window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onPointerEnd),window.addEventListener("blur",this.onWindowBlur))}onTouchStart(n){for(const a of Array.from(n.changedTouches||[]))this.triggerPointerStart(new yn(a),n);window.addEventListener("blur",this.onWindowBlur)}onMove(n){const a=this.currentPointers.slice(),s="changedTouches"in n?Array.from(n.changedTouches||[]).map(f=>new yn(f)):[new yn(n)],c=[];for(const f of s){const m=this.currentPointers.findIndex(h=>h.id===f.id);m<0||(c.push(f),this.currentPointers[m]=f)}c.length&&this.moveCallback(n,this.currentPointers.slice(),a)}onPointerEnd(n){n.buttons>0&&n.button!==0||(this.triggerPointerEnd(n,new yn(n)),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur))}onTouchEnd(n){for(const a of Array.from(n.changedTouches||[]))this.triggerPointerEnd(n,new yn(a))}triggerPointerStart(n,a){return!!this.startCallback(a,n,this.currentPointers.slice())&&(this.currentPointers.push(n),this.startPointers.push(n),!0)}triggerPointerEnd(n,a){const s=this.currentPointers.findIndex(c=>c.id===a.id);s<0||(this.currentPointers.splice(s,1),this.startPointers.splice(s,1),this.endCallback(n,a,this.currentPointers.slice()))}onWindowBlur(){this.clear()}clear(){for(;this.currentPointers.length;){const n=this.currentPointers[this.currentPointers.length-1];this.currentPointers.splice(this.currentPointers.length-1,1),this.startPointers.splice(this.currentPointers.length-1,1),this.endCallback(new Event("touchend",{bubbles:!0,cancelable:!0,clientX:n.clientX,clientY:n.clientY}),n,this.currentPointers.slice())}}stop(){this.element.removeEventListener("mousedown",this.onPointerStart,wn),this.element.removeEventListener("touchstart",this.onTouchStart,wn),this.element.removeEventListener("touchmove",this.onMove,wn),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchcancel",this.onTouchEnd),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur)}}function aa(T,n){return n?Math.sqrt(Math.pow(n.clientX-T.clientX,2)+Math.pow(n.clientY-T.clientY,2)):0}function oa(T,n){return n?{clientX:(T.clientX+n.clientX)/2,clientY:(T.clientY+n.clientY)/2}:T}const dr=T=>typeof T=="object"&&T!==null&&T.constructor===Object&&Object.prototype.toString.call(T)==="[object Object]",ft=(T,...n)=>{const a=n.length;for(let s=0;s<a;s++){const c=n[s]||{};Object.entries(c).forEach(([f,m])=>{const h=Array.isArray(m)?[]:{};T[f]||Object.assign(T,{[f]:h}),dr(m)?Object.assign(T[f],ft(h,m)):Array.isArray(m)?Object.assign(T,{[f]:[...m]}):Object.assign(T,{[f]:m})})}return T},Wi=function(T,n){return T.split(".").reduce((a,s)=>typeof a=="object"?a[s]:void 0,n)};class vi{constructor(n={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(n);for(const a of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))a.startsWith("on")&&typeof this[a]=="function"&&(this[a]=this[a].bind(this))}setOptions(n){this.options=n?ft({},this.constructor.defaults,n):{};for(const[a,s]of Object.entries(this.option("on")||{}))this.on(a,s)}option(n,...a){let s=Wi(n,this.options);return s&&typeof s=="function"&&(s=s.call(this,this,...a)),s}optionFor(n,a,s,...c){let f=Wi(a,n);var m;typeof(m=f)!="string"||isNaN(m)||isNaN(parseFloat(m))||(f=parseFloat(f)),f==="true"&&(f=!0),f==="false"&&(f=!1),f&&typeof f=="function"&&(f=f.call(this,this,n,...c));let h=Wi(a,this.options);return h&&typeof h=="function"?f=h.call(this,this,n,...c,f):f===void 0&&(f=h),f===void 0?s:f}cn(n){const a=this.options.classes;return a&&a[n]||""}localize(n,a=[]){n=String(n).replace(/\{\{(\w+).?(\w+)?\}\}/g,(s,c,f)=>{let m="";return f?m=this.option(`${c[0]+c.toLowerCase().substring(1)}.l10n.${f}`):c&&(m=this.option(`l10n.${c}`)),m||(m=s),m});for(let s=0;s<a.length;s++)n=n.split(a[s][0]).join(a[s][1]);return n=n.replace(/\{\{(.*?)\}\}/g,(s,c)=>c)}on(n,a){let s=[];typeof n=="string"?s=n.split(" "):Array.isArray(n)&&(s=n),this.events||(this.events=new Map),s.forEach(c=>{let f=this.events.get(c);f||(this.events.set(c,[]),f=[]),f.includes(a)||f.push(a),this.events.set(c,f)})}off(n,a){let s=[];typeof n=="string"?s=n.split(" "):Array.isArray(n)&&(s=n),s.forEach(c=>{const f=this.events.get(c);if(Array.isArray(f)){const m=f.indexOf(a);m>-1&&f.splice(m,1)}})}emit(n,...a){[...this.events.get(n)||[]].forEach(s=>s(this,...a)),n!=="*"&&this.emit("*",n,...a)}}Object.defineProperty(vi,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(vi,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class gr extends vi{constructor(n={}){super(n),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}})}attachPlugins(n={}){const a=new Map;for(const[s,c]of Object.entries(n)){const f=this.option(s),m=this.plugins[s];m||f===!1?m&&f===!1&&(m.detach(),delete this.plugins[s]):a.set(s,new c(this,f||{}))}for(const[s,c]of a)this.plugins[s]=c,c.attach()}detachPlugins(n){n=n||Object.keys(this.plugins);for(const a of n){const s=this.plugins[a];s&&s.detach(),delete this.plugins[a]}return this.emit("detachPlugins"),this}}var Re;(function(T){T[T.Init=0]="Init",T[T.Error=1]="Error",T[T.Ready=2]="Ready",T[T.Panning=3]="Panning",T[T.Mousemove=4]="Mousemove",T[T.Destroy=5]="Destroy"})(Re||(Re={}));const Ht=["a","b","c","d","e","f"],Va={PANUP:"Move up",PANDOWN:"Move down",PANLEFT:"Move left",PANRIGHT:"Move right",ZOOMIN:"Zoom in",ZOOMOUT:"Zoom out",TOGGLEZOOM:"Toggle zoom level",TOGGLE1TO1:"Toggle zoom level",ITERATEZOOM:"Toggle zoom level",ROTATECCW:"Rotate counterclockwise",ROTATECW:"Rotate clockwise",FLIPX:"Flip horizontally",FLIPY:"Flip vertically",FITX:"Fit horizontally",FITY:"Fit vertically",RESET:"Reset",TOGGLEFS:"Toggle fullscreen"},Ml={content:null,width:"auto",height:"auto",panMode:"drag",touch:!0,dragMinThreshold:3,lockAxis:!1,mouseMoveFactor:1,mouseMoveFriction:.12,zoom:!0,pinchToZoom:!0,panOnlyZoomed:"auto",minScale:1,maxScale:2,friction:.25,dragFriction:.35,decelFriction:.05,click:"toggleZoom",dblClick:!1,wheel:"zoom",wheelLimit:7,spinner:!0,bounds:"auto",infinite:!1,rubberband:!0,bounce:!0,maxVelocity:75,transformParent:!1,classes:{content:"f-panzoom__content",isLoading:"is-loading",canZoomIn:"can-zoom_in",canZoomOut:"can-zoom_out",isDraggable:"is-draggable",isDragging:"is-dragging",inFullscreen:"in-fullscreen",htmlHasFullscreen:"with-panzoom-in-fullscreen"},l10n:Va},sa='<circle cx="25" cy="25" r="20"></circle>',vr='<div class="f-spinner"><svg viewBox="0 0 50 50">'+sa+sa+"</svg></div>",dt=T=>T&&T!==null&&T instanceof Element&&"nodeType"in T,Pe=(T,n)=>{T&&mr(n).forEach(a=>{T.classList.remove(a)})},fe=(T,n)=>{T&&mr(n).forEach(a=>{T.classList.add(a)})},ti={a:1,b:0,c:0,d:1,e:0,f:0},xl=1e5,ni=1e4,vt="mousemove",la="drag",ca="content",bt="auto";let Yi=null,Ki=null;class ln extends gr{get fits(){return this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1}get isTouchDevice(){return Ki===null&&(Ki=window.matchMedia("(hover: none)").matches),Ki}get isMobile(){return Yi===null&&(Yi=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),Yi}get panMode(){return this.options.panMode!==vt||this.isTouchDevice?la:vt}get panOnlyZoomed(){const n=this.options.panOnlyZoomed;return n===bt?this.isTouchDevice:n}get isInfinite(){return this.option("infinite")}get angle(){return 180*Math.atan2(this.current.b,this.current.a)/Math.PI||0}get targetAngle(){return 180*Math.atan2(this.target.b,this.target.a)/Math.PI||0}get scale(){const{a:n,b:a}=this.current;return Math.sqrt(n*n+a*a)||1}get targetScale(){const{a:n,b:a}=this.target;return Math.sqrt(n*n+a*a)||1}get minScale(){return this.option("minScale")||1}get fullScale(){const{contentRect:n}=this;return n.fullWidth/n.fitWidth||1}get maxScale(){return this.fullScale*(this.option("maxScale")||1)||1}get coverScale(){const{containerRect:n,contentRect:a}=this,s=Math.max(n.height/a.fitHeight,n.width/a.fitWidth)||1;return Math.min(this.fullScale,s)}get isScaling(){return Math.abs(this.targetScale-this.scale)>1e-5&&!this.isResting}get isContentLoading(){const n=this.content;return!!(n&&n instanceof HTMLImageElement)&&!n.complete}get isResting(){if(this.isBouncingX||this.isBouncingY)return!1;for(const n of Ht){const a=n=="e"||n==="f"?1e-4:1e-5;if(Math.abs(this.target[n]-this.current[n])>a)return!1}return!(!this.ignoreBounds&&!this.checkBounds().inBounds)}constructor(n,a={},s={}){var c;if(super(a),Object.defineProperty(this,"pointerTracker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resizeObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"updateTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rAF",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isTicking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clicks",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"trackingPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"cwd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pmme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"friction",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Re.Init}),Object.defineProperty(this,"isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerRect",{enumerable:!0,configurable:!0,writable:!0,value:{width:0,height:0,innerWidth:0,innerHeight:0}}),Object.defineProperty(this,"contentRect",{enumerable:!0,configurable:!0,writable:!0,value:{top:0,right:0,bottom:0,left:0,fullWidth:0,fullHeight:0,fitWidth:0,fitHeight:0,width:0,height:0}}),Object.defineProperty(this,"dragStart",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,top:0,left:0,time:0}}),Object.defineProperty(this,"dragOffset",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,time:0}}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},ti)}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},ti)}),Object.defineProperty(this,"velocity",{enumerable:!0,configurable:!0,writable:!0,value:{a:0,b:0,c:0,d:0,e:0,f:0}}),Object.defineProperty(this,"lockedAxis",{enumerable:!0,configurable:!0,writable:!0,value:!1}),!n)throw new Error("Container Element Not Found");this.container=n,this.initContent(),this.attachPlugins(Object.assign(Object.assign({},ln.Plugins),s)),this.emit("attachPlugins"),this.emit("init");const f=this.content;if(f.addEventListener("load",this.onLoad),f.addEventListener("error",this.onError),this.isContentLoading){if(this.option("spinner")){n.classList.add(this.cn("isLoading"));const m=At(vr);!n.contains(f)||f.parentElement instanceof HTMLPictureElement?this.spinner=n.appendChild(m):this.spinner=((c=f.parentElement)===null||c===void 0?void 0:c.insertBefore(m,f))||null}this.emit("beforeLoad")}else queueMicrotask(()=>{this.enable()})}initContent(){const{container:n}=this,a=this.cn(ca);let s=this.option(ca)||n.querySelector(`.${a}`);if(s||(s=n.querySelector("img,picture")||n.firstElementChild,s&&fe(s,a)),s instanceof HTMLPictureElement&&(s=s.querySelector("img")),!s)throw new Error("No content found");this.content=s}onLoad(){const{spinner:n,container:a,state:s}=this;n&&(n.remove(),this.spinner=null),this.option("spinner")&&a.classList.remove(this.cn("isLoading")),this.emit("afterLoad"),s===Re.Init?this.enable():this.updateMetrics()}onError(){this.state!==Re.Destroy&&(this.spinner&&(this.spinner.remove(),this.spinner=null),this.stop(),this.detachEvents(),this.state=Re.Error,this.emit("error"))}getNextScale(n){const{fullScale:a,targetScale:s,coverScale:c,maxScale:f,minScale:m}=this;let h=m;switch(n){case"toggleMax":h=s-m<.5*(f-m)?f:m;break;case"toggleCover":h=s-m<.5*(c-m)?c:m;break;case"toggleZoom":h=s-m<.5*(a-m)?a:m;break;case"iterateZoom":let y=[1,a,f].sort((S,d)=>S-d),C=y.findIndex(S=>S>s+1e-5);h=y[C]||1}return h}attachObserver(){var n;const a=()=>{const{container:s,containerRect:c}=this;return Math.abs(c.width-s.getBoundingClientRect().width)>.1||Math.abs(c.height-s.getBoundingClientRect().height)>.1};this.resizeObserver||window.ResizeObserver===void 0||(this.resizeObserver=new ResizeObserver(()=>{this.updateTimer||(a()?(this.onResize(),this.isMobile&&(this.updateTimer=setTimeout(()=>{a()&&this.onResize(),this.updateTimer=null},500))):this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null))})),(n=this.resizeObserver)===null||n===void 0||n.observe(this.container)}detachObserver(){var n;(n=this.resizeObserver)===null||n===void 0||n.disconnect()}attachEvents(){const{container:n}=this;n.addEventListener("click",this.onClick,{passive:!1,capture:!1}),n.addEventListener("wheel",this.onWheel,{passive:!1}),this.pointerTracker=new kl(n,{start:this.onPointerDown,move:this.onPointerMove,end:this.onPointerUp}),document.addEventListener(vt,this.onMouseMove)}detachEvents(){var n;const{container:a}=this;a.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),a.removeEventListener("wheel",this.onWheel,{passive:!1}),(n=this.pointerTracker)===null||n===void 0||n.stop(),this.pointerTracker=null,document.removeEventListener(vt,this.onMouseMove),document.removeEventListener("keydown",this.onKeydown,!0),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)}animate(){this.setTargetForce();const n=this.friction,a=this.option("maxVelocity");for(const s of Ht)n?(this.velocity[s]*=1-n,a&&!this.isScaling&&(this.velocity[s]=Math.max(Math.min(this.velocity[s],a),-1*a)),this.current[s]+=this.velocity[s]):this.current[s]=this.target[s];this.setTransform(),this.setEdgeForce(),!this.isResting||this.isDragging?this.rAF=requestAnimationFrame(()=>this.animate()):this.stop("current")}setTargetForce(){for(const n of Ht)n==="e"&&this.isBouncingX||n==="f"&&this.isBouncingY||(this.velocity[n]=(1/(1-this.friction)-1)*(this.target[n]-this.current[n]))}checkBounds(n=0,a=0){const{current:s}=this,c=s.e+n,f=s.f+a,m=this.getBounds(),{x:h,y}=m,C=h.min,S=h.max,d=y.min,u=y.max;let p=0,g=0;return C!==1/0&&c<C?p=C-c:S!==1/0&&c>S&&(p=S-c),d!==1/0&&f<d?g=d-f:u!==1/0&&f>u&&(g=u-f),Math.abs(p)<1e-4&&(p=0),Math.abs(g)<1e-4&&(g=0),Object.assign(Object.assign({},m),{xDiff:p,yDiff:g,inBounds:!p&&!g})}clampTargetBounds(){const{target:n}=this,{x:a,y:s}=this.getBounds();a.min!==1/0&&(n.e=Math.max(n.e,a.min)),a.max!==1/0&&(n.e=Math.min(n.e,a.max)),s.min!==1/0&&(n.f=Math.max(n.f,s.min)),s.max!==1/0&&(n.f=Math.min(n.f,s.max))}calculateContentDim(n=this.current){const{content:a,contentRect:s}=this,{fitWidth:c,fitHeight:f,fullWidth:m,fullHeight:h}=s;let y=m,C=h;if(this.option("zoom")||this.angle!==0){const S=!(a instanceof HTMLImageElement)&&(window.getComputedStyle(a).maxWidth==="none"||window.getComputedStyle(a).maxHeight==="none"),d=S?m:c,u=S?h:f,p=this.getMatrix(n),g=new DOMPoint(0,0).matrixTransform(p),E=new DOMPoint(0+d,0).matrixTransform(p),b=new DOMPoint(0+d,0+u).matrixTransform(p),k=new DOMPoint(0,0+u).matrixTransform(p),M=Math.abs(b.x-g.x),x=Math.abs(b.y-g.y),A=Math.abs(k.x-E.x),v=Math.abs(k.y-E.y);y=Math.max(M,A),C=Math.max(x,v)}return{contentWidth:y,contentHeight:C}}setEdgeForce(){if(this.ignoreBounds||this.isDragging||this.panMode===vt||this.targetScale<this.scale)return this.isBouncingX=!1,void(this.isBouncingY=!1);const{target:n}=this,{x:a,y:s,xDiff:c,yDiff:f}=this.checkBounds(),m=this.option("maxVelocity");let h=this.velocity.e,y=this.velocity.f;c!==0?(this.isBouncingX=!0,c*h<=0?h+=.14*c:(h=.14*c,a.min!==1/0&&(this.target.e=Math.max(n.e,a.min)),a.max!==1/0&&(this.target.e=Math.min(n.e,a.max))),m&&(h=Math.max(Math.min(h,m),-1*m))):this.isBouncingX=!1,f!==0?(this.isBouncingY=!0,f*y<=0?y+=.14*f:(y=.14*f,s.min!==1/0&&(this.target.f=Math.max(n.f,s.min)),s.max!==1/0&&(this.target.f=Math.min(n.f,s.max))),m&&(y=Math.max(Math.min(y,m),-1*m))):this.isBouncingY=!1,this.isBouncingX&&(this.velocity.e=h),this.isBouncingY&&(this.velocity.f=y)}enable(){const{content:n}=this,a=new DOMMatrixReadOnly(window.getComputedStyle(n).transform);for(const s of Ht)this.current[s]=this.target[s]=a[s];this.updateMetrics(),this.attachObserver(),this.attachEvents(),this.state=Re.Ready,this.emit("ready")}onClick(n){var a;n.type==="click"&&n.detail===0&&(this.dragOffset.x=0,this.dragOffset.y=0),this.isDragging&&((a=this.pointerTracker)===null||a===void 0||a.clear(),this.trackingPoints=[],this.startDecelAnim());const s=n.target;if(!s||n.defaultPrevented)return;if(s.hasAttribute("disabled"))return n.preventDefault(),void n.stopPropagation();if((()=>{const p=window.getSelection();return p&&p.type==="Range"})()&&!s.closest("button"))return;const c=s.closest("[data-panzoom-action]"),f=s.closest("[data-panzoom-change]"),m=c||f,h=m&&dt(m)?m.dataset:null;if(h){const p=h.panzoomChange,g=h.panzoomAction;if((p||g)&&n.preventDefault(),p){let E={};try{E=JSON.parse(p)}catch{console&&console.warn("The given data was not valid JSON")}return void this.applyChange(E)}if(g)return void(this[g]&&this[g]())}if(Math.abs(this.dragOffset.x)>3||Math.abs(this.dragOffset.y)>3)return n.preventDefault(),void n.stopPropagation();if(s.closest("[data-fancybox]"))return;const y=this.content.getBoundingClientRect(),C=this.dragStart;if(C.time&&!this.canZoomOut()&&(Math.abs(y.x-C.x)>2||Math.abs(y.y-C.y)>2))return;this.dragStart.time=0;const S=p=>{this.option("zoom",n)&&p&&typeof p=="string"&&/(iterateZoom)|(toggle(Zoom|Full|Cover|Max)|(zoomTo(Fit|Cover|Max)))/.test(p)&&typeof this[p]=="function"&&(n.preventDefault(),this[p]({event:n}))},d=this.option("click",n),u=this.option("dblClick",n);u?(this.clicks++,this.clicks==1&&(this.clickTimer=setTimeout(()=>{this.clicks===1?(this.emit("click",n),!n.defaultPrevented&&d&&S(d)):(this.emit("dblClick",n),n.defaultPrevented||S(u)),this.clicks=0,this.clickTimer=null},350))):(this.emit("click",n),!n.defaultPrevented&&d&&S(d))}addTrackingPoint(n){const a=this.trackingPoints.filter(s=>s.time>Date.now()-100);a.push(n),this.trackingPoints=a}onPointerDown(n,a,s){var c;if(this.option("touch",n)===!1)return!1;this.pwt=0,this.dragOffset={x:0,y:0,time:0},this.trackingPoints=[];const f=this.content.getBoundingClientRect();if(this.dragStart={x:f.x,y:f.y,top:f.top,left:f.left,time:Date.now()},this.clickTimer)return!1;if(this.panMode===vt&&this.targetScale>1)return n.preventDefault(),n.stopPropagation(),!1;const m=n.composedPath()[0];if(!s.length){if(["TEXTAREA","OPTION","INPUT","SELECT","VIDEO","IFRAME"].includes(m.nodeName)||m.closest("[contenteditable],[data-selectable],[data-draggable],[data-clickable],[data-panzoom-change],[data-panzoom-action]"))return!1;(c=window.getSelection())===null||c===void 0||c.removeAllRanges()}if(n.type==="mousedown")["A","BUTTON"].includes(m.nodeName)||n.preventDefault();else if(Math.abs(this.velocity.a)>.3)return!1;return this.target.e=this.current.e,this.target.f=this.current.f,this.stop(),this.isDragging||(this.isDragging=!0,this.addTrackingPoint(a),this.emit("touchStart",n)),!0}onPointerMove(n,a,s){if(this.option("touch",n)===!1||!this.isDragging||a.length<2&&this.panOnlyZoomed&&ie(this.targetScale)<=ie(this.minScale)||(this.emit("touchMove",n),n.defaultPrevented))return;this.addTrackingPoint(a[0]);const{content:c}=this,f=oa(s[0],s[1]),m=oa(a[0],a[1]);let h=0,y=0;if(a.length>1){const x=c.getBoundingClientRect();h=f.clientX-x.left-.5*x.width,y=f.clientY-x.top-.5*x.height}const C=aa(s[0],s[1]),S=aa(a[0],a[1]);let d=C?S/C:1,u=m.clientX-f.clientX,p=m.clientY-f.clientY;this.dragOffset.x+=u,this.dragOffset.y+=p,this.dragOffset.time=Date.now()-this.dragStart.time;let g=ie(this.targetScale)===ie(this.minScale)&&this.option("lockAxis");if(g&&!this.lockedAxis)if(g==="xy"||g==="y"||n.type==="touchmove"){if(Math.abs(this.dragOffset.x)<6&&Math.abs(this.dragOffset.y)<6)return void n.preventDefault();const x=Math.abs(180*Math.atan2(this.dragOffset.y,this.dragOffset.x)/Math.PI);this.lockedAxis=x>45&&x<135?"y":"x",this.dragOffset.x=0,this.dragOffset.y=0,u=0,p=0}else this.lockedAxis=g;if(gi(n.target,this.content)&&(g="x",this.dragOffset.y=0),g&&g!=="xy"&&this.lockedAxis!==g&&ie(this.targetScale)===ie(this.minScale))return;n.cancelable&&n.preventDefault(),this.container.classList.add(this.cn("isDragging"));const E=this.checkBounds(u,p);this.option("rubberband")?(this.isInfinite!=="x"&&(E.xDiff>0&&u<0||E.xDiff<0&&u>0)&&(u*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitWidth*E.xDiff))),this.isInfinite!=="y"&&(E.yDiff>0&&p<0||E.yDiff<0&&p>0)&&(p*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitHeight*E.yDiff)))):(E.xDiff&&(u=0),E.yDiff&&(p=0));const b=this.targetScale,k=this.minScale,M=this.maxScale;b<.5*k&&(d=Math.max(d,k)),b>1.5*M&&(d=Math.min(d,M)),this.lockedAxis==="y"&&ie(b)===ie(k)&&(u=0),this.lockedAxis==="x"&&ie(b)===ie(k)&&(p=0),this.applyChange({originX:h,originY:y,panX:u,panY:p,scale:d,friction:this.option("dragFriction"),ignoreBounds:!0})}onPointerUp(n,a,s){if(s.length)return this.dragOffset.x=0,this.dragOffset.y=0,void(this.trackingPoints=[]);this.container.classList.remove(this.cn("isDragging")),this.isDragging&&(this.addTrackingPoint(a),this.panOnlyZoomed&&this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1&&(this.trackingPoints=[]),gi(n.target,this.content)&&this.lockedAxis==="y"&&(this.trackingPoints=[]),this.emit("touchEnd",n),this.isDragging=!1,this.lockedAxis=!1,this.state!==Re.Destroy&&(n.defaultPrevented||this.startDecelAnim()))}startDecelAnim(){var n;const a=this.isScaling;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const x of Ht)this.velocity[x]=0;this.target.e=this.current.e,this.target.f=this.current.f,Pe(this.container,"is-scaling"),Pe(this.container,"is-animating"),this.isTicking=!1;const{trackingPoints:s}=this,c=s[0],f=s[s.length-1];let m=0,h=0,y=0;f&&c&&(m=f.clientX-c.clientX,h=f.clientY-c.clientY,y=f.time-c.time);const C=((n=window.visualViewport)===null||n===void 0?void 0:n.scale)||1;C!==1&&(m*=C,h*=C);let S=0,d=0,u=0,p=0,g=this.option("decelFriction");const E=this.targetScale;if(y>0){u=Math.abs(m)>3?m/(y/30):0,p=Math.abs(h)>3?h/(y/30):0;const x=this.option("maxVelocity");x&&(u=Math.max(Math.min(u,x),-1*x),p=Math.max(Math.min(p,x),-1*x))}u&&(S=u/(1/(1-g)-1)),p&&(d=p/(1/(1-g)-1)),(this.option("lockAxis")==="y"||this.option("lockAxis")==="xy"&&this.lockedAxis==="y"&&ie(E)===this.minScale)&&(S=u=0),(this.option("lockAxis")==="x"||this.option("lockAxis")==="xy"&&this.lockedAxis==="x"&&ie(E)===this.minScale)&&(d=p=0);const b=this.dragOffset.x,k=this.dragOffset.y,M=this.option("dragMinThreshold")||0;Math.abs(b)<M&&Math.abs(k)<M&&(S=d=0,u=p=0),(this.option("zoom")&&(E<this.minScale-1e-5||E>this.maxScale+1e-5)||a&&!S&&!d)&&(g=.35),this.applyChange({panX:S,panY:d,friction:g}),this.emit("decel",u,p,b,k)}onWheel(n){var a=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(f,m){return Math.abs(m)>Math.abs(f)?m:f});const s=Math.max(-1,Math.min(1,a));if(this.emit("wheel",n,s),this.panMode===vt||n.defaultPrevented)return;const c=this.option("wheel");c==="pan"?(n.preventDefault(),this.panOnlyZoomed&&!this.canZoomOut()||this.applyChange({panX:2*-n.deltaX,panY:2*-n.deltaY,bounce:!1})):c==="zoom"&&this.option("zoom")!==!1&&this.zoomWithWheel(n)}onMouseMove(n){this.panWithMouse(n)}onKeydown(n){n.key==="Escape"&&this.toggleFS()}onResize(){this.updateMetrics(),this.checkBounds().inBounds||this.requestTick()}setTransform(){this.emit("beforeTransform");const{current:n,target:a,content:s,contentRect:c}=this,f=Object.assign({},ti);for(const b of Ht){const k=b=="e"||b==="f"?ni:xl;f[b]=ie(n[b],k),Math.abs(a[b]-n[b])<(b=="e"||b==="f"?.51:.001)&&(n[b]=a[b])}let{a:m,b:h,c:y,d:C,e:S,f:d}=f,u=`matrix(${m}, ${h}, ${y}, ${C}, ${S}, ${d})`,p=s.parentElement instanceof HTMLPictureElement?s.parentElement:s;if(this.option("transformParent")&&(p=p.parentElement||p),p.style.transform===u)return;p.style.transform=u;const{contentWidth:g,contentHeight:E}=this.calculateContentDim();c.width=g,c.height=E,this.emit("afterTransform")}updateMetrics(n=!1){var a;if(!this||this.state===Re.Destroy||this.isContentLoading)return;const s=Math.max(1,((a=window.visualViewport)===null||a===void 0?void 0:a.scale)||1),{container:c,content:f}=this,m=f instanceof HTMLImageElement,h=c.getBoundingClientRect(),y=getComputedStyle(this.container);let C=h.width*s,S=h.height*s;const d=parseFloat(y.paddingTop)+parseFloat(y.paddingBottom),u=C-(parseFloat(y.paddingLeft)+parseFloat(y.paddingRight)),p=S-d;this.containerRect={width:C,height:S,innerWidth:u,innerHeight:p};const g=parseFloat(f.dataset.width||"")||(re=>{let de=0;return de=re instanceof HTMLImageElement?re.naturalWidth:re instanceof SVGElement?re.width.baseVal.value:Math.max(re.offsetWidth,re.scrollWidth),de||0})(f),E=parseFloat(f.dataset.height||"")||(re=>{let de=0;return de=re instanceof HTMLImageElement?re.naturalHeight:re instanceof SVGElement?re.height.baseVal.value:Math.max(re.offsetHeight,re.scrollHeight),de||0})(f);let b=this.option("width",g)||bt,k=this.option("height",E)||bt;const M=b===bt,x=k===bt;typeof b!="number"&&(b=g),typeof k!="number"&&(k=E),M&&(b=g*(k/E)),x&&(k=E/(g/b));let A=f.parentElement instanceof HTMLPictureElement?f.parentElement:f;this.option("transformParent")&&(A=A.parentElement||A);const v=A.getAttribute("style")||"";A.style.setProperty("transform","none","important"),m&&(A.style.width="",A.style.height=""),A.offsetHeight;const O=f.getBoundingClientRect();let I=O.width*s,R=O.height*s,P=I,B=R;I=Math.min(I,b),R=Math.min(R,k),m?{width:I,height:R}=((re,de,ve,ke)=>{const be=ve/re,we=ke/de,Ae=Math.min(be,we);return{width:re*=Ae,height:de*=Ae}})(b,k,I,R):(I=Math.min(I,b),R=Math.min(R,k));let W=.5*(B-R),G=.5*(P-I);this.contentRect=Object.assign(Object.assign({},this.contentRect),{top:O.top-h.top+W,bottom:h.bottom-O.bottom+W,left:O.left-h.left+G,right:h.right-O.right+G,fitWidth:I,fitHeight:R,width:I,height:R,fullWidth:b,fullHeight:k}),A.style.cssText=v,m&&(A.style.width=`${I}px`,A.style.height=`${R}px`),this.setTransform(),n!==!0&&this.emit("refresh"),this.ignoreBounds||(ie(this.targetScale)<ie(this.minScale)?this.zoomTo(this.minScale,{friction:0}):this.targetScale>this.maxScale?this.zoomTo(this.maxScale,{friction:0}):this.state===Re.Init||this.checkBounds().inBounds||this.requestTick()),this.updateControls()}calculateBounds(){const{contentWidth:n,contentHeight:a}=this.calculateContentDim(this.target),{targetScale:s,lockedAxis:c}=this,{fitWidth:f,fitHeight:m}=this.contentRect;let h=0,y=0,C=0,S=0;const d=this.option("infinite");if(d===!0||c&&d===c)h=-1/0,C=1/0,y=-1/0,S=1/0;else{let{containerRect:u,contentRect:p}=this,g=ie(f*s,ni),E=ie(m*s,ni),{innerWidth:b,innerHeight:k}=u;if(u.width===g&&(b=u.width),u.width===E&&(k=u.height),n>b){C=.5*(n-b),h=-1*C;let M=.5*(p.right-p.left);h+=M,C+=M}if(f>b&&n<b&&(h-=.5*(f-b),C-=.5*(f-b)),a>k){S=.5*(a-k),y=-1*S;let M=.5*(p.bottom-p.top);y+=M,S+=M}m>k&&a<k&&(h-=.5*(m-k),C-=.5*(m-k))}return{x:{min:h,max:C},y:{min:y,max:S}}}getBounds(){const n=this.option("bounds");return n!==bt?n:this.calculateBounds()}updateControls(){const n=this,a=n.container,{panMode:s,contentRect:c,targetScale:f,minScale:m}=n;let h=m,y=n.option("click")||!1;y&&(h=n.getNextScale(y));let C=n.canZoomIn(),S=n.canZoomOut(),d=s===la&&!!this.option("touch"),u=S&&d;if(d&&(ie(f)<ie(m)&&!this.panOnlyZoomed&&(u=!0),(ie(c.width,1)>ie(c.fitWidth,1)||ie(c.height,1)>ie(c.fitHeight,1))&&(u=!0)),ie(c.width*f,1)<ie(c.fitWidth,1)&&(u=!1),s===vt&&(u=!1),Dt(a,this.cn("isDraggable"),u),!this.option("zoom"))return;let p=C&&ie(h)>ie(f),g=!p&&!u&&S&&ie(h)<ie(f);Dt(a,this.cn("canZoomIn"),p),Dt(a,this.cn("canZoomOut"),g);for(const E of a.querySelectorAll("[data-panzoom-action]")){let b=!1,k=!1;switch(E.dataset.panzoomAction){case"zoomIn":C?b=!0:k=!0;break;case"zoomOut":S?b=!0:k=!0;break;case"toggleZoom":case"iterateZoom":C||S?b=!0:k=!0;const M=E.querySelector("g");M&&(M.style.display=C?"":"none")}b?(E.removeAttribute("disabled"),E.removeAttribute("tabindex")):k&&(E.setAttribute("disabled",""),E.setAttribute("tabindex","-1"))}}panTo({x:n=this.target.e,y:a=this.target.f,scale:s=this.targetScale,friction:c=this.option("friction"),angle:f=0,originX:m=0,originY:h=0,flipX:y=!1,flipY:C=!1,ignoreBounds:S=!1}){this.state!==Re.Destroy&&this.applyChange({panX:n-this.target.e,panY:a-this.target.f,scale:s/this.targetScale,angle:f,originX:m,originY:h,friction:c,flipX:y,flipY:C,ignoreBounds:S})}applyChange({panX:n=0,panY:a=0,scale:s=1,angle:c=0,originX:f=-this.current.e,originY:m=-this.current.f,friction:h=this.option("friction"),flipX:y=!1,flipY:C=!1,ignoreBounds:S=!1,bounce:d=this.option("bounce")}){const u=this.state;if(u===Re.Destroy)return;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.friction=h||0,this.ignoreBounds=S;const{current:p}=this,g=p.e,E=p.f,b=this.getMatrix(this.target);let k=new DOMMatrix().translate(g,E).translate(f,m).translate(n,a);if(this.option("zoom")){if(!S){const M=this.targetScale,x=this.minScale,A=this.maxScale;M*s<x&&(s=x/M),M*s>A&&(s=A/M)}k=k.scale(s)}k=k.translate(-f,-m).translate(-g,-E).multiply(b),c&&(k=k.rotate(c)),y&&(k=k.scale(-1,1)),C&&(k=k.scale(1,-1));for(const M of Ht)M!=="e"&&M!=="f"&&(k[M]>this.minScale+1e-5||k[M]<this.minScale-1e-5)?this.target[M]=k[M]:this.target[M]=ie(k[M],ni);(this.targetScale<this.scale||Math.abs(s-1)>.1||this.panMode===vt||d===!1)&&!S&&this.clampTargetBounds(),u===Re.Init?this.animate():this.isResting||(this.state=Re.Panning,this.requestTick())}stop(n=!1){if(this.state===Re.Init||this.state===Re.Destroy)return;const a=this.isTicking;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const s of Ht)this.velocity[s]=0,n==="current"?this.current[s]=this.target[s]:n==="target"&&(this.target[s]=this.current[s]);this.setTransform(),Pe(this.container,"is-scaling"),Pe(this.container,"is-animating"),this.isTicking=!1,this.state=Re.Ready,a&&(this.emit("endAnimation"),this.updateControls())}requestTick(){this.isTicking||(this.emit("startAnimation"),this.updateControls(),fe(this.container,"is-animating"),this.isScaling&&fe(this.container,"is-scaling")),this.isTicking=!0,this.rAF||(this.rAF=requestAnimationFrame(()=>this.animate()))}panWithMouse(n,a=this.option("mouseMoveFriction")){if(this.pmme=n,this.panMode!==vt||!n||ie(this.targetScale)<=ie(this.minScale))return;this.emit("mouseMove",n);const{container:s,containerRect:c,contentRect:f}=this,m=c.width,h=c.height,y=s.getBoundingClientRect(),C=(n.clientX||0)-y.left,S=(n.clientY||0)-y.top;let{contentWidth:d,contentHeight:u}=this.calculateContentDim(this.target);const p=this.option("mouseMoveFactor");p>1&&(d!==m&&(d*=p),u!==h&&(u*=p));let g=.5*(d-m)-C/m*100/100*(d-m);g+=.5*(f.right-f.left);let E=.5*(u-h)-S/h*100/100*(u-h);E+=.5*(f.bottom-f.top),this.applyChange({panX:g-this.target.e,panY:E-this.target.f,friction:a})}zoomWithWheel(n){if(this.state===Re.Destroy||this.state===Re.Init)return;const a=Date.now();if(a-this.pwt<45)return void n.preventDefault();this.pwt=a;var s=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(C,S){return Math.abs(S)>Math.abs(C)?S:C});const c=Math.max(-1,Math.min(1,s)),{targetScale:f,maxScale:m,minScale:h}=this;let y=f*(100+45*c)/100;ie(y)<ie(h)&&ie(f)<=ie(h)?(this.cwd+=Math.abs(c),y=h):ie(y)>ie(m)&&ie(f)>=ie(m)?(this.cwd+=Math.abs(c),y=m):(this.cwd=0,y=Math.max(Math.min(y,m),h)),this.cwd>this.option("wheelLimit")||(n.preventDefault(),ie(y)!==ie(f)&&this.zoomTo(y,{event:n}))}canZoomIn(){return this.option("zoom")&&(ie(this.contentRect.width,1)<ie(this.contentRect.fitWidth,1)||ie(this.targetScale)<ie(this.maxScale))}canZoomOut(){return this.option("zoom")&&ie(this.targetScale)>ie(this.minScale)}zoomIn(n=1.25,a){this.zoomTo(this.targetScale*n,a)}zoomOut(n=.8,a){this.zoomTo(this.targetScale*n,a)}zoomToFit(n){this.zoomTo("fit",n)}zoomToCover(n){this.zoomTo("cover",n)}zoomToFull(n){this.zoomTo("full",n)}zoomToMax(n){this.zoomTo("max",n)}toggleZoom(n){this.zoomTo(this.getNextScale("toggleZoom"),n)}toggleMax(n){this.zoomTo(this.getNextScale("toggleMax"),n)}toggleCover(n){this.zoomTo(this.getNextScale("toggleCover"),n)}iterateZoom(n){this.zoomTo("next",n)}zoomTo(n=1,{friction:a=bt,originX:s=bt,originY:c=bt,event:f}={}){if(this.isContentLoading||this.state===Re.Destroy)return;const{targetScale:m,fullScale:h,maxScale:y,coverScale:C}=this;if(this.stop(),this.panMode===vt&&(f=this.pmme||f),f||s===bt||c===bt){const d=this.content.getBoundingClientRect(),u=this.container.getBoundingClientRect(),p=f?f.clientX:u.left+.5*u.width,g=f?f.clientY:u.top+.5*u.height;s=p-d.left-.5*d.width,c=g-d.top-.5*d.height}let S=1;typeof n=="number"?S=n:n==="full"?S=h:n==="cover"?S=C:n==="max"?S=y:n==="fit"?S=1:n==="next"&&(S=this.getNextScale("iterateZoom")),S=S/m||1,a=a===bt?S>1?.15:.25:a,this.applyChange({scale:S,originX:s,originY:c,friction:a}),f&&this.panMode===vt&&this.panWithMouse(f,a)}rotateCCW(){this.applyChange({angle:-90})}rotateCW(){this.applyChange({angle:90})}flipX(){this.applyChange({flipX:!0})}flipY(){this.applyChange({flipY:!0})}fitX(){this.stop("target");const{containerRect:n,contentRect:a,target:s}=this;this.applyChange({panX:.5*n.width-(a.left+.5*a.fitWidth)-s.e,panY:.5*n.height-(a.top+.5*a.fitHeight)-s.f,scale:n.width/a.fitWidth/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}fitY(){this.stop("target");const{containerRect:n,contentRect:a,target:s}=this;this.applyChange({panX:.5*n.width-(a.left+.5*a.fitWidth)-s.e,panY:.5*n.innerHeight-(a.top+.5*a.fitHeight)-s.f,scale:n.height/a.fitHeight/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}toggleFS(){const{container:n}=this,a=this.cn("inFullscreen"),s=this.cn("htmlHasFullscreen");n.classList.toggle(a);const c=n.classList.contains(a);c?(document.documentElement.classList.add(s),document.addEventListener("keydown",this.onKeydown,!0)):(document.documentElement.classList.remove(s),document.removeEventListener("keydown",this.onKeydown,!0)),this.updateMetrics(),this.emit(c?"enterFS":"exitFS")}getMatrix(n=this.current){const{a,b:s,c,d:f,e:m,f:h}=n;return new DOMMatrix([a,s,c,f,m,h])}reset(n){if(this.state!==Re.Init&&this.state!==Re.Destroy){this.stop("current");for(const a of Ht)this.target[a]=ti[a];this.target.a=this.minScale,this.target.d=this.minScale,this.clampTargetBounds(),this.isResting||(this.friction=n===void 0?this.option("friction"):n,this.state=Re.Panning,this.requestTick())}}destroy(){this.stop(),this.state=Re.Destroy,this.detachEvents(),this.detachObserver();const{container:n,content:a}=this,s=this.option("classes")||{};for(const c of Object.values(s))n.classList.remove(c+"");a&&(a.removeEventListener("load",this.onLoad),a.removeEventListener("error",this.onError)),this.detachPlugins()}}Object.defineProperty(ln,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Ml}),Object.defineProperty(ln,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}});const ua=function(T,n){let a=!0;return(...s)=>{a&&(a=!1,T(...s),setTimeout(()=>{a=!0},n))}},da=(T,n)=>{let a=[];return T.childNodes.forEach(s=>{s.nodeType!==Node.ELEMENT_NODE||n&&!s.matches(n)||a.push(s)}),a},_l={viewport:null,track:null,enabled:!0,slides:[],axis:"x",transition:"fade",preload:1,slidesPerPage:"auto",initialPage:0,friction:.12,Panzoom:{decelFriction:.12},center:!0,infinite:!0,fill:!0,dragFree:!1,adaptiveHeight:!1,direction:"ltr",classes:{container:"f-carousel",viewport:"f-carousel__viewport",track:"f-carousel__track",slide:"f-carousel__slide",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",inTransition:"in-transition",isSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}};var Ge;(function(T){T[T.Init=0]="Init",T[T.Ready=1]="Ready",T[T.Destroy=2]="Destroy"})(Ge||(Ge={}));const Gi=T=>{if(typeof T=="string"||T instanceof HTMLElement)T={html:T};else{const n=T.thumb;n!==void 0&&(typeof n=="string"&&(T.thumbSrc=n),n instanceof HTMLImageElement&&(T.thumbEl=n,T.thumbElSrc=n.src,T.thumbSrc=n.src),delete T.thumb)}return Object.assign({html:"",el:null,isDom:!1,class:"",customClass:"",index:-1,dim:0,gap:0,pos:0,transition:!1},T)},Ll=(T={})=>Object.assign({index:-1,slides:[],dim:0,pos:-1},T);class Ct extends vi{constructor(n,a){super(a),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:n})}attach(){}detach(){}}const Al={classes:{list:"f-carousel__dots",isDynamic:"is-dynamic",hasDots:"has-dots",dot:"f-carousel__dot",isBeforePrev:"is-before-prev",isPrev:"is-prev",isCurrent:"is-current",isNext:"is-next",isAfterNext:"is-after-next"},dotTpl:'<button type="button" data-carousel-page="%i" aria-label="{{GOTO}}"><span class="f-carousel__dot" aria-hidden="true"></span></button>',dynamicFrom:11,maxCount:1/0,minCount:2};class $a extends Ct{constructor(){super(...arguments),Object.defineProperty(this,"isDynamic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){this.refresh()}build(){let n=this.list;if(!n){n=document.createElement("ul"),fe(n,this.cn("list")),n.setAttribute("role","tablist");const a=this.instance.container;a.appendChild(n),fe(a,this.cn("hasDots")),this.list=n}return n}refresh(){var n;const a=this.instance.pages.length,s=Math.min(2,this.option("minCount")),c=Math.max(2e3,this.option("maxCount")),f=this.option("dynamicFrom");if(a<s||a>c)return void this.cleanup();const m=typeof f=="number"&&a>5&&a>=f,h=!this.list||this.isDynamic!==m||this.list.children.length!==a;h&&this.cleanup();const y=this.build();if(Dt(y,this.cn("isDynamic"),!!m),h)for(let d=0;d<a;d++)y.append(this.createItem(d));let C,S=0;for(const d of[...y.children]){const u=S===this.instance.page;u&&(C=d),Dt(d,this.cn("isCurrent"),u),(n=d.children[0])===null||n===void 0||n.setAttribute("aria-selected",u?"true":"false");for(const p of["isBeforePrev","isPrev","isNext","isAfterNext"])Pe(d,this.cn(p));S++}if(C=C||y.firstChild,m&&C){const d=C.previousElementSibling,u=d&&d.previousElementSibling;fe(d,this.cn("isPrev")),fe(u,this.cn("isBeforePrev"));const p=C.nextElementSibling,g=p&&p.nextElementSibling;fe(p,this.cn("isNext")),fe(g,this.cn("isAfterNext"))}this.isDynamic=m}createItem(n=0){var a;const s=document.createElement("li");s.setAttribute("role","presentation");const c=At(this.instance.localize(this.option("dotTpl"),[["%d",n+1]]).replace(/\%i/g,n+""));return s.appendChild(c),(a=s.children[0])===null||a===void 0||a.setAttribute("role","tab"),s}cleanup(){this.list&&(this.list.remove(),this.list=null),this.isDynamic=!1,Pe(this.instance.container,this.cn("hasDots"))}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty($a,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Al});const ii="disabled",ri="next",fa="prev";class qa extends Ct{constructor(){super(...arguments),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isDom",{enumerable:!0,configurable:!0,writable:!0,value:!1})}onRefresh(){const n=this.instance,a=n.pages.length,s=n.page;if(a<2)return void this.cleanup();this.build();let c=this.prev,f=this.next;c&&f&&(c.removeAttribute(ii),f.removeAttribute(ii),n.isInfinite||(s<=0&&c.setAttribute(ii,""),s>=a-1&&f.setAttribute(ii,"")))}addBtn(n){var a;const s=this.instance,c=document.createElement("button");c.setAttribute("tabindex","0"),c.setAttribute("title",s.localize(`{{${n.toUpperCase()}}}`)),fe(c,this.cn("button")+" "+this.cn(n===ri?"isNext":"isPrev"));const f=s.isRTL?n===ri?fa:ri:n;var m;return c.innerHTML=s.localize(this.option(`${f}Tpl`)),c.dataset[`carousel${m=n,m?m.match("^[a-z]")?m.charAt(0).toUpperCase()+m.substring(1):m:""}`]="true",(a=this.container)===null||a===void 0||a.appendChild(c),c}build(){const n=this.instance.container,a=this.cn("container");let{container:s,prev:c,next:f}=this;s||(s=n.querySelector("."+a),this.isDom=!!s),s||(s=document.createElement("div"),fe(s,a),n.appendChild(s)),this.container=s,f||(f=s.querySelector("[data-carousel-next]")),f||(f=this.addBtn(ri)),this.next=f,c||(c=s.querySelector("[data-carousel-prev]")),c||(c=this.addBtn(fa)),this.prev=c}cleanup(){this.isDom||(this.prev&&this.prev.remove(),this.next&&this.next.remove(),this.container&&this.container.remove()),this.prev=null,this.next=null,this.container=null,this.isDom=!1}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(qa,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{container:"f-carousel__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"},nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>'}});class Wa extends Ct{constructor(){super(...arguments),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:null})}addAsTargetFor(n){this.target=this.instance,this.nav=n,this.attachEvents()}addAsNavFor(n){this.nav=this.instance,this.target=n,this.attachEvents()}attachEvents(){const{nav:n,target:a}=this;n&&a&&(n.options.initialSlide=a.options.initialPage,n.state===Ge.Ready?this.onNavReady(n):n.on("ready",this.onNavReady),a.state===Ge.Ready?this.onTargetReady(a):a.on("ready",this.onTargetReady))}onNavReady(n){n.on("createSlide",this.onNavCreateSlide),n.on("Panzoom.click",this.onNavClick),n.on("Panzoom.touchEnd",this.onNavTouch),this.onTargetChange()}onTargetReady(n){n.on("change",this.onTargetChange),n.on("Panzoom.refresh",this.onTargetChange),this.onTargetChange()}onNavClick(n,a,s){this.onNavTouch(n,n.panzoom,s)}onNavTouch(n,a,s){var c,f;if(Math.abs(a.dragOffset.x)>3||Math.abs(a.dragOffset.y)>3)return;const m=s.target,{nav:h,target:y}=this;if(!h||!y||!m)return;const C=m.closest("[data-index]");if(s.stopPropagation(),s.preventDefault(),!C)return;const S=parseInt(C.dataset.index||"",10)||0,d=y.getPageForSlide(S),u=h.getPageForSlide(S);h.slideTo(u),y.slideTo(d,{friction:((f=(c=this.nav)===null||c===void 0?void 0:c.plugins)===null||f===void 0?void 0:f.Sync.option("friction"))||0}),this.markSelectedSlide(S)}onNavCreateSlide(n,a){a.index===this.selectedIndex&&this.markSelectedSlide(a.index)}onTargetChange(){var n,a;const{target:s,nav:c}=this;if(!s||!c||c.state!==Ge.Ready||s.state!==Ge.Ready)return;const f=(a=(n=s.pages[s.page])===null||n===void 0?void 0:n.slides[0])===null||a===void 0?void 0:a.index,m=c.getPageForSlide(f);this.markSelectedSlide(f),c.slideTo(m,c.prevPage===null&&s.prevPage===null?{friction:0}:void 0)}markSelectedSlide(n){const a=this.nav;a&&a.state===Ge.Ready&&(this.selectedIndex=n,[...a.slides].map(s=>{s.el&&s.el.classList[s.index===n?"add":"remove"]("is-nav-selected")}))}attach(){const n=this;let a=n.options.target,s=n.options.nav;a?n.addAsNavFor(a):s&&n.addAsTargetFor(s)}detach(){const n=this,a=n.nav,s=n.target;a&&(a.off("ready",n.onNavReady),a.off("createSlide",n.onNavCreateSlide),a.off("Panzoom.click",n.onNavClick),a.off("Panzoom.touchEnd",n.onNavTouch)),n.nav=null,s&&(s.off("ready",n.onTargetReady),s.off("refresh",n.onTargetChange),s.off("change",n.onTargetChange)),n.target=null}}Object.defineProperty(Wa,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{friction:.35}});const Dl={Navigation:qa,Dots:$a,Sync:Wa},ai="animationend",ha="isSelected",oi="slide";class an extends gr{get axis(){return this.isHorizontal?"e":"f"}get isEnabled(){return this.state===Ge.Ready}get isInfinite(){let n=!1;const{contentDim:a,viewportDim:s,pages:c,slides:f}=this,m=f[0];return c.length>=2&&m&&a+m.dim>=s&&(n=this.option("infinite")),n}get isRTL(){return this.option("direction")==="rtl"}get isHorizontal(){return this.option("axis")==="x"}constructor(n,a={},s={}){if(super(),Object.defineProperty(this,"bp",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lp",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"userOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Ge.Init}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"prevPage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"slides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inTransition",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"contentDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"viewportDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),typeof n=="string"&&(n=document.querySelector(n)),!n||!dt(n))throw new Error("No Element found");this.container=n,this.slideNext=ua(this.slideNext.bind(this),150),this.slidePrev=ua(this.slidePrev.bind(this),150),this.userOptions=a,this.userPlugins=s,queueMicrotask(()=>{this.processOptions()})}processOptions(){var n,a;const s=ft({},an.defaults,this.userOptions);let c="";const f=s.breakpoints;if(f&&dr(f))for(const[m,h]of Object.entries(f))window.matchMedia(m).matches&&dr(h)&&(c+=m,ft(s,h));c===this.bp&&this.state!==Ge.Init||(this.bp=c,this.state===Ge.Ready&&(s.initialSlide=((a=(n=this.pages[this.page])===null||n===void 0?void 0:n.slides[0])===null||a===void 0?void 0:a.index)||0),this.state!==Ge.Init&&this.destroy(),super.setOptions(s),this.option("enabled")===!1?this.attachEvents():setTimeout(()=>{this.init()},0))}init(){this.state=Ge.Init,this.emit("init"),this.attachPlugins(Object.assign(Object.assign({},an.Plugins),this.userPlugins)),this.emit("attachPlugins"),this.initLayout(),this.initSlides(),this.updateMetrics(),this.setInitialPosition(),this.initPanzoom(),this.attachEvents(),this.state=Ge.Ready,this.emit("ready")}initLayout(){const{container:n}=this,a=this.option("classes");fe(n,this.cn("container")),Dt(n,a.isLTR,!this.isRTL),Dt(n,a.isRTL,this.isRTL),Dt(n,a.isVertical,!this.isHorizontal),Dt(n,a.isHorizontal,this.isHorizontal);let s=this.option("viewport")||n.querySelector(`.${a.viewport}`);s||(s=document.createElement("div"),fe(s,a.viewport),s.append(...da(n,`.${a.slide}`)),n.prepend(s)),s.addEventListener("scroll",this.onScroll);let c=this.option("track")||n.querySelector(`.${a.track}`);c||(c=document.createElement("div"),fe(c,a.track),c.append(...Array.from(s.childNodes))),c.setAttribute("aria-live","polite"),s.contains(c)||s.prepend(c),this.viewport=s,this.track=c,this.emit("initLayout")}initSlides(){const{track:n}=this;if(!n)return;const a=[...this.slides],s=[];[...da(n,`.${this.cn(oi)}`)].forEach(c=>{if(dt(c)){const f=Gi({el:c,isDom:!0,index:this.slides.length});s.push(f)}});for(let c of[...this.option("slides",[])||[],...a])s.push(Gi(c));this.slides=s;for(let c=0;c<this.slides.length;c++)this.slides[c].index=c;for(const c of s)this.emit("beforeInitSlide",c,c.index),this.emit("initSlide",c,c.index);this.emit("initSlides")}setInitialPage(){const n=this.option("initialSlide");this.page=typeof n=="number"?this.getPageForSlide(n):parseInt(this.option("initialPage",0)+"",10)||0}setInitialPosition(){const{track:n,pages:a,isHorizontal:s}=this;if(!n||!a.length)return;let c=this.page;a[c]||(this.page=c=0);const f=(a[c].pos||0)*(this.isRTL&&s?1:-1),m=s?`${f}px`:"0",h=s?"0":`${f}px`;n.style.transform=`translate3d(${m}, ${h}, 0) scale(1)`,this.option("adaptiveHeight")&&this.setViewportHeight()}initPanzoom(){this.panzoom&&(this.panzoom.destroy(),this.panzoom=null);const n=this.option("Panzoom")||{};this.panzoom=new ln(this.viewport,ft({},{content:this.track,zoom:!1,panOnlyZoomed:!1,lockAxis:this.isHorizontal?"x":"y",infinite:this.isInfinite,click:!1,dblClick:!1,touch:a=>!(this.pages.length<2&&!a.options.infinite),bounds:()=>this.getBounds(),maxVelocity:a=>Math.abs(a.target[this.axis]-a.current[this.axis])<2*this.viewportDim?100:0},n)),this.panzoom.on("*",(a,s,...c)=>{this.emit(`Panzoom.${s}`,a,...c)}),this.panzoom.on("decel",this.onDecel),this.panzoom.on("refresh",this.onRefresh),this.panzoom.on("beforeTransform",this.onBeforeTransform),this.panzoom.on("endAnimation",this.onEndAnimation)}attachEvents(){const n=this.container;n&&(n.addEventListener("click",this.onClick,{passive:!1,capture:!1}),n.addEventListener("slideTo",this.onSlideTo)),window.addEventListener("resize",this.onResize)}createPages(){let n=[];const{contentDim:a,viewportDim:s}=this;let c=this.option("slidesPerPage");c=(c==="auto"||a<=s)&&this.option("fill")!==!1?1/0:parseFloat(c+"");let f=0,m=0,h=0;for(const y of this.slides)(!n.length||m+y.dim-s>.05||h>=c)&&(n.push(Ll()),f=n.length-1,m=0,h=0),n[f].slides.push(y),m+=y.dim+y.gap,h++;return n}processPages(){const n=this.pages,{contentDim:a,viewportDim:s,isInfinite:c}=this,f=this.option("center"),m=this.option("fill"),h=m&&f&&a>s&&!c;if(n.forEach((S,d)=>{var u;S.index=d,S.pos=((u=S.slides[0])===null||u===void 0?void 0:u.pos)||0,S.dim=0;for(const[p,g]of S.slides.entries())S.dim+=g.dim,p<S.slides.length-1&&(S.dim+=g.gap);h&&S.pos+.5*S.dim<.5*s?S.pos=0:h&&S.pos+.5*S.dim>=a-.5*s?S.pos=a-s:f&&(S.pos+=-.5*(s-S.dim))}),n.forEach(S=>{m&&!c&&a>s&&(S.pos=Math.max(S.pos,0),S.pos=Math.min(S.pos,a-s)),S.pos=ie(S.pos,1e3),S.dim=ie(S.dim,1e3),Math.abs(S.pos)<=.1&&(S.pos=0)}),c)return n;const y=[];let C;return n.forEach(S=>{const d=Object.assign({},S);C&&d.pos===C.pos?(C.dim+=d.dim,C.slides=[...C.slides,...d.slides]):(d.index=y.length,C=d,y.push(d))}),y}getPageFromIndex(n=0){const a=this.pages.length;let s;return n=parseInt((n||0).toString())||0,s=this.isInfinite?(n%a+a)%a:Math.max(Math.min(n,a-1),0),s}getSlideMetrics(n){var a,s;const c=this.isHorizontal?"width":"height";let f=0,m=0,h=n.el;const y=!(!h||h.parentNode);if(h?f=parseFloat(h.dataset[c]||"")||0:(h=document.createElement("div"),h.style.visibility="hidden",(this.track||document.body).prepend(h)),fe(h,this.cn(oi)+" "+n.class+" "+n.customClass),f)h.style[c]=`${f}px`,h.style[c==="width"?"height":"width"]="";else{y&&(this.track||document.body).prepend(h),f=h.getBoundingClientRect()[c]*Math.max(1,((a=window.visualViewport)===null||a===void 0?void 0:a.scale)||1);let S=h[this.isHorizontal?"offsetWidth":"offsetHeight"];S-1>f&&(f=S)}const C=getComputedStyle(h);return C.boxSizing==="content-box"&&(this.isHorizontal?(f+=parseFloat(C.paddingLeft)||0,f+=parseFloat(C.paddingRight)||0):(f+=parseFloat(C.paddingTop)||0,f+=parseFloat(C.paddingBottom)||0)),m=parseFloat(C[this.isHorizontal?"marginRight":"marginBottom"])||0,y?(s=h.parentElement)===null||s===void 0||s.removeChild(h):n.el||h.remove(),{dim:ie(f,1e3),gap:ie(m,1e3)}}getBounds(){const{isInfinite:n,isRTL:a,isHorizontal:s,pages:c}=this;let f={min:0,max:0};if(n)f={min:-1/0,max:1/0};else if(c.length){const m=c[0].pos,h=c[c.length-1].pos;f=a&&s?{min:m,max:h}:{min:-1*h,max:-1*m}}return{x:s?f:{min:0,max:0},y:s?{min:0,max:0}:f}}repositionSlides(){let n,{isHorizontal:a,isRTL:s,isInfinite:c,viewport:f,viewportDim:m,contentDim:h,page:y,pages:C,slides:S,panzoom:d}=this,u=0,p=0,g=0,E=0;d?E=-1*d.current[this.axis]:C[y]&&(E=C[y].pos||0),n=a?s?"right":"left":"top",s&&a&&(E*=-1);for(const x of S){const A=x.el;A?(n==="top"?(A.style.right="",A.style.left=""):A.style.top="",x.index!==u?A.style[n]=p===0?"":`${ie(p,1e3)}px`:A.style[n]="",g+=x.dim+x.gap,u++):p+=x.dim+x.gap}if(c&&g&&f){let x=getComputedStyle(f),A="padding",v=a?"Right":"Bottom",O=parseFloat(x[A+(a?"Left":"Top")]);E-=O,m+=O,m+=parseFloat(x[A+v]);for(const I of S)I.el&&(ie(I.pos)<ie(m)&&ie(I.pos+I.dim+I.gap)<ie(E)&&ie(E)>ie(h-m)&&(I.el.style[n]=`${ie(p+g,1e3)}px`),ie(I.pos+I.gap)>=ie(h-m)&&ie(I.pos)>ie(E+m)&&ie(E)<ie(m)&&(I.el.style[n]=`-${ie(g,1e3)}px`))}let b,k,M=[...this.inTransition];if(M.length>1&&(b=C[M[0]],k=C[M[1]]),b&&k){let x=0;for(const A of S)A.el?this.inTransition.has(A.index)&&b.slides.indexOf(A)<0&&(A.el.style[n]=`${ie(x+(b.pos-k.pos),1e3)}px`):x+=A.dim+A.gap}}createSlideEl(n){const{track:a,slides:s}=this;if(!a||!n||n.el&&n.el.parentNode)return;const c=n.el||document.createElement("div");fe(c,this.cn(oi)),fe(c,n.class),fe(c,n.customClass);const f=n.html;f&&(f instanceof HTMLElement?c.appendChild(f):c.innerHTML=n.html+"");const m=[];s.forEach((S,d)=>{S.el&&m.push(d)});const h=n.index;let y=null;m.length&&(y=s[m.reduce((S,d)=>Math.abs(d-h)<Math.abs(S-h)?d:S)]);const C=y&&y.el&&y.el.parentNode?y.index<n.index?y.el.nextSibling:y.el:null;a.insertBefore(c,a.contains(C)?C:null),n.el=c,this.emit("createSlide",n)}removeSlideEl(n,a=!1){const s=n==null?void 0:n.el;if(!s||!s.parentNode)return;const c=this.cn(ha);if(s.classList.contains(c)&&(Pe(s,c),this.emit("unselectSlide",n)),n.isDom&&!a)return s.removeAttribute("aria-hidden"),s.removeAttribute("data-index"),void(s.style.left="");this.emit("removeSlide",n);const f=new CustomEvent(ai);s.dispatchEvent(f),n.el&&(n.el.remove(),n.el=null)}transitionTo(n=0,a=this.option("transition")){var s,c,f,m;if(!a)return!1;const h=this.page,{pages:y,panzoom:C}=this;n=parseInt((n||0).toString())||0;const S=this.getPageFromIndex(n);if(!C||!y[S]||y.length<2||Math.abs((((c=(s=y[h])===null||s===void 0?void 0:s.slides[0])===null||c===void 0?void 0:c.dim)||0)-this.viewportDim)>1)return!1;let d=n>h?1:-1;this.isInfinite&&(h===0&&n===y.length-1&&(d=-1),h===y.length-1&&n===0&&(d=1));const u=y[S].pos*(this.isRTL?1:-1);if(h===S&&Math.abs(u-C.target[this.axis])<1)return!1;this.clearTransitions();const p=C.isResting;fe(this.container,this.cn("inTransition"));const g=((f=y[h])===null||f===void 0?void 0:f.slides[0])||null,E=((m=y[S])===null||m===void 0?void 0:m.slides[0])||null;this.inTransition.add(E.index),this.createSlideEl(E);let b=g.el,k=E.el;p||a===oi||(a="fadeFast",b=null);const M=this.isRTL?"next":"prev",x=this.isRTL?"prev":"next";return b&&(this.inTransition.add(g.index),g.transition=a,b.addEventListener(ai,this.onAnimationEnd),b.classList.add(`f-${a}Out`,`to-${d>0?x:M}`)),k&&(E.transition=a,k.addEventListener(ai,this.onAnimationEnd),k.classList.add(`f-${a}In`,`from-${d>0?M:x}`)),C.current[this.axis]=u,C.target[this.axis]=u,C.requestTick(),this.onChange(S),!0}manageSlideVisiblity(){const n=new Set,a=new Set,s=this.getVisibleSlides(parseFloat(this.option("preload",0)+"")||0);for(const c of this.slides)s.has(c)?n.add(c):a.add(c);for(const c of this.inTransition)n.add(this.slides[c]);for(const c of n)this.createSlideEl(c),this.lazyLoadSlide(c);for(const c of a)n.has(c)||this.removeSlideEl(c);this.markSelectedSlides(),this.repositionSlides()}markSelectedSlides(){if(!this.pages[this.page]||!this.pages[this.page].slides)return;const n="aria-hidden";let a=this.cn(ha);if(a)for(const s of this.slides){const c=s.el;c&&(c.dataset.index=`${s.index}`,c.classList.contains("f-thumbs__slide")?this.getVisibleSlides(0).has(s)?c.removeAttribute(n):c.setAttribute(n,"true"):this.pages[this.page].slides.includes(s)?(c.classList.contains(a)||(fe(c,a),this.emit("selectSlide",s)),c.removeAttribute(n)):(c.classList.contains(a)&&(Pe(c,a),this.emit("unselectSlide",s)),c.setAttribute(n,"true")))}}flipInfiniteTrack(){const{axis:n,isHorizontal:a,isInfinite:s,isRTL:c,viewportDim:f,contentDim:m}=this,h=this.panzoom;if(!h||!s)return;let y=h.current[n],C=h.target[n]-y,S=0,d=.5*f;c&&a?(y<-d&&(S=-1,y+=m),y>m-d&&(S=1,y-=m)):(y>d&&(S=1,y-=m),y<-m+d&&(S=-1,y+=m)),S&&(h.current[n]=y,h.target[n]=y+C)}lazyLoadImg(n,a){const s=this,c="f-fadeIn",f="is-preloading";let m=!1,h=null;const y=()=>{m||(m=!0,h&&(h.remove(),h=null),Pe(a,f),a.complete&&(fe(a,c),setTimeout(()=>{Pe(a,c)},350)),this.option("adaptiveHeight")&&n.el&&this.pages[this.page].slides.indexOf(n)>-1&&(s.updateMetrics(),s.setViewportHeight()),this.emit("load",n))};fe(a,f),a.src=a.dataset.lazySrcset||a.dataset.lazySrc||"",delete a.dataset.lazySrc,delete a.dataset.lazySrcset,a.addEventListener("error",()=>{y()}),a.addEventListener("load",()=>{y()}),setTimeout(()=>{const C=a.parentNode;C&&n.el&&(a.complete?y():m||(h=At(vr),C.insertBefore(h,a)))},300)}lazyLoadSlide(n){const a=n&&n.el;if(!a)return;const s=new Set;let c=Array.from(a.querySelectorAll("[data-lazy-src],[data-lazy-srcset]"));a.dataset.lazySrc&&c.push(a),c.map(f=>{f instanceof HTMLImageElement?s.add(f):f instanceof HTMLElement&&f.dataset.lazySrc&&(f.style.backgroundImage=`url('${f.dataset.lazySrc}')`,delete f.dataset.lazySrc)});for(const f of s)this.lazyLoadImg(n,f)}onAnimationEnd(n){var a;const s=n.target,c=s?parseInt(s.dataset.index||"",10)||0:-1,f=this.slides[c],m=n.animationName;if(!s||!f||!m)return;const h=!!this.inTransition.has(c)&&f.transition;h&&m.substring(0,h.length+2)===`f-${h}`&&this.inTransition.delete(c),this.inTransition.size||this.clearTransitions(),c===this.page&&(!((a=this.panzoom)===null||a===void 0)&&a.isResting)&&this.emit("settle")}onDecel(n,a=0,s=0,c=0,f=0){if(this.option("dragFree"))return void this.setPageFromPosition();const{isRTL:m,isHorizontal:h,axis:y,pages:C}=this,S=C.length,d=Math.abs(Math.atan2(s,a)/(Math.PI/180));let u=0;if(u=d>45&&d<135?h?0:s:h?a:0,!S)return;let p=this.page,g=m&&h?1:-1;const E=n.current[y]*g;let{pageIndex:b}=this.getPageFromPosition(E);Math.abs(u)>5?(C[p].dim<document.documentElement["client"+(this.isHorizontal?"Width":"Height")]-1&&(p=b),p=m&&h?u<0?p-1:p+1:u<0?p+1:p-1):p=c===0&&f===0?p:b,this.slideTo(p,{transition:!1,friction:n.option("decelFriction")})}onClick(n){const a=n.target,s=a&&dt(a)?a.dataset:null;let c,f;s&&(s.carouselPage!==void 0?(f="slideTo",c=s.carouselPage):s.carouselNext!==void 0?f="slideNext":s.carouselPrev!==void 0&&(f="slidePrev")),f?(n.preventDefault(),n.stopPropagation(),a&&!a.hasAttribute("disabled")&&this[f](c)):this.emit("click",n)}onSlideTo(n){const a=n.detail||0;this.slideTo(this.getPageForSlide(a),{friction:0})}onChange(n,a=0){const s=this.page;this.prevPage=s,this.page=n,this.option("adaptiveHeight")&&this.setViewportHeight(),n!==s&&(this.markSelectedSlides(),this.emit("change",n,s,a))}onRefresh(){let n=this.contentDim,a=this.viewportDim;this.updateMetrics(),this.contentDim===n&&this.viewportDim===a||this.slideTo(this.page,{friction:0,transition:!1})}onScroll(){var n;(n=this.viewport)===null||n===void 0||n.scroll(0,0)}onResize(){this.option("breakpoints")&&this.processOptions()}onBeforeTransform(n){this.lp!==n.current[this.axis]&&(this.flipInfiniteTrack(),this.manageSlideVisiblity()),this.lp=n.current.e}onEndAnimation(){this.inTransition.size||this.emit("settle")}reInit(n=null,a=null){this.destroy(),this.state=Ge.Init,this.prevPage=null,this.userOptions=n||this.userOptions,this.userPlugins=a||this.userPlugins,this.processOptions()}slideTo(n=0,{friction:a=this.option("friction"),transition:s=this.option("transition")}={}){if(this.state===Ge.Destroy)return;n=parseInt((n||0).toString())||0;const c=this.getPageFromIndex(n),{axis:f,isHorizontal:m,isRTL:h,pages:y,panzoom:C}=this,S=y.length,d=h&&m?1:-1;if(!C||!S)return;if(this.page!==c){const p=new Event("beforeChange",{bubbles:!0,cancelable:!0});if(this.emit("beforeChange",p,n),p.defaultPrevented)return}if(this.transitionTo(n,s))return;let u=y[c].pos;if(this.isInfinite){const p=this.contentDim,g=C.target[f]*d;S===2?u+=p*Math.floor(parseFloat(n+"")/2):u=[u,u-p,u+p].reduce(function(E,b){return Math.abs(b-g)<Math.abs(E-g)?b:E})}u*=d,Math.abs(C.target[f]-u)<1||(C.panTo({x:m?u:0,y:m?0:u,friction:a}),this.onChange(c))}slideToClosest(n){if(this.panzoom){const{pageIndex:a}=this.getPageFromPosition();this.slideTo(a,n)}}slideNext(){this.slideTo(this.page+1)}slidePrev(){this.slideTo(this.page-1)}clearTransitions(){this.inTransition.clear(),Pe(this.container,this.cn("inTransition"));const n=["to-prev","to-next","from-prev","from-next"];for(const a of this.slides){const s=a.el;if(s){s.removeEventListener(ai,this.onAnimationEnd),s.classList.remove(...n);const c=a.transition;c&&s.classList.remove(`f-${c}Out`,`f-${c}In`)}}this.manageSlideVisiblity()}addSlide(n,a){var s,c,f,m;const h=this.panzoom,y=((s=this.pages[this.page])===null||s===void 0?void 0:s.pos)||0,C=((c=this.pages[this.page])===null||c===void 0?void 0:c.dim)||0,S=this.contentDim<this.viewportDim;let d=Array.isArray(a)?a:[a];const u=[];for(const p of d)u.push(Gi(p));this.slides.splice(n,0,...u);for(let p=0;p<this.slides.length;p++)this.slides[p].index=p;for(const p of u)this.emit("beforeInitSlide",p,p.index);if(this.page>=n&&(this.page+=u.length),this.updateMetrics(),h){const p=((f=this.pages[this.page])===null||f===void 0?void 0:f.pos)||0,g=((m=this.pages[this.page])===null||m===void 0?void 0:m.dim)||0,E=this.pages.length||1,b=this.isRTL?C-g:g-C,k=this.isRTL?y-p:p-y;S&&E===1?(n<=this.page&&(h.current[this.axis]-=b,h.target[this.axis]-=b),h.panTo({[this.isHorizontal?"x":"y"]:-1*p})):k&&n<=this.page&&(h.target[this.axis]-=k,h.current[this.axis]-=k,h.requestTick())}for(const p of u)this.emit("initSlide",p,p.index)}prependSlide(n){this.addSlide(0,n)}appendSlide(n){this.addSlide(this.slides.length,n)}removeSlide(n){const a=this.slides.length;n=(n%a+a)%a;const s=this.slides[n];if(s){this.removeSlideEl(s,!0),this.slides.splice(n,1);for(let c=0;c<this.slides.length;c++)this.slides[c].index=c;this.updateMetrics(),this.slideTo(this.page,{friction:0,transition:!1}),this.emit("destroySlide",s)}}updateMetrics(){const{panzoom:n,viewport:a,track:s,slides:c,isHorizontal:f,isInfinite:m}=this;if(!s)return;const h=f?"width":"height",y=f?"offsetWidth":"offsetHeight";if(a){let d=Math.max(a[y],ie(a.getBoundingClientRect()[h],1e3)),u=getComputedStyle(a),p="padding",g=f?"Right":"Bottom";d-=parseFloat(u[p+(f?"Left":"Top")])+parseFloat(u[p+g]),this.viewportDim=d}let C,S=0;for(const[d,u]of c.entries()){let p=0,g=0;!u.el&&C?(p=C.dim,g=C.gap):({dim:p,gap:g}=this.getSlideMetrics(u),C=u),p=ie(p,1e3),g=ie(g,1e3),u.dim=p,u.gap=g,u.pos=S,S+=p,(m||d<c.length-1)&&(S+=g)}S=ie(S,1e3),this.contentDim=S,n&&(n.contentRect[h]=S,n.contentRect[f?"fullWidth":"fullHeight"]=S),this.pages=this.createPages(),this.pages=this.processPages(),this.state===Ge.Init&&this.setInitialPage(),this.page=Math.max(0,Math.min(this.page,this.pages.length-1)),this.manageSlideVisiblity(),this.emit("refresh")}getProgress(n,a=!1,s=!1){n===void 0&&(n=this.page);const c=this,f=c.panzoom,m=c.contentDim,h=c.pages[n]||0;if(!h||!f)return n>this.page?-1:1;let y=-1*f.current.e,C=ie((y-h.pos)/(1*h.dim),1e3),S=C,d=C;this.isInfinite&&s!==!0&&(S=ie((y-h.pos+m)/(1*h.dim),1e3),d=ie((y-h.pos-m)/(1*h.dim),1e3));let u=[C,S,d].reduce(function(p,g){return Math.abs(g)<Math.abs(p)?g:p});return a?u:u>1?1:u<-1?-1:u}setViewportHeight(){const{page:n,pages:a,viewport:s,isHorizontal:c}=this;if(!s||!a[n])return;let f=0;c&&this.track&&(this.track.style.height="auto",a[n].slides.forEach(m=>{m.el&&(f=Math.max(f,m.el.offsetHeight))})),s.style.height=f?`${f}px`:""}getPageForSlide(n){for(const a of this.pages)for(const s of a.slides)if(s.index===n)return a.index;return-1}getVisibleSlides(n=0){var a;const s=new Set;let{panzoom:c,contentDim:f,viewportDim:m,pages:h,page:y}=this;if(m){f=f+((a=this.slides[this.slides.length-1])===null||a===void 0?void 0:a.gap)||0;let C=0;C=c&&c.state!==Re.Init&&c.state!==Re.Destroy?-1*c.current[this.axis]:h[y]&&h[y].pos||0,this.isInfinite&&(C-=Math.floor(C/f)*f),this.isRTL&&this.isHorizontal&&(C*=-1);const S=C-m*n,d=C+m*(n+1),u=this.isInfinite?[-1,0,1]:[0];for(const p of this.slides)for(const g of u){const E=p.pos+g*f,b=E+p.dim+p.gap;E<d&&b>S&&s.add(p)}}return s}getPageFromPosition(n){const{viewportDim:a,contentDim:s,slides:c,pages:f,panzoom:m}=this,h=f.length,y=c.length,C=c[0],S=c[y-1],d=this.option("center");let u=0,p=0,g=0,E=n===void 0?-1*((m==null?void 0:m.target[this.axis])||0):n;d&&(E+=.5*a),this.isInfinite?(E<C.pos-.5*S.gap&&(E-=s,g=-1),E>S.pos+S.dim+.5*S.gap&&(E-=s,g=1)):E=Math.max(C.pos||0,Math.min(E,S.pos));let b=S,k=c.find(M=>{const x=M.pos-.5*b.gap,A=M.pos+M.dim+.5*M.gap;return b=M,E>=x&&E<A});return k||(k=S),p=this.getPageForSlide(k.index),u=p+g*h,{page:u,pageIndex:p}}setPageFromPosition(){const{pageIndex:n}=this.getPageFromPosition();this.onChange(n)}destroy(){if([Ge.Destroy].includes(this.state))return;this.state=Ge.Destroy;const{container:n,viewport:a,track:s,slides:c,panzoom:f}=this,m=this.option("classes");n.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),n.removeEventListener("slideTo",this.onSlideTo),window.removeEventListener("resize",this.onResize),f&&(f.destroy(),this.panzoom=null),c&&c.forEach(y=>{this.removeSlideEl(y)}),this.detachPlugins(),a&&(a.removeEventListener("scroll",this.onScroll),a.offsetParent&&s&&s.offsetParent&&a.replaceWith(...s.childNodes));for(const[y,C]of Object.entries(m))y!=="container"&&C&&n.classList.remove(C);this.track=null,this.viewport=null,this.page=0,this.slides=[];const h=this.events.get("ready");this.events=new Map,h&&this.events.set("ready",h)}}Object.defineProperty(an,"Panzoom",{enumerable:!0,configurable:!0,writable:!0,value:ln}),Object.defineProperty(an,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:_l}),Object.defineProperty(an,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:Dl});const Ya=function(T){if(!dt(T))return 0;const n=window.scrollY,a=window.innerHeight,s=n+a,c=T.getBoundingClientRect(),f=c.y+n,m=c.height,h=f+m;if(n>h||s<f)return 0;if(n<f&&s>h||f<n&&h>s)return 100;let y=m;f<n&&(y-=n-f),h>s&&(y-=h-s);const C=y/a*100;return Math.round(C)},Vn=!(typeof window>"u"||!window.document||!window.document.createElement);let Zi;const Xi=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden]):not(.fancybox-focus-guard)","iframe","object","embed","video","audio","[contenteditable]",'[tabindex]:not([tabindex^="-"]):not([disabled]):not([aria-hidden])'].join(","),pa=T=>{if(T&&Vn){Zi===void 0&&document.createElement("div").focus({get preventScroll(){return Zi=!0,!1}});try{if(Zi)T.focus({preventScroll:!0});else{const n=window.scrollY||document.body.scrollTop,a=window.scrollX||document.body.scrollLeft;T.focus(),document.body.scrollTo({top:n,left:a,behavior:"auto"})}}catch{}}},Ka=()=>{const T=document;let n,a="",s="",c="";return T.fullscreenEnabled?(a="requestFullscreen",s="exitFullscreen",c="fullscreenElement"):T.webkitFullscreenEnabled&&(a="webkitRequestFullscreen",s="webkitExitFullscreen",c="webkitFullscreenElement"),a&&(n={request:function(f=T.documentElement){return a==="webkitRequestFullscreen"?f[a](Element.ALLOW_KEYBOARD_INPUT):f[a]()},exit:function(){return T[c]&&T[s]()},isFullscreen:function(){return T[c]}}),n},fr={animated:!0,autoFocus:!0,backdropClick:"close",Carousel:{classes:{container:"fancybox__carousel",viewport:"fancybox__viewport",track:"fancybox__track",slide:"fancybox__slide"}},closeButton:"auto",closeExisting:!1,commonCaption:!1,compact:()=>window.matchMedia("(max-width: 578px), (max-height: 578px)").matches,contentClick:"toggleZoom",contentDblClick:!1,defaultType:"image",defaultDisplay:"flex",dragToClose:!0,Fullscreen:{autoStart:!1},groupAll:!1,groupAttr:"data-fancybox",hideClass:"f-fadeOut",hideScrollbar:!0,idle:3500,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"prev",ArrowDown:"next",ArrowRight:"next",ArrowLeft:"prev"},l10n:Object.assign(Object.assign({},Va),{CLOSE:"Close",NEXT:"Next",PREV:"Previous",MODAL:"You can close this modal content with the ESC key",ERROR:"Something Went Wrong, Please Try Again Later",IMAGE_ERROR:"Image Not Found",ELEMENT_NOT_FOUND:"HTML Element Not Found",AJAX_NOT_FOUND:"Error Loading AJAX : Not Found",AJAX_FORBIDDEN:"Error Loading AJAX : Forbidden",IFRAME_ERROR:"Error Loading Page",TOGGLE_ZOOM:"Toggle zoom level",TOGGLE_THUMBS:"Toggle thumbnails",TOGGLE_SLIDESHOW:"Toggle slideshow",TOGGLE_FULLSCREEN:"Toggle full-screen mode",DOWNLOAD:"Download"}),parentEl:null,placeFocusBack:!0,showClass:"f-zoomInUp",startIndex:0,tpl:{closeButton:'<button data-fancybox-close class="f-button is-close-btn" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"/></svg></button>',main:`<div class="fancybox__container" role="dialog" aria-modal="true" aria-label="{{MODAL}}" tabindex="-1">
    <div class="fancybox__backdrop"></div>
    <div class="fancybox__carousel"></div>
    <div class="fancybox__footer"></div>
  </div>`},trapFocus:!0,wheel:"zoom"};var et,at;(function(T){T[T.Init=0]="Init",T[T.Ready=1]="Ready",T[T.Closing=2]="Closing",T[T.CustomClosing=3]="CustomClosing",T[T.Destroy=4]="Destroy"})(et||(et={})),function(T){T[T.Loading=0]="Loading",T[T.Opening=1]="Opening",T[T.Ready=2]="Ready",T[T.Closing=3]="Closing"}(at||(at={}));let ma="",Fn=!1,si=!1,nn=null;const Ga=()=>{let T="",n="";const a=Le.getInstance();if(a){const s=a.carousel,c=a.getSlide();if(s&&c){let f=c.slug||void 0,m=c.triggerEl||void 0;n=f||a.option("slug")||"",!n&&m&&m.dataset&&(n=m.dataset.fancybox||""),n&&n!=="true"&&(T="#"+n+(!f&&s.slides.length>1?"-"+(c.index+1):""))}}return{hash:T,slug:n,index:1}},bi=()=>{const T=new URL(document.URL).hash,n=T.slice(1).split("-"),a=n[n.length-1],s=a&&/^\+?\d+$/.test(a)&&parseInt(n.pop()||"1",10)||1;return{hash:T,slug:n.join("-"),index:s}},Za=()=>{const{slug:T,index:n}=bi();if(!T)return;let a=document.querySelector(`[data-slug="${T}"]`);if(a&&a.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})),Le.getInstance())return;const s=document.querySelectorAll(`[data-fancybox="${T}"]`);s.length&&(a=s[n-1],a&&a.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})))},Xa=()=>{if(Le.defaults.Hash===!1)return;const T=Le.getInstance();if((T==null?void 0:T.options.Hash)===!1)return;const{slug:n,index:a}=bi(),{slug:s}=Ga();T&&(n===s?T.jumpTo(a-1):(Fn=!0,T.close())),Za()},Ja=()=>{nn&&clearTimeout(nn),queueMicrotask(()=>{Xa()})},ga=()=>{window.addEventListener("hashchange",Ja,!1),setTimeout(()=>{Xa()},500)};Vn&&(/complete|interactive|loaded/.test(document.readyState)?ga():document.addEventListener("DOMContentLoaded",ga));const li="is-zooming-in";class Qa extends Ct{onCreateSlide(n,a,s){const c=this.instance.optionFor(s,"src")||"";s.el&&s.type==="image"&&typeof c=="string"&&this.setImage(s,c)}onRemoveSlide(n,a,s){s.panzoom&&s.panzoom.destroy(),s.panzoom=void 0,s.imageEl=void 0}onChange(n,a,s,c){Pe(this.instance.container,li);for(const f of a.slides){const m=f.panzoom;m&&f.index!==s&&m.reset(.35)}}onClose(){var n;const a=this.instance,s=a.container,c=a.getSlide();if(!s||!s.parentElement||!c)return;const{el:f,contentEl:m,panzoom:h,thumbElSrc:y}=c;if(!f||!y||!m||!h||h.isContentLoading||h.state===Re.Init||h.state===Re.Destroy)return;h.updateMetrics();let C=this.getZoomInfo(c);if(!C)return;this.instance.state=et.CustomClosing,s.classList.remove(li),s.classList.add("is-zooming-out"),m.style.backgroundImage=`url('${y}')`;const S=s.getBoundingClientRect();(((n=window.visualViewport)===null||n===void 0?void 0:n.scale)||1)===1&&Object.assign(s.style,{position:"absolute",top:`${s.offsetTop+window.scrollY}px`,left:`${s.offsetLeft+window.scrollX}px`,bottom:"auto",right:"auto",width:`${S.width}px`,height:`${S.height}px`,overflow:"hidden"});const{x:d,y:u,scale:p,opacity:g}=C;if(g){const E=((b,k,M,x)=>{const A=k-b,v=x-M;return O=>M+((O-b)/A*v||0)})(h.scale,p,1,0);h.on("afterTransform",()=>{m.style.opacity=E(h.scale)+""})}h.on("endAnimation",()=>{a.destroy()}),h.target.a=p,h.target.b=0,h.target.c=0,h.target.d=p,h.panTo({x:d,y:u,scale:p,friction:g?.2:.33,ignoreBounds:!0}),h.isResting&&a.destroy()}setImage(n,a){const s=this.instance;n.src=a,this.process(n,a).then(c=>{const{contentEl:f,imageEl:m,thumbElSrc:h,el:y}=n;if(s.isClosing()||!f||!m)return;f.offsetHeight;const C=!!s.isOpeningSlide(n)&&this.getZoomInfo(n);if(this.option("protected")&&y){y.addEventListener("contextmenu",u=>{u.preventDefault()});const d=document.createElement("div");fe(d,"fancybox-protected"),f.appendChild(d)}if(h&&C){const d=c.contentRect,u=Math.max(d.fullWidth,d.fullHeight);let p=null;!C.opacity&&u>1200&&(p=document.createElement("img"),fe(p,"fancybox-ghost"),p.src=h,f.appendChild(p));const g=()=>{p&&(fe(p,"f-fadeFastOut"),setTimeout(()=>{p&&(p.remove(),p=null)},200))};(S=h,new Promise((E,b)=>{const k=new Image;k.onload=E,k.onerror=b,k.src=S})).then(()=>{s.hideLoading(n),n.state=at.Opening,this.instance.emit("reveal",n),this.zoomIn(n).then(()=>{g(),this.instance.done(n)},()=>{}),p&&setTimeout(()=>{g()},u>2500?800:200)},()=>{s.hideLoading(n),s.revealContent(n)})}else{const d=this.optionFor(n,"initialSize"),u=this.optionFor(n,"zoom"),p={event:s.prevMouseMoveEvent||s.options.event,friction:u?.12:0};let g=s.optionFor(n,"showClass")||void 0,E=!0;s.isOpeningSlide(n)&&(d==="full"?c.zoomToFull(p):d==="cover"?c.zoomToCover(p):d==="max"?c.zoomToMax(p):E=!1,c.stop("current")),E&&g&&(g=c.isDragging?"f-fadeIn":""),s.hideLoading(n),s.revealContent(n,g)}var S},()=>{s.setError(n,"{{IMAGE_ERROR}}")})}process(n,a){return new Promise((s,c)=>{var f;const m=this.instance,h=n.el;m.clearContent(n),m.showLoading(n);let y=this.optionFor(n,"content");if(typeof y=="string"&&(y=At(y)),!y||!dt(y)){if(y=document.createElement("img"),y instanceof HTMLImageElement){let C="",S=n.caption;C=typeof S=="string"&&S?S.replace(/<[^>]+>/gi,"").substring(0,1e3):`Image ${n.index+1} of ${((f=m.carousel)===null||f===void 0?void 0:f.pages.length)||1}`,y.src=a||"",y.alt=C,y.draggable=!1,n.srcset&&y.setAttribute("srcset",n.srcset),this.instance.isOpeningSlide(n)&&(y.fetchPriority="high")}n.sizes&&y.setAttribute("sizes",n.sizes)}fe(y,"fancybox-image"),n.imageEl=y,m.setContent(n,y,!1),n.panzoom=new ln(h,ft({transformParent:!0},this.option("Panzoom")||{},{content:y,width:(C,S)=>m.optionFor(n,"width","auto",S)||"auto",height:(C,S)=>m.optionFor(n,"height","auto",S)||"auto",wheel:()=>{const C=m.option("wheel");return(C==="zoom"||C=="pan")&&C},click:(C,S)=>{var d,u;if(m.isCompact||m.isClosing()||n.index!==((d=m.getSlide())===null||d===void 0?void 0:d.index))return!1;if(S){const g=S.composedPath()[0];if(["A","BUTTON","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].includes(g.nodeName))return!1}let p=!S||S.target&&((u=n.contentEl)===null||u===void 0?void 0:u.contains(S.target));return m.option(p?"contentClick":"backdropClick")||!1},dblClick:()=>m.isCompact?"toggleZoom":m.option("contentDblClick")||!1,spinner:!1,panOnlyZoomed:!0,wheelLimit:1/0,on:{ready:C=>{s(C)},error:()=>{c()},destroy:()=>{c()}}}))})}zoomIn(n){return new Promise((a,s)=>{const c=this.instance,f=c.container,{panzoom:m,contentEl:h,el:y}=n;m&&m.updateMetrics();const C=this.getZoomInfo(n);if(!(C&&y&&h&&m&&f))return void s();const{x:S,y:d,scale:u,opacity:p}=C,g=()=>{n.state!==at.Closing&&(p&&(h.style.opacity=Math.max(Math.min(1,1-(1-m.scale)/(1-u)),0)+""),m.scale>=1&&m.scale>m.targetScale-.1&&a(m))},E=M=>{(M.scale<.99||M.scale>1.01)&&!M.isDragging||(Pe(f,li),h.style.opacity="",M.off("endAnimation",E),M.off("touchStart",E),M.off("afterTransform",g),a(M))};m.on("endAnimation",E),m.on("touchStart",E),m.on("afterTransform",g),m.on(["error","destroy"],()=>{s()}),m.panTo({x:S,y:d,scale:u,friction:0,ignoreBounds:!0}),m.stop("current");const b={event:m.panMode==="mousemove"?c.prevMouseMoveEvent||c.options.event:void 0},k=this.optionFor(n,"initialSize");fe(f,li),c.hideLoading(n),k==="full"?m.zoomToFull(b):k==="cover"?m.zoomToCover(b):k==="max"?m.zoomToMax(b):m.reset(.172)})}getZoomInfo(n){const{el:a,imageEl:s,thumbEl:c,panzoom:f}=n,m=this.instance,h=m.container;if(!a||!s||!c||!f||Ya(c)<3||!this.optionFor(n,"zoom")||!h||m.state===et.Destroy||getComputedStyle(h).getPropertyValue("--f-images-zoom")==="0")return!1;const y=window.visualViewport||null;if((y?y.scale:1)!==1)return!1;let{top:C,left:S,width:d,height:u}=c.getBoundingClientRect(),{top:p,left:g,fitWidth:E,fitHeight:b}=f.contentRect;if(!(d&&u&&E&&b))return!1;const k=f.container.getBoundingClientRect();g+=k.left,p+=k.top;const M=-1*(g+.5*E-(S+.5*d)),x=-1*(p+.5*b-(C+.5*u)),A=d/E;let v=this.option("zoomOpacity")||!1;return v==="auto"&&(v=Math.abs(d/u-E/b)>.1),{x:M,y:x,scale:A,opacity:v}}attach(){const n=this,a=n.instance;a.on("Carousel.change",n.onChange),a.on("Carousel.createSlide",n.onCreateSlide),a.on("Carousel.removeSlide",n.onRemoveSlide),a.on("close",n.onClose)}detach(){const n=this,a=n.instance;a.off("Carousel.change",n.onChange),a.off("Carousel.createSlide",n.onCreateSlide),a.off("Carousel.removeSlide",n.onRemoveSlide),a.off("close",n.onClose)}}Object.defineProperty(Qa,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{initialSize:"fit",Panzoom:{maxScale:1},protected:!1,zoom:!0,zoomOpacity:"auto"}}),typeof SuppressedError=="function"&&SuppressedError;const Ji="html",va="image",Qi="map",It="youtube",Jt="vimeo",Bn="html5video",ba=(T,n={})=>{const a=new URL(T),s=new URLSearchParams(a.search),c=new URLSearchParams;for(const[h,y]of[...s,...Object.entries(n)]){let C=y+"";if(h==="t"){let S=C.match(/((\d*)m)?(\d*)s?/);S&&c.set("start",60*parseInt(S[2]||"0")+parseInt(S[3]||"0")+"")}else c.set(h,C)}let f=c+"",m=T.match(/#t=((.*)?\d+s)/);return m&&(f+=`#t=${m[1]}`),f},Ol={ajax:null,autoSize:!0,iframeAttr:{allow:"autoplay; fullscreen",scrolling:"auto"},preload:!0,videoAutoplay:!0,videoRatio:16/9,videoTpl:`<video class="fancybox__html5video" playsinline controls controlsList="nodownload" poster="{{poster}}">
  <source src="{{src}}" type="{{format}}" />Sorry, your browser doesn't support embedded videos.</video>`,videoFormat:"",vimeo:{byline:1,color:"00adef",controls:1,dnt:1,muted:0},youtube:{controls:1,enablejsapi:1,nocookie:1,rel:0,fs:1}},Pl=["image","html","ajax","inline","clone","iframe","map","pdf","html5video","youtube","vimeo"];class eo extends Ct{onBeforeInitSlide(n,a,s){this.processType(s)}onCreateSlide(n,a,s){this.setContent(s)}onClearContent(n,a){a.xhr&&(a.xhr.abort(),a.xhr=null);const s=a.iframeEl;s&&(s.onload=s.onerror=null,s.src="//about:blank",a.iframeEl=null);const c=a.contentEl,f=a.placeholderEl;if(a.type==="inline"&&c&&f)c.classList.remove("fancybox__content"),getComputedStyle(c).getPropertyValue("display")!=="none"&&(c.style.display="none"),setTimeout(()=>{f&&(c&&f.parentNode&&f.parentNode.insertBefore(c,f),f.remove())},0),a.contentEl=void 0,a.placeholderEl=void 0;else for(;a.el&&a.el.firstChild;)a.el.removeChild(a.el.firstChild)}onSelectSlide(n,a,s){s.state===at.Ready&&this.playVideo()}onUnselectSlide(n,a,s){var c,f;if(s.type===Bn){try{(f=(c=s.el)===null||c===void 0?void 0:c.querySelector("video"))===null||f===void 0||f.pause()}catch{}return}let m;s.type===Jt?m={method:"pause",value:"true"}:s.type===It&&(m={event:"command",func:"pauseVideo"}),m&&s.iframeEl&&s.iframeEl.contentWindow&&s.iframeEl.contentWindow.postMessage(JSON.stringify(m),"*"),s.poller&&clearTimeout(s.poller)}onDone(n,a){n.isCurrentSlide(a)&&!n.isClosing()&&this.playVideo()}onRefresh(n,a){a.slides.forEach(s=>{s.el&&(this.resizeIframe(s),this.setAspectRatio(s))})}onMessage(n){try{let a=JSON.parse(n.data);if(n.origin==="https://player.vimeo.com"){if(a.event==="ready")for(let s of Array.from(document.getElementsByClassName("fancybox__iframe")))s instanceof HTMLIFrameElement&&s.contentWindow===n.source&&(s.dataset.ready="true")}else if(n.origin.match(/^https:\/\/(www.)?youtube(-nocookie)?.com$/)&&a.event==="onReady"){const s=document.getElementById(a.id);s&&(s.dataset.ready="true")}}catch{}}loadAjaxContent(n){const a=this.instance.optionFor(n,"src")||"";this.instance.showLoading(n);const s=this.instance,c=new XMLHttpRequest;s.showLoading(n),c.onreadystatechange=function(){c.readyState===XMLHttpRequest.DONE&&s.state===et.Ready&&(s.hideLoading(n),c.status===200?s.setContent(n,c.responseText):s.setError(n,c.status===404?"{{AJAX_NOT_FOUND}}":"{{AJAX_FORBIDDEN}}"))};const f=n.ajax||null;c.open(f?"POST":"GET",a+""),c.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),c.setRequestHeader("X-Requested-With","XMLHttpRequest"),c.send(f),n.xhr=c}setInlineContent(n){let a=null;if(dt(n.src))a=n.src;else if(typeof n.src=="string"){const s=n.src.split("#",2).pop();a=s?document.getElementById(s):null}if(a){if(n.type==="clone"||a.closest(".fancybox__slide")){a=a.cloneNode(!0);const s=a.dataset.animationName;s&&(a.classList.remove(s),delete a.dataset.animationName);let c=a.getAttribute("id");c=c?`${c}--clone`:`clone-${this.instance.id}-${n.index}`,a.setAttribute("id",c)}else if(a.parentNode){const s=document.createElement("div");s.classList.add("fancybox-placeholder"),a.parentNode.insertBefore(s,a),n.placeholderEl=s}this.instance.setContent(n,a)}else this.instance.setError(n,"{{ELEMENT_NOT_FOUND}}")}setIframeContent(n){const{src:a,el:s}=n;if(!a||typeof a!="string"||!s)return;s.classList.add("is-loading");const c=this.instance,f=document.createElement("iframe");f.className="fancybox__iframe",f.setAttribute("id",`fancybox__iframe_${c.id}_${n.index}`);for(const[h,y]of Object.entries(this.optionFor(n,"iframeAttr")||{}))f.setAttribute(h,y);f.onerror=()=>{c.setError(n,"{{IFRAME_ERROR}}")},n.iframeEl=f;const m=this.optionFor(n,"preload");if(n.type!=="iframe"||m===!1)return f.setAttribute("src",n.src+""),c.setContent(n,f,!1),this.resizeIframe(n),void c.revealContent(n);c.showLoading(n),f.onload=()=>{if(!f.src.length)return;const h=f.dataset.ready!=="true";f.dataset.ready="true",this.resizeIframe(n),h?c.revealContent(n):c.hideLoading(n)},f.setAttribute("src",a),c.setContent(n,f,!1)}resizeIframe(n){const{type:a,iframeEl:s}=n;if(a===It||a===Jt)return;const c=s==null?void 0:s.parentElement;if(!s||!c)return;let f=n.autoSize;f===void 0&&(f=this.optionFor(n,"autoSize"));let m=n.width||0,h=n.height||0;m&&h&&(f=!1);const y=c&&c.style;if(n.preload!==!1&&f!==!1&&y)try{const C=window.getComputedStyle(c),S=parseFloat(C.paddingLeft)+parseFloat(C.paddingRight),d=parseFloat(C.paddingTop)+parseFloat(C.paddingBottom),u=s.contentWindow;if(u){const p=u.document,g=p.getElementsByTagName(Ji)[0],E=p.body;y.width="",E.style.overflow="hidden",m=m||g.scrollWidth+S,y.width=`${m}px`,E.style.overflow="",y.flex="0 0 auto",y.height=`${E.scrollHeight}px`,h=g.scrollHeight+d}}catch{}if(m||h){const C={flex:"0 1 auto",width:"",height:""};m&&m!=="auto"&&(C.width=`${m}px`),h&&h!=="auto"&&(C.height=`${h}px`),Object.assign(y,C)}}playVideo(){const n=this.instance.getSlide();if(!n)return;const{el:a}=n;if(!a||!a.offsetParent||!this.optionFor(n,"videoAutoplay"))return;if(n.type===Bn)try{const c=a.querySelector("video");if(c){const f=c.play();f!==void 0&&f.then(()=>{}).catch(m=>{c.muted=!0,c.play()})}}catch{}if(n.type!==It&&n.type!==Jt)return;const s=()=>{if(n.iframeEl&&n.iframeEl.contentWindow){let c;if(n.iframeEl.dataset.ready==="true")return c=n.type===It?{event:"command",func:"playVideo"}:{method:"play",value:"true"},c&&n.iframeEl.contentWindow.postMessage(JSON.stringify(c),"*"),void(n.poller=void 0);n.type===It&&(c={event:"listening",id:n.iframeEl.getAttribute("id")},n.iframeEl.contentWindow.postMessage(JSON.stringify(c),"*"))}n.poller=setTimeout(s,250)};s()}processType(n){if(n.html)return n.type=Ji,n.src=n.html,void(n.html="");const a=this.instance.optionFor(n,"src","");if(!a||typeof a!="string")return;let s=n.type,c=null;if(c=a.match(/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(?:watch\?(?:.*&)?v=|v\/|u\/|shorts\/|embed\/?)?(videoseries\?list=(?:.*)|[\w-]{11}|\?listType=(?:.*)&list=(?:.*))(?:.*)/i)){const f=this.optionFor(n,It),{nocookie:m}=f,h=function(d,u){var p={};for(var g in d)Object.prototype.hasOwnProperty.call(d,g)&&u.indexOf(g)<0&&(p[g]=d[g]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function"){var E=0;for(g=Object.getOwnPropertySymbols(d);E<g.length;E++)u.indexOf(g[E])<0&&Object.prototype.propertyIsEnumerable.call(d,g[E])&&(p[g[E]]=d[g[E]])}return p}(f,["nocookie"]),y=`www.youtube${m?"-nocookie":""}.com`,C=ba(a,h),S=encodeURIComponent(c[2]);n.videoId=S,n.src=`https://${y}/embed/${S}?${C}`,n.thumbSrc=n.thumbSrc||`https://i.ytimg.com/vi/${S}/mqdefault.jpg`,s=It}else if(c=a.match(/^.+vimeo.com\/(?:\/)?([\d]+)((\/|\?h=)([a-z0-9]+))?(.*)?/)){const f=ba(a,this.optionFor(n,Jt)),m=encodeURIComponent(c[1]),h=c[4]||"";n.videoId=m,n.src=`https://player.vimeo.com/video/${m}?${h?`h=${h}${f?"&":""}`:""}${f}`,s=Jt}if(!s&&n.triggerEl){const f=n.triggerEl.dataset.type;Pl.includes(f)&&(s=f)}s||typeof a=="string"&&(a.charAt(0)==="#"?s="inline":(c=a.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))?(s=Bn,n.videoFormat=n.videoFormat||"video/"+(c[1]==="ogv"?"ogg":c[1])):a.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?s=va:a.match(/\.(pdf)((\?|#).*)?$/i)&&(s="pdf")),(c=a.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:(?:(?:maps\/(?:place\/(?:.*)\/)?\@(.*),(\d+.?\d+?)z))|(?:\?ll=))(.*)?/i))?(n.src=`https://maps.google.${c[1]}/?ll=${(c[2]?c[2]+"&z="+Math.floor(parseFloat(c[3]))+(c[4]?c[4].replace(/^\//,"&"):""):c[4]+"").replace(/\?/,"&")}&output=${c[4]&&c[4].indexOf("layer=c")>0?"svembed":"embed"}`,s=Qi):(c=a.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:maps\/search\/)(.*)/i))&&(n.src=`https://maps.google.${c[1]}/maps?q=${c[2].replace("query=","q=").replace("api=1","")}&output=embed`,s=Qi),s=s||this.instance.option("defaultType"),n.type=s,s===va&&(n.thumbSrc=n.thumbSrc||n.src)}setContent(n){const a=this.instance.optionFor(n,"src")||"";if(n&&n.type&&a){switch(n.type){case Ji:this.instance.setContent(n,a);break;case Bn:const s=this.option("videoTpl");s&&this.instance.setContent(n,s.replace(/\{\{src\}\}/gi,a+"").replace(/\{\{format\}\}/gi,this.optionFor(n,"videoFormat")||"").replace(/\{\{poster\}\}/gi,n.poster||n.thumbSrc||""));break;case"inline":case"clone":this.setInlineContent(n);break;case"ajax":this.loadAjaxContent(n);break;case"pdf":case Qi:case It:case Jt:n.preload=!1;case"iframe":this.setIframeContent(n)}this.setAspectRatio(n)}}setAspectRatio(n){const a=n.contentEl;if(!(n.el&&a&&n.type&&[It,Jt,Bn].includes(n.type)))return;let s,c=n.width||"auto",f=n.height||"auto";if(c==="auto"||f==="auto"){s=this.optionFor(n,"videoRatio");const C=(s+"").match(/(\d+)\s*\/\s?(\d+)/);s=C&&C.length>2?parseFloat(C[1])/parseFloat(C[2]):parseFloat(s+"")}else c&&f&&(s=c/f);if(!s)return;a.style.aspectRatio="",a.style.width="",a.style.height="",a.offsetHeight;const m=a.getBoundingClientRect(),h=m.width||1,y=m.height||1;a.style.aspectRatio=s+"",s<h/y?(f=f==="auto"?y:Math.min(y,f),a.style.width="auto",a.style.height=`${f}px`):(c=c==="auto"?h:Math.min(h,c),a.style.width=`${c}px`,a.style.height="auto")}attach(){const n=this,a=n.instance;a.on("Carousel.beforeInitSlide",n.onBeforeInitSlide),a.on("Carousel.createSlide",n.onCreateSlide),a.on("Carousel.selectSlide",n.onSelectSlide),a.on("Carousel.unselectSlide",n.onUnselectSlide),a.on("Carousel.Panzoom.refresh",n.onRefresh),a.on("done",n.onDone),a.on("clearContent",n.onClearContent),window.addEventListener("message",n.onMessage)}detach(){const n=this,a=n.instance;a.off("Carousel.beforeInitSlide",n.onBeforeInitSlide),a.off("Carousel.createSlide",n.onCreateSlide),a.off("Carousel.selectSlide",n.onSelectSlide),a.off("Carousel.unselectSlide",n.onUnselectSlide),a.off("Carousel.Panzoom.refresh",n.onRefresh),a.off("done",n.onDone),a.off("clearContent",n.onClearContent),window.removeEventListener("message",n.onMessage)}}Object.defineProperty(eo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Ol});const ci="play",ui="pause",zn="ready";class to extends Ct{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:zn}),Object.defineProperty(this,"inHover",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"progressBar",{enumerable:!0,configurable:!0,writable:!0,value:null})}get isActive(){return this.state!==zn}onReady(n){this.option("autoStart")&&(n.isInfinite||n.page<n.pages.length-1)&&this.start()}onChange(){this.removeProgressBar(),this.pause()}onSettle(){this.resume()}onVisibilityChange(){document.visibilityState==="visible"?this.resume():this.pause()}onMouseEnter(){this.inHover=!0,this.pause()}onMouseLeave(){var n;this.inHover=!1,!((n=this.instance.panzoom)===null||n===void 0)&&n.isResting&&this.resume()}onTimerEnd(){const n=this.instance;this.state==="play"&&(n.isInfinite||n.page!==n.pages.length-1?n.slideNext():n.slideTo(0))}removeProgressBar(){this.progressBar&&(this.progressBar.remove(),this.progressBar=null)}createProgressBar(){var n;if(!this.option("showProgress"))return null;this.removeProgressBar();const a=this.instance,s=((n=a.pages[a.page])===null||n===void 0?void 0:n.slides)||[];let c=this.option("progressParentEl");if(c||(c=(s.length===1?s[0].el:null)||a.viewport),!c)return null;const f=document.createElement("div");return fe(f,"f-progress"),c.prepend(f),this.progressBar=f,f.offsetHeight,f}set(){const n=this,a=n.instance;if(a.pages.length<2||n.timer)return;const s=n.option("timeout");n.state=ci,fe(a.container,"has-autoplay");let c=n.createProgressBar();c&&(c.style.transitionDuration=`${s}ms`,c.style.transform="scaleX(1)"),n.timer=setTimeout(()=>{n.timer=null,n.inHover||n.onTimerEnd()},s),n.emit("set")}clear(){const n=this;n.timer&&(clearTimeout(n.timer),n.timer=null),n.removeProgressBar()}start(){const n=this;if(n.set(),n.state!==zn){if(n.option("pauseOnHover")){const a=n.instance.container;a.addEventListener("mouseenter",n.onMouseEnter,!1),a.addEventListener("mouseleave",n.onMouseLeave,!1)}document.addEventListener("visibilitychange",n.onVisibilityChange,!1),n.emit("start")}}stop(){const n=this,a=n.state,s=n.instance.container;n.clear(),n.state=zn,s.removeEventListener("mouseenter",n.onMouseEnter,!1),s.removeEventListener("mouseleave",n.onMouseLeave,!1),document.removeEventListener("visibilitychange",n.onVisibilityChange,!1),Pe(s,"has-autoplay"),a!==zn&&n.emit("stop")}pause(){const n=this;n.state===ci&&(n.state=ui,n.clear(),n.emit(ui))}resume(){const n=this,a=n.instance;if(a.isInfinite||a.page!==a.pages.length-1)if(n.state!==ci){if(n.state===ui&&!n.inHover){const s=new Event("resume",{bubbles:!0,cancelable:!0});n.emit("resume",s),s.defaultPrevented||n.set()}}else n.set();else n.stop()}toggle(){this.state===ci||this.state===ui?this.stop():this.start()}attach(){const n=this,a=n.instance;a.on("ready",n.onReady),a.on("Panzoom.startAnimation",n.onChange),a.on("Panzoom.endAnimation",n.onSettle),a.on("Panzoom.touchMove",n.onChange)}detach(){const n=this,a=n.instance;a.off("ready",n.onReady),a.off("Panzoom.startAnimation",n.onChange),a.off("Panzoom.endAnimation",n.onSettle),a.off("Panzoom.touchMove",n.onChange),n.stop()}}Object.defineProperty(to,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{autoStart:!0,pauseOnHover:!0,progressParentEl:null,showProgress:!0,timeout:3e3}});class no extends Ct{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null})}onPrepare(n){const a=n.carousel;if(!a)return;const s=n.container;s&&(a.options.Autoplay=ft({autoStart:!1},this.option("Autoplay")||{},{pauseOnHover:!1,timeout:this.option("timeout"),progressParentEl:()=>this.option("progressParentEl")||null,on:{start:()=>{n.emit("startSlideshow")},set:c=>{var f;s.classList.add("has-slideshow"),((f=n.getSlide())===null||f===void 0?void 0:f.state)!==at.Ready&&c.pause()},stop:()=>{s.classList.remove("has-slideshow"),n.isCompact||n.endIdle(),n.emit("endSlideshow")},resume:(c,f)=>{var m,h,y;!f||!f.cancelable||((m=n.getSlide())===null||m===void 0?void 0:m.state)===at.Ready&&(!((y=(h=n.carousel)===null||h===void 0?void 0:h.panzoom)===null||y===void 0)&&y.isResting)||f.preventDefault()}}}),a.attachPlugins({Autoplay:to}),this.ref=a.plugins.Autoplay)}onReady(n){const a=n.carousel,s=this.ref;s&&a&&this.option("playOnStart")&&(a.isInfinite||a.page<a.pages.length-1)&&s.start()}onDone(n,a){const s=this.ref,c=n.carousel;if(!s||!c)return;const f=a.panzoom;f&&f.on("startAnimation",()=>{n.isCurrentSlide(a)&&s.stop()}),n.isCurrentSlide(a)&&s.resume()}onKeydown(n,a){var s;const c=this.ref;c&&a===this.option("key")&&((s=document.activeElement)===null||s===void 0?void 0:s.nodeName)!=="BUTTON"&&c.toggle()}attach(){const n=this,a=n.instance;a.on("Carousel.init",n.onPrepare),a.on("Carousel.ready",n.onReady),a.on("done",n.onDone),a.on("keydown",n.onKeydown)}detach(){const n=this,a=n.instance;a.off("Carousel.init",n.onPrepare),a.off("Carousel.ready",n.onReady),a.off("done",n.onDone),a.off("keydown",n.onKeydown)}}Object.defineProperty(no,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{key:" ",playOnStart:!1,progressParentEl:T=>{var n;return((n=T.instance.container)===null||n===void 0?void 0:n.querySelector(".fancybox__toolbar [data-fancybox-toggle-slideshow]"))||T.instance.container},timeout:3e3}});const io={classes:{container:"f-thumbs f-carousel__thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide",isResting:"is-resting",isSelected:"is-selected",isLoading:"is-loading",hasThumbs:"has-thumbs"},minCount:2,parentEl:null,thumbTpl:'<button class="f-thumbs__slide__button" tabindex="0" type="button" aria-label="{{GOTO}}" data-carousel-index="%i"><img class="f-thumbs__slide__img" data-lazy-src="{{%s}}" alt="" /></button>',type:"modern"};var Nt;(function(T){T[T.Init=0]="Init",T[T.Ready=1]="Ready",T[T.Hidden=2]="Hidden"})(Nt||(Nt={}));const ya="isResting",di="thumbWidth",En="thumbHeight",xt="thumbClipWidth";let ro=class extends Ct{constructor(){super(...arguments),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"modern"}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"thumbWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbClipWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbExtraGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Nt.Init})}get isModern(){return this.type==="modern"}onInitSlide(T,n){const a=n.el?n.el.dataset:void 0;a&&(n.thumbSrc=a.thumbSrc||n.thumbSrc||"",n[xt]=parseFloat(a[xt]||"")||n[xt]||0,n[En]=parseFloat(a.thumbHeight||"")||n[En]||0),this.addSlide(n)}onInitSlides(){this.build()}onChange(){var T;if(!this.isModern)return;const n=this.container,a=this.instance,s=a.panzoom,c=this.carousel,f=c?c.panzoom:null,m=a.page;if(s&&c&&f){if(s.isDragging){Pe(n,this.cn(ya));let h=((T=c.pages[m])===null||T===void 0?void 0:T.pos)||0;h+=a.getProgress(m)*(this[xt]+this.thumbGap);let y=f.getBounds();-1*h>y.x.min&&-1*h<y.x.max&&f.panTo({x:-1*h,friction:.12})}else Dt(n,this.cn(ya),s.isResting);this.shiftModern()}}onRefresh(){this.updateProps();for(const T of this.instance.slides||[])this.resizeModernSlide(T);this.shiftModern()}isDisabled(){const T=this.option("minCount")||0;if(T){const a=this.instance;let s=0;for(const c of a.slides||[])c.thumbSrc&&s++;if(s<T)return!0}const n=this.option("type");return["modern","classic"].indexOf(n)<0}getThumb(T){const n=this.option("thumbTpl")||"";return{html:this.instance.localize(n,[["%i",T.index],["%d",T.index+1],["%s",T.thumbSrc||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"]])}}addSlide(T){const n=this.carousel;n&&n.addSlide(T.index,this.getThumb(T))}getSlides(){const T=[];for(const n of this.instance.slides||[])T.push(this.getThumb(n));return T}resizeModernSlide(T){this.isModern&&(T[di]=T[xt]&&T[En]?Math.round(this[En]*(T[xt]/T[En])):this[di])}updateProps(){const T=this.container;if(!T)return;const n=a=>parseFloat(getComputedStyle(T).getPropertyValue("--f-thumb-"+a))||0;this.thumbGap=n("gap"),this.thumbExtraGap=n("extra-gap"),this[di]=n("width")||40,this[xt]=n("clip-width")||40,this[En]=n("height")||40}build(){const T=this;if(T.state!==Nt.Init)return;if(T.isDisabled())return void T.emit("disabled");const n=T.instance,a=n.container,s=T.getSlides(),c=T.option("type");T.type=c;const f=T.option("parentEl"),m=T.cn("container"),h=T.cn("track");let y=f==null?void 0:f.querySelector("."+m);y||(y=document.createElement("div"),fe(y,m),f?f.appendChild(y):a.after(y)),fe(y,`is-${c}`),fe(a,T.cn("hasThumbs")),T.container=y,T.updateProps();let C=y.querySelector("."+h);C||(C=document.createElement("div"),fe(C,T.cn("track")),y.appendChild(C)),T.track=C;const S=ft({},{track:C,infinite:!1,center:!0,fill:c==="classic",dragFree:!0,slidesPerPage:1,transition:!1,preload:.25,friction:.12,Panzoom:{maxVelocity:0},Dots:!1,Navigation:!1,classes:{container:"f-thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide"}},T.option("Carousel")||{},{Sync:{target:n},slides:s}),d=new n.constructor(y,S);d.on("createSlide",(u,p)=>{T.setProps(p.index),T.emit("createSlide",p,p.el)}),d.on("ready",()=>{T.shiftModern(),T.emit("ready")}),d.on("refresh",()=>{T.shiftModern()}),d.on("Panzoom.click",(u,p,g)=>{T.onClick(g)}),T.carousel=d,T.state=Nt.Ready}onClick(T){T.preventDefault(),T.stopPropagation();const n=this.instance,{pages:a,page:s}=n,c=E=>{if(E){const b=E.closest("[data-carousel-index]");if(b)return[parseInt(b.dataset.carouselIndex||"",10)||0,b]}return[-1,void 0]},f=(E,b)=>{const k=document.elementFromPoint(E,b);return k?c(k):[-1,void 0]};let[m,h]=c(T.target);if(m>-1)return;const y=this[xt],C=T.clientX,S=T.clientY;let[d,u]=f(C-y,S),[p,g]=f(C+y,S);u&&g?(m=Math.abs(C-u.getBoundingClientRect().right)<Math.abs(C-g.getBoundingClientRect().left)?d:p,m===s&&(m=m===d?p:d)):u?m=d:g&&(m=p),m>-1&&a[m]&&n.slideTo(m)}getShift(T){var n;const a=this,{instance:s}=a,c=a.carousel;if(!s||!c)return 0;const f=a[di],m=a[xt],h=a.thumbGap,y=a.thumbExtraGap;if(!(!((n=c.slides[T])===null||n===void 0)&&n.el))return 0;const C=.5*(f-m),S=s.pages.length-1;let d=s.getProgress(0),u=s.getProgress(S),p=s.getProgress(T,!1,!0),g=0,E=C+y+h;const b=d<0&&d>-1,k=u>0&&u<1;return T===0?(g=E*Math.abs(d),k&&d===1&&(g-=E*Math.abs(u))):T===S?(g=E*Math.abs(u)*-1,b&&u===-1&&(g+=E*Math.abs(d))):b||k?(g=-1*E,g+=E*Math.abs(d),g+=E*(1-Math.abs(u))):g=E*p,g}setProps(T){var n;const a=this;if(!a.isModern)return;const{instance:s}=a,c=a.carousel;if(s&&c){const f=(n=c.slides[T])===null||n===void 0?void 0:n.el;if(f&&f.childNodes.length){let m=ie(1-Math.abs(s.getProgress(T))),h=ie(a.getShift(T));f.style.setProperty("--progress",m?m+"":""),f.style.setProperty("--shift",h+"")}}}shiftModern(){const T=this;if(!T.isModern)return;const{instance:n,track:a}=T,s=n.panzoom,c=T.carousel;if(!(n&&a&&s&&c)||s.state===Re.Init||s.state===Re.Destroy)return;for(const m of n.slides)T.setProps(m.index);let f=(T[xt]+T.thumbGap)*(c.slides.length||0);a.style.setProperty("--width",f+"")}cleanup(){const T=this;T.carousel&&T.carousel.destroy(),T.carousel=null,T.container&&T.container.remove(),T.container=null,T.track&&T.track.remove(),T.track=null,T.state=Nt.Init,Pe(T.instance.container,T.cn("hasThumbs"))}attach(){const T=this,n=T.instance;n.on("initSlide",T.onInitSlide),n.state===Ge.Init?n.on("initSlides",T.onInitSlides):T.onInitSlides(),n.on(["change","Panzoom.afterTransform"],T.onChange),n.on("Panzoom.refresh",T.onRefresh)}detach(){const T=this,n=T.instance;n.off("initSlide",T.onInitSlide),n.off("initSlides",T.onInitSlides),n.off(["change","Panzoom.afterTransform"],T.onChange),n.off("Panzoom.refresh",T.onRefresh),T.cleanup()}};Object.defineProperty(ro,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:io});const Rl=Object.assign(Object.assign({},io),{key:"t",showOnStart:!0,parentEl:null}),wa="is-masked",Ea="aria-hidden";class ao extends Ct{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hidden",{enumerable:!0,configurable:!0,writable:!0,value:!1})}get isEnabled(){const n=this.ref;return n&&!n.isDisabled()}get isHidden(){return this.hidden}onClick(n,a){a.stopPropagation()}onCreateSlide(n,a){var s,c,f;const m=((f=(c=(s=this.instance)===null||s===void 0?void 0:s.carousel)===null||c===void 0?void 0:c.slides[a.index])===null||f===void 0?void 0:f.type)||"",h=a.el;if(h&&m){let y=`for-${m}`;["video","youtube","vimeo","html5video"].includes(m)&&(y+=" for-video"),fe(h,y)}}onInit(){var n;const a=this,s=a.instance,c=s.carousel;if(a.ref||!c)return;const f=a.option("parentEl")||s.footer||s.container;if(!f)return;const m=ft({},a.options,{parentEl:f,classes:{container:"f-thumbs fancybox__thumbs"},Carousel:{Sync:{friction:s.option("Carousel.friction")||0}},on:{ready:h=>{const y=h.container;y&&this.hidden&&(a.refresh(),y.style.transition="none",a.hide(),y.offsetHeight,queueMicrotask(()=>{y.style.transition="",a.show()}))}}});m.Carousel=m.Carousel||{},m.Carousel.on=ft(((n=a.options.Carousel)===null||n===void 0?void 0:n.on)||{},{click:this.onClick,createSlide:this.onCreateSlide}),c.options.Thumbs=m,c.attachPlugins({Thumbs:ro}),a.ref=c.plugins.Thumbs,a.option("showOnStart")||(a.ref.state=Nt.Hidden,a.hidden=!0)}onResize(){var n;const a=(n=this.ref)===null||n===void 0?void 0:n.container;a&&(a.style.maxHeight="")}onKeydown(n,a){const s=this.option("key");s&&s===a&&this.toggle()}toggle(){const n=this.ref;if(n&&!n.isDisabled())return n.state===Nt.Hidden?(n.state=Nt.Init,void n.build()):void(this.hidden?this.show():this.hide())}show(){const n=this.ref;if(!n||n.isDisabled())return;const a=n.container;a&&(this.refresh(),a.offsetHeight,a.removeAttribute(Ea),a.classList.remove(wa),this.hidden=!1)}hide(){const n=this.ref,a=n&&n.container;a&&(this.refresh(),a.offsetHeight,a.classList.add(wa),a.setAttribute(Ea,"true")),this.hidden=!0}refresh(){const n=this.ref;if(!n||!n.state)return;const a=n.container,s=(a==null?void 0:a.firstChild)||null;a&&s&&s.childNodes.length&&(a.style.maxHeight=`${s.getBoundingClientRect().height}px`)}attach(){const n=this,a=n.instance;a.state===et.Init?a.on("Carousel.init",n.onInit):n.onInit(),a.on("resize",n.onResize),a.on("keydown",n.onKeydown)}detach(){var n;const a=this,s=a.instance;s.off("Carousel.init",a.onInit),s.off("resize",a.onResize),s.off("keydown",a.onKeydown),(n=s.carousel)===null||n===void 0||n.detachPlugins(["Thumbs"]),a.ref=null}}Object.defineProperty(ao,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Rl});const er={panLeft:{icon:'<svg><path d="M5 12h14M5 12l6 6M5 12l6-6"/></svg>',change:{panX:-100}},panRight:{icon:'<svg><path d="M5 12h14M13 18l6-6M13 6l6 6"/></svg>',change:{panX:100}},panUp:{icon:'<svg><path d="M12 5v14M18 11l-6-6M6 11l6-6"/></svg>',change:{panY:-100}},panDown:{icon:'<svg><path d="M12 5v14M18 13l-6 6M6 13l6 6"/></svg>',change:{panY:100}},zoomIn:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M11 8v6M8 11h6"/></svg>',action:"zoomIn"},zoomOut:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"zoomOut"},toggle1to1:{icon:'<svg><path d="M3.51 3.07c5.74.02 11.48-.02 17.22.02 1.37.1 2.34 1.64 2.18 3.13 0 4.08.02 8.16 0 12.23-.1 1.54-1.47 2.64-2.79 2.46-5.61-.01-11.24.02-16.86-.01-1.36-.12-2.33-1.65-2.17-3.14 0-4.07-.02-8.16 0-12.23.1-1.36 1.22-2.48 2.42-2.46Z"/><path d="M5.65 8.54h1.49v6.92m8.94-6.92h1.49v6.92M11.5 9.4v.02m0 5.18v0"/></svg>',action:"toggleZoom"},toggleZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"toggleZoom"},iterateZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"iterateZoom"},rotateCCW:{icon:'<svg><path d="M15 4.55a8 8 0 0 0-6 14.9M9 15v5H4M18.37 7.16v.01M13 19.94v.01M16.84 18.37v.01M19.37 15.1v.01M19.94 11v.01"/></svg>',action:"rotateCCW"},rotateCW:{icon:'<svg><path d="M9 4.55a8 8 0 0 1 6 14.9M15 15v5h5M5.63 7.16v.01M4.06 11v.01M4.63 15.1v.01M7.16 18.37v.01M11 19.94v.01"/></svg>',action:"rotateCW"},flipX:{icon:'<svg style="stroke-width: 1.3"><path d="M12 3v18M16 7v10h5L16 7M8 7v10H3L8 7"/></svg>',action:"flipX"},flipY:{icon:'<svg style="stroke-width: 1.3"><path d="M3 12h18M7 16h10L7 21v-5M7 8h10L7 3v5"/></svg>',action:"flipY"},fitX:{icon:'<svg><path d="M4 12V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v6M10 18H3M21 18h-7M6 15l-3 3 3 3M18 15l3 3-3 3"/></svg>',action:"fitX"},fitY:{icon:'<svg><path d="M12 20H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M18 14v7M18 3v7M15 18l3 3 3-3M15 6l3-3 3 3"/></svg>',action:"fitY"},reset:{icon:'<svg><path d="M20 11A8.1 8.1 0 0 0 4.5 9M4 5v4h4M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"/></svg>',action:"reset"},toggleFS:{icon:'<svg><g><path d="M14.5 9.5 21 3m0 0h-6m6 0v6M3 21l6.5-6.5M3 21v-6m0 6h6"/></g><g><path d="m14 10 7-7m-7 7h6m-6 0V4M3 21l7-7m0 0v6m0-6H4"/></g></svg>',action:"toggleFS"}};var rn;(function(T){T[T.Init=0]="Init",T[T.Ready=1]="Ready",T[T.Disabled=2]="Disabled"})(rn||(rn={}));const Hl={absolute:"auto",display:{left:["infobar"],middle:[],right:["iterateZoom","slideshow","fullscreen","thumbs","close"]},enabled:"auto",items:{infobar:{tpl:'<div class="fancybox__infobar" tabindex="-1"><span data-fancybox-current-index></span>/<span data-fancybox-count></span></div>'},download:{tpl:'<a class="f-button" title="{{DOWNLOAD}}" data-fancybox-download href="javasript:;"><svg><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2M7 11l5 5 5-5M12 4v12"/></svg></a>'},prev:{tpl:'<button class="f-button" title="{{PREV}}" data-fancybox-prev><svg><path d="m15 6-6 6 6 6"/></svg></button>'},next:{tpl:'<button class="f-button" title="{{NEXT}}" data-fancybox-next><svg><path d="m9 6 6 6-6 6"/></svg></button>'},slideshow:{tpl:'<button class="f-button" title="{{TOGGLE_SLIDESHOW}}" data-fancybox-toggle-slideshow><svg><g><path d="M8 4v16l13 -8z"></path></g><g><path d="M8 4v15M17 4v15"/></g></svg></button>'},fullscreen:{tpl:'<button class="f-button" title="{{TOGGLE_FULLSCREEN}}" data-fancybox-toggle-fullscreen><svg><g><path d="M4 8V6a2 2 0 0 1 2-2h2M4 16v2a2 2 0 0 0 2 2h2M16 4h2a2 2 0 0 1 2 2v2M16 20h2a2 2 0 0 0 2-2v-2"/></g><g><path d="M15 19v-2a2 2 0 0 1 2-2h2M15 5v2a2 2 0 0 0 2 2h2M5 15h2a2 2 0 0 1 2 2v2M5 9h2a2 2 0 0 0 2-2V5"/></g></svg></button>'},thumbs:{tpl:'<button class="f-button" title="{{TOGGLE_THUMBS}}" data-fancybox-toggle-thumbs><svg><circle cx="5.5" cy="5.5" r="1"/><circle cx="12" cy="5.5" r="1"/><circle cx="18.5" cy="5.5" r="1"/><circle cx="5.5" cy="12" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="18.5" cy="12" r="1"/><circle cx="5.5" cy="18.5" r="1"/><circle cx="12" cy="18.5" r="1"/><circle cx="18.5" cy="18.5" r="1"/></svg></button>'},close:{tpl:'<button class="f-button" title="{{CLOSE}}" data-fancybox-close><svg><path d="m19.5 4.5-15 15M4.5 4.5l15 15"/></svg></button>'}},parentEl:null},Il={tabindex:"-1",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Sa="has-toolbar",tr="fancybox__toolbar";class oo extends Ct{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:rn.Init}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null})}onReady(n){var a;if(!n.carousel)return;let s=this.option("display"),c=this.option("absolute"),f=this.option("enabled");if(f==="auto"){const C=this.instance.carousel;let S=0;if(C)for(const d of C.slides)(d.panzoom||d.type==="image")&&S++;S||(f=!1)}f||(s=void 0);let m=0;const h={left:[],middle:[],right:[]};if(s)for(const C of["left","middle","right"])for(const S of s[C]){const d=this.createEl(S);d&&((a=h[C])===null||a===void 0||a.push(d),m++)}let y=null;if(m&&(y=this.createContainer()),y){for(const[C,S]of Object.entries(h)){const d=document.createElement("div");fe(d,tr+"__column is-"+C);for(const u of S)d.appendChild(u);c!=="auto"||C!=="middle"||S.length||(c=!0),y.appendChild(d)}c===!0&&fe(y,"is-absolute"),this.state=rn.Ready,this.onRefresh()}else this.state=rn.Disabled}onClick(n){var a,s;const c=this.instance,f=c.getSlide(),m=f==null?void 0:f.panzoom,h=n.target,y=h&&dt(h)?h.dataset:null;if(!y)return;if(y.fancyboxToggleThumbs!==void 0)return n.preventDefault(),n.stopPropagation(),void((a=c.plugins.Thumbs)===null||a===void 0||a.toggle());if(y.fancyboxToggleFullscreen!==void 0)return n.preventDefault(),n.stopPropagation(),void this.instance.toggleFullscreen();if(y.fancyboxToggleSlideshow!==void 0){n.preventDefault(),n.stopPropagation();const d=(s=c.carousel)===null||s===void 0?void 0:s.plugins.Autoplay;let u=d.isActive;return m&&m.panMode==="mousemove"&&!u&&m.reset(),void(u?d.stop():d.start())}const C=y.panzoomAction,S=y.panzoomChange;if((S||C)&&(n.preventDefault(),n.stopPropagation()),S){let d={};try{d=JSON.parse(S)}catch{}m&&m.applyChange(d)}else C&&m&&m[C]&&m[C]()}onChange(){this.onRefresh()}onRefresh(){if(this.instance.isClosing())return;const n=this.container;if(!n)return;const a=this.instance.getSlide();if(!a||a.state!==at.Ready)return;const s=a&&!a.error&&a.panzoom;for(const m of n.querySelectorAll("[data-panzoom-action]"))s?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));let c=s&&s.canZoomIn(),f=s&&s.canZoomOut();for(const m of n.querySelectorAll('[data-panzoom-action="zoomIn"]'))c?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of n.querySelectorAll('[data-panzoom-action="zoomOut"]'))f?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of n.querySelectorAll('[data-panzoom-action="toggleZoom"],[data-panzoom-action="iterateZoom"]')){f||c?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));const h=m.querySelector("g");h&&(h.style.display=c?"":"none")}}onDone(n,a){var s;(s=a.panzoom)===null||s===void 0||s.on("afterTransform",()=>{this.instance.isCurrentSlide(a)&&this.onRefresh()}),this.instance.isCurrentSlide(a)&&this.onRefresh()}createContainer(){const n=this.instance.container;if(!n)return null;const a=this.option("parentEl")||n;let s=a.querySelector("."+tr);return s||(s=document.createElement("div"),fe(s,tr),a.prepend(s)),s.addEventListener("click",this.onClick,{passive:!1,capture:!0}),n&&fe(n,Sa),this.container=s,s}createEl(n){const a=this.instance,s=a.carousel;if(!s||n==="toggleFS"||n==="fullscreen"&&!Ka())return null;let c=null;const f=s.slides.length||0;let m=0,h=0;for(const C of s.slides)(C.panzoom||C.type==="image")&&m++,(C.type==="image"||C.downloadSrc)&&h++;if(f<2&&["infobar","prev","next"].includes(n))return c;if(er[n]!==void 0&&!m||n==="download"&&!h)return null;if(n==="thumbs"){const C=a.plugins.Thumbs;if(!C||!C.isEnabled)return null}if(n==="slideshow"&&(!s.plugins.Autoplay||f<2))return null;if(er[n]!==void 0){const C=er[n];c=document.createElement("button"),c.setAttribute("title",this.instance.localize(`{{${n.toUpperCase()}}}`)),fe(c,"f-button"),C.action&&(c.dataset.panzoomAction=C.action),C.change&&(c.dataset.panzoomChange=JSON.stringify(C.change)),c.appendChild(At(this.instance.localize(C.icon)))}else{const C=(this.option("items")||[])[n];C&&(c=At(this.instance.localize(C.tpl)),typeof C.click=="function"&&c.addEventListener("click",S=>{S.preventDefault(),S.stopPropagation(),typeof C.click=="function"&&C.click.call(this,this,S)}))}const y=c==null?void 0:c.querySelector("svg");if(y)for(const[C,S]of Object.entries(Il))y.getAttribute(C)||y.setAttribute(C,String(S));return c}removeContainer(){const n=this.container;n&&n.remove(),this.container=null,this.state=rn.Disabled;const a=this.instance.container;a&&Pe(a,Sa)}attach(){const n=this,a=n.instance;a.on("Carousel.initSlides",n.onReady),a.on("done",n.onDone),a.on(["reveal","Carousel.change"],n.onChange),n.onReady(n.instance)}detach(){const n=this,a=n.instance;a.off("Carousel.initSlides",n.onReady),a.off("done",n.onDone),a.off(["reveal","Carousel.change"],n.onChange),n.removeContainer()}}Object.defineProperty(oo,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Hl});const Nl={Hash:class extends Ct{onReady(){Fn=!1}onChange(T){nn&&clearTimeout(nn);const{hash:n}=Ga(),{hash:a}=bi(),s=T.isOpeningSlide(T.getSlide());s&&(ma=a===n?"":a),n&&n!==a&&(nn=setTimeout(()=>{try{if(T.state===et.Ready){let c="replaceState";s&&!si&&(c="pushState",si=!0),window.history[c]({},document.title,window.location.pathname+window.location.search+n)}}catch{}},300))}onClose(T){if(nn&&clearTimeout(nn),!Fn&&si)return si=!1,Fn=!1,void window.history.back();if(!Fn)try{window.history.replaceState({},document.title,window.location.pathname+window.location.search+(ma||""))}catch{}}attach(){const T=this.instance;T.on("ready",this.onReady),T.on(["Carousel.ready","Carousel.change"],this.onChange),T.on("close",this.onClose)}detach(){const T=this.instance;T.off("ready",this.onReady),T.off(["Carousel.ready","Carousel.change"],this.onChange),T.off("close",this.onClose)}static parseURL(){return bi()}static startFromUrl(){Za()}static destroy(){window.removeEventListener("hashchange",Ja,!1)}},Html:eo,Images:Qa,Slideshow:no,Thumbs:ao,Toolbar:oo},Ca="with-fancybox",nr="hide-scrollbar",Ta="--fancybox-scrollbar-compensate",ka="--fancybox-body-margin",ir="aria-hidden",rr="is-using-tab",ar="is-animated",Ma="is-compact",xa="is-loading",or="is-opening",fi="has-caption",Sn="disabled",Qt="tabindex",_a="download",sr="href",Cn="src",qt=T=>typeof T=="string",La=function(){var T=window.getSelection();return!!T&&T.type==="Range"};let yt,wt=null,en=null,Aa=0,Da=0,Oa=0,Pa=0;const Tn=new Map;let jl=0;class Le extends gr{get isIdle(){return this.idle}get isCompact(){return this.option("compact")}constructor(n=[],a={},s={}){super(a),Object.defineProperty(this,"userSlides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"idle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"idleTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"ignoreFocusChange",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"startedFs",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:et.Init}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"footer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"lastFocus",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prevMouseMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),yt||(yt=Ka()),this.id=a.id||++jl,Tn.set(this.id,this),this.userSlides=n,this.userPlugins=s,queueMicrotask(()=>{this.init()})}init(){if(this.state===et.Destroy)return;this.state=et.Init,this.attachPlugins(Object.assign(Object.assign({},Le.Plugins),this.userPlugins)),this.emit("init"),this.emit("attachPlugins"),this.option("hideScrollbar")===!0&&(()=>{if(!Vn)return;const a=document,s=a.body,c=a.documentElement;if(s.classList.contains(nr))return;let f=window.innerWidth-c.getBoundingClientRect().width;const m=parseFloat(window.getComputedStyle(s).marginRight);f<0&&(f=0),c.style.setProperty(Ta,`${f}px`),m&&s.style.setProperty(ka,`${m}px`),s.classList.add(nr)})(),this.initLayout(),this.scale();const n=()=>{this.initCarousel(this.userSlides),this.state=et.Ready,this.attachEvents(),this.emit("ready"),setTimeout(()=>{this.container&&this.container.setAttribute(ir,"false")},16)};this.option("Fullscreen.autoStart")&&yt&&!yt.isFullscreen()?yt.request().then(()=>{this.startedFs=!0,n()}).catch(()=>n()):n()}initLayout(){var n,a;const s=this.option("parentEl")||document.body,c=At(this.localize(this.option("tpl.main")||""));if(c){if(c.setAttribute("id",`fancybox-${this.id}`),c.setAttribute("aria-label",this.localize("{{MODAL}}")),c.classList.toggle(Ma,this.isCompact),fe(c,this.option("mainClass")||""),fe(c,or),this.container=c,this.footer=c.querySelector(".fancybox__footer"),s.appendChild(c),fe(document.documentElement,Ca),wt&&en||(wt=document.createElement("span"),fe(wt,"fancybox-focus-guard"),wt.setAttribute(Qt,"0"),wt.setAttribute(ir,"true"),wt.setAttribute("aria-label","Focus guard"),en=wt.cloneNode(),(n=c.parentElement)===null||n===void 0||n.insertBefore(wt,c),(a=c.parentElement)===null||a===void 0||a.append(en)),c.addEventListener("mousedown",f=>{Aa=f.pageX,Da=f.pageY,Pe(c,rr)}),this.option("closeExisting"))for(const f of Tn.values())f.id!==this.id&&f.close();else this.option("animated")&&(fe(c,ar),setTimeout(()=>{this.isClosing()||Pe(c,ar)},350));this.emit("initLayout")}}initCarousel(n){const a=this.container;if(!a)return;const s=a.querySelector(".fancybox__carousel");if(!s)return;const c=this.carousel=new an(s,ft({},{slides:n,transition:"fade",Panzoom:{lockAxis:this.option("dragToClose")?"xy":"x",infinite:!!this.option("dragToClose")&&"y"},Dots:!1,Navigation:{classes:{container:"fancybox__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"}},initialPage:this.option("startIndex"),l10n:this.option("l10n")},this.option("Carousel")||{}));c.on("*",(f,m,...h)=>{this.emit(`Carousel.${m}`,f,...h)}),c.on(["ready","change"],()=>{this.manageCaption()}),this.on("Carousel.removeSlide",(f,m,h)=>{this.clearContent(h),h.state=void 0}),c.on("Panzoom.touchStart",()=>{var f,m;this.isCompact||this.endIdle(),!((f=document.activeElement)===null||f===void 0)&&f.closest(".f-thumbs")&&((m=this.container)===null||m===void 0||m.focus())}),c.on("settle",()=>{this.idleTimer||this.isCompact||!this.option("idle")||this.setIdle(),this.option("autoFocus")&&!this.isClosing&&this.checkFocus()}),this.option("dragToClose")&&(c.on("Panzoom.afterTransform",(f,m)=>{const h=this.getSlide();if(h&&ur(h.el))return;const y=this.container;if(y){const C=Math.abs(m.current.f),S=C<1?"":Math.max(.5,Math.min(1,1-C/m.contentRect.fitHeight*1.5));y.style.setProperty("--fancybox-ts",S?"0s":""),y.style.setProperty("--fancybox-opacity",S+"")}}),c.on("Panzoom.touchEnd",(f,m,h)=>{var y;const C=this.getSlide();if(C&&ur(C.el)||m.isMobile&&document.activeElement&&["TEXTAREA","INPUT"].indexOf((y=document.activeElement)===null||y===void 0?void 0:y.nodeName)!==-1)return;const S=Math.abs(m.dragOffset.y);m.lockedAxis==="y"&&(S>=200||S>=50&&m.dragOffset.time<300)&&(h&&h.cancelable&&h.preventDefault(),this.close(h,"f-throwOut"+(m.current.f<0?"Up":"Down")))})),c.on("change",f=>{var m;let h=(m=this.getSlide())===null||m===void 0?void 0:m.triggerEl;if(h){const y=new CustomEvent("slideTo",{bubbles:!0,cancelable:!0,detail:f.page});h.dispatchEvent(y)}}),c.on(["refresh","change"],f=>{const m=this.container;if(!m)return;for(const C of m.querySelectorAll("[data-fancybox-current-index]"))C.innerHTML=f.page+1;for(const C of m.querySelectorAll("[data-fancybox-count]"))C.innerHTML=f.pages.length;if(!f.isInfinite){for(const C of m.querySelectorAll("[data-fancybox-next]"))f.page<f.pages.length-1?(C.removeAttribute(Sn),C.removeAttribute(Qt)):(C.setAttribute(Sn,""),C.setAttribute(Qt,"-1"));for(const C of m.querySelectorAll("[data-fancybox-prev]"))f.page>0?(C.removeAttribute(Sn),C.removeAttribute(Qt)):(C.setAttribute(Sn,""),C.setAttribute(Qt,"-1"))}const h=this.getSlide();if(!h)return;let y=h.downloadSrc||"";y||h.type!=="image"||h.error||!qt(h[Cn])||(y=h[Cn]);for(const C of m.querySelectorAll("[data-fancybox-download]")){const S=h.downloadFilename;y?(C.removeAttribute(Sn),C.removeAttribute(Qt),C.setAttribute(sr,y),C.setAttribute(_a,S||y),C.setAttribute("target","_blank")):(C.setAttribute(Sn,""),C.setAttribute(Qt,"-1"),C.removeAttribute(sr),C.removeAttribute(_a))}}),this.emit("initCarousel")}attachEvents(){const n=this,a=n.container;if(!a)return;a.addEventListener("click",n.onClick,{passive:!1,capture:!1}),a.addEventListener("wheel",n.onWheel,{passive:!1,capture:!1}),document.addEventListener("keydown",n.onKeydown,{passive:!1,capture:!0}),document.addEventListener("visibilitychange",n.onVisibilityChange,!1),document.addEventListener("mousemove",n.onMousemove),n.option("trapFocus")&&document.addEventListener("focus",n.onFocus,!0),window.addEventListener("resize",n.onResize);const s=window.visualViewport;s&&(s.addEventListener("scroll",n.onResize),s.addEventListener("resize",n.onResize))}detachEvents(){const n=this,a=n.container;if(!a)return;document.removeEventListener("keydown",n.onKeydown,{passive:!1,capture:!0}),a.removeEventListener("wheel",n.onWheel,{passive:!1,capture:!1}),a.removeEventListener("click",n.onClick,{passive:!1,capture:!1}),document.removeEventListener("mousemove",n.onMousemove),window.removeEventListener("resize",n.onResize);const s=window.visualViewport;s&&(s.removeEventListener("resize",n.onResize),s.removeEventListener("scroll",n.onResize)),document.removeEventListener("visibilitychange",n.onVisibilityChange,!1),document.removeEventListener("focus",n.onFocus,!0)}scale(){const n=this.container;if(!n)return;const a=window.visualViewport,s=Math.max(1,(a==null?void 0:a.scale)||1);let c="",f="",m="";if(a&&s>1){let h=`${a.offsetLeft}px`,y=`${a.offsetTop}px`;c=a.width*s+"px",f=a.height*s+"px",m=`translate3d(${h}, ${y}, 0) scale(${1/s})`}n.style.transform=m,n.style.width=c,n.style.height=f}onClick(n){var a;const{container:s,isCompact:c}=this;if(!s||this.isClosing())return;!c&&this.option("idle")&&this.resetIdle();const f=n.composedPath()[0];if(f.closest(".fancybox-spinner")||f.closest("[data-fancybox-close]"))return n.preventDefault(),void this.close(n);if(f.closest("[data-fancybox-prev]"))return n.preventDefault(),void this.prev();if(f.closest("[data-fancybox-next]"))return n.preventDefault(),void this.next();if(n.type==="click"&&n.detail===0||Math.abs(n.pageX-Aa)>30||Math.abs(n.pageY-Da)>30)return;const m=document.activeElement;if(La()&&m&&s.contains(m))return;if(c&&((a=this.getSlide())===null||a===void 0?void 0:a.type)==="image")return void(this.clickTimer?(clearTimeout(this.clickTimer),this.clickTimer=null):this.clickTimer=setTimeout(()=>{this.toggleIdle(),this.clickTimer=null},350));if(this.emit("click",n),n.defaultPrevented)return;let h=!1;if(f.closest(".fancybox__content")){if(m){if(m.closest("[contenteditable]"))return;f.matches(Xi)||m.blur()}if(La())return;h=this.option("contentClick")}else f.closest(".fancybox__carousel")&&!f.matches(Xi)&&(h=this.option("backdropClick"));h==="close"?(n.preventDefault(),this.close(n)):h==="next"?(n.preventDefault(),this.next()):h==="prev"&&(n.preventDefault(),this.prev())}onWheel(n){const a=n.target;let s=this.option("wheel",n);a.closest(".fancybox__thumbs")&&(s="slide");const c=s==="slide",f=[-n.deltaX||0,-n.deltaY||0,-n.detail||0].reduce(function(y,C){return Math.abs(C)>Math.abs(y)?C:y}),m=Math.max(-1,Math.min(1,f)),h=Date.now();this.pwt&&h-this.pwt<300?c&&n.preventDefault():(this.pwt=h,this.emit("wheel",n,m),n.defaultPrevented||(s==="close"?(n.preventDefault(),this.close(n)):s==="slide"&&(gi(a)||(n.preventDefault(),this[m>0?"prev":"next"]()))))}onScroll(){window.scrollTo(Oa,Pa)}onKeydown(n){if(!this.isTopmost())return;this.isCompact||!this.option("idle")||this.isClosing()||this.resetIdle();const a=n.key,s=this.option("keyboard");if(!s)return;const c=n.composedPath()[0],f=document.activeElement&&document.activeElement.classList,m=f&&f.contains("f-button")||c.dataset.carouselPage||c.dataset.carouselIndex;if(a!=="Escape"&&!m&&dt(c)&&(c.isContentEditable||["TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(c.nodeName)!==-1)||(n.key==="Tab"?fe(this.container,rr):Pe(this.container,rr),n.ctrlKey||n.altKey||n.shiftKey))return;this.emit("keydown",a,n);const h=s[a];h&&typeof this[h]=="function"&&(n.preventDefault(),this[h]())}onResize(){const n=this.container;if(!n)return;const a=this.isCompact;n.classList.toggle(Ma,a),this.manageCaption(this.getSlide()),this.isCompact?this.clearIdle():this.endIdle(),this.scale(),this.emit("resize")}onFocus(n){this.isTopmost()&&this.checkFocus(n)}onMousemove(n){this.prevMouseMoveEvent=n,!this.isCompact&&this.option("idle")&&this.resetIdle()}onVisibilityChange(){document.visibilityState==="visible"?this.checkFocus():this.endIdle()}manageCloseBtn(n){const a=this.optionFor(n,"closeButton")||!1;if(a==="auto"){const c=this.plugins.Toolbar;if(c&&c.state===rn.Ready)return}if(!a||!n.contentEl||n.closeBtnEl)return;const s=this.option("tpl.closeButton");if(s){const c=At(this.localize(s));n.closeBtnEl=n.contentEl.appendChild(c),n.el&&fe(n.el,"has-close-btn")}}manageCaption(n=void 0){var a,s;const c="fancybox__caption",f=this.container;if(!f)return;Pe(f,fi);const m=this.isCompact||this.option("commonCaption"),h=!m;if(this.caption&&this.stop(this.caption),h&&this.caption&&(this.caption.remove(),this.caption=null),m&&!this.caption)for(const d of((a=this.carousel)===null||a===void 0?void 0:a.slides)||[])d.captionEl&&(d.captionEl.remove(),d.captionEl=void 0,Pe(d.el,fi),(s=d.el)===null||s===void 0||s.removeAttribute("aria-labelledby"));if(n||(n=this.getSlide()),!n||m&&!this.isCurrentSlide(n))return;const y=n.el;let C=this.optionFor(n,"caption","");if(!C)return void(m&&this.caption&&this.animate(this.caption,"f-fadeOut",()=>{this.caption&&(this.caption.innerHTML="")}));let S=null;if(h){if(S=n.captionEl||null,y&&!S){const d=c+`_${this.id}_${n.index}`;S=document.createElement("div"),fe(S,c),S.setAttribute("id",d),n.captionEl=y.appendChild(S),fe(y,fi),y.setAttribute("aria-labelledby",d)}}else S=this.caption,S||(S=f.querySelector("."+c)),!S&&(S=document.createElement("div"),S.dataset.fancyboxCaption="",fe(S,c),(this.footer||f).prepend(S)),fe(f,fi),this.caption=S;S&&(S.innerHTML="",qt(C)||typeof C=="number"?S.innerHTML=C+"":C instanceof HTMLElement&&S.appendChild(C))}checkFocus(n){this.focus(n)}focus(n){var a;if(this.ignoreFocusChange)return;const s=document.activeElement||null,c=(n==null?void 0:n.target)||null,f=this.container,m=(a=this.carousel)===null||a===void 0?void 0:a.viewport;if(!f||!m||!n&&s&&f.contains(s))return;const h=this.getSlide(),y=h&&h.state===at.Ready?h.el:null;if(!y||y.contains(s)||f===s)return;n&&n.cancelable&&n.preventDefault(),this.ignoreFocusChange=!0;const C=Array.from(f.querySelectorAll(Xi));let S=[],d=null;for(let p of C){const g=!p.offsetParent||!!p.closest('[aria-hidden="true"]'),E=y&&y.contains(p),b=!m.contains(p);if(p===f||(E||b)&&!g){S.push(p);const k=p.dataset.origTabindex;k!==void 0&&k&&(p.tabIndex=parseFloat(k)),p.removeAttribute("data-orig-tabindex"),!p.hasAttribute("autoFocus")&&d||(d=p)}else{const k=p.dataset.origTabindex===void 0?p.getAttribute("tabindex")||"":p.dataset.origTabindex;k&&(p.dataset.origTabindex=k),p.tabIndex=-1}}let u=null;n?(!c||S.indexOf(c)<0)&&(u=d||f,S.length&&(s===en?u=S[0]:this.lastFocus!==f&&s!==wt||(u=S[S.length-1]))):u=h&&h.type==="image"?f:d||f,u&&pa(u),this.lastFocus=document.activeElement,this.ignoreFocusChange=!1}next(){const n=this.carousel;n&&n.pages.length>1&&n.slideNext()}prev(){const n=this.carousel;n&&n.pages.length>1&&n.slidePrev()}jumpTo(...n){this.carousel&&this.carousel.slideTo(...n)}isTopmost(){var n;return((n=Le.getInstance())===null||n===void 0?void 0:n.id)==this.id}animate(n=null,a="",s){if(!n||!a)return void(s&&s());this.stop(n);const c=f=>{f.target===n&&n.dataset.animationName&&(n.removeEventListener("animationend",c),delete n.dataset.animationName,s&&s(),Pe(n,a))};n.dataset.animationName=a,n.addEventListener("animationend",c),fe(n,a)}stop(n){n&&n.dispatchEvent(new CustomEvent("animationend",{bubbles:!1,cancelable:!0,currentTarget:n}))}setContent(n,a="",s=!0){if(this.isClosing())return;const c=n.el;if(!c)return;let f=null;if(dt(a)?f=a:(f=At(a+""),dt(f)||(f=document.createElement("div"),f.innerHTML=a+"")),["img","picture","iframe","video","audio"].includes(f.nodeName.toLowerCase())){const m=document.createElement("div");m.appendChild(f),f=m}dt(f)&&n.filter&&!n.error&&(f=f.querySelector(n.filter)),f&&dt(f)?(fe(f,"fancybox__content"),n.id&&f.setAttribute("id",n.id),c.classList.add(`has-${n.error?"error":n.type||"unknown"}`),c.prepend(f),f.style.display==="none"&&(f.style.display=""),getComputedStyle(f).getPropertyValue("display")==="none"&&(f.style.display=n.display||this.option("defaultDisplay")||"flex"),n.contentEl=f,s&&this.revealContent(n),this.manageCloseBtn(n),this.manageCaption(n)):this.setError(n,"{{ELEMENT_NOT_FOUND}}")}revealContent(n,a){const s=n.el,c=n.contentEl;s&&c&&(this.emit("reveal",n),this.hideLoading(n),n.state=at.Opening,(a=this.isOpeningSlide(n)?a===void 0?this.optionFor(n,"showClass"):a:"f-fadeIn")?this.animate(c,a,()=>{this.done(n)}):this.done(n))}done(n){this.isClosing()||(n.state=at.Ready,this.emit("done",n),fe(n.el,"is-done"),this.isCurrentSlide(n)&&this.option("autoFocus")&&queueMicrotask(()=>{var a;(a=n.panzoom)===null||a===void 0||a.updateControls(),this.option("autoFocus")&&this.focus()}),this.isOpeningSlide(n)&&(Pe(this.container,or),!this.isCompact&&this.option("idle")&&this.setIdle()))}isCurrentSlide(n){const a=this.getSlide();return!(!n||!a)&&a.index===n.index}isOpeningSlide(n){var a,s;return((a=this.carousel)===null||a===void 0?void 0:a.prevPage)===null&&n&&n.index===((s=this.getSlide())===null||s===void 0?void 0:s.index)}showLoading(n){n.state=at.Loading;const a=n.el;a&&(fe(a,xa),this.emit("loading",n),n.spinnerEl||setTimeout(()=>{if(!this.isClosing()&&!n.spinnerEl&&n.state===at.Loading){let s=At(vr);fe(s,"fancybox-spinner"),n.spinnerEl=s,a.prepend(s),this.animate(s,"f-fadeIn")}},250))}hideLoading(n){const a=n.el;if(!a)return;const s=n.spinnerEl;this.isClosing()?s==null||s.remove():(Pe(a,xa),s&&this.animate(s,"f-fadeOut",()=>{s.remove()}),n.state===at.Loading&&(this.emit("loaded",n),n.state=at.Ready))}setError(n,a){if(this.isClosing())return;const s=new Event("error",{bubbles:!0,cancelable:!0});if(this.emit("error",s,n),s.defaultPrevented)return;n.error=a,this.hideLoading(n),this.clearContent(n);const c=document.createElement("div");c.classList.add("fancybox-error"),c.innerHTML=this.localize(a||"<p>{{ERROR}}</p>"),this.setContent(n,c)}clearContent(n){if(n.state===void 0)return;this.emit("clearContent",n),n.contentEl&&(n.contentEl.remove(),n.contentEl=void 0);const a=n.el;a&&(Pe(a,"has-error"),Pe(a,"has-unknown"),Pe(a,`has-${n.type||"unknown"}`)),n.closeBtnEl&&n.closeBtnEl.remove(),n.closeBtnEl=void 0,n.captionEl&&n.captionEl.remove(),n.captionEl=void 0,n.spinnerEl&&n.spinnerEl.remove(),n.spinnerEl=void 0}getSlide(){var n;const a=this.carousel;return((n=a==null?void 0:a.pages[a==null?void 0:a.page])===null||n===void 0?void 0:n.slides[0])||void 0}close(n,a){if(this.isClosing())return;const s=new Event("shouldClose",{bubbles:!0,cancelable:!0});if(this.emit("shouldClose",s,n),s.defaultPrevented)return;n&&n.cancelable&&(n.preventDefault(),n.stopPropagation());const c=()=>{this.proceedClose(n,a)};this.startedFs&&yt&&yt.isFullscreen()?Promise.resolve(yt.exit()).then(()=>c()):c()}clearIdle(){this.idleTimer&&clearTimeout(this.idleTimer),this.idleTimer=null}setIdle(n=!1){const a=()=>{this.clearIdle(),this.idle=!0,fe(this.container,"is-idle"),this.emit("setIdle")};if(this.clearIdle(),!this.isClosing())if(n)a();else{const s=this.option("idle");s&&(this.idleTimer=setTimeout(a,s))}}endIdle(){this.clearIdle(),this.idle&&!this.isClosing()&&(this.idle=!1,Pe(this.container,"is-idle"),this.emit("endIdle"))}resetIdle(){this.endIdle(),this.setIdle()}toggleIdle(){this.idle?this.endIdle():this.setIdle(!0)}toggleFullscreen(){yt&&(yt.isFullscreen()?yt.exit():yt.request().then(()=>{this.startedFs=!0}))}isClosing(){return[et.Closing,et.CustomClosing,et.Destroy].includes(this.state)}proceedClose(n,a){var s,c;this.state=et.Closing,this.clearIdle(),this.detachEvents();const f=this.container,m=this.carousel,h=this.getSlide(),y=h&&this.option("placeFocusBack")?h.triggerEl||this.option("triggerEl"):null;if(y&&(Ya(y)?pa(y):y.focus()),f&&(Pe(f,or),fe(f,"is-closing"),f.setAttribute(ir,"true"),this.option("animated")&&fe(f,ar),f.style.pointerEvents="none"),m){m.clearTransitions(),(s=m.panzoom)===null||s===void 0||s.destroy(),(c=m.plugins.Navigation)===null||c===void 0||c.detach();for(const C of m.slides){C.state=at.Closing,this.hideLoading(C);const S=C.contentEl;S&&this.stop(S);const d=C==null?void 0:C.panzoom;d&&(d.stop(),d.detachEvents(),d.detachObserver()),this.isCurrentSlide(C)||m.emit("removeSlide",C)}}Oa=window.scrollX,Pa=window.scrollY,window.addEventListener("scroll",this.onScroll),this.emit("close",n),this.state!==et.CustomClosing?(a===void 0&&h&&(a=this.optionFor(h,"hideClass")),a&&h?(this.animate(h.contentEl,a,()=>{m&&m.emit("removeSlide",h)}),setTimeout(()=>{this.destroy()},500)):this.destroy()):setTimeout(()=>{this.destroy()},500)}destroy(){var n;if(this.state===et.Destroy)return;window.removeEventListener("scroll",this.onScroll),this.state=et.Destroy,(n=this.carousel)===null||n===void 0||n.destroy();const a=this.container;a&&a.remove(),Tn.delete(this.id);const s=Le.getInstance();s?s.focus():(wt&&(wt.remove(),wt=null),en&&(en.remove(),en=null),Pe(document.documentElement,Ca),(()=>{if(!Vn)return;const c=document,f=c.body;f.classList.remove(nr),f.style.setProperty(ka,""),c.documentElement.style.setProperty(Ta,"")})(),this.emit("destroy"))}static bind(n,a,s){if(!Vn)return;let c,f="",m={};if(n===void 0?c=document.body:qt(n)?(c=document.body,f=n,typeof a=="object"&&(m=a||{})):(c=n,qt(a)&&(f=a),typeof s=="object"&&(m=s||{})),!c||!dt(c))return;f=f||"[data-fancybox]";const h=Le.openers.get(c)||new Map;h.set(f,m),Le.openers.set(c,h),h.size===1&&c.addEventListener("click",Le.fromEvent)}static unbind(n,a){let s,c="";if(qt(n)?(s=document.body,c=n):(s=n,qt(a)&&(c=a)),!s)return;const f=Le.openers.get(s);f&&c&&f.delete(c),c&&f||(Le.openers.delete(s),s.removeEventListener("click",Le.fromEvent))}static destroy(){let n;for(;n=Le.getInstance();)n.destroy();for(const a of Le.openers.keys())a.removeEventListener("click",Le.fromEvent);Le.openers=new Map}static fromEvent(n){if(n.defaultPrevented||n.button&&n.button!==0||n.ctrlKey||n.metaKey||n.shiftKey)return;let a=n.composedPath()[0];const s=a.closest("[data-fancybox-trigger]");if(s){const g=s.dataset.fancyboxTrigger||"",E=document.querySelectorAll(`[data-fancybox="${g}"]`),b=parseInt(s.dataset.fancyboxIndex||"",10)||0;a=E[b]||a}if(!(a&&a instanceof Element))return;let c,f,m,h;if([...Le.openers].reverse().find(([g,E])=>!(!g.contains(a)||![...E].reverse().find(([b,k])=>{let M=a.closest(b);return!!M&&(c=g,f=b,m=M,h=k,!0)}))),!c||!f||!m)return;h=h||{},n.preventDefault(),a=m;let y=[],C=ft({},fr,h);C.event=n,C.triggerEl=a,C.delegate=s;const S=C.groupAll,d=C.groupAttr,u=d&&a?a.getAttribute(`${d}`):"";if((!a||u||S)&&(y=[].slice.call(c.querySelectorAll(f))),a&&!S&&(y=u?y.filter(g=>g.getAttribute(`${d}`)===u):[a]),!y.length)return;const p=Le.getInstance();return p&&p.options.triggerEl&&y.indexOf(p.options.triggerEl)>-1?void 0:(a&&(C.startIndex=y.indexOf(a)),Le.fromNodes(y,C))}static fromSelector(n,a,s){let c=null,f="",m={};if(qt(n)?(c=document.body,f=n,typeof a=="object"&&(m=a||{})):n instanceof HTMLElement&&qt(a)&&(c=n,f=a,typeof s=="object"&&(m=s||{})),!c||!f)return!1;const h=Le.openers.get(c);return!!h&&(m=ft({},h.get(f)||{},m),!!m&&Le.fromNodes(Array.from(c.querySelectorAll(f)),m))}static fromNodes(n,a){a=ft({},fr,a||{});const s=[];for(const c of n){const f=c.dataset||{},m=f[Cn]||c.getAttribute(sr)||c.getAttribute("currentSrc")||c.getAttribute(Cn)||void 0;let h;const y=a.delegate;let C;y&&s.length===a.startIndex&&(h=y instanceof HTMLImageElement?y:y.querySelector("img:not([aria-hidden])")),h||(h=c instanceof HTMLImageElement?c:c.querySelector("img:not([aria-hidden])")),h&&(C=h.currentSrc||h[Cn]||void 0,!C&&h.dataset&&(C=h.dataset.lazySrc||h.dataset[Cn]||void 0));const S={src:m,triggerEl:c,thumbEl:h,thumbElSrc:C,thumbSrc:C};for(const d in f){let u=f[d]+"";u=u!=="false"&&(u==="true"||u),S[d]=u}s.push(S)}return new Le(s,a)}static getInstance(n){return n?Tn.get(n):Array.from(Tn.values()).reverse().find(a=>!a.isClosing()&&a)||null}static getSlide(){var n;return((n=Le.getInstance())===null||n===void 0?void 0:n.getSlide())||null}static show(n=[],a={}){return new Le(n,a)}static next(){const n=Le.getInstance();n&&n.next()}static prev(){const n=Le.getInstance();n&&n.prev()}static close(n=!0,...a){if(n)for(const s of Tn.values())s.close(...a);else{const s=Le.getInstance();s&&s.close(...a)}}}Object.defineProperty(Le,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(Le,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:fr}),Object.defineProperty(Le,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:Nl}),Object.defineProperty(Le,"openers",{enumerable:!0,configurable:!0,writable:!0,value:new Map});function Bl(T){return T&&T.__esModule&&Object.prototype.hasOwnProperty.call(T,"default")?T.default:T}var mi={exports:{}};/*!
 * Vditor v3.10.9 - A markdown editor written in TypeScript.
 *
 * MIT License
 *
 * Copyright (c) 2018-present B3log 开源, b3log.org
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */var zl=mi.exports,Ra;function Fl(){return Ra||(Ra=1,function(T,n){(function(s,c){T.exports=c()})(zl,()=>(()=>{var a={192:m=>{var h=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},y=-1,C=1,S=0;h.Diff=function(d,u){return[d,u]},h.prototype.diff_main=function(d,u,p,g){typeof g>"u"&&(this.Diff_Timeout<=0?g=Number.MAX_VALUE:g=new Date().getTime()+this.Diff_Timeout*1e3);var E=g;if(d==null||u==null)throw new Error("Null input. (diff_main)");if(d==u)return d?[new h.Diff(S,d)]:[];typeof p>"u"&&(p=!0);var b=p,k=this.diff_commonPrefix(d,u),M=d.substring(0,k);d=d.substring(k),u=u.substring(k),k=this.diff_commonSuffix(d,u);var x=d.substring(d.length-k);d=d.substring(0,d.length-k),u=u.substring(0,u.length-k);var A=this.diff_compute_(d,u,b,E);return M&&A.unshift(new h.Diff(S,M)),x&&A.push(new h.Diff(S,x)),this.diff_cleanupMerge(A),A},h.prototype.diff_compute_=function(d,u,p,g){var E;if(!d)return[new h.Diff(C,u)];if(!u)return[new h.Diff(y,d)];var b=d.length>u.length?d:u,k=d.length>u.length?u:d,M=b.indexOf(k);if(M!=-1)return E=[new h.Diff(C,b.substring(0,M)),new h.Diff(S,k),new h.Diff(C,b.substring(M+k.length))],d.length>u.length&&(E[0][0]=E[2][0]=y),E;if(k.length==1)return[new h.Diff(y,d),new h.Diff(C,u)];var x=this.diff_halfMatch_(d,u);if(x){var A=x[0],v=x[1],O=x[2],I=x[3],R=x[4],P=this.diff_main(A,O,p,g),B=this.diff_main(v,I,p,g);return P.concat([new h.Diff(S,R)],B)}return p&&d.length>100&&u.length>100?this.diff_lineMode_(d,u,g):this.diff_bisect_(d,u,g)},h.prototype.diff_lineMode_=function(d,u,p){var g=this.diff_linesToChars_(d,u);d=g.chars1,u=g.chars2;var E=g.lineArray,b=this.diff_main(d,u,!1,p);this.diff_charsToLines_(b,E),this.diff_cleanupSemantic(b),b.push(new h.Diff(S,""));for(var k=0,M=0,x=0,A="",v="";k<b.length;){switch(b[k][0]){case C:x++,v+=b[k][1];break;case y:M++,A+=b[k][1];break;case S:if(M>=1&&x>=1){b.splice(k-M-x,M+x),k=k-M-x;for(var O=this.diff_main(A,v,!1,p),I=O.length-1;I>=0;I--)b.splice(k,0,O[I]);k=k+O.length}x=0,M=0,A="",v="";break}k++}return b.pop(),b},h.prototype.diff_bisect_=function(d,u,p){for(var g=d.length,E=u.length,b=Math.ceil((g+E)/2),k=b,M=2*b,x=new Array(M),A=new Array(M),v=0;v<M;v++)x[v]=-1,A[v]=-1;x[k+1]=0,A[k+1]=0;for(var O=g-E,I=O%2!=0,R=0,P=0,B=0,W=0,G=0;G<b&&!(new Date().getTime()>p);G++){for(var re=-G+R;re<=G-P;re+=2){var de=k+re,ve;re==-G||re!=G&&x[de-1]<x[de+1]?ve=x[de+1]:ve=x[de-1]+1;for(var ke=ve-re;ve<g&&ke<E&&d.charAt(ve)==u.charAt(ke);)ve++,ke++;if(x[de]=ve,ve>g)P+=2;else if(ke>E)R+=2;else if(I){var be=k+O-re;if(be>=0&&be<M&&A[be]!=-1){var we=g-A[be];if(ve>=we)return this.diff_bisectSplit_(d,u,ve,ke,p)}}}for(var Ae=-G+B;Ae<=G-W;Ae+=2){var be=k+Ae,we;Ae==-G||Ae!=G&&A[be-1]<A[be+1]?we=A[be+1]:we=A[be-1]+1;for(var We=we-Ae;we<g&&We<E&&d.charAt(g-we-1)==u.charAt(E-We-1);)we++,We++;if(A[be]=we,we>g)W+=2;else if(We>E)B+=2;else if(!I){var de=k+O-Ae;if(de>=0&&de<M&&x[de]!=-1){var ve=x[de],ke=k+ve-de;if(we=g-we,ve>=we)return this.diff_bisectSplit_(d,u,ve,ke,p)}}}}return[new h.Diff(y,d),new h.Diff(C,u)]},h.prototype.diff_bisectSplit_=function(d,u,p,g,E){var b=d.substring(0,p),k=u.substring(0,g),M=d.substring(p),x=u.substring(g),A=this.diff_main(b,k,!1,E),v=this.diff_main(M,x,!1,E);return A.concat(v)},h.prototype.diff_linesToChars_=function(d,u){var p=[],g={};p[0]="";function E(x){for(var A="",v=0,O=-1,I=p.length;O<x.length-1;){O=x.indexOf(`
`,v),O==-1&&(O=x.length-1);var R=x.substring(v,O+1);(g.hasOwnProperty?g.hasOwnProperty(R):g[R]!==void 0)?A+=String.fromCharCode(g[R]):(I==b&&(R=x.substring(v),O=x.length),A+=String.fromCharCode(I),g[R]=I,p[I++]=R),v=O+1}return A}var b=4e4,k=E(d);b=65535;var M=E(u);return{chars1:k,chars2:M,lineArray:p}},h.prototype.diff_charsToLines_=function(d,u){for(var p=0;p<d.length;p++){for(var g=d[p][1],E=[],b=0;b<g.length;b++)E[b]=u[g.charCodeAt(b)];d[p][1]=E.join("")}},h.prototype.diff_commonPrefix=function(d,u){if(!d||!u||d.charAt(0)!=u.charAt(0))return 0;for(var p=0,g=Math.min(d.length,u.length),E=g,b=0;p<E;)d.substring(b,E)==u.substring(b,E)?(p=E,b=p):g=E,E=Math.floor((g-p)/2+p);return E},h.prototype.diff_commonSuffix=function(d,u){if(!d||!u||d.charAt(d.length-1)!=u.charAt(u.length-1))return 0;for(var p=0,g=Math.min(d.length,u.length),E=g,b=0;p<E;)d.substring(d.length-E,d.length-b)==u.substring(u.length-E,u.length-b)?(p=E,b=p):g=E,E=Math.floor((g-p)/2+p);return E},h.prototype.diff_commonOverlap_=function(d,u){var p=d.length,g=u.length;if(p==0||g==0)return 0;p>g?d=d.substring(p-g):p<g&&(u=u.substring(0,p));var E=Math.min(p,g);if(d==u)return E;for(var b=0,k=1;;){var M=d.substring(E-k),x=u.indexOf(M);if(x==-1)return b;k+=x,(x==0||d.substring(E-k)==u.substring(0,k))&&(b=k,k++)}},h.prototype.diff_halfMatch_=function(d,u){if(this.Diff_Timeout<=0)return null;var p=d.length>u.length?d:u,g=d.length>u.length?u:d;if(p.length<4||g.length*2<p.length)return null;var E=this;function b(P,B,W){for(var G=P.substring(W,W+Math.floor(P.length/4)),re=-1,de="",ve,ke,be,we;(re=B.indexOf(G,re+1))!=-1;){var Ae=E.diff_commonPrefix(P.substring(W),B.substring(re)),We=E.diff_commonSuffix(P.substring(0,W),B.substring(0,re));de.length<We+Ae&&(de=B.substring(re-We,re)+B.substring(re,re+Ae),ve=P.substring(0,W-We),ke=P.substring(W+Ae),be=B.substring(0,re-We),we=B.substring(re+Ae))}return de.length*2>=P.length?[ve,ke,be,we,de]:null}var k=b(p,g,Math.ceil(p.length/4)),M=b(p,g,Math.ceil(p.length/2)),x;if(!k&&!M)return null;M?k?x=k[4].length>M[4].length?k:M:x=M:x=k;var A,v,O,I;d.length>u.length?(A=x[0],v=x[1],O=x[2],I=x[3]):(O=x[0],I=x[1],A=x[2],v=x[3]);var R=x[4];return[A,v,O,I,R]},h.prototype.diff_cleanupSemantic=function(d){for(var u=!1,p=[],g=0,E=null,b=0,k=0,M=0,x=0,A=0;b<d.length;)d[b][0]==S?(p[g++]=b,k=x,M=A,x=0,A=0,E=d[b][1]):(d[b][0]==C?x+=d[b][1].length:A+=d[b][1].length,E&&E.length<=Math.max(k,M)&&E.length<=Math.max(x,A)&&(d.splice(p[g-1],0,new h.Diff(y,E)),d[p[g-1]+1][0]=C,g--,g--,b=g>0?p[g-1]:-1,k=0,M=0,x=0,A=0,E=null,u=!0)),b++;for(u&&this.diff_cleanupMerge(d),this.diff_cleanupSemanticLossless(d),b=1;b<d.length;){if(d[b-1][0]==y&&d[b][0]==C){var v=d[b-1][1],O=d[b][1],I=this.diff_commonOverlap_(v,O),R=this.diff_commonOverlap_(O,v);I>=R?(I>=v.length/2||I>=O.length/2)&&(d.splice(b,0,new h.Diff(S,O.substring(0,I))),d[b-1][1]=v.substring(0,v.length-I),d[b+1][1]=O.substring(I),b++):(R>=v.length/2||R>=O.length/2)&&(d.splice(b,0,new h.Diff(S,v.substring(0,R))),d[b-1][0]=C,d[b-1][1]=O.substring(0,O.length-R),d[b+1][0]=y,d[b+1][1]=v.substring(R),b++),b++}b++}},h.prototype.diff_cleanupSemanticLossless=function(d){function u(R,P){if(!R||!P)return 6;var B=R.charAt(R.length-1),W=P.charAt(0),G=B.match(h.nonAlphaNumericRegex_),re=W.match(h.nonAlphaNumericRegex_),de=G&&B.match(h.whitespaceRegex_),ve=re&&W.match(h.whitespaceRegex_),ke=de&&B.match(h.linebreakRegex_),be=ve&&W.match(h.linebreakRegex_),we=ke&&R.match(h.blanklineEndRegex_),Ae=be&&P.match(h.blanklineStartRegex_);return we||Ae?5:ke||be?4:G&&!de&&ve?3:de||ve?2:G||re?1:0}for(var p=1;p<d.length-1;){if(d[p-1][0]==S&&d[p+1][0]==S){var g=d[p-1][1],E=d[p][1],b=d[p+1][1],k=this.diff_commonSuffix(g,E);if(k){var M=E.substring(E.length-k);g=g.substring(0,g.length-k),E=M+E.substring(0,E.length-k),b=M+b}for(var x=g,A=E,v=b,O=u(g,E)+u(E,b);E.charAt(0)===b.charAt(0);){g+=E.charAt(0),E=E.substring(1)+b.charAt(0),b=b.substring(1);var I=u(g,E)+u(E,b);I>=O&&(O=I,x=g,A=E,v=b)}d[p-1][1]!=x&&(x?d[p-1][1]=x:(d.splice(p-1,1),p--),d[p][1]=A,v?d[p+1][1]=v:(d.splice(p+1,1),p--))}p++}},h.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,h.whitespaceRegex_=/\s/,h.linebreakRegex_=/[\r\n]/,h.blanklineEndRegex_=/\n\r?\n$/,h.blanklineStartRegex_=/^\r?\n\r?\n/,h.prototype.diff_cleanupEfficiency=function(d){for(var u=!1,p=[],g=0,E=null,b=0,k=!1,M=!1,x=!1,A=!1;b<d.length;)d[b][0]==S?(d[b][1].length<this.Diff_EditCost&&(x||A)?(p[g++]=b,k=x,M=A,E=d[b][1]):(g=0,E=null),x=A=!1):(d[b][0]==y?A=!0:x=!0,E&&(k&&M&&x&&A||E.length<this.Diff_EditCost/2&&k+M+x+A==3)&&(d.splice(p[g-1],0,new h.Diff(y,E)),d[p[g-1]+1][0]=C,g--,E=null,k&&M?(x=A=!0,g=0):(g--,b=g>0?p[g-1]:-1,x=A=!1),u=!0)),b++;u&&this.diff_cleanupMerge(d)},h.prototype.diff_cleanupMerge=function(d){d.push(new h.Diff(S,""));for(var u=0,p=0,g=0,E="",b="",k;u<d.length;)switch(d[u][0]){case C:g++,b+=d[u][1],u++;break;case y:p++,E+=d[u][1],u++;break;case S:p+g>1?(p!==0&&g!==0&&(k=this.diff_commonPrefix(b,E),k!==0&&(u-p-g>0&&d[u-p-g-1][0]==S?d[u-p-g-1][1]+=b.substring(0,k):(d.splice(0,0,new h.Diff(S,b.substring(0,k))),u++),b=b.substring(k),E=E.substring(k)),k=this.diff_commonSuffix(b,E),k!==0&&(d[u][1]=b.substring(b.length-k)+d[u][1],b=b.substring(0,b.length-k),E=E.substring(0,E.length-k))),u-=p+g,d.splice(u,p+g),E.length&&(d.splice(u,0,new h.Diff(y,E)),u++),b.length&&(d.splice(u,0,new h.Diff(C,b)),u++),u++):u!==0&&d[u-1][0]==S?(d[u-1][1]+=d[u][1],d.splice(u,1)):u++,g=0,p=0,E="",b="";break}d[d.length-1][1]===""&&d.pop();var M=!1;for(u=1;u<d.length-1;)d[u-1][0]==S&&d[u+1][0]==S&&(d[u][1].substring(d[u][1].length-d[u-1][1].length)==d[u-1][1]?(d[u][1]=d[u-1][1]+d[u][1].substring(0,d[u][1].length-d[u-1][1].length),d[u+1][1]=d[u-1][1]+d[u+1][1],d.splice(u-1,1),M=!0):d[u][1].substring(0,d[u+1][1].length)==d[u+1][1]&&(d[u-1][1]+=d[u+1][1],d[u][1]=d[u][1].substring(d[u+1][1].length)+d[u+1][1],d.splice(u+1,1),M=!0)),u++;M&&this.diff_cleanupMerge(d)},h.prototype.diff_xIndex=function(d,u){var p=0,g=0,E=0,b=0,k;for(k=0;k<d.length&&(d[k][0]!==C&&(p+=d[k][1].length),d[k][0]!==y&&(g+=d[k][1].length),!(p>u));k++)E=p,b=g;return d.length!=k&&d[k][0]===y?b:b+(u-E)},h.prototype.diff_prettyHtml=function(d){for(var u=[],p=/&/g,g=/</g,E=/>/g,b=/\n/g,k=0;k<d.length;k++){var M=d[k][0],x=d[k][1],A=x.replace(p,"&amp;").replace(g,"&lt;").replace(E,"&gt;").replace(b,"&para;<br>");switch(M){case C:u[k]='<ins style="background:#e6ffe6;">'+A+"</ins>";break;case y:u[k]='<del style="background:#ffe6e6;">'+A+"</del>";break;case S:u[k]="<span>"+A+"</span>";break}}return u.join("")},h.prototype.diff_text1=function(d){for(var u=[],p=0;p<d.length;p++)d[p][0]!==C&&(u[p]=d[p][1]);return u.join("")},h.prototype.diff_text2=function(d){for(var u=[],p=0;p<d.length;p++)d[p][0]!==y&&(u[p]=d[p][1]);return u.join("")},h.prototype.diff_levenshtein=function(d){for(var u=0,p=0,g=0,E=0;E<d.length;E++){var b=d[E][0],k=d[E][1];switch(b){case C:p+=k.length;break;case y:g+=k.length;break;case S:u+=Math.max(p,g),p=0,g=0;break}}return u+=Math.max(p,g),u},h.prototype.diff_toDelta=function(d){for(var u=[],p=0;p<d.length;p++)switch(d[p][0]){case C:u[p]="+"+encodeURI(d[p][1]);break;case y:u[p]="-"+d[p][1].length;break;case S:u[p]="="+d[p][1].length;break}return u.join("	").replace(/%20/g," ")},h.prototype.diff_fromDelta=function(d,u){for(var p=[],g=0,E=0,b=u.split(/\t/g),k=0;k<b.length;k++){var M=b[k].substring(1);switch(b[k].charAt(0)){case"+":try{p[g++]=new h.Diff(C,decodeURI(M))}catch{throw new Error("Illegal escape in diff_fromDelta: "+M)}break;case"-":case"=":var x=parseInt(M,10);if(isNaN(x)||x<0)throw new Error("Invalid number in diff_fromDelta: "+M);var A=d.substring(E,E+=x);b[k].charAt(0)=="="?p[g++]=new h.Diff(S,A):p[g++]=new h.Diff(y,A);break;default:if(b[k])throw new Error("Invalid diff operation in diff_fromDelta: "+b[k])}}if(E!=d.length)throw new Error("Delta length ("+E+") does not equal source text length ("+d.length+").");return p},h.prototype.match_main=function(d,u,p){if(d==null||u==null||p==null)throw new Error("Null input. (match_main)");return p=Math.max(0,Math.min(p,d.length)),d==u?0:d.length?d.substring(p,p+u.length)==u?p:this.match_bitap_(d,u,p):-1},h.prototype.match_bitap_=function(d,u,p){if(u.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var g=this.match_alphabet_(u),E=this;function b(ve,ke){var be=ve/u.length,we=Math.abs(p-ke);return E.Match_Distance?be+we/E.Match_Distance:we?1:be}var k=this.Match_Threshold,M=d.indexOf(u,p);M!=-1&&(k=Math.min(b(0,M),k),M=d.lastIndexOf(u,p+u.length),M!=-1&&(k=Math.min(b(0,M),k)));var x=1<<u.length-1;M=-1;for(var A,v,O=u.length+d.length,I,R=0;R<u.length;R++){for(A=0,v=O;A<v;)b(R,p+v)<=k?A=v:O=v,v=Math.floor((O-A)/2+A);O=v;var P=Math.max(1,p-v+1),B=Math.min(p+v,d.length)+u.length,W=Array(B+2);W[B+1]=(1<<R)-1;for(var G=B;G>=P;G--){var re=g[d.charAt(G-1)];if(R===0?W[G]=(W[G+1]<<1|1)&re:W[G]=(W[G+1]<<1|1)&re|((I[G+1]|I[G])<<1|1)|I[G+1],W[G]&x){var de=b(R,G-1);if(de<=k)if(k=de,M=G-1,M>p)P=Math.max(1,2*p-M);else break}}if(b(R+1,p)>k)break;I=W}return M},h.prototype.match_alphabet_=function(d){for(var u={},p=0;p<d.length;p++)u[d.charAt(p)]=0;for(var p=0;p<d.length;p++)u[d.charAt(p)]|=1<<d.length-p-1;return u},h.prototype.patch_addContext_=function(d,u){if(u.length!=0){if(d.start2===null)throw Error("patch not initialized");for(var p=u.substring(d.start2,d.start2+d.length1),g=0;u.indexOf(p)!=u.lastIndexOf(p)&&p.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)g+=this.Patch_Margin,p=u.substring(d.start2-g,d.start2+d.length1+g);g+=this.Patch_Margin;var E=u.substring(d.start2-g,d.start2);E&&d.diffs.unshift(new h.Diff(S,E));var b=u.substring(d.start2+d.length1,d.start2+d.length1+g);b&&d.diffs.push(new h.Diff(S,b)),d.start1-=E.length,d.start2-=E.length,d.length1+=E.length+b.length,d.length2+=E.length+b.length}},h.prototype.patch_make=function(d,u,p){var g,E;if(typeof d=="string"&&typeof u=="string"&&typeof p>"u")g=d,E=this.diff_main(g,u,!0),E.length>2&&(this.diff_cleanupSemantic(E),this.diff_cleanupEfficiency(E));else if(d&&typeof d=="object"&&typeof u>"u"&&typeof p>"u")E=d,g=this.diff_text1(E);else if(typeof d=="string"&&u&&typeof u=="object"&&typeof p>"u")g=d,E=u;else if(typeof d=="string"&&typeof u=="string"&&p&&typeof p=="object")g=d,E=p;else throw new Error("Unknown call format to patch_make.");if(E.length===0)return[];for(var b=[],k=new h.patch_obj,M=0,x=0,A=0,v=g,O=g,I=0;I<E.length;I++){var R=E[I][0],P=E[I][1];switch(!M&&R!==S&&(k.start1=x,k.start2=A),R){case C:k.diffs[M++]=E[I],k.length2+=P.length,O=O.substring(0,A)+P+O.substring(A);break;case y:k.length1+=P.length,k.diffs[M++]=E[I],O=O.substring(0,A)+O.substring(A+P.length);break;case S:P.length<=2*this.Patch_Margin&&M&&E.length!=I+1?(k.diffs[M++]=E[I],k.length1+=P.length,k.length2+=P.length):P.length>=2*this.Patch_Margin&&M&&(this.patch_addContext_(k,v),b.push(k),k=new h.patch_obj,M=0,v=O,x=A);break}R!==C&&(x+=P.length),R!==y&&(A+=P.length)}return M&&(this.patch_addContext_(k,v),b.push(k)),b},h.prototype.patch_deepCopy=function(d){for(var u=[],p=0;p<d.length;p++){var g=d[p],E=new h.patch_obj;E.diffs=[];for(var b=0;b<g.diffs.length;b++)E.diffs[b]=new h.Diff(g.diffs[b][0],g.diffs[b][1]);E.start1=g.start1,E.start2=g.start2,E.length1=g.length1,E.length2=g.length2,u[p]=E}return u},h.prototype.patch_apply=function(d,u){if(d.length==0)return[u,[]];d=this.patch_deepCopy(d);var p=this.patch_addPadding(d);u=p+u+p,this.patch_splitMax(d);for(var g=0,E=[],b=0;b<d.length;b++){var k=d[b].start2+g,M=this.diff_text1(d[b].diffs),x,A=-1;if(M.length>this.Match_MaxBits?(x=this.match_main(u,M.substring(0,this.Match_MaxBits),k),x!=-1&&(A=this.match_main(u,M.substring(M.length-this.Match_MaxBits),k+M.length-this.Match_MaxBits),(A==-1||x>=A)&&(x=-1))):x=this.match_main(u,M,k),x==-1)E[b]=!1,g-=d[b].length2-d[b].length1;else{E[b]=!0,g=x-k;var v;if(A==-1?v=u.substring(x,x+M.length):v=u.substring(x,A+this.Match_MaxBits),M==v)u=u.substring(0,x)+this.diff_text2(d[b].diffs)+u.substring(x+M.length);else{var O=this.diff_main(M,v,!1);if(M.length>this.Match_MaxBits&&this.diff_levenshtein(O)/M.length>this.Patch_DeleteThreshold)E[b]=!1;else{this.diff_cleanupSemanticLossless(O);for(var I=0,R,P=0;P<d[b].diffs.length;P++){var B=d[b].diffs[P];B[0]!==S&&(R=this.diff_xIndex(O,I)),B[0]===C?u=u.substring(0,x+R)+B[1]+u.substring(x+R):B[0]===y&&(u=u.substring(0,x+R)+u.substring(x+this.diff_xIndex(O,I+B[1].length))),B[0]!==y&&(I+=B[1].length)}}}}}return u=u.substring(p.length,u.length-p.length),[u,E]},h.prototype.patch_addPadding=function(d){for(var u=this.Patch_Margin,p="",g=1;g<=u;g++)p+=String.fromCharCode(g);for(var g=0;g<d.length;g++)d[g].start1+=u,d[g].start2+=u;var E=d[0],b=E.diffs;if(b.length==0||b[0][0]!=S)b.unshift(new h.Diff(S,p)),E.start1-=u,E.start2-=u,E.length1+=u,E.length2+=u;else if(u>b[0][1].length){var k=u-b[0][1].length;b[0][1]=p.substring(b[0][1].length)+b[0][1],E.start1-=k,E.start2-=k,E.length1+=k,E.length2+=k}if(E=d[d.length-1],b=E.diffs,b.length==0||b[b.length-1][0]!=S)b.push(new h.Diff(S,p)),E.length1+=u,E.length2+=u;else if(u>b[b.length-1][1].length){var k=u-b[b.length-1][1].length;b[b.length-1][1]+=p.substring(0,k),E.length1+=k,E.length2+=k}return p},h.prototype.patch_splitMax=function(d){for(var u=this.Match_MaxBits,p=0;p<d.length;p++)if(!(d[p].length1<=u)){var g=d[p];d.splice(p--,1);for(var E=g.start1,b=g.start2,k="";g.diffs.length!==0;){var M=new h.patch_obj,x=!0;for(M.start1=E-k.length,M.start2=b-k.length,k!==""&&(M.length1=M.length2=k.length,M.diffs.push(new h.Diff(S,k)));g.diffs.length!==0&&M.length1<u-this.Patch_Margin;){var A=g.diffs[0][0],v=g.diffs[0][1];A===C?(M.length2+=v.length,b+=v.length,M.diffs.push(g.diffs.shift()),x=!1):A===y&&M.diffs.length==1&&M.diffs[0][0]==S&&v.length>2*u?(M.length1+=v.length,E+=v.length,x=!1,M.diffs.push(new h.Diff(A,v)),g.diffs.shift()):(v=v.substring(0,u-M.length1-this.Patch_Margin),M.length1+=v.length,E+=v.length,A===S?(M.length2+=v.length,b+=v.length):x=!1,M.diffs.push(new h.Diff(A,v)),v==g.diffs[0][1]?g.diffs.shift():g.diffs[0][1]=g.diffs[0][1].substring(v.length))}k=this.diff_text2(M.diffs),k=k.substring(k.length-this.Patch_Margin);var O=this.diff_text1(g.diffs).substring(0,this.Patch_Margin);O!==""&&(M.length1+=O.length,M.length2+=O.length,M.diffs.length!==0&&M.diffs[M.diffs.length-1][0]===S?M.diffs[M.diffs.length-1][1]+=O:M.diffs.push(new h.Diff(S,O))),x||d.splice(++p,0,M)}}},h.prototype.patch_toText=function(d){for(var u=[],p=0;p<d.length;p++)u[p]=d[p];return u.join("")},h.prototype.patch_fromText=function(d){var u=[];if(!d)return u;for(var p=d.split(`
`),g=0,E=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;g<p.length;){var b=p[g].match(E);if(!b)throw new Error("Invalid patch string: "+p[g]);var k=new h.patch_obj;for(u.push(k),k.start1=parseInt(b[1],10),b[2]===""?(k.start1--,k.length1=1):b[2]=="0"?k.length1=0:(k.start1--,k.length1=parseInt(b[2],10)),k.start2=parseInt(b[3],10),b[4]===""?(k.start2--,k.length2=1):b[4]=="0"?k.length2=0:(k.start2--,k.length2=parseInt(b[4],10)),g++;g<p.length;){var M=p[g].charAt(0);try{var x=decodeURI(p[g].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+x)}if(M=="-")k.diffs.push(new h.Diff(y,x));else if(M=="+")k.diffs.push(new h.Diff(C,x));else if(M==" ")k.diffs.push(new h.Diff(S,x));else{if(M=="@")break;if(M!=="")throw new Error('Invalid patch mode "'+M+'" in: '+x)}g++}}return u},h.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},h.patch_obj.prototype.toString=function(){var d,u;this.length1===0?d=this.start1+",0":this.length1==1?d=this.start1+1:d=this.start1+1+","+this.length1,this.length2===0?u=this.start2+",0":this.length2==1?u=this.start2+1:u=this.start2+1+","+this.length2;for(var p=["@@ -"+d+" +"+u+` @@
`],g,E=0;E<this.diffs.length;E++){switch(this.diffs[E][0]){case C:g="+";break;case y:g="-";break;case S:g=" ";break}p[E+1]=g+encodeURI(this.diffs[E][1])+`
`}return p.join("").replace(/%20/g," ")},m.exports=h,m.exports.diff_match_patch=h,m.exports.DIFF_DELETE=y,m.exports.DIFF_INSERT=C,m.exports.DIFF_EQUAL=S},923:(m,h,y)=>{y.d(h,{default:()=>De});var C=y(288),S=y(59),d=y(784),u=y(51),p=y(500),g=y(339),E=y(108),b=function(V){V===void 0&&(V=document);var U=function(j){var z=document.createElement("img");z.src=j.getAttribute("data-src"),z.addEventListener("load",function(){!j.getAttribute("style")&&!j.getAttribute("class")&&!j.getAttribute("width")&&!j.getAttribute("height")&&z.naturalHeight>z.naturalWidth&&z.naturalWidth/z.naturalHeight<document.querySelector(".vditor-reset").clientWidth/(window.innerHeight-40)&&z.naturalHeight>window.innerHeight-40&&(j.style.height=window.innerHeight-40+"px"),j.src=z.src}),j.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return V.querySelectorAll("img").forEach(function(j){j.getAttribute("data-src")&&U(j)}),!1;window.vditorImageIntersectionObserver?(window.vditorImageIntersectionObserver.disconnect(),V.querySelectorAll("img").forEach(function(j){window.vditorImageIntersectionObserver.observe(j)})):(window.vditorImageIntersectionObserver=new IntersectionObserver(function(j){j.forEach(function(z){(typeof z.isIntersecting>"u"?z.intersectionRatio!==0:z.isIntersecting)&&z.target.getAttribute("data-src")&&U(z.target)})}),V.querySelectorAll("img").forEach(function(j){window.vditorImageIntersectionObserver.observe(j)}))},k=y(960),M=y(0),x=y(975),A=y(931),v=y(597),O=y(162),I=y(70),R=y(591),P=y(913),B=y(873),W=y(161),G=y(598),re=y(905),de=function(V){document.querySelectorAll(".vditor-anchor").forEach(function(U){V===1&&U.classList.add("vditor-anchor--left"),U.onclick=function(){var j=U.getAttribute("href").substr(1),z=document.getElementById("vditorAnchor-"+j).offsetTop;document.querySelector("html").scrollTop=z}}),window.onhashchange=function(){var U=document.getElementById("vditorAnchor-"+decodeURIComponent(window.location.hash.substr(1)));U&&(document.querySelector("html").scrollTop=U.offsetTop)}},ve=y(796),ke=y(827),be=function(V,U){if(U===void 0&&(U="zh_CN"),!(typeof speechSynthesis>"u"||typeof SpeechSynthesisUtterance>"u")){var j=function(){var $e=speechSynthesis.getVoices(),ee,Oe;return $e.forEach(function(Ie){Ie.lang===U.replace("_","-")&&(ee=Ie),Ie.default&&(Oe=Ie)}),ee||(ee=Oe),ee},z='<svg><use xlink:href="#vditor-icon-play"></use></svg>',te='<svg><use xlink:href="#vditor-icon-pause"></use></svg>';document.getElementById("vditorIconScript")||(z='<svg viewBox="0 0 32 32"><path d="M3.436 0l25.128 16-25.128 16v-32z"></path></svg>',te='<svg viewBox="0 0 32 32"><path d="M20.617 0h9.128v32h-9.128v-32zM2.255 32v-32h9.128v32h-9.128z"></path></svg>');var K=document.querySelector(".vditor-speech");K||(K=document.createElement("button"),K.className="vditor-speech",V.insertAdjacentElement("beforeend",K),speechSynthesis.onvoiceschanged!==void 0&&(speechSynthesis.onvoiceschanged=j));var Se=j(),Ce=new SpeechSynthesisUtterance;Ce.voice=Se,Ce.onend=Ce.onerror=function(){K.style.display="none",speechSynthesis.cancel(),K.classList.remove("vditor-speech--current"),K.innerHTML=z},V.addEventListener(window.ontouchstart!==void 0?"touchend":"click",function($e){var ee=$e.target;if(ee.classList.contains("vditor-speech")||ee.parentElement.classList.contains("vditor-speech")){K.classList.contains("vditor-speech--current")?speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),K.innerHTML=te):(speechSynthesis.pause(),K.innerHTML=z)):(Ce.text=K.getAttribute("data-text"),speechSynthesis.speak(Ce),K.classList.add("vditor-speech--current"),K.innerHTML=te),(0,ke.jl)(window.vditorSpeechRange),V.focus();return}if(K.style.display="none",speechSynthesis.cancel(),K.classList.remove("vditor-speech--current"),K.innerHTML=z,getSelection().rangeCount!==0){var Oe=getSelection().getRangeAt(0),Ie=Oe.toString().trim();if(Ie){window.vditorSpeechRange=Oe.cloneRange();var Ze=Oe.getBoundingClientRect();K.innerHTML=z,K.style.display="block",K.style.top=Ze.top+Ze.height+document.querySelector("html").scrollTop-20+"px",window.ontouchstart!==void 0?K.style.left=$e.changedTouches[$e.changedTouches.length-1].pageX+2+"px":K.style.left=$e.clientX+2+"px",K.setAttribute("data-text",Ie)}}})}},we=function(V,U,j,z){function te(K){return K instanceof j?K:new j(function(Se){Se(K)})}return new(j||(j=Promise))(function(K,Se){function Ce(Oe){try{ee(z.next(Oe))}catch(Ie){Se(Ie)}}function $e(Oe){try{ee(z.throw(Oe))}catch(Ie){Se(Ie)}}function ee(Oe){Oe.done?K(Oe.value):te(Oe.value).then(Ce,$e)}ee((z=z.apply(V,U||[])).next())})},Ae=function(V,U){var j={label:0,sent:function(){if(K[0]&1)throw K[1];return K[1]},trys:[],ops:[]},z,te,K,Se;return Se={next:Ce(0),throw:Ce(1),return:Ce(2)},typeof Symbol=="function"&&(Se[Symbol.iterator]=function(){return this}),Se;function Ce(ee){return function(Oe){return $e([ee,Oe])}}function $e(ee){if(z)throw new TypeError("Generator is already executing.");for(;Se&&(Se=0,ee[0]&&(j=0)),j;)try{if(z=1,te&&(K=ee[0]&2?te.return:ee[0]?te.throw||((K=te.return)&&K.call(te),0):te.next)&&!(K=K.call(te,ee[1])).done)return K;switch(te=0,K&&(ee=[ee[0]&2,K.value]),ee[0]){case 0:case 1:K=ee;break;case 4:return j.label++,{value:ee[1],done:!1};case 5:j.label++,te=ee[1],ee=[0];continue;case 7:ee=j.ops.pop(),j.trys.pop();continue;default:if(K=j.trys,!(K=K.length>0&&K[K.length-1])&&(ee[0]===6||ee[0]===2)){j=0;continue}if(ee[0]===3&&(!K||ee[1]>K[0]&&ee[1]<K[3])){j.label=ee[1];break}if(ee[0]===6&&j.label<K[1]){j.label=K[1],K=ee;break}if(K&&j.label<K[2]){j.label=K[2],j.ops.push(ee);break}K[2]&&j.ops.pop(),j.trys.pop();continue}ee=U.call(V,j)}catch(Oe){ee=[6,Oe],te=0}finally{z=K=0}if(ee[0]&5)throw ee[1];return{value:ee[0]?ee[1]:void 0,done:!0}}},We=function(V){var U,j={anchor:0,cdn:P.Y.CDN,customEmoji:{},emojiPath:"".concat(P.Y.CDN,"/dist/images/emoji"),hljs:P.Y.HLJS_OPTIONS,icon:"ant",lang:"zh_CN",markdown:P.Y.MARKDOWN_OPTIONS,math:P.Y.MATH_OPTIONS,mode:"light",speech:{enable:!1},render:{media:{enable:!0}},theme:P.Y.THEME_OPTIONS};return V.cdn&&(!((U=V.theme)===null||U===void 0)&&U.path||(j.theme.path="".concat(V.cdn,"/dist/css/content-theme")),V.emojiPath||(j.emojiPath="".concat(V.cdn,"/dist/images/emoji"))),(0,re.h)(j,V)},me=function(V,U){var j=We(U);return(0,W.Z)("".concat(j.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){var z=(0,ve.X)({autoSpace:j.markdown.autoSpace,gfmAutoLink:j.markdown.gfmAutoLink,codeBlockPreview:j.markdown.codeBlockPreview,emojiSite:j.emojiPath,emojis:j.customEmoji,fixTermTypo:j.markdown.fixTermTypo,footnotes:j.markdown.footnotes,headingAnchor:j.anchor!==0,inlineMathDigit:j.math.inlineDigit,lazyLoadImage:j.lazyLoadImage,linkBase:j.markdown.linkBase,linkPrefix:j.markdown.linkPrefix,listStyle:j.markdown.listStyle,mark:j.markdown.mark,mathBlockPreview:j.markdown.mathBlockPreview,paragraphBeginningSpace:j.markdown.paragraphBeginningSpace,sanitize:j.markdown.sanitize,toc:j.markdown.toc});return U!=null&&U.renderers&&z.SetJSRenderers({renderers:{Md2HTML:U.renderers}}),z.SetHeadingID(!0),z.Md2HTML(V)})},N=function(V,U,j){return we(void 0,void 0,void 0,function(){var z,te,K,Se;return Ae(this,function(Ce){switch(Ce.label){case 0:return z=We(j),[4,me(U,z)];case 1:if(te=Ce.sent(),z.transform&&(te=z.transform(te)),V.innerHTML=te,V.classList.add("vditor-reset"),z.i18n)return[3,5];if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(z.lang))return[3,2];throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");case 2:return K="vditorI18nScript",Se=K+z.lang,document.querySelectorAll('head script[id^="'.concat(K,'"]')).forEach(function($e){$e.id!==Se&&document.head.removeChild($e)}),[4,(0,W.Z)("".concat(z.cdn,"/dist/js/i18n/").concat(z.lang,".js"),Se)];case 3:Ce.sent(),Ce.label=4;case 4:return[3,6];case 5:window.VditorI18n=z.i18n,Ce.label=6;case 6:return z.icon?[4,(0,W.Z)("".concat(z.cdn,"/dist/js/icons/").concat(z.icon,".js"),"vditorIconScript")]:[3,8];case 7:Ce.sent(),Ce.label=8;case 8:return(0,B.H)(z.theme.current,z.theme.path),z.anchor===1&&V.classList.add("vditor-reset--anchor"),(0,u.o)(V,z.hljs),(0,E.$)(z.hljs,V,z.cdn),(0,k.T)(V,{cdn:z.cdn,math:z.math}),(0,x.e)(V,z.cdn,z.mode),(0,A.Y)(V,z.cdn,z.mode),(0,v.K)(V,z.cdn),(0,p.D)(V,z.cdn),(0,g.m)(V,z.cdn),(0,d.v)(V,z.cdn,z.mode),(0,O.l)(V,z.cdn,z.mode),(0,R.M)(V,z.cdn),(0,C.$)(V,z.cdn),z.render.media.enable&&(0,M.l)(V),z.speech.enable&&be(V),z.anchor!==0&&de(z.anchor),z.after&&z.after(),z.lazyLoadImage&&b(V),V.addEventListener("click",function($e){var ee=(0,G._Y)($e.target,"SPAN");if(ee&&(0,G.KJ)(ee,"vditor-toc")){var Oe=V.querySelector("#"+ee.getAttribute("data-target-id"));Oe&&window.scrollTo(window.scrollX,Oe.offsetTop);return}}),[2]}})})},X=y(726),Z=y(13),Ee=function(){function V(){}return V.adapterRender=S,V.previewImage=X.o,V.codeRender=u.o,V.graphvizRender=g.m,V.highlightRender=E.$,V.mathRender=k.T,V.mermaidRender=x.e,V.SMILESRender=A.Y,V.markmapRender=v.K,V.flowchartRender=p.D,V.chartRender=d.v,V.abcRender=C.$,V.mindmapRender=O.l,V.plantumlRender=R.M,V.outlineRender=I.N,V.mediaRender=M.l,V.speechRender=be,V.lazyLoadImageRender=b,V.md2html=me,V.preview=N,V.setCodeTheme=Z.h,V.setContentTheme=B.H,V}();const De=Ee},913:(m,h,y)=>{y.d(h,{Y:()=>S,g:()=>C});var C="3.10.9",S=function(){function d(){}return d.ZWSP="​",d.DROP_EDITOR="application/editor",d.MOBILE_WIDTH=520,d.CLASS_MENU_DISABLED="vditor-menu--disabled",d.EDIT_TOOLBARS=["emoji","headings","bold","italic","strike","link","list","ordered-list","outdent","indent","check","line","quote","code","inline-code","insert-after","insert-before","upload","record","table"],d.CODE_THEME=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","panda-syntax-dark","paraiso-dark","pojoaque","qtcreator-dark","rainbow","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256","ant-design","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","panda-syntax-light","paraiso-light","purebasic","qtcreator-light","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],d.ALIAS_CODE_LANGUAGES=["abc","plantuml","mermaid","flowchart","echarts","mindmap","graphviz","math","markmap","smiles","js","ts","html","toml","c#","bat"],d.CDN="https://unpkg.com/vditor@".concat("3.10.9"),d.MARKDOWN_OPTIONS={autoSpace:!1,gfmAutoLink:!0,codeBlockPreview:!0,fixTermTypo:!1,footnotes:!0,linkBase:"",linkPrefix:"",listStyle:!1,mark:!1,mathBlockPreview:!0,paragraphBeginningSpace:!1,sanitize:!0,toc:!1},d.HLJS_OPTIONS={enable:!0,lineNumber:!1,defaultLang:"",style:"github"},d.MATH_OPTIONS={engine:"KaTeX",inlineDigit:!1,macros:{}},d.THEME_OPTIONS={current:"light",list:{"ant-design":"Ant Design",dark:"Dark",light:"Light",wechat:"WeChat"},path:"".concat(d.CDN,"/dist/css/content-theme")},d}()},931:(m,h,y)=>{y.d(h,{Y:()=>p});var C=y(913),S=y(161),d=y(59),u=y(933),p=function(g,E,b){g===void 0&&(g=document),E===void 0&&(E=C.Y.CDN);var k=d.SMILESRenderAdapter.getElements(g);k.length>0&&(0,S.Z)("".concat(E,"/dist/js/smiles-drawer/smiles-drawer.min.js?v=2.1.7"),"vditorAbcjsScript").then(function(){var M=new SmiDrawer({},{});k.forEach(function(x){var A=d.SMILESRenderAdapter.getCode(x).trim();if(!(x.getAttribute("data-processed")==="true"||A.trim()==="")){var v="smiles"+(0,u.Ee)();x.innerHTML='<svg id="'.concat(v,'"></svg>'),M.draw(A,"#"+v,b==="dark"?"dark":void 0),x.setAttribute("data-processed","true")}})})}},288:(m,h,y)=>{y.d(h,{$:()=>u});var C=y(913),S=y(161),d=y(59),u=function(p,g){p===void 0&&(p=document),g===void 0&&(g=C.Y.CDN);var E=d.abcRenderAdapter.getElements(p);E.length>0&&(0,S.Z)("".concat(g,"/dist/js/abcjs/abcjs_basic.min.js"),"vditorAbcjsScript").then(function(){E.forEach(function(b){b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre")||b.getAttribute("data-processed")!=="true"&&(ABCJS.renderAbc(b,d.abcRenderAdapter.getCode(b).trim()),b.style.overflowX="auto",b.setAttribute("data-processed","true"))})})}},59:(m,h,y)=>{y.r(h),y.d(h,{SMILESRenderAdapter:()=>S,abcRenderAdapter:()=>E,chartRenderAdapter:()=>g,flowchartRenderAdapter:()=>k,graphvizRenderAdapter:()=>b,markmapRenderAdapter:()=>u,mathRenderAdapter:()=>C,mermaidRenderAdapter:()=>d,mindmapRenderAdapter:()=>p,plantumlRenderAdapter:()=>M});var C={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-math")}},S={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-smiles")}},d={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-mermaid")}},u={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-markmap")}},p={getCode:function(x){return x.getAttribute("data-code")},getElements:function(x){return x.querySelectorAll(".language-mindmap")}},g={getCode:function(x){return x.innerText},getElements:function(x){return x.querySelectorAll(".language-echarts")}},E={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-abc")}},b={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-graphviz")}},k={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-flowchart")}},M={getCode:function(x){return x.textContent},getElements:function(x){return x.querySelectorAll(".language-plantuml")}}},784:(m,h,y)=>{y.d(h,{v:()=>E});var C=y(913),S=y(161),d=y(59),u=y(933),p=function(b,k,M,x){function A(v){return v instanceof M?v:new M(function(O){O(v)})}return new(M||(M=Promise))(function(v,O){function I(B){try{P(x.next(B))}catch(W){O(W)}}function R(B){try{P(x.throw(B))}catch(W){O(W)}}function P(B){B.done?v(B.value):A(B.value).then(I,R)}P((x=x.apply(b,k||[])).next())})},g=function(b,k){var M={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},x,A,v,O;return O={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function I(P){return function(B){return R([P,B])}}function R(P){if(x)throw new TypeError("Generator is already executing.");for(;O&&(O=0,P[0]&&(M=0)),M;)try{if(x=1,A&&(v=P[0]&2?A.return:P[0]?A.throw||((v=A.return)&&v.call(A),0):A.next)&&!(v=v.call(A,P[1])).done)return v;switch(A=0,v&&(P=[P[0]&2,v.value]),P[0]){case 0:case 1:v=P;break;case 4:return M.label++,{value:P[1],done:!1};case 5:M.label++,A=P[1],P=[0];continue;case 7:P=M.ops.pop(),M.trys.pop();continue;default:if(v=M.trys,!(v=v.length>0&&v[v.length-1])&&(P[0]===6||P[0]===2)){M=0;continue}if(P[0]===3&&(!v||P[1]>v[0]&&P[1]<v[3])){M.label=P[1];break}if(P[0]===6&&M.label<v[1]){M.label=v[1],v=P;break}if(v&&M.label<v[2]){M.label=v[2],M.ops.push(P);break}v[2]&&M.ops.pop(),M.trys.pop();continue}P=k.call(b,M)}catch(B){P=[6,B],A=0}finally{x=v=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},E=function(b,k,M){b===void 0&&(b=document),k===void 0&&(k=C.Y.CDN);var x=d.chartRenderAdapter.getElements(b);x.length>0&&(0,S.Z)("".concat(k,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){x.forEach(function(A){return p(void 0,void 0,void 0,function(){var v,O,I;return g(this,function(R){switch(R.label){case 0:if(A.parentElement.classList.contains("vditor-wysiwyg__pre")||A.parentElement.classList.contains("vditor-ir__marker--pre"))return[2];if(v=d.chartRenderAdapter.getCode(A).trim(),!v)return[2];R.label=1;case 1:return R.trys.push([1,3,,4]),A.getAttribute("data-processed")==="true"?[2]:[4,(0,u.kY)(v)];case 2:return O=R.sent(),echarts.init(A,M==="dark"?"dark":void 0).setOption(O),A.setAttribute("data-processed","true"),[3,4];case 3:return I=R.sent(),A.className="vditor-reset--error",A.innerHTML="echarts render error: <br>".concat(I),[3,4];case 4:return[2]}})})})})}},51:(m,h,y)=>{y.d(h,{o:()=>d});var C=y(695),S=y(913),d=function(u,p){Array.from(u.querySelectorAll("pre > code")).filter(function(g,E){return!(g.parentElement.classList.contains("vditor-wysiwyg__pre")||g.parentElement.classList.contains("vditor-ir__marker--pre")||g.classList.contains("language-mermaid")||g.classList.contains("language-flowchart")||g.classList.contains("language-echarts")||g.classList.contains("language-mindmap")||g.classList.contains("language-plantuml")||g.classList.contains("language-markmap")||g.classList.contains("language-abc")||g.classList.contains("language-graphviz")||g.classList.contains("language-math")||g.classList.contains("language-smiles")||g.style.maxHeight.indexOf("px")>-1||u.classList.contains("vditor-preview")&&E>5)}).forEach(function(g){var E,b,k,M=g.innerText;if(g.classList.contains("highlight-chroma")){var x=g.cloneNode(!0);x.querySelectorAll(".highlight-ln").forEach(function(I){I.remove()}),M=x.innerText}else M.endsWith(`
`)&&(M=M.substr(0,M.length-1));var A='<svg><use xlink:href="#vditor-icon-copy"></use></svg>';document.getElementById("vditorIconScript")||(A='<svg viewBox="0 0 32 32"><path d="M22.545-0h-17.455c-1.6 0-2.909 1.309-2.909 2.909v20.364h2.909v-20.364h17.455v-2.909zM26.909 5.818h-16c-1.6 0-2.909 1.309-2.909 2.909v20.364c0 1.6 1.309 2.909 2.909 2.909h16c1.6 0 2.909-1.309 2.909-2.909v-20.364c0-1.6-1.309-2.909-2.909-2.909zM26.909 29.091h-16v-20.364h16v20.364z"></path></svg>');var v=document.createElement("div");v.className="vditor-copy",v.innerHTML='<span aria-label="'.concat(((E=window.VditorI18n)===null||E===void 0?void 0:E.copy)||"复制",`"
onmouseover="this.setAttribute('aria-label', '`).concat(((b=window.VditorI18n)===null||b===void 0?void 0:b.copy)||"复制",`')"
class="vditor-tooltipped vditor-tooltipped__w"
onclick="this.previousElementSibling.select();document.execCommand('copy');this.setAttribute('aria-label', '`).concat(((k=window.VditorI18n)===null||k===void 0?void 0:k.copied)||"已复制",`');this.previousElementSibling.blur()">`).concat(A,"</span>");var O=document.createElement("textarea");O.value=(0,C.p)(M),v.insertAdjacentElement("afterbegin",O),p&&p.renderMenu&&p.renderMenu(g,v),g.before(v),g.style.maxHeight=window.outerHeight-40+"px",g.insertAdjacentHTML("afterend",'<span style="position: absolute">'.concat(S.Y.ZWSP,"</span>"))})}},500:(m,h,y)=>{y.d(h,{D:()=>u});var C=y(913),S=y(161),d=y(59),u=function(p,g){g===void 0&&(g=C.Y.CDN);var E=d.flowchartRenderAdapter.getElements(p);E.length!==0&&(0,S.Z)("".concat(g,"/dist/js/flowchart.js/flowchart.min.js"),"vditorFlowchartScript").then(function(){E.forEach(function(b){if(b.getAttribute("data-processed")!=="true"){var k=flowchart.parse(d.flowchartRenderAdapter.getCode(b));b.innerHTML="",k.drawSVG(b),b.setAttribute("data-processed","true")}})})}},339:(m,h,y)=>{y.d(h,{m:()=>u});var C=y(913),S=y(161),d=y(59),u=function(p,g){g===void 0&&(g=C.Y.CDN);var E=d.graphvizRenderAdapter.getElements(p);E.length!==0&&(0,S.Z)("".concat(g,"/dist/js/graphviz/viz.js"),"vditorGraphVizScript").then(function(){E.forEach(function(b){var k=d.graphvizRenderAdapter.getCode(b);if(!(b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre"))&&!(b.getAttribute("data-processed")==="true"||k.trim()==="")){try{var M=new Blob(["importScripts('".concat(document.getElementById("vditorGraphVizScript").src.replace("viz.js","full.render.js"),"');")],{type:"application/javascript"}),x=window.URL||window.webkitURL,A=x.createObjectURL(M),v=new Worker(A);new Viz({worker:v}).renderSVGElement(k).then(function(O){b.innerHTML=O.outerHTML}).catch(function(O){b.innerHTML="graphviz render error: <br>".concat(O),b.className="vditor-reset--error"})}catch(O){console.error("graphviz error",O)}b.setAttribute("data-processed","true")}})})}},108:(m,h,y)=>{y.d(h,{$:()=>u});var C=y(913),S=y(161),d=y(505),u=function(p,g,E){g===void 0&&(g=document),E===void 0&&(E=C.Y.CDN);var b=p.style;C.Y.CODE_THEME.includes(b)||(b="github");var k=document.getElementById("vditorHljsStyle"),M="".concat(E,"/dist/js/highlight.js/styles/").concat(b,".min.css");if(k&&k.getAttribute("href")!==M&&k.remove(),(0,d.T)("".concat(E,"/dist/js/highlight.js/styles/").concat(b,".min.css"),"vditorHljsStyle"),p.enable!==!1){var x=g.querySelectorAll("pre > code");x.length!==0&&(0,S.Z)("".concat(E,"/dist/js/highlight.js/highlight.min.js?v=11.7.0"),"vditorHljsScript").then(function(){(0,S.Z)("".concat(E,"/dist/js/highlight.js/third-languages.js?v=1.0.1"),"vditorHljsThirdScript").then(function(){g.querySelectorAll("pre > code").forEach(function(A){if(!(A.parentElement.classList.contains("vditor-ir__marker--pre")||A.parentElement.classList.contains("vditor-wysiwyg__pre"))&&!(A.classList.contains("language-mermaid")||A.classList.contains("language-flowchart")||A.classList.contains("language-echarts")||A.classList.contains("language-mindmap")||A.classList.contains("language-plantuml")||A.classList.contains("language-smiles")||A.classList.contains("language-abc")||A.classList.contains("language-graphviz")||A.classList.contains("language-math"))){p.defaultLang!==""&&A.className.indexOf("language-")===-1&&A.classList.add("language-"+p.defaultLang);var v=A.className.replace("language-","");if(window.hljs.getLanguage(v)||(v="plaintext"),A.innerHTML=window.hljs.highlight(A.textContent,{language:v,ignoreIllegals:!0}).value,A.classList.add("hljs"),!!p.lineNumber){A.classList.add("vditor-linenumber");var O=A.querySelector(".vditor-linenumber__temp");O||(O=document.createElement("div"),O.className="vditor-linenumber__temp",A.insertAdjacentElement("beforeend",O));var I=getComputedStyle(A).whiteSpace,R=!1;(I==="pre-wrap"||I==="pre-line")&&(R=!0);var P="",B=A.textContent.split(/\r\n|\r|\n/g);B.pop(),B.map(function(W){var G="";R&&(O.textContent=W||`
`,G=' style="height:'.concat(O.getBoundingClientRect().height,'px"')),P+="<span".concat(G,"></span>")}),O.style.display="none",P='<span class="vditor-linenumber__rows">'.concat(P,"</span>"),A.insertAdjacentHTML("beforeend",P)}}})})})}}},597:(m,h,y)=>{y.d(h,{K:()=>E});var C=y(913),S=y(161),d=y(59),u={},p=function(b,k){var M=b.transform(k),x=Object.keys(M.features).filter(function(R){return!u[R]});x.forEach(function(R){u[R]=!0});var A=b.getAssets(x),v=A.styles,O=A.scripts,I=window.markmap;return v&&I.loadCSS(v),O&&I.loadJS(O),M},g=function(b,k){var M=window.markmap,x=M.Transformer,A=M.Markmap,v=M.deriveOptions;M.globalCSS;var O=new x;b.innerHTML='<svg style="width:100%"></svg>';var I=b.firstChild,R=A.create(I,null),P=p(O,k),B=P.root,W=P.frontmatter,G=W==null?void 0:W.markmap,re=v(G);R.setData(B,re),R.fit()},E=function(b,k){b===void 0&&(b=document),k===void 0&&(k=C.Y.CDN);var M=d.markmapRenderAdapter.getElements(b);M.length!==0&&(0,S.Z)("".concat(k,"/dist/js/markmap/markmap.min.js"),"vditorMarkerScript").then(function(){M.forEach(function(x){var A=d.markmapRenderAdapter.getCode(x);if(!(x.getAttribute("data-processed")==="true"||A.trim()==="")){var v=document.createElement("div");v.className="language-markmap",x.parentNode.appendChild(v),g(v,A),x.parentNode.childNodes[0].nodeName=="CODE"&&x.parentNode.removeChild(x.parentNode.childNodes[0])}})})}},960:(m,h,y)=>{y.d(h,{T:()=>g});var C=y(913),S=y(161),d=y(505),u=y(695),p=y(59),g=function(E,b){E===void 0&&(E=document);var k=p.mathRenderAdapter.getElements(E);if(k.length!==0){var M={cdn:C.Y.CDN,math:{engine:"KaTeX",inlineDigit:!1,macros:{}}};if(b&&b.math&&(b.math=Object.assign({},M.math,b.math)),b=Object.assign({},M,b),b.math.engine==="KaTeX")(0,d.T)("".concat(b.cdn,"/dist/js/katex/katex.min.css?v=0.16.9"),"vditorKatexStyle"),(0,S.Z)("".concat(b.cdn,"/dist/js/katex/katex.min.js?v=0.16.9"),"vditorKatexScript").then(function(){(0,S.Z)("".concat(b.cdn,"/dist/js/katex/mhchem.min.js?v=0.16.9"),"vditorKatexChemScript").then(function(){k.forEach(function(v){if(!(v.parentElement.classList.contains("vditor-wysiwyg__pre")||v.parentElement.classList.contains("vditor-ir__marker--pre"))&&!v.getAttribute("data-math")){var O=(0,u.p)(p.mathRenderAdapter.getCode(v));v.setAttribute("data-math",O);try{v.innerHTML=katex.renderToString(O,{displayMode:v.tagName==="DIV",output:"html",macros:b.math.macros})}catch(I){v.innerHTML=I.message,v.className="language-math vditor-reset--error"}v.addEventListener("copy",function(I){I.stopPropagation(),I.preventDefault();var R=I.currentTarget.closest(".language-math");I.clipboardData.setData("text/html",R.innerHTML),I.clipboardData.setData("text/plain",R.getAttribute("data-math"))})}})})});else if(b.math.engine==="MathJax"){var x=function(v){if(v.length!==0){var O=0,I=v[v.length-1],R=function(){var P=v[O++];P===I?P():P(R)};R()}};window.MathJax||(window.MathJax={loader:{paths:{mathjax:"".concat(b.cdn,"/dist/js/mathjax")}},startup:{typeset:!1},tex:{macros:b.math.macros}},Object.assign(window.MathJax,b.math.mathJaxOptions)),(0,S.U)("".concat(b.cdn,"/dist/js/mathjax/tex-svg-full.js"),"protyleMathJaxScript");var A=function(v,O){var I=(0,u.p)(v.textContent).trim(),R=window.MathJax.getMetricsFor(v);R.display=v.tagName==="DIV",window.MathJax.tex2svgPromise(I,R).then(function(P){v.innerHTML="",v.setAttribute("data-math",I),v.append(P),window.MathJax.startup.document.clear(),window.MathJax.startup.document.updateDocument();var B=P.querySelector('[data-mml-node="merror"]');B&&B.textContent.trim()!==""&&(v.innerHTML=B.textContent.trim(),v.className="vditor-reset--error"),O&&O()})};window.MathJax.startup.promise.then(function(){for(var v=[],O=function(R){var P=k[R];!P.parentElement.classList.contains("vditor-wysiwyg__pre")&&!P.parentElement.classList.contains("vditor-ir__marker--pre")&&!P.getAttribute("data-math")&&(0,u.p)(P.textContent).trim()&&v.push(function(B){R===k.length-1?A(P):A(P,B)})},I=0;I<k.length;I++)O(I);x(v)})}}}},0:(m,h,y)=>{y.d(h,{l:()=>p});var C=y(933),S=function(g,E){g.insertAdjacentHTML("afterend",'<video controls="controls" src="'.concat(E,'"></video>')),g.remove()},d=function(g,E){g.insertAdjacentHTML("afterend",'<audio controls="controls" src="'.concat(E,'"></audio>')),g.remove()},u=function(g,E){var b=E.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),k=E.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),M=E.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),x=E.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),A=E.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),v=E.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),O=E.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),I=E.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/);if(b&&b[1].length===11)g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//www.youtube.com/embed/'.concat(b[1]+(b[2]?"?start="+b[2]:""),'"></iframe>')),g.remove();else if(k&&k[1])g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//player.youku.com/embed/'.concat(k[1],'"></iframe>')),g.remove();else if(M&&M[1])g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="https://v.qq.com/txp/iframe/player.html?vid='.concat(M[1],'"></iframe>')),g.remove();else if(x&&x[1])g.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="//coub.com/embed/`.concat(x[1],'?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>')),g.remove();else if(A&&A[0])g.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.facebook.com/plugins/video.php?href=`.concat(encodeURIComponent(A[0]),'"></iframe>')),g.remove();else if(v&&v[2])g.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.dailymotion.com/embed/video/`.concat(v[2],'"></iframe>')),g.remove();else if(E.indexOf("bilibili.com")>-1&&(E.indexOf("bvid=")>-1||O&&O[1])){var R={bvid:(0,C.TK)("bvid",E)||O&&O[1],page:"1",high_quality:"1",as_wide:"1",allowfullscreen:"true",autoplay:"0"};new URL(E.startsWith("http")?E:"https:"+E).search.split("&").forEach(function(W,G){if(W){G===0&&(W=W.substr(1));var re=W.split("=");R[re[0]]=re[1]}});var P="https://player.bilibili.com/player.html?",B=Object.keys(R);B.forEach(function(W,G){P+="".concat(W,"=").concat(R[W]),G<B.length-1&&(P+="&")}),g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="'.concat(P,'"></iframe>')),g.remove()}else I&&I[1]&&(g.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//embed.ted.com/talks/'.concat(I[1],'"></iframe>')),g.remove())},p=function(g){g&&g.querySelectorAll("a").forEach(function(E){var b=E.getAttribute("href");b&&(b.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?S(E,b):b.match(/^.+.(mp3|wav|flac)$/)?d(E,b):u(E,b))})}},975:(m,h,y)=>{y.d(h,{e:()=>E});var C=y(913),S=y(161),d=y(59),u=y(933),p=function(b,k,M,x){function A(v){return v instanceof M?v:new M(function(O){O(v)})}return new(M||(M=Promise))(function(v,O){function I(B){try{P(x.next(B))}catch(W){O(W)}}function R(B){try{P(x.throw(B))}catch(W){O(W)}}function P(B){B.done?v(B.value):A(B.value).then(I,R)}P((x=x.apply(b,k||[])).next())})},g=function(b,k){var M={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},x,A,v,O;return O={next:I(0),throw:I(1),return:I(2)},typeof Symbol=="function"&&(O[Symbol.iterator]=function(){return this}),O;function I(P){return function(B){return R([P,B])}}function R(P){if(x)throw new TypeError("Generator is already executing.");for(;O&&(O=0,P[0]&&(M=0)),M;)try{if(x=1,A&&(v=P[0]&2?A.return:P[0]?A.throw||((v=A.return)&&v.call(A),0):A.next)&&!(v=v.call(A,P[1])).done)return v;switch(A=0,v&&(P=[P[0]&2,v.value]),P[0]){case 0:case 1:v=P;break;case 4:return M.label++,{value:P[1],done:!1};case 5:M.label++,A=P[1],P=[0];continue;case 7:P=M.ops.pop(),M.trys.pop();continue;default:if(v=M.trys,!(v=v.length>0&&v[v.length-1])&&(P[0]===6||P[0]===2)){M=0;continue}if(P[0]===3&&(!v||P[1]>v[0]&&P[1]<v[3])){M.label=P[1];break}if(P[0]===6&&M.label<v[1]){M.label=v[1],v=P;break}if(v&&M.label<v[2]){M.label=v[2],M.ops.push(P);break}v[2]&&M.ops.pop(),M.trys.pop();continue}P=k.call(b,M)}catch(B){P=[6,B],A=0}finally{x=v=0}if(P[0]&5)throw P[1];return{value:P[0]?P[1]:void 0,done:!0}}},E=function(b,k,M){b===void 0&&(b=document),k===void 0&&(k=C.Y.CDN);var x=d.mermaidRenderAdapter.getElements(b);x.length!==0&&(0,S.Z)("".concat(k,"/dist/js/mermaid/mermaid.min.js"),"vditorMermaidScript").then(function(){var A={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8,showSequenceNumbers:!0},gantt:{leftPadding:75,rightPadding:20}};M==="dark"&&(A.theme="dark"),mermaid.initialize(A),x.forEach(function(v){return p(void 0,void 0,void 0,function(){var O,I,R,P,B;return g(this,function(W){switch(W.label){case 0:if(O=d.mermaidRenderAdapter.getCode(v),v.getAttribute("data-processed")==="true"||O.trim()==="")return[2];I="mermaid"+(0,u.Ee)(),W.label=1;case 1:return W.trys.push([1,3,,4]),[4,mermaid.render(I,v.textContent)];case 2:return R=W.sent(),v.innerHTML=R.svg,[3,4];case 3:return P=W.sent(),B=document.querySelector("#"+I),v.innerHTML="".concat(B.outerHTML,`<br>
<div style="text-align: left"><small>`).concat(P.message.replace(/\n/,"<br>"),"</small></div>"),B.parentElement.remove(),[3,4];case 4:return v.setAttribute("data-processed","true"),[2]}})})})})}},162:(m,h,y)=>{y.d(h,{l:()=>u});var C=y(913),S=y(161),d=y(59),u=function(p,g,E){p===void 0&&(p=document),g===void 0&&(g=C.Y.CDN);var b=d.mindmapRenderAdapter.getElements(p);b.length>0&&(0,S.Z)("".concat(g,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){b.forEach(function(k){if(!(k.parentElement.classList.contains("vditor-wysiwyg__pre")||k.parentElement.classList.contains("vditor-ir__marker--pre"))){var M=d.mindmapRenderAdapter.getCode(k);if(M)try{if(k.getAttribute("data-processed")==="true")return;echarts.init(k,E==="dark"?"dark":void 0).setOption({series:[{data:[JSON.parse(decodeURIComponent(M))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:function(x,A){var v;return!((v=A==null?void 0:A.data)===null||v===void 0)&&v.children?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"}}),k.setAttribute("data-processed","true")}catch(x){k.className="vditor-reset--error",k.innerHTML="mindmap render error: <br>".concat(x)}}})})}},70:(m,h,y)=>{y.d(h,{N:()=>d});var C=y(164),S=y(960),d=function(u,p,g){var E="",b=[];if(Array.from(u.children).forEach(function(A,v){if((0,C.c)(A)){if(g){var O=A.id.lastIndexOf("_");A.id=A.id.substring(0,O===-1?void 0:O)+"_"+v}b.push(A.id),E+=A.outerHTML.replace("<wbr>","")}}),E==="")return p.innerHTML="","";var k=document.createElement("div");if(g)g.lute.SetToC(!0),g.currentMode==="wysiwyg"&&!g.preview.element.contains(u)?k.innerHTML=g.lute.SpinVditorDOM("<p>[ToC]</p>"+E):g.currentMode==="ir"&&!g.preview.element.contains(u)?k.innerHTML=g.lute.SpinVditorIRDOM("<p>[ToC]</p>"+E):k.innerHTML=g.lute.HTML2VditorDOM("<p>[ToC]</p>"+E),g.lute.SetToC(g.options.preview.markdown.toc);else{p.classList.add("vditor-outline");var M=Lute.New();M.SetToC(!0),k.innerHTML=M.HTML2VditorDOM("<p>[ToC]</p>"+E)}var x=k.firstElementChild.querySelectorAll("li > span[data-target-id]");return x.forEach(function(A,v){if(A.nextElementSibling&&A.nextElementSibling.tagName==="UL"){var O="<svg class='vditor-outline__action'><use xlink:href='#vditor-icon-down'></use></svg>";document.getElementById("vditorIconScript")||(O='<svg class="vditor-outline__action" viewBox="0 0 32 32"><path d="M3.76 6.12l12.24 12.213 12.24-12.213 3.76 3.76-16 16-16-16 3.76-3.76z"></path></svg>'),A.innerHTML="".concat(O,"<span>").concat(A.innerHTML,"</span>")}else A.innerHTML="<svg></svg><span>".concat(A.innerHTML,"</span>");A.setAttribute("data-target-id",b[v])}),E=k.firstElementChild.innerHTML,x.length===0?(p.innerHTML="",E):(p.innerHTML=E,g&&(0,S.T)(p,{cdn:g.options.cdn,math:g.options.preview.math}),p.firstElementChild.addEventListener("click",function(A){for(var v=A.target;v&&!v.isEqualNode(p);){if(v.classList.contains("vditor-outline__action")){v.classList.contains("vditor-outline__action--close")?(v.classList.remove("vditor-outline__action--close"),v.parentElement.nextElementSibling.setAttribute("style","display:block")):(v.classList.add("vditor-outline__action--close"),v.parentElement.nextElementSibling.setAttribute("style","display:none")),A.preventDefault(),A.stopPropagation();break}else if(v.getAttribute("data-target-id")){A.preventDefault(),A.stopPropagation();var O=document.getElementById(v.getAttribute("data-target-id"));if(!O)return;if(g)if(g.options.height==="auto"){var I=O.offsetTop+g.element.offsetTop;g.options.toolbarConfig.pin||(I+=g.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,I)}else g.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,g.element.offsetTop),g.preview.element.contains(u)?u.parentElement.scrollTop=O.offsetTop:u.scrollTop=O.offsetTop;else window.scrollTo(window.scrollX,O.offsetTop);break}v=v.parentElement}}),E)}},591:(m,h,y)=>{y.d(h,{M:()=>u});var C=y(913),S=y(161),d=y(59),u=function(p,g){p===void 0&&(p=document),g===void 0&&(g=C.Y.CDN);var E=d.plantumlRenderAdapter.getElements(p);E.length!==0&&(0,S.Z)("".concat(g,"/dist/js/plantuml/plantuml-encoder.min.js"),"vditorPlantumlScript").then(function(){E.forEach(function(b){if(!(b.parentElement.classList.contains("vditor-wysiwyg__pre")||b.parentElement.classList.contains("vditor-ir__marker--pre"))){var k=d.plantumlRenderAdapter.getCode(b).trim();if(k)try{b.innerHTML='<object type="image/svg+xml" data="https://www.plantuml.com/plantuml/svg/~1'.concat(plantumlEncoder.encode(k),'"/>')}catch(M){b.className="vditor-reset--error",b.innerHTML="plantuml render error: <br>".concat(M)}}})})}},796:(m,h,y)=>{y.d(h,{X:()=>C});var C=function(S){var d=Lute.New();return d.PutEmojis(S.emojis),d.SetEmojiSite(S.emojiSite),d.SetHeadingAnchor(S.headingAnchor),d.SetInlineMathAllowDigitAfterOpenMarker(S.inlineMathDigit),d.SetAutoSpace(S.autoSpace),d.SetToC(S.toc),d.SetFootnotes(S.footnotes),d.SetFixTermTypo(S.fixTermTypo),d.SetVditorCodeBlockPreview(S.codeBlockPreview),d.SetVditorMathBlockPreview(S.mathBlockPreview),d.SetSanitize(S.sanitize),d.SetChineseParagraphBeginningSpace(S.paragraphBeginningSpace),d.SetRenderListStyle(S.listStyle),d.SetLinkBase(S.linkBase),d.SetLinkPrefix(S.linkPrefix),d.SetMark(S.mark),d.SetGFMAutoLink(S.gfmAutoLink),S.lazyLoadImage&&d.SetImageLazyLoading(S.lazyLoadImage),d}},726:(m,h,y)=>{y.d(h,{o:()=>C});var C=function(S,d,u){u===void 0&&(u="classic");var p=S.getBoundingClientRect(),g=36;document.body.insertAdjacentHTML("beforeend",'<div class="vditor vditor-img'.concat(u==="dark"?" vditor--dark":"",`">
    <div class="vditor-img__bar">
      <span class="vditor-img__btn" data-deg="0">
        <svg><use xlink:href="#vditor-icon-redo"></use></svg>
        `).concat(window.VditorI18n.spin,`
      </span>
      <span class="vditor-img__btn"  onclick="this.parentElement.parentElement.outerHTML = '';document.body.style.overflow = ''">
        X &nbsp;`).concat(window.VditorI18n.close,`
      </span>
    </div>
    <div class="vditor-img__img" onclick="this.parentElement.outerHTML = '';document.body.style.overflow = ''">
      <img style="width: `).concat(S.width,"px;height:").concat(S.height,"px;transform: translate3d(").concat(p.left,"px, ").concat(p.top-g,'px, 0)" src="').concat(S.getAttribute("src"),`">
    </div>
</div>`)),document.body.style.overflow="hidden";var E=document.querySelector(".vditor-img img"),b="translate3d(".concat(Math.max(0,window.innerWidth-S.naturalWidth)/2,"px, ").concat(Math.max(0,window.innerHeight-g-S.naturalHeight)/2,"px, 0)");setTimeout(function(){E.setAttribute("style","transition: transform .3s ease-in-out;transform: ".concat(b)),setTimeout(function(){E.parentElement.scrollTo((E.parentElement.scrollWidth-E.parentElement.clientWidth)/2,(E.parentElement.scrollHeight-E.parentElement.clientHeight)/2)},400)});var k=document.querySelector(".vditor-img__btn");k.addEventListener("click",function(){var M=parseInt(k.getAttribute("data-deg"),10)+90;M/90%2===1&&S.naturalWidth>E.parentElement.clientHeight?E.style.transform="translate3d(".concat(Math.max(0,window.innerWidth-S.naturalWidth)/2,"px, ").concat(S.naturalWidth/2-S.naturalHeight/2,"px, 0) rotateZ(").concat(M,"deg)"):E.style.transform="".concat(b," rotateZ(").concat(M,"deg)"),k.setAttribute("data-deg",M.toString()),setTimeout(function(){E.parentElement.scrollTo((E.parentElement.scrollWidth-E.parentElement.clientWidth)/2,(E.parentElement.scrollHeight-E.parentElement.clientHeight)/2)},400)})}},13:(m,h,y)=>{y.d(h,{h:()=>d});var C=y(913),S=y(505),d=function(u,p){p===void 0&&(p=C.Y.CDN),C.Y.CODE_THEME.includes(u)||(u="github");var g=document.getElementById("vditorHljsStyle"),E="".concat(p,"/dist/js/highlight.js/styles/").concat(u,".min.css");g?g.getAttribute("href")!==E&&(g.remove(),(0,S.T)(E,"vditorHljsStyle")):(0,S.T)(E,"vditorHljsStyle")}},873:(m,h,y)=>{y.d(h,{H:()=>S});var C=y(505),S=function(d,u){if(!(!d||!u)){var p=document.getElementById("vditorContentTheme"),g="".concat(u,"/").concat(d,".css");p?p.getAttribute("href")!==g&&(p.remove(),(0,C.T)(g,"vditorContentTheme")):(0,C.T)(g,"vditorContentTheme")}}},161:(m,h,y)=>{y.d(h,{U:()=>C,Z:()=>S});var C=function(d,u){if(document.getElementById(u))return!1;var p=new XMLHttpRequest;p.open("GET",d,!1),p.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),p.send("");var g=document.createElement("script");g.type="text/javascript",g.text=p.responseText,g.id=u,document.head.appendChild(g)},S=function(d,u){return new Promise(function(p,g){if(document.getElementById(u))return p(!0),!1;var E=document.createElement("script");E.src=d,E.async=!0,document.head.appendChild(E),E.onerror=function(b){g(b)},E.onload=function(){if(document.getElementById(u))return E.remove(),p(!0),!1;E.id=u,p(!0)}})}},505:(m,h,y)=>{y.d(h,{T:()=>C});var C=function(S,d){if(!document.getElementById(d)){var u=document.createElement("link");u.id=d,u.rel="stylesheet",u.type="text/css",u.href=S,document.getElementsByTagName("head")[0].appendChild(u)}}},695:(m,h,y)=>{y.d(h,{p:()=>C});var C=function(S){return S.replace(/\u00a0/g," ")}},629:(m,h,y)=>{y.d(h,{D:()=>d,H8:()=>E,_0:()=>p,fG:()=>g,gm:()=>S,nr:()=>C,y3:()=>u});var C=function(){return navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")===-1},S=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},d=function(){try{return typeof localStorage<"u"}catch{return!1}},u=function(){return navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click"},p=function(b){return navigator.platform.toUpperCase().indexOf("MAC")>=0?!!(b.metaKey&&!b.ctrlKey):!!(!b.metaKey&&b.ctrlKey)},g=function(b){return/Mac/.test(navigator.platform)||navigator.platform==="iPhone"?b.indexOf("⇧")>-1&&S()&&(b=b.replace(";",":").replace("=","+").replace("-","_")):(b.startsWith("⌘")?b=b.replace("⌘","⌘+"):b.startsWith("⌥")&&b.substr(1,1)!=="⌘"?b=b.replace("⌥","⌥+"):b=b.replace("⇧⌘","⌘+⇧+").replace("⌥⌘","⌥+⌘+"),b=b.replace("⌘","Ctrl").replace("⇧","Shift").replace("⌥","Alt"),b.indexOf("Shift")>-1&&(b=b.replace(";",":").replace("=","+").replace("-","_"))),b},E=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}},933:(m,h,y)=>{y.d(h,{Ee:()=>C,TK:()=>S,kY:()=>d});var C=function(){return([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(u){return(parseInt(u,10)^window.crypto.getRandomValues(new Uint32Array(1))[0]&15>>parseInt(u,10)/4).toString(16)})},S=function(u,p){p===void 0&&(p=window.location.search);var g=p.substring(p.indexOf("?")),E=g.indexOf("#"),b=new URLSearchParams(g.substring(0,E>=0?E:void 0));return b.get(u)},d=function(u){return Function('"use strict";return ('.concat(u,")"))()}},598:(m,h,y)=>{y.d(h,{Ab:()=>d,KJ:()=>b,KR:()=>u,Rp:()=>k,Th:()=>p,XW:()=>S,_Y:()=>E,pt:()=>g});var C=y(164),S=function(M,x){for(var A=b(M,x),v=!1,O=!1;A&&!A.classList.contains("vditor-reset")&&!O;)v=b(A.parentElement,x),v?A=v:O=!0;return A||!1},d=function(M,x){for(var A=(0,C.f)(M,x),v=!1,O=!1;A&&!A.classList.contains("vditor-reset")&&!O;)v=(0,C.f)(A.parentElement,x),v?A=v:O=!0;return A||!1},u=function(M){var x=d(M,"UL"),A=d(M,"OL"),v=x;return A&&(!x||x&&A.contains(x))&&(v=A),v},p=function(M,x,A){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);for(var v=M,O=!1;v&&!O&&!v.classList.contains("vditor-reset");)v.getAttribute(x)===A?O=!0:v=v.parentElement;return O&&v},g=function(M){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);var x=M,A=!1,v=p(M,"data-block","0");if(v)return v;for(;x&&!A&&!x.classList.contains("vditor-reset");)x.tagName==="H1"||x.tagName==="H2"||x.tagName==="H3"||x.tagName==="H4"||x.tagName==="H5"||x.tagName==="H6"||x.tagName==="P"||x.tagName==="BLOCKQUOTE"||x.tagName==="OL"||x.tagName==="UL"?A=!0:x=x.parentElement;return A&&x},E=function(M,x){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);for(var A=M,v=!1;A&&!v&&!A.classList.contains("vditor-reset");)A.nodeName===x?v=!0:A=A.parentElement;return v&&A},b=function(M,x){if(!M)return!1;M.nodeType===3&&(M=M.parentElement);for(var A=M,v=!1;A&&!v&&!A.classList.contains("vditor-reset");)A.classList.contains(x)?v=!0:A=A.parentElement;return v&&A},k=function(M){for(;M&&M.lastChild;)M=M.lastChild;return M}},164:(m,h,y)=>{y.d(h,{c:()=>S,f:()=>C});var C=function(d,u){if(!d)return!1;d.nodeType===3&&(d=d.parentElement);for(var p=d,g=!1;p&&!g&&!p.classList.contains("vditor-reset");)p.nodeName.indexOf(u)===0?g=!0:p=p.parentElement;return g&&p},S=function(d){var u=C(d,"H");return u&&u.tagName.length===2&&u.tagName!=="HR"?u:!1}},905:(m,h,y)=>{y.d(h,{h:()=>C});var C=function(){for(var S=[],d=0;d<arguments.length;d++)S[d]=arguments[d];for(var u={},p=function(E){for(var b in E)E.hasOwnProperty(b)&&(Object.prototype.toString.call(E[b])==="[object Object]"?u[b]=C(u[b],E[b]):u[b]=E[b])},g=0;g<S.length;g++)p(S[g]);return u}},827:(m,h,y)=>{y.d(h,{Co:()=>g,ED:()=>b,Ey:()=>p,Fm:()=>k,RN:()=>u,Z2:()=>x,ir:()=>M,jl:()=>E});var C=y(913),S=y(629),d=y(598),u=function(A){var v,O=A[A.currentMode].element;return getSelection().rangeCount>0&&(v=getSelection().getRangeAt(0),O.isEqualNode(v.startContainer)||O.contains(v.startContainer))?v:A[A.currentMode].range?A[A.currentMode].range:(O.focus(),v=O.ownerDocument.createRange(),v.setStart(O,0),v.collapse(!0),v)},p=function(A){var v=window.getSelection().getRangeAt(0);if(!A.contains(v.startContainer)&&!(0,d.KJ)(v.startContainer,"vditor-panel--none"))return{left:0,top:0};var O=A.parentElement.getBoundingClientRect(),I;if(v.getClientRects().length===0)if(v.startContainer.nodeType===3){var R=v.startContainer.parentElement;if(R&&R.getClientRects().length>0)I=R.getClientRects()[0];else return{left:0,top:0}}else{var P=v.startContainer.children;if(P[v.startOffset]&&P[v.startOffset].getClientRects().length>0)I=P[v.startOffset].getClientRects()[0];else if(v.startContainer.childNodes.length>0){var B=v.cloneRange();v.selectNode(v.startContainer.childNodes[Math.max(0,v.startOffset-1)]),I=v.getClientRects()[0],v.setEnd(B.endContainer,B.endOffset),v.setStart(B.startContainer,B.startOffset)}else I=v.startContainer.getClientRects()[0];if(!I){for(var W=v.startContainer.childNodes[v.startOffset];!W.getClientRects||W.getClientRects&&W.getClientRects().length===0;)W=W.parentElement;I=W.getClientRects()[0]}}else I=v.getClientRects()[0];return{left:I.left-O.left,top:I.top-O.top}},g=function(A,v){if(!v){if(getSelection().rangeCount===0)return!1;v=getSelection().getRangeAt(0)}var O=v.commonAncestorContainer;return A.isEqualNode(O)||A.contains(O)},E=function(A){var v=window.getSelection();v.removeAllRanges(),v.addRange(A)},b=function(A,v,O){var I={end:0,start:0};if(!O){if(getSelection().rangeCount===0)return I;O=window.getSelection().getRangeAt(0)}if(g(v,O)){var R=O.cloneRange();A.childNodes[0]&&A.childNodes[0].childNodes[0]?R.setStart(A.childNodes[0].childNodes[0],0):R.selectNodeContents(A),R.setEnd(O.startContainer,O.startOffset),I.start=R.toString().length,I.end=I.start+O.toString().length}return I},k=function(A,v,O){var I=0,R=0,P=O.childNodes[R],B=!1,W=!1;A=Math.max(0,A),v=Math.max(0,v);var G=O.ownerDocument.createRange();for(G.setStart(P||O,0),G.collapse(!0);!W&&P;){var re=I+P.textContent.length;if(!B&&A>=I&&A<=re&&(A===0?G.setStart(P,0):P.childNodes[0].nodeType===3?G.setStart(P.childNodes[0],A-I):P.nextSibling?G.setStartBefore(P.nextSibling):G.setStartAfter(P),B=!0,A===v)){W=!0;break}B&&v>=I&&v<=re&&(v===0?G.setEnd(P,0):P.childNodes[0].nodeType===3?G.setEnd(P.childNodes[0],v-I):P.nextSibling?G.setEndBefore(P.nextSibling):G.setEndAfter(P),W=!0),I=re,P=O.childNodes[++R]}return!W&&O.childNodes[R-1]&&G.setStartBefore(O.childNodes[R-1]),E(G),G},M=function(A,v){var O=A.querySelector("wbr");if(O){if(!O.previousElementSibling)O.previousSibling?v.setStart(O.previousSibling,O.previousSibling.textContent.length):O.nextSibling?O.nextSibling.nodeType===3?v.setStart(O.nextSibling,0):v.setStartBefore(O.nextSibling):v.setStart(O.parentElement,0);else if(O.previousElementSibling.isSameNode(O.previousSibling))if(O.previousElementSibling.lastChild){v.setStartBefore(O),v.collapse(!0),E(v),(0,S.H8)()&&(O.previousElementSibling.tagName==="EM"||O.previousElementSibling.tagName==="STRONG"||O.previousElementSibling.tagName==="S")&&(v.insertNode(document.createTextNode(C.Y.ZWSP)),v.collapse(!1)),O.remove();return}else v.setStartAfter(O.previousElementSibling);else v.setStart(O.previousSibling,O.previousSibling.textContent.length);v.collapse(!0),O.remove(),E(v)}},x=function(A,v){var O=document.createElement("div");O.innerHTML=A;var I=O.querySelectorAll("p");I.length===1&&!I[0].previousSibling&&!I[0].nextSibling&&v[v.currentMode].element.children.length>0&&O.firstElementChild.tagName==="P"&&(A=I[0].innerHTML.trim());var R=document.createElement("div");R.innerHTML=A;var P=u(v);if(P.toString()!==""&&(v[v.currentMode].preventInput=!0,document.execCommand("delete",!1,"")),R.firstElementChild&&R.firstElementChild.getAttribute("data-block")==="0"){R.lastElementChild.insertAdjacentHTML("beforeend","<wbr>");var B=(0,d.pt)(P.startContainer);B?B.insertAdjacentHTML("afterend",R.innerHTML):v[v.currentMode].element.insertAdjacentHTML("beforeend",R.innerHTML),M(v[v.currentMode].element,P)}else{var W=document.createElement("template");W.innerHTML=A,P.insertNode(W.content.cloneNode(!0)),P.collapse(!1),E(P)}}}},s={};function c(m){var h=s[m];if(h!==void 0)return h.exports;var y=s[m]={exports:{}};return a[m](y,y.exports,c),y.exports}c.d=(m,h)=>{for(var y in h)c.o(h,y)&&!c.o(m,y)&&Object.defineProperty(m,y,{enumerable:!0,get:h[y]})},c.o=(m,h)=>Object.prototype.hasOwnProperty.call(m,h),c.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})};var f={};return(()=>{c.d(f,{default:()=>Fs});var m=c(923),h=c(913),y=c(695),C=function(e){return e.currentMode==="sv"?(0,y.p)("".concat(e.sv.element.textContent,`
`).replace(/\n\n$/,`
`)):e.currentMode==="wysiwyg"?e.lute.VditorDOM2Md(e.wysiwyg.element.innerHTML):e.currentMode==="ir"?e.lute.VditorIRDOM2Md(e.ir.element.innerHTML):""},S=c(161),d=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-devtools",this.element.innerHTML='<div class="vditor-reset--error"></div><div style="height: 100%;"></div>'}return e.prototype.renderEchart=function(t){var i=this;t.devtools.element.style.display==="block"&&(0,S.Z)("".concat(t.options.cdn,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){i.ASTChart||(i.ASTChart=echarts.init(t.devtools.element.lastElementChild));try{i.element.lastElementChild.style.display="block",i.element.firstElementChild.innerHTML="",i.ASTChart.setOption({series:[{data:JSON.parse(t.lute.RenderEChartsJSON(C(t))),initialTreeDepth:-1,label:{align:"left",backgroundColor:"rgba(68, 77, 86, .68)",borderRadius:3,color:"#d1d5da",fontSize:12,lineHeight:12,offset:[9,12],padding:[2,4,2,4],position:"top",verticalAlign:"middle"},lineStyle:{color:"#4285f4",type:"curve",width:1},orient:"vertical",roam:!0,type:"tree"}],toolbox:{bottom:25,emphasis:{iconStyle:{color:"#4285f4"}},feature:{restore:{show:!0},saveAsImage:{show:!0}},right:15,show:!0}}),i.ASTChart.resize()}catch(r){i.element.lastElementChild.style.display="none",i.element.firstElementChild.innerHTML=r}})},e}(),u=c(629),p=function(e,t){t.forEach(function(i){if(e[i]){var r=e[i].children[0];r&&r.classList.contains("vditor-menu--current")&&r.classList.remove("vditor-menu--current")}})},g=function(e,t){t.forEach(function(i){if(e[i]){var r=e[i].children[0];r&&!r.classList.contains("vditor-menu--current")&&r.classList.add("vditor-menu--current")}})},E=function(e,t){t.forEach(function(i){if(e[i]){var r=e[i].children[0];r&&r.classList.contains(h.Y.CLASS_MENU_DISABLED)&&r.classList.remove(h.Y.CLASS_MENU_DISABLED)}})},b=function(e,t){t.forEach(function(i){if(e[i]){var r=e[i].children[0];r&&!r.classList.contains(h.Y.CLASS_MENU_DISABLED)&&r.classList.add(h.Y.CLASS_MENU_DISABLED)}})},k=function(e,t){t.forEach(function(i){e[i]&&e[i]&&(e[i].style.display="none")})},M=function(e,t){t.forEach(function(i){e[i]&&e[i]&&(e[i].style.display="block")})},x=function(e,t,i){t.includes("subToolbar")&&(e.toolbar.element.querySelectorAll(".vditor-hint").forEach(function(r){i&&r.isEqualNode(i)||(r.style.display="none")}),e.toolbar.elements.emoji&&(e.toolbar.elements.emoji.lastElementChild.style.display="none")),t.includes("hint")&&(e.hint.element.style.display="none"),e.wysiwyg.popover&&t.includes("popover")&&(e.wysiwyg.popover.style.display="none")},A=function(e,t,i,r){i.addEventListener((0,u.y3)(),function(o){o.preventDefault(),o.stopPropagation(),!i.classList.contains(h.Y.CLASS_MENU_DISABLED)&&(e.toolbar.element.querySelectorAll(".vditor-hint--current").forEach(function(l){l.classList.remove("vditor-hint--current")}),t.style.display==="block"?t.style.display="none":(x(e,["subToolbar","hint","popover"],i.parentElement.parentElement),i.classList.contains("vditor-tooltipped")||i.classList.add("vditor-hint--current"),t.style.display="block",e.toolbar.element.getBoundingClientRect().right-i.getBoundingClientRect().right<250?t.classList.add("vditor-panel--left"):t.classList.remove("vditor-panel--left")))})},v=c(598),O=c(164),I=function(e,t,i,r){r&&console.log("".concat(e," - ").concat(i,": ").concat(t))},R=c(288),P=c(784),B=c(51),W=c(500),G=c(339),re=c(108),de=c(960),ve=c(975),ke=c(597),be=c(162),we=c(591),Ae=c(931),We=function(e,t,i){i===void 0&&(i="sv");var r=document.createElement("div");r.innerHTML=e;var o=!1;r.childElementCount===1&&r.lastElementChild.style.fontFamily.indexOf("monospace")>-1&&(o=!0);var l=r.querySelectorAll("pre");if(r.childElementCount===1&&l.length===1&&l[0].className!=="vditor-wysiwyg"&&l[0].className!=="vditor-sv"&&(o=!0),e.indexOf(`
<p class="p1">`)===0&&(o=!0),r.childElementCount===1&&r.firstElementChild.tagName==="TABLE"&&r.querySelector(".line-number")&&r.querySelector(".line-content")&&(o=!0),o){var w=t||e;return/\n/.test(w)||l.length===1?i==="wysiwyg"?'<div class="vditor-wysiwyg__block" data-block="0" data-type="code-block"><pre><code>'.concat(w.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"<wbr></code></pre></div>"):"\n```\n"+w.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"\n```":i==="wysiwyg"?"<code>".concat(w.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"</code><wbr>"):"`".concat(w,"`")}return!1},me=function(e,t){if(e){if(e.parentElement.getAttribute("data-type")==="html-block"){e.setAttribute("data-render","1");return}var i=e.firstElementChild.className.replace("language-","");if(i==="abc")(0,R.$)(e,t.options.cdn);else if(i==="mermaid")(0,ve.e)(e,t.options.cdn,t.options.theme);else if(i==="smiles")(0,Ae.Y)(e,t.options.cdn,t.options.theme);else if(i==="markmap")(0,ke.K)(e,t.options.cdn);else if(i==="flowchart")(0,W.D)(e,t.options.cdn);else if(i==="echarts")(0,P.v)(e,t.options.cdn,t.options.theme);else if(i==="mindmap")(0,be.l)(e,t.options.cdn,t.options.theme);else if(i==="plantuml")(0,we.M)(e,t.options.cdn);else if(i==="graphviz")(0,G.m)(e,t.options.cdn);else if(i==="math")(0,de.T)(e,{cdn:t.options.cdn,math:t.options.preview.math});else{var r=t.options.customRenders.find(function(o){if(o.language===i)return o.render(e,t),!0});r||((0,re.$)(Object.assign({},t.options.preview.hljs),e,t.options.cdn),(0,B.o)(e,t.options.preview.hljs))}e.setAttribute("data-render","1")}},N=c(827),X=function(e){if(e.currentMode!=="sv"){var t=e[e.currentMode].element,i=e.outline.render(e);i===""&&(i="[ToC]"),t.querySelectorAll('[data-type="toc-block"]').forEach(function(r){r.innerHTML=i,(0,de.T)(r,{cdn:e.options.cdn,math:e.options.preview.math})})}},Z=function(e,t){var i=(0,v._Y)(e.target,"SPAN");if(i&&(0,v.KJ)(i,"vditor-toc")){var r=t[t.currentMode].element.querySelector("#"+i.getAttribute("data-target-id"));if(r)if(t.options.height==="auto"){var o=r.offsetTop+t.element.offsetTop;t.options.toolbarConfig.pin||(o+=t.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,o)}else t.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,t.element.offsetTop),t[t.currentMode].element.scrollTop=r.offsetTop;return}},Ee=function(e,t,i,r){if(e.previousElementSibling&&e.previousElementSibling.classList.contains("vditor-toc")){if(i.key==="Backspace"&&(0,N.ED)(e,t[t.currentMode].element,r).start===0)return e.previousElementSibling.remove(),Me(t),!0;if(mn(t,i,r,e,e.previousElementSibling))return!0}if(e.nextElementSibling&&e.nextElementSibling.classList.contains("vditor-toc")){if(i.key==="Delete"&&(0,N.ED)(e,t[t.currentMode].element,r).start>=e.textContent.trimRight().length)return e.nextElementSibling.remove(),Me(t),!0;if(Rn(t,i,r,e,e.nextElementSibling))return!0}if(i.key==="Backspace"||i.key==="Delete"){var o=(0,v.KJ)(r.startContainer,"vditor-toc");if(o)return o.remove(),Me(t),!0}},De=function(e,t,i,r){i===void 0&&(i=!1);var o=(0,v.pt)(t.startContainer);if(o&&!i&&o.getAttribute("data-type")!=="code-block"){if(Hi(o.innerHTML)&&o.previousElementSibling||Ii(o.innerHTML))return;for(var l=(0,N.ED)(o,e.ir.element,t).start,w=!0,_=l-1;_>o.textContent.substr(0,l).lastIndexOf(`
`);_--)if(o.textContent.charAt(_)!==" "&&o.textContent.charAt(_)!=="	"){w=!1;break}l===0&&(w=!1);for(var D=!0,_=l-1;_<o.textContent.length;_++)if(o.textContent.charAt(_)!==" "&&o.textContent.charAt(_)!==`
`){D=!1;break}if(w){typeof e.options.input=="function"&&e.options.input(C(e));return}if(D&&/^#{1,6} $/.test(o.textContent)&&(D=!1),D){var L=(0,v.KJ)(t.startContainer,"vditor-ir__marker");if(!L){var H=t.startContainer.previousSibling;H&&H.nodeType!==3&&H.classList.contains("vditor-ir__node--expand")&&H.classList.remove("vditor-ir__node--expand"),typeof e.options.input=="function"&&e.options.input(C(e));return}}}if(e.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(Te){Te.classList.remove("vditor-ir__node--expand")}),o||(o=e.ir.element),!o.querySelector("wbr")){var F=(0,v.KJ)(t.startContainer,"vditor-ir__preview");F?F.previousElementSibling.insertAdjacentHTML("beforeend","<wbr>"):t.insertNode(document.createElement("wbr"))}o.querySelectorAll("[style]").forEach(function(Te){Te.removeAttribute("style")}),o.getAttribute("data-type")==="link-ref-defs-block"&&(o=e.ir.element);var Q=o.isEqualNode(e.ir.element),J=(0,v.Th)(o,"data-type","footnotes-block"),Y="";if(Q)Y=o.innerHTML;else{var le=(0,O.f)(t.startContainer,"BLOCKQUOTE"),ne=(0,v.KR)(t.startContainer);if(ne&&(o=ne),le&&(!ne||ne&&!le.contains(ne))&&(o=le),J&&(o=J),Y=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var q=o.previousElementSibling,he=o.nextElementSibling;q&&(q.tagName==="UL"||q.tagName==="OL")&&(Y=q.outerHTML+Y,q.remove()),he&&(he.tagName==="UL"||he.tagName==="OL")&&(Y=Y+he.outerHTML,he.remove()),Y=Y.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}else o.previousElementSibling&&o.previousElementSibling.textContent.replace(h.Y.ZWSP,"")!==""&&r&&r.inputType==="insertParagraph"&&(Y=o.previousElementSibling.outerHTML+Y,o.previousElementSibling.remove());o.innerText.startsWith("```")||(e.ir.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(Te){Te&&!o.isEqualNode(Te)&&(Y+=Te.outerHTML,Te.remove())}),e.ir.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(Te){Te&&!o.isEqualNode(Te)&&(Y+=Te.outerHTML,Te.remove())}))}if(I("SpinVditorIRDOM",Y,"argument",e.options.debugger),Y=e.lute.SpinVditorIRDOM(Y),I("SpinVditorIRDOM",Y,"result",e.options.debugger),Q)o.innerHTML=Y;else if(o.outerHTML=Y,J){var oe=(0,v.Th)(e.ir.element.querySelector("wbr"),"data-type","footnotes-def");if(oe){var ge=oe.textContent,ze=ge.substring(1,ge.indexOf("]:")),He=e.ir.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(ze,'"]'));He&&He.setAttribute("aria-label",ge.substr(ze.length+3).trim().substr(0,24))}}var Fe,ct=e.ir.element.querySelectorAll("[data-type='link-ref-defs-block']");ct.forEach(function(Te,Ke){Ke===0?Fe=Te:(Fe.insertAdjacentHTML("beforeend",Te.innerHTML),Te.remove())}),ct.length>0&&e.ir.element.insertAdjacentElement("beforeend",ct[0]);var it,ut=e.ir.element.querySelectorAll("[data-type='footnotes-block']");ut.forEach(function(Te,Ke){Ke===0?it=Te:(it.insertAdjacentHTML("beforeend",Te.innerHTML),Te.remove())}),ut.length>0&&e.ir.element.insertAdjacentElement("beforeend",ut[0]),(0,N.ir)(e.ir.element,t),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(Te){me(Te,e)}),X(e),Pt(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},V=function(e,t){if(e==="")return!1;if(e.indexOf("⇧")===-1&&e.indexOf("⌘")===-1&&e.indexOf("⌥")===-1)return!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&t.code===e;if(e==="⇧Tab")return!!(!(0,u._0)(t)&&!t.altKey&&t.shiftKey&&t.code==="Tab");var i=e.split("");if(e.startsWith("⌥")){var r=i.length===3?i[2]:i[1];return!!((i.length===3?(0,u._0)(t):!(0,u._0)(t))&&t.altKey&&!t.shiftKey&&t.code===(/^[0-9]$/.test(r)?"Digit":"Key")+r)}e==="⌘Enter"&&(i=["⌘","Enter"]);var o=i.length>2&&i[0]==="⇧",l=o?i[2]:i[1];return o&&((0,u.gm)()||!/Mac/.test(navigator.platform))&&(l==="-"?l="_":l==="="&&(l="+")),!!((0,u._0)(t)&&t.key.toLowerCase()===l.toLowerCase()&&!t.altKey&&(!o&&!t.shiftKey||o&&t.shiftKey))},U=function(e){var t=e.startContainer;if(t.nodeType===3&&t.nodeValue.length!==e.startOffset)return!1;for(var i=t.nextSibling;i&&i.textContent==="";)i=i.nextSibling;if(i){if(i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block"))return i}else{var r=(0,v.KJ)(t,"vditor-ir__marker");if(r&&!r.nextSibling){var o=t.parentElement.parentElement.nextSibling;if(o&&o.nodeType!==3&&o.classList.contains("vditor-ir__node"))return o}return!1}return!1},j=function(e){var t=e.startContainer,i=t.previousSibling;return t.nodeType===3&&e.startOffset===0&&i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block")?i:!1},z=function(e,t){t.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(w){w.classList.remove("vditor-ir__node--expand")});var i=(0,v.XW)(e.startContainer,"vditor-ir__node"),r=!e.collapsed&&(0,v.XW)(e.endContainer,"vditor-ir__node");if(!(!e.collapsed&&(!i||i!==r))){i&&(i.classList.add("vditor-ir__node--expand"),i.classList.remove("vditor-ir__node--hidden"),(0,N.jl)(e));var o=U(e);if(o){o.classList.add("vditor-ir__node--expand"),o.classList.remove("vditor-ir__node--hidden");return}var l=j(e);if(l){l.classList.add("vditor-ir__node--expand"),l.classList.remove("vditor-ir__node--hidden");return}}},te=function(e,t){if(e.ir.composingLock=t.isComposing,t.isComposing)return!1;t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t);var i=(0,N.RN)(e),r=i.startContainer;if(!kr(t,e,r)||(Mr(i,e,t),Fr(i),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"&&t.key!=="Delete"))return!1;var o=(0,v.Th)(r,"data-newline","1");if(!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&t.key==="Enter"&&o&&i.startOffset<o.textContent.length){var l=o.previousElementSibling;l&&(i.insertNode(document.createTextNode(l.textContent)),i.collapse(!1));var w=o.nextSibling;w&&(i.insertNode(document.createTextNode(w.textContent)),i.collapse(!0))}var _=(0,v._Y)(r,"P");if(Dr(t,e,_,i)||Ar(i,e,_,t)||jr(e,i,t,_))return!0;var D=(0,v.KJ)(r,"vditor-ir__marker--pre");if(D&&D.tagName==="PRE"){var L=D.firstChild;if(Nr(e,t,D,i)||(L.getAttribute("data-type")==="math-block"||L.getAttribute("data-type")==="html-block")&&mn(e,t,i,L,D.parentElement)||Rn(e,t,i,L,D.parentElement))return!0}var H=(0,v.Th)(r,"data-type","code-block-info");if(H){if(t.key==="Enter"||t.key==="Tab")return i.selectNodeContents(H.nextElementSibling.firstChild),i.collapse(!0),t.preventDefault(),x(e,["hint"]),!0;if(t.key==="Backspace"){var F=(0,N.ED)(H,e.ir.element).start;F===1&&i.setStart(r,0),F===2&&(e.hint.recentLanguage="")}if(mn(e,t,i,H,H.parentElement))return x(e,["hint"]),!0}var Q=(0,v._Y)(r,"TD")||(0,v._Y)(r,"TH");if(t.key.indexOf("Arrow")>-1&&Q){var J=ko(Q);if(J&&mn(e,t,i,Q,J))return!0;var Y=Mo(Q);if(Y&&Rn(e,t,i,Q,Y))return!0}if(Ir(e,t,i)||Br(e,i,t)||Ni(e,i,t))return!0;var le=(0,O.c)(r);if(le){if(V("⌘=",t)){var ne=le.querySelector(".vditor-ir__marker--heading");return ne&&ne.textContent.trim().length>1&&Hn(e,ne.textContent.substr(1)),t.preventDefault(),!0}if(V("⌘-",t)){var ne=le.querySelector(".vditor-ir__marker--heading");return ne&&ne.textContent.trim().length<6&&Hn(e,ne.textContent.trim()+"# "),t.preventDefault(),!0}}var q=(0,v.pt)(r);if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&i.toString()===""){if(zr(e,i,t,_))return!0;if(q&&q.previousElementSibling&&q.tagName!=="UL"&&q.tagName!=="OL"&&(q.previousElementSibling.getAttribute("data-type")==="code-block"||q.previousElementSibling.getAttribute("data-type")==="math-block")){var he=(0,N.ED)(q,e.ir.element,i).start;if(he===0||he===1&&q.innerText.startsWith(h.Y.ZWSP))return i.selectNodeContents(q.previousElementSibling.querySelector(".vditor-ir__marker--pre code")),i.collapse(!1),z(i,e),q.textContent.trim().replace(h.Y.ZWSP,"")===""&&(q.remove(),Pt(e)),t.preventDefault(),!0}if(le){var oe=le.firstElementChild.textContent.length;(0,N.ED)(le,e.ir.element).start===oe&&oe!==0&&(i.setStart(le.firstElementChild.firstChild,oe-1),i.collapse(!0),(0,N.jl)(i))}}return(t.key==="ArrowUp"||t.key==="ArrowDown")&&q&&(q.querySelectorAll(".vditor-ir__node").forEach(function(ge){ge.contains(r)||ge.classList.add("vditor-ir__node--hidden")}),Ur(t,q,i))?!0:(xr(i,t.key),q&&Ee(q,e,t,i)?(t.preventDefault(),!0):!1)},K=c(726),Se=function(e,t){e.querySelectorAll("[data-type=footnotes-link]").forEach(function(i){for(var r=i.parentElement,o=r.nextSibling;o&&o.textContent.startsWith("    ");){var l=o;l.childNodes.forEach(function(w){r.append(w.cloneNode(!0))}),o=o.nextSibling,l.remove()}t&&t(r)})},Ce=function(e,t){var i,r=getSelection().getRangeAt(0).cloneRange(),o=r.startContainer;r.startContainer.nodeType!==3&&r.startContainer.tagName==="DIV"&&(o=r.startContainer.childNodes[r.startOffset-1]);var l=(0,v.Th)(o,"data-block","0");if(l&&t&&(t.inputType==="deleteContentBackward"||t.data===" ")){for(var w=(0,N.ED)(l,e.sv.element,r).start,_=!0,D=w-1;D>l.textContent.substr(0,w).lastIndexOf(`
`);D--)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!=="	"){_=!1;break}if(w===0&&(_=!1),_){Xe(e);return}if(t.inputType==="deleteContentBackward"){var L=(0,v.Th)(o,"data-type","code-block-open-marker")||(0,v.Th)(o,"data-type","code-block-close-marker");if(L){if(L.getAttribute("data-type")==="code-block-close-marker"){var H=qn(o,"code-block-open-marker");if(H){H.textContent=L.textContent,Xe(e);return}}if(L.getAttribute("data-type")==="code-block-open-marker"){var H=qn(o,"code-block-close-marker",!1);if(H){H.textContent=L.textContent,Xe(e);return}}}var F=(0,v.Th)(o,"data-type","math-block-open-marker");if(F){var Q=F.nextElementSibling.nextElementSibling;Q&&Q.getAttribute("data-type")==="math-block-close-marker"&&(Q.remove(),Xe(e));return}l.querySelectorAll('[data-type="code-block-open-marker"]').forEach(function(q){q.textContent.length===1&&q.remove()}),l.querySelectorAll('[data-type="code-block-close-marker"]').forEach(function(q){q.textContent.length===1&&q.remove()});var J=(0,v.Th)(o,"data-type","heading-marker");if(J&&J.textContent.indexOf("#")===-1){Xe(e);return}}if((t.data===" "||t.inputType==="deleteContentBackward")&&((0,v.Th)(o,"data-type","padding")||(0,v.Th)(o,"data-type","li-marker")||(0,v.Th)(o,"data-type","task-marker")||(0,v.Th)(o,"data-type","blockquote-marker"))){Xe(e);return}}if(l&&l.textContent.trimRight()==="$$"){Xe(e);return}l||(l=e.sv.element),((i=l.firstElementChild)===null||i===void 0?void 0:i.getAttribute("data-type"))==="link-ref-defs-block"&&(l=e.sv.element),(0,v.Th)(o,"data-type","footnotes-link")&&(l=e.sv.element),l.textContent.indexOf(Lute.Caret)===-1&&r.insertNode(document.createTextNode(Lute.Caret)),l.querySelectorAll("[style]").forEach(function(q){q.removeAttribute("style")}),l.querySelectorAll("font").forEach(function(q){q.outerHTML=q.innerHTML});var Y=l.textContent,le=l.isEqualNode(e.sv.element);if(le)Y=l.textContent;else{l.previousElementSibling&&(Y=l.previousElementSibling.textContent+Y,l.previousElementSibling.remove()),l.previousElementSibling&&Y.indexOf(`---
`)===0&&(Y=l.previousElementSibling.textContent+Y,l.previousElementSibling.remove());var ne="";e.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(q,he){q&&!l.isEqualNode(q.parentElement)&&(ne+=q.parentElement.textContent+`
`,q.parentElement.remove())}),e.sv.element.querySelectorAll("[data-type='footnotes-link']").forEach(function(q,he){q&&!l.isEqualNode(q.parentElement)&&(ne+=q.parentElement.textContent+`
`,q.parentElement.remove())}),Y=ne+Y}Y=Er(Y,e),le?l.innerHTML=Y:l.outerHTML=Y,e.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(q){e.sv.element.insertAdjacentElement("beforeend",q.parentElement)}),Se(e.sv.element,function(q){e.sv.element.insertAdjacentElement("beforeend",q)}),(0,N.ir)(e.sv.element,r),Ye(e),Xe(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},$e=function(e,t){var i,r,o,l,w;if(e.sv.composingLock=t.isComposing,t.isComposing||(t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"))return!1;var _=(0,N.RN)(e),D=_.startContainer;_.startContainer.nodeType!==3&&_.startContainer.tagName==="DIV"&&(D=_.startContainer.childNodes[_.startOffset-1]);var L=(0,v.Th)(D,"data-type","text"),H=(0,v.Th)(D,"data-type","blockquote-marker");if(!H&&_.startOffset===0&&L&&L.previousElementSibling&&L.previousElementSibling.getAttribute("data-type")==="blockquote-marker"&&(H=L.previousElementSibling),H&&t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&H.nextElementSibling.textContent.trim()===""&&(0,N.ED)(H,e.sv.element,_).start===H.textContent.length)return((i=H.previousElementSibling)===null||i===void 0?void 0:i.getAttribute("data-type"))==="padding"&&H.previousElementSibling.setAttribute("data-action","enter-remove"),H.remove(),Xe(e),t.preventDefault(),!0;var F=(0,v.Th)(D,"data-type","li-marker"),Q=(0,v.Th)(D,"data-type","task-marker"),J=F;if(J||Q&&Q.nextElementSibling.getAttribute("data-type")!=="task-marker"&&(J=Q),!J&&_.startOffset===0&&L&&L.previousElementSibling&&(L.previousElementSibling.getAttribute("data-type")==="li-marker"||L.previousElementSibling.getAttribute("data-type")==="task-marker")&&(J=L.previousElementSibling),J){var Y=(0,N.ED)(J,e.sv.element,_).start,le=J.getAttribute("data-type")==="task-marker",ne=J;if(le&&(ne=J.previousElementSibling.previousElementSibling.previousElementSibling),Y===J.textContent.length){if(t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&J.nextElementSibling.textContent.trim()==="")return((r=ne.previousElementSibling)===null||r===void 0?void 0:r.getAttribute("data-type"))==="padding"?(ne.previousElementSibling.remove(),Ce(e)):(le&&(ne.remove(),J.previousElementSibling.previousElementSibling.remove(),J.previousElementSibling.remove()),J.nextElementSibling.remove(),J.remove(),Xe(e)),t.preventDefault(),!0;if(t.key==="Tab")return t.shiftKey?ne.previousElementSibling.getAttribute("data-type")==="padding"&&ne.previousElementSibling.remove():ne.insertAdjacentHTML("beforebegin",'<span data-type="padding">'.concat(ne.textContent.replace(/\S/g," "),"</span>")),/^\d/.test(ne.textContent)&&(ne.textContent=ne.textContent.replace(/^\d{1,}/,"1"),_.selectNodeContents(J.firstChild),_.collapse(!1)),Ce(e),t.preventDefault(),!0}}if(Ni(e,_,t))return!0;var q=(0,v.Th)(D,"data-block","0"),he=(0,O.f)(D,"SPAN");if(t.key==="Enter"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey&&q){var oe=!1,ge=q.textContent.match(/^\n+/);(0,N.ED)(q,e.sv.element).start<=(ge?ge[0].length:0)&&(oe=!0);var ze=`
`;if(he){if(((o=he.previousElementSibling)===null||o===void 0?void 0:o.getAttribute("data-action"))==="enter-remove")return he.previousElementSibling.remove(),Xe(e),t.preventDefault(),!0;ze+=mo(he)}return _.insertNode(document.createTextNode(ze)),_.collapse(!1),q&&q.textContent.trim()!==""&&!oe?Ce(e):Xe(e),t.preventDefault(),!0}if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.altKey&&!t.shiftKey){if(he&&((l=he.previousElementSibling)===null||l===void 0?void 0:l.getAttribute("data-type"))==="newline"&&(0,N.ED)(he,e.sv.element,_).start===1&&he.getAttribute("data-type").indexOf("code-block-")===-1)return _.setStart(he,0),_.extractContents(),he.textContent.trim()!==""?Ce(e):Xe(e),t.preventDefault(),!0;if(q&&(0,N.ED)(q,e.sv.element,_).start===0&&q.previousElementSibling){_.extractContents();var He=q.previousElementSibling.lastElementChild;return He.getAttribute("data-type")==="newline"&&(He.remove(),He=q.previousElementSibling.lastElementChild),He.getAttribute("data-type")!=="newline"&&(He.insertAdjacentHTML("afterend",q.innerHTML),q.remove()),q.textContent.trim()!==""&&!(!((w=q.previousElementSibling)===null||w===void 0)&&w.querySelector('[data-type="code-block-open-marker"]'))?Ce(e):(He.getAttribute("data-type")!=="newline"&&(_.selectNodeContents(He.lastChild),_.collapse(!1)),Xe(e)),t.preventDefault(),!0}}return!1},ee=c(873),Oe=function(e){e.options.theme==="dark"?e.element.classList.add("vditor--dark"):e.element.classList.remove("vditor--dark")},Ie=function(e){e.element.innerHTML="",e.element.classList.add("vditor"),e.options.rtl&&e.element.setAttribute("dir","rtl"),Oe(e),(0,ee.H)(e.options.preview.theme.current,e.options.preview.theme.path),typeof e.options.height=="number"?e.element.style.height=e.options.height+"px":e.element.style.height=e.options.height,typeof e.options.minHeight=="number"&&(e.element.style.minHeight=e.options.minHeight+"px"),typeof e.options.width=="number"?e.element.style.width=e.options.width+"px":e.element.style.width=e.options.width,e.element.appendChild(e.toolbar.element);var t=document.createElement("div");if(t.className="vditor-content",e.options.outline.position==="left"&&t.appendChild(e.outline.element),t.appendChild(e.wysiwyg.element.parentElement),t.appendChild(e.sv.element),t.appendChild(e.ir.element.parentElement),t.appendChild(e.preview.element),e.toolbar.elements.devtools&&t.appendChild(e.devtools.element),e.options.outline.position==="right"&&(e.outline.element.classList.add("vditor-outline--right"),t.appendChild(e.outline.element)),e.upload&&t.appendChild(e.upload.element),e.options.resize.enable&&t.appendChild(e.resize.element),t.appendChild(e.hint.element),t.appendChild(e.tip.element),e.element.appendChild(t),t.addEventListener("click",function(){x(e,["subToolbar"])}),e.toolbar.elements.export&&e.element.insertAdjacentHTML("beforeend",'<iframe id="vditorExportIframe" style="width: 100%;height: 0;border: 0"></iframe>'),Kt(e,e.options.mode,zt(e)),document.execCommand("DefaultParagraphSeparator",!1,"p"),navigator.userAgent.indexOf("iPhone")>-1&&typeof window.visualViewport<"u"){var i=!1,r=function(o){i||(i=!0,requestAnimationFrame(function(){i=!1;var l=e.toolbar.element;l.style.transform="none",l.getBoundingClientRect().top<0&&(l.style.transform="translate(0, ".concat(-l.getBoundingClientRect().top,"px)"))}))};window.visualViewport.addEventListener("scroll",r),window.visualViewport.addEventListener("resize",r)}},Ze=function(e){var t=window.innerWidth<=h.Y.MOBILE_WIDTH?10:35;if(e.wysiwyg.element.parentElement.style.display!=="none"){var i=(e.wysiwyg.element.parentElement.clientWidth-e.options.preview.maxWidth)/2;e.wysiwyg.element.style.padding="10px ".concat(Math.max(t,i),"px")}if(e.ir.element.parentElement.style.display!=="none"){var i=(e.ir.element.parentElement.clientWidth-e.options.preview.maxWidth)/2;e.ir.element.style.padding="10px ".concat(Math.max(t,i),"px")}e.preview.element.style.display!=="block"?e.toolbar.element.style.paddingLeft=Math.max(5,parseInt(e[e.currentMode].element.style.paddingLeft||"0",10)+(e.options.outline.position==="left"?e.outline.element.offsetWidth:0))+"px":e.toolbar.element.style.paddingLeft=5+(e.options.outline.position==="left"?e.outline.element.offsetWidth:0)+"px"},Ot=function(e){if(e.options.typewriterMode){var t=window.innerHeight;typeof e.options.height=="number"?(t=e.options.height,typeof e.options.minHeight=="number"&&(t=Math.max(t,e.options.minHeight)),t=Math.min(window.innerHeight,t)):t=e.element.clientHeight,e.element.classList.contains("vditor--fullscreen")&&(t=window.innerHeight),e[e.currentMode].element.style.setProperty("--editor-bottom",(t-e.toolbar.element.offsetHeight)/2+"px")}},cn;function $n(){window.removeEventListener("resize",cn)}var zt=function(e){Ot(e),$n(),window.addEventListener("resize",cn=function(){Ze(e),Ot(e)});var t=(0,u.D)()&&localStorage.getItem(e.options.cache.id);return(!e.options.cache.enable||!t)&&(e.options.value?t=e.options.value:e.originalInnerHTML?t=e.lute.HTML2Md(e.originalInnerHTML):e.options.cache.enable||(t="")),t||""},un=function(e){clearTimeout(e[e.currentMode].hlToolbarTimeoutId),e[e.currentMode].hlToolbarTimeoutId=window.setTimeout(function(){if(e[e.currentMode].element.getAttribute("contenteditable")!=="false"&&(0,N.Co)(e[e.currentMode].element)){p(e.toolbar.elements,h.Y.EDIT_TOOLBARS),E(e.toolbar.elements,h.Y.EDIT_TOOLBARS);var t=(0,N.RN)(e),i=t.startContainer;t.startContainer.nodeType===3&&(i=t.startContainer.parentElement),i.classList.contains("vditor-reset")&&(i=i.childNodes[t.startOffset]);var r=e.currentMode==="sv"?(0,v.Th)(i,"data-type","heading"):(0,O.c)(i);r&&g(e.toolbar.elements,["headings"]);var o=e.currentMode==="sv"?(0,v.Th)(i,"data-type","blockquote"):(0,v._Y)(i,"BLOCKQUOTE");o&&g(e.toolbar.elements,["quote"]);var l=(0,v.Th)(i,"data-type","strong");l&&g(e.toolbar.elements,["bold"]);var w=(0,v.Th)(i,"data-type","em");w&&g(e.toolbar.elements,["italic"]);var _=(0,v.Th)(i,"data-type","s");_&&g(e.toolbar.elements,["strike"]);var D=(0,v.Th)(i,"data-type","a");D&&g(e.toolbar.elements,["link"]);var L=(0,v._Y)(i,"LI");L?(L.classList.contains("vditor-task")?g(e.toolbar.elements,["check"]):L.parentElement.tagName==="OL"?g(e.toolbar.elements,["ordered-list"]):L.parentElement.tagName==="UL"&&g(e.toolbar.elements,["list"]),E(e.toolbar.elements,["outdent","indent"])):b(e.toolbar.elements,["outdent","indent"]);var H=(0,v.Th)(i,"data-type","code-block");H&&(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),g(e.toolbar.elements,["code"]));var F=(0,v.Th)(i,"data-type","code");F&&(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),g(e.toolbar.elements,["inline-code"]));var Q=(0,v.Th)(i,"data-type","table");Q&&b(e.toolbar.elements,["headings","list","ordered-list","check","line","quote","code","table"])}},200)},Be=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),clearTimeout(e.wysiwyg.afterRenderTimeoutId),e.wysiwyg.afterRenderTimeoutId=window.setTimeout(function(){if(!e.wysiwyg.composingLock){var i=C(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}},e.options.undoDelay)},Ln=function(e){for(var t=e.previousSibling;t;){if(t.nodeType!==3&&t.tagName==="A"&&!t.previousSibling&&t.innerHTML.replace(h.Y.ZWSP,"")===""&&t.nextSibling)return t;t=t.previousSibling}return!1},Si=function(e){for(var t=e.startContainer.nextSibling;t&&t.textContent==="";)t=t.nextSibling;return!!(t&&t.nodeType!==3&&(t.tagName==="CODE"||t.getAttribute("data-type")==="math-inline"||t.getAttribute("data-type")==="html-entity"||t.getAttribute("data-type")==="html-inline"))},dn=function(e){for(var t="",i=e.nextSibling;i;)i.nodeType===3?t+=i.textContent:t+=i.outerHTML,i=i.nextSibling;return t},nt=function(e){for(var t="",i=e.previousSibling;i;)i.nodeType===3?t=i.textContent+t:t=i.outerHTML+t,i=i.previousSibling;return t},Ue=function(e){for(var t=e;t&&!t.nextSibling;)t=t.parentElement;return t.nextSibling},Tt=function(e){var t=nt(e.startContainer),i=dn(e.startContainer),r=e.startContainer.textContent,o=e.startOffset,l="",w="";return(r.substr(0,o)!==""&&r.substr(0,o)!==h.Y.ZWSP||t)&&(l="".concat(t).concat(r.substr(0,o))),(r.substr(o)!==""&&r.substr(o)!==h.Y.ZWSP||i)&&(w="".concat(r.substr(o)).concat(i)),{afterHTML:w,beforeHTML:l}},Ft=function(e,t){Array.from(e.wysiwyg.element.childNodes).find(function(i){if(i.nodeType===3){var r=document.createElement("p");r.setAttribute("data-block","0"),r.textContent=i.textContent;var o=t.startContainer.nodeType===3?t.startOffset:i.textContent.length;return i.parentNode.insertBefore(r,i),i.remove(),t.setStart(r.firstChild,Math.min(r.firstChild.textContent.length,o)),t.collapse(!0),(0,N.jl)(t),!0}else if(!i.getAttribute("data-block"))return i.tagName==="P"?i.remove():(i.tagName==="DIV"?(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>")):i.tagName==="BR"?i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"<wbr></p>"):(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"</p>")),(0,N.ir)(e.wysiwyg.element,t),t=getSelection().getRangeAt(0)),!0})},st=function(e,t){var i=(0,N.RN)(e),r=(0,v.pt)(i.startContainer);r||(r=i.startContainer.childNodes[i.startOffset]),!r&&e.wysiwyg.element.children.length===0&&(r=e.wysiwyg.element),r&&!r.classList.contains("vditor-wysiwyg__block")&&(i.insertNode(document.createElement("wbr")),r.innerHTML.trim()==="<wbr>"&&(r.innerHTML="<wbr><br>"),r.tagName==="BLOCKQUOTE"||r.classList.contains("vditor-reset")?r.innerHTML="<".concat(t,' data-block="0">').concat(r.innerHTML.trim(),"</").concat(t,">"):r.outerHTML="<".concat(t,' data-block="0">').concat(r.innerHTML.trim(),"</").concat(t,">"),(0,N.ir)(e.wysiwyg.element,i),X(e))},Ci=function(e){var t=getSelection().getRangeAt(0),i=(0,v.pt)(t.startContainer);i||(i=t.startContainer.childNodes[t.startOffset]),i&&(t.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>"),(0,N.ir)(e.wysiwyg.element,t)),e.wysiwyg.popover.style.display="none"},An=function(e,t,i){i===void 0&&(i=!0);var r=e.previousElementSibling,o=r.ownerDocument.createRange();r.tagName==="CODE"?(r.style.display="inline-block",i?o.setStart(r.firstChild,1):o.selectNodeContents(r)):(r.style.display="block",r.firstChild.firstChild||r.firstChild.appendChild(document.createTextNode("")),o.selectNodeContents(r.firstChild)),i?o.collapse(!0):o.collapse(!1),(0,N.jl)(o),!e.firstElementChild.classList.contains("language-mindmap")&&Ye(t)},lo=function(e,t){if(e.wysiwyg.composingLock=t.isComposing,t.isComposing)return!1;t.key.indexOf("Arrow")===-1&&t.key!=="Meta"&&t.key!=="Control"&&t.key!=="Alt"&&t.key!=="Shift"&&t.key!=="CapsLock"&&t.key!=="Escape"&&!/^F\d{1,2}$/.test(t.key)&&e.undo.recordFirstPosition(e,t);var i=(0,N.RN)(e),r=i.startContainer;if(!kr(t,e,r)||(Mr(i,e,t),Fr(i),t.key!=="Enter"&&t.key!=="Tab"&&t.key!=="Backspace"&&t.key.indexOf("Arrow")===-1&&!(0,u._0)(t)&&t.key!=="Escape"&&t.key!=="Delete"))return!1;var o=(0,v.pt)(r),l=(0,v._Y)(r,"P");if(Dr(t,e,l,i)||Ar(i,e,l,t)||Ir(e,t,i))return!0;var w=(0,v.KJ)(r,"vditor-wysiwyg__block");if(w){if(t.key==="Escape"&&w.children.length===2)return e.wysiwyg.popover.style.display="none",w.firstElementChild.style.display="none",e.wysiwyg.element.blur(),t.preventDefault(),!0;if(!(0,u._0)(t)&&!t.shiftKey&&t.altKey&&t.key==="Enter"&&w.getAttribute("data-type")==="code-block"){var _=e.wysiwyg.popover.querySelector(".vditor-input");return _.focus(),_.select(),t.preventDefault(),!0}if(w.getAttribute("data-block")==="0"&&(Nr(e,t,w.firstElementChild,i)||Rn(e,t,i,w.firstElementChild,w)||w.getAttribute("data-type")!=="yaml-front-matter"&&mn(e,t,i,w.firstElementChild,w)))return!0}if(jr(e,i,t,l))return!0;var D=(0,v.Ab)(r,"BLOCKQUOTE");if(D&&!t.shiftKey&&t.altKey&&t.key==="Enter"){(0,u._0)(t)?i.setStartBefore(D):i.setStartAfter(D),(0,N.jl)(i);var L=document.createElement("p");return L.setAttribute("data-block","0"),L.innerHTML=`
`,i.insertNode(L),i.collapse(!0),(0,N.jl)(i),Be(e),Ye(e),t.preventDefault(),!0}var H=(0,O.c)(r);if(H){if(H.tagName==="H6"&&r.textContent.length===i.startOffset&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Enter"){var F=document.createElement("p");return F.textContent=`
`,F.setAttribute("data-block","0"),r.parentElement.insertAdjacentElement("afterend",F),i.setStart(F,0),(0,N.jl)(i),Be(e),Ye(e),t.preventDefault(),!0}if(V("⌘=",t)){var Q=parseInt(H.tagName.substr(1),10)-1;return Q>0&&(st(e,"h".concat(Q)),Be(e)),t.preventDefault(),!0}if(V("⌘-",t)){var Q=parseInt(H.tagName.substr(1),10)+1;return Q<7&&(st(e,"h".concat(Q)),Be(e)),t.preventDefault(),!0}t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&H.textContent.length===1&&Ci(e)}if(Br(e,i,t))return!0;if(t.altKey&&t.key==="Enter"&&!(0,u._0)(t)&&!t.shiftKey){var J=(0,v._Y)(r,"A"),Y=(0,v.Th)(r,"data-type","link-ref"),le=(0,v.Th)(r,"data-type","footnotes-ref");if(J||Y||le||H&&H.tagName.length===2){var ne=e.wysiwyg.popover.querySelector("input");ne.focus(),ne.select()}}if(lt(e,t))return!0;if(V("⇧⌘U",t)){var q=e.wysiwyg.popover.querySelector('[data-type="up"]');if(q)return q.click(),t.preventDefault(),!0}if(V("⇧⌘D",t)){var q=e.wysiwyg.popover.querySelector('[data-type="down"]');if(q)return q.click(),t.preventDefault(),!0}if(Ni(e,i,t))return!0;if(!(0,u._0)(t)&&t.shiftKey&&!t.altKey&&t.key==="Enter"&&r.parentElement.tagName!=="LI"&&r.parentElement.tagName!=="P")return["STRONG","STRIKE","S","I","EM","B"].includes(r.parentElement.tagName)?i.insertNode(document.createTextNode(`
`+h.Y.ZWSP)):i.insertNode(document.createTextNode(`
`)),i.collapse(!1),(0,N.jl)(i),Be(e),Ye(e),t.preventDefault(),!0;if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&i.toString()===""){if(zr(e,i,t,l))return!0;if(o){if(o.previousElementSibling&&o.previousElementSibling.classList.contains("vditor-wysiwyg__block")&&o.previousElementSibling.getAttribute("data-block")==="0"&&o.tagName!=="UL"&&o.tagName!=="OL"){var he=(0,N.ED)(o,e.wysiwyg.element,i).start;if(he===0&&i.startOffset===0||he===1&&o.innerText.startsWith(h.Y.ZWSP))return An(o.previousElementSibling.lastElementChild,e,!1),o.innerHTML.trim().replace(h.Y.ZWSP,"")===""&&(o.remove(),Be(e)),t.preventDefault(),!0}var oe=i.startOffset;if(i.toString()===""&&r.nodeType===3&&r.textContent.charAt(oe-2)===`
`&&r.textContent.charAt(oe-1)!==h.Y.ZWSP&&["STRONG","STRIKE","S","I","EM","B"].includes(r.parentElement.tagName))return r.textContent=r.textContent.substring(0,oe-1)+h.Y.ZWSP,i.setStart(r,oe),i.collapse(!0),Be(e),t.preventDefault(),!0;r.textContent===h.Y.ZWSP&&i.startOffset===1&&!r.previousSibling&&Si(i)&&(r.textContent=""),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='math-inline']").forEach(function(ze){ze.firstElementChild.style.display="inline",ze.lastElementChild.style.display="none"}),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='html-entity']").forEach(function(ze){ze.firstElementChild.style.display="inline",ze.lastElementChild.style.display="none"})}}if((0,u.gm)()&&i.startOffset===1&&r.textContent.indexOf(h.Y.ZWSP)>-1&&r.previousSibling&&r.previousSibling.nodeType!==3&&r.previousSibling.tagName==="CODE"&&(t.key==="Backspace"||t.key==="ArrowLeft"))return i.selectNodeContents(r.previousSibling),i.collapse(!1),t.preventDefault(),!0;if(Ur(t,o,i))return t.preventDefault(),!0;if(xr(i,t.key),t.key==="ArrowDown"){var ge=r.nextSibling;ge&&ge.nodeType!==3&&ge.getAttribute("data-type")==="math-inline"&&i.setStartAfter(ge)}return o&&Ee(o,e,t,i)?(t.preventDefault(),!0):!1},lt=function(e,t){if(V("⇧⌘X",t)){var i=e.wysiwyg.popover.querySelector('[data-type="remove"]');return i&&i.click(),t.preventDefault(),!0}},Yt=function(e){clearTimeout(e.wysiwyg.hlToolbarTimeoutId),e.wysiwyg.hlToolbarTimeoutId=window.setTimeout(function(){if(e.wysiwyg.element.getAttribute("contenteditable")!=="false"&&(0,N.Co)(e.wysiwyg.element)){p(e.toolbar.elements,h.Y.EDIT_TOOLBARS),E(e.toolbar.elements,h.Y.EDIT_TOOLBARS);var t=getSelection().getRangeAt(0),i=t.startContainer;t.startContainer.nodeType===3?i=t.startContainer.parentElement:i=i.childNodes[t.startOffset>=i.childNodes.length?i.childNodes.length-1:t.startOffset];var r=(0,v.Th)(i,"data-type","footnotes-block");if(r){e.wysiwyg.popover.innerHTML="",gt(r,e),mt(e,r);return}var o=(0,v._Y)(i,"LI");o?(o.classList.contains("vditor-task")?g(e.toolbar.elements,["check"]):o.parentElement.tagName==="OL"?g(e.toolbar.elements,["ordered-list"]):o.parentElement.tagName==="UL"&&g(e.toolbar.elements,["list"]),E(e.toolbar.elements,["outdent","indent"])):b(e.toolbar.elements,["outdent","indent"]),(0,v._Y)(i,"BLOCKQUOTE")&&g(e.toolbar.elements,["quote"]),((0,v._Y)(i,"B")||(0,v._Y)(i,"STRONG"))&&g(e.toolbar.elements,["bold"]),((0,v._Y)(i,"I")||(0,v._Y)(i,"EM"))&&g(e.toolbar.elements,["italic"]),((0,v._Y)(i,"STRIKE")||(0,v._Y)(i,"S"))&&g(e.toolbar.elements,["strike"]),e.wysiwyg.element.querySelectorAll(".vditor-comment--focus").forEach(function(se){se.classList.remove("vditor-comment--focus")});var l=(0,v.KJ)(i,"vditor-comment");if(l){var w=l.getAttribute("data-cmtids").split(" ");if(w.length>1&&l.nextSibling.isSameNode(l.nextElementSibling)){var _=l.nextElementSibling.getAttribute("data-cmtids").split(" ");w.find(function(se){if(_.includes(se))return w=[se],!0})}e.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(se){se.getAttribute("data-cmtids").indexOf(w[0])>-1&&se.classList.add("vditor-comment--focus")})}var D=(0,v._Y)(i,"A");D&&g(e.toolbar.elements,["link"]);var L=(0,v._Y)(i,"TABLE"),H=(0,O.c)(i);(0,v._Y)(i,"CODE")?(0,v._Y)(i,"PRE")?(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),g(e.toolbar.elements,["code"])):(b(e.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),g(e.toolbar.elements,["inline-code"])):H?(b(e.toolbar.elements,["bold"]),g(e.toolbar.elements,["headings"])):L&&b(e.toolbar.elements,["table"]);var F=(0,v.KJ)(i,"vditor-toc");if(F){e.wysiwyg.popover.innerHTML="",gt(F,e),mt(e,F);return}var Q=(0,O.f)(i,"BLOCKQUOTE");if(Q&&(e.wysiwyg.popover.innerHTML="",fn(t,Q,e),hn(t,Q,e),gt(Q,e),mt(e,Q)),o&&(e.wysiwyg.popover.innerHTML="",fn(t,o,e),hn(t,o,e),gt(o,e),mt(e,o)),L){e.options.lang,e.options,e.wysiwyg.popover.innerHTML="";var J=function(){var se=L.rows.length,xe=L.rows[0].cells.length,Vt=parseInt(Ke.value,10)||se,$t=parseInt(ht.value,10)||xe;if(!(Vt===se&&xe===$t)){if(xe!==$t)for(var Nn=$t-xe,Mt=0;Mt<L.rows.length;Mt++)if(Nn>0)for(var Jr=0;Jr<Nn;Jr++)Mt===0?L.rows[Mt].lastElementChild.insertAdjacentHTML("afterend","<th> </th>"):L.rows[Mt].lastElementChild.insertAdjacentHTML("afterend","<td> </td>");else for(var zi=xe-1;zi>=$t;zi--)L.rows[Mt].cells[zi].remove();if(se!==Vt){var Qr=Vt-se;if(Qr>0){for(var Fi="<tr>",bn=0;bn<$t;bn++)Fi+="<td> </td>";for(var ea=0;ea<Qr;ea++)L.querySelector("tbody")?L.querySelector("tbody").insertAdjacentHTML("beforeend",Fi):L.querySelector("thead").insertAdjacentHTML("afterend",Fi+"</tr>")}else for(var bn=se-1;bn>=Vt;bn--)L.rows[bn].remove(),L.rows.length===1&&L.querySelector("tbody").remove()}typeof e.options.input=="function"&&e.options.input(C(e))}},Y=function(se){Kn(L,se),se==="right"?(he.classList.remove("vditor-icon--current"),oe.classList.remove("vditor-icon--current"),ge.classList.add("vditor-icon--current")):se==="center"?(he.classList.remove("vditor-icon--current"),ge.classList.remove("vditor-icon--current"),oe.classList.add("vditor-icon--current")):(oe.classList.remove("vditor-icon--current"),ge.classList.remove("vditor-icon--current"),he.classList.add("vditor-icon--current")),(0,N.jl)(t),Be(e)},le=(0,v._Y)(i,"TD"),ne=(0,v._Y)(i,"TH"),q="left";le?q=le.getAttribute("align")||"left":ne&&(q=ne.getAttribute("align")||"center");var he=document.createElement("button");he.setAttribute("type","button"),he.setAttribute("aria-label",window.VditorI18n.alignLeft+"<"+(0,u.fG)("⇧⌘L")+">"),he.setAttribute("data-type","left"),he.innerHTML='<svg><use xlink:href="#vditor-icon-align-left"></use></svg>',he.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(q==="left"?" vditor-icon--current":""),he.onclick=function(){Y("left")};var oe=document.createElement("button");oe.setAttribute("type","button"),oe.setAttribute("aria-label",window.VditorI18n.alignCenter+"<"+(0,u.fG)("⇧⌘C")+">"),oe.setAttribute("data-type","center"),oe.innerHTML='<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',oe.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(q==="center"?" vditor-icon--current":""),oe.onclick=function(){Y("center")};var ge=document.createElement("button");ge.setAttribute("type","button"),ge.setAttribute("aria-label",window.VditorI18n.alignRight+"<"+(0,u.fG)("⇧⌘R")+">"),ge.setAttribute("data-type","right"),ge.innerHTML='<svg><use xlink:href="#vditor-icon-align-right"></use></svg>',ge.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(q==="right"?" vditor-icon--current":""),ge.onclick=function(){Y("right")};var ze=document.createElement("button");ze.setAttribute("type","button"),ze.setAttribute("aria-label",window.VditorI18n.insertRowBelow+"<"+(0,u.fG)("⌘=")+">"),ze.setAttribute("data-type","insertRow"),ze.innerHTML='<svg><use xlink:href="#vditor-icon-insert-row"></use></svg>',ze.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",ze.onclick=function(){var se=getSelection().getRangeAt(0).startContainer,xe=(0,v._Y)(se,"TD")||(0,v._Y)(se,"TH");xe&&Or(e,t,xe)};var He=document.createElement("button");He.setAttribute("type","button"),He.setAttribute("aria-label",window.VditorI18n.insertRowAbove+"<"+(0,u.fG)("⇧⌘F")+">"),He.setAttribute("data-type","insertRow"),He.innerHTML='<svg><use xlink:href="#vditor-icon-insert-rowb"></use></svg>',He.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",He.onclick=function(){var se=getSelection().getRangeAt(0).startContainer,xe=(0,v._Y)(se,"TD")||(0,v._Y)(se,"TH");xe&&Pr(e,t,xe)};var Fe=document.createElement("button");Fe.setAttribute("type","button"),Fe.setAttribute("aria-label",window.VditorI18n.insertColumnRight+"<"+(0,u.fG)("⇧⌘=")+">"),Fe.setAttribute("data-type","insertColumn"),Fe.innerHTML='<svg><use xlink:href="#vditor-icon-insert-column"></use></svg>',Fe.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Fe.onclick=function(){var se=getSelection().getRangeAt(0).startContainer,xe=(0,v._Y)(se,"TD")||(0,v._Y)(se,"TH");xe&&Gn(e,L,xe)};var ct=document.createElement("button");ct.setAttribute("type","button"),ct.setAttribute("aria-label",window.VditorI18n.insertColumnLeft+"<"+(0,u.fG)("⇧⌘G")+">"),ct.setAttribute("data-type","insertColumn"),ct.innerHTML='<svg><use xlink:href="#vditor-icon-insert-columnb"></use></svg>',ct.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",ct.onclick=function(){var se=getSelection().getRangeAt(0).startContainer,xe=(0,v._Y)(se,"TD")||(0,v._Y)(se,"TH");xe&&Gn(e,L,xe,"beforebegin")};var it=document.createElement("button");it.setAttribute("type","button"),it.setAttribute("aria-label",window.VditorI18n["delete-row"]+"<"+(0,u.fG)("⌘-")+">"),it.setAttribute("data-type","deleteRow"),it.innerHTML='<svg><use xlink:href="#vditor-icon-delete-row"></use></svg>',it.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",it.onclick=function(){var se=getSelection().getRangeAt(0).startContainer,xe=(0,v._Y)(se,"TD")||(0,v._Y)(se,"TH");xe&&Rr(e,t,xe)};var ut=document.createElement("button");ut.setAttribute("type","button"),ut.setAttribute("aria-label",window.VditorI18n["delete-column"]+"<"+(0,u.fG)("⇧⌘-")+">"),ut.setAttribute("data-type","deleteColumn"),ut.innerHTML='<svg><use xlink:href="#vditor-icon-delete-column"></use></svg>',ut.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",ut.onclick=function(){var se=getSelection().getRangeAt(0).startContainer,xe=(0,v._Y)(se,"TD")||(0,v._Y)(se,"TH");xe&&Hr(e,t,L,xe)};var Te=document.createElement("span");Te.setAttribute("aria-label",window.VditorI18n.row),Te.className="vditor-tooltipped vditor-tooltipped__n";var Ke=document.createElement("input");Te.appendChild(Ke),Ke.type="number",Ke.min="1",Ke.className="vditor-input",Ke.style.width="42px",Ke.style.textAlign="center",Ke.setAttribute("placeholder",window.VditorI18n.row),Ke.value=L.rows.length.toString(),Ke.oninput=function(){J()},Ke.onkeydown=function(se){if(!se.isComposing){if(se.key==="Tab"){ht.focus(),ht.select(),se.preventDefault();return}lt(e,se)||kt(se,t)}};var Jn=document.createElement("span");Jn.setAttribute("aria-label",window.VditorI18n.column),Jn.className="vditor-tooltipped vditor-tooltipped__n";var ht=document.createElement("input");Jn.appendChild(ht),ht.type="number",ht.min="1",ht.className="vditor-input",ht.style.width="42px",ht.style.textAlign="center",ht.setAttribute("placeholder",window.VditorI18n.column),ht.value=L.rows[0].cells.length.toString(),ht.oninput=function(){J()},ht.onkeydown=function(se){if(!se.isComposing){if(se.key==="Tab"){Ke.focus(),Ke.select(),se.preventDefault();return}lt(e,se)||kt(se,t)}},fn(t,L,e),hn(t,L,e),gt(L,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",he),e.wysiwyg.popover.insertAdjacentElement("beforeend",oe),e.wysiwyg.popover.insertAdjacentElement("beforeend",ge),e.wysiwyg.popover.insertAdjacentElement("beforeend",He),e.wysiwyg.popover.insertAdjacentElement("beforeend",ze),e.wysiwyg.popover.insertAdjacentElement("beforeend",ct),e.wysiwyg.popover.insertAdjacentElement("beforeend",Fe),e.wysiwyg.popover.insertAdjacentElement("beforeend",it),e.wysiwyg.popover.insertAdjacentElement("beforeend",ut),e.wysiwyg.popover.insertAdjacentElement("beforeend",Te),e.wysiwyg.popover.insertAdjacentHTML("beforeend"," x "),e.wysiwyg.popover.insertAdjacentElement("beforeend",Jn),mt(e,L)}var Bi=(0,v.Th)(i,"data-type","link-ref");Bi&&br(e,Bi,t);var gn=(0,v.Th)(i,"data-type","footnotes-ref");if(gn){e.options.lang,e.options,e.wysiwyg.popover.innerHTML="";var Te=document.createElement("span");Te.setAttribute("aria-label",window.VditorI18n.footnoteRef+"<"+(0,u.fG)("⌥Enter")+">"),Te.className="vditor-tooltipped vditor-tooltipped__n";var Rt=document.createElement("input");Te.appendChild(Rt),Rt.className="vditor-input",Rt.setAttribute("placeholder",window.VditorI18n.footnoteRef+"<"+(0,u.fG)("⌥Enter")+">"),Rt.style.width="120px",Rt.value=gn.getAttribute("data-footnotes-label"),Rt.oninput=function(){Rt.value.trim()!==""&&gn.setAttribute("data-footnotes-label",Rt.value),typeof e.options.input=="function"&&e.options.input(C(e))},Rt.onkeydown=function(xe){xe.isComposing||lt(e,xe)||kt(xe,t)},gt(gn,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",Te),mt(e,gn)}var Qe=(0,v.KJ)(i,"vditor-wysiwyg__block"),Zr=Qe?Qe.getAttribute("data-type").indexOf("block")>-1:!1;if(e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(se){if(!Qe||Qe&&Zr&&!Qe.contains(se)){var xe=se.previousElementSibling;xe.style.display="none"}}),Qe&&Zr){if(e.wysiwyg.popover.innerHTML="",fn(t,Qe,e),hn(t,Qe,e),gt(Qe,e),Qe.getAttribute("data-type")==="code-block"){var Qn=document.createElement("span");Qn.setAttribute("aria-label",window.VditorI18n.language+"<"+(0,u.fG)("⌥Enter")+">"),Qn.className="vditor-tooltipped vditor-tooltipped__n";var Et=document.createElement("input");Qn.appendChild(Et);var In=Qe.firstElementChild.firstElementChild;Et.className="vditor-input",Et.setAttribute("placeholder",window.VditorI18n.language+"<"+(0,u.fG)("⌥Enter")+">"),Et.value=In.className.indexOf("language-")>-1?In.className.split("-")[1].split(" ")[0]:"",Et.oninput=function(se){Et.value.trim()!==""?In.className="language-".concat(Et.value):(In.className="",e.hint.recentLanguage=""),Qe.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(Qe.lastElementChild.innerHTML=Qe.firstElementChild.innerHTML,me(Qe.lastElementChild,e)),Be(e),se.detail===1&&(t.setStart(In.firstChild,0),t.collapse(!0),(0,N.jl)(t))},Et.onkeydown=function(se){if(!se.isComposing&&!lt(e,se)){if(se.key==="Escape"&&e.hint.element.style.display==="block"){e.hint.element.style.display="none",se.preventDefault();return}e.hint.select(se,e),kt(se,t)}},Et.onkeyup=function(se){var xe,Vt;if(!(se.isComposing||se.key==="Enter"||se.key==="ArrowUp"||se.key==="Escape"||se.key==="ArrowDown")){var $t=[],Nn=Et.value.substring(0,Et.selectionStart);(e.options.preview.hljs.langs||h.Y.ALIAS_CODE_LANGUAGES.concat(((Vt=(xe=window.hljs)===null||xe===void 0?void 0:xe.listLanguages())!==null&&Vt!==void 0?Vt:[]).sort())).forEach(function(Mt){Mt.indexOf(Nn.toLowerCase())>-1&&$t.push({html:Mt,value:Mt})}),e.hint.genHTML($t,Nn,e),se.preventDefault()}},e.wysiwyg.popover.insertAdjacentElement("beforeend",Qn)}mt(e,Qe)}else Qe=void 0;if(H){e.wysiwyg.popover.innerHTML="";var Te=document.createElement("span");Te.setAttribute("aria-label","ID<"+(0,u.fG)("⌥Enter")+">"),Te.className="vditor-tooltipped vditor-tooltipped__n";var Ut=document.createElement("input");Te.appendChild(Ut),Ut.className="vditor-input",Ut.setAttribute("placeholder","ID<"+(0,u.fG)("⌥Enter")+">"),Ut.style.width="120px",Ut.value=H.getAttribute("data-id")||"",Ut.oninput=function(){H.setAttribute("data-id",Ut.value),typeof e.options.input=="function"&&e.options.input(C(e))},Ut.onkeydown=function(xe){xe.isComposing||lt(e,xe)||kt(xe,t)},fn(t,H,e),hn(t,H,e),gt(H,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",Te),mt(e,H)}if(D&&Ti(e,D,t),!Q&&!o&&!L&&!Qe&&!D&&!Bi&&!gn&&!H&&!F){var vn=(0,v.Th)(i,"data-block","0");vn&&vn.parentElement.isEqualNode(e.wysiwyg.element)?(e.wysiwyg.popover.innerHTML="",fn(t,vn,e),hn(t,vn,e),gt(vn,e),mt(e,vn)):e.wysiwyg.popover.style.display="none"}e.wysiwyg.element.querySelectorAll('span[data-type="backslash"] > span').forEach(function(se){se.style.display="none"});var Xr=(0,v.Th)(t.startContainer,"data-type","backslash");Xr&&(Xr.querySelector("span").style.display="inline")}},200)},mt=function(e,t){var i=t,r=(0,v._Y)(t,"TABLE");r&&(i=r),e.wysiwyg.popover.style.left="0",e.wysiwyg.popover.style.display="block",e.wysiwyg.popover.style.top=Math.max(-8,i.offsetTop-21-e.wysiwyg.element.scrollTop)+"px",e.wysiwyg.popover.style.left=Math.min(i.offsetLeft,e.wysiwyg.element.clientWidth-e.wysiwyg.popover.clientWidth)+"px",e.wysiwyg.popover.setAttribute("data-top",(i.offsetTop-21).toString())},br=function(e,t,i){i===void 0&&(i=getSelection().getRangeAt(0)),e.wysiwyg.popover.innerHTML="";var r=function(){l.value.trim()!==""&&(t.tagName==="IMG"?t.setAttribute("alt",l.value):t.textContent=l.value),_.value.trim()!==""&&t.setAttribute("data-link-label",_.value),typeof e.options.input=="function"&&e.options.input(C(e))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),l.style.width="120px",l.value=t.getAttribute("alt")||t.textContent,l.oninput=function(){r()},l.onkeydown=function(D){lt(e,D)||kt(D,i)||Dn(e,t,D,_)};var w=document.createElement("span");w.setAttribute("aria-label",window.VditorI18n.linkRef),w.className="vditor-tooltipped vditor-tooltipped__n";var _=document.createElement("input");w.appendChild(_),_.className="vditor-input",_.setAttribute("placeholder",window.VditorI18n.linkRef),_.value=t.getAttribute("data-link-label"),_.oninput=function(){r()},_.onkeydown=function(D){lt(e,D)||kt(D,i)||Dn(e,t,D,l)},gt(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",o),e.wysiwyg.popover.insertAdjacentElement("beforeend",w),mt(e,t)},fn=function(e,t,i){var r=t.previousElementSibling;if(!(!r||!t.parentElement.isEqualNode(i.wysiwyg.element)&&t.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","up"),o.setAttribute("aria-label",window.VditorI18n.up+"<"+(0,u.fG)("⇧⌘U")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-up"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){e.insertNode(document.createElement("wbr")),r.insertAdjacentElement("beforebegin",t),(0,N.ir)(i.wysiwyg.element,e),Be(i),Yt(i),Ye(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},hn=function(e,t,i){var r=t.nextElementSibling;if(!(!r||!t.parentElement.isEqualNode(i.wysiwyg.element)&&t.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","down"),o.setAttribute("aria-label",window.VditorI18n.down+"<"+(0,u.fG)("⇧⌘D")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-down"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){e.insertNode(document.createElement("wbr")),r.insertAdjacentElement("afterend",t),(0,N.ir)(i.wysiwyg.element,e),Be(i),Yt(i),Ye(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},gt=function(e,t){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-type","remove"),i.setAttribute("aria-label",window.VditorI18n.remove+"<"+(0,u.fG)("⇧⌘X")+">"),i.innerHTML='<svg><use xlink:href="#vditor-icon-trashcan"></use></svg>',i.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",i.onclick=function(){var r=(0,N.RN)(t);r.setStartAfter(e),(0,N.jl)(r),e.remove(),Be(t),Yt(t),["H1","H2","H3","H4","H5","H6"].includes(e.tagName)&&X(t)},t.wysiwyg.popover.insertAdjacentElement("beforeend",i)},Dn=function(e,t,i,r){if(!i.isComposing){if(i.key==="Tab"){r.focus(),r.select(),i.preventDefault();return}if(!(0,u._0)(i)&&!i.shiftKey&&i.altKey&&i.key==="Enter"){var o=(0,N.RN)(e);t.insertAdjacentHTML("afterend",h.Y.ZWSP),o.setStartAfter(t.nextSibling),o.collapse(!0),(0,N.jl)(o),i.preventDefault()}}},Ti=function(e,t,i){e.wysiwyg.popover.innerHTML="";var r=function(){l.value.trim()!==""&&(t.innerHTML=l.value),t.setAttribute("href",_.value),t.setAttribute("title",L.value),Be(e)};t.querySelectorAll("[data-marker]").forEach(function(H){H.removeAttribute("data-marker")});var o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),l.style.width="120px",l.value=t.innerHTML||"",l.oninput=function(){r()},l.onkeydown=function(H){lt(e,H)||kt(H,i)||Dn(e,t,H,_)};var w=document.createElement("span");w.setAttribute("aria-label",window.VditorI18n.link),w.className="vditor-tooltipped vditor-tooltipped__n";var _=document.createElement("input");w.appendChild(_),_.className="vditor-input",_.setAttribute("placeholder",window.VditorI18n.link),_.value=t.getAttribute("href")||"",_.oninput=function(){r()},_.onkeydown=function(H){lt(e,H)||kt(H,i)||Dn(e,t,H,L)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.tooltipText),D.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");D.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.tooltipText),L.style.width="60px",L.value=t.getAttribute("title")||"",L.oninput=function(){r()},L.onkeydown=function(H){lt(e,H)||kt(H,i)||Dn(e,t,H,l)},gt(t,e),e.wysiwyg.popover.insertAdjacentElement("beforeend",o),e.wysiwyg.popover.insertAdjacentElement("beforeend",w),e.wysiwyg.popover.insertAdjacentElement("beforeend",D),mt(e,t)},co=function(e,t){var i=e.target;t.wysiwyg.popover.innerHTML="";var r=function(){i.setAttribute("src",l.value),i.setAttribute("alt",_.value),i.setAttribute("title",L.value),typeof t.options.input=="function"&&t.options.input(C(t))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.imageURL),o.className="vditor-tooltipped vditor-tooltipped__n";var l=document.createElement("input");o.appendChild(l),l.className="vditor-input",l.setAttribute("placeholder",window.VditorI18n.imageURL),l.value=i.getAttribute("src")||"",l.oninput=function(){r()},l.onkeydown=function(H){lt(t,H)};var w=document.createElement("span");w.setAttribute("aria-label",window.VditorI18n.alternateText),w.className="vditor-tooltipped vditor-tooltipped__n";var _=document.createElement("input");w.appendChild(_),_.className="vditor-input",_.setAttribute("placeholder",window.VditorI18n.alternateText),_.style.width="52px",_.value=i.getAttribute("alt")||"",_.oninput=function(){r()},_.onkeydown=function(H){lt(t,H)};var D=document.createElement("span");D.setAttribute("aria-label",window.VditorI18n.title),D.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");D.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.title),L.value=i.getAttribute("title")||"",L.oninput=function(){r()},L.onkeydown=function(H){lt(t,H)},gt(i,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",o),t.wysiwyg.popover.insertAdjacentElement("beforeend",w),t.wysiwyg.popover.insertAdjacentElement("beforeend",D),mt(t,i)},kt=function(e,t){if(!(0,u._0)(e)&&!e.shiftKey&&e.key==="Enter"||e.key==="Escape")return t&&(0,N.jl)(t),e.preventDefault(),e.stopPropagation(),!0},pn=function(e){e.currentMode==="wysiwyg"?Yt(e):e.currentMode==="ir"&&un(e)},yr=function(e,t,i){i===void 0&&(i={enableAddUndoStack:!0,enableHint:!1,enableInput:!0});var r=e.wysiwyg.element;r.innerHTML=e.lute.Md2VditorDOM(t),r.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(o){me(o,e),o.previousElementSibling.setAttribute("style","display:none")}),Be(e,i)},uo=function(e,t,i){for(var r=e.startContainer.parentElement,o=!1,l="",w="",_=Tt(e),D=_.beforeHTML,L=_.afterHTML;r&&!o;){var H=r.tagName;if(H==="STRIKE"&&(H="S"),H==="I"&&(H="EM"),H==="B"&&(H="STRONG"),H==="S"||H==="STRONG"||H==="EM"){var F="",Q="",J="";r.parentElement.getAttribute("data-block")!=="0"&&(Q=nt(r),J=dn(r)),(D||Q)&&(F="".concat(Q,"<").concat(H,">").concat(D,"</").concat(H,">"),D=F),(i==="bold"&&H==="STRONG"||i==="italic"&&H==="EM"||i==="strikeThrough"&&H==="S")&&(F+="".concat(l).concat(h.Y.ZWSP,"<wbr>").concat(w),o=!0),(L||J)&&(L="<".concat(H,">").concat(L,"</").concat(H,">").concat(J),F+=L),r.parentElement.getAttribute("data-block")!=="0"?(r=r.parentElement,r.innerHTML=F):(r.outerHTML=F,r=r.parentElement),l="<".concat(H,">")+l,w="</".concat(H,">")+w}else o=!0}(0,N.ir)(t.wysiwyg.element,e)},fo=function(e,t,i){if(!(e.wysiwyg.composingLock&&i instanceof CustomEvent)){var r=!0,o=!0;e.wysiwyg.element.querySelector("wbr")&&e.wysiwyg.element.querySelector("wbr").remove();var l=(0,N.RN)(e),w=t.getAttribute("data-type");if(t.classList.contains("vditor-menu--current"))if(w==="strike"&&(w="strikeThrough"),w==="quote"){var _=(0,v._Y)(l.startContainer,"BLOCKQUOTE");_||(_=l.startContainer.childNodes[l.startOffset]),_&&(r=!1,t.classList.remove("vditor-menu--current"),l.insertNode(document.createElement("wbr")),_.outerHTML=_.innerHTML.trim()===""?'<p data-block="0">'.concat(_.innerHTML,"</p>"):_.innerHTML,(0,N.ir)(e.wysiwyg.element,l))}else if(w==="inline-code"){var D=(0,v._Y)(l.startContainer,"CODE");D||(D=l.startContainer.childNodes[l.startOffset]),D&&(D.outerHTML=D.innerHTML.replace(h.Y.ZWSP,"")+"<wbr>",(0,N.ir)(e.wysiwyg.element,l))}else w==="link"?(l.collapsed&&l.selectNode(l.startContainer.parentElement),document.execCommand("unlink",!1,"")):w==="check"||w==="list"||w==="ordered-list"?(Yn(e,l,w),(0,N.ir)(e.wysiwyg.element,l),r=!1,t.classList.remove("vditor-menu--current")):(r=!1,t.classList.remove("vditor-menu--current"),l.toString()===""?uo(l,e,w):document.execCommand(w,!1,""));else{e.wysiwyg.element.childNodes.length===0&&(e.wysiwyg.element.innerHTML='<p data-block="0"><wbr></p>',(0,N.ir)(e.wysiwyg.element,l));var L=(0,v.pt)(l.startContainer);if(w==="quote"){if(L||(L=l.startContainer.childNodes[l.startOffset]),L){r=!1,t.classList.add("vditor-menu--current"),l.insertNode(document.createElement("wbr"));var H=(0,v._Y)(l.startContainer,"LI");H&&L.contains(H)?H.innerHTML='<blockquote data-block="0">'.concat(H.innerHTML,"</blockquote>"):L.outerHTML='<blockquote data-block="0">'.concat(L.outerHTML,"</blockquote>"),(0,N.ir)(e.wysiwyg.element,l)}}else if(w==="check"||w==="list"||w==="ordered-list")Yn(e,l,w,!1),(0,N.ir)(e.wysiwyg.element,l),r=!1,p(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current");else if(w==="inline-code"){if(l.toString()===""){var F=document.createElement("code");F.textContent=h.Y.ZWSP,l.insertNode(F),l.setStart(F.firstChild,1),l.collapse(!0),(0,N.jl)(l)}else if(l.startContainer.nodeType===3){var F=document.createElement("code");l.surroundContents(F),l.insertNode(F),(0,N.jl)(l)}t.classList.add("vditor-menu--current")}else if(w==="code"){var F=document.createElement("div");F.className="vditor-wysiwyg__block",F.setAttribute("data-type","code-block"),F.setAttribute("data-block","0"),F.setAttribute("data-marker","```"),l.toString()===""?F.innerHTML=`<pre><code><wbr>
</code></pre>`:(F.innerHTML="<pre><code>".concat(l.toString(),"<wbr></code></pre>"),l.deleteContents()),l.insertNode(F),L&&(L.outerHTML=e.lute.SpinVditorDOM(L.outerHTML)),(0,N.ir)(e.wysiwyg.element,l),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(ze){me(ze,e)}),t.classList.add("vditor-menu--disabled")}else if(w==="link"){if(l.toString()===""){var Q=document.createElement("a");Q.innerText=h.Y.ZWSP,l.insertNode(Q),l.setStart(Q.firstChild,1),l.collapse(!0),Ti(e,Q,l);var J=e.wysiwyg.popover.querySelector("input");J.value="",J.focus(),o=!1}else{var F=document.createElement("a");F.setAttribute("href",""),F.innerHTML=l.toString(),l.surroundContents(F),l.insertNode(F),(0,N.jl)(l),Ti(e,F,l);var Y=e.wysiwyg.popover.querySelectorAll("input");Y[0].value=F.innerText,Y[1].focus()}r=!1,t.classList.add("vditor-menu--current")}else if(w==="table"){var le='<table data-block="0"><thead><tr><th>col1<wbr></th><th>col2</th><th>col3</th></tr></thead><tbody><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></tbody></table>';if(l.toString().trim()==="")L&&L.innerHTML.trim().replace(h.Y.ZWSP,"")===""?L.outerHTML=le:document.execCommand("insertHTML",!1,le),l.selectNode(e.wysiwyg.element.querySelector("wbr").previousSibling),e.wysiwyg.element.querySelector("wbr").remove(),(0,N.jl)(l);else{le='<table data-block="0"><thead><tr>';var ne=l.toString().split(`
`),q=ne[0].split(",").length>ne[0].split("	").length?",":"	";ne.forEach(function(ge,ze){ze===0?(ge.split(q).forEach(function(He,Fe){Fe===0?le+="<th>".concat(He,"<wbr></th>"):le+="<th>".concat(He,"</th>")}),le+="</tr></thead>"):(ze===1?le+="<tbody><tr>":le+="<tr>",ge.split(q).forEach(function(He){le+="<td>".concat(He,"</td>")}),le+="</tr>")}),le+="</tbody></table>",document.execCommand("insertHTML",!1,le),(0,N.ir)(e.wysiwyg.element,l)}r=!1,t.classList.add("vditor-menu--disabled")}else if(w==="line"){if(L){var he=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;L.innerHTML.trim()===""?L.outerHTML=he:L.insertAdjacentHTML("afterend",he),(0,N.ir)(e.wysiwyg.element,l)}}else if(r=!1,t.classList.add("vditor-menu--current"),w==="strike"&&(w="strikeThrough"),l.toString()===""&&(w==="bold"||w==="italic"||w==="strikeThrough")){var oe="strong";w==="italic"?oe="em":w==="strikeThrough"&&(oe="s");var F=document.createElement(oe);F.textContent=h.Y.ZWSP,l.insertNode(F),F.previousSibling&&F.previousSibling.textContent===h.Y.ZWSP&&(F.previousSibling.textContent=""),l.setStart(F.firstChild,1),l.collapse(!0),(0,N.jl)(l)}else document.execCommand(w,!1,"")}r&&Yt(e),o&&Be(e)}},Ve=function(){function e(t,i){var r,o=this;this.element=document.createElement("div"),i.className&&(r=this.element.classList).add.apply(r,i.className.split(" "));var l=i.hotkey?" <".concat((0,u.fG)(i.hotkey),">"):"";i.level===2&&(l=i.hotkey?" &lt;".concat((0,u.fG)(i.hotkey),"&gt;"):"");var w=i.tip?i.tip+l:"".concat(window.VditorI18n[i.name]).concat(l),_=i.name==="upload"?"div":"button";if(i.level===2)this.element.innerHTML="<".concat(_,' data-type="').concat(i.name,'">').concat(w,"</").concat(_,">");else{this.element.classList.add("vditor-toolbar__item");var D=document.createElement(_);D.setAttribute("data-type",i.name),D.className="vditor-tooltipped vditor-tooltipped__".concat(i.tipPosition),D.setAttribute("aria-label",w),D.innerHTML=i.icon,this.element.appendChild(D)}i.prefix&&this.element.children[0].addEventListener((0,u.y3)(),function(L){L.preventDefault(),!o.element.firstElementChild.classList.contains(h.Y.CLASS_MENU_DISABLED)&&(t.currentMode==="wysiwyg"?fo(t,o.element.children[0],L):t.currentMode==="ir"?xo(t,o.element.children[0],i.prefix||"",i.suffix||""):go(t,o.element.children[0],i.prefix||"",i.suffix||""))})}return e}(),ho=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Kt=function(e,t,i){var r;if(typeof i!="string"?(x(e,["subToolbar","hint"]),i.preventDefault(),r=C(e)):r=i,!(e.currentMode===t&&typeof i!="string")){if(e.devtools&&e.devtools.renderEchart(e),e.options.preview.mode==="both"&&t==="sv"?e.preview.element.style.display="block":e.preview.element.style.display="none",E(e.toolbar.elements,h.Y.EDIT_TOOLBARS),p(e.toolbar.elements,h.Y.EDIT_TOOLBARS),b(e.toolbar.elements,["outdent","indent"]),t==="ir")k(e.toolbar.elements,["both"]),M(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="block",e.lute.SetVditorIR(!0),e.lute.SetVditorWYSIWYG(!1),e.lute.SetVditorSV(!1),e.currentMode="ir",e.ir.element.innerHTML=e.lute.Md2VditorIRDOM(r),Pt(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),Ze(e),e.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(l){me(l,e)}),e.ir.element.querySelectorAll(".vditor-toc").forEach(function(l){(0,de.T)(l,{cdn:e.options.cdn,math:e.options.preview.math})});else if(t==="wysiwyg")k(e.toolbar.elements,["both"]),M(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.sv.element.style.display="none",e.wysiwyg.element.parentElement.style.display="block",e.ir.element.parentElement.style.display="none",e.lute.SetVditorIR(!1),e.lute.SetVditorWYSIWYG(!0),e.lute.SetVditorSV(!1),e.currentMode="wysiwyg",Ze(e),yr(e,r,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),e.wysiwyg.element.querySelectorAll(".vditor-toc").forEach(function(l){(0,de.T)(l,{cdn:e.options.cdn,math:e.options.preview.math})}),e.wysiwyg.popover.style.display="none";else if(t==="sv"){M(e.toolbar.elements,["both"]),k(e.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),e.wysiwyg.element.parentElement.style.display="none",e.ir.element.parentElement.style.display="none",(e.options.preview.mode==="both"||e.options.preview.mode==="editor")&&(e.sv.element.style.display="block"),e.lute.SetVditorIR(!1),e.lute.SetVditorWYSIWYG(!1),e.lute.SetVditorSV(!0),e.currentMode="sv";var o=Er(r,e);o==="<div data-block='0'></div>"&&(o=""),e.sv.element.innerHTML=o,Se(e.sv.element),Xe(e,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),Ze(e)}e.undo.resetIcon(e),typeof i!="string"&&(e[e.currentMode].element.focus(),pn(e)),X(e),Ot(e),e.toolbar.elements["edit-mode"]&&(e.toolbar.elements["edit-mode"].querySelectorAll("button").forEach(function(l){l.classList.remove("vditor-menu--current")}),e.toolbar.elements["edit-mode"].querySelector('button[data-mode="'.concat(e.currentMode,'"]')).classList.add("vditor-menu--current")),e.outline.toggle(e,e.currentMode!=="sv"&&e.options.outline.enable,typeof i!="string")}},po=function(e){ho(t,e);function t(i,r){var o=e.call(this,i,r)||this,l=document.createElement("div");return l.className="vditor-hint".concat(r.level===2?"":" vditor-panel--arrow"),l.innerHTML='<button data-mode="wysiwyg">'.concat(window.VditorI18n.wysiwyg," &lt;").concat((0,u.fG)("⌥⌘7"),`></button>
<button data-mode="ir">`).concat(window.VditorI18n.instantRendering," &lt;").concat((0,u.fG)("⌥⌘8"),`></button>
<button data-mode="sv">`).concat(window.VditorI18n.splitView," &lt;").concat((0,u.fG)("⌥⌘9"),"></button>"),o.element.appendChild(l),o._bindEvent(i,l,r),o}return t.prototype._bindEvent=function(i,r,o){var l=this.element.children[0];A(i,r,l,o.level),r.children.item(0).addEventListener((0,u.y3)(),function(w){Kt(i,"wysiwyg",w),w.preventDefault(),w.stopPropagation()}),r.children.item(1).addEventListener((0,u.y3)(),function(w){Kt(i,"ir",w),w.preventDefault(),w.stopPropagation()}),r.children.item(2).addEventListener((0,u.y3)(),function(w){Kt(i,"sv",w),w.preventDefault(),w.stopPropagation()})},t}(Ve),On=function(e,t){return(0,N.Co)(e,t)?getSelection().toString():""},ki=function(e,t){t.addEventListener("focus",function(){e.options.focus&&e.options.focus(C(e)),x(e,["subToolbar","hint"])})},wr=function(e,t){t.addEventListener("dblclick",function(i){i.target.tagName==="IMG"&&(e.options.image.preview?e.options.image.preview(i.target):e.options.image.isPreview&&(0,K.o)(i.target,e.options.lang,e.options.theme))})},Mi=function(e,t){t.addEventListener("blur",function(i){if(e.currentMode==="ir"){var r=e.ir.element.querySelector(".vditor-ir__node--expand");r&&r.classList.remove("vditor-ir__node--expand")}else e.currentMode==="wysiwyg"&&!e.wysiwyg.selectPopover.contains(i.relatedTarget)&&e.wysiwyg.hideComment();e[e.currentMode].range=(0,N.RN)(e),e.options.blur&&e.options.blur(C(e))})},xi=function(e,t){t.addEventListener("dragstart",function(i){i.dataTransfer.setData(h.Y.DROP_EDITOR,h.Y.DROP_EDITOR)}),t.addEventListener("drop",function(i){i.dataTransfer.getData(h.Y.DROP_EDITOR)?Me(e):(i.dataTransfer.types.includes("Files")||i.dataTransfer.types.includes("text/html"))&&Zn(e,i,{pasteCode:function(r){document.execCommand("insertHTML",!1,r)}})})},_i=function(e,t,i){t.addEventListener("copy",function(r){return i(r,e)})},Li=function(e,t,i){t.addEventListener("cut",function(r){i(r,e),e.options.comment.enable&&e.currentMode==="wysiwyg"&&e.wysiwyg.getComments(e),document.execCommand("delete")})},Ye=function(e){if(e.currentMode==="wysiwyg"&&e.options.comment.enable&&e.options.comment.adjustTop(e.wysiwyg.getComments(e,!0)),!!e.options.typewriterMode){var t=e[e.currentMode].element,i=(0,N.Ey)(t).top;e.options.height==="auto"&&!e.element.classList.contains("vditor--fullscreen")&&window.scrollTo(window.scrollX,i+e.element.offsetTop+e.toolbar.element.offsetHeight-window.innerHeight/2+10),(e.options.height!=="auto"||e.element.classList.contains("vditor--fullscreen"))&&(t.scrollTop=i+t.scrollTop-t.clientHeight/2+10)}},Ai=function(e,t){t.addEventListener("keydown",function(i){if(!i.isComposing&&e.options.keydown&&e.options.keydown(i),!((e.options.hint.extend.length>1||e.toolbar.elements.emoji)&&e.hint.select(i,e))){if(e.options.comment.enable&&e.currentMode==="wysiwyg"&&(i.key==="Backspace"||V("⌘X",i))&&e.wysiwyg.getComments(e),e.currentMode==="sv"){if($e(e,i))return}else if(e.currentMode==="wysiwyg"){if(lo(e,i))return}else if(e.currentMode==="ir"&&te(e,i))return;if(e.options.ctrlEnter&&V("⌘Enter",i)){e.options.ctrlEnter(C(e)),i.preventDefault();return}if(V("⌘Z",i)&&!e.toolbar.elements.undo){e.undo.undo(e),i.preventDefault();return}if(V("⌘Y",i)&&!e.toolbar.elements.redo){e.undo.redo(e),i.preventDefault();return}if(i.key==="Escape"){e.hint.element.style.display==="block"?e.hint.element.style.display="none":e.options.esc&&!i.isComposing&&e.options.esc(C(e)),i.preventDefault();return}if((0,u._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[1-6]$/.test(i.code)){if(e.currentMode==="wysiwyg"){var r=i.code.replace("Digit","H");(0,v._Y)(getSelection().getRangeAt(0).startContainer,r)?Ci(e):st(e,r),Be(e)}else e.currentMode==="sv"?Sr(e,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" "):e.currentMode==="ir"&&Hn(e,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" ");return i.preventDefault(),!0}if((0,u._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[7-9]$/.test(i.code))return i.code==="Digit7"?Kt(e,"wysiwyg",i):i.code==="Digit8"?Kt(e,"ir",i):i.code==="Digit9"&&Kt(e,"sv",i),!0;e.options.toolbar.find(function(o){if(!o.hotkey||o.toolbar){if(o.toolbar){var l=o.toolbar.find(function(w){if(!w.hotkey)return!1;if(V(w.hotkey,i))return e.toolbar.elements[w.name].children[0].dispatchEvent(new CustomEvent((0,u.y3)())),i.preventDefault(),!0});return!!l}return!1}if(V(o.hotkey,i))return e.toolbar.elements[o.name].children[0].dispatchEvent(new CustomEvent((0,u.y3)())),i.preventDefault(),!0})}})},Di=function(e,t){t.addEventListener("selectstart",function(i){t.onmouseup=function(){setTimeout(function(){var r=On(e[e.currentMode].element);r.trim()?(e.currentMode==="wysiwyg"&&e.options.comment.enable&&(!(0,v.Th)(i.target,"data-type","footnotes-block")&&!(0,v.Th)(i.target,"data-type","link-ref-defs-block")?e.wysiwyg.showComment():e.wysiwyg.hideComment()),e.options.select&&e.options.select(r)):e.currentMode==="wysiwyg"&&e.options.comment.enable&&e.wysiwyg.hideComment()})}})},Oi=function(e,t){var i=(0,N.RN)(e);i.extractContents(),i.insertNode(document.createTextNode(Lute.Caret)),i.insertNode(document.createTextNode(t));var r=(0,v.Th)(i.startContainer,"data-block","0");r||(r=e.sv.element);var o=e.lute.SpinVditorSVDOM(r.textContent);o="<div data-block='0'>"+o.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",r.isEqualNode(e.sv.element)?r.innerHTML=o:r.outerHTML=o,Se(e.sv.element),(0,N.ir)(e.sv.element,i),Ye(e)},qn=function(e,t,i){i===void 0&&(i=!0);var r=e;for(r.nodeType===3&&(r=r.parentElement);r;){if(r.getAttribute("data-type")===t)return r;i?r=r.previousElementSibling:r=r.nextElementSibling}return!1},Er=function(e,t){I("SpinVditorSVDOM",e,"argument",t.options.debugger);var i=t.lute.SpinVditorSVDOM(e);return e="<div data-block='0'>"+i.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",I("SpinVditorSVDOM",e,"result",t.options.debugger),e},mo=function(e){var t=e.getAttribute("data-type"),i=e.previousElementSibling,r=t&&t!=="text"&&t!=="table"&&t!=="heading-marker"&&t!=="newline"&&t!=="yaml-front-matter-open-marker"&&t!=="yaml-front-matter-close-marker"&&t!=="code-block-info"&&t!=="code-block-close-marker"&&t!=="code-block-open-marker"?e.textContent:"",o=!1;for(t==="newline"&&(o=!0);i&&!o;){var l=i.getAttribute("data-type");if(l==="li-marker"||l==="blockquote-marker"||l==="task-marker"||l==="padding"){var w=i.textContent;if(l==="li-marker"&&(t==="code-block-open-marker"||t==="code-block-info"))r=w.replace(/\S/g," ")+r;else if(t==="code-block-close-marker"&&i.nextElementSibling.isSameNode(e)){var _=qn(e,"code-block-open-marker");_&&_.previousElementSibling&&(i=_.previousElementSibling,r=w+r)}else r=w+r}else l==="newline"&&(o=!0);i=i.previousElementSibling}return r},Xe=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&e.hint.render(e),e.preview.render(e);var i=C(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),clearTimeout(e.sv.processTimeoutId),e.sv.processTimeoutId=window.setTimeout(function(){t.enableAddUndoStack&&!e.sv.composingLock&&e.undo.addToUndoStack(e)},e.options.undoDelay)},Sr=function(e,t){var i=(0,N.RN)(e),r=(0,O.f)(i.startContainer,"SPAN");r&&r.textContent.trim()!==""&&(t=`
`+t),i.collapse(!0),document.execCommand("insertHTML",!1,t)},go=function(e,t,i,r){var o=(0,N.RN)(e),l=t.getAttribute("data-type");e.sv.element.childNodes.length===0&&(e.sv.element.innerHTML=`<span data-type="p" data-block="0"><span data-type="text"><wbr></span></span><span data-type="newline"><br><span style="display: none">
</span></span>`,(0,N.ir)(e.sv.element,o));var w=(0,v.pt)(o.startContainer),_=(0,O.f)(o.startContainer,"SPAN");if(w){if(l==="link"){var D=void 0;o.toString()===""?D="".concat(i).concat(Lute.Caret).concat(r):D="".concat(i).concat(o.toString()).concat(r.replace(")",Lute.Caret+")")),document.execCommand("insertHTML",!1,D);return}else if(l==="italic"||l==="bold"||l==="strike"||l==="inline-code"||l==="code"||l==="table"||l==="line"){var D=void 0;o.toString()===""?D="".concat(i).concat(Lute.Caret).concat(l==="code"?"":r):D="".concat(i).concat(o.toString()).concat(Lute.Caret).concat(l==="code"?"":r),l==="table"||l==="code"&&_&&_.textContent!==""?D=`

`+D:l==="line"&&(D=`

`.concat(i,`
`).concat(Lute.Caret)),document.execCommand("insertHTML",!1,D);return}else if((l==="check"||l==="list"||l==="ordered-list"||l==="quote")&&_){var L="* ";l==="check"?L="* [ ] ":l==="ordered-list"?L="1. ":l==="quote"&&(L="> ");var H=qn(_,"newline");H?H.insertAdjacentText("afterend",L):w.insertAdjacentText("afterbegin",L),Ce(e);return}(0,N.ir)(e.sv.element,o),Xe(e)}},Cr=function(e){switch(e.currentMode){case"ir":return e.ir.element;case"wysiwyg":return e.wysiwyg.element;case"sv":return e.sv.element}},Tr=function(e,t){e.options.upload.setHeaders&&(e.options.upload.headers=e.options.upload.setHeaders()),e.options.upload.headers&&Object.keys(e.options.upload.headers).forEach(function(i){t.setRequestHeader(i,e.options.upload.headers[i])})},vo=function(e,t,i,r){function o(l){return l instanceof i?l:new i(function(w){w(l)})}return new(i||(i=Promise))(function(l,w){function _(H){try{L(r.next(H))}catch(F){w(F)}}function D(H){try{L(r.throw(H))}catch(F){w(F)}}function L(H){H.done?l(H.value):o(H.value).then(_,D)}L((r=r.apply(e,t||[])).next())})},bo=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,o,l,w;return w={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function _(L){return function(H){return D([L,H])}}function D(L){if(r)throw new TypeError("Generator is already executing.");for(;w&&(w=0,L[0]&&(i=0)),i;)try{if(r=1,o&&(l=L[0]&2?o.return:L[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,L[1])).done)return l;switch(o=0,l&&(L=[L[0]&2,l.value]),L[0]){case 0:case 1:l=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!l||L[1]>l[0]&&L[1]<l[3])){i.label=L[1];break}if(L[0]===6&&i.label<l[1]){i.label=l[1],l=L;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(L);break}l[2]&&i.ops.pop(),i.trys.pop();continue}L=t.call(e,i)}catch(H){L=[6,H],o=0}finally{r=l=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},yo=function(){function e(){this.isUploading=!1,this.element=document.createElement("div"),this.element.className="vditor-upload"}return e}(),wo=function(e,t){e.tip.hide();var i=[],r="",o="";e.options.lang,e.options;for(var l=function(D,L){var H=t[L],F=!0;H.name||(r+="<li>".concat(window.VditorI18n.nameEmpty,"</li>"),F=!1),H.size>e.options.upload.max&&(r+="<li>".concat(H.name," ").concat(window.VditorI18n.over," ").concat(e.options.upload.max/1024/1024,"M</li>"),F=!1);var Q=H.name.lastIndexOf("."),J=H.name.substr(Q),Y=e.options.upload.filename(H.name.substr(0,Q))+J;if(e.options.upload.accept){var le=e.options.upload.accept.split(",").some(function(ne){var q=ne.trim();if(q.indexOf(".")===0){if(J.toLowerCase()===q.toLowerCase())return!0}else if(H.type.split("/")[0]===q.split("/")[0])return!0;return!1});le||(r+="<li>".concat(H.name," ").concat(window.VditorI18n.fileTypeError,"</li>"),F=!1)}F&&(i.push(H),o+="<li>".concat(Y," ").concat(window.VditorI18n.uploading,"</li>"))},w=t.length,_=0;_<w;_++)l(w,_);return e.tip.show("<ul>".concat(r).concat(o,"</ul>")),i},Eo=function(e,t){var i=Cr(t);i.focus();var r=JSON.parse(e),o="";r.code===1&&(o="".concat(r.msg)),r.data.errFiles&&r.data.errFiles.length>0&&(o="<ul><li>".concat(o,"</li>"),r.data.errFiles.forEach(function(w){var _=w.lastIndexOf("."),D=t.options.upload.filename(w.substr(0,_))+w.substr(_);o+="<li>".concat(D," ").concat(window.VditorI18n.uploadError,"</li>")}),o+="</ul>"),o?t.tip.show(o):t.tip.hide();var l="";Object.keys(r.data.succMap).forEach(function(w){var _=r.data.succMap[w],D=w.lastIndexOf("."),L=w.substr(D),H=t.options.upload.filename(w.substr(0,D))+L;L=L.toLowerCase(),L.indexOf(".wav")===0||L.indexOf(".mp3")===0||L.indexOf(".ogg")===0?t.currentMode==="wysiwyg"?l+=`<div class="vditor-wysiwyg__block" data-type="html-block"
 data-block="0"><pre><code>&lt;audio controls="controls" src="`.concat(_,'"&gt;&lt;/audio&gt;</code></pre><pre class="vditor-wysiwyg__preview" data-render="1"><audio controls="controls" src="').concat(_,`"></audio></pre></div>
`):t.currentMode==="ir"?l+='<audio controls="controls" src="'.concat(_,`"></audio>
`):l+="[".concat(H,"](").concat(_,`)
`):L.indexOf(".apng")===0||L.indexOf(".bmp")===0||L.indexOf(".gif")===0||L.indexOf(".ico")===0||L.indexOf(".cur")===0||L.indexOf(".jpg")===0||L.indexOf(".jpeg")===0||L.indexOf(".jfif")===0||L.indexOf(".pjp")===0||L.indexOf(".pjpeg")===0||L.indexOf(".png")===0||L.indexOf(".svg")===0||L.indexOf(".webp")===0?t.currentMode==="wysiwyg"?l+='<img alt="'.concat(H,'" src="').concat(_,`">
`):l+="![".concat(H,"](").concat(_,`)
`):t.currentMode==="wysiwyg"?l+='<a href="'.concat(_,'">').concat(H,`</a>
`):l+="[".concat(H,"](").concat(_,`)
`)}),(0,N.jl)(t.upload.range),document.execCommand("insertHTML",!1,l),t.upload.range=getSelection().getRangeAt(0).cloneRange()},Pi=function(e,t,i){return vo(void 0,void 0,void 0,function(){var r,o,Y,l,w,w,_,D,L,H,F,Q,J,Y,le,ne;return bo(this,function(q){switch(q.label){case 0:for(r=[],o=e.options.upload.multiple===!0?t.length:1,Y=0;Y<o;Y++)l=t[Y],l instanceof DataTransferItem&&(l=l.getAsFile()),r.push(l);return e.options.upload.handler?[4,e.options.upload.handler(r)]:[3,2];case 1:return w=q.sent(),i&&(i.value=""),typeof w=="string"?(e.tip.show(w),[2]):[2];case 2:return!e.options.upload.url||!e.upload?(i&&(i.value=""),e.tip.show("please config: options.upload.url"),[2]):e.options.upload.file?[4,e.options.upload.file(r)]:[3,4];case 3:r=q.sent(),q.label=4;case 4:if(e.options.upload.validate&&(w=e.options.upload.validate(r),typeof w=="string"))return e.tip.show(w),[2];if(_=Cr(e),e.upload.range=(0,N.RN)(e),D=wo(e,r),D.length===0)return i&&(i.value=""),[2];for(L=new FormData,H=e.options.upload.extraData,F=0,Q=Object.keys(H);F<Q.length;F++)J=Q[F],L.append(J,H[J]);for(Y=0,le=D.length;Y<le;Y++)L.append(e.options.upload.fieldName,D[Y]);return ne=new XMLHttpRequest,ne.open("POST",e.options.upload.url),e.options.upload.token&&ne.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(ne.withCredentials=!0),Tr(e,ne),e.upload.isUploading=!0,_.setAttribute("contenteditable","false"),ne.onreadystatechange=function(){if(ne.readyState===XMLHttpRequest.DONE){if(e.upload.isUploading=!1,_.setAttribute("contenteditable","true"),ne.status>=200&&ne.status<300)if(e.options.upload.success)e.options.upload.success(_,ne.responseText);else{var he=ne.responseText;e.options.upload.format&&(he=e.options.upload.format(t,ne.responseText)),Eo(he,e)}else e.options.upload.error?e.options.upload.error(ne.responseText):e.tip.show(ne.responseText);i&&(i.value=""),e.upload.element.style.display="none"}},ne.upload.onprogress=function(he){if(he.lengthComputable){var oe=he.loaded/he.total*100;e.upload.element.style.display="block";var ge=e.upload.element;ge.style.width=oe+"%"}},ne.send(L),[2]}})})},Wn=function(e,t,i){var r,o=(0,v.pt)(t.startContainer);if(o||(o=e.wysiwyg.element),i&&i.inputType!=="formatItalic"&&i.inputType!=="deleteByDrag"&&i.inputType!=="insertFromDrop"&&i.inputType!=="formatBold"&&i.inputType!=="formatRemove"&&i.inputType!=="formatStrikeThrough"&&i.inputType!=="insertUnorderedList"&&i.inputType!=="insertOrderedList"&&i.inputType!=="formatOutdent"&&i.inputType!=="formatIndent"&&i.inputType!==""||!i){var l=Ln(t.startContainer);l&&l.remove(),e.wysiwyg.element.querySelectorAll("wbr").forEach(function(oe){oe.remove()}),t.insertNode(document.createElement("wbr")),o.querySelectorAll("[style]").forEach(function(oe){oe.removeAttribute("style")}),o.querySelectorAll(".vditor-comment").forEach(function(oe){oe.textContent.trim()===""&&(oe.classList.remove("vditor-comment","vditor-comment--focus"),oe.removeAttribute("data-cmtids"))}),(r=o.previousElementSibling)===null||r===void 0||r.querySelectorAll(".vditor-comment").forEach(function(oe){oe.textContent.trim()===""&&(oe.classList.remove("vditor-comment","vditor-comment--focus"),oe.removeAttribute("data-cmtids"))});var w="";o.getAttribute("data-type")==="link-ref-defs-block"&&(o=e.wysiwyg.element);var _=o.isEqualNode(e.wysiwyg.element),D=(0,v.Th)(o,"data-type","footnotes-block");if(_)w=o.innerHTML;else{var L=(0,v.KR)(t.startContainer);if(L&&!D){var H=(0,O.f)(t.startContainer,"BLOCKQUOTE");H?o=(0,v.pt)(t.startContainer)||o:o=L}if(D&&(o=D),w=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var F=o.previousElementSibling,Q=o.nextElementSibling;F&&(F.tagName==="UL"||F.tagName==="OL")&&(w=F.outerHTML+w,F.remove()),Q&&(Q.tagName==="UL"||Q.tagName==="OL")&&(w=w+Q.outerHTML,Q.remove()),w=w.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}o.innerText.startsWith("```")||(e.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(oe){oe&&!o.isEqualNode(oe)&&(w+=oe.outerHTML,oe.remove())}),e.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(oe){oe&&!o.isEqualNode(oe)&&(w+=oe.outerHTML,oe.remove())}))}if(w=w.replace(/<\/(strong|b)><strong data-marker="\W{2}">/g,"").replace(/<\/(em|i)><em data-marker="\W{1}">/g,"").replace(/<\/(s|strike)><s data-marker="~{1,2}">/g,""),w==='<p data-block="0">```<wbr></p>'&&e.hint.recentLanguage&&(w='<p data-block="0">```<wbr></p>'.replace("```","```"+e.hint.recentLanguage)),I("SpinVditorDOM",w,"argument",e.options.debugger),w=e.lute.SpinVditorDOM(w),I("SpinVditorDOM",w,"result",e.options.debugger),_)o.innerHTML=w;else if(o.outerHTML=w,D){var J=(0,v.Ab)(e.wysiwyg.element.querySelector("wbr"),"LI");if(J){var Y=e.wysiwyg.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(J.getAttribute("data-marker"),'"]'));Y&&Y.setAttribute("aria-label",J.textContent.trim().substr(0,24))}}var le,ne=e.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']");ne.forEach(function(oe,ge){ge===0?le=oe:(le.insertAdjacentHTML("beforeend",oe.innerHTML),oe.remove())}),ne.length>0&&e.wysiwyg.element.insertAdjacentElement("beforeend",ne[0]);var q,he=e.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']");he.forEach(function(oe,ge){ge===0?q=oe:(q.insertAdjacentHTML("beforeend",oe.innerHTML),oe.remove())}),he.length>0&&e.wysiwyg.element.insertAdjacentElement("beforeend",he[0]),(0,N.ir)(e.wysiwyg.element,t),e.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(oe){me(oe,e)}),i&&(i.inputType==="deleteContentBackward"||i.inputType==="deleteContentForward")&&e.options.comment.enable&&(e.wysiwyg.triggerRemoveComment(e),e.options.comment.adjustTop(e.wysiwyg.getComments(e,!0)))}X(e),Be(e,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},So=function(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e},Co=function(e,t,i,r){function o(l){return l instanceof i?l:new i(function(w){w(l)})}return new(i||(i=Promise))(function(l,w){function _(H){try{L(r.next(H))}catch(F){w(F)}}function D(H){try{L(r.throw(H))}catch(F){w(F)}}function L(H){H.done?l(H.value):o(H.value).then(_,D)}L((r=r.apply(e,t||[])).next())})},To=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,o,l,w;return w={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function _(L){return function(H){return D([L,H])}}function D(L){if(r)throw new TypeError("Generator is already executing.");for(;w&&(w=0,L[0]&&(i=0)),i;)try{if(r=1,o&&(l=L[0]&2?o.return:L[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,L[1])).done)return l;switch(o=0,l&&(L=[L[0]&2,l.value]),L[0]){case 0:case 1:l=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!l||L[1]>l[0]&&L[1]<l[3])){i.label=L[1];break}if(L[0]===6&&i.label<l[1]){i.label=l[1],l=L;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(L);break}l[2]&&i.ops.pop(),i.trys.pop();continue}L=t.call(e,i)}catch(H){L=[6,H],o=0}finally{r=l=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},kr=function(e,t,i){if(e.keyCode===229&&e.code===""&&e.key==="Unidentified"&&t.currentMode!=="sv"){var r=(0,v.pt)(i);if(r&&r.textContent.trim()==="")return t[t.currentMode].composingLock=!0,!1}return!0},Mr=function(e,t,i){if(!(i.key==="Enter"||i.key==="Tab"||i.key==="Backspace"||i.key.indexOf("Arrow")>-1||(0,u._0)(i)||i.key==="Escape"||i.shiftKey||i.altKey)){var r=(0,v._Y)(e.startContainer,"P")||(0,v._Y)(e.startContainer,"LI");if(r&&(0,N.ED)(r,t[t.currentMode].element,e).start===0){r.nodeValue&&(r.nodeValue=r.nodeValue.replace(/\u2006/g,""));var o=document.createTextNode(h.Y.ZWSP);e.insertNode(o),e.setStartAfter(o)}}},xr=function(e,t){if(t==="ArrowDown"||t==="ArrowUp"){var i=(0,v.Th)(e.startContainer,"data-type","math-inline")||(0,v.Th)(e.startContainer,"data-type","html-entity")||(0,v.Th)(e.startContainer,"data-type","html-inline");i&&(t==="ArrowDown"&&e.setStartAfter(i.parentElement),t==="ArrowUp"&&e.setStartBefore(i.parentElement))}},Pn=function(e,t){var i=(0,N.RN)(e),r=(0,v.pt)(i.startContainer);r&&(r.insertAdjacentHTML(t,'<p data-block="0">'.concat(h.Y.ZWSP,`<wbr>
</p>`)),(0,N.ir)(e[e.currentMode].element,i),pn(e),Me(e))},ko=function(e){var t=(0,v._Y)(e,"TABLE");return t&&t.rows[0].cells[0].isSameNode(e)?t:!1},Mo=function(e){var t=(0,v._Y)(e,"TABLE");return t&&t.lastElementChild.lastElementChild.lastElementChild.isSameNode(e)?t:!1},_r=function(e,t,i){i===void 0&&(i=!0);var r=e.previousElementSibling;return r||(e.parentElement.previousElementSibling?r=e.parentElement.previousElementSibling.lastElementChild:e.parentElement.parentElement.tagName==="TBODY"&&e.parentElement.parentElement.previousElementSibling?r=e.parentElement.parentElement.previousElementSibling.lastElementChild.lastElementChild:r=null),r&&(t.selectNodeContents(r),i||t.collapse(!1),(0,N.jl)(t)),r},Rn=function(e,t,i,r,o){var l=(0,N.ED)(r,e[e.currentMode].element,i);if(t.key==="ArrowDown"&&r.textContent.trimRight().substr(l.start).indexOf(`
`)===-1||t.key==="ArrowRight"&&l.start>=r.textContent.trimRight().length){var w=o.nextElementSibling;return!w||w&&(w.tagName==="TABLE"||w.getAttribute("data-type"))?(o.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(h.Y.ZWSP,"<wbr></p>")),(0,N.ir)(e[e.currentMode].element,i)):(i.selectNodeContents(w),i.collapse(!0),(0,N.jl)(i)),t.preventDefault(),!0}return!1},mn=function(e,t,i,r,o){var l=(0,N.ED)(r,e[e.currentMode].element,i);if(t.key==="ArrowUp"&&r.textContent.substr(0,l.start).indexOf(`
`)===-1||(t.key==="ArrowLeft"||t.key==="Backspace"&&i.toString()==="")&&l.start===0){var w=o.previousElementSibling;return!w||w&&(w.tagName==="TABLE"||w.getAttribute("data-type"))?(o.insertAdjacentHTML("beforebegin",'<p data-block="0">'.concat(h.Y.ZWSP,"<wbr></p>")),(0,N.ir)(e[e.currentMode].element,i)):(i.selectNodeContents(w),i.collapse(!1),(0,N.jl)(i)),t.preventDefault(),!0}return!1},Yn=function(e,t,i,r){r===void 0&&(r=!0);var o=(0,v._Y)(t.startContainer,"LI");if(e[e.currentMode].element.querySelectorAll("wbr").forEach(function(H){H.remove()}),t.insertNode(document.createElement("wbr")),r&&o){for(var l="",w=0;w<o.parentElement.childElementCount;w++){var _=o.parentElement.children[w].querySelector("input");_&&_.remove(),l+='<p data-block="0">'.concat(o.parentElement.children[w].innerHTML.trimLeft(),"</p>")}o.parentElement.insertAdjacentHTML("beforebegin",l),o.parentElement.remove()}else if(o)if(i==="check")o.parentElement.querySelectorAll("li").forEach(function(H){H.insertAdjacentHTML("afterbegin",'<input type="checkbox" />'.concat(H.textContent.indexOf(" ")===0?"":" ")),H.classList.add("vditor-task")});else{o.querySelector("input")&&o.parentElement.querySelectorAll("li").forEach(function(H){H.querySelector("input").remove(),H.classList.remove("vditor-task")});var L=void 0;i==="list"?(L=document.createElement("ul"),L.setAttribute("data-marker","*")):(L=document.createElement("ol"),L.setAttribute("data-marker","1.")),L.setAttribute("data-block","0"),L.setAttribute("data-tight",o.parentElement.getAttribute("data-tight")),L.innerHTML=o.parentElement.innerHTML,o.parentElement.parentNode.replaceChild(L,o.parentElement)}else{var D=(0,v.Th)(t.startContainer,"data-block","0");D||(e[e.currentMode].element.querySelector("wbr").remove(),D=e[e.currentMode].element.querySelector("p"),D.innerHTML="<wbr>"),i==="check"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li class="vditor-task"><input type="checkbox" /> '.concat(D.innerHTML,"</li></ul>")),D.remove()):i==="list"?(D.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li>'.concat(D.innerHTML,"</li></ul>")),D.remove()):i==="ordered-list"&&(D.insertAdjacentHTML("beforebegin",'<ol data-block="0"><li>'.concat(D.innerHTML,"</li></ol>")),D.remove())}},Lr=function(e,t,i){var r=t.previousElementSibling;if(t&&r){var o=[t];Array.from(i.cloneContents().children).forEach(function(D,L){D.nodeType!==3&&t&&D.textContent.trim()!==""&&t.getAttribute("data-node-id")===D.getAttribute("data-node-id")&&(L!==0&&o.push(t),t=t.nextElementSibling)}),e[e.currentMode].element.querySelectorAll("wbr").forEach(function(D){D.remove()}),i.insertNode(document.createElement("wbr"));var l=r.parentElement,w="";o.forEach(function(D){var L=D.getAttribute("data-marker");L.length!==1&&(L="1".concat(L.slice(-1))),w+='<li data-node-id="'.concat(D.getAttribute("data-node-id"),'" data-marker="').concat(L,'">').concat(D.innerHTML,"</li>"),D.remove()}),r.insertAdjacentHTML("beforeend","<".concat(l.tagName,' data-block="0">').concat(w,"</").concat(l.tagName,">")),e.currentMode==="wysiwyg"?l.outerHTML=e.lute.SpinVditorDOM(l.outerHTML):l.outerHTML=e.lute.SpinVditorIRDOM(l.outerHTML),(0,N.ir)(e[e.currentMode].element,i);var _=(0,v.KR)(i.startContainer);_&&_.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(D){me(D,e),e.currentMode==="wysiwyg"&&D.previousElementSibling.setAttribute("style","display:none")}),Me(e),pn(e)}else e[e.currentMode].element.focus()},Ri=function(e,t,i,r){var o=(0,v._Y)(t.parentElement,"LI");if(o){e[e.currentMode].element.querySelectorAll("wbr").forEach(function(F){F.remove()}),i.insertNode(document.createElement("wbr"));var l=t.parentElement,w=l.cloneNode(),_=[t];Array.from(i.cloneContents().children).forEach(function(F,Q){F.nodeType!==3&&t&&F.textContent.trim()!==""&&t.getAttribute("data-node-id")===F.getAttribute("data-node-id")&&(Q!==0&&_.push(t),t=t.nextElementSibling)});var D=!1,L="";l.querySelectorAll("li").forEach(function(F){D&&(L+=F.outerHTML,!F.nextElementSibling&&!F.previousElementSibling?F.parentElement.remove():F.remove()),F.isSameNode(_[_.length-1])&&(D=!0)}),_.reverse().forEach(function(F){o.insertAdjacentElement("afterend",F)}),L&&(w.innerHTML=L,_[0].insertAdjacentElement("beforeend",w)),e.currentMode==="wysiwyg"?r.outerHTML=e.lute.SpinVditorDOM(r.outerHTML):r.outerHTML=e.lute.SpinVditorIRDOM(r.outerHTML),(0,N.ir)(e[e.currentMode].element,i);var H=(0,v.KR)(i.startContainer);H&&H.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(F){me(F,e),e.currentMode==="wysiwyg"&&F.previousElementSibling.setAttribute("style","display:none")}),Me(e),pn(e)}else e[e.currentMode].element.focus()},Kn=function(e,t){for(var i=getSelection().getRangeAt(0).startContainer.parentElement,r=e.rows[0].cells.length,o=e.rows.length,l=0,w=0;w<o;w++)for(var _=0;_<r;_++)if(e.rows[w].cells[_].isSameNode(i)){l=_;break}for(var D=0;D<o;D++)e.rows[D].cells[l].setAttribute("align",t)},Hi=function(e){var t=e.trimRight().split(`
`).pop();return t===""?!1:(t.replace(/ |-/g,"")===""||t.replace(/ |_/g,"")===""||t.replace(/ |\*/g,"")==="")&&t.replace(/ /g,"").length>2?!(t.indexOf("-")>-1&&t.trimLeft().indexOf(" ")===-1&&e.trimRight().split(`
`).length>1||t.indexOf("    ")===0||t.indexOf("	")===0):!1},Ii=function(e){var t=e.trimRight().split(`
`);return e=t.pop(),e.indexOf("    ")===0||e.indexOf("	")===0||(e=e.trimLeft(),e===""||t.length===0)?!1:e.replace(/-/g,"")===""||e.replace(/=/g,"")===""},Me=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),e.currentMode==="wysiwyg"?Be(e,t):e.currentMode==="ir"?Pt(e,t):e.currentMode==="sv"&&Xe(e,t)},Ar=function(e,t,i,r){var o,l=e.startContainer,w=(0,v._Y)(l,"LI");if(w){if(!(0,u._0)(r)&&!r.altKey&&r.key==="Enter"&&!r.shiftKey&&i&&w.contains(i)&&i.nextElementSibling)return w&&!w.textContent.endsWith(`
`)&&w.insertAdjacentText("beforeend",`
`),e.insertNode(document.createTextNode(`

`)),e.collapse(!1),Me(t),r.preventDefault(),!0;if(!(0,u._0)(r)&&!r.shiftKey&&!r.altKey&&r.key==="Backspace"&&!w.previousElementSibling&&e.toString()===""&&(0,N.ED)(w,t[t.currentMode].element,e).start===0)return w.nextElementSibling?(w.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(w.innerHTML,"</p>")),w.remove()):w.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(w.innerHTML,"</p>"),(0,N.ir)(t[t.currentMode].element,e),Me(t),r.preventDefault(),!0;if(!(0,u._0)(r)&&!r.shiftKey&&!r.altKey&&r.key==="Backspace"&&w.textContent.trim().replace(h.Y.ZWSP,"")===""&&e.toString()===""&&((o=w.previousElementSibling)===null||o===void 0?void 0:o.tagName)==="LI")return w.previousElementSibling.insertAdjacentText("beforeend",`

`),e.selectNodeContents(w.previousElementSibling),e.collapse(!1),w.remove(),(0,N.ir)(t[t.currentMode].element,e),Me(t),r.preventDefault(),!0;if(!(0,u._0)(r)&&!r.altKey&&r.key==="Tab"){var _=!1;if((e.startOffset===0&&(l.nodeType===3&&!l.previousSibling||l.nodeType!==3&&l.nodeName==="LI")||w.classList.contains("vditor-task")&&e.startOffset===1&&l.previousSibling.nodeType!==3&&l.previousSibling.tagName==="INPUT")&&(_=!0),_||e.toString()!=="")return r.shiftKey?Ri(t,w,e,w.parentElement):Lr(t,w,e),r.preventDefault(),!0}}return!1},Ni=function(e,t,i){if(e.options.tab&&i.key==="Tab")return i.shiftKey||(t.toString()===""?(t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1)):(t.extractContents(),t.insertNode(document.createTextNode(e.options.tab)),t.collapse(!1))),(0,N.jl)(t),Me(e),i.preventDefault(),!0},Dr=function(e,t,i,r){if(i){if(!(0,u._0)(e)&&!e.altKey&&e.key==="Enter"){var o=String.raw(Vr||(Vr=So(["",""],["",""])),i.textContent).replace(/\\\|/g,"").trim(),l=o.split("|");if(o.startsWith("|")&&o.endsWith("|")&&l.length>3){var w=l.map(function(){return"---"}).join("|");return w=i.textContent+`
`+w.substring(3,w.length-3)+`
|<wbr>`,i.outerHTML=t.lute.SpinVditorDOM(w),(0,N.ir)(t[t.currentMode].element,r),Me(t),Ye(t),e.preventDefault(),!0}if(Hi(i.innerHTML)&&i.previousElementSibling){var _="",D=i.innerHTML.trimRight().split(`
`);return D.length>1&&(D.pop(),_='<p data-block="0">'.concat(D.join(`
`),"</p>")),i.insertAdjacentHTML("afterend","".concat(_,`<hr data-block="0"><p data-block="0"><wbr>
</p>`)),i.remove(),(0,N.ir)(t[t.currentMode].element,r),Me(t),Ye(t),e.preventDefault(),!0}if(Ii(i.innerHTML))return t.currentMode==="wysiwyg"?i.outerHTML=t.lute.SpinVditorDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`):i.outerHTML=t.lute.SpinVditorIRDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`),(0,N.ir)(t[t.currentMode].element,r),Me(t),Ye(t),e.preventDefault(),!0}if(r.collapsed&&i.previousElementSibling&&e.key==="Backspace"&&!(0,u._0)(e)&&!e.altKey&&!e.shiftKey&&i.textContent.trimRight().split(`
`).length>1&&(0,N.ED)(i,t[t.currentMode].element,r).start===0){var L=(0,v.Rp)(i.previousElementSibling);return L.textContent.endsWith(`
`)||(L.textContent=L.textContent+`
`),L.parentElement.insertAdjacentHTML("beforeend","<wbr>".concat(i.innerHTML)),i.remove(),(0,N.ir)(t[t.currentMode].element,r),!1}return!1}},Or=function(e,t,i){for(var r="",o=0;o<i.parentElement.childElementCount;o++)r+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');i.tagName==="TH"?i.parentElement.parentElement.insertAdjacentHTML("afterend","<tbody><tr>".concat(r,"</tr></tbody>")):i.parentElement.insertAdjacentHTML("afterend","<tr>".concat(r,"</tr>")),Me(e)},Pr=function(e,t,i){for(var r="",o=0;o<i.parentElement.childElementCount;o++)i.tagName==="TH"?r+='<th align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </th>'):r+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');if(i.tagName==="TH"){i.parentElement.parentElement.insertAdjacentHTML("beforebegin","<thead><tr>".concat(r,"</tr></thead>")),t.insertNode(document.createElement("wbr"));var l=i.parentElement.innerHTML.replace(/<th>/g,"<td>").replace(/<\/th>/g,"</td>");i.parentElement.parentElement.nextElementSibling.insertAdjacentHTML("afterbegin",l),i.parentElement.parentElement.remove(),(0,N.ir)(e.ir.element,t)}else i.parentElement.insertAdjacentHTML("beforebegin","<tr>".concat(r,"</tr>"));Me(e)},Gn=function(e,t,i,r){r===void 0&&(r="afterend");for(var o=0,l=i.previousElementSibling;l;)o++,l=l.previousElementSibling;for(var w=0;w<t.rows.length;w++)w===0?t.rows[w].cells[o].insertAdjacentHTML(r,"<th> </th>"):t.rows[w].cells[o].insertAdjacentHTML(r,"<td> </td>");Me(e)},Rr=function(e,t,i){if(i.tagName==="TD"){var r=i.parentElement.parentElement;i.parentElement.previousElementSibling?t.selectNodeContents(i.parentElement.previousElementSibling.lastElementChild):t.selectNodeContents(r.previousElementSibling.lastElementChild.lastElementChild),r.childElementCount===1?r.remove():i.parentElement.remove(),t.collapse(!1),(0,N.jl)(t),Me(e)}},Hr=function(e,t,i,r){for(var o=0,l=r.previousElementSibling;l;)o++,l=l.previousElementSibling;(r.previousElementSibling||r.nextElementSibling)&&(t.selectNodeContents(r.previousElementSibling||r.nextElementSibling),t.collapse(!0));for(var w=0;w<i.rows.length;w++){var _=i.rows[w].cells;if(_.length===1){i.remove(),pn(e);break}_[o].remove()}(0,N.jl)(t),Me(e)},Ir=function(e,t,i){var r=i.startContainer,o=(0,v._Y)(r,"TD")||(0,v._Y)(r,"TH");if(o){if(!(0,u._0)(t)&&!t.altKey&&t.key==="Enter"){(!o.lastElementChild||o.lastElementChild&&(!o.lastElementChild.isSameNode(o.lastChild)||o.lastElementChild.tagName!=="BR"))&&o.insertAdjacentHTML("beforeend","<br>");var l=document.createElement("br");return i.insertNode(l),i.setStartAfter(l),Me(e),Ye(e),t.preventDefault(),!0}if(t.key==="Tab"){if(t.shiftKey)return _r(o,i),t.preventDefault(),!0;var w=o.nextElementSibling;return w||(o.parentElement.nextElementSibling?w=o.parentElement.nextElementSibling.firstElementChild:o.parentElement.parentElement.tagName==="THEAD"&&o.parentElement.parentElement.nextElementSibling?w=o.parentElement.parentElement.nextElementSibling.firstElementChild.firstElementChild:w=null),w&&(i.selectNodeContents(w),(0,N.jl)(i)),t.preventDefault(),!0}var _=o.parentElement.parentElement.parentElement;if(t.key==="ArrowUp"){if(t.preventDefault(),o.tagName==="TH")return _.previousElementSibling?(i.selectNodeContents(_.previousElementSibling),i.collapse(!1),(0,N.jl)(i)):Pn(e,"beforebegin"),!0;for(var D=0,L=o.parentElement;D<L.cells.length&&!L.cells[D].isSameNode(o);D++);var H=L.previousElementSibling;return H||(H=L.parentElement.previousElementSibling.firstChild),i.selectNodeContents(H.cells[D]),i.collapse(!1),(0,N.jl)(i),!0}if(t.key==="ArrowDown"){t.preventDefault();var L=o.parentElement;if(!L.nextElementSibling&&o.tagName==="TD")return _.nextElementSibling?(i.selectNodeContents(_.nextElementSibling),i.collapse(!0),(0,N.jl)(i)):Pn(e,"afterend"),!0;for(var D=0;D<L.cells.length&&!L.cells[D].isSameNode(o);D++);var w=L.nextElementSibling;return w||(w=L.parentElement.nextElementSibling.firstChild),i.selectNodeContents(w.cells[D]),i.collapse(!0),(0,N.jl)(i),!0}if(e.currentMode==="wysiwyg"&&!(0,u._0)(t)&&t.key==="Enter"&&!t.shiftKey&&t.altKey){var F=e.wysiwyg.popover.querySelector(".vditor-input");return F.focus(),F.select(),t.preventDefault(),!0}if(!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Backspace"&&i.startOffset===0&&i.toString()===""){var Q=_r(o,i,!1);return!Q&&_&&(_.textContent.trim()===""?(_.outerHTML=`<p data-block="0"><wbr>
</p>`,(0,N.ir)(e[e.currentMode].element,i)):(i.setStartBefore(_),i.collapse(!0)),Me(e)),t.preventDefault(),!0}if(V("⇧⌘F",t))return Pr(e,i,o),t.preventDefault(),!0;if(V("⌘=",t))return Or(e,i,o),t.preventDefault(),!0;if(V("⇧⌘G",t))return Gn(e,_,o,"beforebegin"),t.preventDefault(),!0;if(V("⇧⌘=",t))return Gn(e,_,o),t.preventDefault(),!0;if(V("⌘-",t))return Rr(e,i,o),t.preventDefault(),!0;if(V("⇧⌘-",t))return Hr(e,i,_,o),t.preventDefault(),!0;if(V("⇧⌘L",t)){if(e.currentMode==="ir")return Kn(_,"left"),Me(e),t.preventDefault(),!0;var J=e.wysiwyg.popover.querySelector('[data-type="left"]');if(J)return J.click(),t.preventDefault(),!0}if(V("⇧⌘C",t)){if(e.currentMode==="ir")return Kn(_,"center"),Me(e),t.preventDefault(),!0;var J=e.wysiwyg.popover.querySelector('[data-type="center"]');if(J)return J.click(),t.preventDefault(),!0}if(V("⇧⌘R",t)){if(e.currentMode==="ir")return Kn(_,"right"),Me(e),t.preventDefault(),!0;var J=e.wysiwyg.popover.querySelector('[data-type="right"]');if(J)return J.click(),t.preventDefault(),!0}}return!1},Nr=function(e,t,i,r){if(i.tagName==="PRE"&&V("⌘A",t))return r.selectNodeContents(i.firstElementChild),t.preventDefault(),!0;if(e.options.tab&&t.key==="Tab"&&!t.shiftKey&&r.toString()==="")return r.insertNode(document.createTextNode(e.options.tab)),r.collapse(!1),Me(e),t.preventDefault(),!0;if(t.key==="Backspace"&&!(0,u._0)(t)&&!t.shiftKey&&!t.altKey){var o=(0,N.ED)(i,e[e.currentMode].element,r);if((o.start===0||o.start===1&&i.innerText===`
`)&&r.toString()==="")return i.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(i.firstElementChild.innerHTML,"</p>"),(0,N.ir)(e[e.currentMode].element,r),Me(e),t.preventDefault(),!0}return!(0,u._0)(t)&&!t.altKey&&t.key==="Enter"?(i.firstElementChild.textContent.endsWith(`
`)||i.firstElementChild.insertAdjacentText("beforeend",`
`),r.extractContents(),r.insertNode(document.createTextNode(`
`)),r.collapse(!1),(0,N.jl)(r),(0,u.gm)()||(e.currentMode==="wysiwyg"?Wn(e,r):De(e,r)),Ye(e),t.preventDefault(),!0):!1},jr=function(e,t,i,r){var o=t.startContainer,l=(0,v._Y)(o,"BLOCKQUOTE");if(l&&t.toString()===""){if(i.key==="Backspace"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&(0,N.ED)(l,e[e.currentMode].element,t).start===0)return t.insertNode(document.createElement("wbr")),l.outerHTML=l.innerHTML,(0,N.ir)(e[e.currentMode].element,t),Me(e),i.preventDefault(),!0;if(r&&i.key==="Enter"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&r.parentElement.tagName==="BLOCKQUOTE"){var w=!1;if(r.innerHTML.replace(h.Y.ZWSP,"")===`
`||r.innerHTML.replace(h.Y.ZWSP,"")===""?(w=!0,r.remove()):r.innerHTML.endsWith(`

`)&&(0,N.ED)(r,e[e.currentMode].element,t).start===r.textContent.length-1&&(r.innerHTML=r.innerHTML.substr(0,r.innerHTML.length-2),w=!0),w)return l.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(h.Y.ZWSP,`<wbr>
</p>`)),(0,N.ir)(e[e.currentMode].element,t),Me(e),i.preventDefault(),!0}var _=(0,v.pt)(o);if(e.currentMode==="wysiwyg"&&_&&V("⇧⌘;",i))return t.insertNode(document.createElement("wbr")),_.outerHTML='<blockquote data-block="0">'.concat(_.outerHTML,"</blockquote>"),(0,N.ir)(e.wysiwyg.element,t),Be(e),i.preventDefault(),!0;if(Rn(e,i,t,l,l)||mn(e,i,t,l,l))return!0}return!1},Br=function(e,t,i){var r=t.startContainer,o=(0,v._Y)(r,"li");if(o&&o.classList.contains("vditor-task")){if(V("⇧⌘J",i)){var l=o.firstElementChild;return l.checked?l.removeAttribute("checked"):l.setAttribute("checked","checked"),Me(e),i.preventDefault(),!0}if(i.key==="Backspace"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey&&t.toString()===""&&t.startOffset===1&&(r.nodeType===3&&r.previousSibling&&r.previousSibling.tagName==="INPUT"||r.nodeType!==3)){var w=o.previousElementSibling;if(o.querySelector("input").remove(),w){var _=(0,v.Rp)(w);_.parentElement.insertAdjacentHTML("beforeend","<wbr>"+o.innerHTML.trim()),o.remove()}else o.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(o.innerHTML.trim()||`
`,"</p>")),o.nextElementSibling?o.remove():o.parentElement.remove();return(0,N.ir)(e[e.currentMode].element,t),Me(e),i.preventDefault(),!0}if(i.key==="Enter"&&!(0,u._0)(i)&&!i.shiftKey&&!i.altKey){if(o.textContent.trim()==="")if((0,v.KJ)(o.parentElement,"vditor-task")){var D=(0,v.KR)(r);D&&Ri(e,o,t,D)}else if(o.nextElementSibling){var L="",H="",F=!1;Array.from(o.parentElement.children).forEach(function(le){o.isSameNode(le)?F=!0:F?L+=le.outerHTML:H+=le.outerHTML});var Q=o.parentElement.tagName,J=o.parentElement.tagName==="OL"?"":' data-marker="'.concat(o.parentElement.getAttribute("data-marker"),'"'),Y="";H&&(Y=o.parentElement.tagName==="UL"?"":' start="1"',H="<".concat(Q,' data-tight="true"').concat(J,' data-block="0">').concat(H,"</").concat(Q,">")),o.parentElement.outerHTML="".concat(H,`<p data-block="0"><wbr>
</p><`).concat(Q,`
 data-tight="true"`).concat(J,' data-block="0"').concat(Y,">").concat(L,"</").concat(Q,">")}else o.parentElement.insertAdjacentHTML("afterend",`<p data-block="0"><wbr>
</p>`),o.parentElement.querySelectorAll("li").length===1?o.parentElement.remove():o.remove();else r.nodeType!==3&&t.startOffset===0&&r.firstChild.tagName==="INPUT"?t.setStart(r.childNodes[1],1):(t.setEndAfter(o.lastChild),o.insertAdjacentHTML("afterend",'<li class="vditor-task" data-marker="'.concat(o.getAttribute("data-marker"),'"><input type="checkbox"> <wbr></li>')),document.querySelector("wbr").after(t.extractContents()));return(0,N.ir)(e[e.currentMode].element,t),Me(e),Ye(e),i.preventDefault(),!0}}return!1},zr=function(e,t,i,r){if(t.startContainer.nodeType!==3){var o=t.startContainer.children[t.startOffset];if(o&&o.tagName==="HR")return t.selectNodeContents(o.previousElementSibling),t.collapse(!1),i.preventDefault(),!0}if(r){var l=r.previousElementSibling;if(l&&(0,N.ED)(r,e[e.currentMode].element,t).start===0&&((0,u.gm)()&&l.tagName==="HR"||l.tagName==="TABLE")){if(l.tagName==="TABLE"){var w=l.lastElementChild.lastElementChild.lastElementChild;w.innerHTML=w.innerHTML.trimLeft()+"<wbr>"+r.textContent.trim(),r.remove()}else l.remove();return(0,N.ir)(e[e.currentMode].element,t),Me(e),i.preventDefault(),!0}}return!1},Fr=function(e){(0,u.gm)()&&e.startContainer.nodeType!==3&&e.startContainer.tagName==="HR"&&e.setStartBefore(e.startContainer)},Ur=function(e,t,i){var r,o;if(!(0,u.gm)())return!1;if(e.key==="ArrowUp"&&t&&((r=t.previousElementSibling)===null||r===void 0?void 0:r.tagName)==="TABLE"){var l=t.previousElementSibling;return i.selectNodeContents(l.rows[l.rows.length-1].lastElementChild),i.collapse(!1),e.preventDefault(),!0}return e.key==="ArrowDown"&&t&&((o=t.nextElementSibling)===null||o===void 0?void 0:o.tagName)==="TABLE"?(i.selectNodeContents(t.nextElementSibling.rows[0].cells[0]),i.collapse(!0),e.preventDefault(),!0):!1},Zn=function(e,t,i){return Co(void 0,void 0,void 0,function(){var r,o,l,w,_,D,L,H,F,Q,J,Y,le,q,ne,q,he;return To(this,function(oe){switch(oe.label){case 0:return e[e.currentMode].element.getAttribute("contenteditable")!=="true"?[2]:(t.stopPropagation(),t.preventDefault(),"clipboardData"in t?(r=t.clipboardData.getData("text/html"),o=t.clipboardData.getData("text/plain"),l=t.clipboardData.files):(r=t.dataTransfer.getData("text/html"),o=t.dataTransfer.getData("text/plain"),t.dataTransfer.types.includes("Files")&&(l=t.dataTransfer.items)),w={},_=function(ge,ze){if(!ze)return["",Lute.WalkContinue];if(e.options.upload.renderLinkDest)return e.options.upload.renderLinkDest(e,ge,ze);var He=ge.TokensStr();if(ge.__internal_object__.Parent.Type===34&&He&&He.indexOf("file://")===-1&&e.options.upload.linkToImgUrl){var Fe=new XMLHttpRequest;Fe.open("POST",e.options.upload.linkToImgUrl),e.options.upload.token&&Fe.setRequestHeader("X-Upload-Token",e.options.upload.token),e.options.upload.withCredentials&&(Fe.withCredentials=!0),Tr(e,Fe),Fe.setRequestHeader("Content-Type","application/json; charset=utf-8"),Fe.onreadystatechange=function(){if(Fe.readyState===XMLHttpRequest.DONE){if(Fe.status===200){var ct=Fe.responseText;e.options.upload.linkToImgFormat&&(ct=e.options.upload.linkToImgFormat(Fe.responseText));var it=JSON.parse(ct);if(it.code!==0){e.tip.show(it.msg);return}var ut=it.data.originalURL;if(e.currentMode==="sv")e.sv.element.querySelectorAll(".vditor-sv__marker--link").forEach(function(Ke){Ke.textContent===ut&&(Ke.textContent=it.data.url)});else{var Te=e[e.currentMode].element.querySelector('img[src="'.concat(ut,'"]'));Te.src=it.data.url,e.currentMode==="ir"&&(Te.previousElementSibling.previousElementSibling.innerHTML=it.data.url)}Me(e)}else e.tip.show(Fe.responseText);e.options.upload.linkToImgCallback&&e.options.upload.linkToImgCallback(Fe.responseText)}},Fe.send(JSON.stringify({url:He}))}return e.currentMode==="ir"?['<span class="vditor-ir__marker vditor-ir__marker--link">'.concat(Lute.EscapeHTMLStr(He),"</span>"),Lute.WalkContinue]:e.currentMode==="wysiwyg"?["",Lute.WalkContinue]:['<span class="vditor-sv__marker--link">'.concat(Lute.EscapeHTMLStr(He),"</span>"),Lute.WalkContinue]},(r.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<a href="'.concat(o,'">').concat(o,"</a>")||r.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<!--StartFragment--><a href="'.concat(o,'">').concat(o,"</a><!--EndFragment-->"))&&(r=""),D=new DOMParser().parseFromString(r,"text/html"),D.body&&(r=D.body.innerHTML),r=Lute.Sanitize(r),e.wysiwyg.getComments(e),L=e[e.currentMode].element.scrollHeight,H=We(r,o,e.currentMode),F=e.currentMode==="sv"?(0,v.Th)(t.target,"data-type","code-block"):(0,v._Y)(t.target,"CODE"),F?(e.currentMode==="sv"?document.execCommand("insertHTML",!1,o.replace(/&/g,"&amp;").replace(/</g,"&lt;")):(Q=(0,N.ED)(t.target,e[e.currentMode].element),F.parentElement.tagName!=="PRE"&&(o+=h.Y.ZWSP),F.textContent=F.textContent.substring(0,Q.start)+o+F.textContent.substring(Q.end),(0,N.Fm)(Q.start+o.length,Q.start+o.length,F.parentElement),!((he=F.parentElement)===null||he===void 0)&&he.nextElementSibling.classList.contains("vditor-".concat(e.currentMode,"__preview"))&&(F.parentElement.nextElementSibling.innerHTML=F.outerHTML,me(F.parentElement.nextElementSibling,e))),[3,8]):[3,1]);case 1:return H?(i.pasteCode(H),[3,8]):[3,2];case 2:return r.trim()===""?[3,3]:(J=document.createElement("div"),J.innerHTML=r,J.querySelectorAll("[style]").forEach(function(ge){ge.removeAttribute("style")}),J.querySelectorAll(".vditor-copy").forEach(function(ge){ge.remove()}),e.currentMode==="ir"?(w.HTML2VditorIRDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:w}),(0,N.Z2)(e.lute.HTML2VditorIRDOM(J.innerHTML),e)):e.currentMode==="wysiwyg"?(w.HTML2VditorDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:w}),(0,N.Z2)(e.lute.HTML2VditorDOM(J.innerHTML),e)):(w.Md2VditorSVDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:w}),Oi(e,e.lute.HTML2Md(J.innerHTML).trimRight())),e.outline.render(e),[3,8]);case 3:return l.length>0?e.options.upload.url||e.options.upload.handler?[4,Pi(e,l)]:[3,5]:[3,7];case 4:return oe.sent(),[3,6];case 5:Y=new FileReader,"clipboardData"in t?(l=t.clipboardData.files,le=l[0]):t.dataTransfer.types.includes("Files")&&(l=t.dataTransfer.items,le=l[0].getAsFile()),le&&le.type.startsWith("image")&&(Y.readAsDataURL(le),Y.onload=function(){var ge="";e.currentMode==="wysiwyg"?ge+='<img alt="'.concat(le.name,'" src="').concat(Y.result.toString(),`">
`):ge+="![".concat(le.name,"](").concat(Y.result.toString(),`)
`),document.execCommand("insertHTML",!1,ge)}),oe.label=6;case 6:return[3,8];case 7:o.trim()!==""&&l.length===0&&(q=(0,N.RN)(e),q.toString()!==""&&e.lute.IsValidLinkDest(o)&&(o="[".concat(q.toString(),"](").concat(o,")")),e.currentMode==="ir"?(w.Md2VditorIRDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:w}),(0,N.Z2)(e.lute.Md2VditorIRDOM(o),e)):e.currentMode==="wysiwyg"?(w.Md2VditorDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:w}),(0,N.Z2)(e.lute.Md2VditorDOM(o),e)):(w.Md2VditorSVDOM={renderLinkDest:_},e.lute.SetJSRenderers({renderers:w}),Oi(e,o)),e.outline.render(e)),oe.label=8;case 8:return e.currentMode!=="sv"&&(ne=(0,v.pt)((0,N.RN)(e).startContainer),ne&&(q=(0,N.RN)(e),e[e.currentMode].element.querySelectorAll("wbr").forEach(function(ge){ge.remove()}),q.insertNode(document.createElement("wbr")),e.currentMode==="wysiwyg"?ne.outerHTML=e.lute.SpinVditorDOM(ne.outerHTML):ne.outerHTML=e.lute.SpinVditorIRDOM(ne.outerHTML),(0,N.ir)(e[e.currentMode].element,q)),e[e.currentMode].element.querySelectorAll(".vditor-".concat(e.currentMode,"__preview[data-render='2']")).forEach(function(ge){me(ge,e)})),e.wysiwyg.triggerRemoveComment(e),Me(e),e[e.currentMode].element.scrollHeight-L>Math.min(e[e.currentMode].element.clientHeight,window.innerHeight)/2&&Ye(e),[2]}})})},Vr,$r=function(e){var t,i;e.hint.render(e);var r=(0,N.RN)(e).startContainer,o=(0,v.Th)(r,"data-type","code-block-info");if(o)if(o.textContent.replace(h.Y.ZWSP,"")===""&&e.hint.recentLanguage){o.textContent=h.Y.ZWSP+e.hint.recentLanguage;var l=(0,N.RN)(e);l.selectNodeContents(o)}else{var w=[],_=o.textContent.substring(0,(0,N.ED)(o,e.ir.element).start).replace(h.Y.ZWSP,"");(e.options.preview.hljs.langs||h.Y.ALIAS_CODE_LANGUAGES.concat(((i=(t=window.hljs)===null||t===void 0?void 0:t.listLanguages())!==null&&i!==void 0?i:[]).sort())).forEach(function(D){D.indexOf(_.toLowerCase())>-1&&w.push({html:D,value:D})}),e.hint.genHTML(w,_,e)}},Pt=function(e,t){t===void 0&&(t={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.enableHint&&$r(e),clearTimeout(e.ir.processTimeoutId),e.ir.processTimeoutId=window.setTimeout(function(){if(!e.ir.composingLock){var i=C(e);typeof e.options.input=="function"&&t.enableInput&&e.options.input(i),e.options.counter.enable&&e.counter.render(e,i),e.options.cache.enable&&(0,u.D)()&&(localStorage.setItem(e.options.cache.id,i),e.options.cache.after&&e.options.cache.after(i)),e.devtools&&e.devtools.renderEchart(e),t.enableAddUndoStack&&e.undo.addToUndoStack(e)}},e.options.undoDelay)},Hn=function(e,t){var i=(0,N.RN)(e),r=(0,v.pt)(i.startContainer)||i.startContainer;if(r){var o=r.querySelector(".vditor-ir__marker--heading");o?o.innerHTML=t:(r.insertAdjacentText("afterbegin",t),i.selectNodeContents(r),i.collapse(!1)),De(e,i.cloneRange()),un(e)}},Xn=function(e,t,i){var r=(0,v.Th)(e.startContainer,"data-type",i);if(r){r.firstElementChild.remove(),r.lastElementChild.remove(),e.insertNode(document.createElement("wbr"));var o=document.createElement("div");o.innerHTML=t.lute.SpinVditorIRDOM(r.outerHTML),r.outerHTML=o.firstElementChild.innerHTML.trim()}},xo=function(e,t,i,r){var o=(0,N.RN)(e),l=t.getAttribute("data-type"),w=o.startContainer;w.nodeType===3&&(w=w.parentElement);var _=!0;if(t.classList.contains("vditor-menu--current"))if(l==="quote"){var D=(0,v._Y)(w,"BLOCKQUOTE");D&&(o.insertNode(document.createElement("wbr")),D.outerHTML=D.innerHTML.trim()===""?'<p data-block="0">'.concat(D.innerHTML,"</p>"):D.innerHTML)}else if(l==="link"){var L=(0,v.Th)(o.startContainer,"data-type","a");if(L){var H=(0,v.KJ)(o.startContainer,"vditor-ir__link");H?(o.insertNode(document.createElement("wbr")),L.outerHTML=H.innerHTML):L.outerHTML=L.querySelector(".vditor-ir__link").innerHTML+"<wbr>"}}else l==="italic"?Xn(o,e,"em"):l==="bold"?Xn(o,e,"strong"):l==="strike"?Xn(o,e,"s"):l==="inline-code"?Xn(o,e,"code"):(l==="check"||l==="list"||l==="ordered-list")&&(Yn(e,o,l),_=!1,t.classList.remove("vditor-menu--current"));else{e.ir.element.childNodes.length===0&&(e.ir.element.innerHTML='<p data-block="0"><wbr></p>',(0,N.ir)(e.ir.element,o));var F=(0,v.pt)(o.startContainer);if(l==="line"){if(F){var Q=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;F.innerHTML.trim()===""?F.outerHTML=Q:F.insertAdjacentHTML("afterend",Q)}}else if(l==="quote")F&&(o.insertNode(document.createElement("wbr")),F.outerHTML='<blockquote data-block="0">'.concat(F.outerHTML,"</blockquote>"),_=!1,t.classList.add("vditor-menu--current"));else if(l==="link"){var J=void 0;o.toString()===""?J="".concat(i,"<wbr>").concat(r):J="".concat(i).concat(o.toString()).concat(r.replace(")","<wbr>)")),document.execCommand("insertHTML",!1,J),_=!1,t.classList.add("vditor-menu--current")}else if(l==="italic"||l==="bold"||l==="strike"||l==="inline-code"||l==="code"||l==="table"){var J=void 0;o.toString()===""?J="".concat(i,"<wbr>").concat(r):(l==="code"?J="".concat(i,`
`).concat(o.toString(),"<wbr>").concat(r):l==="table"?J="".concat(i).concat(o.toString(),"<wbr>").concat(r):J="".concat(i).concat(o.toString()).concat(r,"<wbr>"),o.deleteContents()),(l==="table"||l==="code")&&(J=`
`+J+`

`);var Y=document.createElement("span");Y.innerHTML=J,o.insertNode(Y),De(e,o),l==="table"&&(o.selectNodeContents(getSelection().getRangeAt(0).startContainer.parentElement),(0,N.jl)(o))}else(l==="check"||l==="list"||l==="ordered-list")&&(Yn(e,o,l,!1),_=!1,p(e.toolbar.elements,["check","list","ordered-list"]),t.classList.add("vditor-menu--current"))}(0,N.ir)(e.ir.element,o),Pt(e),_&&un(e)},_o=function(e,t,i,r){function o(l){return l instanceof i?l:new i(function(w){w(l)})}return new(i||(i=Promise))(function(l,w){function _(H){try{L(r.next(H))}catch(F){w(F)}}function D(H){try{L(r.throw(H))}catch(F){w(F)}}function L(H){H.done?l(H.value):o(H.value).then(_,D)}L((r=r.apply(e,t||[])).next())})},Lo=function(e,t){var i={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},r,o,l,w;return w={next:_(0),throw:_(1),return:_(2)},typeof Symbol=="function"&&(w[Symbol.iterator]=function(){return this}),w;function _(L){return function(H){return D([L,H])}}function D(L){if(r)throw new TypeError("Generator is already executing.");for(;w&&(w=0,L[0]&&(i=0)),i;)try{if(r=1,o&&(l=L[0]&2?o.return:L[0]?o.throw||((l=o.return)&&l.call(o),0):o.next)&&!(l=l.call(o,L[1])).done)return l;switch(o=0,l&&(L=[L[0]&2,l.value]),L[0]){case 0:case 1:l=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(l=i.trys,!(l=l.length>0&&l[l.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!l||L[1]>l[0]&&L[1]<l[3])){i.label=L[1];break}if(L[0]===6&&i.label<l[1]){i.label=l[1],l=L;break}if(l&&i.label<l[2]){i.label=l[2],i.ops.push(L);break}l[2]&&i.ops.pop(),i.trys.pop();continue}L=t.call(e,i)}catch(H){L=[6,H],o=0}finally{r=l=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},Ao=function(){function e(t){var i=this;this.splitChar="",this.lastIndex=-1,this.fillEmoji=function(r,o){i.element.style.display="none";var l=decodeURIComponent(r.getAttribute("data-value")),w=window.getSelection().getRangeAt(0);if(o.currentMode==="ir"){var _=(0,v.Th)(w.startContainer,"data-type","code-block-info");if(_){_.textContent=h.Y.ZWSP+l.trimRight(),w.selectNodeContents(_),w.collapse(!1),Pt(o),_.parentElement.querySelectorAll("code").forEach(function(F){F.className="language-"+l.trimRight()}),me(_.parentElement.querySelector(".vditor-ir__preview"),o),i.recentLanguage=l.trimRight();return}}if(o.currentMode==="wysiwyg"&&w.startContainer.nodeType!==3){var D=w.startContainer,L=void 0;if(D.classList.contains("vditor-input")?L=D:L=D.firstElementChild,L&&L.classList.contains("vditor-input")){L.value=l.trimRight(),w.selectNodeContents(L),w.collapse(!1),L.dispatchEvent(new CustomEvent("input",{detail:1})),i.recentLanguage=l.trimRight();return}}if(w.setStart(w.startContainer,i.lastIndex),w.deleteContents(),o.options.hint.parse?o.currentMode==="sv"?(0,N.Z2)(o.lute.SpinVditorSVDOM(l),o):o.currentMode==="wysiwyg"?(0,N.Z2)(o.lute.SpinVditorDOM(l),o):(0,N.Z2)(o.lute.SpinVditorIRDOM(l),o):(0,N.Z2)(l,o),i.splitChar===":"&&l.indexOf(":")>-1&&o.currentMode!=="sv"&&w.insertNode(document.createTextNode(" ")),w.collapse(!1),(0,N.jl)(w),o.currentMode==="wysiwyg"){var H=(0,v.KJ)(w.startContainer,"vditor-wysiwyg__block");H&&H.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(H.lastElementChild.innerHTML=H.firstElementChild.innerHTML,me(H.lastElementChild,o))}else if(o.currentMode==="ir"){var H=(0,v.KJ)(w.startContainer,"vditor-ir__marker--pre");H&&H.nextElementSibling.classList.contains("vditor-ir__preview")&&(H.nextElementSibling.innerHTML=H.innerHTML,me(H.nextElementSibling,o))}Me(o)},this.timeId=-1,this.element=document.createElement("div"),this.element.className="vditor-hint",this.recentLanguage="",t.push({key:":"})}return e.prototype.render=function(t){var i=this;if(window.getSelection().focusNode){var r,o=getSelection().getRangeAt(0);r=o.startContainer.textContent.substring(0,o.startOffset)||"";var l=this.getKey(r,t.options.hint.extend);if(typeof l>"u")this.element.style.display="none",clearTimeout(this.timeId);else if(this.splitChar===":"){var w=l===""?t.options.hint.emoji:t.lute.GetEmojis(),_=[];Object.keys(w).forEach(function(D){D.indexOf(l.toLowerCase())===0&&(w[D].indexOf(".")>-1?_.push({html:'<img src="'.concat(w[D],'" title=":').concat(D,':"/> :').concat(D,":"),value:":".concat(D,":")}):_.push({html:'<span class="vditor-hint__emoji">'.concat(w[D],"</span>").concat(D),value:w[D]}))}),this.genHTML(_,l,t)}else t.options.hint.extend.forEach(function(D){D.key===i.splitChar&&(clearTimeout(i.timeId),i.timeId=window.setTimeout(function(){return _o(i,void 0,void 0,function(){var L;return Lo(this,function(H){switch(H.label){case 0:return L=this.genHTML,[4,D.hint(l)];case 1:return L.apply(this,[H.sent(),l,t]),[2]}})})},t.options.hint.delay))})}},e.prototype.genHTML=function(t,i,r){var o=this;if(t.length===0){this.element.style.display="none";return}var l=r[r.currentMode].element,w=(0,N.Ey)(l),_=w.left+(r.options.outline.position==="left"?r.outline.element.offsetWidth:0),D=w.top,L="";t.forEach(function(F,Q){if(!(Q>7)){var J=F.html;if(i!==""){var Y=J.lastIndexOf(">")+1,le=J.substr(Y),ne=le.toLowerCase().indexOf(i.toLowerCase());ne>-1&&(le=le.substring(0,ne)+"<b>"+le.substring(ne,ne+i.length)+"</b>"+le.substring(ne+i.length),J=J.substr(0,Y)+le)}L+='<button type="button" data-value="'.concat(encodeURIComponent(F.value),` "
`).concat(Q===0?"class='vditor-hint--current'":"","> ").concat(J,"</button>")}}),this.element.innerHTML=L;var H=parseInt(document.defaultView.getComputedStyle(l,null).getPropertyValue("line-height"),10);this.element.style.top="".concat(D+(H||22),"px"),this.element.style.left="".concat(_,"px"),this.element.style.display="block",this.element.style.right="auto",this.element.querySelectorAll("button").forEach(function(F){F.addEventListener("click",function(Q){o.fillEmoji(F,r),Q.preventDefault()})}),this.element.getBoundingClientRect().bottom>window.innerHeight&&(this.element.style.top="".concat(D-this.element.offsetHeight,"px")),this.element.getBoundingClientRect().right>window.innerWidth&&(this.element.style.left="auto",this.element.style.right="0")},e.prototype.select=function(t,i){if(this.element.querySelectorAll("button").length===0||this.element.style.display==="none")return!1;var r=this.element.querySelector(".vditor-hint--current");if(t.key==="ArrowDown")return t.preventDefault(),t.stopPropagation(),r.removeAttribute("class"),r.nextElementSibling?r.nextElementSibling.className="vditor-hint--current":this.element.children[0].className="vditor-hint--current",!0;if(t.key==="ArrowUp"){if(t.preventDefault(),t.stopPropagation(),r.removeAttribute("class"),r.previousElementSibling)r.previousElementSibling.className="vditor-hint--current";else{var o=this.element.children.length;this.element.children[o-1].className="vditor-hint--current"}return!0}else if(!(0,u._0)(t)&&!t.shiftKey&&!t.altKey&&t.key==="Enter"&&!t.isComposing)return t.preventDefault(),t.stopPropagation(),this.fillEmoji(r,i),!0;return!1},e.prototype.getKey=function(t,i){var r=this;this.lastIndex=-1,this.splitChar="",i.forEach(function(L){var H=t.lastIndexOf(L.key);r.lastIndex<H&&(r.splitChar=L.key,r.lastIndex=H)});var o;if(this.lastIndex===-1)return o;var l=t.split(this.splitChar),w=l[l.length-1],_=32;if(l.length>1&&w.trim()===w)if(l.length===2&&l[0]===""&&l[1].length<_)o=l[1];else{var D=l[l.length-2].slice(-1);(0,y.p)(D)===" "&&w.length<_&&(o=w)}return o},e}(),Do=function(){function e(t){this.composingLock=!1;var i=document.createElement("div");i.className="vditor-ir",i.innerHTML='<pre class="vditor-reset" placeholder="'.concat(t.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>`),this.element=i.firstElementChild,this.bindEvent(t),ki(t,this.element),wr(t,this.element),Mi(t,this.element),Ai(t,this.element),Di(t,this.element),xi(t,this.element),_i(t,this.element,this.copy),Li(t,this.element,this.copy)}return e.prototype.copy=function(t,i){var r=getSelection().getRangeAt(0);if(r.toString()!==""){t.stopPropagation(),t.preventDefault();var o=document.createElement("div");o.appendChild(r.cloneContents()),t.clipboardData.setData("text/plain",i.lute.VditorIRDOM2Md(o.innerHTML).trim()),t.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("paste",function(r){Zn(t,r,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){x(t,["hint"])}),this.element.addEventListener("compositionstart",function(r){i.composingLock=!0}),this.element.addEventListener("compositionend",function(r){(0,u.gm)()||De(t,getSelection().getRangeAt(0).cloneRange()),i.composingLock=!1}),this.element.addEventListener("input",function(r){if(!(r.inputType==="deleteByDrag"||r.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,Pt(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}i.composingLock||r.data==="‘"||r.data==="“"||r.data==="《"||De(t,getSelection().getRangeAt(0).cloneRange(),!1,r)}}),this.element.addEventListener("click",function(r){if(r.target.tagName==="INPUT"){r.target.checked?r.target.setAttribute("checked","checked"):r.target.removeAttribute("checked"),i.preventInput=!0,Pt(t);return}var o=(0,N.RN)(t),l=(0,v.KJ)(r.target,"vditor-ir__preview");if(l||(l=(0,v.KJ)(o.startContainer,"vditor-ir__preview")),l&&(l.previousElementSibling.firstElementChild?o.selectNodeContents(l.previousElementSibling.firstElementChild):o.selectNodeContents(l.previousElementSibling),o.collapse(!0),(0,N.jl)(o),Ye(t)),r.target.tagName==="IMG"){var w=r.target.parentElement.querySelector(".vditor-ir__marker--link");w&&(o.selectNode(w),(0,N.jl)(o))}var _=(0,v.Th)(r.target,"data-type","a");if(_&&!_.classList.contains("vditor-ir__node--expand")){t.options.link.click?t.options.link.click(_.querySelector(":scope > .vditor-ir__marker--link")):t.options.link.isOpen&&window.open(_.querySelector(":scope > .vditor-ir__marker--link").textContent);return}if(r.target.isEqualNode(i.element)&&i.element.lastElementChild&&o.collapsed){var D=i.element.lastElementChild.getBoundingClientRect();r.y>D.top+D.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(h.Y.ZWSP,"")===""?(o.selectNodeContents(i.element.lastElementChild),o.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(h.Y.ZWSP,"<wbr></p>")),(0,N.ir)(i.element,o)))}o.toString()===""?z(o,t):setTimeout(function(){z((0,N.RN)(t),t)}),Z(r,t),un(t)}),this.element.addEventListener("keyup",function(r){if(!(r.isComposing||(0,u._0)(r))){if(r.key==="Enter"&&Ye(t),un(t),(r.key==="Backspace"||r.key==="Delete")&&t.ir.element.innerHTML!==""&&t.ir.element.childNodes.length===1&&t.ir.element.firstElementChild&&t.ir.element.firstElementChild.tagName==="P"&&t.ir.element.firstElementChild.childElementCount===0&&(t.ir.element.textContent===""||t.ir.element.textContent===`
`)){t.ir.element.innerHTML="";return}var o=(0,N.RN)(t);r.key==="Backspace"?((0,u.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent="",z(o,t)),i.element.querySelectorAll(".language-math").forEach(function(w){var _=w.querySelector("br");_&&_.remove()})):r.key.indexOf("Arrow")>-1?((r.key==="ArrowLeft"||r.key==="ArrowRight")&&$r(t),z(o,t)):r.keyCode===229&&r.code===""&&r.key==="Unidentified"&&z(o,t);var l=(0,v.KJ)(o.startContainer,"vditor-ir__preview");if(l){if(r.key==="ArrowUp"||r.key==="ArrowLeft")return l.previousElementSibling.firstElementChild?o.selectNodeContents(l.previousElementSibling.firstElementChild):o.selectNodeContents(l.previousElementSibling),o.collapse(!1),r.preventDefault(),!0;if(l.tagName==="SPAN"&&(r.key==="ArrowDown"||r.key==="ArrowRight"))return l.parentElement.getAttribute("data-type")==="html-entity"?(l.parentElement.insertAdjacentText("afterend",h.Y.ZWSP),o.setStart(l.parentElement.nextSibling,1)):o.selectNodeContents(l.parentElement.lastElementChild),o.collapse(!1),r.preventDefault(),!0}}})},e}(),qr=function(e){if(e.currentMode==="sv")return e.lute.Md2HTML(C(e));if(e.currentMode==="wysiwyg")return e.lute.VditorDOM2HTML(e.wysiwyg.element.innerHTML);if(e.currentMode==="ir")return e.lute.VditorIRDOM2HTML(e.ir.element.innerHTML)},Oo=c(796),Wr=c(70),Po=function(){function e(t){this.element=document.createElement("div"),this.element.className="vditor-outline",this.element.innerHTML='<div class="vditor-outline__title">'.concat(t,`</div>
<div class="vditor-outline__content"></div>`)}return e.prototype.render=function(t){var i="";return t.preview.element.style.display==="block"?i=(0,Wr.N)(t.preview.previewElement,this.element.lastElementChild,t):i=(0,Wr.N)(t[t.currentMode].element,this.element.lastElementChild,t),i},e.prototype.toggle=function(t,i,r){var o;i===void 0&&(i=!0),r===void 0&&(r=!0);var l=(o=t.toolbar.elements.outline)===null||o===void 0?void 0:o.firstElementChild;if(i&&window.innerWidth>=h.Y.MOBILE_WIDTH?(this.element.style.display="block",this.render(t),l==null||l.classList.add("vditor-menu--current")):(this.element.style.display="none",l==null||l.classList.remove("vditor-menu--current")),r&&getSelection().rangeCount>0){var w=getSelection().getRangeAt(0);t[t.currentMode].element.contains(w.startContainer)&&(0,N.jl)(w)}Ze(t)},e}(),Ro=c(0),Ho=function(){function e(t){var i=this;this.element=document.createElement("div"),this.element.className="vditor-preview",this.previewElement=document.createElement("div"),this.previewElement.className="vditor-reset",t.options.classes.preview&&this.previewElement.classList.add(t.options.classes.preview),this.previewElement.style.maxWidth=t.options.preview.maxWidth+"px",this.previewElement.addEventListener("copy",function(D){if(D.target.tagName!=="TEXTAREA"){var L=document.createElement("div");L.className="vditor-reset",L.appendChild(getSelection().getRangeAt(0).cloneContents()),i.copyToX(t,L,"default"),D.preventDefault()}}),this.previewElement.addEventListener("click",function(D){var L=(0,v._Y)(D.target,"SPAN");if(L&&(0,v.KJ)(L,"vditor-toc")){var H=i.previewElement.querySelector("#"+L.getAttribute("data-target-id"));H&&(i.element.scrollTop=H.offsetTop);return}if(D.target.tagName==="A"){t.options.link.click?t.options.link.click(D.target):t.options.link.isOpen&&window.open(D.target.getAttribute("href")),D.preventDefault();return}D.target.tagName==="IMG"&&(t.options.image.preview?t.options.image.preview(D.target):t.options.image.isPreview&&(0,K.o)(D.target,t.options.lang,t.options.theme))}),this.element.appendChild(this.previewElement);var r=t.options.preview.actions;if(r.length!==0){var o=document.createElement("div");o.className="vditor-preview__action";for(var l=[],w=0;w<r.length;w++){var _=r[w];if(typeof _=="object"){l.push('<button type="button" data-type="'.concat(_.key,'" class="').concat(_.className,'"').concat(_.tooltip?' aria-label="'.concat(_.tooltip,'"'):"",'">').concat(_.text,"</button>"));continue}switch(_){case"desktop":l.push('<button type="button" class="vditor-preview__action--current" data-type="desktop">Desktop</button>');break;case"tablet":l.push('<button type="button" data-type="tablet">Tablet</button>');break;case"mobile":l.push('<button type="button" data-type="mobile">Mobile/Wechat</button>');break;case"mp-wechat":l.push('<button type="button" data-type="mp-wechat" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到公众号"><svg><use xlink:href="#vditor-icon-mp-wechat"></use></svg></button>');break;case"zhihu":l.push('<button type="button" data-type="zhihu" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到知乎"><svg><use xlink:href="#vditor-icon-zhihu"></use></svg></button>');break}}o.innerHTML=l.join(""),o.addEventListener((0,u.y3)(),function(D){var L=(0,O.f)(D.target,"BUTTON");if(L){var H=L.getAttribute("data-type"),F=r.find(function(Q){return(Q==null?void 0:Q.key)===H});if(F){F.click(H);return}if(H==="mp-wechat"||H==="zhihu"){i.copyToX(t,i.previewElement.cloneNode(!0),H);return}H==="desktop"?i.previewElement.style.width="auto":H==="tablet"?i.previewElement.style.width="780px":i.previewElement.style.width="360px",i.previewElement.scrollWidth>i.previewElement.parentElement.clientWidth&&(i.previewElement.style.width="auto"),i.render(t),o.querySelectorAll("button").forEach(function(Q){Q.classList.remove("vditor-preview__action--current")}),L.classList.add("vditor-preview__action--current")}}),this.element.insertBefore(o,this.previewElement)}}return e.prototype.render=function(t,i){var r=this;if(clearTimeout(this.mdTimeoutId),this.element.style.display==="none"){this.element.getAttribute("data-type")==="renderPerformance"&&t.tip.hide();return}if(i){this.previewElement.innerHTML=i;return}if(C(t).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")===""){this.previewElement.innerHTML="";return}var o=new Date().getTime(),l=C(t);this.mdTimeoutId=window.setTimeout(function(){if(t.options.preview.url){var w=new XMLHttpRequest;w.open("POST",t.options.preview.url),w.setRequestHeader("Content-Type","application/json;charset=UTF-8"),w.onreadystatechange=function(){if(w.readyState===XMLHttpRequest.DONE)if(w.status===200){var D=JSON.parse(w.responseText);if(D.code!==0){t.tip.show(D.msg);return}t.options.preview.transform&&(D.data=t.options.preview.transform(D.data)),r.previewElement.innerHTML=D.data,r.afterRender(t,o)}else{var L=t.lute.Md2HTML(l);t.options.preview.transform&&(L=t.options.preview.transform(L)),r.previewElement.innerHTML=L,r.afterRender(t,o)}},w.send(JSON.stringify({markdownText:l}))}else{var _=t.lute.Md2HTML(l);t.options.preview.transform&&(_=t.options.preview.transform(_)),r.previewElement.innerHTML=_,r.afterRender(t,o)}},t.options.preview.delay)},e.prototype.afterRender=function(t,i){t.options.preview.parse&&t.options.preview.parse(this.element);var r=new Date().getTime()-i;new Date().getTime()-i>2600?(t.tip.show(window.VditorI18n.performanceTip.replace("${x}",r.toString())),t.preview.element.setAttribute("data-type","renderPerformance")):t.preview.element.getAttribute("data-type")==="renderPerformance"&&(t.tip.hide(),t.preview.element.removeAttribute("data-type"));var o=t.preview.element.querySelector(".vditor-comment--focus");o&&o.classList.remove("vditor-comment--focus"),(0,B.o)(t.preview.previewElement,t.options.preview.hljs),(0,re.$)(t.options.preview.hljs,t.preview.previewElement,t.options.cdn),(0,ve.e)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,ke.K)(t.preview.previewElement,t.options.cdn),(0,Ae.Y)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,W.D)(t.preview.previewElement,t.options.cdn),(0,G.m)(t.preview.previewElement,t.options.cdn),(0,P.v)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,be.l)(t.preview.previewElement,t.options.cdn,t.options.theme),(0,we.M)(t.preview.previewElement,t.options.cdn),(0,R.$)(t.preview.previewElement,t.options.cdn),t.options.preview.render.media.enable&&(0,Ro.l)(t.preview.previewElement),t.options.customRenders.forEach(function(_){_.render(t.preview.previewElement,t)});var l=t.preview.element,w=t.outline.render(t);w===""&&(w="[ToC]"),l.querySelectorAll('[data-type="toc-block"]').forEach(function(_){_.innerHTML=w,(0,de.T)(_,{cdn:t.options.cdn,math:t.options.preview.math})}),(0,de.T)(t.preview.previewElement,{cdn:t.options.cdn,math:t.options.preview.math})},e.prototype.copyToX=function(t,i,r){r===void 0&&(r="mp-wechat"),r!=="zhihu"?i.querySelectorAll(".katex-html .base").forEach(function(l){l.style.display="initial"}):i.querySelectorAll(".language-math").forEach(function(l){l.outerHTML='<img class="Formula-image" data-eeimg="true" src="//www.zhihu.com/equation?tex=" alt="'.concat(l.getAttribute("data-math"),'\\" style="display: block; margin: 0 auto; max-width: 100%;">')}),i.style.backgroundColor="#fff",i.querySelectorAll("code").forEach(function(l){l.style.backgroundImage="none"}),this.element.append(i);var o=i.ownerDocument.createRange();o.selectNode(i),(0,N.jl)(o),document.execCommand("copy"),i.remove(),t.tip.show(["zhihu","mp-wechat"].includes(r)?"已复制，可到".concat(r==="zhihu"?"知乎":"微信公众号平台","进行粘贴"):"已复制到剪切板")},e}(),Io=function(){function e(t){this.element=document.createElement("div"),this.element.className="vditor-resize vditor-resize--".concat(t.options.resize.position),this.element.innerHTML='<div><svg><use xlink:href="#vditor-icon-resize"></use></svg></div>',this.bindEvent(t)}return e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("mousedown",function(r){var o=document,l=r.clientY,w=t.element.offsetHeight,_=63+t.element.querySelector(".vditor-toolbar").clientHeight;o.ondragstart=function(){return!1},window.captureEvents&&window.captureEvents(),i.element.classList.add("vditor-resize--selected"),o.onmousemove=function(D){t.options.resize.position==="top"?t.element.style.height=Math.max(_,w+(l-D.clientY))+"px":t.element.style.height=Math.max(_,w+(D.clientY-l))+"px",t.options.typewriterMode&&(t.sv.element.style.paddingBottom=t.sv.element.parentElement.offsetHeight/2+"px")},o.onmouseup=function(){t.options.resize.after&&t.options.resize.after(t.element.offsetHeight-w),window.captureEvents&&window.captureEvents(),o.onmousemove=null,o.onmouseup=null,o.ondragstart=null,o.onselectstart=null,o.onselect=null,i.element.classList.remove("vditor-resize--selected")}})},e}(),No=function(){function e(t){this.composingLock=!1,this.element=document.createElement("pre"),this.element.className="vditor-sv vditor-reset",this.element.setAttribute("placeholder",t.options.placeholder),this.element.setAttribute("contenteditable","true"),this.element.setAttribute("spellcheck","false"),this.bindEvent(t),ki(t,this.element),Mi(t,this.element),Ai(t,this.element),Di(t,this.element),xi(t,this.element),_i(t,this.element,this.copy),Li(t,this.element,this.copy)}return e.prototype.copy=function(t,i){t.stopPropagation(),t.preventDefault(),t.clipboardData.setData("text/plain",On(i[i.currentMode].element))},e.prototype.bindEvent=function(t){var i=this;this.element.addEventListener("paste",function(r){Zn(t,r,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){if(t.preview.element.style.display==="block"){var r=i.element.scrollTop,o=i.element.clientHeight,l=i.element.scrollHeight-parseFloat(i.element.style.paddingBottom||"0"),w=t.preview.element;r/o>.5?w.scrollTop=(r+o)*w.scrollHeight/l-o:w.scrollTop=r*w.scrollHeight/l}}),this.element.addEventListener("compositionstart",function(r){i.composingLock=!0}),this.element.addEventListener("compositionend",function(r){(0,u.gm)()||Ce(t,r),i.composingLock=!1}),this.element.addEventListener("input",function(r){if(!(r.inputType==="deleteByDrag"||r.inputType==="insertFromDrop")&&!(i.composingLock||r.data==="‘"||r.data==="“"||r.data==="《")){if(i.preventInput){i.preventInput=!1,Xe(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}Ce(t,r)}}),this.element.addEventListener("keyup",function(r){if(!(r.isComposing||(0,u._0)(r))){if((r.key==="Backspace"||r.key==="Delete")&&t.sv.element.innerHTML!==""&&t.sv.element.childNodes.length===1&&t.sv.element.firstElementChild&&t.sv.element.firstElementChild.tagName==="DIV"&&t.sv.element.firstElementChild.childElementCount===2&&(t.sv.element.firstElementChild.textContent===""||t.sv.element.textContent===`
`)){t.sv.element.innerHTML="";return}r.key==="Enter"&&Ye(t)}})},e}(),Yr=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-tip"}return e.prototype.show=function(t,i){var r=this;i===void 0&&(i=6e3),this.element.className="vditor-tip vditor-tip--show",i===0?(this.element.innerHTML='<div class="vditor-tip__content">'.concat(t,`
<div class="vditor-tip__close">X</div></div>`),this.element.querySelector(".vditor-tip__close").addEventListener("click",function(){r.hide()})):(this.element.innerHTML='<div class="vditor-tip__content">'.concat(t,"</div>"),setTimeout(function(){r.hide()},i)),this.element.removeAttribute("style"),setTimeout(function(){var o=r.element.getBoundingClientRect();o.top<46&&(r.element.style.position="fixed",r.element.style.top="46px")},150)},e.prototype.hide=function(){this.element.className="vditor-messageElementtip",this.element.innerHTML=""},e}(),ji=function(e,t){if(t.options.preview.mode!==e){switch(t.options.preview.mode=e,e){case"both":t.sv.element.style.display="block",t.preview.element.style.display="block",t.preview.render(t),g(t.toolbar.elements,["both"]);break;case"editor":t.sv.element.style.display="block",t.preview.element.style.display="none",p(t.toolbar.elements,["both"]);break}t.devtools&&t.devtools.renderEchart(t)}},jo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Bo=function(e){jo(t,e);function t(i,r){var o=e.call(this,i,r)||this;return i.options.preview.mode==="both"&&o.element.children[0].classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,u.y3)(),function(l){var w=o.element.firstElementChild;w.classList.contains(h.Y.CLASS_MENU_DISABLED)||(l.preventDefault(),i.currentMode==="sv"&&(i.options.preview.mode==="both"?ji("editor",i):ji("both",i)))}),o}return t}(Ve),zo=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__br"}return e}(),Kr=c(13),Fo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Uo=function(e){Fo(t,e);function t(i,r){var o=e.call(this,i,r)||this,l=o.element.children[0],w=document.createElement("div");w.className="vditor-hint".concat(r.level===2?"":" vditor-panel--arrow");var _="";return h.Y.CODE_THEME.forEach(function(D){_+="<button>".concat(D,"</button>")}),w.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(_,"</div>"),w.addEventListener((0,u.y3)(),function(D){D.target.tagName==="BUTTON"&&(x(i,["subToolbar"]),i.options.preview.hljs.style=D.target.textContent,(0,Kr.h)(D.target.textContent,i.options.cdn),D.preventDefault(),D.stopPropagation())}),o.element.appendChild(w),A(i,w,l,r.level),o}return t}(Ve),Vo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),$o=function(e){Vo(t,e);function t(i,r){var o=e.call(this,i,r)||this,l=o.element.children[0],w=document.createElement("div");w.className="vditor-hint".concat(r.level===2?"":" vditor-panel--arrow");var _="";return Object.keys(i.options.preview.theme.list).forEach(function(D){_+='<button data-type="'.concat(D,'">').concat(i.options.preview.theme.list[D],"</button>")}),w.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(_,"</div>"),w.addEventListener((0,u.y3)(),function(D){D.target.tagName==="BUTTON"&&(x(i,["subToolbar"]),i.options.preview.theme.current=D.target.getAttribute("data-type"),(0,ee.H)(i.options.preview.theme.current,i.options.preview.theme.path),D.preventDefault(),D.stopPropagation())}),o.element.appendChild(w),A(i,w,l,r.level),o}return t}(Ve),qo=function(){function e(t){this.element=document.createElement("span"),this.element.className="vditor-counter vditor-tooltipped vditor-tooltipped__nw",this.render(t,"")}return e.prototype.render=function(t,i){var r=i.endsWith(`
`)?i.length-1:i.length;if(t.options.counter.type==="text"&&t[t.currentMode]){var o=t[t.currentMode].element.cloneNode(!0);o.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(l){l.remove()}),r=o.textContent.length}typeof t.options.counter.max=="number"?(r>t.options.counter.max?this.element.className="vditor-counter vditor-counter--error":this.element.className="vditor-counter",this.element.innerHTML="".concat(r,"/").concat(t.options.counter.max)):this.element.innerHTML="".concat(r),this.element.setAttribute("aria-label",t.options.counter.type),t.options.counter.after&&t.options.counter.after(r,{enable:t.options.counter.enable,max:t.options.counter.max,type:t.options.counter.type})},e}(),Wo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Yo=function(e){Wo(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o.element.children[0].innerHTML=r.icon,o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!l.currentTarget.classList.contains(h.Y.CLASS_MENU_DISABLED)&&r.click(l,i)}),o}return t}(Ve),Ko=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Go=function(e){Ko(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o.element.firstElementChild.addEventListener((0,u.y3)(),function(l){var w=o.element.firstElementChild;w.classList.contains(h.Y.CLASS_MENU_DISABLED)||(l.preventDefault(),w.classList.contains("vditor-menu--current")?(w.classList.remove("vditor-menu--current"),i.devtools.element.style.display="none",Ze(i)):(w.classList.add("vditor-menu--current"),i.devtools.element.style.display="block",Ze(i),i.devtools.renderEchart(i)))}),o}return t}(Ve),Zo=function(){function e(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__divider"}return e}(),Xo=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Jo=function(e){Xo(t,e);function t(i,r){var o=e.call(this,i,r)||this,l=document.createElement("div");l.className="vditor-panel vditor-panel--arrow";var w="";return Object.keys(i.options.hint.emoji).forEach(function(_){var D=i.options.hint.emoji[_];D.indexOf(".")>-1?w+='<button data-value=":'.concat(_,': " data-key=":').concat(_,`:"><img
data-value=":`).concat(_,': " data-key=":').concat(_,':" class="vditor-emojis__icon" src="').concat(D,'"/></button>'):w+='<button data-value="'.concat(D,` "
 data-key="`).concat(_,'"><span class="vditor-emojis__icon">').concat(D,"</span></button>")}),l.innerHTML='<div class="vditor-emojis" style="max-height: '.concat(i.options.height==="auto"?"auto":i.options.height-80,'px">').concat(w,`</div><div class="vditor-emojis__tail">
    <span class="vditor-emojis__tip"></span><span>`).concat(i.options.hint.emojiTail||"",`</span>
</div>`),o.element.appendChild(l),A(i,l,o.element.firstElementChild,r.level),o.bindEvent(i),o}return t.prototype.bindEvent=function(i){var r=this;this.element.lastElementChild.addEventListener((0,u.y3)(),function(o){var l=(0,O.f)(o.target,"BUTTON");if(l){o.preventDefault();var w=l.getAttribute("data-value"),_=(0,N.RN)(i),D=w;if(i.currentMode==="wysiwyg"?D=i.lute.SpinVditorDOM(w):i.currentMode==="ir"&&(D=i.lute.SpinVditorIRDOM(w)),w.indexOf(":")>-1&&i.currentMode!=="sv"){var L=document.createElement("div");L.innerHTML=D,D=L.firstElementChild.firstElementChild.outerHTML+" ",(0,N.Z2)(D,i)}else _.extractContents(),_.insertNode(document.createTextNode(w)),(0,v.pt)(_.startContainer)||Ft(i,_);_.collapse(!1),(0,N.jl)(_),r.element.lastElementChild.style.display="none",Me(i)}}),this.element.lastElementChild.addEventListener("mouseover",function(o){var l=(0,O.f)(o.target,"BUTTON");l&&(r.element.querySelector(".vditor-emojis__tip").innerHTML=l.getAttribute("data-key"))})},t}(Ve),Gr=function(e,t,i){var r=document.createElement("a");"download"in r?(r.download=i,r.style.display="none",r.href=URL.createObjectURL(new Blob([t])),document.body.appendChild(r),r.click(),r.remove()):e.tip.show(window.VditorI18n.downloadTip,0)},Qo=function(e){var t=C(e);Gr(e,t,t.substr(0,10)+".md")},es=function(e){e.tip.show(window.VditorI18n.generate,3800);var t=document.querySelector("#vditorExportIframe");t.contentDocument.open(),t.contentDocument.write('<link rel="stylesheet" href="'.concat(e.options.cdn,`/dist/index.css"/>
<script src="`).concat(e.options.cdn,`/dist/method.min.js"><\/script>
<div id="preview" style="width: 800px"></div>
<script>
window.addEventListener("message", (e) => {
  if(!e.data) {
    return;
  }
  Vditor.preview(document.getElementById('preview'), e.data, {
    cdn: "`).concat(e.options.cdn,`",
    markdown: {
      theme: `).concat(JSON.stringify(e.options.preview.theme),`
    },
    hljs: {
      style: "`).concat(e.options.preview.hljs.style,`"
    }
  });
  setTimeout(() => {
        window.print();
    }, 3600);
}, false);
<\/script>`)),t.contentDocument.close(),setTimeout(function(){t.contentWindow.postMessage(C(e),"*")},200)},ts=function(e){var t=qr(e),i='<html><head><link rel="stylesheet" type="text/css" href="'.concat(e.options.cdn,`/dist/index.css"/>
<script src="`).concat(e.options.cdn,"/dist/js/i18n/").concat(e.options.lang,`.js"><\/script>
<script src="`).concat(e.options.cdn,`/dist/method.min.js"><\/script></head>
<body><div class="vditor-reset" id="preview">`).concat(t,`</div>
<script>
    const previewElement = document.getElementById('preview')
    Vditor.setContentTheme('`).concat(e.options.preview.theme.current,"', '").concat(e.options.preview.theme.path,`');
    Vditor.codeRender(previewElement);
    Vditor.highlightRender(`).concat(JSON.stringify(e.options.preview.hljs),", previewElement, '").concat(e.options.cdn,`');
    Vditor.mathRender(previewElement, {
        cdn: '`).concat(e.options.cdn,`',
        math: `).concat(JSON.stringify(e.options.preview.math),`,
    });
    Vditor.mermaidRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.SMILESRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.markmapRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.flowchartRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.graphvizRender(previewElement, '`).concat(e.options.cdn,`');
    Vditor.chartRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.mindmapRender(previewElement, '`).concat(e.options.cdn,"', '").concat(e.options.theme,`');
    Vditor.abcRender(previewElement, '`).concat(e.options.cdn,`');
    `).concat(e.options.preview.render.media.enable?"Vditor.mediaRender(previewElement);":"",`
    Vditor.speechRender(previewElement);
<\/script>
<script src="`).concat(e.options.cdn,"/dist/js/icons/").concat(e.options.icon,'.js"><\/script></body></html>');Gr(e,i,t.substr(0,10)+".html")},ns=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),is=function(e){ns(t,e);function t(i,r){var o=e.call(this,i,r)||this,l=o.element.children[0],w=document.createElement("div");return w.className="vditor-hint".concat(r.level===2?"":" vditor-panel--arrow"),w.innerHTML=`<button data-type="markdown">Markdown</button>
<button data-type="pdf">PDF</button>
<button data-type="html">HTML</button>`,w.addEventListener((0,u.y3)(),function(_){var D=_.target;if(D.tagName==="BUTTON"){switch(D.getAttribute("data-type")){case"markdown":Qo(i);break;case"pdf":es(i);break;case"html":ts(i);break}x(i,["subToolbar"]),_.preventDefault(),_.stopPropagation()}}),o.element.appendChild(w),A(i,w,l,r.level),o}return t}(Ve),rs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),as=function(e){rs(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o._bindEvent(i,r),o}return t.prototype._bindEvent=function(i,r){this.element.children[0].addEventListener((0,u.y3)(),function(o){o.preventDefault(),i.element.className.includes("vditor--fullscreen")?(r.level||(this.innerHTML=r.icon),i.element.style.zIndex="",document.body.style.overflow="",i.element.classList.remove("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(l){var w=i.toolbar.elements[l].firstChild;w&&(w.className=w.className.replace("__s","__n"),i.options.toolbar.forEach(function(_){typeof _!="string"&&_.tipPosition&&_.name===w.dataset.type&&(w.className="vditor-tooltipped vditor-tooltipped__".concat(_.tipPosition))}))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__s","__n"))):(r.level||(this.innerHTML='<svg><use xlink:href="#vditor-icon-contract"></use></svg>'),i.element.style.zIndex=i.options.fullscreen.index.toString(),document.body.style.overflow="hidden",i.element.classList.add("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(l){var w=i.toolbar.elements[l].firstChild;w&&(w.className=w.className.replace("__n","__s"))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__n","__s"))),i.devtools&&i.devtools.renderEchart(i),r.click&&r.click(o,i),Ze(i),Ot(i)})},t}(Ve),os=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),ss=function(e){os(t,e);function t(i,r){var o=e.call(this,i,r)||this,l=document.createElement("div");return l.className="vditor-hint vditor-panel--arrow",l.innerHTML='<button data-tag="h1" data-value="# ">'.concat(window.VditorI18n.heading1," ").concat((0,u.fG)("&lt;⌥⌘1>"),`</button>
<button data-tag="h2" data-value="## ">`).concat(window.VditorI18n.heading2," &lt;").concat((0,u.fG)("⌥⌘2"),`></button>
<button data-tag="h3" data-value="### ">`).concat(window.VditorI18n.heading3," &lt;").concat((0,u.fG)("⌥⌘3"),`></button>
<button data-tag="h4" data-value="#### ">`).concat(window.VditorI18n.heading4," &lt;").concat((0,u.fG)("⌥⌘4"),`></button>
<button data-tag="h5" data-value="##### ">`).concat(window.VditorI18n.heading5," &lt;").concat((0,u.fG)("⌥⌘5"),`></button>
<button data-tag="h6" data-value="###### ">`).concat(window.VditorI18n.heading6," &lt;").concat((0,u.fG)("⌥⌘6"),"></button>"),o.element.appendChild(l),o._bindEvent(i,l),o}return t.prototype._bindEvent=function(i,r){var o=this.element.children[0];o.addEventListener((0,u.y3)(),function(w){w.preventDefault(),clearTimeout(i.wysiwyg.afterRenderTimeoutId),clearTimeout(i.ir.processTimeoutId),clearTimeout(i.sv.processTimeoutId),!o.classList.contains(h.Y.CLASS_MENU_DISABLED)&&(o.blur(),o.classList.contains("vditor-menu--current")?(i.currentMode==="wysiwyg"?(Ci(i),Be(i)):i.currentMode==="ir"&&Hn(i,""),o.classList.remove("vditor-menu--current")):(x(i,["subToolbar"]),r.style.display="block"))});for(var l=0;l<6;l++)r.children.item(l).addEventListener((0,u.y3)(),function(w){w.preventDefault(),i.currentMode==="wysiwyg"?(st(i,w.target.getAttribute("data-tag")),Be(i),o.classList.add("vditor-menu--current")):i.currentMode==="ir"?(Hn(i,w.target.getAttribute("data-value")),o.classList.add("vditor-menu--current")):Sr(i,w.target.getAttribute("data-value")),r.style.display="none"})},t}(Ve),ls=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),cs=function(e){ls(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),i.tip.show(`<div style="margin-bottom:14px;font-size: 14px;line-height: 22px;min-width:300px;max-width: 360px;display: flex;">
<div style="margin-top: 14px;flex: 1">
    <div>Markdown 使用指南</div>
    <ul style="list-style: none">
        <li><a href="https://ld246.com/article/1583308420519" target="_blank">语法速查手册</a></li>
        <li><a href="https://ld246.com/article/1583129520165" target="_blank">基础语法</a></li>
        <li><a href="https://ld246.com/article/1583305480675" target="_blank">扩展语法</a></li>
        <li><a href="https://ld246.com/article/1582778815353" target="_blank">键盘快捷键</a></li>
    </ul>
</div>
<div style="margin-top: 14px;flex: 1">
    <div>Vditor 支持</div>
    <ul style="list-style: none">
        <li><a href="https://github.com/Vanessa219/vditor/issues" target="_blank">Issues</a></li>
        <li><a href="https://ld246.com/tag/vditor" target="_blank">官方讨论区</a></li>
        <li><a href="https://ld246.com/article/1549638745630" target="_blank">开发手册</a></li>
        <li><a href="https://ld246.com/guide/markdown" target="_blank">演示地址</a></li>
    </ul>
</div></div>`,0)}),o}return t}(Ve),us=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),ds=function(e){us(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!(o.element.firstElementChild.classList.contains(h.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var w=(0,N.RN)(i),_=(0,v._Y)(w.startContainer,"LI");_&&Lr(i,_,w)}}),o}return t}(Ve),fs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),hs=function(e){fs(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),i.tip.show(`<div style="max-width: 520px; font-size: 14px;line-height: 22px;margin-bottom: 14px;">
<p style="text-align: center;margin: 14px 0">
    <em>下一代的 Markdown 编辑器，为未来而构建</em>
</p>
<div style="display: flex;margin-bottom: 14px;flex-wrap: wrap;align-items: center">
    <img src="https://unpkg.com/vditor/dist/images/logo.png" style="margin: 0 auto;height: 68px"/>
    <div>&nbsp;&nbsp;</div>
    <div style="flex: 1;min-width: 250px">
        Vditor 是一款浏览器端的 Markdown 编辑器，支持所见即所得、即时渲染（类似 Typora）和分屏预览模式。
        它使用 TypeScript 实现，支持原生 JavaScript 以及 Vue、React、Angular 和 Svelte 等框架。
    </div>
</div>
<div style="display: flex;flex-wrap: wrap;">
    <ul style="list-style: none;flex: 1;min-width:148px">
        <li>
        项目地址：<a href="https://b3log.org/vditor" target="_blank">b3log.org/vditor</a>
        </li>
        <li>
        开源协议：MIT
        </li>
    </ul>
    <ul style="list-style: none;margin-right: 18px">
        <li>
        组件版本：Vditor v`.concat(h.g," / Lute v").concat(Lute.Version,`
        </li>
        <li>
        赞助捐赠：<a href="https://ld246.com/sponsor" target="_blank">https://ld246.com/sponsor</a>
        </li>
    </ul>
</div>
</div>`),0)}),o}return t}(Ve),ps=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),ms=function(e){ps(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!(o.element.firstElementChild.classList.contains(h.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&Pn(i,"afterend")}),o}return t}(Ve),gs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),vs=function(e){gs(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!(o.element.firstElementChild.classList.contains(h.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&Pn(i,"beforebegin")}),o}return t}(Ve),bs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),ys=function(e){bs(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!(o.element.firstElementChild.classList.contains(h.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var w=(0,N.RN)(i),_=(0,v._Y)(w.startContainer,"LI");_&&Ri(i,_,w,_.parentElement)}}),o}return t}(Ve),ws=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Es=function(e){ws(t,e);function t(i,r){var o=e.call(this,i,r)||this;return i.options.outline&&o.element.firstElementChild.classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault();var w=i.toolbar.elements.outline.firstElementChild;w.classList.contains(h.Y.CLASS_MENU_DISABLED)||(i.options.outline.enable=!o.element.firstElementChild.classList.contains("vditor-menu--current"),i.outline.toggle(i,i.options.outline.enable))}),o}return t}(Ve),Ss=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Cs=function(e){Ss(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var r=this;this.element.children[0].addEventListener((0,u.y3)(),function(o){o.preventDefault();var l=r.element.firstElementChild;if(!l.classList.contains(h.Y.CLASS_MENU_DISABLED)){var w=h.Y.EDIT_TOOLBARS.concat(["both","edit-mode","devtools"]);l.classList.contains("vditor-menu--current")?(l.classList.remove("vditor-menu--current"),i.currentMode==="sv"?(i.sv.element.style.display="block",i.options.preview.mode==="both"?i.preview.element.style.display="block":i.preview.element.style.display="none"):(i[i.currentMode].element.parentElement.style.display="block",i.preview.element.style.display="none"),E(i.toolbar.elements,w),i.outline.render(i)):(b(i.toolbar.elements,w),i.preview.element.style.display="block",i.currentMode==="sv"?i.sv.element.style.display="none":i[i.currentMode].element.parentElement.style.display="none",i.preview.render(i),l.classList.add("vditor-menu--current"),x(i,["subToolbar","hint","popover"]),setTimeout(function(){i.outline.render(i)},i.options.preview.delay+10)),Ze(i)}})},t}(Ve),Ts=function(){function e(t){this.SAMPLE_RATE=5e3,this.isRecording=!1,this.readyFlag=!1,this.leftChannel=[],this.rightChannel=[],this.recordingLength=0;var i;if(typeof AudioContext<"u")i=new AudioContext;else if(webkitAudioContext)i=new webkitAudioContext;else return;this.DEFAULT_SAMPLE_RATE=i.sampleRate;var r=i.createGain(),o=i.createMediaStreamSource(t);o.connect(r),this.recorder=i.createScriptProcessor(2048,2,1),this.recorder.onaudioprocess=null,r.connect(this.recorder),this.recorder.connect(i.destination),this.readyFlag=!0}return e.prototype.cloneChannelData=function(t,i){this.leftChannel.push(new Float32Array(t)),this.rightChannel.push(new Float32Array(i)),this.recordingLength+=2048},e.prototype.startRecordingNewWavFile=function(){this.readyFlag&&(this.isRecording=!0,this.leftChannel.length=this.rightChannel.length=0,this.recordingLength=0)},e.prototype.stopRecording=function(){this.isRecording=!1},e.prototype.buildWavFileBlob=function(){for(var t=this.mergeBuffers(this.leftChannel),i=this.mergeBuffers(this.rightChannel),r=new Float32Array(t.length),o=0;o<t.length;++o)r[o]=.5*(t[o]+i[o]);this.DEFAULT_SAMPLE_RATE>this.SAMPLE_RATE&&(r=this.downSampleBuffer(r,this.SAMPLE_RATE));var l=44+r.length*2,w=new ArrayBuffer(l),_=new DataView(w);this.writeUTFBytes(_,0,"RIFF"),_.setUint32(4,l,!0),this.writeUTFBytes(_,8,"WAVE"),this.writeUTFBytes(_,12,"fmt "),_.setUint32(16,16,!0),_.setUint16(20,1,!0),_.setUint16(22,1,!0),_.setUint32(24,this.SAMPLE_RATE,!0),_.setUint32(28,this.SAMPLE_RATE*2,!0),_.setUint16(32,2,!0),_.setUint16(34,16,!0);var D=r.length*2;this.writeUTFBytes(_,36,"data"),_.setUint32(40,D,!0);for(var L=r.length,H=44,F=1,Q=0;Q<L;Q++)_.setInt16(H,r[Q]*(32767*F),!0),H+=2;return new Blob([_],{type:"audio/wav"})},e.prototype.downSampleBuffer=function(t,i){if(i===this.DEFAULT_SAMPLE_RATE||i>this.DEFAULT_SAMPLE_RATE)return t;for(var r=this.DEFAULT_SAMPLE_RATE/i,o=Math.round(t.length/r),l=new Float32Array(o),w=0,_=0;w<l.length;){for(var D=Math.round((w+1)*r),L=0,H=0,F=_;F<D&&F<t.length;F++)L+=t[F],H++;l[w]=L/H,w++,_=D}return l},e.prototype.mergeBuffers=function(t){for(var i=new Float32Array(this.recordingLength),r=0,o=t.length,l=0;l<o;++l){var w=t[l];i.set(w,r),r+=w.length}return i},e.prototype.writeUTFBytes=function(t,i,r){for(var o=r.length,l=0;l<o;l++)t.setUint8(i+l,r.charCodeAt(l))},e}(),ks=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Ms=function(e){ks(t,e);function t(i,r){var o=e.call(this,i,r)||this;return o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var r=this,o;this.element.children[0].addEventListener((0,u.y3)(),function(l){if(l.preventDefault(),!r.element.firstElementChild.classList.contains(h.Y.CLASS_MENU_DISABLED)){var w=i[i.currentMode].element;if(!o){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(D){o=new Ts(D),o.recorder.onaudioprocess=function(L){if(o.isRecording){var H=L.inputBuffer.getChannelData(0),F=L.inputBuffer.getChannelData(1);o.cloneChannelData(H,F)}},o.startRecordingNewWavFile(),i.tip.show(window.VditorI18n.recording),w.setAttribute("contenteditable","false"),r.element.children[0].classList.add("vditor-menu--current")}).catch(function(){i.tip.show(window.VditorI18n["record-tip"])});return}if(o.isRecording){o.stopRecording(),i.tip.hide();var _=new File([o.buildWavFileBlob()],"record".concat(new Date().getTime(),".wav"),{type:"video/webm"});Pi(i,[_]),r.element.children[0].classList.remove("vditor-menu--current")}else i.tip.show(window.VditorI18n.recording),w.setAttribute("contenteditable","false"),o.startRecordingNewWavFile(),r.element.children[0].classList.add("vditor-menu--current")}})},t}(Ve),xs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),_s=function(e){xs(t,e);function t(i,r){var o=e.call(this,i,r)||this;return b({redo:o.element},["redo"]),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!o.element.firstElementChild.classList.contains(h.Y.CLASS_MENU_DISABLED)&&i.undo.redo(i)}),o}return t}(Ve),Ls=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),As=function(e){Ls(t,e);function t(i,r){var o=e.call(this,i,r)||this;return b({undo:o.element},["undo"]),o.element.children[0].addEventListener((0,u.y3)(),function(l){l.preventDefault(),!o.element.firstElementChild.classList.contains(h.Y.CLASS_MENU_DISABLED)&&i.undo.undo(i)}),o}return t}(Ve),Ds=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),Os=function(e){Ds(t,e);function t(i,r){var o=e.call(this,i,r)||this,l='<input type="file"';return i.options.upload.multiple&&(l+=' multiple="multiple"'),i.options.upload.accept&&(l+=' accept="'.concat(i.options.upload.accept,'"')),o.element.children[0].innerHTML="".concat(r.icon||'<svg><use xlink:href="#vditor-icon-upload"></use></svg>').concat(l,">"),o._bindEvent(i),o}return t.prototype._bindEvent=function(i){var r=this;this.element.children[0].addEventListener((0,u.y3)(),function(o){if(r.element.firstElementChild.classList.contains(h.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}}),this.element.querySelector("input").addEventListener("change",function(o){if(r.element.firstElementChild.classList.contains(h.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}o.target.files.length!==0&&Pi(i,o.target.files,o.target)})},t}(Ve),Ps=function(){function e(t){var i=this,r=t.options;this.elements={},this.element=document.createElement("div"),this.element.className="vditor-toolbar",r.toolbar.forEach(function(o,l){var w=i.genItem(t,o,l);if(i.element.appendChild(w),o.toolbar){var _=document.createElement("div");_.className="vditor-hint vditor-panel--arrow",_.addEventListener((0,u.y3)(),function(D){_.style.display="none"}),o.toolbar.forEach(function(D,L){D.level=2,_.appendChild(i.genItem(t,D,l+L))}),w.appendChild(_),A(t,_,w.children[0])}}),t.options.toolbarConfig.hide&&this.element.classList.add("vditor-toolbar--hide"),t.options.toolbarConfig.pin&&this.element.classList.add("vditor-toolbar--pin"),t.options.counter.enable&&(t.counter=new qo(t),this.element.appendChild(t.counter.element))}return e.prototype.updateConfig=function(t,i){t.options.toolbarConfig=Object.assign({hide:!1,pin:!1},i),t.options.toolbarConfig.hide?this.element.classList.add("vditor-toolbar--hide"):this.element.classList.remove("vditor-toolbar--hide"),t.options.toolbarConfig.pin?this.element.classList.add("vditor-toolbar--pin"):this.element.classList.remove("vditor-toolbar--pin")},e.prototype.genItem=function(t,i,r){var o;switch(i.name){case"bold":case"italic":case"more":case"strike":case"line":case"quote":case"list":case"ordered-list":case"check":case"code":case"inline-code":case"link":case"table":o=new Ve(t,i);break;case"emoji":o=new Jo(t,i);break;case"headings":o=new ss(t,i);break;case"|":o=new Zo;break;case"br":o=new zo;break;case"undo":o=new As(t,i);break;case"redo":o=new _s(t,i);break;case"help":o=new cs(t,i);break;case"both":o=new Bo(t,i);break;case"preview":o=new Cs(t,i);break;case"fullscreen":o=new as(t,i);break;case"upload":o=new Os(t,i);break;case"record":o=new Ms(t,i);break;case"info":o=new hs(t,i);break;case"edit-mode":o=new po(t,i);break;case"devtools":o=new Go(t,i);break;case"outdent":o=new ys(t,i);break;case"indent":o=new ds(t,i);break;case"outline":o=new Es(t,i);break;case"insert-after":o=new ms(t,i);break;case"insert-before":o=new vs(t,i);break;case"code-theme":o=new Uo(t,i);break;case"content-theme":o=new $o(t,i);break;case"export":o=new is(t,i);break;default:o=new Yo(t,i);break}if(o){var l=i.name;return(l==="br"||l==="|")&&(l=l+r),this.elements[l]=o.element,o.element}},e}(),Rs=c(192),Hs=function(){function e(){this.stackSize=50,this.resetStack(),this.dmp=new Rs}return e.prototype.clearStack=function(t){this.resetStack(),this.resetIcon(t)},e.prototype.resetIcon=function(t){t.toolbar&&(this[t.currentMode].undoStack.length>1?E(t.toolbar.elements,["undo"]):b(t.toolbar.elements,["undo"]),this[t.currentMode].redoStack.length!==0?E(t.toolbar.elements,["redo"]):b(t.toolbar.elements,["redo"]))},e.prototype.undo=function(t){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"&&!(this[t.currentMode].undoStack.length<2)){var i=this[t.currentMode].undoStack.pop();i&&(this[t.currentMode].redoStack.push(i),this.renderDiff(i,t),this[t.currentMode].hasUndo=!0,x(t,["hint"]))}},e.prototype.redo=function(t){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"){var i=this[t.currentMode].redoStack.pop();i&&(this[t.currentMode].undoStack.push(i),this.renderDiff(i,t,!0))}},e.prototype.recordFirstPosition=function(t,i){if(getSelection().rangeCount!==0&&!(this[t.currentMode].undoStack.length!==1||this[t.currentMode].undoStack[0].length===0||this[t.currentMode].redoStack.length>0)&&!((0,u.gm)()&&i.key==="Backspace")&&!(0,u.nr)()){var r=this.addCaret(t);r.replace("<wbr>","").replace(" vditor-ir__node--expand","")===this[t.currentMode].undoStack[0][0].diffs[0][1].replace("<wbr>","")&&(this[t.currentMode].undoStack[0][0].diffs[0][1]=r,this[t.currentMode].lastText=r)}},e.prototype.addToUndoStack=function(t){var i=this.addCaret(t,!0),r=this.dmp.diff_main(i,this[t.currentMode].lastText,!0),o=this.dmp.patch_make(i,this[t.currentMode].lastText,r);o.length===0&&this[t.currentMode].undoStack.length>0||(this[t.currentMode].lastText=i,this[t.currentMode].undoStack.push(o),this[t.currentMode].undoStack.length>this.stackSize&&this[t.currentMode].undoStack.shift(),this[t.currentMode].hasUndo&&(this[t.currentMode].redoStack=[],this[t.currentMode].hasUndo=!1,b(t.toolbar.elements,["redo"])),this[t.currentMode].undoStack.length>1&&E(t.toolbar.elements,["undo"]))},e.prototype.renderDiff=function(t,i,r){r===void 0&&(r=!1);var o;if(r){var l=this.dmp.patch_deepCopy(t).reverse();l.forEach(function(_){_.diffs.forEach(function(D){D[0]=-D[0]})}),o=this.dmp.patch_apply(l,this[i.currentMode].lastText)[0]}else o=this.dmp.patch_apply(t,this[i.currentMode].lastText)[0];if(this[i.currentMode].lastText=o,i[i.currentMode].element.innerHTML=o,i.currentMode!=="sv"&&(i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview")).forEach(function(_){_.parentElement.querySelector(".language-echarts")&&(i.currentMode==="ir"?_.parentElement.outerHTML=i.lute.SpinVditorIRDOM(_.parentElement.outerHTML):_.parentElement.outerHTML=i.lute.SpinVditorDOM(_.parentElement.outerHTML))}),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(_){me(_,i)})),i[i.currentMode].element.querySelector("wbr"))(0,N.ir)(i[i.currentMode].element,i[i.currentMode].element.ownerDocument.createRange()),Ye(i);else{var w=getSelection().getRangeAt(0);w.setEndBefore(i[i.currentMode].element),w.collapse(!1)}X(i),Me(i,{enableAddUndoStack:!1,enableHint:!1,enableInput:!0}),pn(i),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(_){me(_,i)}),this[i.currentMode].undoStack.length>1?E(i.toolbar.elements,["undo"]):b(i.toolbar.elements,["undo"]),this[i.currentMode].redoStack.length!==0?E(i.toolbar.elements,["redo"]):b(i.toolbar.elements,["redo"])},e.prototype.resetStack=function(){this.ir={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.sv={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.wysiwyg={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]}},e.prototype.addCaret=function(t,i){i===void 0&&(i=!1);var r;if(getSelection().rangeCount!==0&&!t[t.currentMode].element.querySelector("wbr")){var o=getSelection().getRangeAt(0);if(t[t.currentMode].element.contains(o.startContainer)){r=o.cloneRange();var l=document.createElement("span");l.className="vditor-wbr",o.insertNode(l)}}var w=t[t.currentMode].element.cloneNode(!0);w.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='1']")).forEach(function(D){D.firstElementChild&&(D.firstElementChild.classList.contains("language-echarts")||D.firstElementChild.classList.contains("language-plantuml")||D.firstElementChild.classList.contains("language-mindmap")?(D.firstElementChild.removeAttribute("_echarts_instance_"),D.firstElementChild.removeAttribute("data-processed"),D.firstElementChild.innerHTML=D.previousElementSibling.firstElementChild.innerHTML,D.setAttribute("data-render","2")):D.firstElementChild.classList.contains("language-math")&&(D.setAttribute("data-render","2"),D.firstElementChild.textContent=D.firstElementChild.getAttribute("data-math"),D.firstElementChild.removeAttribute("data-math")))});var _=w.innerHTML;return t[t.currentMode].element.querySelectorAll(".vditor-wbr").forEach(function(D){D.remove()}),i&&r&&(0,N.jl)(r),_.replace('<span class="vditor-wbr"></span>',"<wbr>")},e}(),Is=c(905),Ns=function(){function e(t){this.defaultOptions={rtl:!1,after:void 0,cache:{enable:!0},cdn:h.Y.CDN,classes:{preview:""},comment:{enable:!1},counter:{enable:!1,type:"markdown"},customRenders:[],debugger:!1,fullscreen:{index:90},height:"auto",hint:{delay:200,emoji:{"+1":"👍","-1":"👎",confused:"😕",eyes:"👀️",heart:"❤️",rocket:"🚀️",smile:"😄",tada:"🎉️"},emojiPath:"".concat(h.Y.CDN,"/dist/images/emoji"),extend:[],parse:!0},icon:"ant",lang:"zh_CN",mode:"ir",outline:{enable:!1,position:"left"},placeholder:"",preview:{actions:["desktop","tablet","mobile","mp-wechat","zhihu"],delay:1e3,hljs:h.Y.HLJS_OPTIONS,markdown:h.Y.MARKDOWN_OPTIONS,math:h.Y.MATH_OPTIONS,maxWidth:800,mode:"both",theme:h.Y.THEME_OPTIONS,render:{media:{enable:!0}}},link:{isOpen:!0},image:{isPreview:!0},resize:{enable:!1,position:"bottom"},theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","fullscreen","edit-mode",{name:"more",toolbar:["both","code-theme","content-theme","export","outline","preview","devtools","info","help"]}],toolbarConfig:{hide:!1,pin:!1},typewriterMode:!1,undoDelay:800,upload:{extraData:{},fieldName:"file[]",filename:function(i){return i.replace(/\W/g,"")},linkToImgUrl:"",max:10*1024*1024,multiple:!0,url:"",withCredentials:!1},value:"",width:"auto"},this.options=t}return e.prototype.merge=function(){var t,i,r,o,l,w,_,D,L;this.options&&(this.options.toolbar?this.options.toolbar=this.mergeToolbar(this.options.toolbar):this.options.toolbar=this.mergeToolbar(this.defaultOptions.toolbar),!((i=(t=this.options.preview)===null||t===void 0?void 0:t.theme)===null||i===void 0)&&i.list&&(this.defaultOptions.preview.theme.list=this.options.preview.theme.list),!((l=(o=(r=this.options.preview)===null||r===void 0?void 0:r.render)===null||o===void 0?void 0:o.media)===null||l===void 0)&&l.enable&&(this.defaultOptions.preview.render.media.enable=this.options.preview.render.media.enable),!((w=this.options.hint)===null||w===void 0)&&w.emoji&&(this.defaultOptions.hint.emoji=this.options.hint.emoji),this.options.comment&&(this.defaultOptions.comment=this.options.comment),this.options.cdn&&(!((D=(_=this.options.preview)===null||_===void 0?void 0:_.theme)===null||D===void 0)&&D.path||(this.defaultOptions.preview.theme.path="".concat(this.options.cdn,"/dist/css/content-theme")),!((L=this.options.hint)===null||L===void 0)&&L.emojiPath||(this.defaultOptions.hint.emojiPath="".concat(this.options.cdn,"/dist/images/emoji"))));var H=(0,Is.h)(this.defaultOptions,this.options);if(H.cache.enable&&!H.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");return H},e.prototype.mergeToolbar=function(t){var i=this,r=[{icon:'<svg><use xlink:href="#vditor-icon-export"></use></svg>',name:"export",tipPosition:"ne"},{hotkey:"⌘E",icon:'<svg><use xlink:href="#vditor-icon-emoji"></use></svg>',name:"emoji",tipPosition:"ne"},{hotkey:"⌘H",icon:'<svg><use xlink:href="#vditor-icon-headings"></use></svg>',name:"headings",tipPosition:"ne"},{hotkey:"⌘B",icon:'<svg><use xlink:href="#vditor-icon-bold"></use></svg>',name:"bold",prefix:"**",suffix:"**",tipPosition:"ne"},{hotkey:"⌘I",icon:'<svg><use xlink:href="#vditor-icon-italic"></use></svg>',name:"italic",prefix:"*",suffix:"*",tipPosition:"ne"},{hotkey:"⌘D",icon:'<svg><use xlink:href="#vditor-icon-strike"></use></svg>',name:"strike",prefix:"~~",suffix:"~~",tipPosition:"ne"},{hotkey:"⌘K",icon:'<svg><use xlink:href="#vditor-icon-link"></use></svg>',name:"link",prefix:"[",suffix:"](https://)",tipPosition:"n"},{name:"|"},{hotkey:"⌘L",icon:'<svg><use xlink:href="#vditor-icon-list"></use></svg>',name:"list",prefix:"* ",tipPosition:"n"},{hotkey:"⌘O",icon:'<svg><use xlink:href="#vditor-icon-ordered-list"></use></svg>',name:"ordered-list",prefix:"1. ",tipPosition:"n"},{hotkey:"⌘J",icon:'<svg><use xlink:href="#vditor-icon-check"></use></svg>',name:"check",prefix:"* [ ] ",tipPosition:"n"},{hotkey:"⇧⌘I",icon:'<svg><use xlink:href="#vditor-icon-outdent"></use></svg>',name:"outdent",tipPosition:"n"},{hotkey:"⇧⌘O",icon:'<svg><use xlink:href="#vditor-icon-indent"></use></svg>',name:"indent",tipPosition:"n"},{name:"|"},{hotkey:"⌘;",icon:'<svg><use xlink:href="#vditor-icon-quote"></use></svg>',name:"quote",prefix:"> ",tipPosition:"n"},{hotkey:"⇧⌘H",icon:'<svg><use xlink:href="#vditor-icon-line"></use></svg>',name:"line",prefix:"---",tipPosition:"n"},{hotkey:"⌘U",icon:'<svg><use xlink:href="#vditor-icon-code"></use></svg>',name:"code",prefix:"```",suffix:"\n```",tipPosition:"n"},{hotkey:"⌘G",icon:'<svg><use xlink:href="#vditor-icon-inline-code"></use></svg>',name:"inline-code",prefix:"`",suffix:"`",tipPosition:"n"},{hotkey:"⇧⌘B",icon:'<svg><use xlink:href="#vditor-icon-before"></use></svg>',name:"insert-before",tipPosition:"n"},{hotkey:"⇧⌘E",icon:'<svg><use xlink:href="#vditor-icon-after"></use></svg>',name:"insert-after",tipPosition:"n"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-upload"></use></svg>',name:"upload",tipPosition:"n"},{icon:'<svg><use xlink:href="#vditor-icon-record"></use></svg>',name:"record",tipPosition:"n"},{hotkey:"⌘M",icon:'<svg><use xlink:href="#vditor-icon-table"></use></svg>',name:"table",prefix:"| col1",suffix:` | col2 | col3 |
| --- | --- | --- |
|  |  |  |
|  |  |  |`,tipPosition:"n"},{name:"|"},{hotkey:"⌘Z",icon:'<svg><use xlink:href="#vditor-icon-undo"></use></svg>',name:"undo",tipPosition:"nw"},{hotkey:"⌘Y",icon:'<svg><use xlink:href="#vditor-icon-redo"></use></svg>',name:"redo",tipPosition:"nw"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-more"></use></svg>',name:"more",tipPosition:"e"},{hotkey:"⌘'",icon:'<svg><use xlink:href="#vditor-icon-fullscreen"></use></svg>',name:"fullscreen",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-edit"></use></svg>',name:"edit-mode",tipPosition:"nw"},{hotkey:"⌘P",icon:'<svg><use xlink:href="#vditor-icon-both"></use></svg>',name:"both",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-preview"></use></svg>',name:"preview",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',name:"outline",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-theme"></use></svg>',name:"content-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-code-theme"></use></svg>',name:"code-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-bug"></use></svg>',name:"devtools",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-info"></use></svg>',name:"info",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-help"></use></svg>',name:"help",tipPosition:"nw"},{name:"br"}],o=[];return t.forEach(function(l){var w=l;r.forEach(function(_){typeof l=="string"&&_.name===l&&(w=_),typeof l=="object"&&_.name===l.name&&(w=Object.assign({},_,l))}),l.toolbar&&(w.toolbar=i.mergeToolbar(l.toolbar)),o.push(w)}),o},e}(),js=function(){function e(t){var i=this;this.composingLock=!1,this.commentIds=[];var r=document.createElement("div");r.className="vditor-wysiwyg",r.innerHTML='<pre class="vditor-reset" placeholder="'.concat(t.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>
<div class="vditor-panel vditor-panel--none"></div>
<div class="vditor-panel vditor-panel--none">
    <button type="button" aria-label="`).concat(window.VditorI18n.comment,`" class="vditor-icon vditor-tooltipped vditor-tooltipped__n">
        <svg><use xlink:href="#vditor-icon-comment"></use></svg>
    </button>
</div>`),this.element=r.firstElementChild,this.popover=r.firstElementChild.nextElementSibling,this.selectPopover=r.lastElementChild,this.bindEvent(t),ki(t,this.element),wr(t,this.element),Mi(t,this.element),Ai(t,this.element),Di(t,this.element),xi(t,this.element),_i(t,this.element,this.copy),Li(t,this.element,this.copy),t.options.comment.enable&&(this.selectPopover.querySelector("button").onclick=function(){var o=Lute.NewNodeID(),l=getSelection().getRangeAt(0),w=l.cloneRange(),_=l.extractContents(),D,L,H=!1,F=!1;_.childNodes.forEach(function(Y,le){var ne=!1;if(Y.nodeType===3?ne=!0:Y.classList.contains("vditor-comment")?Y.classList.contains("vditor-comment")&&Y.setAttribute("data-cmtids",Y.getAttribute("data-cmtids")+" "+o):ne=!0,ne)if(Y.nodeType!==3&&Y.getAttribute("data-block")==="0"&&le===0&&w.startOffset>0)Y.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(Y.innerHTML,"</span>"),D=Y;else if(Y.nodeType!==3&&Y.getAttribute("data-block")==="0"&&le===_.childNodes.length-1&&w.endOffset<w.endContainer.textContent.length)Y.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(Y.innerHTML,"</span>"),L=Y;else if(Y.nodeType!==3&&Y.getAttribute("data-block")==="0")le===0?H=!0:le===_.childNodes.length-1&&(F=!0),Y.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(Y.innerHTML,"</span>");else{var q=document.createElement("span");q.classList.add("vditor-comment"),q.setAttribute("data-cmtids",o),Y.parentNode.insertBefore(q,Y),q.appendChild(Y)}});var Q=(0,v.pt)(w.startContainer);Q&&(D?(Q.insertAdjacentHTML("beforeend",D.innerHTML),D.remove()):Q.textContent.trim().replace(h.Y.ZWSP,"")===""&&H&&Q.remove());var J=(0,v.pt)(w.endContainer);J&&(L?(J.insertAdjacentHTML("afterbegin",L.innerHTML),L.remove()):J.textContent.trim().replace(h.Y.ZWSP,"")===""&&F&&J.remove()),l.insertNode(_),t.options.comment.add(o,l.toString(),i.getComments(t,!0)),Be(t,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),i.hideComment()})}return e.prototype.getComments=function(t,i){var r=this;if(i===void 0&&(i=!1),t.currentMode==="wysiwyg"&&t.options.comment.enable){this.commentIds=[],this.element.querySelectorAll(".vditor-comment").forEach(function(l){r.commentIds=r.commentIds.concat(l.getAttribute("data-cmtids").split(" "))}),this.commentIds=Array.from(new Set(this.commentIds));var o=[];if(i)return this.commentIds.forEach(function(l){o.push({id:l,top:r.element.querySelector('.vditor-comment[data-cmtids="'.concat(l,'"]')).offsetTop})}),o}else return[]},e.prototype.triggerRemoveComment=function(t){var i=function(l,w){var _=new Set(w);return l.filter(function(D){return!_.has(D)})};if(t.currentMode==="wysiwyg"&&t.options.comment.enable&&t.wysiwyg.commentIds.length>0){var r=JSON.parse(JSON.stringify(this.commentIds));this.getComments(t);var o=i(r,this.commentIds);o.length>0&&t.options.comment.remove(o)}},e.prototype.showComment=function(){var t=(0,N.Ey)(this.element);this.selectPopover.setAttribute("style","left:".concat(t.left,"px;display:block;top:").concat(Math.max(-8,t.top-21),"px"))},e.prototype.hideComment=function(){this.selectPopover.setAttribute("style","display:none")},e.prototype.unbindListener=function(){window.removeEventListener("scroll",this.scrollListener)},e.prototype.copy=function(t,i){var r=getSelection().getRangeAt(0);if(r.toString()!==""){t.stopPropagation(),t.preventDefault();var o=(0,v._Y)(r.startContainer,"CODE"),l=(0,v._Y)(r.endContainer,"CODE");if(o&&l&&l.isSameNode(o)){var w="";o.parentElement.tagName==="PRE"?w=r.toString():w="`"+r.toString()+"`",t.clipboardData.setData("text/plain",w),t.clipboardData.setData("text/html","");return}var _=(0,v._Y)(r.startContainer,"A"),D=(0,v._Y)(r.endContainer,"A");if(_&&D&&D.isSameNode(_)){var L=_.getAttribute("title")||"";L&&(L=' "'.concat(L,'"')),t.clipboardData.setData("text/plain","[".concat(r.toString(),"](").concat(_.getAttribute("href")).concat(L,")")),t.clipboardData.setData("text/html","");return}var H=document.createElement("div");H.appendChild(r.cloneContents()),t.clipboardData.setData("text/plain",i.lute.VditorDOM2Md(H.innerHTML).trim()),t.clipboardData.setData("text/html","")}},e.prototype.bindEvent=function(t){var i=this;this.unbindListener(),window.addEventListener("scroll",this.scrollListener=function(){if(x(t,["hint"]),!(i.popover.style.display!=="block"||i.selectPopover.style.display!=="block")){var r=parseInt(i.popover.getAttribute("data-top"),10);if(t.options.height!=="auto"){if(t.options.toolbarConfig.pin&&t.toolbar.element.getBoundingClientRect().top===0){var o=Math.max(window.scrollY-t.element.offsetTop-8,Math.min(r-t.wysiwyg.element.scrollTop,i.element.clientHeight-21))+"px";i.popover.style.display==="block"&&(i.popover.style.top=o),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=o)}return}else if(!t.options.toolbarConfig.pin)return;var l=Math.max(r,window.scrollY-t.element.offsetTop-8)+"px";i.popover.style.display==="block"&&(i.popover.style.top=l),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=l)}}),this.element.addEventListener("scroll",function(){if(x(t,["hint"]),t.options.comment&&t.options.comment.enable&&t.options.comment.scroll&&t.options.comment.scroll(t.wysiwyg.element.scrollTop),i.popover.style.display==="block"){var r=parseInt(i.popover.getAttribute("data-top"),10)-t.wysiwyg.element.scrollTop,o=-8;t.options.toolbarConfig.pin&&t.toolbar.element.getBoundingClientRect().top===0&&(o=window.scrollY-t.element.offsetTop+o);var l=Math.max(o,Math.min(r,i.element.clientHeight-21))+"px";i.popover.style.top=l,i.selectPopover.style.top=l}}),this.element.addEventListener("paste",function(r){Zn(t,r,{pasteCode:function(o){var l=(0,N.RN)(t),w=document.createElement("template");w.innerHTML=o,l.insertNode(w.content.cloneNode(!0));var _=(0,v.Th)(l.startContainer,"data-block","0");_?_.outerHTML=t.lute.SpinVditorDOM(_.outerHTML):t.wysiwyg.element.innerHTML=t.lute.SpinVditorDOM(t.wysiwyg.element.innerHTML),(0,N.ir)(t.wysiwyg.element,l)}})}),this.element.addEventListener("compositionstart",function(){i.composingLock=!0}),this.element.addEventListener("compositionend",function(r){var o=(0,O.c)(getSelection().getRangeAt(0).startContainer);if(o&&o.textContent===""){X(t);return}(0,u.gm)()||Wn(t,getSelection().getRangeAt(0).cloneRange(),r),i.composingLock=!1}),this.element.addEventListener("input",function(r){if(!(r.inputType==="deleteByDrag"||r.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,Be(t);return}if(i.composingLock||r.data==="‘"||r.data==="“"||r.data==="《"){Be(t);return}var o=getSelection().getRangeAt(0),l=(0,v.pt)(o.startContainer);if(l||(Ft(t,o),l=(0,v.pt)(o.startContainer)),!!l){for(var w=(0,N.ED)(l,t.wysiwyg.element,o).start,_=!0,D=w-1;D>l.textContent.substr(0,w).lastIndexOf(`
`);D--)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!=="	"){_=!1;break}w===0&&(_=!1);for(var L=!0,D=w-1;D<l.textContent.length;D++)if(l.textContent.charAt(D)!==" "&&l.textContent.charAt(D)!==`
`){L=!1;break}L&&/^#{1,6} $/.test(l.textContent)&&(L=!1);var H=(0,O.c)(getSelection().getRangeAt(0).startContainer);if(H&&H.textContent===""&&(X(t),H.remove()),_&&l.getAttribute("data-type")!=="code-block"||L||Ii(l.innerHTML)||Hi(l.innerHTML)&&l.previousElementSibling){typeof t.options.input=="function"&&t.options.input(C(t));return}r.inputType==="insertParagraph"&&i.element.innerHTML==="<p><br></p><p><br></p>"&&l.previousElementSibling.remove(),Wn(t,o,r)}}}),this.element.addEventListener("click",function(r){if(r.target.tagName==="INPUT"){var o=r.target;o.checked?o.setAttribute("checked","checked"):o.removeAttribute("checked"),i.preventInput=!0,getSelection().rangeCount>0&&(0,N.jl)(getSelection().getRangeAt(0)),Be(t);return}if(r.target.tagName==="IMG"&&!r.target.parentElement.classList.contains("vditor-wysiwyg__preview")){r.target.getAttribute("data-type")==="link-ref"?br(t,r.target):co(r,t);return}var l=(0,v._Y)(r.target,"A");if(l){t.options.link.click?t.options.link.click(l):t.options.link.isOpen&&window.open(l.getAttribute("href")),r.preventDefault();return}var w=(0,N.RN)(t);if(r.target.isEqualNode(i.element)&&i.element.lastElementChild&&w.collapsed){var _=i.element.lastElementChild.getBoundingClientRect();r.y>_.top+_.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(h.Y.ZWSP,"")===""?(w.selectNodeContents(i.element.lastElementChild),w.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(h.Y.ZWSP,"<wbr></p>")),(0,N.ir)(i.element,w)))}Yt(t);var D=(0,v.KJ)(r.target,"vditor-wysiwyg__preview");D||(D=(0,v.KJ)((0,N.RN)(t).startContainer,"vditor-wysiwyg__preview")),D&&An(D,t),Z(r,t)}),this.element.addEventListener("keyup",function(r){if(!(r.isComposing||(0,u._0)(r))){r.key==="Enter"&&Ye(t),(r.key==="Backspace"||r.key==="Delete")&&t.wysiwyg.element.innerHTML!==""&&t.wysiwyg.element.childNodes.length===1&&t.wysiwyg.element.firstElementChild&&t.wysiwyg.element.firstElementChild.tagName==="P"&&t.wysiwyg.element.firstElementChild.childElementCount===0&&(t.wysiwyg.element.textContent===""||t.wysiwyg.element.textContent===`
`)&&(t.wysiwyg.element.innerHTML="");var o=(0,N.RN)(t);if(r.key==="Backspace"&&(0,u.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent=""),Ft(t,o),Yt(t),!(r.key!=="ArrowDown"&&r.key!=="ArrowRight"&&r.key!=="Backspace"&&r.key!=="ArrowLeft"&&r.key!=="ArrowUp")){(r.key==="ArrowLeft"||r.key==="ArrowRight")&&t.hint.render(t);var l=(0,v.KJ)(o.startContainer,"vditor-wysiwyg__preview");if(!l&&o.startContainer.nodeType!==3&&o.startOffset>0){var w=o.startContainer;w.classList.contains("vditor-wysiwyg__block")&&(l=w.lastElementChild)}if(l){var _=l.previousElementSibling;if(_.style.display==="none"){r.key==="ArrowDown"||r.key==="ArrowRight"?An(l,t):An(l,t,!1);return}var D=l.previousElementSibling;if(D.tagName==="PRE"&&(D=D.firstElementChild),r.key==="ArrowDown"||r.key==="ArrowRight"){var w=l.parentElement,L=Ue(w);if(L&&L.nodeType!==3){var H=L.querySelector(".vditor-wysiwyg__preview");if(H){An(H,t);return}}if(L.nodeType===3){for(;L.textContent.length===0&&L.nextSibling;)L=L.nextSibling;o.setStart(L,1)}else o.setStart(L.firstChild,0)}else o.selectNodeContents(D),o.collapse(!1)}}}})},e}(),Bs=function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,o){r.__proto__=o}||function(r,o){for(var l in o)Object.prototype.hasOwnProperty.call(o,l)&&(r[l]=o[l])},e(t,i)};return function(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");e(t,i);function r(){this.constructor=t}t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),zs=function(e){Bs(t,e);function t(i,r){var o=e.call(this)||this;if(o.version=h.g,typeof i=="string"){if(r?r.cache?r.cache.id||(r.cache.id="vditor".concat(i)):r.cache={id:"vditor".concat(i)}:r={cache:{id:"vditor".concat(i)}},!document.getElementById(i))return o.showErrorTip("Failed to get element by id: ".concat(i)),o;i=document.getElementById(i)}var l=new Ns(r),w=l.merge();if(w.i18n)window.VditorI18n=w.i18n,o.init(i,w);else if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(w.lang)){var _="vditorI18nScript",D=_+w.lang;document.querySelectorAll('head script[id^="'.concat(_,'"]')).forEach(function(L){L.id!==D&&document.head.removeChild(L)}),(0,S.Z)("".concat(w.cdn,"/dist/js/i18n/").concat(w.lang,".js"),D).then(function(){o.init(i,w)}).catch(function(L){o.showErrorTip("GET ".concat(w.cdn,"/dist/js/i18n/").concat(w.lang,".js net::ERR_ABORTED 404 (Not Found)"))})}else throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");return o}return t.prototype.showErrorTip=function(i){var r=new Yr;document.body.appendChild(r.element),r.show(i,0)},t.prototype.updateToolbarConfig=function(i){this.vditor.toolbar.updateConfig(this.vditor,i)},t.prototype.setTheme=function(i,r,o,l){this.vditor.options.theme=i,Oe(this.vditor),r&&(this.vditor.options.preview.theme.current=r,(0,ee.H)(r,l||this.vditor.options.preview.theme.path)),o&&(this.vditor.options.preview.hljs.style=o,(0,Kr.h)(o,this.vditor.options.cdn))},t.prototype.getValue=function(){return C(this.vditor)},t.prototype.getCurrentMode=function(){return this.vditor.currentMode},t.prototype.focus=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.focus():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.focus():this.vditor.currentMode==="ir"&&this.vditor.ir.element.focus()},t.prototype.blur=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.blur():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.blur():this.vditor.currentMode==="ir"&&this.vditor.ir.element.blur()},t.prototype.disabled=function(){x(this.vditor,["subToolbar","hint","popover"]),b(this.vditor.toolbar.elements,h.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","false")},t.prototype.enable=function(){E(this.vditor.toolbar.elements,h.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor.undo.resetIcon(this.vditor),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","true")},t.prototype.getSelection=function(){if(this.vditor.currentMode==="wysiwyg")return On(this.vditor.wysiwyg.element);if(this.vditor.currentMode==="sv")return On(this.vditor.sv.element);if(this.vditor.currentMode==="ir")return On(this.vditor.ir.element)},t.prototype.renderPreview=function(i){this.vditor.preview.render(this.vditor,i)},t.prototype.getCursorPosition=function(){return(0,N.Ey)(this.vditor[this.vditor.currentMode].element)},t.prototype.isUploading=function(){return this.vditor.upload.isUploading},t.prototype.clearCache=function(){this.vditor.options.cache.enable&&(0,u.D)()&&localStorage.removeItem(this.vditor.options.cache.id)},t.prototype.disabledCache=function(){this.vditor.options.cache.enable=!1},t.prototype.enableCache=function(){if(!this.vditor.options.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");this.vditor.options.cache.enable=!0},t.prototype.html2md=function(i){return this.vditor.lute.HTML2Md(i)},t.prototype.exportJSON=function(i){return this.vditor.lute.RenderJSON(i)},t.prototype.getHTML=function(){return qr(this.vditor)},t.prototype.tip=function(i,r){this.vditor.tip.show(i,r)},t.prototype.setPreviewMode=function(i){ji(i,this.vditor)},t.prototype.deleteValue=function(){window.getSelection().isCollapsed||document.execCommand("delete",!1)},t.prototype.updateValue=function(i){document.execCommand("insertHTML",!1,i)},t.prototype.insertValue=function(i,r){r===void 0&&(r=!0);var o=(0,N.RN)(this.vditor);o.collapse(!0);var l=document.createElement("template");l.innerHTML=i,o.insertNode(l.content.cloneNode(!0)),o.collapse(!1),this.vditor.currentMode==="sv"?(this.vditor.sv.preventInput=!0,r&&Ce(this.vditor)):this.vditor.currentMode==="wysiwyg"?r&&Wn(this.vditor,getSelection().getRangeAt(0)):this.vditor.currentMode==="ir"&&(this.vditor.ir.preventInput=!0,r&&De(this.vditor,getSelection().getRangeAt(0),!0))},t.prototype.insertMD=function(i){this.vditor.currentMode==="ir"?(0,N.Z2)(this.vditor.lute.Md2VditorIRDOM(i),this.vditor):this.vditor.currentMode==="wysiwyg"?(0,N.Z2)(this.vditor.lute.Md2VditorDOM(i),this.vditor):Oi(this.vditor,i),this.vditor.outline.render(this.vditor),Me(this.vditor)},t.prototype.setValue=function(i,r){var o=this;r===void 0&&(r=!1),this.vditor.currentMode==="sv"?(this.vditor.sv.element.innerHTML="<div data-block='0'>".concat(this.vditor.lute.SpinVditorSVDOM(i),"</div>"),Xe(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})):this.vditor.currentMode==="wysiwyg"?yr(this.vditor,i,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}):(this.vditor.ir.element.innerHTML=this.vditor.lute.Md2VditorIRDOM(i),this.vditor.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(l){me(l,o.vditor)}),Pt(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})),this.vditor.outline.render(this.vditor),i||(x(this.vditor,["emoji","headings","submenu","hint"]),this.vditor.wysiwyg.popover&&(this.vditor.wysiwyg.popover.style.display="none"),this.clearCache()),r&&this.clearStack()},t.prototype.insertEmptyBlock=function(i){Pn(this.vditor,i)},t.prototype.clearStack=function(){this.vditor.undo.clearStack(this.vditor),this.vditor.undo.addToUndoStack(this.vditor)},t.prototype.destroy=function(){this.vditor.element.innerHTML=this.vditor.originalInnerHTML,this.vditor.element.classList.remove("vditor"),this.vditor.element.removeAttribute("style");var i=document.getElementById("vditorIconScript");i&&i.remove(),this.clearCache(),$n(),this.vditor.wysiwyg.unbindListener()},t.prototype.getCommentIds=function(){return this.vditor.currentMode!=="wysiwyg"?[]:this.vditor.wysiwyg.getComments(this.vditor,!0)},t.prototype.hlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var r=function(o){o.classList.remove("vditor-comment--hover"),i.forEach(function(l){o.getAttribute("data-cmtids").indexOf(l)>-1&&o.classList.add("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){r(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){r(o)})}},t.prototype.unHlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var r=function(o){i.forEach(function(l){o.getAttribute("data-cmtids").indexOf(l)>-1&&o.classList.remove("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){r(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){r(o)})}},t.prototype.removeCommentIds=function(i){var r=this;if(this.vditor.currentMode==="wysiwyg"){var o=function(l,w){var _=l.getAttribute("data-cmtids").split(" ");_.find(function(D,L){if(D===w)return _.splice(L,1),!0}),_.length===0?(l.outerHTML=l.innerHTML,(0,N.RN)(r.vditor).collapse(!0)):l.setAttribute("data-cmtids",_.join(" "))};i.forEach(function(l){r.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(w){o(w,l)}),r.vditor.preview.element.style.display!=="none"&&r.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(w){o(w,l)})}),Be(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})}},t.prototype.init=function(i,r){var o=this;this.vditor={currentMode:r.mode,element:i,hint:new Ao(r.hint.extend),lute:void 0,options:r,originalInnerHTML:i.innerHTML,outline:new Po(window.VditorI18n.outline),tip:new Yr},this.vditor.sv=new No(this.vditor),this.vditor.undo=new Hs,this.vditor.wysiwyg=new js(this.vditor),this.vditor.ir=new Do(this.vditor),this.vditor.toolbar=new Ps(this.vditor),r.resize.enable&&(this.vditor.resize=new Io(this.vditor)),this.vditor.toolbar.elements.devtools&&(this.vditor.devtools=new d),(r.upload.url||r.upload.handler)&&(this.vditor.upload=new yo),(0,S.Z)(r._lutePath||"".concat(r.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){o.vditor.lute=(0,Oo.X)({autoSpace:o.vditor.options.preview.markdown.autoSpace,gfmAutoLink:o.vditor.options.preview.markdown.gfmAutoLink,codeBlockPreview:o.vditor.options.preview.markdown.codeBlockPreview,emojiSite:o.vditor.options.hint.emojiPath,emojis:o.vditor.options.hint.emoji,fixTermTypo:o.vditor.options.preview.markdown.fixTermTypo,footnotes:o.vditor.options.preview.markdown.footnotes,headingAnchor:!1,inlineMathDigit:o.vditor.options.preview.math.inlineDigit,linkBase:o.vditor.options.preview.markdown.linkBase,linkPrefix:o.vditor.options.preview.markdown.linkPrefix,listStyle:o.vditor.options.preview.markdown.listStyle,mark:o.vditor.options.preview.markdown.mark,mathBlockPreview:o.vditor.options.preview.markdown.mathBlockPreview,paragraphBeginningSpace:o.vditor.options.preview.markdown.paragraphBeginningSpace,sanitize:o.vditor.options.preview.markdown.sanitize,toc:o.vditor.options.preview.markdown.toc}),o.vditor.preview=new Ho(o.vditor),Ie(o.vditor),r.after&&r.after(),r.icon&&(0,S.U)("".concat(r.cdn,"/dist/js/icons/").concat(r.icon,".js"),"vditorIconScript")})},t}(m.default);const Fs=zs})(),f=f.default,f})())}(mi)),mi.exports}var Ul=Fl();const yi=Bl(Ul),Vl=St({__name:"VditorEditor",props:{modelValue:{type:String,default:""},theme:{type:String,default:"classic"}},emits:["update:modelValue"],setup(T,{expose:n,emit:a}){const s=T,c=a,f=ae();let m=null;const h={mode:"ir",height:"auto",minHeight:140,resize:{enable:!0,position:"bottom"},icon:"ant",lang:"zh_CN",theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","|","quote","line","code","inline-code","|","preview","fullscreen"],toolbarConfig:{pin:!0,hideTooltip:!0},counter:{enable:!1},cache:{enable:!0,id:"vue-vditor"},input:y=>{c("update:modelValue",y)},preview:{hljs:{style:"native"},markdown:{listStyle:!0,mark:!0},actions:[]},placeholder:"灵感记录~"};return jt(async()=>{f.value&&(m=new yi(f.value,{...h,after:()=>{m==null||m.setValue(s.modelValue),m==null||m.setTheme(s.theme==="dark"?"dark":"classic")}}))}),wi(()=>{m==null||m.destroy()}),n({clear:()=>{m&&(m.setValue(""),c("update:modelValue",""))},insertValue:y=>{m&&(m.insertValue(y),c("update:modelValue",m.getValue()))}}),ot(()=>s.theme,y=>{m&&m.setTheme(y==="dark"?"dark":"classic")}),(y,C)=>(ue(),pe("div",{ref_key:"editorContainer",ref:f,class:"vditor-container"},null,512))}}),$l={class:"bg-gray-800 p-6 rounded-lg"},ql={class:"space-y-4"},Wl={class:"flex justify-end gap-2"},Yl=St({__name:"Searchmode",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","search-result"],setup(T,{expose:n,emit:a}){const s=Ne(),f=on().public.baseApi,m=T,h=a,y=je({get:()=>m.modelValue,set:u=>h("update:modelValue",u)}),C=()=>{h("update:modelValue",!1)},S=ae(""),d=async()=>{var u,p;if(!S.value.trim()){s.add({title:"提示",description:"请输入搜索关键词",color:"yellow"});return}try{const{data:g,error:E}=await Sl("/messages/search",{method:"GET",baseURL:f,params:{keyword:S.value,page:1,pageSize:10}},"$4cD5OWGgav");if(E.value)throw new Error(((u=E.value)==null?void 0:u.message)||"网络请求失败");if(!g.value)throw new Error("未收到服务器响应");if(g.value.code===1)h("search-result",g.value),h("update:modelValue",!1),S.value="",s.add({title:"成功",description:"搜索完成",color:"green"});else throw new Error(((p=g.value)==null?void 0:p.msg)||"搜索失败")}catch(g){console.error("Search error:",g),s.add({title:"错误",description:g instanceof Error?g.message:"搜索失败，请稍后重试",color:"red"})}};return n({handleSearch:d}),(u,p)=>{const g=pr,E=_t,b=Ba;return ue(),Bt(b,{modelValue:y.value,"onUpdate:modelValue":p[1]||(p[1]=k=>y.value=k)},{default:qe(()=>[$("div",$l,[p[4]||(p[4]=$("h3",{class:"text-xl font-semibold text-white mb-4"},"搜索内容",-1)),$("div",ql,[ce(g,{modelValue:S.value,"onUpdate:modelValue":p[0]||(p[0]=k=>S.value=k),placeholder:"输入搜索关键词",class:"w-full",onKeyup:Na(d,["enter"])},null,8,["modelValue"]),$("div",Wl,[ce(E,{variant:"solid",color:"gray",onClick:C,class:"bg-gray-700 hover:bg-gray-700 text-white hover:text-white border border-gray-600"},{default:qe(()=>p[2]||(p[2]=[tt(" 取消 ")])),_:1}),ce(E,{color:"primary",onClick:d,class:"text-white hover:text-white"},{default:qe(()=>p[3]||(p[3]=[tt(" 搜索 ")])),_:1})])])])]),_:1},8,["modelValue"])}}}),so=_n(Yl,[["__scopeId","data-v-07a5871c"]]),Kl=Ia("notify",{state:()=>({config:{webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:"",twitterEnabled:!1,twitterApiKey:"",twitterApiSecret:"",twitterAccessToken:"",twitterAccessTokenSecret:"",customHttpEnabled:!1,customHttpUrl:"",customHttpMethod:"POST",customHttpHeaders:"",customHttpBody:'{"content":"{{content}}"}'}}),actions:{async fetchConfig(){try{const n=await(await fetch("/api/notify/config",{credentials:"include"})).json();n.code===1&&(this.config=n.data)}catch(T){console.error("获取推送配置失败:",T)}},async saveConfig(T){try{const a=await(await fetch("/api/notify/config",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(T)})).json();if(a.code===1){const s=a.data||T;return Object.keys(this.config).forEach(c=>{c.endsWith("Enabled")?this.config[c]=!!s[c]&&s[c]!=="false":s[c]!==void 0&&(this.config[c]=s[c])}),!0}return!1}catch(n){return console.error("保存推送配置失败:",n),!1}},async testNotify(T){try{return(await(await fetch("/api/notify/test",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:T})})).json()).code===1}catch(n){return console.error("测试推送失败:",n),!1}},async sendNotify(T){try{let n=T.content;return T.images&&T.images.length>0&&(n+=`

`,T.images.forEach(c=>{n+=`![](${c})
`})),(await(await fetch("/api/notify/send",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:n,format:T.format||"markdown",config:this.config})})).json()).code===1}catch(n){return console.error("发送推送失败:",n),!1}}}}),Gl=St({__name:"VideoUpload",emits:["video-uploaded","upload-progress"],setup(T,{emit:n}){const a=n,s=ae(null),c=Ne(),f=on().public.baseApi,m=()=>{var y;(y=s.value)==null||y.click()},h=async y=>{const C=y.target,S=C.files?C.files[0]:null;if(!S){c.add({title:"错误",description:"未选择视频",color:"red"});return}const d=200*1024*1024;if(S.size>d){c.add({title:"错误",description:"视频不能超过200MB",color:"red"});return}const u=new FormData;u.append("video",S);const p=new XMLHttpRequest;p.open("POST",`${f}/videos/upload`,!0),p.withCredentials=!0,p.upload.onprogress=g=>{if(g.lengthComputable){const E=Math.round(g.loaded/g.total*100);a("upload-progress",E)}},p.onload=()=>{if(p.status===200)try{const g=JSON.parse(p.responseText);if(g.code===1&&g.data)a("video-uploaded",g.data),c.add({title:"成功",description:"视频上传成功",color:"green"});else throw new Error(g.msg||"视频上传失败")}catch(g){c.add({title:"错误",description:g.message||"视频上传失败",color:"red"})}else c.add({title:"错误",description:"视频上传失败",color:"red"});a("upload-progress",0),s.value&&(s.value.value="")},p.onerror=()=>{c.add({title:"错误",description:"视频上传失败",color:"red"}),a("upload-progress",0),s.value&&(s.value.value="")},p.send(u)};return(y,C)=>{const S=_t;return ue(),pe("div",null,[$("input",{ref_key:"videoInput",ref:s,type:"file",accept:"video/*",class:"hidden",onChange:h},null,544),ce(S,{color:"gray",variant:"solid",size:"sm",icon:"i-mdi-video",class:"cursor-pointer",onClick:m,title:"上传视频"})])}}}),kn=el(cr.ui.strategy,cr.ui.progress,Tl),Zl=St({inheritAttrs:!1,props:{value:{type:Number,default:null},max:{type:[Number,Array],default:100},indicator:{type:Boolean,default:!1},animation:{type:String,default:()=>kn.default.animation,validator(T){return Object.keys(kn.animation).includes(T)}},size:{type:String,default:()=>kn.default.size,validator(T){return Object.keys(kn.progress.size).includes(T)}},color:{type:String,default:()=>kn.default.color,validator(T){return cr.ui.colors.includes(T)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(T){const{ui:n,attrs:a}=tl("progress",lr(T,"ui"),kn,lr(T,"class")),s=je(()=>Zt(n.value.indicator.container.base,n.value.indicator.container.width,n.value.indicator.container.transition)),c=je(()=>Zt(n.value.indicator.align,n.value.indicator.width,n.value.indicator.color,n.value.indicator.size[T.size])),f=je(()=>{var M;const k=[n.value.progress.base,n.value.progress.width,n.value.progress.size[T.size],n.value.progress.rounded,n.value.progress.track,n.value.progress.bar,(M=n.value.progress.color)==null?void 0:M.replaceAll("{color}",T.color),n.value.progress.background,n.value.progress.indeterminate.base,n.value.progress.indeterminate.rounded];return p.value&&k.push(n.value.animation[T.animation]),Zt(...k)}),m=je(()=>{var k;return Zt(n.value.steps.base,(k=n.value.steps.color)==null?void 0:k.replaceAll("{color}",T.color),n.value.steps.size[T.size])}),h=je(()=>Zt(n.value.step.base,n.value.step.align)),y=je(()=>Zt(n.value.step.active)),C=je(()=>Zt(n.value.step.first));function S(k){return k===Number(T.value)}function d(k){return k===0}function u(k){k=Number(k);const M=[h.value];return d(k)&&M.push(C.value),S(k)&&M.push(y.value),M.join(" ")}const p=je(()=>T.value===void 0||T.value===null),g=je(()=>Array.isArray(T.max)),E=je(()=>p.value?null:Array.isArray(T.max)?T.max.length-1:Number(T.max)),b=je(()=>{if(!p.value)switch(!0){case T.value<0:return 0;case T.value>E.value:return 100;default:return T.value/E.value*100}});return{ui:n,attrs:a,indicatorContainerClass:s,indicatorClass:c,progressClass:f,stepsClass:m,stepClasses:u,isIndeterminate:p,isSteps:g,realMax:E,percent:b}}}),Xl=["aria-valuemax","aria-valuenow"];function Jl(T,n,a,s,c,f){return ue(),pe("div",{class:pt(T.ui.wrapper),role:"progressbar"},[T.indicator||T.$slots.indicator?na(T.$slots,"indicator",nl(Vi({key:0},{percent:T.percent})),()=>[T.isSteps?_e("",!0):(ue(),pe("div",{key:0,class:pt(T.indicatorContainerClass),style:sn({width:`${T.percent}%`})},[$("div",{class:pt(T.indicatorClass)},Je(Math.round(T.percent))+"% ",3)],6))],!0):_e("",!0),$("progress",Vi({"aria-valuemax":T.realMax,"aria-valuenow":T.value,class:T.progressClass},{value:T.value,max:T.realMax,...T.attrs}),Je(T.percent!==void 0?`${Math.round(T.percent)}%`:void 0),17,Xl),T.isSteps?(ue(),pe("div",{key:1,class:pt(T.stepsClass)},[(ue(!0),pe(Lt,null,Wt(T.max,(m,h)=>(ue(),pe("div",{key:h,class:pt(T.stepClasses(h))},[na(T.$slots,`step-${h}`,Vi({ref_for:!0},{step:m}),()=>[tt(Je(m),1)],!0)],2))),128))],2)):_e("",!0)],2)}const Ql=_n(Zl,[["render",Jl],["__scopeId","data-v-157fbd8e"]]),ec={class:"flex justify-between items-center mb-3"},tc={class:"mb-4"},nc={class:"flex gap-2 mb-3"},ic={key:0,class:"space-y-2 mb-3"},rc={class:"flex items-center gap-2"},ac={class:"flex justify-end mt-2 mb-3"},oc=["src"],sc={key:3,class:"text-sm text-gray-300"},lc={key:4,class:"text-sm text-gray-300"},cc={key:1,class:"flex justify-end mt-2"},uc={key:2,class:"mt-2 text-red-400 text-sm"},dc={key:3,class:"mt-2"},fc={class:"flex items-center gap-2 bg-gray-800 p-2 rounded"},hc=["value"],pc={class:"flex justify-end mt-2"},mc=St({__name:"ImageHostingUploader",props:{position:{type:Object,required:!0,default:()=>({x:0,y:0})},editorRef:{type:Object,required:!1,default:null}},emits:["close","upload-success"],setup(T,{emit:n}){const a=T,s=je(()=>{if(typeof window>"u")return{};const X=window.innerWidth,Z=window.innerHeight,Ee=400,De=500;let V=a.position.x,U=a.position.y;return V+Ee>X&&(V=X-Ee-20),V<0&&(V=20),U+De>Z&&(U=Z-De-20),U<0&&(U=20),X<768&&(V=(X-Ee)/2,U=60),{position:"fixed",top:`${U}px`,left:`${V}px`,maxWidth:`${Math.min(Ee,X-40)}px`,width:"100%",cursor:"move",userSelect:"none",touchAction:"none"}}),c=ae(!1),f=ae({x:0,y:0}),m=X=>{c.value=!0;const Z="touches"in X?X.touches[0].clientX:X.clientX,Ee="touches"in X?X.touches[0].clientY:X.clientY;f.value={x:Z-a.position.x,y:Ee-a.position.y},document.addEventListener("mousemove",h),document.addEventListener("touchmove",h),document.addEventListener("mouseup",y),document.addEventListener("touchend",y)},h=X=>{if(!c.value)return;const Z="touches"in X?X.touches[0].clientX:X.clientX,Ee="touches"in X?X.touches[0].clientY:X.clientY;C("update:position",{x:Z-f.value.x,y:Ee-f.value.y})},y=()=>{c.value=!1,document.removeEventListener("mousemove",h),document.removeEventListener("touchmove",h),document.removeEventListener("mouseup",y),document.removeEventListener("touchend",y)},C=n,S=Ne(),d=ae("smms"),u=ae(null),p=ae(!1),g=ae(!1),E=ae(0),b=ae(""),k=ae(""),M=ae(""),x=ae(""),A=ae(""),v=ae("main"),O=ae("images/"),I=ae(!1),R=ae(""),P=ae(""),B=ae(""),W=()=>{var X;(X=u.value)==null||X.click()},G=X=>{var Ee;p.value=!1;const Z=(Ee=X.dataTransfer)==null?void 0:Ee.files;Z&&Z.length>0&&ve(Z[0])},re=X=>{const Ee=X.target.files;Ee&&Ee.length>0&&ve(Ee[0])},de=ae(null),ve=async X=>{if(!X.type.startsWith("image/")){M.value="请选择图片文件";return}const Z=5*1024*1024;if(X.size>Z){M.value="图片大小不能超过 5MB";return}M.value="",de.value=X;const Ee=new FileReader;Ee.onload=De=>{var V;b.value=(V=De.target)==null?void 0:V.result},Ee.readAsDataURL(X)},ke=()=>{if(!k.value){M.value="请先上传图片";return}const X=`![](${k.value})`;C("upload-success",X),C("close"),de.value=null,b.value="",k.value="",E.value=0,g.value=!1,M.value=""},be=async X=>{try{await navigator.clipboard.writeText(X),S.add({title:"成功",description:"已复制到剪贴板",color:"green",timeout:2e3})}catch{S.add({title:"错误",description:"复制失败",color:"red",timeout:2e3})}},we=async()=>{if(!de.value){M.value="请先选择图片";return}g.value=!0,E.value=0,M.value="";try{switch(d.value){case"github":await Ae(de.value);break;default:throw new Error("未知的图床类型")}}catch(X){console.error("上传错误:",X),M.value=X.message||"上传失败",g.value=!1,X.name==="AbortError"?M.value="请求超时，请检查网络连接":X.message.includes("Failed to fetch")&&(M.value="网络请求失败，可能是跨域问题或API不可用")}},Ae=async X=>{if(!x.value||!A.value){M.value="请先配置 GitHub Token 和仓库名";return}try{E.value=30;const Z=Date.now(),Ee=X.name.split(".").pop(),De=`${Z}.${Ee}`,V=`${O.value}${De}`.replace(/\/\//g,"/"),U=await We(X),j={message:`Upload image ${De}`,content:U,branch:v.value||"main"};E.value=50;const z=await fetch(`https://api.github.com/repos/${A.value}/contents/${V}`,{method:"PUT",headers:{Authorization:`token ${x.value}`,"Content-Type":"application/json"},body:JSON.stringify(j)});if(E.value=80,!z.ok)throw new Error(`GitHub 上传失败: ${z.status}`);const te=await z.json();k.value=I.value&&R.value?`https://${R.value}/gh/${A.value}@${v.value||"main"}/${V}`:te.content.download_url,E.value=100,g.value=!1,S.add({title:"成功",description:`图片已上传到 GitHub${I.value&&R.value?" (CDN加速)":""}`,color:"green",timeout:2e3})}catch(Z){console.error("GitHub 上传错误:",Z),M.value=Z.message||"GitHub 上传失败",g.value=!1}},We=X=>new Promise((Z,Ee)=>{const De=new FileReader;De.onload=()=>Z(De.result.split(",")[1]),De.onerror=Ee,De.readAsDataURL(X)}),me=()=>{try{const X={selectedHost:d.value,github:{token:x.value,repo:A.value,branch:v.value,path:O.value,enableCDN:I.value,cdnDomain:R.value},smms:{token:P.value},freeimage:{token:B.value}};localStorage.setItem("imageHostingConfig",JSON.stringify(X)),S.add({title:"成功",description:"配置已保存",color:"green",timeout:2e3})}catch(X){console.error("保存配置失败:",X),S.add({title:"错误",description:"保存配置失败",color:"red",timeout:2e3})}},N=()=>{const X=localStorage.getItem("imageHostingConfig");if(X)try{const Z=JSON.parse(X);d.value=Z.selectedHost||"smms",Z.github&&(x.value=Z.github.token||"",A.value=Z.github.repo||"",v.value=Z.github.branch||"main",O.value=Z.github.path||"images/",I.value=Z.github.enableCDN||!1,R.value=Z.github.cdnDomain||""),Z.smms&&(P.value=Z.smms.token||""),Z.imgtp&&(imgtpToken.value=Z.imgtp.token||""),Z.freeimage&&(B.value=Z.freeimage.token||"")}catch(Z){console.error("加载配置失败:",Z)}};return ot([d,x,A,v,O,P],()=>{me()},{deep:!0}),jt(()=>{N()}),(X,Z)=>{const Ee=_t,De=pr,V=ll,U=Ei,j=Ql;return ue(),pe("div",{class:"fixed z-50 bg-black/80 backdrop-blur-sm rounded-lg shadow-lg p-4 text-white",style:sn(s.value),onMousedown:m,onTouchstart:m},[$("div",ec,[Z[11]||(Z[11]=$("h3",{class:"text-lg font-medium"},"图床上传",-1)),ce(Ee,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",size:"xs",onClick:Z[0]||(Z[0]=z=>X.$emit("close"))})]),$("div",tc,[$("div",nc,[ce(Ee,{color:d.value==="github"?"blue":"gray",variant:"solid",size:"sm",onClick:Z[1]||(Z[1]=z=>d.value="github")},{default:qe(()=>Z[12]||(Z[12]=[tt(" GitHub ")])),_:1},8,["color"])]),d.value==="github"?(ue(),pe("div",ic,[ce(De,{modelValue:x.value,"onUpdate:modelValue":Z[2]||(Z[2]=z=>x.value=z),placeholder:"GitHub Token",size:"sm",type:"password"},null,8,["modelValue"]),ce(De,{modelValue:A.value,"onUpdate:modelValue":Z[3]||(Z[3]=z=>A.value=z),placeholder:"仓库名 (用户名/仓库)",size:"sm"},null,8,["modelValue"]),ce(De,{modelValue:v.value,"onUpdate:modelValue":Z[4]||(Z[4]=z=>v.value=z),placeholder:"分支名 (默认: main)",size:"sm"},null,8,["modelValue"]),ce(De,{modelValue:O.value,"onUpdate:modelValue":Z[5]||(Z[5]=z=>O.value=z),placeholder:"存储路径 (默认: images/)",size:"sm"},null,8,["modelValue"]),$("div",rc,[ce(V,{modelValue:I.value,"onUpdate:modelValue":Z[6]||(Z[6]=z=>I.value=z)},null,8,["modelValue"]),Z[13]||(Z[13]=$("span",{class:"text-sm"},"启用CDN加速",-1))]),I.value?(ue(),Bt(De,{key:0,modelValue:R.value,"onUpdate:modelValue":Z[7]||(Z[7]=z=>R.value=z),placeholder:"输入CDN域名 (如: jsd.cdn.noisework.cn)",size:"sm"},null,8,["modelValue"])):_e("",!0)])):_e("",!0),$("div",ac,[ce(Ee,{color:"green",variant:"solid",size:"sm",icon:"i-heroicons-check",onClick:me},{default:qe(()=>Z[14]||(Z[14]=[tt(" 保存配置 ")])),_:1})]),$("div",{class:pt(["flex flex-col items-center justify-center border-2 border-dashed border-gray-500 rounded-lg p-4 cursor-pointer hover:border-blue-400 transition-colors",{"border-blue-400":p.value}]),onClick:W,onDragover:Z[8]||(Z[8]=$i(z=>p.value=!0,["prevent"])),onDragleave:Z[9]||(Z[9]=$i(z=>p.value=!1,["prevent"])),onDrop:$i(G,["prevent"])},[$("input",{ref_key:"fileInput",ref:u,type:"file",accept:"image/*",onChange:re,class:"hidden"},null,544),!g.value&&!b.value?(ue(),Bt(U,{key:0,name:"i-heroicons-cloud-arrow-up",class:"w-10 h-10 text-gray-400 mb-2"})):_e("",!0),b.value&&!g.value?(ue(),pe("img",{key:1,src:b.value,class:"max-h-32 max-w-full mb-2 rounded"},null,8,oc)):_e("",!0),g.value?(ue(),Bt(j,{key:2,value:E.value,color:"blue",class:"w-full mb-2"},null,8,["value"])):_e("",!0),!g.value&&!b.value?(ue(),pe("p",sc," 点击或拖拽图片到此处上传 ")):_e("",!0),g.value?(ue(),pe("p",lc," 上传中... "+Je(E.value)+"% ",1)):_e("",!0)],34),b.value&&!g.value&&!k.value?(ue(),pe("div",cc,[ce(Ee,{color:"blue",variant:"solid",size:"sm",icon:"i-heroicons-cloud-arrow-up",onClick:we},{default:qe(()=>Z[15]||(Z[15]=[tt(" 开始上传 ")])),_:1})])):_e("",!0),M.value?(ue(),pe("div",uc,Je(M.value),1)):_e("",!0),k.value?(ue(),pe("div",dc,[$("div",fc,[$("input",{type:"text",value:k.value,readonly:"",class:"bg-transparent flex-1 text-sm outline-none"},null,8,hc),ce(Ee,{icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",size:"xs",onClick:Z[10]||(Z[10]=z=>be(k.value))})]),$("div",pc,[ce(Ee,{color:"blue",variant:"solid",size:"sm",onClick:ke},{default:qe(()=>Z[16]||(Z[16]=[tt(" 插入图片 ")])),_:1})])])):_e("",!0)])],36)}}}),gc=_n(mc,[["__scopeId","data-v-a97867d7"]]),vc={class:"flex justify-between mb-3"},bc={class:"flex justify-start items-center gap-2"},yc={class:"flex gap-2"},wc={href:"/rss",target:"_blank"},Ec={class:"flex justify-between items-center"},Sc={class:"flex items-center justify-start gap-2"},Cc={key:0,class:"w-full mt-2"},Tc={class:"bg-gray-700 rounded h-2"},kc={class:"text-xs text-gray-300 mt-1 text-right"},Mc={class:"flex gap-2"},xc={key:0,class:"mx-auto sm:max-w-2xl mt-5 backdrop-blur-sm bg-black/40 p-4 rounded-md"},_c={class:"prose prose-invert max-w-none"},Lc=["innerHTML"],Ac={key:0,class:"prose prose-invert max-w-none"},Dc=["innerHTML"],Oc=St({__name:"AddForm",emits:["search-result","video-uploaded","before-upload","upload-progress"],setup(T,{emit:n}){const a=ae(!1),s=ae({x:400,y:320}),c=me=>{var N;(N=R.value)!=null&&N.insertValue&&R.value.insertValue(me),a.value=!1},f=me=>{s.value=me},m=ae(0),h=me=>{m.value=me},y=ae(!1),C=n,S=me=>{C("search-result",me)},d=Ne(),u=on().public.baseApi,{save:p}=Ua(),g=Un("showHeatmap");pi("showHeatmap",g);const E=()=>{g.value=!g.value},b=ae(""),k=ae(""),M=ae(""),x=ae(typeof window<"u"&&localStorage.getItem("postPrivate")==="true"),A=Un("contentTheme"),v=Un("toggleContentTheme"),O=()=>{v&&v(),typeof window<"u"&&(document.documentElement.className=A.value==="dark"?"dark":"")},I=ae(null),R=ae(null),P=je(()=>x.value?"i-mdi-eye-off-outline":"i-mdi-eye-outline");Kl();const B=ae(localStorage.getItem("enableNotify")==="true"),W=()=>{b.value="",k.value="",M.value="",R.value&&R.value.clear()},G=ja(),re=()=>G.isLogin?!0:(d.add({title:"提示",description:"请先登录",color:"orange",timeout:2e3}),!1),de=()=>{const me=document.getElementById("file-input");me&&me.click()},ve=async me=>{var U;if(!re())return;const N=me.target,X=N.files?N.files[0]:null;if(!X){d.add({title:"错误",description:"没有选择文件",color:"red",timeout:2e3});return}const Z=["image/jpeg","image/png","image/gif","image/webp"],Ee=[".jpg",".jpeg",".png",".gif",".webp"],De=X.name.toLowerCase().substring(X.name.lastIndexOf("."));if(!Z.includes(X.type)||!Ee.includes(De)){d.add({title:"错误",description:"仅支持 JPG、PNG、GIF、WEBP 格式的图片",color:"red",timeout:2e3});return}const V=5*1024*1024;if(X.size>V){d.add({title:"错误",description:"图片大小不能超过 5MB",color:"red",timeout:2e3});return}try{const j=new FormData;j.append("image",X);const z=await fetch(`${u}/images/upload`,{method:"POST",body:j,credentials:"include"});if(!z.ok){const K=await z.json();throw new Error(K.msg||"图片上传失败")}const te=await z.json();if(te.code===1&&te.data){if((U=R.value)!=null&&U.insertValue){const Se=`
![](${typeof window<"u"?window.location.origin:""}${u}${te.data})
`;R.value.insertValue(Se)}d.add({title:"成功",description:"图片上传成功",color:"green",timeout:2e3})}else throw new Error(te.msg||"图片上传失败")}catch(j){console.error("上传错误:",j),d.add({title:"错误",description:j.message||"图片上传失败",color:"red",timeout:2e3})}finally{I.value&&(I.value.value="")}},ke=me=>{var Ee;const N=typeof window<"u"?window.location.origin:"",X=me.startsWith("/")?me:`/${me}`,Z=`<video width="100%" height="100%" src="${N}${X}" controls loop></video>
`;(Ee=R.value)!=null&&Ee.insertValue&&R.value.insertValue(Z)};ot(k,me=>{M.value=yi.md2html(me||"")}),ot(()=>G.isLogin,me=>{me&&(B.value=localStorage.getItem("enableNotify")==="true")},{immediate:!0}),jt(async()=>{Le.bind("[data-fancybox]",{}),G.isLogin||localStorage.getItem("token")&&G.fetchUserInfo&&await G.fetchUserInfo(),x.value=localStorage.getItem("postPrivate")==="true",A.value=localStorage.getItem("contentTheme")||A.value}),wi(()=>{Le.destroy()});const be=()=>{B.value=!B.value,localStorage.setItem("enableNotify",B.value.toString())},we=()=>{x.value=!x.value,localStorage.setItem("postPrivate",x.value?"true":"false")},Ae=me=>G.isLogin?!0:(d.add({title:"提示",description:"请登录后操作",color:"orange",timeout:2e3}),me.preventDefault&&me.preventDefault(),!1),We=async()=>{if(!re())return;if(!k.value.trim()){d.add({title:"错误",description:"请输入内容或上传图片/视频",color:"red",timeout:2e3});return}const me={username:b.value,content:k.value,private:x.value,notify:B.value};try{await p(me)&&W()}catch(N){console.error("发布错误:",N),d.add({title:"错误",description:N.message||"发布失败",color:"red",timeout:2e3})}};return(me,N)=>{const X=Ei,Z=cl,Ee=il,De=hr;return ue(),pe(Lt,null,[ce(De,{class:"mx-auto sm:max-w-2xl hover:shadow-md backdrop-blur-sm bg-black/20 shadow-lg text-white"},{default:qe(()=>[$("div",vc,[$("div",bc,[ce(X,{name:"i-heroicons-pencil-square",class:"w-6 h-6 transition-all duration-300 hover:scale-110 hover:text-blue-400 animate-pulse"}),N[5]||(N[5]=$("h2",{class:"text-lg font-bold italic text-white"},"说说·笔记~",-1))]),$("div",yc,[ce(Z,null,{default:qe(()=>[$("div",{onClick:N[0]||(N[0]=V=>y.value=!0),class:"cursor-pointer flex"},[ce(X,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5 text-gray-200"})]),$("button",{onClick:E},[ce(X,{name:"i-mdi-calendar-month",class:"w-5 h-5 text-gray-200"})]),$("button",{onClick:O,title:"切换暗黑/白天模式"},[ce(X,{name:ye(A)==="dark"?"i-mdi-weather-night":"i-mdi-white-balance-sunny",class:"w-5 h-5 text-gray-200"},null,8,["name"])]),$("a",wc,[ce(X,{name:"i-mdi-rss",class:"w-5 h-5 text-gray-200"})])]),_:1}),ce(Ee,{to:"/status"},{default:qe(()=>[ce(X,{name:"i-mdi-server-outline",class:"w-5 h-5 text-gray-200"})]),_:1})])]),$("div",null,[ce(Vl,{ref_key:"vditorEditor",ref:R,modelValue:k.value,"onUpdate:modelValue":N[1]||(N[1]=V=>k.value=V),theme:ye(A)},null,8,["modelValue","theme"]),$("div",Ec,[$("div",Sc,[$("input",{id:"file-input",ref_key:"fileInput",ref:I,type:"file",accept:"image/*",onChange:ve,class:"hidden",placeholder:"选择图片"},null,544),ce(Gl,{onVideoUploaded:ke,onBeforeUpload:Ae,onUploadProgress:h}),m.value>0&&m.value<100?(ue(),pe("div",Cc,[$("div",Tc,[$("div",{class:"bg-blue-500 h-2 rounded",style:sn({width:m.value+"%"})},null,4)]),$("div",kc,Je(m.value)+"%",1)])):_e("",!0),ce(ye(_t),{color:"gray",variant:"solid",class:"cursor-pointer",size:"sm",icon:"i-fluent-image-20-regular",onClick:de}),ce(ye(_t),{color:"gray",variant:"solid",class:"cursor-pointer",size:"sm",icon:"i-mdi-cloud-upload-outline",onClick:N[2]||(N[2]=V=>a.value=!0),title:"图床上传"}),ce(ye(_t),{color:"gray",variant:"solid",size:"sm",onClick:we,icon:P.value,title:x.value?"设为公开":"设为私密",ui:{tooltip:{text:x.value?"设为公开":"设为私密"}}},null,8,["icon","title","ui"]),ce(ye(_t),{color:"gray",variant:"solid",size:"sm",onClick:be,icon:B.value?"i-mdi-bell":"i-mdi-bell-off",title:B.value?"关闭推送":"开启推送",ui:{tooltip:{text:B.value?"关闭推送":"开启推送"}},class:"text-gray-600"},null,8,["icon","title","ui"])]),$("div",Mc,[ce(ye(_t),{icon:"i-fluent-broom-16-regular",variant:"solid",color:"gray",size:"sm",onClick:W}),ce(ye(_t),{icon:"i-fluent-add-12-filled",variant:"solid",color:"gray",size:"sm",onClick:We})])])])]),_:1}),M.value?(ue(),pe("div",xc,[$("div",_c,[$("div",{innerHTML:M.value},null,8,Lc)]),N[6]||(N[6]=$("hr",{class:"border-gray-600 my-4"},null,-1)),M.value?(ue(),pe("div",Ac,[$("div",{innerHTML:M.value},null,8,Dc)])):_e("",!0)])):_e("",!0),ce(so,{modelValue:y.value,"onUpdate:modelValue":N[3]||(N[3]=V=>y.value=V),onSearchResult:S},null,8,["modelValue"]),a.value?(ue(),Bt(gc,{key:1,position:s.value,onClose:N[4]||(N[4]=V=>a.value=!1),onUploadSuccess:c,"onUpdate:position":f},null,8,["position"])):_e("",!0)],64)}}}),Ha=St({__name:"MarkdownRenderer",props:{content:{type:String,required:!0},enableGithubCard:{type:Boolean,default:!0}},emits:["tagClick"],setup(T,{emit:n}){const a=/https:\/\/www\.bilibili\.com\/video\/(BV[\w]+)\/?$/,s=/https:\/\/(?:www\.)?youtube\.com\/watch\?v=([\w-]+)|https:\/\/youtu\.be\/([\w-]+)/,c=/https:\/\/music\.163\.com(?:\/#)?\/song\?id=(\d+)/,f=/https:\/\/y\.qq\.com\/n\/yqq\/song(\w+)\.html/,m=/https:\/\/v\.qq\.com\/x\/cover\/\w+\/(\w+)\.html/,h=/https:\/\/open\.spotify\.com\/(track|album|playlist)\/([a-zA-Z0-9]+)/,y=/https:\/\/v\.youku\.com\/v_show\/id_([a-zA-Z0-9]+)\.html/,C=n,S=ae(null);let d=null;const u=T,p=Un("contentTheme"),g=()=>{if(!S.value)return;const v=p&&p.value==="dark";S.value.classList.toggle("theme-dark",!!v),S.value.classList.toggle("theme-light",!v)},E=()=>{var v;if(window.mediumZoom){d&&d.detach();const O=(v=S.value)==null?void 0:v.getElementsByTagName("img");O&&O.length>0&&(d=window.mediumZoom(O,{background:"rgba(0, 0, 0, 0.9)",margin:24,scrollOffset:0}))}},b=new RegExp("(?<!!)\\[([^\\]]+)\\]\\((https:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s)]*)?)\\)","g"),k=new RegExp(`(?<!["'\\(])\\bhttps:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s<\\)]*)?\\b`,"g"),M=v=>(u.enableGithubCard&&(v=v.replace(b,(O,I,R,P,B)=>`<div class="github-card" id="${`github-card-${P}-${B}`}" data-owner="${P}" data-repo="${B}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`),v=v.replace(k,(O,I,R)=>`<div class="github-card" id="${`github-card-${I}-${R}`}" data-owner="${I}" data-repo="${R}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`)),v.replace(a,"<div class='video-wrapper'><iframe src='https://www.bilibili.com/blackboard/html5mobileplayer.html?bvid=$1&as_wide=1&high_quality=1&danmaku=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' style='position:absolute;height:100%;width:100%'></iframe></div>").replace(s,"<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$1$2' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></div>").replace(c,"<div class='music-wrapper'><meting-js auto='https://music.163.com/#/song?id=$1'></meting-js></div>").replace(f,"<meting-js auto='https://y.qq.com/n/yqq/song$1.html'></meting-js>").replace(m,"<div class='video-wrapper'><iframe src='//v.qq.com/iframe/player.html?vid=$1' allowFullScreen='true' frameborder='no'></iframe></div>").replace(h,"<div class='spotify-wrapper'><iframe style='border-radius:12px' src='https://open.spotify.com/embed/$1/$2?utm_source=generator&theme=0' width='100%' frameBorder='0' allowfullscreen='' allow='autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture' loading='lazy'></iframe></div>").replace(y,"<div class='video-wrapper'><iframe src='https://player.youku.com/embed/$1' frameborder=0 'allowfullscreen'></iframe></div>")),x=async(v,O,I)=>{try{const R=await fetch(`https://api.github.com/repos/${v}/${O}`);if(!R.ok)return;const P=await R.json(),B=document.getElementById(I);B&&(B.innerHTML=`
        <div class="github-card-header">
          <img src="${P.owner.avatar_url}" class="github-card-avatar" />
          <div>
            <a href="${P.html_url}" target="_blank" class="github-card-title">${P.full_name}</a>
            <div class="github-card-desc">${P.description||""}</div>
          </div>
        </div>
        <div class="github-card-footer">
          <span>⭐ ${P.stargazers_count}</span>
          <span>🍴 ${P.forks_count}</span>
          <span>🛠️ ${P.language||""}</span>
        </div>
      `)}catch{}},A=async v=>{if(S.value)try{if(typeof yi>"u"){console.error("Vditor is not loaded.");return}const I=M(v).replace(/<a /g,'<a target="_blank" ').replace(new RegExp("(?<!<[^>]*)#([^\\s#<>]+)(?![^<]*>)","g"),`<span class="clickable-tag" onclick="window.handleTagClick('$1')" style="cursor: pointer;">#$1</span>`),R=p&&p.value==="dark"?"dark":"light",P=R==="dark"?"github-dark":"github";yi.preview(S.value,I,{mode:"light",lang:"zh_CN",theme:{current:R},hljs:{style:P,lineNumber:!0,enable:!0},after:()=>{var G,re,de;const B=(G=S.value)==null?void 0:G.querySelectorAll("a");B==null||B.forEach(ve=>{ve.hasAttribute("target")||(ve.setAttribute("target","_blank"),ve.setAttribute("rel","noopener noreferrer"))}),E(),console.log("Rendering complete."),g();const W=(re=S.value)==null?void 0:re.querySelectorAll(".clickable-tag");if(W==null||W.forEach(ve=>{ve.addEventListener("click",ke=>{var we;ke.preventDefault();const be=(we=ve.textContent)==null?void 0:we.substring(1);be&&C("tagClick",be)})}),u.enableGithubCard){const ve=(de=S.value)==null?void 0:de.querySelectorAll(".github-card");ve==null||ve.forEach(ke=>{const be=ke.getAttribute("data-owner"),we=ke.getAttribute("data-repo"),Ae=ke.id;be&&we&&Ae&&x(be,we,Ae)})}}})}catch(O){console.error("Error rendering markdown:",O),S.value.innerHTML=""}};return ot(()=>u.content,async v=>{await A(v)},{immediate:!0}),jt(()=>{A(u.content),window.APlayer&&window.MetingJSElement?console.log("MetingJS is ready"):console.error("MetingJS or APlayer is not loaded properly"),g()}),wi(()=>{d&&(d.detach(),d=null)}),ot(()=>p&&p.value,()=>{g(),A(u.content)}),(v,O)=>(ue(),pe("div",{ref_key:"previewElement",ref:S,class:"markdown-preview"},null,512))}}),Pc={class:"min-h-screen flex flex-col"},Rc={key:0,class:"text-center text-gray-500 py-8"},Hc={class:"flex-grow mx-auto w-full sm:max-w-2xl px-2"},Ic={key:0,class:"flex justify-between items-center mb-4 p-4 rounded-lg"},Nc={class:"text-gray-400"},jc={class:"my-4"},Bc={key:0,class:"text-center text-gray-500 py-8"},zc={class:"flex justify-between items-center"},Fc={class:"flex justify-start items-center h-auto overflow-x-auto whitespace-nowrap hide-scrollbar"},Uc={class:"flex justify-start text-sm"},Vc={class:"text-orange-500"},$c={class:"text-orange-500"},qc={class:"message-actions flex justify-end items-center space-x-2 flex-shrink-0 px-3 py-1.5 mr-[9px] -mb-[1px]"},Wc={key:0,class:"w-5 h-5 flex-shrink-0 transition-transform duration-200 hover:scale-110"},Yc=["onClick"],Kc=["onClick"],Gc=["onClick"],Zc=["onClick"],Xc=["onClick"],Jc={class:"border-l-2 border-gray-300 p-4 ml-1"},Qc=["data-msg-id"],eu=["src","fetchpriority"],tu={key:1,class:"border-t border-gray-600 my-4"},nu={key:2,class:"text-center mt-2 relative",style:{"z-index":"9999"}},iu=["onClick"],ru=["id"],au={key:1,class:"flex justify-center items-center space-x-4 w-full my-4 flex-wrap md:flex-nowrap"},ou={class:"flex justify-center items-center space-x-4 w-full md:w-auto"},su={key:2,class:"ml-2 text-orange-400"},lu={class:"flex items-center justify-center space-x-2 w-full md:w-auto mt-3 md:mt-0"},cu={class:"text-gray-500 text-shadow-sm text-sm"},uu={key:2,class:"text-center text-gray-500 mt-4"},du={key:1,class:"text-center text-xs text-gray-400 py-4"},fu=["innerHTML"],hu={class:"flex justify-between items-center"},pu={class:"flex flex-col space-y-4"},mu={class:"border-t border-gray-200 my-2 pt-2"},gu={class:"p-4 rounded-lg overflow-auto max-h-[300px] bg-[rgba(36,43,50,0.95)]"},vu={class:"text-white"},bu={class:"flex justify-end space-x-2"},yu=St({__name:"MessageList",props:{siteConfig:{type:Object,required:!0},targetMessageId:{type:String,default:null}},setup(T,{expose:n}){const a=Un("contentTheme",ae(typeof window<"u"&&localStorage.getItem("contentTheme")||"dark")),s=je(()=>a.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white":"bg-white text-black"),c=je(()=>a.value==="dark"?"text-white":"text-black"),f=je(()=>a.value==="dark"?"from-[rgba(36,43,50,1)] via-[rgba(36,43,50,0.8)] to-transparent":"from-[rgba(255,255,255,1)] via-[rgba(255,255,255,0.8)] to-transparent"),m=je(()=>a.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white rounded-lg p-3":"bg-white text-black rounded-lg p-3"),h=je(()=>a.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white hover:text-white border-none shadow-sm rounded-full":"bg-white text-black hover:text-black border border-gray-300 shadow-sm rounded-full"),y=ae(""),C=je(()=>Math.ceil(p.total/15)),S=async()=>{const U=parseInt(y.value);if(!U||U<1||U>C.value||p.loading){Ne().add({title:"页码无效",description:`请输入 1-${C.value} 之间的数字`,color:"orange",timeout:2e3});return}try{const j=await p.getMessages({page:U,pageSize:15});if(!j)throw new Error("跳转页面失败");p.messages=j.items,window.scrollTo({top:0,behavior:"instant"}),y.value=""}catch(j){console.error("跳转页面失败:",j),Ne().add({title:"跳转失败",color:"red",timeout:2e3})}},d=T;ot(()=>d.targetMessageId,async U=>{if(!U)return;await rt();const j=document.querySelector(`.content-container[data-msg-id="${U}"]`);j&&(j.scrollIntoView({behavior:"smooth",block:"center"}),j.classList.add("highlight-message"),setTimeout(()=>{j.classList.remove("highlight-message")},2e3))},{immediate:!0});const u=on().public.baseApi;Ua();const p=Fa(),g=ae(null),E=ja(),b=je(()=>E.isLogin),k=async U=>{try{const j=encodeURIComponent(U.trim()),z=await fetch(`${u}/messages/tags/${j}`,{credentials:"include",headers:{Accept:"application/json"}});if(!z.ok)throw new Error(`HTTP error! status: ${z.status}`);const te=await z.json();if(te.code===1&&Array.isArray(te.data))X.value=!0,Z.value=te.data,await rt(),B(),A();else throw new Error(te.msg||"获取标签内容失败")}catch(j){console.error("获取标签消息失败:",j),Ne().add({title:"获取标签消息失败",description:j.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},M=async()=>{Z.value=[],X.value=!1,await p.getMessages({page:1,pageSize:15}),await rt(),B(),A()},x=async U=>{if(confirm("确定要删除这条消息吗？"))try{await p.deleteMessage(U),p.messages=p.messages.filter(z=>z.id!==U),Ne().add({title:"删除成功",color:"green",timeout:2e3})}catch(z){console.error("删除失败:",z),Ne().add({title:"删除失败",color:"red",timeout:2e3})}},A=()=>{if(window.Fancybox){window.Fancybox.destroy();const U={Carousel:{infinite:!1},Toolbar:{display:[{id:"prev",position:"center"},{id:"counter",position:"center"},{id:"next",position:"center"},"zoom","slideshow","fullscreen","close"]},Image:{zoom:!0,click:!0,wheel:"slide"}};document.querySelectorAll(".markdown-preview img").forEach(z=>{const te=z.getAttribute("src")||"",K=/^https?:\/\//i.test(te),Se=z.parentElement;if(Se&&Se.tagName==="A"&&Se.hasAttribute("data-fancybox")){K||Se.replaceWith(z);return}if(K){const Ce=document.createElement("a");Ce.href=te,Ce.setAttribute("data-fancybox","uploaded-image"),Ce.style.display="block",z.parentNode.insertBefore(Ce,z),Ce.appendChild(z)}else Se&&Se.tagName==="A"&&Se.hasAttribute("data-fancybox")&&Se.replaceWith(z)}),window.Fancybox.bind("[data-fancybox]",U)}},v=async U=>{g.value===U?g.value=null:(g.value=U,await rt(),window.Waline?document.querySelector(`#waline-${U}`)?window.Waline.init({el:`#waline-${U}`,serverURL:d.siteConfig.walineServerURL,path:"messages/${msgId}",reaction:!1,meta:["nick","mail","link"],requiredMeta:["mail","nick"],pageview:!0,search:!1,wordLimit:200,pageSize:5,avatar:"monsterid",emoji:["https://unpkg.com/@waline/emojis@1.2.0/tieba"],imageUploader:!1,copyright:!1,dark:'html[class="dark"]'}):console.error(`评论容器 #waline-${U} 未找到`):console.error("Waline 未加载"))},O=U=>{const j=new Date(U),te=new Date().getTime()-j.getTime(),K=Math.floor(te/(1e3*60*60*24)),Se=Math.floor(te/(1e3*60*60)),Ce=Math.floor(te/(1e3*60));return Math.floor(te/1e3)<60?"刚刚":Ce<60?`${Ce}分钟前`:Se<24?`${Se}小时前`:K<3?`${K}天前`:j.toLocaleString()},I=ae({}),R=ae({}),P=U=>{I.value[U]=!I.value[U]},B=()=>{rt(()=>{(X.value?Z.value:p.messages).forEach(j=>{const z=document.querySelector(`.content-container[data-msg-id="${j.id}"] .overflow-y-hidden`);z&&z.scrollHeight>700&&(R.value[j.id]=!0,I.value[j.id]===void 0&&(I.value[j.id]=!1))})})};ot(()=>p.messages,()=>{W.hash.includes("/messages/")||rt(()=>{requestAnimationFrame(()=>{B(),A()})})},{deep:!0});const W=rl();jt(async()=>{try{const U=W.hash.split("/messages/").pop();if(!window.Waline){const j=document.createElement("link");j.rel="stylesheet",j.href="https://unpkg.com/@waline/client@v2/dist/waline.css",document.head.appendChild(j),await new Promise((z,te)=>{const K=document.createElement("script");K.src="https://unpkg.com/@waline/client@v2/dist/waline.js",K.crossOrigin="anonymous",K.onload=z,K.onerror=te,document.head.appendChild(K)})}if(U){const j=await fetch(`${u}/messages/${U}`,{credentials:"include",headers:{Accept:"application/json"}});if(!j.ok)throw new Error("消息加载失败");const z=await j.json();if(z.code===1&&z.data){p.messages=[z.data],p.hasMore=!1,p.page=1,await rt();const te=document.querySelector(`.content-container[data-msg-id="${U}"]`);te&&te.scrollIntoView({behavior:"instant",block:"start"})}else throw new Error("消息不存在")}else W.hash.includes("/messages/")||await p.getMessages({page:1,pageSize:15});await rt(),B(),A()}catch(U){console.error("初始化失败:",U),U instanceof Error&&Ne().add({title:"加载失败",description:U.message||"请刷新重试",color:"red",timeout:2e3})}}),ot(()=>W.hash,async U=>{const j=U.split("/messages/").pop();if(!j){W.hash.includes("/messages/")||await p.getMessages({page:1,pageSize:15});return}try{const z=await fetch(`${u}/messages/${j}`,{credentials:"include",headers:{Accept:"application/json"}});if(!z.ok)throw new Error("消息加载失败");const te=await z.json();if(te.code===1&&te.data){p.messages=[te.data],p.hasMore=!1,p.page=1,await rt();const K=document.querySelector(`.content-container[data-msg-id="${j}"]`);K&&K.scrollIntoView({behavior:"instant",block:"start"})}}catch(z){console.error("加载消息失败:",z),Ne().add({title:"加载失败",color:"red",timeout:2e3})}},{immediate:!0});const G=ae(!1),re=async()=>{if(!(G.value||p.page<=1)){G.value=!0;try{const U=p.page-1,j=await p.getMessages({page:U,pageSize:15});j&&Array.isArray(j.items)?(p.messages=j.items,p.page=j.page||U):p.page=U,window.scrollTo({top:0,behavior:"instant"})}catch{Ne().add({title:"加载失败",color:"red",timeout:2e3})}finally{G.value=!1}}},de=async()=>{if(!(G.value||!p.hasMore)){G.value=!0;try{const U=p.page+1,j=await p.getMessages({page:U,pageSize:15});j&&Array.isArray(j.items)?(p.messages=j.items,p.page=j.page||U):p.page=U,window.scrollTo({top:0,behavior:"instant"})}catch{Ne().add({title:"加载失败",color:"red",timeout:2e3})}finally{G.value=!1}}};ot(()=>E.isLogin,U=>{U&&p.getMessages({page:1,pageSize:15})}),ot(()=>p.messages,async()=>{try{await rt(),B(),A()}catch(U){console.error("更新视图失败:",U)}},{deep:!0}),wi(()=>{window.Fancybox&&window.Fancybox.destroy()});const ve=async U=>{try{await navigator.clipboard.writeText(U),Ne().add({title:"复制成功",color:"green",timeout:2e3})}catch(j){console.error("复制失败:",j),Ne().add({title:"复制失败",color:"red",timeout:2e3})}},ke=ae(!1),be=ae(""),we=ae(null),Ae=ae(!1),We=U=>{if(we.value=U.id,be.value=U.content,U.image_url){const j=`

<!-- 附件图片(编辑时可删除) -->
![附件图片](${u}${U.image_url})
<!-- 附件图片结束 -->`;be.value+=j}ke.value=!0},me=async()=>{if(we.value){Ae.value=!0;try{const U=p.messages.find(K=>K.id===we.value);if(!U)return;let j=be.value;if(j=j.replace(/\n*<!-- 附件图片\(编辑时可删除\) -->\n!\[附件图片\]\(.*?\)\n<!-- 附件图片结束 -->\n*/g,""),j===U.content){Ne().add({title:"内容未修改",description:"请修改内容后再保存",color:"orange",timeout:2e3}),Ae.value=!1;return}const z=await fetch(`${u}/messages/${we.value}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({content:j,image_url:U.image_url})});if(!z.ok)throw new Error(`HTTP error! status: ${z.status}`);const te=await z.json();if(te.code===1){const K=p.messages.findIndex(Se=>Se.id===we.value);K!==-1&&(p.messages[K]={...p.messages[K],content:be.value,image_url:U.image_url}),ke.value=!1,Ne().add({title:"更新成功",color:"green",timeout:2e3})}else throw new Error(te.msg||"保存失败")}catch(U){console.error("更新消息失败:",U),Ne().add({title:"更新失败",color:"red",timeout:2e3})}finally{Ae.value=!1}}},N=async U=>{var j,z;try{const te=document.querySelector(`.content-container[data-msg-id="${U}"]`);if(!te)return;const K=(z=(j=te.querySelector(".markdown-preview"))==null?void 0:j.textContent)==null?void 0:z.trim(),Se=te.querySelector("img"),Ce=te.querySelector("video"),$e=te.querySelector("audio");if(!K&&!Se&&Ce||!K&&!Se&&$e){Ne().add({title:"此内容不可生成卡片",color:"orange",timeout:2e3});return}const ee=setTimeout(()=>{Ne().add({title:"生成超时",description:"卡片生成时间过长，请稍后重试",color:"red",timeout:3e3})},1e4),Oe=I.value[U];I.value[U]=!0,await rt();const Ie=document.createElement("div");Ie.style.cssText=`
  padding: 16px;
  background: transparent;
  border-radius: 12px;
  width: ${Se?"640px":"480px"};
  position: absolute;
  left: -9999px;
  top: 0;
  z-index: -1;
  overflow: visible;
  min-height: fit-content;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
  border: none;
`,document.body.appendChild(Ie);const Ze=te.cloneNode(!0),Ot=window.getComputedStyle(te),cn=Ot.backgroundColor&&Ot.backgroundColor!=="rgba(0, 0, 0, 0)"?Ot.backgroundColor:"#ffffff",$n=Ot.color||"#333";Ze.querySelectorAll(".text-center.mt-2, .bg-gradient-to-t").forEach(nt=>nt.remove()),Ze.style.cssText=`
      max-height: none;
      overflow: visible;
      padding: 0;
      margin: 0;
      background: ${cn};
      border-radius: 12px;
    `;const zt=Ze.querySelector(".overflow-y-hidden");zt&&(zt.className="",zt.style.cssText=`
        overflow: visible;
        max-height: none !important;
        height: auto !important;
        padding: 12px;
        line-height: 1.6;
        margin-bottom: 0;
        white-space: pre-wrap;
        background: ${cn};
        border-radius: 12px;
        font-size: 14px;
        color: ${$n};
      `),Ze.querySelectorAll("video, audio, iframe").forEach(nt=>{var Tt;const Ue=document.createElement("div");Ue.style.cssText=`
        padding: 15px;
        background: rgba(251, 146, 60, 0.1);
        border: 1px solid rgba(251, 146, 60, 0.3);
        border-radius: 8px;
        color: #fb923c;
        margin: 15px 0;
        word-break: break-all;
      `,nt instanceof HTMLVideoElement?Ue.innerHTML=`🎬 视频链接：${nt.src||"未知链接"}`:nt instanceof HTMLAudioElement?Ue.innerHTML=`🎵 音频链接：${nt.src||"未知链接"}`:nt instanceof HTMLIFrameElement&&(Ue.innerHTML=`🔗 嵌入内容链接：${nt.src||"未知链接"}`),(Tt=nt.parentNode)==null||Tt.replaceChild(Ue,nt)}),await(async()=>{const nt=Ze.querySelectorAll("img");await Promise.all(Array.from(nt).map(async Ue=>new Promise(Tt=>{const Ft=Ue.src;Ue.crossOrigin="anonymous",Ft.startsWith("/")?(Ue.src=`${u}${Ft}`,fetch(Ue.src,{credentials:"include"}).then(st=>st.blob()).then(st=>{Ue.src=URL.createObjectURL(st),Tt()}).catch(()=>{var st;console.error("图片加载失败:",Ft),(st=Ue.parentElement)==null||st.removeChild(Ue),Tt()})):Ue.complete?Tt():(Ue.onload=()=>Tt(),Ue.onerror=()=>{var st;console.error("图片加载失败:",Ft),(st=Ue.parentElement)==null||st.removeChild(Ue),Tt()})})))})(),Ie.appendChild(Ze);const Ln=document.createElement("div");Ln.style.cssText=`
    margin-top: 12px;
    padding-top: 12px;
    text-align: center;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: transparent;
  `,Ln.innerHTML=`
    <div style="color: #fb923c; font-size: 13px; margin-bottom: 4px; font-weight: 500;">
      ${d.siteConfig.cardFooterTitle}
    </div>
    <a href="https://note.noisework.cn" 
       target="_blank" 
       rel="noopener noreferrer" 
       style="color: rgba(255,255,255,0.5); text-decoration: none;">
      ${d.siteConfig.cardFooterSubtitle}
    </a>
  `,Ie.appendChild(Ln),await rt();const Si=await html2canvas(Ie,{backgroundColor:null,scale:2,useCORS:!0,allowTaint:!0,logging:!1,width:Ie.offsetWidth,height:Ie.scrollHeight,borderRadius:"16px",onclone:nt=>{const Ue=nt.querySelector(".content-container");Ue&&(Ue.style.cssText=`
            overflow: visible !important;
            max-height: none !important;
            height: auto !important;
            padding: 0;
            min-height: ${(zt==null?void 0:zt.scrollHeight)||0}px;
            background: ${cn};
            border-radius: 12px;
          `)}});clearTimeout(ee);const dn=document.createElement("a");dn.download=`message-${U}.png`,dn.href=Si.toDataURL("image/png"),dn.click(),document.body.removeChild(Ie),I.value[U]=Oe,Ne().add({title:"下载成功",color:"green",timeout:2e3})}catch(te){console.error("下载失败:",te),Ne().add({title:"下载失败",color:"red",timeout:2e3})}},X=ae(!1),Z=ae([]),Ee=async U=>{var j;try{const z=X.value?null:window.scrollY;if(console.debug("API返回的原始数据:",U),!U)throw new Error("API返回数据为空");let te=[],K=0;if(U.code===1?Array.isArray(U.data)?te=U.data:(j=U.data)!=null&&j.items&&(te=U.data.items):Array.isArray(U)&&(te=U),!Array.isArray(te))throw new Error("无效的数据格式");K=te.length,X.value=!0,Z.value=te,K===0?Ne().add({title:"未找到相关内容",color:"orange",timeout:2e3}):Ne().add({title:`找到 ${K} 条结果`,color:"green",timeout:2e3}),z!==null&&window.scrollTo({top:0,behavior:"smooth"}),await rt(),B(),A()}catch(z){console.error("处理搜索结果时出错:",z),Ne().add({title:"搜索失败",description:z.message||"处理搜索结果时发生错误",color:"red",timeout:2e3}),De()}},De=()=>{Z.value=[],X.value=!1,console.log("重置搜索 - searchResults:",Z.value),console.log("重置搜索 - isSearchMode:",X.value),rt(()=>{B(),A()})},V=je(()=>X.value&&Array.isArray(Z.value)?Z.value:p.messages||[]);return n({handleSearchResult:Ee}),ot(Z,U=>{console.log("searchResults变化:",U),rt(()=>{B(),A()})},{deep:!0,immediate:!0}),ot(X,U=>{console.log("isSearchMode变化:",U),rt(()=>{B(),A()})}),je(()=>({cardFooterTitle:d.siteConfig.cardFooterTitle,cardFooterSubtitle:d.siteConfig.cardFooterSubtitle,pageFooterHTML:d.siteConfig.pageFooterHTML,walineServerURL:d.siteConfig.walineServerURL})),(U,j)=>{const z=Ei,te=_t,K=pr,Se=ul,Ce=hr,$e=Ba;return ue(),pe(Lt,null,[$("div",Pc,[ye(V).length?_e("",!0):(ue(),pe("div",Rc,[ce(z,{name:"i-heroicons-inbox",class:"w-12 h-12 mx-auto mb-4"}),j[5]||(j[5]=$("p",null,"暂无消息内容",-1))])),$("div",Hc,[ye(X)?(ue(),pe("div",Ic,[$("p",Nc,"搜索结果 ("+Je(ye(Z).length)+" 条)",1),ce(te,{size:"sm",variant:"ghost",class:"text-gray-400 hover:text-orange-500",icon:"i-heroicons-arrow-left",onClick:M},{default:qe(()=>j[6]||(j[6]=[tt(" 返回完整列表 ")])),_:1})])):_e("",!0),$("div",jc,[ye(X)&&ye(Z).length===0?(ue(),pe("div",Bc,[ce(z,{name:"i-heroicons-magnifying-glass",class:"w-12 h-12 mx-auto mb-4"}),j[7]||(j[7]=$("p",null,"未找到相关内容",-1))])):_e("",!0),(ue(!0),pe(Lt,null,Wt(ye(V),ee=>{var Oe;return ue(),pe("div",{key:ee.id,class:"w-full h-auto overflow-hidden flex flex-col justify-between"},[$("div",zc,[$("div",Fc,[j[9]||(j[9]=$("div",{class:"w-2 h-2 rounded-full bg-orange-600 mr-2 flex-shrink-0"},null,-1)),$("div",Uc,[$("span",Vc,Je(O(ee.created_at)),1),j[8]||(j[8]=$("span",{class:"gradient-dot mx-2 flex-shrink-0"},"@",-1)),$("span",$c,Je(ee.username||"匿名用户"),1)])]),$("div",qc,[ee.private?(ue(),pe("div",Wc,[ce(z,{name:"i-mdi-lock-outline",class:"text-gray-400"})])):_e("",!0),ye(b)?(ue(),pe("div",{key:1,class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Ie=>We(ee),title:"编辑内容"},[ce(z,{name:"i-mdi-pencil-outline",class:"text-gray-400 hover:text-orange-500"})],8,Yc)):_e("",!0),$("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Ie=>ve(ee.content),title:"复制内容"},[ce(z,{name:"i-mdi-content-copy",class:"text-gray-400 hover:text-orange-500"})],8,Kc),$("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Ie=>N(ee.id),title:"下载为图片"},[ce(z,{name:"i-mdi-image-outline",class:"text-gray-400 hover:text-orange-500"})],8,Gc),$("div",{class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Ie=>v(ee.id),title:"评论"},[ce(z,{name:"i-mdi-comment-outline",class:"text-gray-400 hover:text-orange-500"})],8,Zc),ye(b)?(ue(),pe("div",{key:2,class:"w-5 h-5 cursor-pointer flex-shrink-0 transition-all duration-200 hover:scale-110",onClick:Ie=>x(ee.id),title:"删除"},[ce(z,{name:"i-mdi-paper-roll-outline",class:"text-gray-400 hover:text-orange-500"})],8,Xc)):_e("",!0)])]),$("div",Jc,[ee.image_url||ee.content?(ue(),pe("div",{key:0,class:pt(["content-container",ye(s)]),"data-msg-id":ee.id},[ee.image_url?(ue(),pe("img",{key:0,src:`${ye(u)}${ee.image_url}`,alt:"Image",class:"max-w-full object-cover rounded-lg mb-4",loading:"lazy",fetchpriority:U.index<3?"high":"low"},null,8,eu)):_e("",!0),ee.image_url&&ee.content?(ue(),pe("div",tu)):_e("",!0),$("div",{class:pt(["overflow-y-hidden relative",[{"max-h-[700px]":!ye(I)[ee.id]},ye(c)]])},[ce(Ha,{content:ee.content,enableGithubCard:((Oe=T.siteConfig)==null?void 0:Oe.enableGithubCard)===!0,onTagClick:k,"link-target":"_blank"},null,8,["content","enableGithubCard"]),ye(R)[ee.id]&&!ye(I)[ee.id]?(ue(),pe("div",{key:0,class:pt(["absolute bottom-0 left-0 right-0 h-32 bg-gradient-to-t",ye(f)])},null,2)):_e("",!0)],2),ye(R)[ee.id]?(ue(),pe("div",nu,[$("button",{onClick:Ie=>P(ee.id),class:pt(["expand-toggle-btn flex items-center justify-center space-x-1 mx-auto px-4 py-2 focus:outline-none transition-colors duration-200",ye(h)])},[$("span",null,Je(ye(I)[ee.id]?"收起内容":"展开全文"),1),ce(z,{name:ye(I)[ee.id]?"i-mdi-chevron-up":"i-mdi-chevron-down",class:"w-5 h-5"},null,8,["name"])],10,iu)])):_e("",!0)],10,Qc)):_e("",!0),al($("div",{class:pt(["mt-4",ye(m)])},[$("div",{id:`waline-${ee.id}`},null,8,ru)],2),[[ol,ye(g)===ee.id]])])])}),128))]),ye(X)?_e("",!0):(ue(),pe("div",au,[$("div",ou,[ye(p).page>1?(ue(),Bt(te,{key:0,color:"gray",variant:"outline",size:"xs",class:"rounded-full px-4 py-1.5 bg-[rgba(36,43,50,0.95)] text-white hover:text-white border-none shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",onClick:re,disabled:ye(G)},{default:qe(()=>[ce(z,{name:"i-heroicons-arrow-left",class:"mr-1 w-4 h-4"}),j[10]||(j[10]=tt(" 上一页 "))]),_:1},8,["disabled"])):_e("",!0),ye(p).hasMore?(ue(),Bt(te,{key:1,color:"gray",variant:"outline",size:"xs",class:"rounded-full px-4 py-1.5 bg-[rgba(36,43,50,0.95)] text-white hover:text-white border-none shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",onClick:de,disabled:ye(G)},{default:qe(()=>[j[11]||(j[11]=tt(" 下一页 ")),ce(z,{name:"i-heroicons-arrow-right",class:"ml-1 w-4 h-4"})]),_:1},8,["disabled"])):_e("",!0),ye(G)?(ue(),pe("span",su,"加载中...")):_e("",!0)]),$("div",lu,[$("span",cu,"第 "+Je(ye(p).page)+" 页",1),ce(K,{modelValue:ye(y),"onUpdate:modelValue":j[0]||(j[0]=ee=>qi(y)?y.value=ee:null),type:"number",min:"1",max:ye(C),class:"w-12 text-center text-sm",placeholder:"#",onKeyup:Na(S,["enter"])},null,8,["modelValue","max"]),ce(te,{size:"xs",color:"gray",variant:"ghost",class:"text-gray-400 hover:text-orange-500 text-sm",onClick:S},{default:qe(()=>j[12]||(j[12]=[tt(" 跳转 ")])),_:1})])])),!ye(X)&&ye(p).messages.length>0&&!ye(p).hasMore?(ue(),pe("div",uu,[ce(z,{name:"i-fluent-emoji-flat-confetti-ball",size:"lg"}),j[13]||(j[13]=tt(" 加载完毕~ "))])):_e("",!0)]),T.siteConfig.pageFooterHTML?(ue(),pe("div",{key:2,innerHTML:T.siteConfig.pageFooterHTML},null,8,fu)):(ue(),pe("div",du,j[14]||(j[14]=[tt(" 来自"),$("a",{href:"https://www.noisework.cn",target:"_blank",rel:"noopener noreferrer",class:"text-orange-400 hover:text-orange-500"},"Noise",-1),tt(" 使用"),$("a",{href:"https://github.com/lin-snow/Ech0",target:"_blank",rel:"noopener noreferrer",class:"text-orange-400 hover:text-orange-500"},"Ech0",-1),tt("发布 ")])))]),ce($e,{modelValue:ye(ke),"onUpdate:modelValue":j[4]||(j[4]=ee=>qi(ke)?ke.value=ee:null),ui:{width:"sm:max-w-2xl"}},{default:qe(()=>[ce(Ce,null,{header:qe(()=>[$("div",hu,[j[15]||(j[15]=$("h3",{class:"text-lg font-medium"},"编辑内容",-1)),ce(te,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:j[1]||(j[1]=ee=>ke.value=!1)})])]),footer:qe(()=>[$("div",bu,[ce(te,{color:"gray",variant:"outline",onClick:j[3]||(j[3]=ee=>ke.value=!1),class:"text-white"},{default:qe(()=>j[17]||(j[17]=[tt(" 取消 ")])),_:1}),ce(te,{color:"orange",onClick:me,loading:ye(Ae),class:"text-white"},{default:qe(()=>j[18]||(j[18]=[tt(" 保存 ")])),_:1},8,["loading"])])]),default:qe(()=>{var ee;return[$("div",pu,[ce(Se,{modelValue:ye(be),"onUpdate:modelValue":j[2]||(j[2]=Oe=>qi(be)?be.value=Oe:null),placeholder:"编辑内容...",rows:"10",class:"font-mono text-sm"},null,8,["modelValue"]),$("div",mu,[j[16]||(j[16]=$("div",{class:"text-sm text-gray-500 mb-2"},"预览：",-1)),$("div",gu,[$("div",vu,[ce(Ha,{content:ye(be),enableGithubCard:((ee=T.siteConfig)==null?void 0:ee.enableGithubCard)===!0},null,8,["content","enableGithubCard"])])])])])]}),_:1})]),_:1},8,["modelValue"])],64)}}}),wu=_n(yu,[["__scopeId","data-v-9b815571"]]),Eu={class:"heatmap-header"},Su={class:"heatmap-legend"},Cu={class:"legend-colors"},Tu={class:"calendar-wrapper"},ku={class:"month-labels"},Mu={class:"weekday-labels"},xu={class:"heatmap-grid"},_u=["title"],Lu=St({__name:"heatmap",setup(T){const n=ae([]),a=ae([]),s=ae(null),c=je(()=>{if(!n.value.length)return Array(12).fill("").map((k,M)=>`${M+1}月`);const u=n.value.map(k=>new Date(k.date)),p=new Date(Math.min(...u)),g=[];let E=new Date(p);E.setDate(1);let b=E.getFullYear();for(let k=0;k<12;k++){const M=E.getMonth(),x=E.getFullYear();x!==b||k===0?(g.push(`${x}年${M+1}月`),b=x):g.push(`${M+1}月`),E.setMonth(M+1)}return g}),f=["日","一","二","三","四","五","六"],m=u=>["#9be9a8","#40c463","#30a14e","#216e39","#0e4429"][Math.min(u-1,4)]||"#ebedf0",h=u=>u.count?m(u.level):"rgba(235, 237, 240, 0.4)",y=async()=>{try{const p=await(await fetch("/api/messages/calendar")).json();p&&p.code===1&&p.data&&p.data.length>0?(n.value=p.data,d()):C()}catch(u){console.error("获取热力图数据失败:",u),C()}},C=()=>{const u=new Date,p=new Date(u);p.setMonth(u.getMonth()-11),p.setDate(1);const g=[];let E=new Date(p);for(;E<=u;){const b=Math.random()>.7?Math.floor(Math.random()*10)+1:0;g.push({date:S(E),count:b}),E.setDate(E.getDate()+1)}n.value=g,d()},S=u=>{const p=u.getFullYear(),g=String(u.getMonth()+1).padStart(2,"0"),E=String(u.getDate()).padStart(2,"0");return`${p}-${g}-${E}`},d=()=>{if(!n.value.length)return;const u=n.value.map(x=>new Date(x.date)),p=new Date(Math.min(...u));new Date(Math.max(...u));const g=new Date(p);g.setDate(1);const E=new Date(g);E.setMonth(g.getMonth()+11),E.setDate(E.getDate()+(6-E.getDay()));const b=new Map;n.value.forEach(x=>{x&&x.date&&x.count!==void 0&&b.set(x.date,x.count)});const k=[];let M=new Date(g);for(M.setDate(M.getDate()-M.getDay());M<=E;){const x=[];for(let A=0;A<7;A++){const v=S(M),O=b.get(v)||0;x.push({date:v,count:O,level:O?Math.min(Math.ceil(O/2),5):0}),M.setDate(M.getDate()+1)}k.push(x)}a.value=k};return jt(()=>{y()}),(u,p)=>{const g=hr;return ue(),Bt(g,{class:"mx-auto sm:max-w-2xl hover:shadow-md backdrop-blur-sm bg-black/40 shadow-lg text-white"},{default:qe(()=>[$("div",Eu,[p[2]||(p[2]=$("h3",null,"内容发布日历",-1)),$("div",Su,[p[0]||(p[0]=$("span",null,"少",-1)),$("div",Cu,[(ue(),pe(Lt,null,Wt(5,E=>$("div",{key:E,style:sn({backgroundColor:m(E)})},null,4)),64))]),p[1]||(p[1]=$("span",null,"多",-1))])]),$("div",Tu,[$("div",{class:"calendar-container",ref_key:"calendarContainer",ref:s},[$("div",ku,[(ue(!0),pe(Lt,null,Wt(c.value,(E,b)=>(ue(),pe("div",{class:"month-label",key:b},Je(E),1))),128))]),$("div",Mu,[(ue(),pe(Lt,null,Wt(f,E=>$("div",{class:"weekday-label",key:E},Je(E),1)),64))]),$("div",xu,[(ue(!0),pe(Lt,null,Wt(a.value,(E,b)=>(ue(),pe("div",{key:b,class:"heatmap-week"},[(ue(!0),pe(Lt,null,Wt(E,(k,M)=>(ue(),pe("div",{key:M,class:"heatmap-day",style:sn({backgroundColor:h(k)}),title:`${k.date}: ${k.count||0} 条内容`},null,12,_u))),128))]))),128))])],512)])]),_:1})}}}),Au=_n(Lu,[["__scopeId","data-v-4da783b8"]]),Du={class:"tags-container mx-auto w-full sm:max-w-2xl"},Ou={class:"relative"},Pu={class:"tags-wrapper"},Ru={class:"tags-scroll"},Hu=["onClick"],Iu={class:"tag-count"},Nu=St({__name:"TagList",props:{tags:{type:Array,default:()=>[]}},emits:["tagClick","updateTags"],setup(T,{emit:n}){const a=n,s=ae(!1),c=ae(Date.now()),f=T,m=je(()=>{const C=/[/?=&]/,S=/^(song|video|playlist)\?id=\d+$/,d=new Map;return f.tags.reduce((u,p)=>(d.has(p.name)||!C.test(p.name)&&!S.test(p.name)&&(d.set(p.name,!0),u.push(p)),u),[])},{}),h=C=>{a("tagClick",C)},y=async()=>{s.value||(s.value=!0,c.value=Date.now(),a("updateTags"),setTimeout(()=>{s.value=!1},1e3))};return(C,S)=>{const d=Ei;return ue(),pe("div",Du,[$("div",Ou,[$("div",Pu,[$("div",Ru,[(ue(!0),pe(Lt,null,Wt(m.value,u=>(ue(),pe("span",{key:u.name+c.value,class:"tag-item",onClick:p=>h(u.name)},[tt(" #"+Je(u.name)+" ",1),$("span",Iu,"("+Je(u.count)+")",1)],8,Hu))),128))])]),$("div",{class:"absolute -right-1 top-1/2 -translate-y-1/2 p-2 cursor-pointer transition-all duration-200 hover:scale-110 z-10",onClick:y,title:"刷新标签"},[ce(d,{name:"i-mdi-refresh",class:pt(["w-5 h-5 text-gray-400 hover:text-orange-500",{"animate-spin":s.value}])},null,8,["class"])]),S[0]||(S[0]=$("div",{class:"scroll-fade"},null,-1))])])}}}),ju=_n(Nu,[["__scopeId","data-v-a469a53f"]]),Bu=window.setInterval,zu={key:0,class:"loading"},Fu={class:"moments-header"},Uu={class:"header-title"},Vu={class:"profile-info"},$u=["src","alt"],qu={class:"profile-text"},Wu={class:"title"},Yu={class:"description"},Ku={key:0,class:"mx-auto sm:max-w-2xl mb-4"},Qu=St({__name:"index",setup(T){const n=ae(null),a=O=>{console.log("接收到搜索结果:",O),n.value&&n.value.handleSearchResult(O)},s=ae(!1),c=ae(typeof window<"u"&&localStorage.getItem("contentTheme")||"dark");pi("showHeatmap",s),pi("contentTheme",c),pi("toggleContentTheme",()=>{c.value=c.value==="dark"?"light":"dark",typeof window<"u"&&(localStorage.setItem("contentTheme",c.value),document.documentElement.className=c.value==="dark"?"dark":"")}),ot(s,O=>{console.log("index.vue 中热力图状态变化:",O)}),ia({meta:[{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}]});const f=ae({siteTitle:"",subtitleText:"",avatarURL:"",username:"",description:"",backgrounds:[],cardFooterTitle:"",cardFooterSubtitle:"",pageFooterHTML:"",rssTitle:"",rssDescription:"",rssAuthorName:"",rssFaviconURL:"",enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:""}),m=je(()=>({"--bg-image":`url(${S.value||f.value.backgrounds[0]})`})),h=je(()=>({"background-image":`url(${S.value||f.value.backgrounds[0]})`,"background-size":"cover","background-position":"center"})),y={siteTitle:"Noise的说说笔记",subtitleText:"欢迎访问，点击头像可更换封面背景！",avatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",username:"Noise",description:"执迷不悟",backgrounds:["https://s2.loli.net/2025/03/27/KJ1trnU2ksbFEYM.jpg","https://s2.loli.net/2025/03/27/MZqaLczCvwjSmW7.jpg","https://s2.loli.net/2025/03/27/UMijKXwJ9yTqSeE.jpg","https://s2.loli.net/2025/03/27/WJQIlkXvBg2afcR.jpg","https://s2.loli.net/2025/03/27/oHNQtf4spkq2iln.jpg","https://s2.loli.net/2025/03/27/PMRuX5loc6Uaimw.jpg","https://s2.loli.net/2025/03/27/U2WIslbNyTLt4rD.jpg","https://s2.loli.net/2025/03/27/xu1jZL5Og4pqT9d.jpg","https://s2.loli.net/2025/03/27/OXqwzZ6v3PVIns9.jpg","https://s2.loli.net/2025/03/27/HGuqlE6apgNywbh.jpg","https://s2.loli.net/2025/03/26/d7iyuPYA8cRqD1K.jpg","https://s2.loli.net/2025/03/27/wYy12qDMH6bGJOI.jpg","https://s2.loli.net/2025/03/27/y67m2k5xcSdTsHN.jpg"],cardFooterTitle:"Noise·说说·笔记~",cardFooterSubtitle:"note.noisework.cn",pageFooterHTML:'<div class="text-center text-xs text-gray-400 py-4">来自<a href="https://www.noisework.cn" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Noise</a> 使用<a href="https://github.com/lin-snow/Ech0" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Ech0</a>发布</div>',rssTitle:"Noise的说说笔记",rssDescription:"一个说说笔记~",rssAuthorName:"Noise",rssFaviconURL:"/favicon.ico",enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",walineServerURL:"https://s9cewscb.lc-cn-n1-shared.com"},C=async()=>{var O,I;try{f.value={...y};const R=await fetch("/api/frontend/config",{credentials:"include",headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}});if(!R.ok)throw new Error("Network response was not ok");const P=await R.json();if(console.log("获取到的配置数据:",P),(O=P==null?void 0:P.data)!=null&&O.frontendSettings){const B=P.data.frontendSettings,W=["enableGithubCard","pwaEnabled"];Object.keys(f.value).forEach(re=>{if(B[re]!==null&&B[re]!==void 0)if(re==="backgrounds"&&Array.isArray(B[re]))f.value.backgrounds=[...B[re]];else if(W.includes(re)){const de=B[re];f.value[re]=de===!0||de==="true"}else{const de=B[re];f.value[re]=typeof de=="string"?de.trim():de}});const G=(B.defaultContentTheme||"dark").trim();typeof window<"u"&&!localStorage.getItem("contentTheme")?(c.value=G==="light"?"light":"dark",document.documentElement.className=c.value==="dark"?"dark":""):typeof window<"u"&&(document.documentElement.className=c.value==="dark"?"dark":"")}if((I=f.value.backgrounds)!=null&&I.length||(f.value.backgrounds=[...y.backgrounds]),f.value.backgrounds.length>0){const B=Math.floor(Math.random()*f.value.backgrounds.length);S.value=f.value.backgrounds[B]}d.value=!0}catch(R){console.error("获取配置失败:",R),f.value={...y},d.value=!0}},S=ae(""),d=ae(!1),u=ae(!1),p=async O=>{const I=R=>new Promise(P=>{const B=new Image;B.src=R,B.onload=()=>P(R),B.onerror=()=>P(null)});await Promise.all(O.map(R=>I(R)))};jt(()=>{window.addEventListener("frontend-config-updated",async O=>{var R;const I=(O==null?void 0:O.detail)||{};if(typeof I.value=="string"&&I.key==="defaultContentTheme"&&typeof window<"u"&&!localStorage.getItem("contentTheme")&&(c.value=I.value==="light"?"light":"dark",document.documentElement.className=c.value==="dark"?"dark":""),await C(),((R=f.value.backgrounds)==null?void 0:R.length)>0){const P=Math.floor(Math.random()*f.value.backgrounds.length),B=f.value.backgrounds[P];S.value=B}})}),hi(()=>{window.removeEventListener("frontend-config-updated",C)});const g=async()=>{if(u.value)return;u.value=!0;const O=Math.floor(Math.random()*f.value.backgrounds.length),I=f.value.backgrounds[O];if(I===S.value){u.value=!1;return}const R=`${I}?imageView2/2/w/10/blur/1/q/10`;S.value=R,requestAnimationFrame(()=>{const P=new Image;P.src=I,P.onload=()=>{requestAnimationFrame(()=>{S.value=I,u.value=!1})},P.onerror=()=>{u.value=!1}})},E=()=>{const O=(f.value.pwaTitle||f.value.siteTitle||"说说笔记").trim(),I="/favicon.ico",R=(f.value.pwaDescription||f.value.description||"").trim();ia({title:O,meta:[{name:"description",content:R},{name:"theme-color",content:"#000000"}],link:[{rel:"icon",href:I},...f.value.pwaEnabled?[{rel:"manifest",href:"/site.webmanifest"}]:[]]})};ot(()=>[f.value.pwaEnabled,f.value.pwaTitle,f.value.pwaIconURL,f.value.pwaDescription,f.value.siteTitle,f.value.rssFaviconURL,f.value.description],()=>{E()},{immediate:!0});const b=ae(null),k=ae([]),M=async()=>{await x()},x=async()=>{try{const I=await(await fetch(`${on().public.baseApi}/messages/tags`,{headers:{"Cache-Control":"no-cache",Pragma:"no-cache"}})).json();I.code===1&&(k.value=I.data||[])}catch(O){console.error("获取标签失败:",O),k.value=[]}};jt(()=>{const O=()=>C();window.addEventListener("frontend-config-updated",O),C(),hi(()=>window.removeEventListener("frontend-config-updated",O))});const A=async O=>{try{const I=encodeURIComponent(O.trim()),R=await fetch(`${on().public.baseApi}/messages/tags/${I}`,{credentials:"include",headers:{Accept:"application/json"}});if(!R.ok)throw new Error(`HTTP error! status: ${R.status}`);const P=await R.json();if(P.code===1&&Array.isArray(P.data))n.value&&n.value.handleSearchResult(P.data);else throw new Error(P.msg||"获取标签内容失败")}catch(I){console.error("获取标签消息失败:",I),Ne().add({title:"获取标签消息失败",description:I.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},v=()=>{if(!b.value)return;let O=0,I=!1,R=!1;return Bu(()=>{R||(I?(O--,b.value.textContent=f.value.subtitleText.slice(0,O),O<=0&&(R=!0,b.value.textContent="",setTimeout(()=>{I=!1,R=!1,O=0},1e3))):(b.value.textContent=f.value.subtitleText.slice(0,O+1),O++,O>=f.value.subtitleText.length&&(R=!0,setTimeout(()=>{I=!0,R=!1},2e3))))},100)};return jt(async()=>{try{if(d.value=!1,window.requestIdleCallback=window.requestIdleCallback||(I=>setTimeout(I,1)),await C(),ra(async()=>{await x(),await p(f.value.backgrounds)}),f.value.backgrounds.length>0){const I=f.value.backgrounds[Math.floor(Math.random()*f.value.backgrounds.length)],R=`${I}?imageView2/2/w/100/q/30`;S.value=R,ra(async()=>{await p(f.value.backgrounds)});const P=new Image;P.src=I,P.onload=()=>{requestAnimationFrame(()=>{S.value=I,d.value=!0})}}const O=v();hi(()=>{O&&clearInterval(O)}),window.addEventListener("frontend-config-updated",async I=>{var R;if(await C(),((R=f.value.backgrounds)==null?void 0:R.length)>0){const P=Math.floor(Math.random()*f.value.backgrounds.length),B=f.value.backgrounds[P];S.value=B}})}catch(O){console.error("初始化失败:",O),d.value=!0}}),(O,I)=>{const R=sl;return ue(),pe("div",{class:"background-container",style:sn(m.value)},[d.value?_e("",!0):(ue(),pe("div",zu,I[1]||(I[1]=[$("div",{class:"rainbow-spinner"},null,-1),$("div",{class:"loading-text"},"加载中...",-1)]))),$("div",{class:pt(["content-wrapper",{"gpu-accelerated":!0}])},[ce(R,{class:"container-fixed py-2 pb-4 my-4"},{default:qe(()=>[$("div",Fu,[$("div",{class:"header-image",style:sn(h.value)},[$("h1",Uu,Je(f.value.siteTitle),1),$("div",{ref_key:"subtitleEl",ref:b,class:"header-subtitle"},Je(f.value.subtitleText),513),$("div",Vu,[$("img",{class:"avatar",onClick:g,src:f.value.avatarURL,alt:f.value.username},null,8,$u),$("div",qu,[$("div",Wu,Je(f.value.username),1),$("div",Yu,Je(f.value.description),1)])])],4)]),s.value?(ue(),pe("div",Ku,[ce(Au)])):_e("",!0),ce(Oc,{onSearchResult:a}),k.value&&k.value.length>0?(ue(),Bt(ju,{key:1,tags:k.value,onTagClick:A,onUpdateTags:M},null,8,["tags"])):_e("",!0),ce(wu,{ref_key:"messageList",ref:n,class:"message-list-container","site-config":f.value,"target-message-id":O.targetMessageId},null,8,["site-config","target-message-id"])]),_:1}),ce(dl),ce(so,{modelValue:O.showSearchModal,"onUpdate:modelValue":I[0]||(I[0]=P=>O.showSearchModal=P),onSearchResult:a},null,8,["modelValue"])])],4)}}});export{Qu as default};
