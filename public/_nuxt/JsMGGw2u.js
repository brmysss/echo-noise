var lc=Object.defineProperty;var cc=(p,e,r)=>e in p?lc(p,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):p[e]=r;var Ai=(p,e,r)=>cc(p,typeof e!="symbol"?e+"":e,r);import{s as uc,u as dc,a as ir,r as G,b as fc,t as _r,g as hc,o as pc,c as ci,w as Et,d as vo,e as mc,f as gc,h as ve,i as he,j as Ri,k as yr,l as vc,m as Wa,n as ar,_ as Cn,p as rn,q as ae,v as J,x as aa,y as gt,z as qe,A as oa,B as Ya,C as os,D as ss,E as zt,F as bc,G as Me,H as be,I as te,J as Ce,K as I,L as Ut,M as Qt,N as Lt,T as yc,O as wc,P as kc,Q as kr,R as Ec,S as ls,U as Ke,V as Un,W as bt,X as Ur,Y as Ni,Z as cs,$ as gn,a0 as $i,a1 as da,a2 as fi,a3 as us,a4 as Mr,a5 as wi,a6 as rr,a7 as Bi,a8 as Gn,a9 as Ii,aa as zr,ab as Sc,ac as ds,ad as ya,ae as fs,af as xc,ag as bo,ah as yo}from"./7KMhTGMC.js";import{u as wo,_ as fa,a as Cc}from"./BTvwW0nt.js";import{_ as _c,a as Tc,b as hs,N as Mc}from"./Chx1geq6.js";import{_ as Ac}from"./nZ3d8Yso.js";import{_ as ha}from"./DXwWcezG.js";import{s as Xi}from"./x_rD_Ya3.js";const Lc=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Dc=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Oc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Li=[];let Pc=class{constructor(){Ai(this,"_data",new Fr);Ai(this,"_hash",new Fr([...Lc]));Ai(this,"_nDataBytes",0);Ai(this,"_minBufferSize",0)}finalize(e){e&&this._append(e);const r=this._nDataBytes*8,s=this._data.sigBytes*8;return this._data.words[s>>>5]|=128<<24-s%32,this._data.words[(s+64>>>9<<4)+14]=Math.floor(r/4294967296),this._data.words[(s+64>>>9<<4)+15]=r,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(e,r){const s=this._hash.words;let l=s[0],d=s[1],m=s[2],u=s[3],g=s[4],S=s[5],k=s[6],h=s[7];for(let f=0;f<64;f++){if(f<16)Li[f]=e[r+f]|0;else{const T=Li[f-15],M=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,v=Li[f-2],D=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;Li[f]=M+Li[f-7]+D+Li[f-16]}const b=g&S^~g&k,y=l&d^l&m^d&m,E=(l<<30|l>>>2)^(l<<19|l>>>13)^(l<<10|l>>>22),w=(g<<26|g>>>6)^(g<<21|g>>>11)^(g<<7|g>>>25),C=h+w+b+Dc[f]+Li[f],_=E+y;h=k,k=S,S=g,g=u+C|0,u=m,m=d,d=l,l=C+_|0}s[0]=s[0]+l|0,s[1]=s[1]+d|0,s[2]=s[2]+m|0,s[3]=s[3]+u|0,s[4]=s[4]+g|0,s[5]=s[5]+S|0,s[6]=s[6]+k|0,s[7]=s[7]+h|0}_append(e){typeof e=="string"&&(e=Fr.fromUtf8(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes}_process(e){let r,s=this._data.sigBytes/64;e?s=Math.ceil(s):s=Math.max((s|0)-this._minBufferSize,0);const l=s*16,d=Math.min(l*4,this._data.sigBytes);if(l){for(let m=0;m<l;m+=16)this._doProcessBlock(this._data.words,m);r=this._data.words.splice(0,l),this._data.sigBytes-=d}return new Fr(r,d)}},Fr=class ps{constructor(e,r){Ai(this,"words");Ai(this,"sigBytes");e=this.words=e||[],this.sigBytes=r===void 0?e.length*4:r}static fromUtf8(e){const r=unescape(encodeURIComponent(e)),s=r.length,l=[];for(let d=0;d<s;d++)l[d>>>2]|=(r.charCodeAt(d)&255)<<24-d%4*8;return new ps(l,s)}toBase64(){const e=[];for(let r=0;r<this.sigBytes;r+=3){const s=this.words[r>>>2]>>>24-r%4*8&255,l=this.words[r+1>>>2]>>>24-(r+1)%4*8&255,d=this.words[r+2>>>2]>>>24-(r+2)%4*8&255,m=s<<16|l<<8|d;for(let u=0;u<4&&r*8+u*6<this.sigBytes*8;u++)e.push(Oc.charAt(m>>>6*(3-u)&63))}return e.join("")}concat(e){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let r=0;r<e.sigBytes;r++){const s=e.words[r>>>2]>>>24-r%4*8&255;this.words[this.sigBytes+r>>>2]|=s<<24-(this.sigBytes+r)%4*8}else for(let r=0;r<e.sigBytes;r+=4)this.words[this.sigBytes+r>>>2]=e.words[r>>>2];this.sigBytes+=e.sigBytes}};function Rc(p){return new Pc().finalize(p).toBase64()}function Ic(p){return Rc(uc(p))}const Hc=p=>p==="defer"||p===!1;function Nc(...p){var E;const e=typeof p[p.length-1]=="string"?p.pop():void 0;typeof p[0]!="string"&&p.unshift(e);let[r,s,l={}]=p;if(typeof r!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof s!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const d=dc(),m=s,u=()=>ir.value,g=()=>d.isHydrating?d.payload.data[r]:d.static.data[r];l.server??(l.server=!0),l.default??(l.default=u),l.getCachedData??(l.getCachedData=g),l.lazy??(l.lazy=!1),l.immediate??(l.immediate=!0),l.deep??(l.deep=ir.deep),l.dedupe??(l.dedupe="cancel");const S=l.getCachedData(r,d),k=S!=null;if(!d._asyncData[r]||!l.immediate){(E=d.payload._errors)[r]??(E[r]=ir.errorValue);const w=l.deep?G:fc;d._asyncData[r]={data:w(k?S:l.default()),pending:G(!k),error:_r(d.payload._errors,r),status:G("idle"),_default:l.default}}const h={...d._asyncData[r]};delete h._default,h.refresh=h.execute=(w={})=>{if(d._asyncDataPromises[r]){if(Hc(w.dedupe??l.dedupe))return d._asyncDataPromises[r];d._asyncDataPromises[r].cancelled=!0}if(w._initial||d.isHydrating&&w._initial!==!1){const _=w._initial?S:l.getCachedData(r,d);if(_!=null)return Promise.resolve(_)}h.pending.value=!0,h.status.value="pending";const C=new Promise((_,T)=>{try{_(m(d))}catch(M){T(M)}}).then(async _=>{if(C.cancelled)return d._asyncDataPromises[r];let T=_;l.transform&&(T=await l.transform(_)),l.pick&&(T=$c(T,l.pick)),d.payload.data[r]=T,h.data.value=T,h.error.value=ir.errorValue,h.status.value="success"}).catch(_=>{if(C.cancelled)return d._asyncDataPromises[r];h.error.value=gc(_),h.data.value=ve(l.default()),h.status.value="error"}).finally(()=>{C.cancelled||(h.pending.value=!1,delete d._asyncDataPromises[r])});return d._asyncDataPromises[r]=C,d._asyncDataPromises[r]},h.clear=()=>jc(d,r);const f=()=>h.refresh({_initial:!0}),b=l.server!==!1&&d.payload.serverRendered;{const w=hc();if(w&&b&&l.immediate&&!w.sp&&(w.sp=[]),w&&!w._nuxtOnBeforeMountCbs){w._nuxtOnBeforeMountCbs=[];const T=w._nuxtOnBeforeMountCbs;pc(()=>{T.forEach(M=>{M()}),T.splice(0,T.length)}),ci(()=>T.splice(0,T.length))}b&&d.isHydrating&&(h.error.value||S!=null)?(h.pending.value=!1,h.status.value=h.error.value?"error":"success"):w&&(d.payload.serverRendered&&d.isHydrating||l.lazy)&&l.immediate?w._nuxtOnBeforeMountCbs.push(f):l.immediate&&f();const C=mc();if(l.watch){const T=Et(l.watch,()=>h.refresh());C&&vo(T)}const _=d.hook("app:data:refresh",async T=>{(!T||T.includes(r))&&await h.refresh()});C&&vo(_)}const y=Promise.resolve(d._asyncDataPromises[r]).then(()=>h);return Object.assign(y,h),y}function jc(p,e){e in p.payload.data&&(p.payload.data[e]=void 0),e in p.payload._errors&&(p.payload._errors[e]=ir.errorValue),p._asyncData[e]&&(p._asyncData[e].data.value=void 0,p._asyncData[e].error.value=ir.errorValue,p._asyncData[e].pending.value=!1,p._asyncData[e].status.value="idle"),e in p._asyncDataPromises&&(p._asyncDataPromises[e]&&(p._asyncDataPromises[e].cancelled=!0),p._asyncDataPromises[e]=void 0)}function $c(p,e){const r={};for(const s of e)r[s]=p[s];return r}function Bc(p,e,r){const[s={},l]=typeof e=="string"?[{},e]:[e,r],d=he(()=>Ri(p)),m=s.key||Ic([l,typeof d.value=="string"?d.value:"",...Uc(s)]);if(!m||typeof m!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+m);const u=m===l?"$f"+m:m;if(!s.baseURL&&typeof d.value=="string"&&d.value[0]==="/"&&d.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:g,lazy:S,default:k,transform:h,pick:f,watch:b,immediate:y,getCachedData:E,deep:w,dedupe:C,..._}=s,T=yr({...vc,..._,cache:typeof s.cache=="boolean"?void 0:s.cache}),M={server:g,lazy:S,default:k,transform:h,pick:f,immediate:y,getCachedData:E,deep:w,dedupe:C,watch:b===!1?[]:[T,d,...b||[]]};let v;return Nc(u,()=>{var $;($=v==null?void 0:v.abort)==null||$.call(v,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),v=typeof AbortController<"u"?new AbortController:{};const N=Ri(s.timeout);let V;return N&&(V=setTimeout(()=>v.abort(new DOMException("Request aborted due to timeout.","AbortError")),N),v.signal.onabort=()=>clearTimeout(V)),(s.$fetch||globalThis.$fetch)(d.value,{signal:v.signal,...T}).finally(()=>{clearTimeout(V)})},M)}function Uc(p){var r;const e=[((r=Ri(p.method))==null?void 0:r.toUpperCase())||"GET",Ri(p.baseURL)];for(const s of[p.params||p.query]){const l=Ri(s);if(!l)continue;const d={};for(const[m,u]of Object.entries(l))d[Ri(m)]=Ri(u);e.push(d)}return e}const zc={base:"invisible before:visible before:block before:rotate-45 before:z-[-1] before:w-2 before:h-2",ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-800",rounded:"before:rounded-sm",background:"before:bg-gray-200 dark:before:bg-gray-800",shadow:"before:shadow",placement:"group-data-[popper-placement*='right']:-left-1 group-data-[popper-placement*='left']:-right-1 group-data-[popper-placement*='top']:-bottom-1 group-data-[popper-placement*='bottom']:-top-1"},Fc={base:"inline-flex items-center justify-center text-gray-900 dark:text-white",padding:"px-1",size:{xs:"h-4 min-w-[16px] text-[10px]",sm:"h-5 min-w-[20px] text-[11px]",md:"h-6 min-w-[24px] text-[12px]"},rounded:"rounded",font:"font-medium font-sans",background:"bg-gray-100 dark:bg-gray-800",ring:"ring-1 ring-gray-300 dark:ring-gray-700 ring-inset",default:{size:"sm"}},Vc={base:"mx-auto",padding:"px-4 sm:px-6 lg:px-8",constrained:"max-w-7xl"},qc={wrapper:"relative inline-flex",container:"z-20 group",width:"max-w-xs",background:"bg-white dark:bg-gray-900",color:"text-gray-900 dark:text-white",shadow:"shadow",rounded:"rounded",ring:"ring-1 ring-gray-200 dark:ring-gray-800",base:"[@media(pointer:coarse)]:hidden h-6 px-2 py-1 text-xs font-normal truncate relative",shortcuts:"hidden md:inline-flex flex-shrink-0 gap-0.5",middot:"mx-1 text-gray-700 dark:text-gray-200",transition:{enterActiveClass:"transition ease-out duration-200",enterFromClass:"opacity-0 translate-y-1",enterToClass:"opacity-100 translate-y-0",leaveActiveClass:"transition ease-in duration-150",leaveFromClass:"opacity-100 translate-y-0",leaveToClass:"opacity-0 translate-y-1"},popper:{strategy:"fixed"},default:{openDelay:0,closeDelay:0},arrow:{...zc,base:"[@media(pointer:coarse)]:hidden invisible before:visible before:block before:rotate-45 before:z-[-1] before:w-2 before:h-2"}},wa=Wa(ar.ui.strategy,ar.ui.kbd,Fc),Wc=rn({inheritAttrs:!1,props:{value:{type:String,default:null},size:{type:String,default:()=>wa.default.size,validator(p){return Object.keys(wa.size).includes(p)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(p){const{ui:e,attrs:r}=Ya("kbd",_r(p,"ui"),wa),s=he(()=>os(ss(e.value.base,e.value.size[p.size],e.value.padding,e.value.rounded,e.value.font,e.value.background,e.value.ring),p.class));return{ui:e,attrs:r,kbdClass:s}}});function Yc(p,e,r,s,l,d){return J(),ae("kbd",oa({class:p.kbdClass},p.attrs),[aa(p.$slots,"default",{},()=>[gt(qe(p.value),1)])],16)}const ms=Cn(Wc,[["render",Yc]]);function xn(p){if(p==null)return window;if(p.toString()!=="[object Window]"){var e=p.ownerDocument;return e&&e.defaultView||window}return p}function Fi(p){var e=xn(p).Element;return p instanceof e||p instanceof Element}function Pn(p){var e=xn(p).HTMLElement;return p instanceof e||p instanceof HTMLElement}function Ka(p){if(typeof ShadowRoot>"u")return!1;var e=xn(p).ShadowRoot;return p instanceof e||p instanceof ShadowRoot}var Ui=Math.max,sa=Math.min,or=Math.round;function Ua(){var p=navigator.userAgentData;return p!=null&&p.brands&&Array.isArray(p.brands)?p.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function gs(){return!/^((?!chrome|android).)*safari/i.test(Ua())}function sr(p,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var s=p.getBoundingClientRect(),l=1,d=1;e&&Pn(p)&&(l=p.offsetWidth>0&&or(s.width)/p.offsetWidth||1,d=p.offsetHeight>0&&or(s.height)/p.offsetHeight||1);var m=Fi(p)?xn(p):window,u=m.visualViewport,g=!gs()&&r,S=(s.left+(g&&u?u.offsetLeft:0))/l,k=(s.top+(g&&u?u.offsetTop:0))/d,h=s.width/l,f=s.height/d;return{width:h,height:f,top:k,right:S+h,bottom:k+f,left:S,x:S,y:k}}function Ga(p){var e=xn(p),r=e.pageXOffset,s=e.pageYOffset;return{scrollLeft:r,scrollTop:s}}function Kc(p){return{scrollLeft:p.scrollLeft,scrollTop:p.scrollTop}}function Gc(p){return p===xn(p)||!Pn(p)?Ga(p):Kc(p)}function Qn(p){return p?(p.nodeName||"").toLowerCase():null}function Ei(p){return((Fi(p)?p.ownerDocument:p.document)||window.document).documentElement}function Xa(p){return sr(Ei(p)).left+Ga(p).scrollLeft}function di(p){return xn(p).getComputedStyle(p)}function Za(p){var e=di(p),r=e.overflow,s=e.overflowX,l=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+l+s)}function Xc(p){var e=p.getBoundingClientRect(),r=or(e.width)/p.offsetWidth||1,s=or(e.height)/p.offsetHeight||1;return r!==1||s!==1}function Zc(p,e,r){r===void 0&&(r=!1);var s=Pn(e),l=Pn(e)&&Xc(e),d=Ei(e),m=sr(p,l,r),u={scrollLeft:0,scrollTop:0},g={x:0,y:0};return(s||!s&&!r)&&((Qn(e)!=="body"||Za(d))&&(u=Gc(e)),Pn(e)?(g=sr(e,!0),g.x+=e.clientLeft,g.y+=e.clientTop):d&&(g.x=Xa(d))),{x:m.left+u.scrollLeft-g.x,y:m.top+u.scrollTop-g.y,width:m.width,height:m.height}}function Ja(p){var e=sr(p),r=p.offsetWidth,s=p.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-s)<=1&&(s=e.height),{x:p.offsetLeft,y:p.offsetTop,width:r,height:s}}function pa(p){return Qn(p)==="html"?p:p.assignedSlot||p.parentNode||(Ka(p)?p.host:null)||Ei(p)}function vs(p){return["html","body","#document"].indexOf(Qn(p))>=0?p.ownerDocument.body:Pn(p)&&Za(p)?p:vs(pa(p))}function Er(p,e){var r;e===void 0&&(e=[]);var s=vs(p),l=s===((r=p.ownerDocument)==null?void 0:r.body),d=xn(s),m=l?[d].concat(d.visualViewport||[],Za(s)?s:[]):s,u=e.concat(m);return l?u:u.concat(Er(pa(m)))}function Jc(p){return["table","td","th"].indexOf(Qn(p))>=0}function ko(p){return!Pn(p)||di(p).position==="fixed"?null:p.offsetParent}function Qc(p){var e=/firefox/i.test(Ua()),r=/Trident/i.test(Ua());if(r&&Pn(p)){var s=di(p);if(s.position==="fixed")return null}var l=pa(p);for(Ka(l)&&(l=l.host);Pn(l)&&["html","body"].indexOf(Qn(l))<0;){var d=di(l);if(d.transform!=="none"||d.perspective!=="none"||d.contain==="paint"||["transform","perspective"].indexOf(d.willChange)!==-1||e&&d.willChange==="filter"||e&&d.filter&&d.filter!=="none")return l;l=l.parentNode}return null}function Ar(p){for(var e=xn(p),r=ko(p);r&&Jc(r)&&di(r).position==="static";)r=ko(r);return r&&(Qn(r)==="html"||Qn(r)==="body"&&di(r).position==="static")?e:r||Qc(p)||e}var En="top",zn="bottom",Fn="right",Sn="left",Qa="auto",Lr=[En,zn,Fn,Sn],lr="start",Tr="end",eu="clippingParents",bs="viewport",gr="popper",tu="reference",Eo=Lr.reduce(function(p,e){return p.concat([e+"-"+lr,e+"-"+Tr])},[]),ys=[].concat(Lr,[Qa]).reduce(function(p,e){return p.concat([e,e+"-"+lr,e+"-"+Tr])},[]),nu="beforeRead",iu="read",ru="afterRead",au="beforeMain",ou="main",su="afterMain",lu="beforeWrite",cu="write",uu="afterWrite",du=[nu,iu,ru,au,ou,su,lu,cu,uu];function fu(p){var e=new Map,r=new Set,s=[];p.forEach(function(d){e.set(d.name,d)});function l(d){r.add(d.name);var m=[].concat(d.requires||[],d.requiresIfExists||[]);m.forEach(function(u){if(!r.has(u)){var g=e.get(u);g&&l(g)}}),s.push(d)}return p.forEach(function(d){r.has(d.name)||l(d)}),s}function hu(p){var e=fu(p);return du.reduce(function(r,s){return r.concat(e.filter(function(l){return l.phase===s}))},[])}function pu(p){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(p())})})),e}}function mu(p){var e=p.reduce(function(r,s){var l=r[s.name];return r[s.name]=l?Object.assign({},l,s,{options:Object.assign({},l.options,s.options),data:Object.assign({},l.data,s.data)}):s,r},{});return Object.keys(e).map(function(r){return e[r]})}function gu(p,e){var r=xn(p),s=Ei(p),l=r.visualViewport,d=s.clientWidth,m=s.clientHeight,u=0,g=0;if(l){d=l.width,m=l.height;var S=gs();(S||!S&&e==="fixed")&&(u=l.offsetLeft,g=l.offsetTop)}return{width:d,height:m,x:u+Xa(p),y:g}}function vu(p){var e,r=Ei(p),s=Ga(p),l=(e=p.ownerDocument)==null?void 0:e.body,d=Ui(r.scrollWidth,r.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),m=Ui(r.scrollHeight,r.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0),u=-s.scrollLeft+Xa(p),g=-s.scrollTop;return di(l||r).direction==="rtl"&&(u+=Ui(r.clientWidth,l?l.clientWidth:0)-d),{width:d,height:m,x:u,y:g}}function ws(p,e){var r=e.getRootNode&&e.getRootNode();if(p.contains(e))return!0;if(r&&Ka(r)){var s=e;do{if(s&&p.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function za(p){return Object.assign({},p,{left:p.x,top:p.y,right:p.x+p.width,bottom:p.y+p.height})}function bu(p,e){var r=sr(p,!1,e==="fixed");return r.top=r.top+p.clientTop,r.left=r.left+p.clientLeft,r.bottom=r.top+p.clientHeight,r.right=r.left+p.clientWidth,r.width=p.clientWidth,r.height=p.clientHeight,r.x=r.left,r.y=r.top,r}function So(p,e,r){return e===bs?za(gu(p,r)):Fi(e)?bu(e,r):za(vu(Ei(p)))}function yu(p){var e=Er(pa(p)),r=["absolute","fixed"].indexOf(di(p).position)>=0,s=r&&Pn(p)?Ar(p):p;return Fi(s)?e.filter(function(l){return Fi(l)&&ws(l,s)&&Qn(l)!=="body"}):[]}function wu(p,e,r,s){var l=e==="clippingParents"?yu(p):[].concat(e),d=[].concat(l,[r]),m=d[0],u=d.reduce(function(g,S){var k=So(p,S,s);return g.top=Ui(k.top,g.top),g.right=sa(k.right,g.right),g.bottom=sa(k.bottom,g.bottom),g.left=Ui(k.left,g.left),g},So(p,m,s));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function Jn(p){return p.split("-")[0]}function cr(p){return p.split("-")[1]}function eo(p){return["top","bottom"].indexOf(p)>=0?"x":"y"}function ks(p){var e=p.reference,r=p.element,s=p.placement,l=s?Jn(s):null,d=s?cr(s):null,m=e.x+e.width/2-r.width/2,u=e.y+e.height/2-r.height/2,g;switch(l){case En:g={x:m,y:e.y-r.height};break;case zn:g={x:m,y:e.y+e.height};break;case Fn:g={x:e.x+e.width,y:u};break;case Sn:g={x:e.x-r.width,y:u};break;default:g={x:e.x,y:e.y}}var S=l?eo(l):null;if(S!=null){var k=S==="y"?"height":"width";switch(d){case lr:g[S]=g[S]-(e[k]/2-r[k]/2);break;case Tr:g[S]=g[S]+(e[k]/2-r[k]/2);break}}return g}function Es(){return{top:0,right:0,bottom:0,left:0}}function Ss(p){return Object.assign({},Es(),p)}function xs(p,e){return e.reduce(function(r,s){return r[s]=p,r},{})}function to(p,e){e===void 0&&(e={});var r=e,s=r.placement,l=s===void 0?p.placement:s,d=r.strategy,m=d===void 0?p.strategy:d,u=r.boundary,g=u===void 0?eu:u,S=r.rootBoundary,k=S===void 0?bs:S,h=r.elementContext,f=h===void 0?gr:h,b=r.altBoundary,y=b===void 0?!1:b,E=r.padding,w=E===void 0?0:E,C=Ss(typeof w!="number"?w:xs(w,Lr)),_=f===gr?tu:gr,T=p.rects.popper,M=p.elements[y?_:f],v=wu(Fi(M)?M:M.contextElement||Ei(p.elements.popper),g,k,m),D=sr(p.elements.reference),N=ks({reference:D,element:T,placement:l}),V=za(Object.assign({},T,N)),H=f===gr?V:D,$={top:v.top-H.top+C.top,bottom:H.bottom-v.bottom+C.bottom,left:v.left-H.left+C.left,right:H.right-v.right+C.right},z=p.modifiersData.offset;if(f===gr&&z){var F=z[l];Object.keys($).forEach(function(le){var de=[Fn,zn].indexOf(le)>=0?1:-1,Pe=[En,zn].indexOf(le)>=0?"y":"x";$[le]+=F[Pe]*de})}return $}var xo={placement:"bottom",modifiers:[],strategy:"absolute"};function Co(){for(var p=arguments.length,e=new Array(p),r=0;r<p;r++)e[r]=arguments[r];return!e.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function ku(p){p===void 0&&(p={});var e=p,r=e.defaultModifiers,s=r===void 0?[]:r,l=e.defaultOptions,d=l===void 0?xo:l;return function(u,g,S){S===void 0&&(S=d);var k={placement:"bottom",orderedModifiers:[],options:Object.assign({},xo,d),modifiersData:{},elements:{reference:u,popper:g},attributes:{},styles:{}},h=[],f=!1,b={state:k,setOptions:function(C){var _=typeof C=="function"?C(k.options):C;E(),k.options=Object.assign({},d,k.options,_),k.scrollParents={reference:Fi(u)?Er(u):u.contextElement?Er(u.contextElement):[],popper:Er(g)};var T=hu(mu([].concat(s,k.options.modifiers)));return k.orderedModifiers=T.filter(function(M){return M.enabled}),y(),b.update()},forceUpdate:function(){if(!f){var C=k.elements,_=C.reference,T=C.popper;if(Co(_,T)){k.rects={reference:Zc(_,Ar(T),k.options.strategy==="fixed"),popper:Ja(T)},k.reset=!1,k.placement=k.options.placement,k.orderedModifiers.forEach(function($){return k.modifiersData[$.name]=Object.assign({},$.data)});for(var M=0;M<k.orderedModifiers.length;M++){if(k.reset===!0){k.reset=!1,M=-1;continue}var v=k.orderedModifiers[M],D=v.fn,N=v.options,V=N===void 0?{}:N,H=v.name;typeof D=="function"&&(k=D({state:k,options:V,name:H,instance:b})||k)}}}},update:pu(function(){return new Promise(function(w){b.forceUpdate(),w(k)})}),destroy:function(){E(),f=!0}};if(!Co(u,g))return b;b.setOptions(S).then(function(w){!f&&S.onFirstUpdate&&S.onFirstUpdate(w)});function y(){k.orderedModifiers.forEach(function(w){var C=w.name,_=w.options,T=_===void 0?{}:_,M=w.effect;if(typeof M=="function"){var v=M({state:k,name:C,instance:b,options:T}),D=function(){};h.push(v||D)}})}function E(){h.forEach(function(w){return w()}),h=[]}return b}}var Vr={passive:!0};function Eu(p){var e=p.state,r=p.instance,s=p.options,l=s.scroll,d=l===void 0?!0:l,m=s.resize,u=m===void 0?!0:m,g=xn(e.elements.popper),S=[].concat(e.scrollParents.reference,e.scrollParents.popper);return d&&S.forEach(function(k){k.addEventListener("scroll",r.update,Vr)}),u&&g.addEventListener("resize",r.update,Vr),function(){d&&S.forEach(function(k){k.removeEventListener("scroll",r.update,Vr)}),u&&g.removeEventListener("resize",r.update,Vr)}}const Cs={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Eu,data:{}};function Su(p){var e=p.state,r=p.name;e.modifiersData[r]=ks({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const xu={name:"popperOffsets",enabled:!0,phase:"read",fn:Su,data:{}};var Cu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function _u(p,e){var r=p.x,s=p.y,l=e.devicePixelRatio||1;return{x:or(r*l)/l||0,y:or(s*l)/l||0}}function _o(p){var e,r=p.popper,s=p.popperRect,l=p.placement,d=p.variation,m=p.offsets,u=p.position,g=p.gpuAcceleration,S=p.adaptive,k=p.roundOffsets,h=p.isFixed,f=m.x,b=f===void 0?0:f,y=m.y,E=y===void 0?0:y,w=typeof k=="function"?k({x:b,y:E}):{x:b,y:E};b=w.x,E=w.y;var C=m.hasOwnProperty("x"),_=m.hasOwnProperty("y"),T=Sn,M=En,v=window;if(S){var D=Ar(r),N="clientHeight",V="clientWidth";if(D===xn(r)&&(D=Ei(r),di(D).position!=="static"&&u==="absolute"&&(N="scrollHeight",V="scrollWidth")),D=D,l===En||(l===Sn||l===Fn)&&d===Tr){M=zn;var H=h&&D===v&&v.visualViewport?v.visualViewport.height:D[N];E-=H-s.height,E*=g?1:-1}if(l===Sn||(l===En||l===zn)&&d===Tr){T=Fn;var $=h&&D===v&&v.visualViewport?v.visualViewport.width:D[V];b-=$-s.width,b*=g?1:-1}}var z=Object.assign({position:u},S&&Cu),F=k===!0?_u({x:b,y:E},xn(r)):{x:b,y:E};if(b=F.x,E=F.y,g){var le;return Object.assign({},z,(le={},le[M]=_?"0":"",le[T]=C?"0":"",le.transform=(v.devicePixelRatio||1)<=1?"translate("+b+"px, "+E+"px)":"translate3d("+b+"px, "+E+"px, 0)",le))}return Object.assign({},z,(e={},e[M]=_?E+"px":"",e[T]=C?b+"px":"",e.transform="",e))}function Tu(p){var e=p.state,r=p.options,s=r.gpuAcceleration,l=s===void 0?!0:s,d=r.adaptive,m=d===void 0?!0:d,u=r.roundOffsets,g=u===void 0?!0:u,S={placement:Jn(e.placement),variation:cr(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:l,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,_o(Object.assign({},S,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:m,roundOffsets:g})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,_o(Object.assign({},S,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:g})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const _s={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Tu,data:{}};function Mu(p){var e=p.state;Object.keys(e.elements).forEach(function(r){var s=e.styles[r]||{},l=e.attributes[r]||{},d=e.elements[r];!Pn(d)||!Qn(d)||(Object.assign(d.style,s),Object.keys(l).forEach(function(m){var u=l[m];u===!1?d.removeAttribute(m):d.setAttribute(m,u===!0?"":u)}))})}function Au(p){var e=p.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(s){var l=e.elements[s],d=e.attributes[s]||{},m=Object.keys(e.styles.hasOwnProperty(s)?e.styles[s]:r[s]),u=m.reduce(function(g,S){return g[S]="",g},{});!Pn(l)||!Qn(l)||(Object.assign(l.style,u),Object.keys(d).forEach(function(g){l.removeAttribute(g)}))})}}const Lu={name:"applyStyles",enabled:!0,phase:"write",fn:Mu,effect:Au,requires:["computeStyles"]};var Du=[Cs,xu,_s,Lu],Ou={left:"right",right:"left",bottom:"top",top:"bottom"};function ia(p){return p.replace(/left|right|bottom|top/g,function(e){return Ou[e]})}var Pu={start:"end",end:"start"};function To(p){return p.replace(/start|end/g,function(e){return Pu[e]})}function Ru(p,e){e===void 0&&(e={});var r=e,s=r.placement,l=r.boundary,d=r.rootBoundary,m=r.padding,u=r.flipVariations,g=r.allowedAutoPlacements,S=g===void 0?ys:g,k=cr(s),h=k?u?Eo:Eo.filter(function(y){return cr(y)===k}):Lr,f=h.filter(function(y){return S.indexOf(y)>=0});f.length===0&&(f=h);var b=f.reduce(function(y,E){return y[E]=to(p,{placement:E,boundary:l,rootBoundary:d,padding:m})[Jn(E)],y},{});return Object.keys(b).sort(function(y,E){return b[y]-b[E]})}function Iu(p){if(Jn(p)===Qa)return[];var e=ia(p);return[To(p),e,To(e)]}function Hu(p){var e=p.state,r=p.options,s=p.name;if(!e.modifiersData[s]._skip){for(var l=r.mainAxis,d=l===void 0?!0:l,m=r.altAxis,u=m===void 0?!0:m,g=r.fallbackPlacements,S=r.padding,k=r.boundary,h=r.rootBoundary,f=r.altBoundary,b=r.flipVariations,y=b===void 0?!0:b,E=r.allowedAutoPlacements,w=e.options.placement,C=Jn(w),_=C===w,T=g||(_||!y?[ia(w)]:Iu(w)),M=[w].concat(T).reduce(function(re,Ae){return re.concat(Jn(Ae)===Qa?Ru(e,{placement:Ae,boundary:k,rootBoundary:h,padding:S,flipVariations:y,allowedAutoPlacements:E}):Ae)},[]),v=e.rects.reference,D=e.rects.popper,N=new Map,V=!0,H=M[0],$=0;$<M.length;$++){var z=M[$],F=Jn(z),le=cr(z)===lr,de=[En,zn].indexOf(F)>=0,Pe=de?"width":"height",Ue=to(e,{placement:z,boundary:k,rootBoundary:h,altBoundary:f,padding:S}),Te=de?le?Fn:Sn:le?zn:En;v[Pe]>D[Pe]&&(Te=ia(Te));var Le=ia(Te),Re=[];if(d&&Re.push(Ue[F]<=0),u&&Re.push(Ue[Te]<=0,Ue[Le]<=0),Re.every(function(re){return re})){H=z,V=!1;break}N.set(z,Re)}if(V)for(var Je=y?3:1,tt=function(Ae){var Ge=M.find(function(Z){var ke=N.get(Z);if(ke)return ke.slice(0,Ae).every(function(se){return se})});if(Ge)return H=Ge,"break"},U=Je;U>0;U--){var oe=tt(U);if(oe==="break")break}e.placement!==H&&(e.modifiersData[s]._skip=!0,e.placement=H,e.reset=!0)}}const Nu={name:"flip",enabled:!0,phase:"main",fn:Hu,requiresIfExists:["offset"],data:{_skip:!1}};function ju(p,e,r){var s=Jn(p),l=[Sn,En].indexOf(s)>=0?-1:1,d=typeof r=="function"?r(Object.assign({},e,{placement:p})):r,m=d[0],u=d[1];return m=m||0,u=(u||0)*l,[Sn,Fn].indexOf(s)>=0?{x:u,y:m}:{x:m,y:u}}function $u(p){var e=p.state,r=p.options,s=p.name,l=r.offset,d=l===void 0?[0,0]:l,m=ys.reduce(function(k,h){return k[h]=ju(h,e.rects,d),k},{}),u=m[e.placement],g=u.x,S=u.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=g,e.modifiersData.popperOffsets.y+=S),e.modifiersData[s]=m}const Bu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:$u};function Uu(p){return p==="x"?"y":"x"}function Sr(p,e,r){return Ui(p,sa(e,r))}function zu(p,e,r){var s=Sr(p,e,r);return s>r?r:s}function Fu(p){var e=p.state,r=p.options,s=p.name,l=r.mainAxis,d=l===void 0?!0:l,m=r.altAxis,u=m===void 0?!1:m,g=r.boundary,S=r.rootBoundary,k=r.altBoundary,h=r.padding,f=r.tether,b=f===void 0?!0:f,y=r.tetherOffset,E=y===void 0?0:y,w=to(e,{boundary:g,rootBoundary:S,padding:h,altBoundary:k}),C=Jn(e.placement),_=cr(e.placement),T=!_,M=eo(C),v=Uu(M),D=e.modifiersData.popperOffsets,N=e.rects.reference,V=e.rects.popper,H=typeof E=="function"?E(Object.assign({},e.rects,{placement:e.placement})):E,$=typeof H=="number"?{mainAxis:H,altAxis:H}:Object.assign({mainAxis:0,altAxis:0},H),z=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,F={x:0,y:0};if(D){if(d){var le,de=M==="y"?En:Sn,Pe=M==="y"?zn:Fn,Ue=M==="y"?"height":"width",Te=D[M],Le=Te+w[de],Re=Te-w[Pe],Je=b?-V[Ue]/2:0,tt=_===lr?N[Ue]:V[Ue],U=_===lr?-V[Ue]:-N[Ue],oe=e.elements.arrow,re=b&&oe?Ja(oe):{width:0,height:0},Ae=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Es(),Ge=Ae[de],Z=Ae[Pe],ke=Sr(0,N[Ue],re[Ue]),se=T?N[Ue]/2-Je-ke-Ge-$.mainAxis:tt-ke-Ge-$.mainAxis,ee=T?-N[Ue]/2+Je+ke+Z+$.mainAxis:U+ke+Z+$.mainAxis,Ie=e.elements.arrow&&Ar(e.elements.arrow),ye=Ie?M==="y"?Ie.clientTop||0:Ie.clientLeft||0:0,lt=(le=z==null?void 0:z[M])!=null?le:0,Ve=Te+se-lt-ye,Qe=Te+ee-lt,De=Sr(b?sa(Le,Ve):Le,Te,b?Ui(Re,Qe):Re);D[M]=De,F[M]=De-Te}if(u){var nt,ct=M==="x"?En:Sn,dt=M==="x"?zn:Fn,ft=D[v],It=v==="y"?"height":"width",_n=ft+w[ct],an=ft-w[dt],on=[En,Sn].indexOf(C)!==-1,it=(nt=z==null?void 0:z[v])!=null?nt:0,Xt=on?_n:ft-N[It]-V[It]-it+$.altAxis,un=on?ft+N[It]+V[It]-it-$.altAxis:an,sn=b&&on?zu(Xt,ft,un):Sr(b?Xt:_n,ft,b?un:an);D[v]=sn,F[v]=sn-ft}e.modifiersData[s]=F}}const Vu={name:"preventOverflow",enabled:!0,phase:"main",fn:Fu,requiresIfExists:["offset"]};var qu=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,Ss(typeof e!="number"?e:xs(e,Lr))};function Wu(p){var e,r=p.state,s=p.name,l=p.options,d=r.elements.arrow,m=r.modifiersData.popperOffsets,u=Jn(r.placement),g=eo(u),S=[Sn,Fn].indexOf(u)>=0,k=S?"height":"width";if(!(!d||!m)){var h=qu(l.padding,r),f=Ja(d),b=g==="y"?En:Sn,y=g==="y"?zn:Fn,E=r.rects.reference[k]+r.rects.reference[g]-m[g]-r.rects.popper[k],w=m[g]-r.rects.reference[g],C=Ar(d),_=C?g==="y"?C.clientHeight||0:C.clientWidth||0:0,T=E/2-w/2,M=h[b],v=_-f[k]-h[y],D=_/2-f[k]/2+T,N=Sr(M,D,v),V=g;r.modifiersData[s]=(e={},e[V]=N,e.centerOffset=N-D,e)}}function Yu(p){var e=p.state,r=p.options,s=r.element,l=s===void 0?"[data-popper-arrow]":s;l!=null&&(typeof l=="string"&&(l=e.elements.popper.querySelector(l),!l)||ws(e.elements.popper,l)&&(e.elements.arrow=l))}const Ku={name:"arrow",enabled:!0,phase:"main",fn:Wu,effect:Yu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},Gu=ku({defaultModifiers:[...Du,Bu,Nu,Vu,_s,Cs,Ku]});function Xu({locked:p=!1,overflowPadding:e=8,offsetDistance:r=8,offsetSkid:s=0,gpuAcceleration:l=!0,adaptive:d=!0,scroll:m=!0,resize:u=!0,arrow:g=!1,placement:S,strategy:k},h){const f=G(null),b=G(null),y=G(null);return zt(()=>{bc(E=>{if(!b.value||!f.value)return;const w=wo(b),C=wo(f);if(!(w instanceof HTMLElement)||!C)return;const _={modifiers:[{name:"flip",enabled:!p},{name:"preventOverflow",options:{padding:e}},{name:"offset",options:{offset:[s,r]}},{name:"computeStyles",options:{adaptive:d,gpuAcceleration:l}},{name:"eventListeners",options:{scroll:m,resize:u}},{name:"arrow",enabled:g}]};S&&(_.placement=S),k&&(_.strategy=k),y.value=Gu(C,w,_),E(y.value.destroy)})}),[f,b,y]}const ka=Wa(ar.ui.strategy,ar.ui.tooltip,qc),Zu=rn({components:{UKbd:ms},inheritAttrs:!1,props:{text:{type:String,default:null},prevent:{type:Boolean,default:!1},shortcuts:{type:Array,default:()=>[]},openDelay:{type:Number,default:()=>ka.default.openDelay},closeDelay:{type:Number,default:()=>ka.default.closeDelay},popper:{type:Object,default:()=>({})},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(p){const{ui:e,attrs:r}=Ya("tooltip",_r(p,"ui"),ka,_r(p,"class")),s=he(()=>wc({},p.popper,e.value.popper)),[l,d]=Xu(s.value),m=G(!1);let u=null,g=null;const S=he(()=>!!(kc().text||p.text));function k(){g&&(clearTimeout(g),g=null),!m.value&&(u=u||setTimeout(()=>{m.value=!0,u=null},p.openDelay))}function h(){u&&(clearTimeout(u),u=null),m.value&&(g=g||setTimeout(()=>{m.value=!1,g=null},p.closeDelay))}return{ui:e,attrs:r,popper:s,trigger:l,container:d,open:m,onMouseEnter:k,onMouseLeave:h,isVisible:S}}});function Ju(p,e,r,s,l,d){const m=ms;return J(),ae("div",oa({ref:"trigger",class:p.ui.wrapper},p.attrs,{onMouseenter:e[0]||(e[0]=(...u)=>p.onMouseEnter&&p.onMouseEnter(...u)),onMouseleave:e[1]||(e[1]=(...u)=>p.onMouseLeave&&p.onMouseLeave(...u))}),[aa(p.$slots,"default",{open:p.open},()=>[e[2]||(e[2]=gt(" Hover "))]),p.open&&!p.prevent&&p.isVisible?(J(),ae("div",{key:0,ref:"container",class:be([p.ui.container,p.ui.width])},[te(yc,oa({appear:""},p.ui.transition),{default:Ce(()=>{var u;return[I("div",null,[p.popper.arrow?(J(),ae("div",{key:0,"data-popper-arrow":"",class:be(Object.values(p.ui.arrow))},null,2)):Me("",!0),I("div",{class:be([p.ui.base,p.ui.background,p.ui.color,p.ui.rounded,p.ui.shadow,p.ui.ring])},[aa(p.$slots,"text",{},()=>[gt(qe(p.text),1)]),(u=p.shortcuts)!=null&&u.length?(J(),ae("span",{key:0,class:be(p.ui.shortcuts)},[I("span",{class:be(p.ui.middot)},"·",2),(J(!0),ae(Ut,null,Qt(p.shortcuts,g=>(J(),Lt(m,{key:g,size:"xs"},{default:Ce(()=>[gt(qe(g),1)]),_:2},1024))),128))],2)):Me("",!0)],2)])]}),_:3},16)],2)):Me("",!0)],16)}const Qu=Cn(Zu,[["render",Ju]]),ed=Symbol.for("nuxt:client-only"),td=rn({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(p,{slots:e,attrs:r}){const s=G(!1);return zt(()=>{s.value=!0}),kr(ed,!0),l=>{var g;if(s.value)return(g=e.default)==null?void 0:g.call(e);const d=e.fallback||e.placeholder;if(d)return d();const m=l.fallback||l.placeholder||"",u=l.fallbackTag||l.placeholderTag||"span";return ae(u,r,m)}}}),nd=Wa(ar.ui.strategy,ar.ui.container,Vc),id=rn({inheritAttrs:!1,props:{as:{type:String,default:"div"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(p){const{ui:e,attrs:r}=Ya("container",_r(p,"ui"),nd),s=he(()=>os(ss(e.value.base,e.value.padding,e.value.constrained),p.class));return{ui:e,attrs:r,containerClass:s}}});function rd(p,e,r,s,l,d){return J(),Lt(Ec(p.as),oa({class:p.containerClass},p.attrs),{default:Ce(()=>[aa(p.$slots,"default")]),_:3},16,["class"])}const ad=Cn(id,[["render",rd]]),Ts=ls("messageStore",()=>{const p=G([]),e=G(0),r=G(!0),s=G(1),l=G(15),d=Ke(),m=G(!1),u=G(null),g=G([]),S=G([]),k=G(null);return{messages:p,total:e,hasMore:r,page:s,pageSize:l,loading:m,siteConfig:u,reset:()=>{p.value=[],e.value=0,r.value=!0,s.value=1,m.value=!1},getMessages:async $=>{if(!m.value){m.value=!0;try{const z=await Ni("messages/page",$,{credentials:"include"});if(!z)return d.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const F=z.data.items.filter(le=>!p.value.some(de=>de.id===le.id));return $.page===1?p.value=z.data.items:p.value=[...p.value,...F],e.value=z.data.total,s.value=$.page,l.value=$.pageSize,r.value=p.value.length<e.value,z.data}catch(z){console.error("获取笔记列表失败:",z),d.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3})}finally{m.value=!1}}},deleteMessage:async $=>{try{const z=await cs(`messages/${$}`,void 0,{credentials:"include"});return!z||z.code!==1?(d.add({title:"删除笔记失败",description:z==null?void 0:z.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(p.value=p.value.filter(F=>F.id!==$),e.value-=1,z)}catch(z){throw console.error("删除笔记失败:",z),z}},updateMessage:async($,z)=>{try{const F=await Ur(`messages/${$}`,{content:z},{credentials:"include"});if(!F||F.code!==1)return d.add({title:"更新笔记失败",description:F==null?void 0:F.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const le=p.value.findIndex(de=>de.id===$);return le!==-1&&(p.value[le]=F.data),F}catch(F){throw console.error("更新笔记失败:",F),F}},setPinned:async($,z)=>{try{const F=await Ur(`messages/${$}/pin`,{pinned:z},{credentials:"include"});if(!F||F.code!==1)return d.add({title:"更新置顶状态失败",description:F==null?void 0:F.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const le=p.value.findIndex(de=>de.id===$);return le!==-1&&(p.value[le]={...p.value[le],pinned:z},p.value=[...p.value].sort((de,Pe)=>{const Ue=de.pinned?1:0,Te=Pe.pinned?1:0;return Ue!==Te?Te-Ue:new Date(Pe.created_at).getTime()-new Date(de.created_at).getTime()})),F}catch(F){throw console.error("更新置顶状态失败:",F),F}},getMessageById:async $=>{try{const z=await Un(`messages/${$}`,void 0,{credentials:"include"});return!z||z.code!==1?(d.add({title:"获取消息失败",description:(z==null?void 0:z.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):z.data}catch(z){throw console.error("获取消息失败:",z),z}},getSiteConfig:async()=>{try{const $=await Un("site/config",void 0,{credentials:"include"});return!$||$.code!==1?(d.add({title:"获取网站配置失败",description:($==null?void 0:$.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(u.value=$.data,bt(),$.data)}catch($){throw console.error("获取网站配置失败:",$),$}},updateSiteConfig:async($,z)=>{try{const F=await Ur("site/config",{[$]:z},{credentials:"include"});return!F||F.code!==1?(d.add({title:"更新配置失败",description:F==null?void 0:F.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(u.value={...u.value,[$]:z},F.data)}catch(F){throw console.error("更新配置失败:",F),F}},tags:g,images:S,getAllTags:async()=>{try{const $=await Un("messages/tags",void 0,{credentials:"include"});return!$||$.code!==1?(d.add({title:"获取标签列表失败",description:($==null?void 0:$.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(g.value=$.data,$.data)}catch($){throw console.error("获取标签列表失败:",$),$}},getMessagesByTag:async $=>{try{const z=await Un(`messages/tags/${encodeURIComponent($)}`,void 0,{credentials:"include"});return!z||z.code!==1?(d.add({title:"获取标签消息失败",description:(z==null?void 0:z.msg)||"请稍后重试",color:"red",timeout:2e3}),null):z.data}catch(z){throw console.error("获取标签消息失败:",z),z}},getAllImages:async()=>{try{const $=await Un("messages/images",void 0,{credentials:"include"});return!$||$.code!==1?(d.add({title:"获取图片列表失败",description:($==null?void 0:$.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(S.value=$.data,$.data)}catch($){throw console.error("获取图片列表失败:",$),$}},notifyConfig:k,getNotifyConfig:async()=>{try{const $=await Un("notify/config",void 0,{credentials:"include"});return!$||$.code!==1?(d.add({title:"获取推送配置失败",description:($==null?void 0:$.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(k.value=$.data,$.data)}catch($){throw console.error("获取推送配置失败:",$),$}},updateNotifyConfig:async $=>{try{const z=await Ur("notify/config",$,{credentials:"include"});return!z||z.code!==1?(d.add({title:"更新推送配置失败",description:(z==null?void 0:z.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(k.value=z.data,z.data)}catch(z){throw console.error("更新推送配置失败:",z),z}},testNotify:async $=>{try{const z=await Ni(`notify/test?type=${$}`,{},{credentials:"include"});if(!z||z.code!==1)throw new Error((z==null?void 0:z.msg)||"测试失败");return z.data}catch(z){throw console.error("推送测试失败:",z),z}},createMessage:async $=>{try{const z=await Ni("messages",$,{credentials:"include"});if(!z||z.code!==1)throw new Error((z==null?void 0:z.msg)||"创建消息失败");if($.notify)try{const F=gn().public.baseApi,le={content:$.content,images:$.image_url?[`${F}${$.image_url}`].filter(Boolean):[],format:"markdown"},de=await Ni("notify/send",le,{credentials:"include"});(!de||de.code!==1)&&console.warn("推送失败:",de==null?void 0:de.msg)}catch(F){console.error("消息推送失败:",F)}return d.add({title:"成功",description:"发布成功",color:"green",timeout:2e3}),z.data}catch(z){throw console.error("创建消息失败:",z),z}}}}),Ms=()=>{const p=Ts(),e=Ke();return{save:async d=>{try{const m=await Ni("messages",d,{credentials:"include"});if(!m||m.code!==1)return console.log(m==null?void 0:m.code),e.add({title:"添加失败",description:String(m==null?void 0:m.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const u=m.data;return p.messages.unshift(u),e.add({title:"保存成功",description:"消息已保存",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),m.data}catch(m){console.error(m)}},uploadImage:async d=>{try{const m=new FormData;m.append("image",d);const u=await Ni("images/upload",m,{credentials:"include"});return!u||u.code!==1?(console.log(u==null?void 0:u.code),e.add({title:"上传失败",description:String(u==null?void 0:u.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):u.data}catch(m){return console.error("上传图片错误:",m),null}},deleteMessage:async d=>{try{const m=await p.deleteMessage(d);if(m&&m.code===1)return e.add({title:"删除成功",description:"笔记已删除",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),!0}catch(m){console.error(m)}}}},_e=(p,e=1e4)=>(p=parseFloat(p+"")||0,Math.round((p+Number.EPSILON)*e)/e),Fa=function(p){if(!(p&&p instanceof Element&&p.offsetParent))return!1;const e=p.scrollHeight>p.clientHeight,r=window.getComputedStyle(p).overflowY,s=r.indexOf("hidden")!==-1,l=r.indexOf("visible")!==-1;return e&&!s&&!l},la=function(p,e=void 0){return!(!p||p===document.body||e&&p===e)&&(Fa(p)?p:la(p.parentElement,e))},Xn=function(p){var e=new DOMParser().parseFromString(p,"text/html").body;if(e.childElementCount>1){for(var r=document.createElement("div");e.firstChild;)r.appendChild(e.firstChild);return r}return e.firstChild},no=p=>`${p||""}`.split(" ").filter(e=>!!e),Zn=(p,e,r)=>{p&&no(e).forEach(s=>{p.classList.toggle(s,r||!1)})};class Zi{constructor(e){Object.defineProperty(this,"pageX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nativePointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nativePointer=e,this.pageX=e.pageX,this.pageY=e.pageY,this.clientX=e.clientX,this.clientY=e.clientY,this.id=self.Touch&&e instanceof Touch?e.identifier:-1,this.time=Date.now()}}const Ji={passive:!1};class od{constructor(e,{start:r=()=>!0,move:s=()=>{},end:l=()=>{}}){Object.defineProperty(this,"element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"startPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.element=e,this.startCallback=r,this.moveCallback=s,this.endCallback=l;for(const d of["onPointerStart","onTouchStart","onMove","onTouchEnd","onPointerEnd","onWindowBlur"])this[d]=this[d].bind(this);this.element.addEventListener("mousedown",this.onPointerStart,Ji),this.element.addEventListener("touchstart",this.onTouchStart,Ji),this.element.addEventListener("touchmove",this.onMove,Ji),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchcancel",this.onTouchEnd)}onPointerStart(e){if(!e.buttons||e.button!==0)return;const r=new Zi(e);this.currentPointers.some(s=>s.id===r.id)||this.triggerPointerStart(r,e)&&(window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onPointerEnd),window.addEventListener("blur",this.onWindowBlur))}onTouchStart(e){for(const r of Array.from(e.changedTouches||[]))this.triggerPointerStart(new Zi(r),e);window.addEventListener("blur",this.onWindowBlur)}onMove(e){const r=this.currentPointers.slice(),s="changedTouches"in e?Array.from(e.changedTouches||[]).map(d=>new Zi(d)):[new Zi(e)],l=[];for(const d of s){const m=this.currentPointers.findIndex(u=>u.id===d.id);m<0||(l.push(d),this.currentPointers[m]=d)}l.length&&this.moveCallback(e,this.currentPointers.slice(),r)}onPointerEnd(e){e.buttons>0&&e.button!==0||(this.triggerPointerEnd(e,new Zi(e)),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur))}onTouchEnd(e){for(const r of Array.from(e.changedTouches||[]))this.triggerPointerEnd(e,new Zi(r))}triggerPointerStart(e,r){return!!this.startCallback(r,e,this.currentPointers.slice())&&(this.currentPointers.push(e),this.startPointers.push(e),!0)}triggerPointerEnd(e,r){const s=this.currentPointers.findIndex(l=>l.id===r.id);s<0||(this.currentPointers.splice(s,1),this.startPointers.splice(s,1),this.endCallback(e,r,this.currentPointers.slice()))}onWindowBlur(){this.clear()}clear(){for(;this.currentPointers.length;){const e=this.currentPointers[this.currentPointers.length-1];this.currentPointers.splice(this.currentPointers.length-1,1),this.startPointers.splice(this.currentPointers.length-1,1),this.endCallback(new Event("touchend",{bubbles:!0,cancelable:!0,clientX:e.clientX,clientY:e.clientY}),e,this.currentPointers.slice())}}stop(){this.element.removeEventListener("mousedown",this.onPointerStart,Ji),this.element.removeEventListener("touchstart",this.onTouchStart,Ji),this.element.removeEventListener("touchmove",this.onMove,Ji),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchcancel",this.onTouchEnd),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur)}}function Mo(p,e){return e?Math.sqrt(Math.pow(e.clientX-p.clientX,2)+Math.pow(e.clientY-p.clientY,2)):0}function Ao(p,e){return e?{clientX:(p.clientX+e.clientX)/2,clientY:(p.clientY+e.clientY)/2}:p}const Va=p=>typeof p=="object"&&p!==null&&p.constructor===Object&&Object.prototype.toString.call(p)==="[object Object]",bn=(p,...e)=>{const r=e.length;for(let s=0;s<r;s++){const l=e[s]||{};Object.entries(l).forEach(([d,m])=>{const u=Array.isArray(m)?[]:{};p[d]||Object.assign(p,{[d]:u}),Va(m)?Object.assign(p[d],bn(u,m)):Array.isArray(m)?Object.assign(p,{[d]:[...m]}):Object.assign(p,{[d]:m})})}return p},Ea=function(p,e){return p.split(".").reduce((r,s)=>typeof r=="object"?r[s]:void 0,e)};class ca{constructor(e={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(e);for(const r of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))r.startsWith("on")&&typeof this[r]=="function"&&(this[r]=this[r].bind(this))}setOptions(e){this.options=e?bn({},this.constructor.defaults,e):{};for(const[r,s]of Object.entries(this.option("on")||{}))this.on(r,s)}option(e,...r){let s=Ea(e,this.options);return s&&typeof s=="function"&&(s=s.call(this,this,...r)),s}optionFor(e,r,s,...l){let d=Ea(r,e);var m;typeof(m=d)!="string"||isNaN(m)||isNaN(parseFloat(m))||(d=parseFloat(d)),d==="true"&&(d=!0),d==="false"&&(d=!1),d&&typeof d=="function"&&(d=d.call(this,this,e,...l));let u=Ea(r,this.options);return u&&typeof u=="function"?d=u.call(this,this,e,...l,d):d===void 0&&(d=u),d===void 0?s:d}cn(e){const r=this.options.classes;return r&&r[e]||""}localize(e,r=[]){e=String(e).replace(/\{\{(\w+).?(\w+)?\}\}/g,(s,l,d)=>{let m="";return d?m=this.option(`${l[0]+l.toLowerCase().substring(1)}.l10n.${d}`):l&&(m=this.option(`l10n.${l}`)),m||(m=s),m});for(let s=0;s<r.length;s++)e=e.split(r[s][0]).join(r[s][1]);return e=e.replace(/\{\{(.*?)\}\}/g,(s,l)=>l)}on(e,r){let s=[];typeof e=="string"?s=e.split(" "):Array.isArray(e)&&(s=e),this.events||(this.events=new Map),s.forEach(l=>{let d=this.events.get(l);d||(this.events.set(l,[]),d=[]),d.includes(r)||d.push(r),this.events.set(l,d)})}off(e,r){let s=[];typeof e=="string"?s=e.split(" "):Array.isArray(e)&&(s=e),s.forEach(l=>{const d=this.events.get(l);if(Array.isArray(d)){const m=d.indexOf(r);m>-1&&d.splice(m,1)}})}emit(e,...r){[...this.events.get(e)||[]].forEach(s=>s(this,...r)),e!=="*"&&this.emit("*",e,...r)}}Object.defineProperty(ca,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(ca,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class io extends ca{constructor(e={}){super(e),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}})}attachPlugins(e={}){const r=new Map;for(const[s,l]of Object.entries(e)){const d=this.option(s),m=this.plugins[s];m||d===!1?m&&d===!1&&(m.detach(),delete this.plugins[s]):r.set(s,new l(this,d||{}))}for(const[s,l]of r)this.plugins[s]=l,l.attach()}detachPlugins(e){e=e||Object.keys(this.plugins);for(const r of e){const s=this.plugins[r];s&&s.detach(),delete this.plugins[r]}return this.emit("detachPlugins"),this}}var xt;(function(p){p[p.Init=0]="Init",p[p.Error=1]="Error",p[p.Ready=2]="Ready",p[p.Panning=3]="Panning",p[p.Mousemove=4]="Mousemove",p[p.Destroy=5]="Destroy"})(xt||(xt={}));const si=["a","b","c","d","e","f"],As={PANUP:"Move up",PANDOWN:"Move down",PANLEFT:"Move left",PANRIGHT:"Move right",ZOOMIN:"Zoom in",ZOOMOUT:"Zoom out",TOGGLEZOOM:"Toggle zoom level",TOGGLE1TO1:"Toggle zoom level",ITERATEZOOM:"Toggle zoom level",ROTATECCW:"Rotate counterclockwise",ROTATECW:"Rotate clockwise",FLIPX:"Flip horizontally",FLIPY:"Flip vertically",FITX:"Fit horizontally",FITY:"Fit vertically",RESET:"Reset",TOGGLEFS:"Toggle fullscreen"},sd={content:null,width:"auto",height:"auto",panMode:"drag",touch:!0,dragMinThreshold:3,lockAxis:!1,mouseMoveFactor:1,mouseMoveFriction:.12,zoom:!0,pinchToZoom:!0,panOnlyZoomed:"auto",minScale:1,maxScale:2,friction:.25,dragFriction:.35,decelFriction:.05,click:"toggleZoom",dblClick:!1,wheel:"zoom",wheelLimit:7,spinner:!0,bounds:"auto",infinite:!1,rubberband:!0,bounce:!0,maxVelocity:75,transformParent:!1,classes:{content:"f-panzoom__content",isLoading:"is-loading",canZoomIn:"can-zoom_in",canZoomOut:"can-zoom_out",isDraggable:"is-draggable",isDragging:"is-dragging",inFullscreen:"in-fullscreen",htmlHasFullscreen:"with-panzoom-in-fullscreen"},l10n:As},Lo='<circle cx="25" cy="25" r="20"></circle>',ro='<div class="f-spinner"><svg viewBox="0 0 50 50">'+Lo+Lo+"</svg></div>",vn=p=>p&&p!==null&&p instanceof Element&&"nodeType"in p,kt=(p,e)=>{p&&no(e).forEach(r=>{p.classList.remove(r)})},We=(p,e)=>{p&&no(e).forEach(r=>{p.classList.add(r)})},qr={a:1,b:0,c:0,d:1,e:0,f:0},ld=1e5,Wr=1e4,An="mousemove",Do="drag",Oo="content",Ln="auto";let Sa=null,xa=null;class Vi extends io{get fits(){return this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1}get isTouchDevice(){return xa===null&&(xa=window.matchMedia("(hover: none)").matches),xa}get isMobile(){return Sa===null&&(Sa=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),Sa}get panMode(){return this.options.panMode!==An||this.isTouchDevice?Do:An}get panOnlyZoomed(){const e=this.options.panOnlyZoomed;return e===Ln?this.isTouchDevice:e}get isInfinite(){return this.option("infinite")}get angle(){return 180*Math.atan2(this.current.b,this.current.a)/Math.PI||0}get targetAngle(){return 180*Math.atan2(this.target.b,this.target.a)/Math.PI||0}get scale(){const{a:e,b:r}=this.current;return Math.sqrt(e*e+r*r)||1}get targetScale(){const{a:e,b:r}=this.target;return Math.sqrt(e*e+r*r)||1}get minScale(){return this.option("minScale")||1}get fullScale(){const{contentRect:e}=this;return e.fullWidth/e.fitWidth||1}get maxScale(){return this.fullScale*(this.option("maxScale")||1)||1}get coverScale(){const{containerRect:e,contentRect:r}=this,s=Math.max(e.height/r.fitHeight,e.width/r.fitWidth)||1;return Math.min(this.fullScale,s)}get isScaling(){return Math.abs(this.targetScale-this.scale)>1e-5&&!this.isResting}get isContentLoading(){const e=this.content;return!!(e&&e instanceof HTMLImageElement)&&!e.complete}get isResting(){if(this.isBouncingX||this.isBouncingY)return!1;for(const e of si){const r=e=="e"||e==="f"?1e-4:1e-5;if(Math.abs(this.target[e]-this.current[e])>r)return!1}return!(!this.ignoreBounds&&!this.checkBounds().inBounds)}constructor(e,r={},s={}){var l;if(super(r),Object.defineProperty(this,"pointerTracker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resizeObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"updateTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rAF",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isTicking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clicks",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"trackingPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"cwd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pmme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"friction",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:xt.Init}),Object.defineProperty(this,"isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerRect",{enumerable:!0,configurable:!0,writable:!0,value:{width:0,height:0,innerWidth:0,innerHeight:0}}),Object.defineProperty(this,"contentRect",{enumerable:!0,configurable:!0,writable:!0,value:{top:0,right:0,bottom:0,left:0,fullWidth:0,fullHeight:0,fitWidth:0,fitHeight:0,width:0,height:0}}),Object.defineProperty(this,"dragStart",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,top:0,left:0,time:0}}),Object.defineProperty(this,"dragOffset",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,time:0}}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},qr)}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},qr)}),Object.defineProperty(this,"velocity",{enumerable:!0,configurable:!0,writable:!0,value:{a:0,b:0,c:0,d:0,e:0,f:0}}),Object.defineProperty(this,"lockedAxis",{enumerable:!0,configurable:!0,writable:!0,value:!1}),!e)throw new Error("Container Element Not Found");this.container=e,this.initContent(),this.attachPlugins(Object.assign(Object.assign({},Vi.Plugins),s)),this.emit("attachPlugins"),this.emit("init");const d=this.content;if(d.addEventListener("load",this.onLoad),d.addEventListener("error",this.onError),this.isContentLoading){if(this.option("spinner")){e.classList.add(this.cn("isLoading"));const m=Xn(ro);!e.contains(d)||d.parentElement instanceof HTMLPictureElement?this.spinner=e.appendChild(m):this.spinner=((l=d.parentElement)===null||l===void 0?void 0:l.insertBefore(m,d))||null}this.emit("beforeLoad")}else queueMicrotask(()=>{this.enable()})}initContent(){const{container:e}=this,r=this.cn(Oo);let s=this.option(Oo)||e.querySelector(`.${r}`);if(s||(s=e.querySelector("img,picture")||e.firstElementChild,s&&We(s,r)),s instanceof HTMLPictureElement&&(s=s.querySelector("img")),!s)throw new Error("No content found");this.content=s}onLoad(){const{spinner:e,container:r,state:s}=this;e&&(e.remove(),this.spinner=null),this.option("spinner")&&r.classList.remove(this.cn("isLoading")),this.emit("afterLoad"),s===xt.Init?this.enable():this.updateMetrics()}onError(){this.state!==xt.Destroy&&(this.spinner&&(this.spinner.remove(),this.spinner=null),this.stop(),this.detachEvents(),this.state=xt.Error,this.emit("error"))}getNextScale(e){const{fullScale:r,targetScale:s,coverScale:l,maxScale:d,minScale:m}=this;let u=m;switch(e){case"toggleMax":u=s-m<.5*(d-m)?d:m;break;case"toggleCover":u=s-m<.5*(l-m)?l:m;break;case"toggleZoom":u=s-m<.5*(r-m)?r:m;break;case"iterateZoom":let g=[1,r,d].sort((k,h)=>k-h),S=g.findIndex(k=>k>s+1e-5);u=g[S]||1}return u}attachObserver(){var e;const r=()=>{const{container:s,containerRect:l}=this;return Math.abs(l.width-s.getBoundingClientRect().width)>.1||Math.abs(l.height-s.getBoundingClientRect().height)>.1};this.resizeObserver||window.ResizeObserver===void 0||(this.resizeObserver=new ResizeObserver(()=>{this.updateTimer||(r()?(this.onResize(),this.isMobile&&(this.updateTimer=setTimeout(()=>{r()&&this.onResize(),this.updateTimer=null},500))):this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null))})),(e=this.resizeObserver)===null||e===void 0||e.observe(this.container)}detachObserver(){var e;(e=this.resizeObserver)===null||e===void 0||e.disconnect()}attachEvents(){const{container:e}=this;e.addEventListener("click",this.onClick,{passive:!1,capture:!1}),e.addEventListener("wheel",this.onWheel,{passive:!1}),this.pointerTracker=new od(e,{start:this.onPointerDown,move:this.onPointerMove,end:this.onPointerUp}),document.addEventListener(An,this.onMouseMove)}detachEvents(){var e;const{container:r}=this;r.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),r.removeEventListener("wheel",this.onWheel,{passive:!1}),(e=this.pointerTracker)===null||e===void 0||e.stop(),this.pointerTracker=null,document.removeEventListener(An,this.onMouseMove),document.removeEventListener("keydown",this.onKeydown,!0),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)}animate(){this.setTargetForce();const e=this.friction,r=this.option("maxVelocity");for(const s of si)e?(this.velocity[s]*=1-e,r&&!this.isScaling&&(this.velocity[s]=Math.max(Math.min(this.velocity[s],r),-1*r)),this.current[s]+=this.velocity[s]):this.current[s]=this.target[s];this.setTransform(),this.setEdgeForce(),!this.isResting||this.isDragging?this.rAF=requestAnimationFrame(()=>this.animate()):this.stop("current")}setTargetForce(){for(const e of si)e==="e"&&this.isBouncingX||e==="f"&&this.isBouncingY||(this.velocity[e]=(1/(1-this.friction)-1)*(this.target[e]-this.current[e]))}checkBounds(e=0,r=0){const{current:s}=this,l=s.e+e,d=s.f+r,m=this.getBounds(),{x:u,y:g}=m,S=u.min,k=u.max,h=g.min,f=g.max;let b=0,y=0;return S!==1/0&&l<S?b=S-l:k!==1/0&&l>k&&(b=k-l),h!==1/0&&d<h?y=h-d:f!==1/0&&d>f&&(y=f-d),Math.abs(b)<1e-4&&(b=0),Math.abs(y)<1e-4&&(y=0),Object.assign(Object.assign({},m),{xDiff:b,yDiff:y,inBounds:!b&&!y})}clampTargetBounds(){const{target:e}=this,{x:r,y:s}=this.getBounds();r.min!==1/0&&(e.e=Math.max(e.e,r.min)),r.max!==1/0&&(e.e=Math.min(e.e,r.max)),s.min!==1/0&&(e.f=Math.max(e.f,s.min)),s.max!==1/0&&(e.f=Math.min(e.f,s.max))}calculateContentDim(e=this.current){const{content:r,contentRect:s}=this,{fitWidth:l,fitHeight:d,fullWidth:m,fullHeight:u}=s;let g=m,S=u;if(this.option("zoom")||this.angle!==0){const k=!(r instanceof HTMLImageElement)&&(window.getComputedStyle(r).maxWidth==="none"||window.getComputedStyle(r).maxHeight==="none"),h=k?m:l,f=k?u:d,b=this.getMatrix(e),y=new DOMPoint(0,0).matrixTransform(b),E=new DOMPoint(0+h,0).matrixTransform(b),w=new DOMPoint(0+h,0+f).matrixTransform(b),C=new DOMPoint(0,0+f).matrixTransform(b),_=Math.abs(w.x-y.x),T=Math.abs(w.y-y.y),M=Math.abs(C.x-E.x),v=Math.abs(C.y-E.y);g=Math.max(_,M),S=Math.max(T,v)}return{contentWidth:g,contentHeight:S}}setEdgeForce(){if(this.ignoreBounds||this.isDragging||this.panMode===An||this.targetScale<this.scale)return this.isBouncingX=!1,void(this.isBouncingY=!1);const{target:e}=this,{x:r,y:s,xDiff:l,yDiff:d}=this.checkBounds(),m=this.option("maxVelocity");let u=this.velocity.e,g=this.velocity.f;l!==0?(this.isBouncingX=!0,l*u<=0?u+=.14*l:(u=.14*l,r.min!==1/0&&(this.target.e=Math.max(e.e,r.min)),r.max!==1/0&&(this.target.e=Math.min(e.e,r.max))),m&&(u=Math.max(Math.min(u,m),-1*m))):this.isBouncingX=!1,d!==0?(this.isBouncingY=!0,d*g<=0?g+=.14*d:(g=.14*d,s.min!==1/0&&(this.target.f=Math.max(e.f,s.min)),s.max!==1/0&&(this.target.f=Math.min(e.f,s.max))),m&&(g=Math.max(Math.min(g,m),-1*m))):this.isBouncingY=!1,this.isBouncingX&&(this.velocity.e=u),this.isBouncingY&&(this.velocity.f=g)}enable(){const{content:e}=this,r=new DOMMatrixReadOnly(window.getComputedStyle(e).transform);for(const s of si)this.current[s]=this.target[s]=r[s];this.updateMetrics(),this.attachObserver(),this.attachEvents(),this.state=xt.Ready,this.emit("ready")}onClick(e){var r;e.type==="click"&&e.detail===0&&(this.dragOffset.x=0,this.dragOffset.y=0),this.isDragging&&((r=this.pointerTracker)===null||r===void 0||r.clear(),this.trackingPoints=[],this.startDecelAnim());const s=e.target;if(!s||e.defaultPrevented)return;if(s.hasAttribute("disabled"))return e.preventDefault(),void e.stopPropagation();if((()=>{const b=window.getSelection();return b&&b.type==="Range"})()&&!s.closest("button"))return;const l=s.closest("[data-panzoom-action]"),d=s.closest("[data-panzoom-change]"),m=l||d,u=m&&vn(m)?m.dataset:null;if(u){const b=u.panzoomChange,y=u.panzoomAction;if((b||y)&&e.preventDefault(),b){let E={};try{E=JSON.parse(b)}catch{console&&console.warn("The given data was not valid JSON")}return void this.applyChange(E)}if(y)return void(this[y]&&this[y]())}if(Math.abs(this.dragOffset.x)>3||Math.abs(this.dragOffset.y)>3)return e.preventDefault(),void e.stopPropagation();if(s.closest("[data-fancybox]"))return;const g=this.content.getBoundingClientRect(),S=this.dragStart;if(S.time&&!this.canZoomOut()&&(Math.abs(g.x-S.x)>2||Math.abs(g.y-S.y)>2))return;this.dragStart.time=0;const k=b=>{this.option("zoom",e)&&b&&typeof b=="string"&&/(iterateZoom)|(toggle(Zoom|Full|Cover|Max)|(zoomTo(Fit|Cover|Max)))/.test(b)&&typeof this[b]=="function"&&(e.preventDefault(),this[b]({event:e}))},h=this.option("click",e),f=this.option("dblClick",e);f?(this.clicks++,this.clicks==1&&(this.clickTimer=setTimeout(()=>{this.clicks===1?(this.emit("click",e),!e.defaultPrevented&&h&&k(h)):(this.emit("dblClick",e),e.defaultPrevented||k(f)),this.clicks=0,this.clickTimer=null},350))):(this.emit("click",e),!e.defaultPrevented&&h&&k(h))}addTrackingPoint(e){const r=this.trackingPoints.filter(s=>s.time>Date.now()-100);r.push(e),this.trackingPoints=r}onPointerDown(e,r,s){var l;if(this.option("touch",e)===!1)return!1;this.pwt=0,this.dragOffset={x:0,y:0,time:0},this.trackingPoints=[];const d=this.content.getBoundingClientRect();if(this.dragStart={x:d.x,y:d.y,top:d.top,left:d.left,time:Date.now()},this.clickTimer)return!1;if(this.panMode===An&&this.targetScale>1)return e.preventDefault(),e.stopPropagation(),!1;const m=e.composedPath()[0];if(!s.length){if(["TEXTAREA","OPTION","INPUT","SELECT","VIDEO","IFRAME"].includes(m.nodeName)||m.closest("[contenteditable],[data-selectable],[data-draggable],[data-clickable],[data-panzoom-change],[data-panzoom-action]"))return!1;(l=window.getSelection())===null||l===void 0||l.removeAllRanges()}if(e.type==="mousedown")["A","BUTTON"].includes(m.nodeName)||e.preventDefault();else if(Math.abs(this.velocity.a)>.3)return!1;return this.target.e=this.current.e,this.target.f=this.current.f,this.stop(),this.isDragging||(this.isDragging=!0,this.addTrackingPoint(r),this.emit("touchStart",e)),!0}onPointerMove(e,r,s){if(this.option("touch",e)===!1||!this.isDragging||r.length<2&&this.panOnlyZoomed&&_e(this.targetScale)<=_e(this.minScale)||(this.emit("touchMove",e),e.defaultPrevented))return;this.addTrackingPoint(r[0]);const{content:l}=this,d=Ao(s[0],s[1]),m=Ao(r[0],r[1]);let u=0,g=0;if(r.length>1){const T=l.getBoundingClientRect();u=d.clientX-T.left-.5*T.width,g=d.clientY-T.top-.5*T.height}const S=Mo(s[0],s[1]),k=Mo(r[0],r[1]);let h=S?k/S:1,f=m.clientX-d.clientX,b=m.clientY-d.clientY;this.dragOffset.x+=f,this.dragOffset.y+=b,this.dragOffset.time=Date.now()-this.dragStart.time;let y=_e(this.targetScale)===_e(this.minScale)&&this.option("lockAxis");if(y&&!this.lockedAxis)if(y==="xy"||y==="y"||e.type==="touchmove"){if(Math.abs(this.dragOffset.x)<6&&Math.abs(this.dragOffset.y)<6)return void e.preventDefault();const T=Math.abs(180*Math.atan2(this.dragOffset.y,this.dragOffset.x)/Math.PI);this.lockedAxis=T>45&&T<135?"y":"x",this.dragOffset.x=0,this.dragOffset.y=0,f=0,b=0}else this.lockedAxis=y;if(la(e.target,this.content)&&(y="x",this.dragOffset.y=0),y&&y!=="xy"&&this.lockedAxis!==y&&_e(this.targetScale)===_e(this.minScale))return;e.cancelable&&e.preventDefault(),this.container.classList.add(this.cn("isDragging"));const E=this.checkBounds(f,b);this.option("rubberband")?(this.isInfinite!=="x"&&(E.xDiff>0&&f<0||E.xDiff<0&&f>0)&&(f*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitWidth*E.xDiff))),this.isInfinite!=="y"&&(E.yDiff>0&&b<0||E.yDiff<0&&b>0)&&(b*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitHeight*E.yDiff)))):(E.xDiff&&(f=0),E.yDiff&&(b=0));const w=this.targetScale,C=this.minScale,_=this.maxScale;w<.5*C&&(h=Math.max(h,C)),w>1.5*_&&(h=Math.min(h,_)),this.lockedAxis==="y"&&_e(w)===_e(C)&&(f=0),this.lockedAxis==="x"&&_e(w)===_e(C)&&(b=0),this.applyChange({originX:u,originY:g,panX:f,panY:b,scale:h,friction:this.option("dragFriction"),ignoreBounds:!0})}onPointerUp(e,r,s){if(s.length)return this.dragOffset.x=0,this.dragOffset.y=0,void(this.trackingPoints=[]);this.container.classList.remove(this.cn("isDragging")),this.isDragging&&(this.addTrackingPoint(r),this.panOnlyZoomed&&this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1&&(this.trackingPoints=[]),la(e.target,this.content)&&this.lockedAxis==="y"&&(this.trackingPoints=[]),this.emit("touchEnd",e),this.isDragging=!1,this.lockedAxis=!1,this.state!==xt.Destroy&&(e.defaultPrevented||this.startDecelAnim()))}startDecelAnim(){var e;const r=this.isScaling;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const T of si)this.velocity[T]=0;this.target.e=this.current.e,this.target.f=this.current.f,kt(this.container,"is-scaling"),kt(this.container,"is-animating"),this.isTicking=!1;const{trackingPoints:s}=this,l=s[0],d=s[s.length-1];let m=0,u=0,g=0;d&&l&&(m=d.clientX-l.clientX,u=d.clientY-l.clientY,g=d.time-l.time);const S=((e=window.visualViewport)===null||e===void 0?void 0:e.scale)||1;S!==1&&(m*=S,u*=S);let k=0,h=0,f=0,b=0,y=this.option("decelFriction");const E=this.targetScale;if(g>0){f=Math.abs(m)>3?m/(g/30):0,b=Math.abs(u)>3?u/(g/30):0;const T=this.option("maxVelocity");T&&(f=Math.max(Math.min(f,T),-1*T),b=Math.max(Math.min(b,T),-1*T))}f&&(k=f/(1/(1-y)-1)),b&&(h=b/(1/(1-y)-1)),(this.option("lockAxis")==="y"||this.option("lockAxis")==="xy"&&this.lockedAxis==="y"&&_e(E)===this.minScale)&&(k=f=0),(this.option("lockAxis")==="x"||this.option("lockAxis")==="xy"&&this.lockedAxis==="x"&&_e(E)===this.minScale)&&(h=b=0);const w=this.dragOffset.x,C=this.dragOffset.y,_=this.option("dragMinThreshold")||0;Math.abs(w)<_&&Math.abs(C)<_&&(k=h=0,f=b=0),(this.option("zoom")&&(E<this.minScale-1e-5||E>this.maxScale+1e-5)||r&&!k&&!h)&&(y=.35),this.applyChange({panX:k,panY:h,friction:y}),this.emit("decel",f,b,w,C)}onWheel(e){var r=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(d,m){return Math.abs(m)>Math.abs(d)?m:d});const s=Math.max(-1,Math.min(1,r));if(this.emit("wheel",e,s),this.panMode===An||e.defaultPrevented)return;const l=this.option("wheel");l==="pan"?(e.preventDefault(),this.panOnlyZoomed&&!this.canZoomOut()||this.applyChange({panX:2*-e.deltaX,panY:2*-e.deltaY,bounce:!1})):l==="zoom"&&this.option("zoom")!==!1&&this.zoomWithWheel(e)}onMouseMove(e){this.panWithMouse(e)}onKeydown(e){e.key==="Escape"&&this.toggleFS()}onResize(){this.updateMetrics(),this.checkBounds().inBounds||this.requestTick()}setTransform(){this.emit("beforeTransform");const{current:e,target:r,content:s,contentRect:l}=this,d=Object.assign({},qr);for(const w of si){const C=w=="e"||w==="f"?Wr:ld;d[w]=_e(e[w],C),Math.abs(r[w]-e[w])<(w=="e"||w==="f"?.51:.001)&&(e[w]=r[w])}let{a:m,b:u,c:g,d:S,e:k,f:h}=d,f=`matrix(${m}, ${u}, ${g}, ${S}, ${k}, ${h})`,b=s.parentElement instanceof HTMLPictureElement?s.parentElement:s;if(this.option("transformParent")&&(b=b.parentElement||b),b.style.transform===f)return;b.style.transform=f;const{contentWidth:y,contentHeight:E}=this.calculateContentDim();l.width=y,l.height=E,this.emit("afterTransform")}updateMetrics(e=!1){var r;if(!this||this.state===xt.Destroy||this.isContentLoading)return;const s=Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1),{container:l,content:d}=this,m=d instanceof HTMLImageElement,u=l.getBoundingClientRect(),g=getComputedStyle(this.container);let S=u.width*s,k=u.height*s;const h=parseFloat(g.paddingTop)+parseFloat(g.paddingBottom),f=S-(parseFloat(g.paddingLeft)+parseFloat(g.paddingRight)),b=k-h;this.containerRect={width:S,height:k,innerWidth:f,innerHeight:b};const y=parseFloat(d.dataset.width||"")||(le=>{let de=0;return de=le instanceof HTMLImageElement?le.naturalWidth:le instanceof SVGElement?le.width.baseVal.value:Math.max(le.offsetWidth,le.scrollWidth),de||0})(d),E=parseFloat(d.dataset.height||"")||(le=>{let de=0;return de=le instanceof HTMLImageElement?le.naturalHeight:le instanceof SVGElement?le.height.baseVal.value:Math.max(le.offsetHeight,le.scrollHeight),de||0})(d);let w=this.option("width",y)||Ln,C=this.option("height",E)||Ln;const _=w===Ln,T=C===Ln;typeof w!="number"&&(w=y),typeof C!="number"&&(C=E),_&&(w=y*(C/E)),T&&(C=E/(y/w));let M=d.parentElement instanceof HTMLPictureElement?d.parentElement:d;this.option("transformParent")&&(M=M.parentElement||M);const v=M.getAttribute("style")||"";M.style.setProperty("transform","none","important"),m&&(M.style.width="",M.style.height=""),M.offsetHeight;const D=d.getBoundingClientRect();let N=D.width*s,V=D.height*s,H=N,$=V;N=Math.min(N,w),V=Math.min(V,C),m?{width:N,height:V}=((le,de,Pe,Ue)=>{const Te=Pe/le,Le=Ue/de,Re=Math.min(Te,Le);return{width:le*=Re,height:de*=Re}})(w,C,N,V):(N=Math.min(N,w),V=Math.min(V,C));let z=.5*($-V),F=.5*(H-N);this.contentRect=Object.assign(Object.assign({},this.contentRect),{top:D.top-u.top+z,bottom:u.bottom-D.bottom+z,left:D.left-u.left+F,right:u.right-D.right+F,fitWidth:N,fitHeight:V,width:N,height:V,fullWidth:w,fullHeight:C}),M.style.cssText=v,m&&(M.style.width=`${N}px`,M.style.height=`${V}px`),this.setTransform(),e!==!0&&this.emit("refresh"),this.ignoreBounds||(_e(this.targetScale)<_e(this.minScale)?this.zoomTo(this.minScale,{friction:0}):this.targetScale>this.maxScale?this.zoomTo(this.maxScale,{friction:0}):this.state===xt.Init||this.checkBounds().inBounds||this.requestTick()),this.updateControls()}calculateBounds(){const{contentWidth:e,contentHeight:r}=this.calculateContentDim(this.target),{targetScale:s,lockedAxis:l}=this,{fitWidth:d,fitHeight:m}=this.contentRect;let u=0,g=0,S=0,k=0;const h=this.option("infinite");if(h===!0||l&&h===l)u=-1/0,S=1/0,g=-1/0,k=1/0;else{let{containerRect:f,contentRect:b}=this,y=_e(d*s,Wr),E=_e(m*s,Wr),{innerWidth:w,innerHeight:C}=f;if(f.width===y&&(w=f.width),f.width===E&&(C=f.height),e>w){S=.5*(e-w),u=-1*S;let _=.5*(b.right-b.left);u+=_,S+=_}if(d>w&&e<w&&(u-=.5*(d-w),S-=.5*(d-w)),r>C){k=.5*(r-C),g=-1*k;let _=.5*(b.bottom-b.top);g+=_,k+=_}m>C&&r<C&&(u-=.5*(m-C),S-=.5*(m-C))}return{x:{min:u,max:S},y:{min:g,max:k}}}getBounds(){const e=this.option("bounds");return e!==Ln?e:this.calculateBounds()}updateControls(){const e=this,r=e.container,{panMode:s,contentRect:l,targetScale:d,minScale:m}=e;let u=m,g=e.option("click")||!1;g&&(u=e.getNextScale(g));let S=e.canZoomIn(),k=e.canZoomOut(),h=s===Do&&!!this.option("touch"),f=k&&h;if(h&&(_e(d)<_e(m)&&!this.panOnlyZoomed&&(f=!0),(_e(l.width,1)>_e(l.fitWidth,1)||_e(l.height,1)>_e(l.fitHeight,1))&&(f=!0)),_e(l.width*d,1)<_e(l.fitWidth,1)&&(f=!1),s===An&&(f=!1),Zn(r,this.cn("isDraggable"),f),!this.option("zoom"))return;let b=S&&_e(u)>_e(d),y=!b&&!f&&k&&_e(u)<_e(d);Zn(r,this.cn("canZoomIn"),b),Zn(r,this.cn("canZoomOut"),y);for(const E of r.querySelectorAll("[data-panzoom-action]")){let w=!1,C=!1;switch(E.dataset.panzoomAction){case"zoomIn":S?w=!0:C=!0;break;case"zoomOut":k?w=!0:C=!0;break;case"toggleZoom":case"iterateZoom":S||k?w=!0:C=!0;const _=E.querySelector("g");_&&(_.style.display=S?"":"none")}w?(E.removeAttribute("disabled"),E.removeAttribute("tabindex")):C&&(E.setAttribute("disabled",""),E.setAttribute("tabindex","-1"))}}panTo({x:e=this.target.e,y:r=this.target.f,scale:s=this.targetScale,friction:l=this.option("friction"),angle:d=0,originX:m=0,originY:u=0,flipX:g=!1,flipY:S=!1,ignoreBounds:k=!1}){this.state!==xt.Destroy&&this.applyChange({panX:e-this.target.e,panY:r-this.target.f,scale:s/this.targetScale,angle:d,originX:m,originY:u,friction:l,flipX:g,flipY:S,ignoreBounds:k})}applyChange({panX:e=0,panY:r=0,scale:s=1,angle:l=0,originX:d=-this.current.e,originY:m=-this.current.f,friction:u=this.option("friction"),flipX:g=!1,flipY:S=!1,ignoreBounds:k=!1,bounce:h=this.option("bounce")}){const f=this.state;if(f===xt.Destroy)return;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.friction=u||0,this.ignoreBounds=k;const{current:b}=this,y=b.e,E=b.f,w=this.getMatrix(this.target);let C=new DOMMatrix().translate(y,E).translate(d,m).translate(e,r);if(this.option("zoom")){if(!k){const _=this.targetScale,T=this.minScale,M=this.maxScale;_*s<T&&(s=T/_),_*s>M&&(s=M/_)}C=C.scale(s)}C=C.translate(-d,-m).translate(-y,-E).multiply(w),l&&(C=C.rotate(l)),g&&(C=C.scale(-1,1)),S&&(C=C.scale(1,-1));for(const _ of si)_!=="e"&&_!=="f"&&(C[_]>this.minScale+1e-5||C[_]<this.minScale-1e-5)?this.target[_]=C[_]:this.target[_]=_e(C[_],Wr);(this.targetScale<this.scale||Math.abs(s-1)>.1||this.panMode===An||h===!1)&&!k&&this.clampTargetBounds(),f===xt.Init?this.animate():this.isResting||(this.state=xt.Panning,this.requestTick())}stop(e=!1){if(this.state===xt.Init||this.state===xt.Destroy)return;const r=this.isTicking;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const s of si)this.velocity[s]=0,e==="current"?this.current[s]=this.target[s]:e==="target"&&(this.target[s]=this.current[s]);this.setTransform(),kt(this.container,"is-scaling"),kt(this.container,"is-animating"),this.isTicking=!1,this.state=xt.Ready,r&&(this.emit("endAnimation"),this.updateControls())}requestTick(){this.isTicking||(this.emit("startAnimation"),this.updateControls(),We(this.container,"is-animating"),this.isScaling&&We(this.container,"is-scaling")),this.isTicking=!0,this.rAF||(this.rAF=requestAnimationFrame(()=>this.animate()))}panWithMouse(e,r=this.option("mouseMoveFriction")){if(this.pmme=e,this.panMode!==An||!e||_e(this.targetScale)<=_e(this.minScale))return;this.emit("mouseMove",e);const{container:s,containerRect:l,contentRect:d}=this,m=l.width,u=l.height,g=s.getBoundingClientRect(),S=(e.clientX||0)-g.left,k=(e.clientY||0)-g.top;let{contentWidth:h,contentHeight:f}=this.calculateContentDim(this.target);const b=this.option("mouseMoveFactor");b>1&&(h!==m&&(h*=b),f!==u&&(f*=b));let y=.5*(h-m)-S/m*100/100*(h-m);y+=.5*(d.right-d.left);let E=.5*(f-u)-k/u*100/100*(f-u);E+=.5*(d.bottom-d.top),this.applyChange({panX:y-this.target.e,panY:E-this.target.f,friction:r})}zoomWithWheel(e){if(this.state===xt.Destroy||this.state===xt.Init)return;const r=Date.now();if(r-this.pwt<45)return void e.preventDefault();this.pwt=r;var s=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(S,k){return Math.abs(k)>Math.abs(S)?k:S});const l=Math.max(-1,Math.min(1,s)),{targetScale:d,maxScale:m,minScale:u}=this;let g=d*(100+45*l)/100;_e(g)<_e(u)&&_e(d)<=_e(u)?(this.cwd+=Math.abs(l),g=u):_e(g)>_e(m)&&_e(d)>=_e(m)?(this.cwd+=Math.abs(l),g=m):(this.cwd=0,g=Math.max(Math.min(g,m),u)),this.cwd>this.option("wheelLimit")||(e.preventDefault(),_e(g)!==_e(d)&&this.zoomTo(g,{event:e}))}canZoomIn(){return this.option("zoom")&&(_e(this.contentRect.width,1)<_e(this.contentRect.fitWidth,1)||_e(this.targetScale)<_e(this.maxScale))}canZoomOut(){return this.option("zoom")&&_e(this.targetScale)>_e(this.minScale)}zoomIn(e=1.25,r){this.zoomTo(this.targetScale*e,r)}zoomOut(e=.8,r){this.zoomTo(this.targetScale*e,r)}zoomToFit(e){this.zoomTo("fit",e)}zoomToCover(e){this.zoomTo("cover",e)}zoomToFull(e){this.zoomTo("full",e)}zoomToMax(e){this.zoomTo("max",e)}toggleZoom(e){this.zoomTo(this.getNextScale("toggleZoom"),e)}toggleMax(e){this.zoomTo(this.getNextScale("toggleMax"),e)}toggleCover(e){this.zoomTo(this.getNextScale("toggleCover"),e)}iterateZoom(e){this.zoomTo("next",e)}zoomTo(e=1,{friction:r=Ln,originX:s=Ln,originY:l=Ln,event:d}={}){if(this.isContentLoading||this.state===xt.Destroy)return;const{targetScale:m,fullScale:u,maxScale:g,coverScale:S}=this;if(this.stop(),this.panMode===An&&(d=this.pmme||d),d||s===Ln||l===Ln){const h=this.content.getBoundingClientRect(),f=this.container.getBoundingClientRect(),b=d?d.clientX:f.left+.5*f.width,y=d?d.clientY:f.top+.5*f.height;s=b-h.left-.5*h.width,l=y-h.top-.5*h.height}let k=1;typeof e=="number"?k=e:e==="full"?k=u:e==="cover"?k=S:e==="max"?k=g:e==="fit"?k=1:e==="next"&&(k=this.getNextScale("iterateZoom")),k=k/m||1,r=r===Ln?k>1?.15:.25:r,this.applyChange({scale:k,originX:s,originY:l,friction:r}),d&&this.panMode===An&&this.panWithMouse(d,r)}rotateCCW(){this.applyChange({angle:-90})}rotateCW(){this.applyChange({angle:90})}flipX(){this.applyChange({flipX:!0})}flipY(){this.applyChange({flipY:!0})}fitX(){this.stop("target");const{containerRect:e,contentRect:r,target:s}=this;this.applyChange({panX:.5*e.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*e.height-(r.top+.5*r.fitHeight)-s.f,scale:e.width/r.fitWidth/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}fitY(){this.stop("target");const{containerRect:e,contentRect:r,target:s}=this;this.applyChange({panX:.5*e.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*e.innerHeight-(r.top+.5*r.fitHeight)-s.f,scale:e.height/r.fitHeight/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}toggleFS(){const{container:e}=this,r=this.cn("inFullscreen"),s=this.cn("htmlHasFullscreen");e.classList.toggle(r);const l=e.classList.contains(r);l?(document.documentElement.classList.add(s),document.addEventListener("keydown",this.onKeydown,!0)):(document.documentElement.classList.remove(s),document.removeEventListener("keydown",this.onKeydown,!0)),this.updateMetrics(),this.emit(l?"enterFS":"exitFS")}getMatrix(e=this.current){const{a:r,b:s,c:l,d,e:m,f:u}=e;return new DOMMatrix([r,s,l,d,m,u])}reset(e){if(this.state!==xt.Init&&this.state!==xt.Destroy){this.stop("current");for(const r of si)this.target[r]=qr[r];this.target.a=this.minScale,this.target.d=this.minScale,this.clampTargetBounds(),this.isResting||(this.friction=e===void 0?this.option("friction"):e,this.state=xt.Panning,this.requestTick())}}destroy(){this.stop(),this.state=xt.Destroy,this.detachEvents(),this.detachObserver();const{container:e,content:r}=this,s=this.option("classes")||{};for(const l of Object.values(s))e.classList.remove(l+"");r&&(r.removeEventListener("load",this.onLoad),r.removeEventListener("error",this.onError)),this.detachPlugins()}}Object.defineProperty(Vi,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:sd}),Object.defineProperty(Vi,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}});const Po=function(p,e){let r=!0;return(...s)=>{r&&(r=!1,p(...s),setTimeout(()=>{r=!0},e))}},Ro=(p,e)=>{let r=[];return p.childNodes.forEach(s=>{s.nodeType!==Node.ELEMENT_NODE||e&&!s.matches(e)||r.push(s)}),r},cd={viewport:null,track:null,enabled:!0,slides:[],axis:"x",transition:"fade",preload:1,slidesPerPage:"auto",initialPage:0,friction:.12,Panzoom:{decelFriction:.12},center:!0,infinite:!0,fill:!0,dragFree:!1,adaptiveHeight:!1,direction:"ltr",classes:{container:"f-carousel",viewport:"f-carousel__viewport",track:"f-carousel__track",slide:"f-carousel__slide",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",inTransition:"in-transition",isSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}};var Yt;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Destroy=2]="Destroy"})(Yt||(Yt={}));const Ca=p=>{if(typeof p=="string"||p instanceof HTMLElement)p={html:p};else{const e=p.thumb;e!==void 0&&(typeof e=="string"&&(p.thumbSrc=e),e instanceof HTMLImageElement&&(p.thumbEl=e,p.thumbElSrc=e.src,p.thumbSrc=e.src),delete p.thumb)}return Object.assign({html:"",el:null,isDom:!1,class:"",customClass:"",index:-1,dim:0,gap:0,pos:0,transition:!1},p)},ud=(p={})=>Object.assign({index:-1,slides:[],dim:0,pos:-1},p);class Vn extends ca{constructor(e,r){super(r),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:e})}attach(){}detach(){}}const dd={classes:{list:"f-carousel__dots",isDynamic:"is-dynamic",hasDots:"has-dots",dot:"f-carousel__dot",isBeforePrev:"is-before-prev",isPrev:"is-prev",isCurrent:"is-current",isNext:"is-next",isAfterNext:"is-after-next"},dotTpl:'<button type="button" data-carousel-page="%i" aria-label="{{GOTO}}"><span class="f-carousel__dot" aria-hidden="true"></span></button>',dynamicFrom:11,maxCount:1/0,minCount:2};class Ls extends Vn{constructor(){super(...arguments),Object.defineProperty(this,"isDynamic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){this.refresh()}build(){let e=this.list;if(!e){e=document.createElement("ul"),We(e,this.cn("list")),e.setAttribute("role","tablist");const r=this.instance.container;r.appendChild(e),We(r,this.cn("hasDots")),this.list=e}return e}refresh(){var e;const r=this.instance.pages.length,s=Math.min(2,this.option("minCount")),l=Math.max(2e3,this.option("maxCount")),d=this.option("dynamicFrom");if(r<s||r>l)return void this.cleanup();const m=typeof d=="number"&&r>5&&r>=d,u=!this.list||this.isDynamic!==m||this.list.children.length!==r;u&&this.cleanup();const g=this.build();if(Zn(g,this.cn("isDynamic"),!!m),u)for(let h=0;h<r;h++)g.append(this.createItem(h));let S,k=0;for(const h of[...g.children]){const f=k===this.instance.page;f&&(S=h),Zn(h,this.cn("isCurrent"),f),(e=h.children[0])===null||e===void 0||e.setAttribute("aria-selected",f?"true":"false");for(const b of["isBeforePrev","isPrev","isNext","isAfterNext"])kt(h,this.cn(b));k++}if(S=S||g.firstChild,m&&S){const h=S.previousElementSibling,f=h&&h.previousElementSibling;We(h,this.cn("isPrev")),We(f,this.cn("isBeforePrev"));const b=S.nextElementSibling,y=b&&b.nextElementSibling;We(b,this.cn("isNext")),We(y,this.cn("isAfterNext"))}this.isDynamic=m}createItem(e=0){var r;const s=document.createElement("li");s.setAttribute("role","presentation");const l=Xn(this.instance.localize(this.option("dotTpl"),[["%d",e+1]]).replace(/\%i/g,e+""));return s.appendChild(l),(r=s.children[0])===null||r===void 0||r.setAttribute("role","tab"),s}cleanup(){this.list&&(this.list.remove(),this.list=null),this.isDynamic=!1,kt(this.instance.container,this.cn("hasDots"))}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(Ls,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:dd});const Yr="disabled",Kr="next",Io="prev";class Ds extends Vn{constructor(){super(...arguments),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isDom",{enumerable:!0,configurable:!0,writable:!0,value:!1})}onRefresh(){const e=this.instance,r=e.pages.length,s=e.page;if(r<2)return void this.cleanup();this.build();let l=this.prev,d=this.next;l&&d&&(l.removeAttribute(Yr),d.removeAttribute(Yr),e.isInfinite||(s<=0&&l.setAttribute(Yr,""),s>=r-1&&d.setAttribute(Yr,"")))}addBtn(e){var r;const s=this.instance,l=document.createElement("button");l.setAttribute("tabindex","0"),l.setAttribute("title",s.localize(`{{${e.toUpperCase()}}}`)),We(l,this.cn("button")+" "+this.cn(e===Kr?"isNext":"isPrev"));const d=s.isRTL?e===Kr?Io:Kr:e;var m;return l.innerHTML=s.localize(this.option(`${d}Tpl`)),l.dataset[`carousel${m=e,m?m.match("^[a-z]")?m.charAt(0).toUpperCase()+m.substring(1):m:""}`]="true",(r=this.container)===null||r===void 0||r.appendChild(l),l}build(){const e=this.instance.container,r=this.cn("container");let{container:s,prev:l,next:d}=this;s||(s=e.querySelector("."+r),this.isDom=!!s),s||(s=document.createElement("div"),We(s,r),e.appendChild(s)),this.container=s,d||(d=s.querySelector("[data-carousel-next]")),d||(d=this.addBtn(Kr)),this.next=d,l||(l=s.querySelector("[data-carousel-prev]")),l||(l=this.addBtn(Io)),this.prev=l}cleanup(){this.isDom||(this.prev&&this.prev.remove(),this.next&&this.next.remove(),this.container&&this.container.remove()),this.prev=null,this.next=null,this.container=null,this.isDom=!1}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(Ds,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{container:"f-carousel__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"},nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>'}});class Os extends Vn{constructor(){super(...arguments),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:null})}addAsTargetFor(e){this.target=this.instance,this.nav=e,this.attachEvents()}addAsNavFor(e){this.nav=this.instance,this.target=e,this.attachEvents()}attachEvents(){const{nav:e,target:r}=this;e&&r&&(e.options.initialSlide=r.options.initialPage,e.state===Yt.Ready?this.onNavReady(e):e.on("ready",this.onNavReady),r.state===Yt.Ready?this.onTargetReady(r):r.on("ready",this.onTargetReady))}onNavReady(e){e.on("createSlide",this.onNavCreateSlide),e.on("Panzoom.click",this.onNavClick),e.on("Panzoom.touchEnd",this.onNavTouch),this.onTargetChange()}onTargetReady(e){e.on("change",this.onTargetChange),e.on("Panzoom.refresh",this.onTargetChange),this.onTargetChange()}onNavClick(e,r,s){this.onNavTouch(e,e.panzoom,s)}onNavTouch(e,r,s){var l,d;if(Math.abs(r.dragOffset.x)>3||Math.abs(r.dragOffset.y)>3)return;const m=s.target,{nav:u,target:g}=this;if(!u||!g||!m)return;const S=m.closest("[data-index]");if(s.stopPropagation(),s.preventDefault(),!S)return;const k=parseInt(S.dataset.index||"",10)||0,h=g.getPageForSlide(k),f=u.getPageForSlide(k);u.slideTo(f),g.slideTo(h,{friction:((d=(l=this.nav)===null||l===void 0?void 0:l.plugins)===null||d===void 0?void 0:d.Sync.option("friction"))||0}),this.markSelectedSlide(k)}onNavCreateSlide(e,r){r.index===this.selectedIndex&&this.markSelectedSlide(r.index)}onTargetChange(){var e,r;const{target:s,nav:l}=this;if(!s||!l||l.state!==Yt.Ready||s.state!==Yt.Ready)return;const d=(r=(e=s.pages[s.page])===null||e===void 0?void 0:e.slides[0])===null||r===void 0?void 0:r.index,m=l.getPageForSlide(d);this.markSelectedSlide(d),l.slideTo(m,l.prevPage===null&&s.prevPage===null?{friction:0}:void 0)}markSelectedSlide(e){const r=this.nav;r&&r.state===Yt.Ready&&(this.selectedIndex=e,[...r.slides].map(s=>{s.el&&s.el.classList[s.index===e?"add":"remove"]("is-nav-selected")}))}attach(){const e=this;let r=e.options.target,s=e.options.nav;r?e.addAsNavFor(r):s&&e.addAsTargetFor(s)}detach(){const e=this,r=e.nav,s=e.target;r&&(r.off("ready",e.onNavReady),r.off("createSlide",e.onNavCreateSlide),r.off("Panzoom.click",e.onNavClick),r.off("Panzoom.touchEnd",e.onNavTouch)),e.nav=null,s&&(s.off("ready",e.onTargetReady),s.off("refresh",e.onTargetChange),s.off("change",e.onTargetChange)),e.target=null}}Object.defineProperty(Os,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{friction:.35}});const fd={Navigation:Ds,Dots:Ls,Sync:Os},Gr="animationend",Ho="isSelected",Xr="slide";class zi extends io{get axis(){return this.isHorizontal?"e":"f"}get isEnabled(){return this.state===Yt.Ready}get isInfinite(){let e=!1;const{contentDim:r,viewportDim:s,pages:l,slides:d}=this,m=d[0];return l.length>=2&&m&&r+m.dim>=s&&(e=this.option("infinite")),e}get isRTL(){return this.option("direction")==="rtl"}get isHorizontal(){return this.option("axis")==="x"}constructor(e,r={},s={}){if(super(),Object.defineProperty(this,"bp",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lp",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"userOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Yt.Init}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"prevPage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"slides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inTransition",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"contentDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"viewportDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),typeof e=="string"&&(e=document.querySelector(e)),!e||!vn(e))throw new Error("No Element found");this.container=e,this.slideNext=Po(this.slideNext.bind(this),150),this.slidePrev=Po(this.slidePrev.bind(this),150),this.userOptions=r,this.userPlugins=s,queueMicrotask(()=>{this.processOptions()})}processOptions(){var e,r;const s=bn({},zi.defaults,this.userOptions);let l="";const d=s.breakpoints;if(d&&Va(d))for(const[m,u]of Object.entries(d))window.matchMedia(m).matches&&Va(u)&&(l+=m,bn(s,u));l===this.bp&&this.state!==Yt.Init||(this.bp=l,this.state===Yt.Ready&&(s.initialSlide=((r=(e=this.pages[this.page])===null||e===void 0?void 0:e.slides[0])===null||r===void 0?void 0:r.index)||0),this.state!==Yt.Init&&this.destroy(),super.setOptions(s),this.option("enabled")===!1?this.attachEvents():setTimeout(()=>{this.init()},0))}init(){this.state=Yt.Init,this.emit("init"),this.attachPlugins(Object.assign(Object.assign({},zi.Plugins),this.userPlugins)),this.emit("attachPlugins"),this.initLayout(),this.initSlides(),this.updateMetrics(),this.setInitialPosition(),this.initPanzoom(),this.attachEvents(),this.state=Yt.Ready,this.emit("ready")}initLayout(){const{container:e}=this,r=this.option("classes");We(e,this.cn("container")),Zn(e,r.isLTR,!this.isRTL),Zn(e,r.isRTL,this.isRTL),Zn(e,r.isVertical,!this.isHorizontal),Zn(e,r.isHorizontal,this.isHorizontal);let s=this.option("viewport")||e.querySelector(`.${r.viewport}`);s||(s=document.createElement("div"),We(s,r.viewport),s.append(...Ro(e,`.${r.slide}`)),e.prepend(s)),s.addEventListener("scroll",this.onScroll);let l=this.option("track")||e.querySelector(`.${r.track}`);l||(l=document.createElement("div"),We(l,r.track),l.append(...Array.from(s.childNodes))),l.setAttribute("aria-live","polite"),s.contains(l)||s.prepend(l),this.viewport=s,this.track=l,this.emit("initLayout")}initSlides(){const{track:e}=this;if(!e)return;const r=[...this.slides],s=[];[...Ro(e,`.${this.cn(Xr)}`)].forEach(l=>{if(vn(l)){const d=Ca({el:l,isDom:!0,index:this.slides.length});s.push(d)}});for(let l of[...this.option("slides",[])||[],...r])s.push(Ca(l));this.slides=s;for(let l=0;l<this.slides.length;l++)this.slides[l].index=l;for(const l of s)this.emit("beforeInitSlide",l,l.index),this.emit("initSlide",l,l.index);this.emit("initSlides")}setInitialPage(){const e=this.option("initialSlide");this.page=typeof e=="number"?this.getPageForSlide(e):parseInt(this.option("initialPage",0)+"",10)||0}setInitialPosition(){const{track:e,pages:r,isHorizontal:s}=this;if(!e||!r.length)return;let l=this.page;r[l]||(this.page=l=0);const d=(r[l].pos||0)*(this.isRTL&&s?1:-1),m=s?`${d}px`:"0",u=s?"0":`${d}px`;e.style.transform=`translate3d(${m}, ${u}, 0) scale(1)`,this.option("adaptiveHeight")&&this.setViewportHeight()}initPanzoom(){this.panzoom&&(this.panzoom.destroy(),this.panzoom=null);const e=this.option("Panzoom")||{};this.panzoom=new Vi(this.viewport,bn({},{content:this.track,zoom:!1,panOnlyZoomed:!1,lockAxis:this.isHorizontal?"x":"y",infinite:this.isInfinite,click:!1,dblClick:!1,touch:r=>!(this.pages.length<2&&!r.options.infinite),bounds:()=>this.getBounds(),maxVelocity:r=>Math.abs(r.target[this.axis]-r.current[this.axis])<2*this.viewportDim?100:0},e)),this.panzoom.on("*",(r,s,...l)=>{this.emit(`Panzoom.${s}`,r,...l)}),this.panzoom.on("decel",this.onDecel),this.panzoom.on("refresh",this.onRefresh),this.panzoom.on("beforeTransform",this.onBeforeTransform),this.panzoom.on("endAnimation",this.onEndAnimation)}attachEvents(){const e=this.container;e&&(e.addEventListener("click",this.onClick,{passive:!1,capture:!1}),e.addEventListener("slideTo",this.onSlideTo)),window.addEventListener("resize",this.onResize)}createPages(){let e=[];const{contentDim:r,viewportDim:s}=this;let l=this.option("slidesPerPage");l=(l==="auto"||r<=s)&&this.option("fill")!==!1?1/0:parseFloat(l+"");let d=0,m=0,u=0;for(const g of this.slides)(!e.length||m+g.dim-s>.05||u>=l)&&(e.push(ud()),d=e.length-1,m=0,u=0),e[d].slides.push(g),m+=g.dim+g.gap,u++;return e}processPages(){const e=this.pages,{contentDim:r,viewportDim:s,isInfinite:l}=this,d=this.option("center"),m=this.option("fill"),u=m&&d&&r>s&&!l;if(e.forEach((k,h)=>{var f;k.index=h,k.pos=((f=k.slides[0])===null||f===void 0?void 0:f.pos)||0,k.dim=0;for(const[b,y]of k.slides.entries())k.dim+=y.dim,b<k.slides.length-1&&(k.dim+=y.gap);u&&k.pos+.5*k.dim<.5*s?k.pos=0:u&&k.pos+.5*k.dim>=r-.5*s?k.pos=r-s:d&&(k.pos+=-.5*(s-k.dim))}),e.forEach(k=>{m&&!l&&r>s&&(k.pos=Math.max(k.pos,0),k.pos=Math.min(k.pos,r-s)),k.pos=_e(k.pos,1e3),k.dim=_e(k.dim,1e3),Math.abs(k.pos)<=.1&&(k.pos=0)}),l)return e;const g=[];let S;return e.forEach(k=>{const h=Object.assign({},k);S&&h.pos===S.pos?(S.dim+=h.dim,S.slides=[...S.slides,...h.slides]):(h.index=g.length,S=h,g.push(h))}),g}getPageFromIndex(e=0){const r=this.pages.length;let s;return e=parseInt((e||0).toString())||0,s=this.isInfinite?(e%r+r)%r:Math.max(Math.min(e,r-1),0),s}getSlideMetrics(e){var r,s;const l=this.isHorizontal?"width":"height";let d=0,m=0,u=e.el;const g=!(!u||u.parentNode);if(u?d=parseFloat(u.dataset[l]||"")||0:(u=document.createElement("div"),u.style.visibility="hidden",(this.track||document.body).prepend(u)),We(u,this.cn(Xr)+" "+e.class+" "+e.customClass),d)u.style[l]=`${d}px`,u.style[l==="width"?"height":"width"]="";else{g&&(this.track||document.body).prepend(u),d=u.getBoundingClientRect()[l]*Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1);let k=u[this.isHorizontal?"offsetWidth":"offsetHeight"];k-1>d&&(d=k)}const S=getComputedStyle(u);return S.boxSizing==="content-box"&&(this.isHorizontal?(d+=parseFloat(S.paddingLeft)||0,d+=parseFloat(S.paddingRight)||0):(d+=parseFloat(S.paddingTop)||0,d+=parseFloat(S.paddingBottom)||0)),m=parseFloat(S[this.isHorizontal?"marginRight":"marginBottom"])||0,g?(s=u.parentElement)===null||s===void 0||s.removeChild(u):e.el||u.remove(),{dim:_e(d,1e3),gap:_e(m,1e3)}}getBounds(){const{isInfinite:e,isRTL:r,isHorizontal:s,pages:l}=this;let d={min:0,max:0};if(e)d={min:-1/0,max:1/0};else if(l.length){const m=l[0].pos,u=l[l.length-1].pos;d=r&&s?{min:m,max:u}:{min:-1*u,max:-1*m}}return{x:s?d:{min:0,max:0},y:s?{min:0,max:0}:d}}repositionSlides(){let e,{isHorizontal:r,isRTL:s,isInfinite:l,viewport:d,viewportDim:m,contentDim:u,page:g,pages:S,slides:k,panzoom:h}=this,f=0,b=0,y=0,E=0;h?E=-1*h.current[this.axis]:S[g]&&(E=S[g].pos||0),e=r?s?"right":"left":"top",s&&r&&(E*=-1);for(const T of k){const M=T.el;M?(e==="top"?(M.style.right="",M.style.left=""):M.style.top="",T.index!==f?M.style[e]=b===0?"":`${_e(b,1e3)}px`:M.style[e]="",y+=T.dim+T.gap,f++):b+=T.dim+T.gap}if(l&&y&&d){let T=getComputedStyle(d),M="padding",v=r?"Right":"Bottom",D=parseFloat(T[M+(r?"Left":"Top")]);E-=D,m+=D,m+=parseFloat(T[M+v]);for(const N of k)N.el&&(_e(N.pos)<_e(m)&&_e(N.pos+N.dim+N.gap)<_e(E)&&_e(E)>_e(u-m)&&(N.el.style[e]=`${_e(b+y,1e3)}px`),_e(N.pos+N.gap)>=_e(u-m)&&_e(N.pos)>_e(E+m)&&_e(E)<_e(m)&&(N.el.style[e]=`-${_e(y,1e3)}px`))}let w,C,_=[...this.inTransition];if(_.length>1&&(w=S[_[0]],C=S[_[1]]),w&&C){let T=0;for(const M of k)M.el?this.inTransition.has(M.index)&&w.slides.indexOf(M)<0&&(M.el.style[e]=`${_e(T+(w.pos-C.pos),1e3)}px`):T+=M.dim+M.gap}}createSlideEl(e){const{track:r,slides:s}=this;if(!r||!e||e.el&&e.el.parentNode)return;const l=e.el||document.createElement("div");We(l,this.cn(Xr)),We(l,e.class),We(l,e.customClass);const d=e.html;d&&(d instanceof HTMLElement?l.appendChild(d):l.innerHTML=e.html+"");const m=[];s.forEach((k,h)=>{k.el&&m.push(h)});const u=e.index;let g=null;m.length&&(g=s[m.reduce((k,h)=>Math.abs(h-u)<Math.abs(k-u)?h:k)]);const S=g&&g.el&&g.el.parentNode?g.index<e.index?g.el.nextSibling:g.el:null;r.insertBefore(l,r.contains(S)?S:null),e.el=l,this.emit("createSlide",e)}removeSlideEl(e,r=!1){const s=e==null?void 0:e.el;if(!s||!s.parentNode)return;const l=this.cn(Ho);if(s.classList.contains(l)&&(kt(s,l),this.emit("unselectSlide",e)),e.isDom&&!r)return s.removeAttribute("aria-hidden"),s.removeAttribute("data-index"),void(s.style.left="");this.emit("removeSlide",e);const d=new CustomEvent(Gr);s.dispatchEvent(d),e.el&&(e.el.remove(),e.el=null)}transitionTo(e=0,r=this.option("transition")){var s,l,d,m;if(!r)return!1;const u=this.page,{pages:g,panzoom:S}=this;e=parseInt((e||0).toString())||0;const k=this.getPageFromIndex(e);if(!S||!g[k]||g.length<2||Math.abs((((l=(s=g[u])===null||s===void 0?void 0:s.slides[0])===null||l===void 0?void 0:l.dim)||0)-this.viewportDim)>1)return!1;let h=e>u?1:-1;this.isInfinite&&(u===0&&e===g.length-1&&(h=-1),u===g.length-1&&e===0&&(h=1));const f=g[k].pos*(this.isRTL?1:-1);if(u===k&&Math.abs(f-S.target[this.axis])<1)return!1;this.clearTransitions();const b=S.isResting;We(this.container,this.cn("inTransition"));const y=((d=g[u])===null||d===void 0?void 0:d.slides[0])||null,E=((m=g[k])===null||m===void 0?void 0:m.slides[0])||null;this.inTransition.add(E.index),this.createSlideEl(E);let w=y.el,C=E.el;b||r===Xr||(r="fadeFast",w=null);const _=this.isRTL?"next":"prev",T=this.isRTL?"prev":"next";return w&&(this.inTransition.add(y.index),y.transition=r,w.addEventListener(Gr,this.onAnimationEnd),w.classList.add(`f-${r}Out`,`to-${h>0?T:_}`)),C&&(E.transition=r,C.addEventListener(Gr,this.onAnimationEnd),C.classList.add(`f-${r}In`,`from-${h>0?_:T}`)),S.current[this.axis]=f,S.target[this.axis]=f,S.requestTick(),this.onChange(k),!0}manageSlideVisiblity(){const e=new Set,r=new Set,s=this.getVisibleSlides(parseFloat(this.option("preload",0)+"")||0);for(const l of this.slides)s.has(l)?e.add(l):r.add(l);for(const l of this.inTransition)e.add(this.slides[l]);for(const l of e)this.createSlideEl(l),this.lazyLoadSlide(l);for(const l of r)e.has(l)||this.removeSlideEl(l);this.markSelectedSlides(),this.repositionSlides()}markSelectedSlides(){if(!this.pages[this.page]||!this.pages[this.page].slides)return;const e="aria-hidden";let r=this.cn(Ho);if(r)for(const s of this.slides){const l=s.el;l&&(l.dataset.index=`${s.index}`,l.classList.contains("f-thumbs__slide")?this.getVisibleSlides(0).has(s)?l.removeAttribute(e):l.setAttribute(e,"true"):this.pages[this.page].slides.includes(s)?(l.classList.contains(r)||(We(l,r),this.emit("selectSlide",s)),l.removeAttribute(e)):(l.classList.contains(r)&&(kt(l,r),this.emit("unselectSlide",s)),l.setAttribute(e,"true")))}}flipInfiniteTrack(){const{axis:e,isHorizontal:r,isInfinite:s,isRTL:l,viewportDim:d,contentDim:m}=this,u=this.panzoom;if(!u||!s)return;let g=u.current[e],S=u.target[e]-g,k=0,h=.5*d;l&&r?(g<-h&&(k=-1,g+=m),g>m-h&&(k=1,g-=m)):(g>h&&(k=1,g-=m),g<-m+h&&(k=-1,g+=m)),k&&(u.current[e]=g,u.target[e]=g+S)}lazyLoadImg(e,r){const s=this,l="f-fadeIn",d="is-preloading";let m=!1,u=null;const g=()=>{m||(m=!0,u&&(u.remove(),u=null),kt(r,d),r.complete&&(We(r,l),setTimeout(()=>{kt(r,l)},350)),this.option("adaptiveHeight")&&e.el&&this.pages[this.page].slides.indexOf(e)>-1&&(s.updateMetrics(),s.setViewportHeight()),this.emit("load",e))};We(r,d),r.src=r.dataset.lazySrcset||r.dataset.lazySrc||"",delete r.dataset.lazySrc,delete r.dataset.lazySrcset,r.addEventListener("error",()=>{g()}),r.addEventListener("load",()=>{g()}),setTimeout(()=>{const S=r.parentNode;S&&e.el&&(r.complete?g():m||(u=Xn(ro),S.insertBefore(u,r)))},300)}lazyLoadSlide(e){const r=e&&e.el;if(!r)return;const s=new Set;let l=Array.from(r.querySelectorAll("[data-lazy-src],[data-lazy-srcset]"));r.dataset.lazySrc&&l.push(r),l.map(d=>{d instanceof HTMLImageElement?s.add(d):d instanceof HTMLElement&&d.dataset.lazySrc&&(d.style.backgroundImage=`url('${d.dataset.lazySrc}')`,delete d.dataset.lazySrc)});for(const d of s)this.lazyLoadImg(e,d)}onAnimationEnd(e){var r;const s=e.target,l=s?parseInt(s.dataset.index||"",10)||0:-1,d=this.slides[l],m=e.animationName;if(!s||!d||!m)return;const u=!!this.inTransition.has(l)&&d.transition;u&&m.substring(0,u.length+2)===`f-${u}`&&this.inTransition.delete(l),this.inTransition.size||this.clearTransitions(),l===this.page&&(!((r=this.panzoom)===null||r===void 0)&&r.isResting)&&this.emit("settle")}onDecel(e,r=0,s=0,l=0,d=0){if(this.option("dragFree"))return void this.setPageFromPosition();const{isRTL:m,isHorizontal:u,axis:g,pages:S}=this,k=S.length,h=Math.abs(Math.atan2(s,r)/(Math.PI/180));let f=0;if(f=h>45&&h<135?u?0:s:u?r:0,!k)return;let b=this.page,y=m&&u?1:-1;const E=e.current[g]*y;let{pageIndex:w}=this.getPageFromPosition(E);Math.abs(f)>5?(S[b].dim<document.documentElement["client"+(this.isHorizontal?"Width":"Height")]-1&&(b=w),b=m&&u?f<0?b-1:b+1:f<0?b+1:b-1):b=l===0&&d===0?b:w,this.slideTo(b,{transition:!1,friction:e.option("decelFriction")})}onClick(e){const r=e.target,s=r&&vn(r)?r.dataset:null;let l,d;s&&(s.carouselPage!==void 0?(d="slideTo",l=s.carouselPage):s.carouselNext!==void 0?d="slideNext":s.carouselPrev!==void 0&&(d="slidePrev")),d?(e.preventDefault(),e.stopPropagation(),r&&!r.hasAttribute("disabled")&&this[d](l)):this.emit("click",e)}onSlideTo(e){const r=e.detail||0;this.slideTo(this.getPageForSlide(r),{friction:0})}onChange(e,r=0){const s=this.page;this.prevPage=s,this.page=e,this.option("adaptiveHeight")&&this.setViewportHeight(),e!==s&&(this.markSelectedSlides(),this.emit("change",e,s,r))}onRefresh(){let e=this.contentDim,r=this.viewportDim;this.updateMetrics(),this.contentDim===e&&this.viewportDim===r||this.slideTo(this.page,{friction:0,transition:!1})}onScroll(){var e;(e=this.viewport)===null||e===void 0||e.scroll(0,0)}onResize(){this.option("breakpoints")&&this.processOptions()}onBeforeTransform(e){this.lp!==e.current[this.axis]&&(this.flipInfiniteTrack(),this.manageSlideVisiblity()),this.lp=e.current.e}onEndAnimation(){this.inTransition.size||this.emit("settle")}reInit(e=null,r=null){this.destroy(),this.state=Yt.Init,this.prevPage=null,this.userOptions=e||this.userOptions,this.userPlugins=r||this.userPlugins,this.processOptions()}slideTo(e=0,{friction:r=this.option("friction"),transition:s=this.option("transition")}={}){if(this.state===Yt.Destroy)return;e=parseInt((e||0).toString())||0;const l=this.getPageFromIndex(e),{axis:d,isHorizontal:m,isRTL:u,pages:g,panzoom:S}=this,k=g.length,h=u&&m?1:-1;if(!S||!k)return;if(this.page!==l){const b=new Event("beforeChange",{bubbles:!0,cancelable:!0});if(this.emit("beforeChange",b,e),b.defaultPrevented)return}if(this.transitionTo(e,s))return;let f=g[l].pos;if(this.isInfinite){const b=this.contentDim,y=S.target[d]*h;k===2?f+=b*Math.floor(parseFloat(e+"")/2):f=[f,f-b,f+b].reduce(function(E,w){return Math.abs(w-y)<Math.abs(E-y)?w:E})}f*=h,Math.abs(S.target[d]-f)<1||(S.panTo({x:m?f:0,y:m?0:f,friction:r}),this.onChange(l))}slideToClosest(e){if(this.panzoom){const{pageIndex:r}=this.getPageFromPosition();this.slideTo(r,e)}}slideNext(){this.slideTo(this.page+1)}slidePrev(){this.slideTo(this.page-1)}clearTransitions(){this.inTransition.clear(),kt(this.container,this.cn("inTransition"));const e=["to-prev","to-next","from-prev","from-next"];for(const r of this.slides){const s=r.el;if(s){s.removeEventListener(Gr,this.onAnimationEnd),s.classList.remove(...e);const l=r.transition;l&&s.classList.remove(`f-${l}Out`,`f-${l}In`)}}this.manageSlideVisiblity()}addSlide(e,r){var s,l,d,m;const u=this.panzoom,g=((s=this.pages[this.page])===null||s===void 0?void 0:s.pos)||0,S=((l=this.pages[this.page])===null||l===void 0?void 0:l.dim)||0,k=this.contentDim<this.viewportDim;let h=Array.isArray(r)?r:[r];const f=[];for(const b of h)f.push(Ca(b));this.slides.splice(e,0,...f);for(let b=0;b<this.slides.length;b++)this.slides[b].index=b;for(const b of f)this.emit("beforeInitSlide",b,b.index);if(this.page>=e&&(this.page+=f.length),this.updateMetrics(),u){const b=((d=this.pages[this.page])===null||d===void 0?void 0:d.pos)||0,y=((m=this.pages[this.page])===null||m===void 0?void 0:m.dim)||0,E=this.pages.length||1,w=this.isRTL?S-y:y-S,C=this.isRTL?g-b:b-g;k&&E===1?(e<=this.page&&(u.current[this.axis]-=w,u.target[this.axis]-=w),u.panTo({[this.isHorizontal?"x":"y"]:-1*b})):C&&e<=this.page&&(u.target[this.axis]-=C,u.current[this.axis]-=C,u.requestTick())}for(const b of f)this.emit("initSlide",b,b.index)}prependSlide(e){this.addSlide(0,e)}appendSlide(e){this.addSlide(this.slides.length,e)}removeSlide(e){const r=this.slides.length;e=(e%r+r)%r;const s=this.slides[e];if(s){this.removeSlideEl(s,!0),this.slides.splice(e,1);for(let l=0;l<this.slides.length;l++)this.slides[l].index=l;this.updateMetrics(),this.slideTo(this.page,{friction:0,transition:!1}),this.emit("destroySlide",s)}}updateMetrics(){const{panzoom:e,viewport:r,track:s,slides:l,isHorizontal:d,isInfinite:m}=this;if(!s)return;const u=d?"width":"height",g=d?"offsetWidth":"offsetHeight";if(r){let h=Math.max(r[g],_e(r.getBoundingClientRect()[u],1e3)),f=getComputedStyle(r),b="padding",y=d?"Right":"Bottom";h-=parseFloat(f[b+(d?"Left":"Top")])+parseFloat(f[b+y]),this.viewportDim=h}let S,k=0;for(const[h,f]of l.entries()){let b=0,y=0;!f.el&&S?(b=S.dim,y=S.gap):({dim:b,gap:y}=this.getSlideMetrics(f),S=f),b=_e(b,1e3),y=_e(y,1e3),f.dim=b,f.gap=y,f.pos=k,k+=b,(m||h<l.length-1)&&(k+=y)}k=_e(k,1e3),this.contentDim=k,e&&(e.contentRect[u]=k,e.contentRect[d?"fullWidth":"fullHeight"]=k),this.pages=this.createPages(),this.pages=this.processPages(),this.state===Yt.Init&&this.setInitialPage(),this.page=Math.max(0,Math.min(this.page,this.pages.length-1)),this.manageSlideVisiblity(),this.emit("refresh")}getProgress(e,r=!1,s=!1){e===void 0&&(e=this.page);const l=this,d=l.panzoom,m=l.contentDim,u=l.pages[e]||0;if(!u||!d)return e>this.page?-1:1;let g=-1*d.current.e,S=_e((g-u.pos)/(1*u.dim),1e3),k=S,h=S;this.isInfinite&&s!==!0&&(k=_e((g-u.pos+m)/(1*u.dim),1e3),h=_e((g-u.pos-m)/(1*u.dim),1e3));let f=[S,k,h].reduce(function(b,y){return Math.abs(y)<Math.abs(b)?y:b});return r?f:f>1?1:f<-1?-1:f}setViewportHeight(){const{page:e,pages:r,viewport:s,isHorizontal:l}=this;if(!s||!r[e])return;let d=0;l&&this.track&&(this.track.style.height="auto",r[e].slides.forEach(m=>{m.el&&(d=Math.max(d,m.el.offsetHeight))})),s.style.height=d?`${d}px`:""}getPageForSlide(e){for(const r of this.pages)for(const s of r.slides)if(s.index===e)return r.index;return-1}getVisibleSlides(e=0){var r;const s=new Set;let{panzoom:l,contentDim:d,viewportDim:m,pages:u,page:g}=this;if(m){d=d+((r=this.slides[this.slides.length-1])===null||r===void 0?void 0:r.gap)||0;let S=0;S=l&&l.state!==xt.Init&&l.state!==xt.Destroy?-1*l.current[this.axis]:u[g]&&u[g].pos||0,this.isInfinite&&(S-=Math.floor(S/d)*d),this.isRTL&&this.isHorizontal&&(S*=-1);const k=S-m*e,h=S+m*(e+1),f=this.isInfinite?[-1,0,1]:[0];for(const b of this.slides)for(const y of f){const E=b.pos+y*d,w=E+b.dim+b.gap;E<h&&w>k&&s.add(b)}}return s}getPageFromPosition(e){const{viewportDim:r,contentDim:s,slides:l,pages:d,panzoom:m}=this,u=d.length,g=l.length,S=l[0],k=l[g-1],h=this.option("center");let f=0,b=0,y=0,E=e===void 0?-1*((m==null?void 0:m.target[this.axis])||0):e;h&&(E+=.5*r),this.isInfinite?(E<S.pos-.5*k.gap&&(E-=s,y=-1),E>k.pos+k.dim+.5*k.gap&&(E-=s,y=1)):E=Math.max(S.pos||0,Math.min(E,k.pos));let w=k,C=l.find(_=>{const T=_.pos-.5*w.gap,M=_.pos+_.dim+.5*_.gap;return w=_,E>=T&&E<M});return C||(C=k),b=this.getPageForSlide(C.index),f=b+y*u,{page:f,pageIndex:b}}setPageFromPosition(){const{pageIndex:e}=this.getPageFromPosition();this.onChange(e)}destroy(){if([Yt.Destroy].includes(this.state))return;this.state=Yt.Destroy;const{container:e,viewport:r,track:s,slides:l,panzoom:d}=this,m=this.option("classes");e.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),e.removeEventListener("slideTo",this.onSlideTo),window.removeEventListener("resize",this.onResize),d&&(d.destroy(),this.panzoom=null),l&&l.forEach(g=>{this.removeSlideEl(g)}),this.detachPlugins(),r&&(r.removeEventListener("scroll",this.onScroll),r.offsetParent&&s&&s.offsetParent&&r.replaceWith(...s.childNodes));for(const[g,S]of Object.entries(m))g!=="container"&&S&&e.classList.remove(S);this.track=null,this.viewport=null,this.page=0,this.slides=[];const u=this.events.get("ready");this.events=new Map,u&&this.events.set("ready",u)}}Object.defineProperty(zi,"Panzoom",{enumerable:!0,configurable:!0,writable:!0,value:Vi}),Object.defineProperty(zi,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:cd}),Object.defineProperty(zi,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:fd});const Ps=function(p){if(!vn(p))return 0;const e=window.scrollY,r=window.innerHeight,s=e+r,l=p.getBoundingClientRect(),d=l.y+e,m=l.height,u=d+m;if(e>u||s<d)return 0;if(e<d&&s>u||d<e&&u>s)return 100;let g=m;d<e&&(g-=e-d),u>s&&(g-=u-s);const S=g/r*100;return Math.round(S)},xr=!(typeof window>"u"||!window.document||!window.document.createElement);let _a;const Ta=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden]):not(.fancybox-focus-guard)","iframe","object","embed","video","audio","[contenteditable]",'[tabindex]:not([tabindex^="-"]):not([disabled]):not([aria-hidden])'].join(","),No=p=>{if(p&&xr){_a===void 0&&document.createElement("div").focus({get preventScroll(){return _a=!0,!1}});try{if(_a)p.focus({preventScroll:!0});else{const e=window.scrollY||document.body.scrollTop,r=window.scrollX||document.body.scrollLeft;p.focus(),document.body.scrollTo({top:e,left:r,behavior:"auto"})}}catch{}}},Rs=()=>{const p=document;let e,r="",s="",l="";return p.fullscreenEnabled?(r="requestFullscreen",s="exitFullscreen",l="fullscreenElement"):p.webkitFullscreenEnabled&&(r="webkitRequestFullscreen",s="webkitExitFullscreen",l="webkitFullscreenElement"),r&&(e={request:function(d=p.documentElement){return r==="webkitRequestFullscreen"?d[r](Element.ALLOW_KEYBOARD_INPUT):d[r]()},exit:function(){return p[l]&&p[s]()},isFullscreen:function(){return p[l]}}),e},qa={animated:!0,autoFocus:!0,backdropClick:"close",Carousel:{classes:{container:"fancybox__carousel",viewport:"fancybox__viewport",track:"fancybox__track",slide:"fancybox__slide"}},closeButton:"auto",closeExisting:!1,commonCaption:!1,compact:()=>window.matchMedia("(max-width: 578px), (max-height: 578px)").matches,contentClick:"toggleZoom",contentDblClick:!1,defaultType:"image",defaultDisplay:"flex",dragToClose:!0,Fullscreen:{autoStart:!1},groupAll:!1,groupAttr:"data-fancybox",hideClass:"f-fadeOut",hideScrollbar:!0,idle:3500,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"prev",ArrowDown:"next",ArrowRight:"next",ArrowLeft:"prev"},l10n:Object.assign(Object.assign({},As),{CLOSE:"Close",NEXT:"Next",PREV:"Previous",MODAL:"You can close this modal content with the ESC key",ERROR:"Something Went Wrong, Please Try Again Later",IMAGE_ERROR:"Image Not Found",ELEMENT_NOT_FOUND:"HTML Element Not Found",AJAX_NOT_FOUND:"Error Loading AJAX : Not Found",AJAX_FORBIDDEN:"Error Loading AJAX : Forbidden",IFRAME_ERROR:"Error Loading Page",TOGGLE_ZOOM:"Toggle zoom level",TOGGLE_THUMBS:"Toggle thumbnails",TOGGLE_SLIDESHOW:"Toggle slideshow",TOGGLE_FULLSCREEN:"Toggle full-screen mode",DOWNLOAD:"Download"}),parentEl:null,placeFocusBack:!0,showClass:"f-zoomInUp",startIndex:0,tpl:{closeButton:'<button data-fancybox-close class="f-button is-close-btn" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"/></svg></button>',main:`<div class="fancybox__container" role="dialog" aria-modal="true" aria-label="{{MODAL}}" tabindex="-1">
    <div class="fancybox__backdrop"></div>
    <div class="fancybox__carousel"></div>
    <div class="fancybox__footer"></div>
  </div>`},trapFocus:!0,wheel:"zoom"};var Jt,ln;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Closing=2]="Closing",p[p.CustomClosing=3]="CustomClosing",p[p.Destroy=4]="Destroy"})(Jt||(Jt={})),function(p){p[p.Loading=0]="Loading",p[p.Opening=1]="Opening",p[p.Ready=2]="Ready",p[p.Closing=3]="Closing"}(ln||(ln={}));let jo="",wr=!1,Zr=!1,Hi=null;const Is=()=>{let p="",e="";const r=vt.getInstance();if(r){const s=r.carousel,l=r.getSlide();if(s&&l){let d=l.slug||void 0,m=l.triggerEl||void 0;e=d||r.option("slug")||"",!e&&m&&m.dataset&&(e=m.dataset.fancybox||""),e&&e!=="true"&&(p="#"+e+(!d&&s.slides.length>1?"-"+(l.index+1):""))}}return{hash:p,slug:e,index:1}},ua=()=>{const p=new URL(document.URL).hash,e=p.slice(1).split("-"),r=e[e.length-1],s=r&&/^\+?\d+$/.test(r)&&parseInt(e.pop()||"1",10)||1;return{hash:p,slug:e.join("-"),index:s}},Hs=()=>{const{slug:p,index:e}=ua();if(!p)return;let r=document.querySelector(`[data-slug="${p}"]`);if(r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})),vt.getInstance())return;const s=document.querySelectorAll(`[data-fancybox="${p}"]`);s.length&&(r=s[e-1],r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})))},Ns=()=>{if(vt.defaults.Hash===!1)return;const p=vt.getInstance();if((p==null?void 0:p.options.Hash)===!1)return;const{slug:e,index:r}=ua(),{slug:s}=Is();p&&(e===s?p.jumpTo(r-1):(wr=!0,p.close())),Hs()},js=()=>{Hi&&clearTimeout(Hi),queueMicrotask(()=>{Ns()})},$o=()=>{window.addEventListener("hashchange",js,!1),setTimeout(()=>{Ns()},500)};xr&&(/complete|interactive|loaded/.test(document.readyState)?$o():document.addEventListener("DOMContentLoaded",$o));const Jr="is-zooming-in";class $s extends Vn{onCreateSlide(e,r,s){const l=this.instance.optionFor(s,"src")||"";s.el&&s.type==="image"&&typeof l=="string"&&this.setImage(s,l)}onRemoveSlide(e,r,s){s.panzoom&&s.panzoom.destroy(),s.panzoom=void 0,s.imageEl=void 0}onChange(e,r,s,l){kt(this.instance.container,Jr);for(const d of r.slides){const m=d.panzoom;m&&d.index!==s&&m.reset(.35)}}onClose(){var e;const r=this.instance,s=r.container,l=r.getSlide();if(!s||!s.parentElement||!l)return;const{el:d,contentEl:m,panzoom:u,thumbElSrc:g}=l;if(!d||!g||!m||!u||u.isContentLoading||u.state===xt.Init||u.state===xt.Destroy)return;u.updateMetrics();let S=this.getZoomInfo(l);if(!S)return;this.instance.state=Jt.CustomClosing,s.classList.remove(Jr),s.classList.add("is-zooming-out"),m.style.backgroundImage=`url('${g}')`;const k=s.getBoundingClientRect();(((e=window.visualViewport)===null||e===void 0?void 0:e.scale)||1)===1&&Object.assign(s.style,{position:"absolute",top:`${s.offsetTop+window.scrollY}px`,left:`${s.offsetLeft+window.scrollX}px`,bottom:"auto",right:"auto",width:`${k.width}px`,height:`${k.height}px`,overflow:"hidden"});const{x:h,y:f,scale:b,opacity:y}=S;if(y){const E=((w,C,_,T)=>{const M=C-w,v=T-_;return D=>_+((D-w)/M*v||0)})(u.scale,b,1,0);u.on("afterTransform",()=>{m.style.opacity=E(u.scale)+""})}u.on("endAnimation",()=>{r.destroy()}),u.target.a=b,u.target.b=0,u.target.c=0,u.target.d=b,u.panTo({x:h,y:f,scale:b,friction:y?.2:.33,ignoreBounds:!0}),u.isResting&&r.destroy()}setImage(e,r){const s=this.instance;e.src=r,this.process(e,r).then(l=>{const{contentEl:d,imageEl:m,thumbElSrc:u,el:g}=e;if(s.isClosing()||!d||!m)return;d.offsetHeight;const S=!!s.isOpeningSlide(e)&&this.getZoomInfo(e);if(this.option("protected")&&g){g.addEventListener("contextmenu",f=>{f.preventDefault()});const h=document.createElement("div");We(h,"fancybox-protected"),d.appendChild(h)}if(u&&S){const h=l.contentRect,f=Math.max(h.fullWidth,h.fullHeight);let b=null;!S.opacity&&f>1200&&(b=document.createElement("img"),We(b,"fancybox-ghost"),b.src=u,d.appendChild(b));const y=()=>{b&&(We(b,"f-fadeFastOut"),setTimeout(()=>{b&&(b.remove(),b=null)},200))};(k=u,new Promise((E,w)=>{const C=new Image;C.onload=E,C.onerror=w,C.src=k})).then(()=>{s.hideLoading(e),e.state=ln.Opening,this.instance.emit("reveal",e),this.zoomIn(e).then(()=>{y(),this.instance.done(e)},()=>{}),b&&setTimeout(()=>{y()},f>2500?800:200)},()=>{s.hideLoading(e),s.revealContent(e)})}else{const h=this.optionFor(e,"initialSize"),f=this.optionFor(e,"zoom"),b={event:s.prevMouseMoveEvent||s.options.event,friction:f?.12:0};let y=s.optionFor(e,"showClass")||void 0,E=!0;s.isOpeningSlide(e)&&(h==="full"?l.zoomToFull(b):h==="cover"?l.zoomToCover(b):h==="max"?l.zoomToMax(b):E=!1,l.stop("current")),E&&y&&(y=l.isDragging?"f-fadeIn":""),s.hideLoading(e),s.revealContent(e,y)}var k},()=>{s.setError(e,"{{IMAGE_ERROR}}")})}process(e,r){return new Promise((s,l)=>{var d;const m=this.instance,u=e.el;m.clearContent(e),m.showLoading(e);let g=this.optionFor(e,"content");if(typeof g=="string"&&(g=Xn(g)),!g||!vn(g)){if(g=document.createElement("img"),g instanceof HTMLImageElement){let S="",k=e.caption;S=typeof k=="string"&&k?k.replace(/<[^>]+>/gi,"").substring(0,1e3):`Image ${e.index+1} of ${((d=m.carousel)===null||d===void 0?void 0:d.pages.length)||1}`,g.src=r||"",g.alt=S,g.draggable=!1,e.srcset&&g.setAttribute("srcset",e.srcset),this.instance.isOpeningSlide(e)&&(g.fetchPriority="high")}e.sizes&&g.setAttribute("sizes",e.sizes)}We(g,"fancybox-image"),e.imageEl=g,m.setContent(e,g,!1),e.panzoom=new Vi(u,bn({transformParent:!0},this.option("Panzoom")||{},{content:g,width:(S,k)=>m.optionFor(e,"width","auto",k)||"auto",height:(S,k)=>m.optionFor(e,"height","auto",k)||"auto",wheel:()=>{const S=m.option("wheel");return(S==="zoom"||S=="pan")&&S},click:(S,k)=>{var h,f;if(m.isCompact||m.isClosing()||e.index!==((h=m.getSlide())===null||h===void 0?void 0:h.index))return!1;if(k){const y=k.composedPath()[0];if(["A","BUTTON","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].includes(y.nodeName))return!1}let b=!k||k.target&&((f=e.contentEl)===null||f===void 0?void 0:f.contains(k.target));return m.option(b?"contentClick":"backdropClick")||!1},dblClick:()=>m.isCompact?"toggleZoom":m.option("contentDblClick")||!1,spinner:!1,panOnlyZoomed:!0,wheelLimit:1/0,on:{ready:S=>{s(S)},error:()=>{l()},destroy:()=>{l()}}}))})}zoomIn(e){return new Promise((r,s)=>{const l=this.instance,d=l.container,{panzoom:m,contentEl:u,el:g}=e;m&&m.updateMetrics();const S=this.getZoomInfo(e);if(!(S&&g&&u&&m&&d))return void s();const{x:k,y:h,scale:f,opacity:b}=S,y=()=>{e.state!==ln.Closing&&(b&&(u.style.opacity=Math.max(Math.min(1,1-(1-m.scale)/(1-f)),0)+""),m.scale>=1&&m.scale>m.targetScale-.1&&r(m))},E=_=>{(_.scale<.99||_.scale>1.01)&&!_.isDragging||(kt(d,Jr),u.style.opacity="",_.off("endAnimation",E),_.off("touchStart",E),_.off("afterTransform",y),r(_))};m.on("endAnimation",E),m.on("touchStart",E),m.on("afterTransform",y),m.on(["error","destroy"],()=>{s()}),m.panTo({x:k,y:h,scale:f,friction:0,ignoreBounds:!0}),m.stop("current");const w={event:m.panMode==="mousemove"?l.prevMouseMoveEvent||l.options.event:void 0},C=this.optionFor(e,"initialSize");We(d,Jr),l.hideLoading(e),C==="full"?m.zoomToFull(w):C==="cover"?m.zoomToCover(w):C==="max"?m.zoomToMax(w):m.reset(.172)})}getZoomInfo(e){const{el:r,imageEl:s,thumbEl:l,panzoom:d}=e,m=this.instance,u=m.container;if(!r||!s||!l||!d||Ps(l)<3||!this.optionFor(e,"zoom")||!u||m.state===Jt.Destroy||getComputedStyle(u).getPropertyValue("--f-images-zoom")==="0")return!1;const g=window.visualViewport||null;if((g?g.scale:1)!==1)return!1;let{top:S,left:k,width:h,height:f}=l.getBoundingClientRect(),{top:b,left:y,fitWidth:E,fitHeight:w}=d.contentRect;if(!(h&&f&&E&&w))return!1;const C=d.container.getBoundingClientRect();y+=C.left,b+=C.top;const _=-1*(y+.5*E-(k+.5*h)),T=-1*(b+.5*w-(S+.5*f)),M=h/E;let v=this.option("zoomOpacity")||!1;return v==="auto"&&(v=Math.abs(h/f-E/w)>.1),{x:_,y:T,scale:M,opacity:v}}attach(){const e=this,r=e.instance;r.on("Carousel.change",e.onChange),r.on("Carousel.createSlide",e.onCreateSlide),r.on("Carousel.removeSlide",e.onRemoveSlide),r.on("close",e.onClose)}detach(){const e=this,r=e.instance;r.off("Carousel.change",e.onChange),r.off("Carousel.createSlide",e.onCreateSlide),r.off("Carousel.removeSlide",e.onRemoveSlide),r.off("close",e.onClose)}}Object.defineProperty($s,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{initialSize:"fit",Panzoom:{maxScale:1},protected:!1,zoom:!0,zoomOpacity:"auto"}}),typeof SuppressedError=="function"&&SuppressedError;const Ma="html",Bo="image",Aa="map",li="youtube",Di="vimeo",vr="html5video",Uo=(p,e={})=>{const r=new URL(p),s=new URLSearchParams(r.search),l=new URLSearchParams;for(const[u,g]of[...s,...Object.entries(e)]){let S=g+"";if(u==="t"){let k=S.match(/((\d*)m)?(\d*)s?/);k&&l.set("start",60*parseInt(k[2]||"0")+parseInt(k[3]||"0")+"")}else l.set(u,S)}let d=l+"",m=p.match(/#t=((.*)?\d+s)/);return m&&(d+=`#t=${m[1]}`),d},hd={ajax:null,autoSize:!0,iframeAttr:{allow:"autoplay; fullscreen",scrolling:"auto"},preload:!0,videoAutoplay:!0,videoRatio:16/9,videoTpl:`<video class="fancybox__html5video" playsinline controls controlsList="nodownload" poster="{{poster}}">
  <source src="{{src}}" type="{{format}}" />Sorry, your browser doesn't support embedded videos.</video>`,videoFormat:"",vimeo:{byline:1,color:"00adef",controls:1,dnt:1,muted:0},youtube:{controls:1,enablejsapi:1,nocookie:1,rel:0,fs:1}},pd=["image","html","ajax","inline","clone","iframe","map","pdf","html5video","youtube","vimeo"];class Bs extends Vn{onBeforeInitSlide(e,r,s){this.processType(s)}onCreateSlide(e,r,s){this.setContent(s)}onClearContent(e,r){r.xhr&&(r.xhr.abort(),r.xhr=null);const s=r.iframeEl;s&&(s.onload=s.onerror=null,s.src="//about:blank",r.iframeEl=null);const l=r.contentEl,d=r.placeholderEl;if(r.type==="inline"&&l&&d)l.classList.remove("fancybox__content"),getComputedStyle(l).getPropertyValue("display")!=="none"&&(l.style.display="none"),setTimeout(()=>{d&&(l&&d.parentNode&&d.parentNode.insertBefore(l,d),d.remove())},0),r.contentEl=void 0,r.placeholderEl=void 0;else for(;r.el&&r.el.firstChild;)r.el.removeChild(r.el.firstChild)}onSelectSlide(e,r,s){s.state===ln.Ready&&this.playVideo()}onUnselectSlide(e,r,s){var l,d;if(s.type===vr){try{(d=(l=s.el)===null||l===void 0?void 0:l.querySelector("video"))===null||d===void 0||d.pause()}catch{}return}let m;s.type===Di?m={method:"pause",value:"true"}:s.type===li&&(m={event:"command",func:"pauseVideo"}),m&&s.iframeEl&&s.iframeEl.contentWindow&&s.iframeEl.contentWindow.postMessage(JSON.stringify(m),"*"),s.poller&&clearTimeout(s.poller)}onDone(e,r){e.isCurrentSlide(r)&&!e.isClosing()&&this.playVideo()}onRefresh(e,r){r.slides.forEach(s=>{s.el&&(this.resizeIframe(s),this.setAspectRatio(s))})}onMessage(e){try{let r=JSON.parse(e.data);if(e.origin==="https://player.vimeo.com"){if(r.event==="ready")for(let s of Array.from(document.getElementsByClassName("fancybox__iframe")))s instanceof HTMLIFrameElement&&s.contentWindow===e.source&&(s.dataset.ready="true")}else if(e.origin.match(/^https:\/\/(www.)?youtube(-nocookie)?.com$/)&&r.event==="onReady"){const s=document.getElementById(r.id);s&&(s.dataset.ready="true")}}catch{}}loadAjaxContent(e){const r=this.instance.optionFor(e,"src")||"";this.instance.showLoading(e);const s=this.instance,l=new XMLHttpRequest;s.showLoading(e),l.onreadystatechange=function(){l.readyState===XMLHttpRequest.DONE&&s.state===Jt.Ready&&(s.hideLoading(e),l.status===200?s.setContent(e,l.responseText):s.setError(e,l.status===404?"{{AJAX_NOT_FOUND}}":"{{AJAX_FORBIDDEN}}"))};const d=e.ajax||null;l.open(d?"POST":"GET",r+""),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.send(d),e.xhr=l}setInlineContent(e){let r=null;if(vn(e.src))r=e.src;else if(typeof e.src=="string"){const s=e.src.split("#",2).pop();r=s?document.getElementById(s):null}if(r){if(e.type==="clone"||r.closest(".fancybox__slide")){r=r.cloneNode(!0);const s=r.dataset.animationName;s&&(r.classList.remove(s),delete r.dataset.animationName);let l=r.getAttribute("id");l=l?`${l}--clone`:`clone-${this.instance.id}-${e.index}`,r.setAttribute("id",l)}else if(r.parentNode){const s=document.createElement("div");s.classList.add("fancybox-placeholder"),r.parentNode.insertBefore(s,r),e.placeholderEl=s}this.instance.setContent(e,r)}else this.instance.setError(e,"{{ELEMENT_NOT_FOUND}}")}setIframeContent(e){const{src:r,el:s}=e;if(!r||typeof r!="string"||!s)return;s.classList.add("is-loading");const l=this.instance,d=document.createElement("iframe");d.className="fancybox__iframe",d.setAttribute("id",`fancybox__iframe_${l.id}_${e.index}`);for(const[u,g]of Object.entries(this.optionFor(e,"iframeAttr")||{}))d.setAttribute(u,g);d.onerror=()=>{l.setError(e,"{{IFRAME_ERROR}}")},e.iframeEl=d;const m=this.optionFor(e,"preload");if(e.type!=="iframe"||m===!1)return d.setAttribute("src",e.src+""),l.setContent(e,d,!1),this.resizeIframe(e),void l.revealContent(e);l.showLoading(e),d.onload=()=>{if(!d.src.length)return;const u=d.dataset.ready!=="true";d.dataset.ready="true",this.resizeIframe(e),u?l.revealContent(e):l.hideLoading(e)},d.setAttribute("src",r),l.setContent(e,d,!1)}resizeIframe(e){const{type:r,iframeEl:s}=e;if(r===li||r===Di)return;const l=s==null?void 0:s.parentElement;if(!s||!l)return;let d=e.autoSize;d===void 0&&(d=this.optionFor(e,"autoSize"));let m=e.width||0,u=e.height||0;m&&u&&(d=!1);const g=l&&l.style;if(e.preload!==!1&&d!==!1&&g)try{const S=window.getComputedStyle(l),k=parseFloat(S.paddingLeft)+parseFloat(S.paddingRight),h=parseFloat(S.paddingTop)+parseFloat(S.paddingBottom),f=s.contentWindow;if(f){const b=f.document,y=b.getElementsByTagName(Ma)[0],E=b.body;g.width="",E.style.overflow="hidden",m=m||y.scrollWidth+k,g.width=`${m}px`,E.style.overflow="",g.flex="0 0 auto",g.height=`${E.scrollHeight}px`,u=y.scrollHeight+h}}catch{}if(m||u){const S={flex:"0 1 auto",width:"",height:""};m&&m!=="auto"&&(S.width=`${m}px`),u&&u!=="auto"&&(S.height=`${u}px`),Object.assign(g,S)}}playVideo(){const e=this.instance.getSlide();if(!e)return;const{el:r}=e;if(!r||!r.offsetParent||!this.optionFor(e,"videoAutoplay"))return;if(e.type===vr)try{const l=r.querySelector("video");if(l){const d=l.play();d!==void 0&&d.then(()=>{}).catch(m=>{l.muted=!0,l.play()})}}catch{}if(e.type!==li&&e.type!==Di)return;const s=()=>{if(e.iframeEl&&e.iframeEl.contentWindow){let l;if(e.iframeEl.dataset.ready==="true")return l=e.type===li?{event:"command",func:"playVideo"}:{method:"play",value:"true"},l&&e.iframeEl.contentWindow.postMessage(JSON.stringify(l),"*"),void(e.poller=void 0);e.type===li&&(l={event:"listening",id:e.iframeEl.getAttribute("id")},e.iframeEl.contentWindow.postMessage(JSON.stringify(l),"*"))}e.poller=setTimeout(s,250)};s()}processType(e){if(e.html)return e.type=Ma,e.src=e.html,void(e.html="");const r=this.instance.optionFor(e,"src","");if(!r||typeof r!="string")return;let s=e.type,l=null;if(l=r.match(/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(?:watch\?(?:.*&)?v=|v\/|u\/|shorts\/|embed\/?)?(videoseries\?list=(?:.*)|[\w-]{11}|\?listType=(?:.*)&list=(?:.*))(?:.*)/i)){const d=this.optionFor(e,li),{nocookie:m}=d,u=function(h,f){var b={};for(var y in h)Object.prototype.hasOwnProperty.call(h,y)&&f.indexOf(y)<0&&(b[y]=h[y]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function"){var E=0;for(y=Object.getOwnPropertySymbols(h);E<y.length;E++)f.indexOf(y[E])<0&&Object.prototype.propertyIsEnumerable.call(h,y[E])&&(b[y[E]]=h[y[E]])}return b}(d,["nocookie"]),g=`www.youtube${m?"-nocookie":""}.com`,S=Uo(r,u),k=encodeURIComponent(l[2]);e.videoId=k,e.src=`https://${g}/embed/${k}?${S}`,e.thumbSrc=e.thumbSrc||`https://i.ytimg.com/vi/${k}/mqdefault.jpg`,s=li}else if(l=r.match(/^.+vimeo.com\/(?:\/)?([\d]+)((\/|\?h=)([a-z0-9]+))?(.*)?/)){const d=Uo(r,this.optionFor(e,Di)),m=encodeURIComponent(l[1]),u=l[4]||"";e.videoId=m,e.src=`https://player.vimeo.com/video/${m}?${u?`h=${u}${d?"&":""}`:""}${d}`,s=Di}if(!s&&e.triggerEl){const d=e.triggerEl.dataset.type;pd.includes(d)&&(s=d)}s||typeof r=="string"&&(r.charAt(0)==="#"?s="inline":(l=r.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))?(s=vr,e.videoFormat=e.videoFormat||"video/"+(l[1]==="ogv"?"ogg":l[1])):r.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?s=Bo:r.match(/\.(pdf)((\?|#).*)?$/i)&&(s="pdf")),(l=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:(?:(?:maps\/(?:place\/(?:.*)\/)?\@(.*),(\d+.?\d+?)z))|(?:\?ll=))(.*)?/i))?(e.src=`https://maps.google.${l[1]}/?ll=${(l[2]?l[2]+"&z="+Math.floor(parseFloat(l[3]))+(l[4]?l[4].replace(/^\//,"&"):""):l[4]+"").replace(/\?/,"&")}&output=${l[4]&&l[4].indexOf("layer=c")>0?"svembed":"embed"}`,s=Aa):(l=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:maps\/search\/)(.*)/i))&&(e.src=`https://maps.google.${l[1]}/maps?q=${l[2].replace("query=","q=").replace("api=1","")}&output=embed`,s=Aa),s=s||this.instance.option("defaultType"),e.type=s,s===Bo&&(e.thumbSrc=e.thumbSrc||e.src)}setContent(e){const r=this.instance.optionFor(e,"src")||"";if(e&&e.type&&r){switch(e.type){case Ma:this.instance.setContent(e,r);break;case vr:const s=this.option("videoTpl");s&&this.instance.setContent(e,s.replace(/\{\{src\}\}/gi,r+"").replace(/\{\{format\}\}/gi,this.optionFor(e,"videoFormat")||"").replace(/\{\{poster\}\}/gi,e.poster||e.thumbSrc||""));break;case"inline":case"clone":this.setInlineContent(e);break;case"ajax":this.loadAjaxContent(e);break;case"pdf":case Aa:case li:case Di:e.preload=!1;case"iframe":this.setIframeContent(e)}this.setAspectRatio(e)}}setAspectRatio(e){const r=e.contentEl;if(!(e.el&&r&&e.type&&[li,Di,vr].includes(e.type)))return;let s,l=e.width||"auto",d=e.height||"auto";if(l==="auto"||d==="auto"){s=this.optionFor(e,"videoRatio");const S=(s+"").match(/(\d+)\s*\/\s?(\d+)/);s=S&&S.length>2?parseFloat(S[1])/parseFloat(S[2]):parseFloat(s+"")}else l&&d&&(s=l/d);if(!s)return;r.style.aspectRatio="",r.style.width="",r.style.height="",r.offsetHeight;const m=r.getBoundingClientRect(),u=m.width||1,g=m.height||1;r.style.aspectRatio=s+"",s<u/g?(d=d==="auto"?g:Math.min(g,d),r.style.width="auto",r.style.height=`${d}px`):(l=l==="auto"?u:Math.min(u,l),r.style.width=`${l}px`,r.style.height="auto")}attach(){const e=this,r=e.instance;r.on("Carousel.beforeInitSlide",e.onBeforeInitSlide),r.on("Carousel.createSlide",e.onCreateSlide),r.on("Carousel.selectSlide",e.onSelectSlide),r.on("Carousel.unselectSlide",e.onUnselectSlide),r.on("Carousel.Panzoom.refresh",e.onRefresh),r.on("done",e.onDone),r.on("clearContent",e.onClearContent),window.addEventListener("message",e.onMessage)}detach(){const e=this,r=e.instance;r.off("Carousel.beforeInitSlide",e.onBeforeInitSlide),r.off("Carousel.createSlide",e.onCreateSlide),r.off("Carousel.selectSlide",e.onSelectSlide),r.off("Carousel.unselectSlide",e.onUnselectSlide),r.off("Carousel.Panzoom.refresh",e.onRefresh),r.off("done",e.onDone),r.off("clearContent",e.onClearContent),window.removeEventListener("message",e.onMessage)}}Object.defineProperty(Bs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:hd});const Qr="play",ea="pause",br="ready";class Us extends Vn{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:br}),Object.defineProperty(this,"inHover",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"progressBar",{enumerable:!0,configurable:!0,writable:!0,value:null})}get isActive(){return this.state!==br}onReady(e){this.option("autoStart")&&(e.isInfinite||e.page<e.pages.length-1)&&this.start()}onChange(){this.removeProgressBar(),this.pause()}onSettle(){this.resume()}onVisibilityChange(){document.visibilityState==="visible"?this.resume():this.pause()}onMouseEnter(){this.inHover=!0,this.pause()}onMouseLeave(){var e;this.inHover=!1,!((e=this.instance.panzoom)===null||e===void 0)&&e.isResting&&this.resume()}onTimerEnd(){const e=this.instance;this.state==="play"&&(e.isInfinite||e.page!==e.pages.length-1?e.slideNext():e.slideTo(0))}removeProgressBar(){this.progressBar&&(this.progressBar.remove(),this.progressBar=null)}createProgressBar(){var e;if(!this.option("showProgress"))return null;this.removeProgressBar();const r=this.instance,s=((e=r.pages[r.page])===null||e===void 0?void 0:e.slides)||[];let l=this.option("progressParentEl");if(l||(l=(s.length===1?s[0].el:null)||r.viewport),!l)return null;const d=document.createElement("div");return We(d,"f-progress"),l.prepend(d),this.progressBar=d,d.offsetHeight,d}set(){const e=this,r=e.instance;if(r.pages.length<2||e.timer)return;const s=e.option("timeout");e.state=Qr,We(r.container,"has-autoplay");let l=e.createProgressBar();l&&(l.style.transitionDuration=`${s}ms`,l.style.transform="scaleX(1)"),e.timer=setTimeout(()=>{e.timer=null,e.inHover||e.onTimerEnd()},s),e.emit("set")}clear(){const e=this;e.timer&&(clearTimeout(e.timer),e.timer=null),e.removeProgressBar()}start(){const e=this;if(e.set(),e.state!==br){if(e.option("pauseOnHover")){const r=e.instance.container;r.addEventListener("mouseenter",e.onMouseEnter,!1),r.addEventListener("mouseleave",e.onMouseLeave,!1)}document.addEventListener("visibilitychange",e.onVisibilityChange,!1),e.emit("start")}}stop(){const e=this,r=e.state,s=e.instance.container;e.clear(),e.state=br,s.removeEventListener("mouseenter",e.onMouseEnter,!1),s.removeEventListener("mouseleave",e.onMouseLeave,!1),document.removeEventListener("visibilitychange",e.onVisibilityChange,!1),kt(s,"has-autoplay"),r!==br&&e.emit("stop")}pause(){const e=this;e.state===Qr&&(e.state=ea,e.clear(),e.emit(ea))}resume(){const e=this,r=e.instance;if(r.isInfinite||r.page!==r.pages.length-1)if(e.state!==Qr){if(e.state===ea&&!e.inHover){const s=new Event("resume",{bubbles:!0,cancelable:!0});e.emit("resume",s),s.defaultPrevented||e.set()}}else e.set();else e.stop()}toggle(){this.state===Qr||this.state===ea?this.stop():this.start()}attach(){const e=this,r=e.instance;r.on("ready",e.onReady),r.on("Panzoom.startAnimation",e.onChange),r.on("Panzoom.endAnimation",e.onSettle),r.on("Panzoom.touchMove",e.onChange)}detach(){const e=this,r=e.instance;r.off("ready",e.onReady),r.off("Panzoom.startAnimation",e.onChange),r.off("Panzoom.endAnimation",e.onSettle),r.off("Panzoom.touchMove",e.onChange),e.stop()}}Object.defineProperty(Us,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{autoStart:!0,pauseOnHover:!0,progressParentEl:null,showProgress:!0,timeout:3e3}});class zs extends Vn{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null})}onPrepare(e){const r=e.carousel;if(!r)return;const s=e.container;s&&(r.options.Autoplay=bn({autoStart:!1},this.option("Autoplay")||{},{pauseOnHover:!1,timeout:this.option("timeout"),progressParentEl:()=>this.option("progressParentEl")||null,on:{start:()=>{e.emit("startSlideshow")},set:l=>{var d;s.classList.add("has-slideshow"),((d=e.getSlide())===null||d===void 0?void 0:d.state)!==ln.Ready&&l.pause()},stop:()=>{s.classList.remove("has-slideshow"),e.isCompact||e.endIdle(),e.emit("endSlideshow")},resume:(l,d)=>{var m,u,g;!d||!d.cancelable||((m=e.getSlide())===null||m===void 0?void 0:m.state)===ln.Ready&&(!((g=(u=e.carousel)===null||u===void 0?void 0:u.panzoom)===null||g===void 0)&&g.isResting)||d.preventDefault()}}}),r.attachPlugins({Autoplay:Us}),this.ref=r.plugins.Autoplay)}onReady(e){const r=e.carousel,s=this.ref;s&&r&&this.option("playOnStart")&&(r.isInfinite||r.page<r.pages.length-1)&&s.start()}onDone(e,r){const s=this.ref,l=e.carousel;if(!s||!l)return;const d=r.panzoom;d&&d.on("startAnimation",()=>{e.isCurrentSlide(r)&&s.stop()}),e.isCurrentSlide(r)&&s.resume()}onKeydown(e,r){var s;const l=this.ref;l&&r===this.option("key")&&((s=document.activeElement)===null||s===void 0?void 0:s.nodeName)!=="BUTTON"&&l.toggle()}attach(){const e=this,r=e.instance;r.on("Carousel.init",e.onPrepare),r.on("Carousel.ready",e.onReady),r.on("done",e.onDone),r.on("keydown",e.onKeydown)}detach(){const e=this,r=e.instance;r.off("Carousel.init",e.onPrepare),r.off("Carousel.ready",e.onReady),r.off("done",e.onDone),r.off("keydown",e.onKeydown)}}Object.defineProperty(zs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{key:" ",playOnStart:!1,progressParentEl:p=>{var e;return((e=p.instance.container)===null||e===void 0?void 0:e.querySelector(".fancybox__toolbar [data-fancybox-toggle-slideshow]"))||p.instance.container},timeout:3e3}});const Fs={classes:{container:"f-thumbs f-carousel__thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide",isResting:"is-resting",isSelected:"is-selected",isLoading:"is-loading",hasThumbs:"has-thumbs"},minCount:2,parentEl:null,thumbTpl:'<button class="f-thumbs__slide__button" tabindex="0" type="button" aria-label="{{GOTO}}" data-carousel-index="%i"><img class="f-thumbs__slide__img" data-lazy-src="{{%s}}" alt="" /></button>',type:"modern"};var ui;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Hidden=2]="Hidden"})(ui||(ui={}));const zo="isResting",ta="thumbWidth",Qi="thumbHeight",Kn="thumbClipWidth";let Vs=class extends Vn{constructor(){super(...arguments),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"modern"}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"thumbWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbClipWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbExtraGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:ui.Init})}get isModern(){return this.type==="modern"}onInitSlide(p,e){const r=e.el?e.el.dataset:void 0;r&&(e.thumbSrc=r.thumbSrc||e.thumbSrc||"",e[Kn]=parseFloat(r[Kn]||"")||e[Kn]||0,e[Qi]=parseFloat(r.thumbHeight||"")||e[Qi]||0),this.addSlide(e)}onInitSlides(){this.build()}onChange(){var p;if(!this.isModern)return;const e=this.container,r=this.instance,s=r.panzoom,l=this.carousel,d=l?l.panzoom:null,m=r.page;if(s&&l&&d){if(s.isDragging){kt(e,this.cn(zo));let u=((p=l.pages[m])===null||p===void 0?void 0:p.pos)||0;u+=r.getProgress(m)*(this[Kn]+this.thumbGap);let g=d.getBounds();-1*u>g.x.min&&-1*u<g.x.max&&d.panTo({x:-1*u,friction:.12})}else Zn(e,this.cn(zo),s.isResting);this.shiftModern()}}onRefresh(){this.updateProps();for(const p of this.instance.slides||[])this.resizeModernSlide(p);this.shiftModern()}isDisabled(){const p=this.option("minCount")||0;if(p){const r=this.instance;let s=0;for(const l of r.slides||[])l.thumbSrc&&s++;if(s<p)return!0}const e=this.option("type");return["modern","classic"].indexOf(e)<0}getThumb(p){const e=this.option("thumbTpl")||"";return{html:this.instance.localize(e,[["%i",p.index],["%d",p.index+1],["%s",p.thumbSrc||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"]])}}addSlide(p){const e=this.carousel;e&&e.addSlide(p.index,this.getThumb(p))}getSlides(){const p=[];for(const e of this.instance.slides||[])p.push(this.getThumb(e));return p}resizeModernSlide(p){this.isModern&&(p[ta]=p[Kn]&&p[Qi]?Math.round(this[Qi]*(p[Kn]/p[Qi])):this[ta])}updateProps(){const p=this.container;if(!p)return;const e=r=>parseFloat(getComputedStyle(p).getPropertyValue("--f-thumb-"+r))||0;this.thumbGap=e("gap"),this.thumbExtraGap=e("extra-gap"),this[ta]=e("width")||40,this[Kn]=e("clip-width")||40,this[Qi]=e("height")||40}build(){const p=this;if(p.state!==ui.Init)return;if(p.isDisabled())return void p.emit("disabled");const e=p.instance,r=e.container,s=p.getSlides(),l=p.option("type");p.type=l;const d=p.option("parentEl"),m=p.cn("container"),u=p.cn("track");let g=d==null?void 0:d.querySelector("."+m);g||(g=document.createElement("div"),We(g,m),d?d.appendChild(g):r.after(g)),We(g,`is-${l}`),We(r,p.cn("hasThumbs")),p.container=g,p.updateProps();let S=g.querySelector("."+u);S||(S=document.createElement("div"),We(S,p.cn("track")),g.appendChild(S)),p.track=S;const k=bn({},{track:S,infinite:!1,center:!0,fill:l==="classic",dragFree:!0,slidesPerPage:1,transition:!1,preload:.25,friction:.12,Panzoom:{maxVelocity:0},Dots:!1,Navigation:!1,classes:{container:"f-thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide"}},p.option("Carousel")||{},{Sync:{target:e},slides:s}),h=new e.constructor(g,k);h.on("createSlide",(f,b)=>{p.setProps(b.index),p.emit("createSlide",b,b.el)}),h.on("ready",()=>{p.shiftModern(),p.emit("ready")}),h.on("refresh",()=>{p.shiftModern()}),h.on("Panzoom.click",(f,b,y)=>{p.onClick(y)}),p.carousel=h,p.state=ui.Ready}onClick(p){p.preventDefault(),p.stopPropagation();const e=this.instance,{pages:r,page:s}=e,l=E=>{if(E){const w=E.closest("[data-carousel-index]");if(w)return[parseInt(w.dataset.carouselIndex||"",10)||0,w]}return[-1,void 0]},d=(E,w)=>{const C=document.elementFromPoint(E,w);return C?l(C):[-1,void 0]};let[m,u]=l(p.target);if(m>-1)return;const g=this[Kn],S=p.clientX,k=p.clientY;let[h,f]=d(S-g,k),[b,y]=d(S+g,k);f&&y?(m=Math.abs(S-f.getBoundingClientRect().right)<Math.abs(S-y.getBoundingClientRect().left)?h:b,m===s&&(m=m===h?b:h)):f?m=h:y&&(m=b),m>-1&&r[m]&&e.slideTo(m)}getShift(p){var e;const r=this,{instance:s}=r,l=r.carousel;if(!s||!l)return 0;const d=r[ta],m=r[Kn],u=r.thumbGap,g=r.thumbExtraGap;if(!(!((e=l.slides[p])===null||e===void 0)&&e.el))return 0;const S=.5*(d-m),k=s.pages.length-1;let h=s.getProgress(0),f=s.getProgress(k),b=s.getProgress(p,!1,!0),y=0,E=S+g+u;const w=h<0&&h>-1,C=f>0&&f<1;return p===0?(y=E*Math.abs(h),C&&h===1&&(y-=E*Math.abs(f))):p===k?(y=E*Math.abs(f)*-1,w&&f===-1&&(y+=E*Math.abs(h))):w||C?(y=-1*E,y+=E*Math.abs(h),y+=E*(1-Math.abs(f))):y=E*b,y}setProps(p){var e;const r=this;if(!r.isModern)return;const{instance:s}=r,l=r.carousel;if(s&&l){const d=(e=l.slides[p])===null||e===void 0?void 0:e.el;if(d&&d.childNodes.length){let m=_e(1-Math.abs(s.getProgress(p))),u=_e(r.getShift(p));d.style.setProperty("--progress",m?m+"":""),d.style.setProperty("--shift",u+"")}}}shiftModern(){const p=this;if(!p.isModern)return;const{instance:e,track:r}=p,s=e.panzoom,l=p.carousel;if(!(e&&r&&s&&l)||s.state===xt.Init||s.state===xt.Destroy)return;for(const m of e.slides)p.setProps(m.index);let d=(p[Kn]+p.thumbGap)*(l.slides.length||0);r.style.setProperty("--width",d+"")}cleanup(){const p=this;p.carousel&&p.carousel.destroy(),p.carousel=null,p.container&&p.container.remove(),p.container=null,p.track&&p.track.remove(),p.track=null,p.state=ui.Init,kt(p.instance.container,p.cn("hasThumbs"))}attach(){const p=this,e=p.instance;e.on("initSlide",p.onInitSlide),e.state===Yt.Init?e.on("initSlides",p.onInitSlides):p.onInitSlides(),e.on(["change","Panzoom.afterTransform"],p.onChange),e.on("Panzoom.refresh",p.onRefresh)}detach(){const p=this,e=p.instance;e.off("initSlide",p.onInitSlide),e.off("initSlides",p.onInitSlides),e.off(["change","Panzoom.afterTransform"],p.onChange),e.off("Panzoom.refresh",p.onRefresh),p.cleanup()}};Object.defineProperty(Vs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Fs});const md=Object.assign(Object.assign({},Fs),{key:"t",showOnStart:!0,parentEl:null}),Fo="is-masked",Vo="aria-hidden";class qs extends Vn{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hidden",{enumerable:!0,configurable:!0,writable:!0,value:!1})}get isEnabled(){const e=this.ref;return e&&!e.isDisabled()}get isHidden(){return this.hidden}onClick(e,r){r.stopPropagation()}onCreateSlide(e,r){var s,l,d;const m=((d=(l=(s=this.instance)===null||s===void 0?void 0:s.carousel)===null||l===void 0?void 0:l.slides[r.index])===null||d===void 0?void 0:d.type)||"",u=r.el;if(u&&m){let g=`for-${m}`;["video","youtube","vimeo","html5video"].includes(m)&&(g+=" for-video"),We(u,g)}}onInit(){var e;const r=this,s=r.instance,l=s.carousel;if(r.ref||!l)return;const d=r.option("parentEl")||s.footer||s.container;if(!d)return;const m=bn({},r.options,{parentEl:d,classes:{container:"f-thumbs fancybox__thumbs"},Carousel:{Sync:{friction:s.option("Carousel.friction")||0}},on:{ready:u=>{const g=u.container;g&&this.hidden&&(r.refresh(),g.style.transition="none",r.hide(),g.offsetHeight,queueMicrotask(()=>{g.style.transition="",r.show()}))}}});m.Carousel=m.Carousel||{},m.Carousel.on=bn(((e=r.options.Carousel)===null||e===void 0?void 0:e.on)||{},{click:this.onClick,createSlide:this.onCreateSlide}),l.options.Thumbs=m,l.attachPlugins({Thumbs:Vs}),r.ref=l.plugins.Thumbs,r.option("showOnStart")||(r.ref.state=ui.Hidden,r.hidden=!0)}onResize(){var e;const r=(e=this.ref)===null||e===void 0?void 0:e.container;r&&(r.style.maxHeight="")}onKeydown(e,r){const s=this.option("key");s&&s===r&&this.toggle()}toggle(){const e=this.ref;if(e&&!e.isDisabled())return e.state===ui.Hidden?(e.state=ui.Init,void e.build()):void(this.hidden?this.show():this.hide())}show(){const e=this.ref;if(!e||e.isDisabled())return;const r=e.container;r&&(this.refresh(),r.offsetHeight,r.removeAttribute(Vo),r.classList.remove(Fo),this.hidden=!1)}hide(){const e=this.ref,r=e&&e.container;r&&(this.refresh(),r.offsetHeight,r.classList.add(Fo),r.setAttribute(Vo,"true")),this.hidden=!0}refresh(){const e=this.ref;if(!e||!e.state)return;const r=e.container,s=(r==null?void 0:r.firstChild)||null;r&&s&&s.childNodes.length&&(r.style.maxHeight=`${s.getBoundingClientRect().height}px`)}attach(){const e=this,r=e.instance;r.state===Jt.Init?r.on("Carousel.init",e.onInit):e.onInit(),r.on("resize",e.onResize),r.on("keydown",e.onKeydown)}detach(){var e;const r=this,s=r.instance;s.off("Carousel.init",r.onInit),s.off("resize",r.onResize),s.off("keydown",r.onKeydown),(e=s.carousel)===null||e===void 0||e.detachPlugins(["Thumbs"]),r.ref=null}}Object.defineProperty(qs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:md});const La={panLeft:{icon:'<svg><path d="M5 12h14M5 12l6 6M5 12l6-6"/></svg>',change:{panX:-100}},panRight:{icon:'<svg><path d="M5 12h14M13 18l6-6M13 6l6 6"/></svg>',change:{panX:100}},panUp:{icon:'<svg><path d="M12 5v14M18 11l-6-6M6 11l6-6"/></svg>',change:{panY:-100}},panDown:{icon:'<svg><path d="M12 5v14M18 13l-6 6M6 13l6 6"/></svg>',change:{panY:100}},zoomIn:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M11 8v6M8 11h6"/></svg>',action:"zoomIn"},zoomOut:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"zoomOut"},toggle1to1:{icon:'<svg><path d="M3.51 3.07c5.74.02 11.48-.02 17.22.02 1.37.1 2.34 1.64 2.18 3.13 0 4.08.02 8.16 0 12.23-.1 1.54-1.47 2.64-2.79 2.46-5.61-.01-11.24.02-16.86-.01-1.36-.12-2.33-1.65-2.17-3.14 0-4.07-.02-8.16 0-12.23.1-1.36 1.22-2.48 2.42-2.46Z"/><path d="M5.65 8.54h1.49v6.92m8.94-6.92h1.49v6.92M11.5 9.4v.02m0 5.18v0"/></svg>',action:"toggleZoom"},toggleZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"toggleZoom"},iterateZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"iterateZoom"},rotateCCW:{icon:'<svg><path d="M15 4.55a8 8 0 0 0-6 14.9M9 15v5H4M18.37 7.16v.01M13 19.94v.01M16.84 18.37v.01M19.37 15.1v.01M19.94 11v.01"/></svg>',action:"rotateCCW"},rotateCW:{icon:'<svg><path d="M9 4.55a8 8 0 0 1 6 14.9M15 15v5h5M5.63 7.16v.01M4.06 11v.01M4.63 15.1v.01M7.16 18.37v.01M11 19.94v.01"/></svg>',action:"rotateCW"},flipX:{icon:'<svg style="stroke-width: 1.3"><path d="M12 3v18M16 7v10h5L16 7M8 7v10H3L8 7"/></svg>',action:"flipX"},flipY:{icon:'<svg style="stroke-width: 1.3"><path d="M3 12h18M7 16h10L7 21v-5M7 8h10L7 3v5"/></svg>',action:"flipY"},fitX:{icon:'<svg><path d="M4 12V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v6M10 18H3M21 18h-7M6 15l-3 3 3 3M18 15l3 3-3 3"/></svg>',action:"fitX"},fitY:{icon:'<svg><path d="M12 20H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M18 14v7M18 3v7M15 18l3 3 3-3M15 6l3-3 3 3"/></svg>',action:"fitY"},reset:{icon:'<svg><path d="M20 11A8.1 8.1 0 0 0 4.5 9M4 5v4h4M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"/></svg>',action:"reset"},toggleFS:{icon:'<svg><g><path d="M14.5 9.5 21 3m0 0h-6m6 0v6M3 21l6.5-6.5M3 21v-6m0 6h6"/></g><g><path d="m14 10 7-7m-7 7h6m-6 0V4M3 21l7-7m0 0v6m0-6H4"/></g></svg>',action:"toggleFS"}};var ji;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Disabled=2]="Disabled"})(ji||(ji={}));const gd={absolute:"auto",display:{left:["infobar"],middle:[],right:["iterateZoom","slideshow","fullscreen","thumbs","close"]},enabled:"auto",items:{infobar:{tpl:'<div class="fancybox__infobar" tabindex="-1"><span data-fancybox-current-index></span>/<span data-fancybox-count></span></div>'},download:{tpl:'<a class="f-button" title="{{DOWNLOAD}}" data-fancybox-download href="javasript:;"><svg><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2M7 11l5 5 5-5M12 4v12"/></svg></a>'},prev:{tpl:'<button class="f-button" title="{{PREV}}" data-fancybox-prev><svg><path d="m15 6-6 6 6 6"/></svg></button>'},next:{tpl:'<button class="f-button" title="{{NEXT}}" data-fancybox-next><svg><path d="m9 6 6 6-6 6"/></svg></button>'},slideshow:{tpl:'<button class="f-button" title="{{TOGGLE_SLIDESHOW}}" data-fancybox-toggle-slideshow><svg><g><path d="M8 4v16l13 -8z"></path></g><g><path d="M8 4v15M17 4v15"/></g></svg></button>'},fullscreen:{tpl:'<button class="f-button" title="{{TOGGLE_FULLSCREEN}}" data-fancybox-toggle-fullscreen><svg><g><path d="M4 8V6a2 2 0 0 1 2-2h2M4 16v2a2 2 0 0 0 2 2h2M16 4h2a2 2 0 0 1 2 2v2M16 20h2a2 2 0 0 0 2-2v-2"/></g><g><path d="M15 19v-2a2 2 0 0 1 2-2h2M15 5v2a2 2 0 0 0 2 2h2M5 15h2a2 2 0 0 1 2 2v2M5 9h2a2 2 0 0 0 2-2V5"/></g></svg></button>'},thumbs:{tpl:'<button class="f-button" title="{{TOGGLE_THUMBS}}" data-fancybox-toggle-thumbs><svg><circle cx="5.5" cy="5.5" r="1"/><circle cx="12" cy="5.5" r="1"/><circle cx="18.5" cy="5.5" r="1"/><circle cx="5.5" cy="12" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="18.5" cy="12" r="1"/><circle cx="5.5" cy="18.5" r="1"/><circle cx="12" cy="18.5" r="1"/><circle cx="18.5" cy="18.5" r="1"/></svg></button>'},close:{tpl:'<button class="f-button" title="{{CLOSE}}" data-fancybox-close><svg><path d="m19.5 4.5-15 15M4.5 4.5l15 15"/></svg></button>'}},parentEl:null},vd={tabindex:"-1",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},qo="has-toolbar",Da="fancybox__toolbar";class Ws extends Vn{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:ji.Init}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null})}onReady(e){var r;if(!e.carousel)return;let s=this.option("display"),l=this.option("absolute"),d=this.option("enabled");if(d==="auto"){const S=this.instance.carousel;let k=0;if(S)for(const h of S.slides)(h.panzoom||h.type==="image")&&k++;k||(d=!1)}d||(s=void 0);let m=0;const u={left:[],middle:[],right:[]};if(s)for(const S of["left","middle","right"])for(const k of s[S]){const h=this.createEl(k);h&&((r=u[S])===null||r===void 0||r.push(h),m++)}let g=null;if(m&&(g=this.createContainer()),g){for(const[S,k]of Object.entries(u)){const h=document.createElement("div");We(h,Da+"__column is-"+S);for(const f of k)h.appendChild(f);l!=="auto"||S!=="middle"||k.length||(l=!0),g.appendChild(h)}l===!0&&We(g,"is-absolute"),this.state=ji.Ready,this.onRefresh()}else this.state=ji.Disabled}onClick(e){var r,s;const l=this.instance,d=l.getSlide(),m=d==null?void 0:d.panzoom,u=e.target,g=u&&vn(u)?u.dataset:null;if(!g)return;if(g.fancyboxToggleThumbs!==void 0)return e.preventDefault(),e.stopPropagation(),void((r=l.plugins.Thumbs)===null||r===void 0||r.toggle());if(g.fancyboxToggleFullscreen!==void 0)return e.preventDefault(),e.stopPropagation(),void this.instance.toggleFullscreen();if(g.fancyboxToggleSlideshow!==void 0){e.preventDefault(),e.stopPropagation();const h=(s=l.carousel)===null||s===void 0?void 0:s.plugins.Autoplay;let f=h.isActive;return m&&m.panMode==="mousemove"&&!f&&m.reset(),void(f?h.stop():h.start())}const S=g.panzoomAction,k=g.panzoomChange;if((k||S)&&(e.preventDefault(),e.stopPropagation()),k){let h={};try{h=JSON.parse(k)}catch{}m&&m.applyChange(h)}else S&&m&&m[S]&&m[S]()}onChange(){this.onRefresh()}onRefresh(){if(this.instance.isClosing())return;const e=this.container;if(!e)return;const r=this.instance.getSlide();if(!r||r.state!==ln.Ready)return;const s=r&&!r.error&&r.panzoom;for(const m of e.querySelectorAll("[data-panzoom-action]"))s?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));let l=s&&s.canZoomIn(),d=s&&s.canZoomOut();for(const m of e.querySelectorAll('[data-panzoom-action="zoomIn"]'))l?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of e.querySelectorAll('[data-panzoom-action="zoomOut"]'))d?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of e.querySelectorAll('[data-panzoom-action="toggleZoom"],[data-panzoom-action="iterateZoom"]')){d||l?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));const u=m.querySelector("g");u&&(u.style.display=l?"":"none")}}onDone(e,r){var s;(s=r.panzoom)===null||s===void 0||s.on("afterTransform",()=>{this.instance.isCurrentSlide(r)&&this.onRefresh()}),this.instance.isCurrentSlide(r)&&this.onRefresh()}createContainer(){const e=this.instance.container;if(!e)return null;const r=this.option("parentEl")||e;let s=r.querySelector("."+Da);return s||(s=document.createElement("div"),We(s,Da),r.prepend(s)),s.addEventListener("click",this.onClick,{passive:!1,capture:!0}),e&&We(e,qo),this.container=s,s}createEl(e){const r=this.instance,s=r.carousel;if(!s||e==="toggleFS"||e==="fullscreen"&&!Rs())return null;let l=null;const d=s.slides.length||0;let m=0,u=0;for(const S of s.slides)(S.panzoom||S.type==="image")&&m++,(S.type==="image"||S.downloadSrc)&&u++;if(d<2&&["infobar","prev","next"].includes(e))return l;if(La[e]!==void 0&&!m||e==="download"&&!u)return null;if(e==="thumbs"){const S=r.plugins.Thumbs;if(!S||!S.isEnabled)return null}if(e==="slideshow"&&(!s.plugins.Autoplay||d<2))return null;if(La[e]!==void 0){const S=La[e];l=document.createElement("button"),l.setAttribute("title",this.instance.localize(`{{${e.toUpperCase()}}}`)),We(l,"f-button"),S.action&&(l.dataset.panzoomAction=S.action),S.change&&(l.dataset.panzoomChange=JSON.stringify(S.change)),l.appendChild(Xn(this.instance.localize(S.icon)))}else{const S=(this.option("items")||[])[e];S&&(l=Xn(this.instance.localize(S.tpl)),typeof S.click=="function"&&l.addEventListener("click",k=>{k.preventDefault(),k.stopPropagation(),typeof S.click=="function"&&S.click.call(this,this,k)}))}const g=l==null?void 0:l.querySelector("svg");if(g)for(const[S,k]of Object.entries(vd))g.getAttribute(S)||g.setAttribute(S,String(k));return l}removeContainer(){const e=this.container;e&&e.remove(),this.container=null,this.state=ji.Disabled;const r=this.instance.container;r&&kt(r,qo)}attach(){const e=this,r=e.instance;r.on("Carousel.initSlides",e.onReady),r.on("done",e.onDone),r.on(["reveal","Carousel.change"],e.onChange),e.onReady(e.instance)}detach(){const e=this,r=e.instance;r.off("Carousel.initSlides",e.onReady),r.off("done",e.onDone),r.off(["reveal","Carousel.change"],e.onChange),e.removeContainer()}}Object.defineProperty(Ws,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:gd});const bd={Hash:class extends Vn{onReady(){wr=!1}onChange(p){Hi&&clearTimeout(Hi);const{hash:e}=Is(),{hash:r}=ua(),s=p.isOpeningSlide(p.getSlide());s&&(jo=r===e?"":r),e&&e!==r&&(Hi=setTimeout(()=>{try{if(p.state===Jt.Ready){let l="replaceState";s&&!Zr&&(l="pushState",Zr=!0),window.history[l]({},document.title,window.location.pathname+window.location.search+e)}}catch{}},300))}onClose(p){if(Hi&&clearTimeout(Hi),!wr&&Zr)return Zr=!1,wr=!1,void window.history.back();if(!wr)try{window.history.replaceState({},document.title,window.location.pathname+window.location.search+(jo||""))}catch{}}attach(){const p=this.instance;p.on("ready",this.onReady),p.on(["Carousel.ready","Carousel.change"],this.onChange),p.on("close",this.onClose)}detach(){const p=this.instance;p.off("ready",this.onReady),p.off(["Carousel.ready","Carousel.change"],this.onChange),p.off("close",this.onClose)}static parseURL(){return ua()}static startFromUrl(){Hs()}static destroy(){window.removeEventListener("hashchange",js,!1)}},Html:Bs,Images:$s,Slideshow:zs,Thumbs:qs,Toolbar:Ws},Wo="with-fancybox",Oa="hide-scrollbar",Yo="--fancybox-scrollbar-compensate",Ko="--fancybox-body-margin",Pa="aria-hidden",Ra="is-using-tab",Ia="is-animated",Go="is-compact",Xo="is-loading",Ha="is-opening",na="has-caption",er="disabled",Oi="tabindex",Zo="download",Na="href",tr="src",yi=p=>typeof p=="string",Jo=function(){var p=window.getSelection();return!!p&&p.type==="Range"};let Dn,On=null,Pi=null,Qo=0,es=0,ts=0,ns=0;const nr=new Map;let yd=0;class vt extends io{get isIdle(){return this.idle}get isCompact(){return this.option("compact")}constructor(e=[],r={},s={}){super(r),Object.defineProperty(this,"userSlides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"idle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"idleTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"ignoreFocusChange",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"startedFs",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Jt.Init}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"footer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"lastFocus",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prevMouseMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Dn||(Dn=Rs()),this.id=r.id||++yd,nr.set(this.id,this),this.userSlides=e,this.userPlugins=s,queueMicrotask(()=>{this.init()})}init(){if(this.state===Jt.Destroy)return;this.state=Jt.Init,this.attachPlugins(Object.assign(Object.assign({},vt.Plugins),this.userPlugins)),this.emit("init"),this.emit("attachPlugins"),this.option("hideScrollbar")===!0&&(()=>{if(!xr)return;const r=document,s=r.body,l=r.documentElement;if(s.classList.contains(Oa))return;let d=window.innerWidth-l.getBoundingClientRect().width;const m=parseFloat(window.getComputedStyle(s).marginRight);d<0&&(d=0),l.style.setProperty(Yo,`${d}px`),m&&s.style.setProperty(Ko,`${m}px`),s.classList.add(Oa)})(),this.initLayout(),this.scale();const e=()=>{this.initCarousel(this.userSlides),this.state=Jt.Ready,this.attachEvents(),this.emit("ready"),setTimeout(()=>{this.container&&this.container.setAttribute(Pa,"false")},16)};this.option("Fullscreen.autoStart")&&Dn&&!Dn.isFullscreen()?Dn.request().then(()=>{this.startedFs=!0,e()}).catch(()=>e()):e()}initLayout(){var e,r;const s=this.option("parentEl")||document.body,l=Xn(this.localize(this.option("tpl.main")||""));if(l){if(l.setAttribute("id",`fancybox-${this.id}`),l.setAttribute("aria-label",this.localize("{{MODAL}}")),l.classList.toggle(Go,this.isCompact),We(l,this.option("mainClass")||""),We(l,Ha),this.container=l,this.footer=l.querySelector(".fancybox__footer"),s.appendChild(l),We(document.documentElement,Wo),On&&Pi||(On=document.createElement("span"),We(On,"fancybox-focus-guard"),On.setAttribute(Oi,"0"),On.setAttribute(Pa,"true"),On.setAttribute("aria-label","Focus guard"),Pi=On.cloneNode(),(e=l.parentElement)===null||e===void 0||e.insertBefore(On,l),(r=l.parentElement)===null||r===void 0||r.append(Pi)),l.addEventListener("mousedown",d=>{Qo=d.pageX,es=d.pageY,kt(l,Ra)}),this.option("closeExisting"))for(const d of nr.values())d.id!==this.id&&d.close();else this.option("animated")&&(We(l,Ia),setTimeout(()=>{this.isClosing()||kt(l,Ia)},350));this.emit("initLayout")}}initCarousel(e){const r=this.container;if(!r)return;const s=r.querySelector(".fancybox__carousel");if(!s)return;const l=this.carousel=new zi(s,bn({},{slides:e,transition:"fade",Panzoom:{lockAxis:this.option("dragToClose")?"xy":"x",infinite:!!this.option("dragToClose")&&"y"},Dots:!1,Navigation:{classes:{container:"fancybox__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"}},initialPage:this.option("startIndex"),l10n:this.option("l10n")},this.option("Carousel")||{}));l.on("*",(d,m,...u)=>{this.emit(`Carousel.${m}`,d,...u)}),l.on(["ready","change"],()=>{this.manageCaption()}),this.on("Carousel.removeSlide",(d,m,u)=>{this.clearContent(u),u.state=void 0}),l.on("Panzoom.touchStart",()=>{var d,m;this.isCompact||this.endIdle(),!((d=document.activeElement)===null||d===void 0)&&d.closest(".f-thumbs")&&((m=this.container)===null||m===void 0||m.focus())}),l.on("settle",()=>{this.idleTimer||this.isCompact||!this.option("idle")||this.setIdle(),this.option("autoFocus")&&!this.isClosing&&this.checkFocus()}),this.option("dragToClose")&&(l.on("Panzoom.afterTransform",(d,m)=>{const u=this.getSlide();if(u&&Fa(u.el))return;const g=this.container;if(g){const S=Math.abs(m.current.f),k=S<1?"":Math.max(.5,Math.min(1,1-S/m.contentRect.fitHeight*1.5));g.style.setProperty("--fancybox-ts",k?"0s":""),g.style.setProperty("--fancybox-opacity",k+"")}}),l.on("Panzoom.touchEnd",(d,m,u)=>{var g;const S=this.getSlide();if(S&&Fa(S.el)||m.isMobile&&document.activeElement&&["TEXTAREA","INPUT"].indexOf((g=document.activeElement)===null||g===void 0?void 0:g.nodeName)!==-1)return;const k=Math.abs(m.dragOffset.y);m.lockedAxis==="y"&&(k>=200||k>=50&&m.dragOffset.time<300)&&(u&&u.cancelable&&u.preventDefault(),this.close(u,"f-throwOut"+(m.current.f<0?"Up":"Down")))})),l.on("change",d=>{var m;let u=(m=this.getSlide())===null||m===void 0?void 0:m.triggerEl;if(u){const g=new CustomEvent("slideTo",{bubbles:!0,cancelable:!0,detail:d.page});u.dispatchEvent(g)}}),l.on(["refresh","change"],d=>{const m=this.container;if(!m)return;for(const S of m.querySelectorAll("[data-fancybox-current-index]"))S.innerHTML=d.page+1;for(const S of m.querySelectorAll("[data-fancybox-count]"))S.innerHTML=d.pages.length;if(!d.isInfinite){for(const S of m.querySelectorAll("[data-fancybox-next]"))d.page<d.pages.length-1?(S.removeAttribute(er),S.removeAttribute(Oi)):(S.setAttribute(er,""),S.setAttribute(Oi,"-1"));for(const S of m.querySelectorAll("[data-fancybox-prev]"))d.page>0?(S.removeAttribute(er),S.removeAttribute(Oi)):(S.setAttribute(er,""),S.setAttribute(Oi,"-1"))}const u=this.getSlide();if(!u)return;let g=u.downloadSrc||"";g||u.type!=="image"||u.error||!yi(u[tr])||(g=u[tr]);for(const S of m.querySelectorAll("[data-fancybox-download]")){const k=u.downloadFilename;g?(S.removeAttribute(er),S.removeAttribute(Oi),S.setAttribute(Na,g),S.setAttribute(Zo,k||g),S.setAttribute("target","_blank")):(S.setAttribute(er,""),S.setAttribute(Oi,"-1"),S.removeAttribute(Na),S.removeAttribute(Zo))}}),this.emit("initCarousel")}attachEvents(){const e=this,r=e.container;if(!r)return;r.addEventListener("click",e.onClick,{passive:!1,capture:!1}),r.addEventListener("wheel",e.onWheel,{passive:!1,capture:!1}),document.addEventListener("keydown",e.onKeydown,{passive:!1,capture:!0}),document.addEventListener("visibilitychange",e.onVisibilityChange,!1),document.addEventListener("mousemove",e.onMousemove),e.option("trapFocus")&&document.addEventListener("focus",e.onFocus,!0),window.addEventListener("resize",e.onResize);const s=window.visualViewport;s&&(s.addEventListener("scroll",e.onResize),s.addEventListener("resize",e.onResize))}detachEvents(){const e=this,r=e.container;if(!r)return;document.removeEventListener("keydown",e.onKeydown,{passive:!1,capture:!0}),r.removeEventListener("wheel",e.onWheel,{passive:!1,capture:!1}),r.removeEventListener("click",e.onClick,{passive:!1,capture:!1}),document.removeEventListener("mousemove",e.onMousemove),window.removeEventListener("resize",e.onResize);const s=window.visualViewport;s&&(s.removeEventListener("resize",e.onResize),s.removeEventListener("scroll",e.onResize)),document.removeEventListener("visibilitychange",e.onVisibilityChange,!1),document.removeEventListener("focus",e.onFocus,!0)}scale(){const e=this.container;if(!e)return;const r=window.visualViewport,s=Math.max(1,(r==null?void 0:r.scale)||1);let l="",d="",m="";if(r&&s>1){let u=`${r.offsetLeft}px`,g=`${r.offsetTop}px`;l=r.width*s+"px",d=r.height*s+"px",m=`translate3d(${u}, ${g}, 0) scale(${1/s})`}e.style.transform=m,e.style.width=l,e.style.height=d}onClick(e){var r;const{container:s,isCompact:l}=this;if(!s||this.isClosing())return;!l&&this.option("idle")&&this.resetIdle();const d=e.composedPath()[0];if(d.closest(".fancybox-spinner")||d.closest("[data-fancybox-close]"))return e.preventDefault(),void this.close(e);if(d.closest("[data-fancybox-prev]"))return e.preventDefault(),void this.prev();if(d.closest("[data-fancybox-next]"))return e.preventDefault(),void this.next();if(e.type==="click"&&e.detail===0||Math.abs(e.pageX-Qo)>30||Math.abs(e.pageY-es)>30)return;const m=document.activeElement;if(Jo()&&m&&s.contains(m))return;if(l&&((r=this.getSlide())===null||r===void 0?void 0:r.type)==="image")return void(this.clickTimer?(clearTimeout(this.clickTimer),this.clickTimer=null):this.clickTimer=setTimeout(()=>{this.toggleIdle(),this.clickTimer=null},350));if(this.emit("click",e),e.defaultPrevented)return;let u=!1;if(d.closest(".fancybox__content")){if(m){if(m.closest("[contenteditable]"))return;d.matches(Ta)||m.blur()}if(Jo())return;u=this.option("contentClick")}else d.closest(".fancybox__carousel")&&!d.matches(Ta)&&(u=this.option("backdropClick"));u==="close"?(e.preventDefault(),this.close(e)):u==="next"?(e.preventDefault(),this.next()):u==="prev"&&(e.preventDefault(),this.prev())}onWheel(e){const r=e.target;let s=this.option("wheel",e);r.closest(".fancybox__thumbs")&&(s="slide");const l=s==="slide",d=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(g,S){return Math.abs(S)>Math.abs(g)?S:g}),m=Math.max(-1,Math.min(1,d)),u=Date.now();this.pwt&&u-this.pwt<300?l&&e.preventDefault():(this.pwt=u,this.emit("wheel",e,m),e.defaultPrevented||(s==="close"?(e.preventDefault(),this.close(e)):s==="slide"&&(la(r)||(e.preventDefault(),this[m>0?"prev":"next"]()))))}onScroll(){window.scrollTo(ts,ns)}onKeydown(e){if(!this.isTopmost())return;this.isCompact||!this.option("idle")||this.isClosing()||this.resetIdle();const r=e.key,s=this.option("keyboard");if(!s)return;const l=e.composedPath()[0],d=document.activeElement&&document.activeElement.classList,m=d&&d.contains("f-button")||l.dataset.carouselPage||l.dataset.carouselIndex;if(r!=="Escape"&&!m&&vn(l)&&(l.isContentEditable||["TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(l.nodeName)!==-1)||(e.key==="Tab"?We(this.container,Ra):kt(this.container,Ra),e.ctrlKey||e.altKey||e.shiftKey))return;this.emit("keydown",r,e);const u=s[r];u&&typeof this[u]=="function"&&(e.preventDefault(),this[u]())}onResize(){const e=this.container;if(!e)return;const r=this.isCompact;e.classList.toggle(Go,r),this.manageCaption(this.getSlide()),this.isCompact?this.clearIdle():this.endIdle(),this.scale(),this.emit("resize")}onFocus(e){this.isTopmost()&&this.checkFocus(e)}onMousemove(e){this.prevMouseMoveEvent=e,!this.isCompact&&this.option("idle")&&this.resetIdle()}onVisibilityChange(){document.visibilityState==="visible"?this.checkFocus():this.endIdle()}manageCloseBtn(e){const r=this.optionFor(e,"closeButton")||!1;if(r==="auto"){const l=this.plugins.Toolbar;if(l&&l.state===ji.Ready)return}if(!r||!e.contentEl||e.closeBtnEl)return;const s=this.option("tpl.closeButton");if(s){const l=Xn(this.localize(s));e.closeBtnEl=e.contentEl.appendChild(l),e.el&&We(e.el,"has-close-btn")}}manageCaption(e=void 0){var r,s;const l="fancybox__caption",d=this.container;if(!d)return;kt(d,na);const m=this.isCompact||this.option("commonCaption"),u=!m;if(this.caption&&this.stop(this.caption),u&&this.caption&&(this.caption.remove(),this.caption=null),m&&!this.caption)for(const h of((r=this.carousel)===null||r===void 0?void 0:r.slides)||[])h.captionEl&&(h.captionEl.remove(),h.captionEl=void 0,kt(h.el,na),(s=h.el)===null||s===void 0||s.removeAttribute("aria-labelledby"));if(e||(e=this.getSlide()),!e||m&&!this.isCurrentSlide(e))return;const g=e.el;let S=this.optionFor(e,"caption","");if(!S)return void(m&&this.caption&&this.animate(this.caption,"f-fadeOut",()=>{this.caption&&(this.caption.innerHTML="")}));let k=null;if(u){if(k=e.captionEl||null,g&&!k){const h=l+`_${this.id}_${e.index}`;k=document.createElement("div"),We(k,l),k.setAttribute("id",h),e.captionEl=g.appendChild(k),We(g,na),g.setAttribute("aria-labelledby",h)}}else k=this.caption,k||(k=d.querySelector("."+l)),!k&&(k=document.createElement("div"),k.dataset.fancyboxCaption="",We(k,l),(this.footer||d).prepend(k)),We(d,na),this.caption=k;k&&(k.innerHTML="",yi(S)||typeof S=="number"?k.innerHTML=S+"":S instanceof HTMLElement&&k.appendChild(S))}checkFocus(e){this.focus(e)}focus(e){var r;if(this.ignoreFocusChange)return;const s=document.activeElement||null,l=(e==null?void 0:e.target)||null,d=this.container,m=(r=this.carousel)===null||r===void 0?void 0:r.viewport;if(!d||!m||!e&&s&&d.contains(s))return;const u=this.getSlide(),g=u&&u.state===ln.Ready?u.el:null;if(!g||g.contains(s)||d===s)return;e&&e.cancelable&&e.preventDefault(),this.ignoreFocusChange=!0;const S=Array.from(d.querySelectorAll(Ta));let k=[],h=null;for(let b of S){const y=!b.offsetParent||!!b.closest('[aria-hidden="true"]'),E=g&&g.contains(b),w=!m.contains(b);if(b===d||(E||w)&&!y){k.push(b);const C=b.dataset.origTabindex;C!==void 0&&C&&(b.tabIndex=parseFloat(C)),b.removeAttribute("data-orig-tabindex"),!b.hasAttribute("autoFocus")&&h||(h=b)}else{const C=b.dataset.origTabindex===void 0?b.getAttribute("tabindex")||"":b.dataset.origTabindex;C&&(b.dataset.origTabindex=C),b.tabIndex=-1}}let f=null;e?(!l||k.indexOf(l)<0)&&(f=h||d,k.length&&(s===Pi?f=k[0]:this.lastFocus!==d&&s!==On||(f=k[k.length-1]))):f=u&&u.type==="image"?d:h||d,f&&No(f),this.lastFocus=document.activeElement,this.ignoreFocusChange=!1}next(){const e=this.carousel;e&&e.pages.length>1&&e.slideNext()}prev(){const e=this.carousel;e&&e.pages.length>1&&e.slidePrev()}jumpTo(...e){this.carousel&&this.carousel.slideTo(...e)}isTopmost(){var e;return((e=vt.getInstance())===null||e===void 0?void 0:e.id)==this.id}animate(e=null,r="",s){if(!e||!r)return void(s&&s());this.stop(e);const l=d=>{d.target===e&&e.dataset.animationName&&(e.removeEventListener("animationend",l),delete e.dataset.animationName,s&&s(),kt(e,r))};e.dataset.animationName=r,e.addEventListener("animationend",l),We(e,r)}stop(e){e&&e.dispatchEvent(new CustomEvent("animationend",{bubbles:!1,cancelable:!0,currentTarget:e}))}setContent(e,r="",s=!0){if(this.isClosing())return;const l=e.el;if(!l)return;let d=null;if(vn(r)?d=r:(d=Xn(r+""),vn(d)||(d=document.createElement("div"),d.innerHTML=r+"")),["img","picture","iframe","video","audio"].includes(d.nodeName.toLowerCase())){const m=document.createElement("div");m.appendChild(d),d=m}vn(d)&&e.filter&&!e.error&&(d=d.querySelector(e.filter)),d&&vn(d)?(We(d,"fancybox__content"),e.id&&d.setAttribute("id",e.id),l.classList.add(`has-${e.error?"error":e.type||"unknown"}`),l.prepend(d),d.style.display==="none"&&(d.style.display=""),getComputedStyle(d).getPropertyValue("display")==="none"&&(d.style.display=e.display||this.option("defaultDisplay")||"flex"),e.contentEl=d,s&&this.revealContent(e),this.manageCloseBtn(e),this.manageCaption(e)):this.setError(e,"{{ELEMENT_NOT_FOUND}}")}revealContent(e,r){const s=e.el,l=e.contentEl;s&&l&&(this.emit("reveal",e),this.hideLoading(e),e.state=ln.Opening,(r=this.isOpeningSlide(e)?r===void 0?this.optionFor(e,"showClass"):r:"f-fadeIn")?this.animate(l,r,()=>{this.done(e)}):this.done(e))}done(e){this.isClosing()||(e.state=ln.Ready,this.emit("done",e),We(e.el,"is-done"),this.isCurrentSlide(e)&&this.option("autoFocus")&&queueMicrotask(()=>{var r;(r=e.panzoom)===null||r===void 0||r.updateControls(),this.option("autoFocus")&&this.focus()}),this.isOpeningSlide(e)&&(kt(this.container,Ha),!this.isCompact&&this.option("idle")&&this.setIdle()))}isCurrentSlide(e){const r=this.getSlide();return!(!e||!r)&&r.index===e.index}isOpeningSlide(e){var r,s;return((r=this.carousel)===null||r===void 0?void 0:r.prevPage)===null&&e&&e.index===((s=this.getSlide())===null||s===void 0?void 0:s.index)}showLoading(e){e.state=ln.Loading;const r=e.el;r&&(We(r,Xo),this.emit("loading",e),e.spinnerEl||setTimeout(()=>{if(!this.isClosing()&&!e.spinnerEl&&e.state===ln.Loading){let s=Xn(ro);We(s,"fancybox-spinner"),e.spinnerEl=s,r.prepend(s),this.animate(s,"f-fadeIn")}},250))}hideLoading(e){const r=e.el;if(!r)return;const s=e.spinnerEl;this.isClosing()?s==null||s.remove():(kt(r,Xo),s&&this.animate(s,"f-fadeOut",()=>{s.remove()}),e.state===ln.Loading&&(this.emit("loaded",e),e.state=ln.Ready))}setError(e,r){if(this.isClosing())return;const s=new Event("error",{bubbles:!0,cancelable:!0});if(this.emit("error",s,e),s.defaultPrevented)return;e.error=r,this.hideLoading(e),this.clearContent(e);const l=document.createElement("div");l.classList.add("fancybox-error"),l.innerHTML=this.localize(r||"<p>{{ERROR}}</p>"),this.setContent(e,l)}clearContent(e){if(e.state===void 0)return;this.emit("clearContent",e),e.contentEl&&(e.contentEl.remove(),e.contentEl=void 0);const r=e.el;r&&(kt(r,"has-error"),kt(r,"has-unknown"),kt(r,`has-${e.type||"unknown"}`)),e.closeBtnEl&&e.closeBtnEl.remove(),e.closeBtnEl=void 0,e.captionEl&&e.captionEl.remove(),e.captionEl=void 0,e.spinnerEl&&e.spinnerEl.remove(),e.spinnerEl=void 0}getSlide(){var e;const r=this.carousel;return((e=r==null?void 0:r.pages[r==null?void 0:r.page])===null||e===void 0?void 0:e.slides[0])||void 0}close(e,r){if(this.isClosing())return;const s=new Event("shouldClose",{bubbles:!0,cancelable:!0});if(this.emit("shouldClose",s,e),s.defaultPrevented)return;e&&e.cancelable&&(e.preventDefault(),e.stopPropagation());const l=()=>{this.proceedClose(e,r)};this.startedFs&&Dn&&Dn.isFullscreen()?Promise.resolve(Dn.exit()).then(()=>l()):l()}clearIdle(){this.idleTimer&&clearTimeout(this.idleTimer),this.idleTimer=null}setIdle(e=!1){const r=()=>{this.clearIdle(),this.idle=!0,We(this.container,"is-idle"),this.emit("setIdle")};if(this.clearIdle(),!this.isClosing())if(e)r();else{const s=this.option("idle");s&&(this.idleTimer=setTimeout(r,s))}}endIdle(){this.clearIdle(),this.idle&&!this.isClosing()&&(this.idle=!1,kt(this.container,"is-idle"),this.emit("endIdle"))}resetIdle(){this.endIdle(),this.setIdle()}toggleIdle(){this.idle?this.endIdle():this.setIdle(!0)}toggleFullscreen(){Dn&&(Dn.isFullscreen()?Dn.exit():Dn.request().then(()=>{this.startedFs=!0}))}isClosing(){return[Jt.Closing,Jt.CustomClosing,Jt.Destroy].includes(this.state)}proceedClose(e,r){var s,l;this.state=Jt.Closing,this.clearIdle(),this.detachEvents();const d=this.container,m=this.carousel,u=this.getSlide(),g=u&&this.option("placeFocusBack")?u.triggerEl||this.option("triggerEl"):null;if(g&&(Ps(g)?No(g):g.focus()),d&&(kt(d,Ha),We(d,"is-closing"),d.setAttribute(Pa,"true"),this.option("animated")&&We(d,Ia),d.style.pointerEvents="none"),m){m.clearTransitions(),(s=m.panzoom)===null||s===void 0||s.destroy(),(l=m.plugins.Navigation)===null||l===void 0||l.detach();for(const S of m.slides){S.state=ln.Closing,this.hideLoading(S);const k=S.contentEl;k&&this.stop(k);const h=S==null?void 0:S.panzoom;h&&(h.stop(),h.detachEvents(),h.detachObserver()),this.isCurrentSlide(S)||m.emit("removeSlide",S)}}ts=window.scrollX,ns=window.scrollY,window.addEventListener("scroll",this.onScroll),this.emit("close",e),this.state!==Jt.CustomClosing?(r===void 0&&u&&(r=this.optionFor(u,"hideClass")),r&&u?(this.animate(u.contentEl,r,()=>{m&&m.emit("removeSlide",u)}),setTimeout(()=>{this.destroy()},500)):this.destroy()):setTimeout(()=>{this.destroy()},500)}destroy(){var e;if(this.state===Jt.Destroy)return;window.removeEventListener("scroll",this.onScroll),this.state=Jt.Destroy,(e=this.carousel)===null||e===void 0||e.destroy();const r=this.container;r&&r.remove(),nr.delete(this.id);const s=vt.getInstance();s?s.focus():(On&&(On.remove(),On=null),Pi&&(Pi.remove(),Pi=null),kt(document.documentElement,Wo),(()=>{if(!xr)return;const l=document,d=l.body;d.classList.remove(Oa),d.style.setProperty(Ko,""),l.documentElement.style.setProperty(Yo,"")})(),this.emit("destroy"))}static bind(e,r,s){if(!xr)return;let l,d="",m={};if(e===void 0?l=document.body:yi(e)?(l=document.body,d=e,typeof r=="object"&&(m=r||{})):(l=e,yi(r)&&(d=r),typeof s=="object"&&(m=s||{})),!l||!vn(l))return;d=d||"[data-fancybox]";const u=vt.openers.get(l)||new Map;u.set(d,m),vt.openers.set(l,u),u.size===1&&l.addEventListener("click",vt.fromEvent)}static unbind(e,r){let s,l="";if(yi(e)?(s=document.body,l=e):(s=e,yi(r)&&(l=r)),!s)return;const d=vt.openers.get(s);d&&l&&d.delete(l),l&&d||(vt.openers.delete(s),s.removeEventListener("click",vt.fromEvent))}static destroy(){let e;for(;e=vt.getInstance();)e.destroy();for(const r of vt.openers.keys())r.removeEventListener("click",vt.fromEvent);vt.openers=new Map}static fromEvent(e){if(e.defaultPrevented||e.button&&e.button!==0||e.ctrlKey||e.metaKey||e.shiftKey)return;let r=e.composedPath()[0];const s=r.closest("[data-fancybox-trigger]");if(s){const y=s.dataset.fancyboxTrigger||"",E=document.querySelectorAll(`[data-fancybox="${y}"]`),w=parseInt(s.dataset.fancyboxIndex||"",10)||0;r=E[w]||r}if(!(r&&r instanceof Element))return;let l,d,m,u;if([...vt.openers].reverse().find(([y,E])=>!(!y.contains(r)||![...E].reverse().find(([w,C])=>{let _=r.closest(w);return!!_&&(l=y,d=w,m=_,u=C,!0)}))),!l||!d||!m)return;u=u||{},e.preventDefault(),r=m;let g=[],S=bn({},qa,u);S.event=e,S.triggerEl=r,S.delegate=s;const k=S.groupAll,h=S.groupAttr,f=h&&r?r.getAttribute(`${h}`):"";if((!r||f||k)&&(g=[].slice.call(l.querySelectorAll(d))),r&&!k&&(g=f?g.filter(y=>y.getAttribute(`${h}`)===f):[r]),!g.length)return;const b=vt.getInstance();return b&&b.options.triggerEl&&g.indexOf(b.options.triggerEl)>-1?void 0:(r&&(S.startIndex=g.indexOf(r)),vt.fromNodes(g,S))}static fromSelector(e,r,s){let l=null,d="",m={};if(yi(e)?(l=document.body,d=e,typeof r=="object"&&(m=r||{})):e instanceof HTMLElement&&yi(r)&&(l=e,d=r,typeof s=="object"&&(m=s||{})),!l||!d)return!1;const u=vt.openers.get(l);return!!u&&(m=bn({},u.get(d)||{},m),!!m&&vt.fromNodes(Array.from(l.querySelectorAll(d)),m))}static fromNodes(e,r){r=bn({},qa,r||{});const s=[];for(const l of e){const d=l.dataset||{},m=d[tr]||l.getAttribute(Na)||l.getAttribute("currentSrc")||l.getAttribute(tr)||void 0;let u;const g=r.delegate;let S;g&&s.length===r.startIndex&&(u=g instanceof HTMLImageElement?g:g.querySelector("img:not([aria-hidden])")),u||(u=l instanceof HTMLImageElement?l:l.querySelector("img:not([aria-hidden])")),u&&(S=u.currentSrc||u[tr]||void 0,!S&&u.dataset&&(S=u.dataset.lazySrc||u.dataset[tr]||void 0));const k={src:m,triggerEl:l,thumbEl:u,thumbElSrc:S,thumbSrc:S};for(const h in d){let f=d[h]+"";f=f!=="false"&&(f==="true"||f),k[h]=f}s.push(k)}return new vt(s,r)}static getInstance(e){return e?nr.get(e):Array.from(nr.values()).reverse().find(r=>!r.isClosing()&&r)||null}static getSlide(){var e;return((e=vt.getInstance())===null||e===void 0?void 0:e.getSlide())||null}static show(e=[],r={}){return new vt(e,r)}static next(){const e=vt.getInstance();e&&e.next()}static prev(){const e=vt.getInstance();e&&e.prev()}static close(e=!0,...r){if(e)for(const s of nr.values())s.close(...r);else{const s=vt.getInstance();s&&s.close(...r)}}}Object.defineProperty(vt,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(vt,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:qa}),Object.defineProperty(vt,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:bd}),Object.defineProperty(vt,"openers",{enumerable:!0,configurable:!0,writable:!0,value:new Map});function wd(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var ra={exports:{}};/*!
 * Vditor v3.10.9 - A markdown editor written in TypeScript.
 *
 * MIT License
 *
 * Copyright (c) 2018-present B3log 开源, b3log.org
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */var kd=ra.exports,is;function Ed(){return is||(is=1,function(p,e){(function(s,l){p.exports=l()})(kd,()=>(()=>{var r={192:m=>{var u=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},g=-1,S=1,k=0;u.Diff=function(h,f){return[h,f]},u.prototype.diff_main=function(h,f,b,y){typeof y>"u"&&(this.Diff_Timeout<=0?y=Number.MAX_VALUE:y=new Date().getTime()+this.Diff_Timeout*1e3);var E=y;if(h==null||f==null)throw new Error("Null input. (diff_main)");if(h==f)return h?[new u.Diff(k,h)]:[];typeof b>"u"&&(b=!0);var w=b,C=this.diff_commonPrefix(h,f),_=h.substring(0,C);h=h.substring(C),f=f.substring(C),C=this.diff_commonSuffix(h,f);var T=h.substring(h.length-C);h=h.substring(0,h.length-C),f=f.substring(0,f.length-C);var M=this.diff_compute_(h,f,w,E);return _&&M.unshift(new u.Diff(k,_)),T&&M.push(new u.Diff(k,T)),this.diff_cleanupMerge(M),M},u.prototype.diff_compute_=function(h,f,b,y){var E;if(!h)return[new u.Diff(S,f)];if(!f)return[new u.Diff(g,h)];var w=h.length>f.length?h:f,C=h.length>f.length?f:h,_=w.indexOf(C);if(_!=-1)return E=[new u.Diff(S,w.substring(0,_)),new u.Diff(k,C),new u.Diff(S,w.substring(_+C.length))],h.length>f.length&&(E[0][0]=E[2][0]=g),E;if(C.length==1)return[new u.Diff(g,h),new u.Diff(S,f)];var T=this.diff_halfMatch_(h,f);if(T){var M=T[0],v=T[1],D=T[2],N=T[3],V=T[4],H=this.diff_main(M,D,b,y),$=this.diff_main(v,N,b,y);return H.concat([new u.Diff(k,V)],$)}return b&&h.length>100&&f.length>100?this.diff_lineMode_(h,f,y):this.diff_bisect_(h,f,y)},u.prototype.diff_lineMode_=function(h,f,b){var y=this.diff_linesToChars_(h,f);h=y.chars1,f=y.chars2;var E=y.lineArray,w=this.diff_main(h,f,!1,b);this.diff_charsToLines_(w,E),this.diff_cleanupSemantic(w),w.push(new u.Diff(k,""));for(var C=0,_=0,T=0,M="",v="";C<w.length;){switch(w[C][0]){case S:T++,v+=w[C][1];break;case g:_++,M+=w[C][1];break;case k:if(_>=1&&T>=1){w.splice(C-_-T,_+T),C=C-_-T;for(var D=this.diff_main(M,v,!1,b),N=D.length-1;N>=0;N--)w.splice(C,0,D[N]);C=C+D.length}T=0,_=0,M="",v="";break}C++}return w.pop(),w},u.prototype.diff_bisect_=function(h,f,b){for(var y=h.length,E=f.length,w=Math.ceil((y+E)/2),C=w,_=2*w,T=new Array(_),M=new Array(_),v=0;v<_;v++)T[v]=-1,M[v]=-1;T[C+1]=0,M[C+1]=0;for(var D=y-E,N=D%2!=0,V=0,H=0,$=0,z=0,F=0;F<w&&!(new Date().getTime()>b);F++){for(var le=-F+V;le<=F-H;le+=2){var de=C+le,Pe;le==-F||le!=F&&T[de-1]<T[de+1]?Pe=T[de+1]:Pe=T[de-1]+1;for(var Ue=Pe-le;Pe<y&&Ue<E&&h.charAt(Pe)==f.charAt(Ue);)Pe++,Ue++;if(T[de]=Pe,Pe>y)H+=2;else if(Ue>E)V+=2;else if(N){var Te=C+D-le;if(Te>=0&&Te<_&&M[Te]!=-1){var Le=y-M[Te];if(Pe>=Le)return this.diff_bisectSplit_(h,f,Pe,Ue,b)}}}for(var Re=-F+$;Re<=F-z;Re+=2){var Te=C+Re,Le;Re==-F||Re!=F&&M[Te-1]<M[Te+1]?Le=M[Te+1]:Le=M[Te-1]+1;for(var Je=Le-Re;Le<y&&Je<E&&h.charAt(y-Le-1)==f.charAt(E-Je-1);)Le++,Je++;if(M[Te]=Le,Le>y)z+=2;else if(Je>E)$+=2;else if(!N){var de=C+D-Re;if(de>=0&&de<_&&T[de]!=-1){var Pe=T[de],Ue=C+Pe-de;if(Le=y-Le,Pe>=Le)return this.diff_bisectSplit_(h,f,Pe,Ue,b)}}}}return[new u.Diff(g,h),new u.Diff(S,f)]},u.prototype.diff_bisectSplit_=function(h,f,b,y,E){var w=h.substring(0,b),C=f.substring(0,y),_=h.substring(b),T=f.substring(y),M=this.diff_main(w,C,!1,E),v=this.diff_main(_,T,!1,E);return M.concat(v)},u.prototype.diff_linesToChars_=function(h,f){var b=[],y={};b[0]="";function E(T){for(var M="",v=0,D=-1,N=b.length;D<T.length-1;){D=T.indexOf(`
`,v),D==-1&&(D=T.length-1);var V=T.substring(v,D+1);(y.hasOwnProperty?y.hasOwnProperty(V):y[V]!==void 0)?M+=String.fromCharCode(y[V]):(N==w&&(V=T.substring(v),D=T.length),M+=String.fromCharCode(N),y[V]=N,b[N++]=V),v=D+1}return M}var w=4e4,C=E(h);w=65535;var _=E(f);return{chars1:C,chars2:_,lineArray:b}},u.prototype.diff_charsToLines_=function(h,f){for(var b=0;b<h.length;b++){for(var y=h[b][1],E=[],w=0;w<y.length;w++)E[w]=f[y.charCodeAt(w)];h[b][1]=E.join("")}},u.prototype.diff_commonPrefix=function(h,f){if(!h||!f||h.charAt(0)!=f.charAt(0))return 0;for(var b=0,y=Math.min(h.length,f.length),E=y,w=0;b<E;)h.substring(w,E)==f.substring(w,E)?(b=E,w=b):y=E,E=Math.floor((y-b)/2+b);return E},u.prototype.diff_commonSuffix=function(h,f){if(!h||!f||h.charAt(h.length-1)!=f.charAt(f.length-1))return 0;for(var b=0,y=Math.min(h.length,f.length),E=y,w=0;b<E;)h.substring(h.length-E,h.length-w)==f.substring(f.length-E,f.length-w)?(b=E,w=b):y=E,E=Math.floor((y-b)/2+b);return E},u.prototype.diff_commonOverlap_=function(h,f){var b=h.length,y=f.length;if(b==0||y==0)return 0;b>y?h=h.substring(b-y):b<y&&(f=f.substring(0,b));var E=Math.min(b,y);if(h==f)return E;for(var w=0,C=1;;){var _=h.substring(E-C),T=f.indexOf(_);if(T==-1)return w;C+=T,(T==0||h.substring(E-C)==f.substring(0,C))&&(w=C,C++)}},u.prototype.diff_halfMatch_=function(h,f){if(this.Diff_Timeout<=0)return null;var b=h.length>f.length?h:f,y=h.length>f.length?f:h;if(b.length<4||y.length*2<b.length)return null;var E=this;function w(H,$,z){for(var F=H.substring(z,z+Math.floor(H.length/4)),le=-1,de="",Pe,Ue,Te,Le;(le=$.indexOf(F,le+1))!=-1;){var Re=E.diff_commonPrefix(H.substring(z),$.substring(le)),Je=E.diff_commonSuffix(H.substring(0,z),$.substring(0,le));de.length<Je+Re&&(de=$.substring(le-Je,le)+$.substring(le,le+Re),Pe=H.substring(0,z-Je),Ue=H.substring(z+Re),Te=$.substring(0,le-Je),Le=$.substring(le+Re))}return de.length*2>=H.length?[Pe,Ue,Te,Le,de]:null}var C=w(b,y,Math.ceil(b.length/4)),_=w(b,y,Math.ceil(b.length/2)),T;if(!C&&!_)return null;_?C?T=C[4].length>_[4].length?C:_:T=_:T=C;var M,v,D,N;h.length>f.length?(M=T[0],v=T[1],D=T[2],N=T[3]):(D=T[0],N=T[1],M=T[2],v=T[3]);var V=T[4];return[M,v,D,N,V]},u.prototype.diff_cleanupSemantic=function(h){for(var f=!1,b=[],y=0,E=null,w=0,C=0,_=0,T=0,M=0;w<h.length;)h[w][0]==k?(b[y++]=w,C=T,_=M,T=0,M=0,E=h[w][1]):(h[w][0]==S?T+=h[w][1].length:M+=h[w][1].length,E&&E.length<=Math.max(C,_)&&E.length<=Math.max(T,M)&&(h.splice(b[y-1],0,new u.Diff(g,E)),h[b[y-1]+1][0]=S,y--,y--,w=y>0?b[y-1]:-1,C=0,_=0,T=0,M=0,E=null,f=!0)),w++;for(f&&this.diff_cleanupMerge(h),this.diff_cleanupSemanticLossless(h),w=1;w<h.length;){if(h[w-1][0]==g&&h[w][0]==S){var v=h[w-1][1],D=h[w][1],N=this.diff_commonOverlap_(v,D),V=this.diff_commonOverlap_(D,v);N>=V?(N>=v.length/2||N>=D.length/2)&&(h.splice(w,0,new u.Diff(k,D.substring(0,N))),h[w-1][1]=v.substring(0,v.length-N),h[w+1][1]=D.substring(N),w++):(V>=v.length/2||V>=D.length/2)&&(h.splice(w,0,new u.Diff(k,v.substring(0,V))),h[w-1][0]=S,h[w-1][1]=D.substring(0,D.length-V),h[w+1][0]=g,h[w+1][1]=v.substring(V),w++),w++}w++}},u.prototype.diff_cleanupSemanticLossless=function(h){function f(V,H){if(!V||!H)return 6;var $=V.charAt(V.length-1),z=H.charAt(0),F=$.match(u.nonAlphaNumericRegex_),le=z.match(u.nonAlphaNumericRegex_),de=F&&$.match(u.whitespaceRegex_),Pe=le&&z.match(u.whitespaceRegex_),Ue=de&&$.match(u.linebreakRegex_),Te=Pe&&z.match(u.linebreakRegex_),Le=Ue&&V.match(u.blanklineEndRegex_),Re=Te&&H.match(u.blanklineStartRegex_);return Le||Re?5:Ue||Te?4:F&&!de&&Pe?3:de||Pe?2:F||le?1:0}for(var b=1;b<h.length-1;){if(h[b-1][0]==k&&h[b+1][0]==k){var y=h[b-1][1],E=h[b][1],w=h[b+1][1],C=this.diff_commonSuffix(y,E);if(C){var _=E.substring(E.length-C);y=y.substring(0,y.length-C),E=_+E.substring(0,E.length-C),w=_+w}for(var T=y,M=E,v=w,D=f(y,E)+f(E,w);E.charAt(0)===w.charAt(0);){y+=E.charAt(0),E=E.substring(1)+w.charAt(0),w=w.substring(1);var N=f(y,E)+f(E,w);N>=D&&(D=N,T=y,M=E,v=w)}h[b-1][1]!=T&&(T?h[b-1][1]=T:(h.splice(b-1,1),b--),h[b][1]=M,v?h[b+1][1]=v:(h.splice(b+1,1),b--))}b++}},u.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,u.whitespaceRegex_=/\s/,u.linebreakRegex_=/[\r\n]/,u.blanklineEndRegex_=/\n\r?\n$/,u.blanklineStartRegex_=/^\r?\n\r?\n/,u.prototype.diff_cleanupEfficiency=function(h){for(var f=!1,b=[],y=0,E=null,w=0,C=!1,_=!1,T=!1,M=!1;w<h.length;)h[w][0]==k?(h[w][1].length<this.Diff_EditCost&&(T||M)?(b[y++]=w,C=T,_=M,E=h[w][1]):(y=0,E=null),T=M=!1):(h[w][0]==g?M=!0:T=!0,E&&(C&&_&&T&&M||E.length<this.Diff_EditCost/2&&C+_+T+M==3)&&(h.splice(b[y-1],0,new u.Diff(g,E)),h[b[y-1]+1][0]=S,y--,E=null,C&&_?(T=M=!0,y=0):(y--,w=y>0?b[y-1]:-1,T=M=!1),f=!0)),w++;f&&this.diff_cleanupMerge(h)},u.prototype.diff_cleanupMerge=function(h){h.push(new u.Diff(k,""));for(var f=0,b=0,y=0,E="",w="",C;f<h.length;)switch(h[f][0]){case S:y++,w+=h[f][1],f++;break;case g:b++,E+=h[f][1],f++;break;case k:b+y>1?(b!==0&&y!==0&&(C=this.diff_commonPrefix(w,E),C!==0&&(f-b-y>0&&h[f-b-y-1][0]==k?h[f-b-y-1][1]+=w.substring(0,C):(h.splice(0,0,new u.Diff(k,w.substring(0,C))),f++),w=w.substring(C),E=E.substring(C)),C=this.diff_commonSuffix(w,E),C!==0&&(h[f][1]=w.substring(w.length-C)+h[f][1],w=w.substring(0,w.length-C),E=E.substring(0,E.length-C))),f-=b+y,h.splice(f,b+y),E.length&&(h.splice(f,0,new u.Diff(g,E)),f++),w.length&&(h.splice(f,0,new u.Diff(S,w)),f++),f++):f!==0&&h[f-1][0]==k?(h[f-1][1]+=h[f][1],h.splice(f,1)):f++,y=0,b=0,E="",w="";break}h[h.length-1][1]===""&&h.pop();var _=!1;for(f=1;f<h.length-1;)h[f-1][0]==k&&h[f+1][0]==k&&(h[f][1].substring(h[f][1].length-h[f-1][1].length)==h[f-1][1]?(h[f][1]=h[f-1][1]+h[f][1].substring(0,h[f][1].length-h[f-1][1].length),h[f+1][1]=h[f-1][1]+h[f+1][1],h.splice(f-1,1),_=!0):h[f][1].substring(0,h[f+1][1].length)==h[f+1][1]&&(h[f-1][1]+=h[f+1][1],h[f][1]=h[f][1].substring(h[f+1][1].length)+h[f+1][1],h.splice(f+1,1),_=!0)),f++;_&&this.diff_cleanupMerge(h)},u.prototype.diff_xIndex=function(h,f){var b=0,y=0,E=0,w=0,C;for(C=0;C<h.length&&(h[C][0]!==S&&(b+=h[C][1].length),h[C][0]!==g&&(y+=h[C][1].length),!(b>f));C++)E=b,w=y;return h.length!=C&&h[C][0]===g?w:w+(f-E)},u.prototype.diff_prettyHtml=function(h){for(var f=[],b=/&/g,y=/</g,E=/>/g,w=/\n/g,C=0;C<h.length;C++){var _=h[C][0],T=h[C][1],M=T.replace(b,"&amp;").replace(y,"&lt;").replace(E,"&gt;").replace(w,"&para;<br>");switch(_){case S:f[C]='<ins style="background:#e6ffe6;">'+M+"</ins>";break;case g:f[C]='<del style="background:#ffe6e6;">'+M+"</del>";break;case k:f[C]="<span>"+M+"</span>";break}}return f.join("")},u.prototype.diff_text1=function(h){for(var f=[],b=0;b<h.length;b++)h[b][0]!==S&&(f[b]=h[b][1]);return f.join("")},u.prototype.diff_text2=function(h){for(var f=[],b=0;b<h.length;b++)h[b][0]!==g&&(f[b]=h[b][1]);return f.join("")},u.prototype.diff_levenshtein=function(h){for(var f=0,b=0,y=0,E=0;E<h.length;E++){var w=h[E][0],C=h[E][1];switch(w){case S:b+=C.length;break;case g:y+=C.length;break;case k:f+=Math.max(b,y),b=0,y=0;break}}return f+=Math.max(b,y),f},u.prototype.diff_toDelta=function(h){for(var f=[],b=0;b<h.length;b++)switch(h[b][0]){case S:f[b]="+"+encodeURI(h[b][1]);break;case g:f[b]="-"+h[b][1].length;break;case k:f[b]="="+h[b][1].length;break}return f.join("	").replace(/%20/g," ")},u.prototype.diff_fromDelta=function(h,f){for(var b=[],y=0,E=0,w=f.split(/\t/g),C=0;C<w.length;C++){var _=w[C].substring(1);switch(w[C].charAt(0)){case"+":try{b[y++]=new u.Diff(S,decodeURI(_))}catch{throw new Error("Illegal escape in diff_fromDelta: "+_)}break;case"-":case"=":var T=parseInt(_,10);if(isNaN(T)||T<0)throw new Error("Invalid number in diff_fromDelta: "+_);var M=h.substring(E,E+=T);w[C].charAt(0)=="="?b[y++]=new u.Diff(k,M):b[y++]=new u.Diff(g,M);break;default:if(w[C])throw new Error("Invalid diff operation in diff_fromDelta: "+w[C])}}if(E!=h.length)throw new Error("Delta length ("+E+") does not equal source text length ("+h.length+").");return b},u.prototype.match_main=function(h,f,b){if(h==null||f==null||b==null)throw new Error("Null input. (match_main)");return b=Math.max(0,Math.min(b,h.length)),h==f?0:h.length?h.substring(b,b+f.length)==f?b:this.match_bitap_(h,f,b):-1},u.prototype.match_bitap_=function(h,f,b){if(f.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var y=this.match_alphabet_(f),E=this;function w(Pe,Ue){var Te=Pe/f.length,Le=Math.abs(b-Ue);return E.Match_Distance?Te+Le/E.Match_Distance:Le?1:Te}var C=this.Match_Threshold,_=h.indexOf(f,b);_!=-1&&(C=Math.min(w(0,_),C),_=h.lastIndexOf(f,b+f.length),_!=-1&&(C=Math.min(w(0,_),C)));var T=1<<f.length-1;_=-1;for(var M,v,D=f.length+h.length,N,V=0;V<f.length;V++){for(M=0,v=D;M<v;)w(V,b+v)<=C?M=v:D=v,v=Math.floor((D-M)/2+M);D=v;var H=Math.max(1,b-v+1),$=Math.min(b+v,h.length)+f.length,z=Array($+2);z[$+1]=(1<<V)-1;for(var F=$;F>=H;F--){var le=y[h.charAt(F-1)];if(V===0?z[F]=(z[F+1]<<1|1)&le:z[F]=(z[F+1]<<1|1)&le|((N[F+1]|N[F])<<1|1)|N[F+1],z[F]&T){var de=w(V,F-1);if(de<=C)if(C=de,_=F-1,_>b)H=Math.max(1,2*b-_);else break}}if(w(V+1,b)>C)break;N=z}return _},u.prototype.match_alphabet_=function(h){for(var f={},b=0;b<h.length;b++)f[h.charAt(b)]=0;for(var b=0;b<h.length;b++)f[h.charAt(b)]|=1<<h.length-b-1;return f},u.prototype.patch_addContext_=function(h,f){if(f.length!=0){if(h.start2===null)throw Error("patch not initialized");for(var b=f.substring(h.start2,h.start2+h.length1),y=0;f.indexOf(b)!=f.lastIndexOf(b)&&b.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)y+=this.Patch_Margin,b=f.substring(h.start2-y,h.start2+h.length1+y);y+=this.Patch_Margin;var E=f.substring(h.start2-y,h.start2);E&&h.diffs.unshift(new u.Diff(k,E));var w=f.substring(h.start2+h.length1,h.start2+h.length1+y);w&&h.diffs.push(new u.Diff(k,w)),h.start1-=E.length,h.start2-=E.length,h.length1+=E.length+w.length,h.length2+=E.length+w.length}},u.prototype.patch_make=function(h,f,b){var y,E;if(typeof h=="string"&&typeof f=="string"&&typeof b>"u")y=h,E=this.diff_main(y,f,!0),E.length>2&&(this.diff_cleanupSemantic(E),this.diff_cleanupEfficiency(E));else if(h&&typeof h=="object"&&typeof f>"u"&&typeof b>"u")E=h,y=this.diff_text1(E);else if(typeof h=="string"&&f&&typeof f=="object"&&typeof b>"u")y=h,E=f;else if(typeof h=="string"&&typeof f=="string"&&b&&typeof b=="object")y=h,E=b;else throw new Error("Unknown call format to patch_make.");if(E.length===0)return[];for(var w=[],C=new u.patch_obj,_=0,T=0,M=0,v=y,D=y,N=0;N<E.length;N++){var V=E[N][0],H=E[N][1];switch(!_&&V!==k&&(C.start1=T,C.start2=M),V){case S:C.diffs[_++]=E[N],C.length2+=H.length,D=D.substring(0,M)+H+D.substring(M);break;case g:C.length1+=H.length,C.diffs[_++]=E[N],D=D.substring(0,M)+D.substring(M+H.length);break;case k:H.length<=2*this.Patch_Margin&&_&&E.length!=N+1?(C.diffs[_++]=E[N],C.length1+=H.length,C.length2+=H.length):H.length>=2*this.Patch_Margin&&_&&(this.patch_addContext_(C,v),w.push(C),C=new u.patch_obj,_=0,v=D,T=M);break}V!==S&&(T+=H.length),V!==g&&(M+=H.length)}return _&&(this.patch_addContext_(C,v),w.push(C)),w},u.prototype.patch_deepCopy=function(h){for(var f=[],b=0;b<h.length;b++){var y=h[b],E=new u.patch_obj;E.diffs=[];for(var w=0;w<y.diffs.length;w++)E.diffs[w]=new u.Diff(y.diffs[w][0],y.diffs[w][1]);E.start1=y.start1,E.start2=y.start2,E.length1=y.length1,E.length2=y.length2,f[b]=E}return f},u.prototype.patch_apply=function(h,f){if(h.length==0)return[f,[]];h=this.patch_deepCopy(h);var b=this.patch_addPadding(h);f=b+f+b,this.patch_splitMax(h);for(var y=0,E=[],w=0;w<h.length;w++){var C=h[w].start2+y,_=this.diff_text1(h[w].diffs),T,M=-1;if(_.length>this.Match_MaxBits?(T=this.match_main(f,_.substring(0,this.Match_MaxBits),C),T!=-1&&(M=this.match_main(f,_.substring(_.length-this.Match_MaxBits),C+_.length-this.Match_MaxBits),(M==-1||T>=M)&&(T=-1))):T=this.match_main(f,_,C),T==-1)E[w]=!1,y-=h[w].length2-h[w].length1;else{E[w]=!0,y=T-C;var v;if(M==-1?v=f.substring(T,T+_.length):v=f.substring(T,M+this.Match_MaxBits),_==v)f=f.substring(0,T)+this.diff_text2(h[w].diffs)+f.substring(T+_.length);else{var D=this.diff_main(_,v,!1);if(_.length>this.Match_MaxBits&&this.diff_levenshtein(D)/_.length>this.Patch_DeleteThreshold)E[w]=!1;else{this.diff_cleanupSemanticLossless(D);for(var N=0,V,H=0;H<h[w].diffs.length;H++){var $=h[w].diffs[H];$[0]!==k&&(V=this.diff_xIndex(D,N)),$[0]===S?f=f.substring(0,T+V)+$[1]+f.substring(T+V):$[0]===g&&(f=f.substring(0,T+V)+f.substring(T+this.diff_xIndex(D,N+$[1].length))),$[0]!==g&&(N+=$[1].length)}}}}}return f=f.substring(b.length,f.length-b.length),[f,E]},u.prototype.patch_addPadding=function(h){for(var f=this.Patch_Margin,b="",y=1;y<=f;y++)b+=String.fromCharCode(y);for(var y=0;y<h.length;y++)h[y].start1+=f,h[y].start2+=f;var E=h[0],w=E.diffs;if(w.length==0||w[0][0]!=k)w.unshift(new u.Diff(k,b)),E.start1-=f,E.start2-=f,E.length1+=f,E.length2+=f;else if(f>w[0][1].length){var C=f-w[0][1].length;w[0][1]=b.substring(w[0][1].length)+w[0][1],E.start1-=C,E.start2-=C,E.length1+=C,E.length2+=C}if(E=h[h.length-1],w=E.diffs,w.length==0||w[w.length-1][0]!=k)w.push(new u.Diff(k,b)),E.length1+=f,E.length2+=f;else if(f>w[w.length-1][1].length){var C=f-w[w.length-1][1].length;w[w.length-1][1]+=b.substring(0,C),E.length1+=C,E.length2+=C}return b},u.prototype.patch_splitMax=function(h){for(var f=this.Match_MaxBits,b=0;b<h.length;b++)if(!(h[b].length1<=f)){var y=h[b];h.splice(b--,1);for(var E=y.start1,w=y.start2,C="";y.diffs.length!==0;){var _=new u.patch_obj,T=!0;for(_.start1=E-C.length,_.start2=w-C.length,C!==""&&(_.length1=_.length2=C.length,_.diffs.push(new u.Diff(k,C)));y.diffs.length!==0&&_.length1<f-this.Patch_Margin;){var M=y.diffs[0][0],v=y.diffs[0][1];M===S?(_.length2+=v.length,w+=v.length,_.diffs.push(y.diffs.shift()),T=!1):M===g&&_.diffs.length==1&&_.diffs[0][0]==k&&v.length>2*f?(_.length1+=v.length,E+=v.length,T=!1,_.diffs.push(new u.Diff(M,v)),y.diffs.shift()):(v=v.substring(0,f-_.length1-this.Patch_Margin),_.length1+=v.length,E+=v.length,M===k?(_.length2+=v.length,w+=v.length):T=!1,_.diffs.push(new u.Diff(M,v)),v==y.diffs[0][1]?y.diffs.shift():y.diffs[0][1]=y.diffs[0][1].substring(v.length))}C=this.diff_text2(_.diffs),C=C.substring(C.length-this.Patch_Margin);var D=this.diff_text1(y.diffs).substring(0,this.Patch_Margin);D!==""&&(_.length1+=D.length,_.length2+=D.length,_.diffs.length!==0&&_.diffs[_.diffs.length-1][0]===k?_.diffs[_.diffs.length-1][1]+=D:_.diffs.push(new u.Diff(k,D))),T||h.splice(++b,0,_)}}},u.prototype.patch_toText=function(h){for(var f=[],b=0;b<h.length;b++)f[b]=h[b];return f.join("")},u.prototype.patch_fromText=function(h){var f=[];if(!h)return f;for(var b=h.split(`
`),y=0,E=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;y<b.length;){var w=b[y].match(E);if(!w)throw new Error("Invalid patch string: "+b[y]);var C=new u.patch_obj;for(f.push(C),C.start1=parseInt(w[1],10),w[2]===""?(C.start1--,C.length1=1):w[2]=="0"?C.length1=0:(C.start1--,C.length1=parseInt(w[2],10)),C.start2=parseInt(w[3],10),w[4]===""?(C.start2--,C.length2=1):w[4]=="0"?C.length2=0:(C.start2--,C.length2=parseInt(w[4],10)),y++;y<b.length;){var _=b[y].charAt(0);try{var T=decodeURI(b[y].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+T)}if(_=="-")C.diffs.push(new u.Diff(g,T));else if(_=="+")C.diffs.push(new u.Diff(S,T));else if(_==" ")C.diffs.push(new u.Diff(k,T));else{if(_=="@")break;if(_!=="")throw new Error('Invalid patch mode "'+_+'" in: '+T)}y++}}return f},u.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},u.patch_obj.prototype.toString=function(){var h,f;this.length1===0?h=this.start1+",0":this.length1==1?h=this.start1+1:h=this.start1+1+","+this.length1,this.length2===0?f=this.start2+",0":this.length2==1?f=this.start2+1:f=this.start2+1+","+this.length2;for(var b=["@@ -"+h+" +"+f+` @@
`],y,E=0;E<this.diffs.length;E++){switch(this.diffs[E][0]){case S:y="+";break;case g:y="-";break;case k:y=" ";break}b[E+1]=y+encodeURI(this.diffs[E][1])+`
`}return b.join("").replace(/%20/g," ")},m.exports=u,m.exports.diff_match_patch=u,m.exports.DIFF_DELETE=g,m.exports.DIFF_INSERT=S,m.exports.DIFF_EQUAL=k},923:(m,u,g)=>{g.d(u,{default:()=>Ge});var S=g(288),k=g(59),h=g(784),f=g(51),b=g(500),y=g(339),E=g(108),w=function(Z){Z===void 0&&(Z=document);var ke=function(se){var ee=document.createElement("img");ee.src=se.getAttribute("data-src"),ee.addEventListener("load",function(){!se.getAttribute("style")&&!se.getAttribute("class")&&!se.getAttribute("width")&&!se.getAttribute("height")&&ee.naturalHeight>ee.naturalWidth&&ee.naturalWidth/ee.naturalHeight<document.querySelector(".vditor-reset").clientWidth/(window.innerHeight-40)&&ee.naturalHeight>window.innerHeight-40&&(se.style.height=window.innerHeight-40+"px"),se.src=ee.src}),se.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return Z.querySelectorAll("img").forEach(function(se){se.getAttribute("data-src")&&ke(se)}),!1;window.vditorImageIntersectionObserver?(window.vditorImageIntersectionObserver.disconnect(),Z.querySelectorAll("img").forEach(function(se){window.vditorImageIntersectionObserver.observe(se)})):(window.vditorImageIntersectionObserver=new IntersectionObserver(function(se){se.forEach(function(ee){(typeof ee.isIntersecting>"u"?ee.intersectionRatio!==0:ee.isIntersecting)&&ee.target.getAttribute("data-src")&&ke(ee.target)})}),Z.querySelectorAll("img").forEach(function(se){window.vditorImageIntersectionObserver.observe(se)}))},C=g(960),_=g(0),T=g(975),M=g(931),v=g(597),D=g(162),N=g(70),V=g(591),H=g(913),$=g(873),z=g(161),F=g(598),le=g(905),de=function(Z){document.querySelectorAll(".vditor-anchor").forEach(function(ke){Z===1&&ke.classList.add("vditor-anchor--left"),ke.onclick=function(){var se=ke.getAttribute("href").substr(1),ee=document.getElementById("vditorAnchor-"+se).offsetTop;document.querySelector("html").scrollTop=ee}}),window.onhashchange=function(){var ke=document.getElementById("vditorAnchor-"+decodeURIComponent(window.location.hash.substr(1)));ke&&(document.querySelector("html").scrollTop=ke.offsetTop)}},Pe=g(796),Ue=g(827),Te=function(Z,ke){if(ke===void 0&&(ke="zh_CN"),!(typeof speechSynthesis>"u"||typeof SpeechSynthesisUtterance>"u")){var se=function(){var Qe=speechSynthesis.getVoices(),De,nt;return Qe.forEach(function(ct){ct.lang===ke.replace("_","-")&&(De=ct),ct.default&&(nt=ct)}),De||(De=nt),De},ee='<svg><use xlink:href="#vditor-icon-play"></use></svg>',Ie='<svg><use xlink:href="#vditor-icon-pause"></use></svg>';document.getElementById("vditorIconScript")||(ee='<svg viewBox="0 0 32 32"><path d="M3.436 0l25.128 16-25.128 16v-32z"></path></svg>',Ie='<svg viewBox="0 0 32 32"><path d="M20.617 0h9.128v32h-9.128v-32zM2.255 32v-32h9.128v32h-9.128z"></path></svg>');var ye=document.querySelector(".vditor-speech");ye||(ye=document.createElement("button"),ye.className="vditor-speech",Z.insertAdjacentElement("beforeend",ye),speechSynthesis.onvoiceschanged!==void 0&&(speechSynthesis.onvoiceschanged=se));var lt=se(),Ve=new SpeechSynthesisUtterance;Ve.voice=lt,Ve.onend=Ve.onerror=function(){ye.style.display="none",speechSynthesis.cancel(),ye.classList.remove("vditor-speech--current"),ye.innerHTML=ee},Z.addEventListener(window.ontouchstart!==void 0?"touchend":"click",function(Qe){var De=Qe.target;if(De.classList.contains("vditor-speech")||De.parentElement.classList.contains("vditor-speech")){ye.classList.contains("vditor-speech--current")?speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),ye.innerHTML=Ie):(speechSynthesis.pause(),ye.innerHTML=ee)):(Ve.text=ye.getAttribute("data-text"),speechSynthesis.speak(Ve),ye.classList.add("vditor-speech--current"),ye.innerHTML=Ie),(0,Ue.jl)(window.vditorSpeechRange),Z.focus();return}if(ye.style.display="none",speechSynthesis.cancel(),ye.classList.remove("vditor-speech--current"),ye.innerHTML=ee,getSelection().rangeCount!==0){var nt=getSelection().getRangeAt(0),ct=nt.toString().trim();if(ct){window.vditorSpeechRange=nt.cloneRange();var dt=nt.getBoundingClientRect();ye.innerHTML=ee,ye.style.display="block",ye.style.top=dt.top+dt.height+document.querySelector("html").scrollTop-20+"px",window.ontouchstart!==void 0?ye.style.left=Qe.changedTouches[Qe.changedTouches.length-1].pageX+2+"px":ye.style.left=Qe.clientX+2+"px",ye.setAttribute("data-text",ct)}}})}},Le=function(Z,ke,se,ee){function Ie(ye){return ye instanceof se?ye:new se(function(lt){lt(ye)})}return new(se||(se=Promise))(function(ye,lt){function Ve(nt){try{De(ee.next(nt))}catch(ct){lt(ct)}}function Qe(nt){try{De(ee.throw(nt))}catch(ct){lt(ct)}}function De(nt){nt.done?ye(nt.value):Ie(nt.value).then(Ve,Qe)}De((ee=ee.apply(Z,ke||[])).next())})},Re=function(Z,ke){var se={label:0,sent:function(){if(ye[0]&1)throw ye[1];return ye[1]},trys:[],ops:[]},ee,Ie,ye,lt;return lt={next:Ve(0),throw:Ve(1),return:Ve(2)},typeof Symbol=="function"&&(lt[Symbol.iterator]=function(){return this}),lt;function Ve(De){return function(nt){return Qe([De,nt])}}function Qe(De){if(ee)throw new TypeError("Generator is already executing.");for(;lt&&(lt=0,De[0]&&(se=0)),se;)try{if(ee=1,Ie&&(ye=De[0]&2?Ie.return:De[0]?Ie.throw||((ye=Ie.return)&&ye.call(Ie),0):Ie.next)&&!(ye=ye.call(Ie,De[1])).done)return ye;switch(Ie=0,ye&&(De=[De[0]&2,ye.value]),De[0]){case 0:case 1:ye=De;break;case 4:return se.label++,{value:De[1],done:!1};case 5:se.label++,Ie=De[1],De=[0];continue;case 7:De=se.ops.pop(),se.trys.pop();continue;default:if(ye=se.trys,!(ye=ye.length>0&&ye[ye.length-1])&&(De[0]===6||De[0]===2)){se=0;continue}if(De[0]===3&&(!ye||De[1]>ye[0]&&De[1]<ye[3])){se.label=De[1];break}if(De[0]===6&&se.label<ye[1]){se.label=ye[1],ye=De;break}if(ye&&se.label<ye[2]){se.label=ye[2],se.ops.push(De);break}ye[2]&&se.ops.pop(),se.trys.pop();continue}De=ke.call(Z,se)}catch(nt){De=[6,nt],Ie=0}finally{ee=ye=0}if(De[0]&5)throw De[1];return{value:De[0]?De[1]:void 0,done:!0}}},Je=function(Z){var ke,se={anchor:0,cdn:H.Y.CDN,customEmoji:{},emojiPath:"".concat(H.Y.CDN,"/dist/images/emoji"),hljs:H.Y.HLJS_OPTIONS,icon:"ant",lang:"zh_CN",markdown:H.Y.MARKDOWN_OPTIONS,math:H.Y.MATH_OPTIONS,mode:"light",speech:{enable:!1},render:{media:{enable:!0}},theme:H.Y.THEME_OPTIONS};return Z.cdn&&(!((ke=Z.theme)===null||ke===void 0)&&ke.path||(se.theme.path="".concat(Z.cdn,"/dist/css/content-theme")),Z.emojiPath||(se.emojiPath="".concat(Z.cdn,"/dist/images/emoji"))),(0,le.h)(se,Z)},tt=function(Z,ke){var se=Je(ke);return(0,z.Z)("".concat(se.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){var ee=(0,Pe.X)({autoSpace:se.markdown.autoSpace,gfmAutoLink:se.markdown.gfmAutoLink,codeBlockPreview:se.markdown.codeBlockPreview,emojiSite:se.emojiPath,emojis:se.customEmoji,fixTermTypo:se.markdown.fixTermTypo,footnotes:se.markdown.footnotes,headingAnchor:se.anchor!==0,inlineMathDigit:se.math.inlineDigit,lazyLoadImage:se.lazyLoadImage,linkBase:se.markdown.linkBase,linkPrefix:se.markdown.linkPrefix,listStyle:se.markdown.listStyle,mark:se.markdown.mark,mathBlockPreview:se.markdown.mathBlockPreview,paragraphBeginningSpace:se.markdown.paragraphBeginningSpace,sanitize:se.markdown.sanitize,toc:se.markdown.toc});return ke!=null&&ke.renderers&&ee.SetJSRenderers({renderers:{Md2HTML:ke.renderers}}),ee.SetHeadingID(!0),ee.Md2HTML(Z)})},U=function(Z,ke,se){return Le(void 0,void 0,void 0,function(){var ee,Ie,ye,lt;return Re(this,function(Ve){switch(Ve.label){case 0:return ee=Je(se),[4,tt(ke,ee)];case 1:if(Ie=Ve.sent(),ee.transform&&(Ie=ee.transform(Ie)),Z.innerHTML=Ie,Z.classList.add("vditor-reset"),ee.i18n)return[3,5];if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(ee.lang))return[3,2];throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");case 2:return ye="vditorI18nScript",lt=ye+ee.lang,document.querySelectorAll('head script[id^="'.concat(ye,'"]')).forEach(function(Qe){Qe.id!==lt&&document.head.removeChild(Qe)}),[4,(0,z.Z)("".concat(ee.cdn,"/dist/js/i18n/").concat(ee.lang,".js"),lt)];case 3:Ve.sent(),Ve.label=4;case 4:return[3,6];case 5:window.VditorI18n=ee.i18n,Ve.label=6;case 6:return ee.icon?[4,(0,z.Z)("".concat(ee.cdn,"/dist/js/icons/").concat(ee.icon,".js"),"vditorIconScript")]:[3,8];case 7:Ve.sent(),Ve.label=8;case 8:return(0,$.H)(ee.theme.current,ee.theme.path),ee.anchor===1&&Z.classList.add("vditor-reset--anchor"),(0,f.o)(Z,ee.hljs),(0,E.$)(ee.hljs,Z,ee.cdn),(0,C.T)(Z,{cdn:ee.cdn,math:ee.math}),(0,T.e)(Z,ee.cdn,ee.mode),(0,M.Y)(Z,ee.cdn,ee.mode),(0,v.K)(Z,ee.cdn),(0,b.D)(Z,ee.cdn),(0,y.m)(Z,ee.cdn),(0,h.v)(Z,ee.cdn,ee.mode),(0,D.l)(Z,ee.cdn,ee.mode),(0,V.M)(Z,ee.cdn),(0,S.$)(Z,ee.cdn),ee.render.media.enable&&(0,_.l)(Z),ee.speech.enable&&Te(Z),ee.anchor!==0&&de(ee.anchor),ee.after&&ee.after(),ee.lazyLoadImage&&w(Z),Z.addEventListener("click",function(Qe){var De=(0,F._Y)(Qe.target,"SPAN");if(De&&(0,F.KJ)(De,"vditor-toc")){var nt=Z.querySelector("#"+De.getAttribute("data-target-id"));nt&&window.scrollTo(window.scrollX,nt.offsetTop);return}}),[2]}})})},oe=g(726),re=g(13),Ae=function(){function Z(){}return Z.adapterRender=k,Z.previewImage=oe.o,Z.codeRender=f.o,Z.graphvizRender=y.m,Z.highlightRender=E.$,Z.mathRender=C.T,Z.mermaidRender=T.e,Z.SMILESRender=M.Y,Z.markmapRender=v.K,Z.flowchartRender=b.D,Z.chartRender=h.v,Z.abcRender=S.$,Z.mindmapRender=D.l,Z.plantumlRender=V.M,Z.outlineRender=N.N,Z.mediaRender=_.l,Z.speechRender=Te,Z.lazyLoadImageRender=w,Z.md2html=tt,Z.preview=U,Z.setCodeTheme=re.h,Z.setContentTheme=$.H,Z}();const Ge=Ae},913:(m,u,g)=>{g.d(u,{Y:()=>k,g:()=>S});var S="3.10.9",k=function(){function h(){}return h.ZWSP="​",h.DROP_EDITOR="application/editor",h.MOBILE_WIDTH=520,h.CLASS_MENU_DISABLED="vditor-menu--disabled",h.EDIT_TOOLBARS=["emoji","headings","bold","italic","strike","link","list","ordered-list","outdent","indent","check","line","quote","code","inline-code","insert-after","insert-before","upload","record","table"],h.CODE_THEME=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","panda-syntax-dark","paraiso-dark","pojoaque","qtcreator-dark","rainbow","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256","ant-design","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","panda-syntax-light","paraiso-light","purebasic","qtcreator-light","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],h.ALIAS_CODE_LANGUAGES=["abc","plantuml","mermaid","flowchart","echarts","mindmap","graphviz","math","markmap","smiles","js","ts","html","toml","c#","bat"],h.CDN="https://unpkg.com/vditor@".concat("3.10.9"),h.MARKDOWN_OPTIONS={autoSpace:!1,gfmAutoLink:!0,codeBlockPreview:!0,fixTermTypo:!1,footnotes:!0,linkBase:"",linkPrefix:"",listStyle:!1,mark:!1,mathBlockPreview:!0,paragraphBeginningSpace:!1,sanitize:!0,toc:!1},h.HLJS_OPTIONS={enable:!0,lineNumber:!1,defaultLang:"",style:"github"},h.MATH_OPTIONS={engine:"KaTeX",inlineDigit:!1,macros:{}},h.THEME_OPTIONS={current:"light",list:{"ant-design":"Ant Design",dark:"Dark",light:"Light",wechat:"WeChat"},path:"".concat(h.CDN,"/dist/css/content-theme")},h}()},931:(m,u,g)=>{g.d(u,{Y:()=>b});var S=g(913),k=g(161),h=g(59),f=g(933),b=function(y,E,w){y===void 0&&(y=document),E===void 0&&(E=S.Y.CDN);var C=h.SMILESRenderAdapter.getElements(y);C.length>0&&(0,k.Z)("".concat(E,"/dist/js/smiles-drawer/smiles-drawer.min.js?v=2.1.7"),"vditorAbcjsScript").then(function(){var _=new SmiDrawer({},{});C.forEach(function(T){var M=h.SMILESRenderAdapter.getCode(T).trim();if(!(T.getAttribute("data-processed")==="true"||M.trim()==="")){var v="smiles"+(0,f.Ee)();T.innerHTML='<svg id="'.concat(v,'"></svg>'),_.draw(M,"#"+v,w==="dark"?"dark":void 0),T.setAttribute("data-processed","true")}})})}},288:(m,u,g)=>{g.d(u,{$:()=>f});var S=g(913),k=g(161),h=g(59),f=function(b,y){b===void 0&&(b=document),y===void 0&&(y=S.Y.CDN);var E=h.abcRenderAdapter.getElements(b);E.length>0&&(0,k.Z)("".concat(y,"/dist/js/abcjs/abcjs_basic.min.js"),"vditorAbcjsScript").then(function(){E.forEach(function(w){w.parentElement.classList.contains("vditor-wysiwyg__pre")||w.parentElement.classList.contains("vditor-ir__marker--pre")||w.getAttribute("data-processed")!=="true"&&(ABCJS.renderAbc(w,h.abcRenderAdapter.getCode(w).trim()),w.style.overflowX="auto",w.setAttribute("data-processed","true"))})})}},59:(m,u,g)=>{g.r(u),g.d(u,{SMILESRenderAdapter:()=>k,abcRenderAdapter:()=>E,chartRenderAdapter:()=>y,flowchartRenderAdapter:()=>C,graphvizRenderAdapter:()=>w,markmapRenderAdapter:()=>f,mathRenderAdapter:()=>S,mermaidRenderAdapter:()=>h,mindmapRenderAdapter:()=>b,plantumlRenderAdapter:()=>_});var S={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-math")}},k={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-smiles")}},h={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-mermaid")}},f={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-markmap")}},b={getCode:function(T){return T.getAttribute("data-code")},getElements:function(T){return T.querySelectorAll(".language-mindmap")}},y={getCode:function(T){return T.innerText},getElements:function(T){return T.querySelectorAll(".language-echarts")}},E={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-abc")}},w={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-graphviz")}},C={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-flowchart")}},_={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-plantuml")}}},784:(m,u,g)=>{g.d(u,{v:()=>E});var S=g(913),k=g(161),h=g(59),f=g(933),b=function(w,C,_,T){function M(v){return v instanceof _?v:new _(function(D){D(v)})}return new(_||(_=Promise))(function(v,D){function N($){try{H(T.next($))}catch(z){D(z)}}function V($){try{H(T.throw($))}catch(z){D(z)}}function H($){$.done?v($.value):M($.value).then(N,V)}H((T=T.apply(w,C||[])).next())})},y=function(w,C){var _={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},T,M,v,D;return D={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function N(H){return function($){return V([H,$])}}function V(H){if(T)throw new TypeError("Generator is already executing.");for(;D&&(D=0,H[0]&&(_=0)),_;)try{if(T=1,M&&(v=H[0]&2?M.return:H[0]?M.throw||((v=M.return)&&v.call(M),0):M.next)&&!(v=v.call(M,H[1])).done)return v;switch(M=0,v&&(H=[H[0]&2,v.value]),H[0]){case 0:case 1:v=H;break;case 4:return _.label++,{value:H[1],done:!1};case 5:_.label++,M=H[1],H=[0];continue;case 7:H=_.ops.pop(),_.trys.pop();continue;default:if(v=_.trys,!(v=v.length>0&&v[v.length-1])&&(H[0]===6||H[0]===2)){_=0;continue}if(H[0]===3&&(!v||H[1]>v[0]&&H[1]<v[3])){_.label=H[1];break}if(H[0]===6&&_.label<v[1]){_.label=v[1],v=H;break}if(v&&_.label<v[2]){_.label=v[2],_.ops.push(H);break}v[2]&&_.ops.pop(),_.trys.pop();continue}H=C.call(w,_)}catch($){H=[6,$],M=0}finally{T=v=0}if(H[0]&5)throw H[1];return{value:H[0]?H[1]:void 0,done:!0}}},E=function(w,C,_){w===void 0&&(w=document),C===void 0&&(C=S.Y.CDN);var T=h.chartRenderAdapter.getElements(w);T.length>0&&(0,k.Z)("".concat(C,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){T.forEach(function(M){return b(void 0,void 0,void 0,function(){var v,D,N;return y(this,function(V){switch(V.label){case 0:if(M.parentElement.classList.contains("vditor-wysiwyg__pre")||M.parentElement.classList.contains("vditor-ir__marker--pre"))return[2];if(v=h.chartRenderAdapter.getCode(M).trim(),!v)return[2];V.label=1;case 1:return V.trys.push([1,3,,4]),M.getAttribute("data-processed")==="true"?[2]:[4,(0,f.kY)(v)];case 2:return D=V.sent(),echarts.init(M,_==="dark"?"dark":void 0).setOption(D),M.setAttribute("data-processed","true"),[3,4];case 3:return N=V.sent(),M.className="vditor-reset--error",M.innerHTML="echarts render error: <br>".concat(N),[3,4];case 4:return[2]}})})})})}},51:(m,u,g)=>{g.d(u,{o:()=>h});var S=g(695),k=g(913),h=function(f,b){Array.from(f.querySelectorAll("pre > code")).filter(function(y,E){return!(y.parentElement.classList.contains("vditor-wysiwyg__pre")||y.parentElement.classList.contains("vditor-ir__marker--pre")||y.classList.contains("language-mermaid")||y.classList.contains("language-flowchart")||y.classList.contains("language-echarts")||y.classList.contains("language-mindmap")||y.classList.contains("language-plantuml")||y.classList.contains("language-markmap")||y.classList.contains("language-abc")||y.classList.contains("language-graphviz")||y.classList.contains("language-math")||y.classList.contains("language-smiles")||y.style.maxHeight.indexOf("px")>-1||f.classList.contains("vditor-preview")&&E>5)}).forEach(function(y){var E,w,C,_=y.innerText;if(y.classList.contains("highlight-chroma")){var T=y.cloneNode(!0);T.querySelectorAll(".highlight-ln").forEach(function(N){N.remove()}),_=T.innerText}else _.endsWith(`
`)&&(_=_.substr(0,_.length-1));var M='<svg><use xlink:href="#vditor-icon-copy"></use></svg>';document.getElementById("vditorIconScript")||(M='<svg viewBox="0 0 32 32"><path d="M22.545-0h-17.455c-1.6 0-2.909 1.309-2.909 2.909v20.364h2.909v-20.364h17.455v-2.909zM26.909 5.818h-16c-1.6 0-2.909 1.309-2.909 2.909v20.364c0 1.6 1.309 2.909 2.909 2.909h16c1.6 0 2.909-1.309 2.909-2.909v-20.364c0-1.6-1.309-2.909-2.909-2.909zM26.909 29.091h-16v-20.364h16v20.364z"></path></svg>');var v=document.createElement("div");v.className="vditor-copy",v.innerHTML='<span aria-label="'.concat(((E=window.VditorI18n)===null||E===void 0?void 0:E.copy)||"复制",`"
onmouseover="this.setAttribute('aria-label', '`).concat(((w=window.VditorI18n)===null||w===void 0?void 0:w.copy)||"复制",`')"
class="vditor-tooltipped vditor-tooltipped__w"
onclick="this.previousElementSibling.select();document.execCommand('copy');this.setAttribute('aria-label', '`).concat(((C=window.VditorI18n)===null||C===void 0?void 0:C.copied)||"已复制",`');this.previousElementSibling.blur()">`).concat(M,"</span>");var D=document.createElement("textarea");D.value=(0,S.p)(_),v.insertAdjacentElement("afterbegin",D),b&&b.renderMenu&&b.renderMenu(y,v),y.before(v),y.style.maxHeight=window.outerHeight-40+"px",y.insertAdjacentHTML("afterend",'<span style="position: absolute">'.concat(k.Y.ZWSP,"</span>"))})}},500:(m,u,g)=>{g.d(u,{D:()=>f});var S=g(913),k=g(161),h=g(59),f=function(b,y){y===void 0&&(y=S.Y.CDN);var E=h.flowchartRenderAdapter.getElements(b);E.length!==0&&(0,k.Z)("".concat(y,"/dist/js/flowchart.js/flowchart.min.js"),"vditorFlowchartScript").then(function(){E.forEach(function(w){if(w.getAttribute("data-processed")!=="true"){var C=flowchart.parse(h.flowchartRenderAdapter.getCode(w));w.innerHTML="",C.drawSVG(w),w.setAttribute("data-processed","true")}})})}},339:(m,u,g)=>{g.d(u,{m:()=>f});var S=g(913),k=g(161),h=g(59),f=function(b,y){y===void 0&&(y=S.Y.CDN);var E=h.graphvizRenderAdapter.getElements(b);E.length!==0&&(0,k.Z)("".concat(y,"/dist/js/graphviz/viz.js"),"vditorGraphVizScript").then(function(){E.forEach(function(w){var C=h.graphvizRenderAdapter.getCode(w);if(!(w.parentElement.classList.contains("vditor-wysiwyg__pre")||w.parentElement.classList.contains("vditor-ir__marker--pre"))&&!(w.getAttribute("data-processed")==="true"||C.trim()==="")){try{var _=new Blob(["importScripts('".concat(document.getElementById("vditorGraphVizScript").src.replace("viz.js","full.render.js"),"');")],{type:"application/javascript"}),T=window.URL||window.webkitURL,M=T.createObjectURL(_),v=new Worker(M);new Viz({worker:v}).renderSVGElement(C).then(function(D){w.innerHTML=D.outerHTML}).catch(function(D){w.innerHTML="graphviz render error: <br>".concat(D),w.className="vditor-reset--error"})}catch(D){console.error("graphviz error",D)}w.setAttribute("data-processed","true")}})})}},108:(m,u,g)=>{g.d(u,{$:()=>f});var S=g(913),k=g(161),h=g(505),f=function(b,y,E){y===void 0&&(y=document),E===void 0&&(E=S.Y.CDN);var w=b.style;S.Y.CODE_THEME.includes(w)||(w="github");var C=document.getElementById("vditorHljsStyle"),_="".concat(E,"/dist/js/highlight.js/styles/").concat(w,".min.css");if(C&&C.getAttribute("href")!==_&&C.remove(),(0,h.T)("".concat(E,"/dist/js/highlight.js/styles/").concat(w,".min.css"),"vditorHljsStyle"),b.enable!==!1){var T=y.querySelectorAll("pre > code");T.length!==0&&(0,k.Z)("".concat(E,"/dist/js/highlight.js/highlight.min.js?v=11.7.0"),"vditorHljsScript").then(function(){(0,k.Z)("".concat(E,"/dist/js/highlight.js/third-languages.js?v=1.0.1"),"vditorHljsThirdScript").then(function(){y.querySelectorAll("pre > code").forEach(function(M){if(!(M.parentElement.classList.contains("vditor-ir__marker--pre")||M.parentElement.classList.contains("vditor-wysiwyg__pre"))&&!(M.classList.contains("language-mermaid")||M.classList.contains("language-flowchart")||M.classList.contains("language-echarts")||M.classList.contains("language-mindmap")||M.classList.contains("language-plantuml")||M.classList.contains("language-smiles")||M.classList.contains("language-abc")||M.classList.contains("language-graphviz")||M.classList.contains("language-math"))){b.defaultLang!==""&&M.className.indexOf("language-")===-1&&M.classList.add("language-"+b.defaultLang);var v=M.className.replace("language-","");if(window.hljs.getLanguage(v)||(v="plaintext"),M.innerHTML=window.hljs.highlight(M.textContent,{language:v,ignoreIllegals:!0}).value,M.classList.add("hljs"),!!b.lineNumber){M.classList.add("vditor-linenumber");var D=M.querySelector(".vditor-linenumber__temp");D||(D=document.createElement("div"),D.className="vditor-linenumber__temp",M.insertAdjacentElement("beforeend",D));var N=getComputedStyle(M).whiteSpace,V=!1;(N==="pre-wrap"||N==="pre-line")&&(V=!0);var H="",$=M.textContent.split(/\r\n|\r|\n/g);$.pop(),$.map(function(z){var F="";V&&(D.textContent=z||`
`,F=' style="height:'.concat(D.getBoundingClientRect().height,'px"')),H+="<span".concat(F,"></span>")}),D.style.display="none",H='<span class="vditor-linenumber__rows">'.concat(H,"</span>"),M.insertAdjacentHTML("beforeend",H)}}})})})}}},597:(m,u,g)=>{g.d(u,{K:()=>E});var S=g(913),k=g(161),h=g(59),f={},b=function(w,C){var _=w.transform(C),T=Object.keys(_.features).filter(function(V){return!f[V]});T.forEach(function(V){f[V]=!0});var M=w.getAssets(T),v=M.styles,D=M.scripts,N=window.markmap;return v&&N.loadCSS(v),D&&N.loadJS(D),_},y=function(w,C){var _=window.markmap,T=_.Transformer,M=_.Markmap,v=_.deriveOptions;_.globalCSS;var D=new T;w.innerHTML='<svg style="width:100%"></svg>';var N=w.firstChild,V=M.create(N,null),H=b(D,C),$=H.root,z=H.frontmatter,F=z==null?void 0:z.markmap,le=v(F);V.setData($,le),V.fit()},E=function(w,C){w===void 0&&(w=document),C===void 0&&(C=S.Y.CDN);var _=h.markmapRenderAdapter.getElements(w);_.length!==0&&(0,k.Z)("".concat(C,"/dist/js/markmap/markmap.min.js"),"vditorMarkerScript").then(function(){_.forEach(function(T){var M=h.markmapRenderAdapter.getCode(T);if(!(T.getAttribute("data-processed")==="true"||M.trim()==="")){var v=document.createElement("div");v.className="language-markmap",T.parentNode.appendChild(v),y(v,M),T.parentNode.childNodes[0].nodeName=="CODE"&&T.parentNode.removeChild(T.parentNode.childNodes[0])}})})}},960:(m,u,g)=>{g.d(u,{T:()=>y});var S=g(913),k=g(161),h=g(505),f=g(695),b=g(59),y=function(E,w){E===void 0&&(E=document);var C=b.mathRenderAdapter.getElements(E);if(C.length!==0){var _={cdn:S.Y.CDN,math:{engine:"KaTeX",inlineDigit:!1,macros:{}}};if(w&&w.math&&(w.math=Object.assign({},_.math,w.math)),w=Object.assign({},_,w),w.math.engine==="KaTeX")(0,h.T)("".concat(w.cdn,"/dist/js/katex/katex.min.css?v=0.16.9"),"vditorKatexStyle"),(0,k.Z)("".concat(w.cdn,"/dist/js/katex/katex.min.js?v=0.16.9"),"vditorKatexScript").then(function(){(0,k.Z)("".concat(w.cdn,"/dist/js/katex/mhchem.min.js?v=0.16.9"),"vditorKatexChemScript").then(function(){C.forEach(function(v){if(!(v.parentElement.classList.contains("vditor-wysiwyg__pre")||v.parentElement.classList.contains("vditor-ir__marker--pre"))&&!v.getAttribute("data-math")){var D=(0,f.p)(b.mathRenderAdapter.getCode(v));v.setAttribute("data-math",D);try{v.innerHTML=katex.renderToString(D,{displayMode:v.tagName==="DIV",output:"html",macros:w.math.macros})}catch(N){v.innerHTML=N.message,v.className="language-math vditor-reset--error"}v.addEventListener("copy",function(N){N.stopPropagation(),N.preventDefault();var V=N.currentTarget.closest(".language-math");N.clipboardData.setData("text/html",V.innerHTML),N.clipboardData.setData("text/plain",V.getAttribute("data-math"))})}})})});else if(w.math.engine==="MathJax"){var T=function(v){if(v.length!==0){var D=0,N=v[v.length-1],V=function(){var H=v[D++];H===N?H():H(V)};V()}};window.MathJax||(window.MathJax={loader:{paths:{mathjax:"".concat(w.cdn,"/dist/js/mathjax")}},startup:{typeset:!1},tex:{macros:w.math.macros}},Object.assign(window.MathJax,w.math.mathJaxOptions)),(0,k.U)("".concat(w.cdn,"/dist/js/mathjax/tex-svg-full.js"),"protyleMathJaxScript");var M=function(v,D){var N=(0,f.p)(v.textContent).trim(),V=window.MathJax.getMetricsFor(v);V.display=v.tagName==="DIV",window.MathJax.tex2svgPromise(N,V).then(function(H){v.innerHTML="",v.setAttribute("data-math",N),v.append(H),window.MathJax.startup.document.clear(),window.MathJax.startup.document.updateDocument();var $=H.querySelector('[data-mml-node="merror"]');$&&$.textContent.trim()!==""&&(v.innerHTML=$.textContent.trim(),v.className="vditor-reset--error"),D&&D()})};window.MathJax.startup.promise.then(function(){for(var v=[],D=function(V){var H=C[V];!H.parentElement.classList.contains("vditor-wysiwyg__pre")&&!H.parentElement.classList.contains("vditor-ir__marker--pre")&&!H.getAttribute("data-math")&&(0,f.p)(H.textContent).trim()&&v.push(function($){V===C.length-1?M(H):M(H,$)})},N=0;N<C.length;N++)D(N);T(v)})}}}},0:(m,u,g)=>{g.d(u,{l:()=>b});var S=g(933),k=function(y,E){y.insertAdjacentHTML("afterend",'<video controls="controls" src="'.concat(E,'"></video>')),y.remove()},h=function(y,E){y.insertAdjacentHTML("afterend",'<audio controls="controls" src="'.concat(E,'"></audio>')),y.remove()},f=function(y,E){var w=E.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),C=E.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),_=E.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),T=E.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),M=E.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),v=E.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),D=E.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),N=E.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/);if(w&&w[1].length===11)y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//www.youtube.com/embed/'.concat(w[1]+(w[2]?"?start="+w[2]:""),'"></iframe>')),y.remove();else if(C&&C[1])y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//player.youku.com/embed/'.concat(C[1],'"></iframe>')),y.remove();else if(_&&_[1])y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="https://v.qq.com/txp/iframe/player.html?vid='.concat(_[1],'"></iframe>')),y.remove();else if(T&&T[1])y.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="//coub.com/embed/`.concat(T[1],'?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>')),y.remove();else if(M&&M[0])y.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.facebook.com/plugins/video.php?href=`.concat(encodeURIComponent(M[0]),'"></iframe>')),y.remove();else if(v&&v[2])y.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.dailymotion.com/embed/video/`.concat(v[2],'"></iframe>')),y.remove();else if(E.indexOf("bilibili.com")>-1&&(E.indexOf("bvid=")>-1||D&&D[1])){var V={bvid:(0,S.TK)("bvid",E)||D&&D[1],page:"1",high_quality:"1",as_wide:"1",allowfullscreen:"true",autoplay:"0"};new URL(E.startsWith("http")?E:"https:"+E).search.split("&").forEach(function(z,F){if(z){F===0&&(z=z.substr(1));var le=z.split("=");V[le[0]]=le[1]}});var H="https://player.bilibili.com/player.html?",$=Object.keys(V);$.forEach(function(z,F){H+="".concat(z,"=").concat(V[z]),F<$.length-1&&(H+="&")}),y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="'.concat(H,'"></iframe>')),y.remove()}else N&&N[1]&&(y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//embed.ted.com/talks/'.concat(N[1],'"></iframe>')),y.remove())},b=function(y){y&&y.querySelectorAll("a").forEach(function(E){var w=E.getAttribute("href");w&&(w.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?k(E,w):w.match(/^.+.(mp3|wav|flac)$/)?h(E,w):f(E,w))})}},975:(m,u,g)=>{g.d(u,{e:()=>E});var S=g(913),k=g(161),h=g(59),f=g(933),b=function(w,C,_,T){function M(v){return v instanceof _?v:new _(function(D){D(v)})}return new(_||(_=Promise))(function(v,D){function N($){try{H(T.next($))}catch(z){D(z)}}function V($){try{H(T.throw($))}catch(z){D(z)}}function H($){$.done?v($.value):M($.value).then(N,V)}H((T=T.apply(w,C||[])).next())})},y=function(w,C){var _={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},T,M,v,D;return D={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function N(H){return function($){return V([H,$])}}function V(H){if(T)throw new TypeError("Generator is already executing.");for(;D&&(D=0,H[0]&&(_=0)),_;)try{if(T=1,M&&(v=H[0]&2?M.return:H[0]?M.throw||((v=M.return)&&v.call(M),0):M.next)&&!(v=v.call(M,H[1])).done)return v;switch(M=0,v&&(H=[H[0]&2,v.value]),H[0]){case 0:case 1:v=H;break;case 4:return _.label++,{value:H[1],done:!1};case 5:_.label++,M=H[1],H=[0];continue;case 7:H=_.ops.pop(),_.trys.pop();continue;default:if(v=_.trys,!(v=v.length>0&&v[v.length-1])&&(H[0]===6||H[0]===2)){_=0;continue}if(H[0]===3&&(!v||H[1]>v[0]&&H[1]<v[3])){_.label=H[1];break}if(H[0]===6&&_.label<v[1]){_.label=v[1],v=H;break}if(v&&_.label<v[2]){_.label=v[2],_.ops.push(H);break}v[2]&&_.ops.pop(),_.trys.pop();continue}H=C.call(w,_)}catch($){H=[6,$],M=0}finally{T=v=0}if(H[0]&5)throw H[1];return{value:H[0]?H[1]:void 0,done:!0}}},E=function(w,C,_){w===void 0&&(w=document),C===void 0&&(C=S.Y.CDN);var T=h.mermaidRenderAdapter.getElements(w);T.length!==0&&(0,k.Z)("".concat(C,"/dist/js/mermaid/mermaid.min.js"),"vditorMermaidScript").then(function(){var M={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8,showSequenceNumbers:!0},gantt:{leftPadding:75,rightPadding:20}};_==="dark"&&(M.theme="dark"),mermaid.initialize(M),T.forEach(function(v){return b(void 0,void 0,void 0,function(){var D,N,V,H,$;return y(this,function(z){switch(z.label){case 0:if(D=h.mermaidRenderAdapter.getCode(v),v.getAttribute("data-processed")==="true"||D.trim()==="")return[2];N="mermaid"+(0,f.Ee)(),z.label=1;case 1:return z.trys.push([1,3,,4]),[4,mermaid.render(N,v.textContent)];case 2:return V=z.sent(),v.innerHTML=V.svg,[3,4];case 3:return H=z.sent(),$=document.querySelector("#"+N),v.innerHTML="".concat($.outerHTML,`<br>
<div style="text-align: left"><small>`).concat(H.message.replace(/\n/,"<br>"),"</small></div>"),$.parentElement.remove(),[3,4];case 4:return v.setAttribute("data-processed","true"),[2]}})})})})}},162:(m,u,g)=>{g.d(u,{l:()=>f});var S=g(913),k=g(161),h=g(59),f=function(b,y,E){b===void 0&&(b=document),y===void 0&&(y=S.Y.CDN);var w=h.mindmapRenderAdapter.getElements(b);w.length>0&&(0,k.Z)("".concat(y,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){w.forEach(function(C){if(!(C.parentElement.classList.contains("vditor-wysiwyg__pre")||C.parentElement.classList.contains("vditor-ir__marker--pre"))){var _=h.mindmapRenderAdapter.getCode(C);if(_)try{if(C.getAttribute("data-processed")==="true")return;echarts.init(C,E==="dark"?"dark":void 0).setOption({series:[{data:[JSON.parse(decodeURIComponent(_))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:function(T,M){var v;return!((v=M==null?void 0:M.data)===null||v===void 0)&&v.children?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"}}),C.setAttribute("data-processed","true")}catch(T){C.className="vditor-reset--error",C.innerHTML="mindmap render error: <br>".concat(T)}}})})}},70:(m,u,g)=>{g.d(u,{N:()=>h});var S=g(164),k=g(960),h=function(f,b,y){var E="",w=[];if(Array.from(f.children).forEach(function(M,v){if((0,S.c)(M)){if(y){var D=M.id.lastIndexOf("_");M.id=M.id.substring(0,D===-1?void 0:D)+"_"+v}w.push(M.id),E+=M.outerHTML.replace("<wbr>","")}}),E==="")return b.innerHTML="","";var C=document.createElement("div");if(y)y.lute.SetToC(!0),y.currentMode==="wysiwyg"&&!y.preview.element.contains(f)?C.innerHTML=y.lute.SpinVditorDOM("<p>[ToC]</p>"+E):y.currentMode==="ir"&&!y.preview.element.contains(f)?C.innerHTML=y.lute.SpinVditorIRDOM("<p>[ToC]</p>"+E):C.innerHTML=y.lute.HTML2VditorDOM("<p>[ToC]</p>"+E),y.lute.SetToC(y.options.preview.markdown.toc);else{b.classList.add("vditor-outline");var _=Lute.New();_.SetToC(!0),C.innerHTML=_.HTML2VditorDOM("<p>[ToC]</p>"+E)}var T=C.firstElementChild.querySelectorAll("li > span[data-target-id]");return T.forEach(function(M,v){if(M.nextElementSibling&&M.nextElementSibling.tagName==="UL"){var D="<svg class='vditor-outline__action'><use xlink:href='#vditor-icon-down'></use></svg>";document.getElementById("vditorIconScript")||(D='<svg class="vditor-outline__action" viewBox="0 0 32 32"><path d="M3.76 6.12l12.24 12.213 12.24-12.213 3.76 3.76-16 16-16-16 3.76-3.76z"></path></svg>'),M.innerHTML="".concat(D,"<span>").concat(M.innerHTML,"</span>")}else M.innerHTML="<svg></svg><span>".concat(M.innerHTML,"</span>");M.setAttribute("data-target-id",w[v])}),E=C.firstElementChild.innerHTML,T.length===0?(b.innerHTML="",E):(b.innerHTML=E,y&&(0,k.T)(b,{cdn:y.options.cdn,math:y.options.preview.math}),b.firstElementChild.addEventListener("click",function(M){for(var v=M.target;v&&!v.isEqualNode(b);){if(v.classList.contains("vditor-outline__action")){v.classList.contains("vditor-outline__action--close")?(v.classList.remove("vditor-outline__action--close"),v.parentElement.nextElementSibling.setAttribute("style","display:block")):(v.classList.add("vditor-outline__action--close"),v.parentElement.nextElementSibling.setAttribute("style","display:none")),M.preventDefault(),M.stopPropagation();break}else if(v.getAttribute("data-target-id")){M.preventDefault(),M.stopPropagation();var D=document.getElementById(v.getAttribute("data-target-id"));if(!D)return;if(y)if(y.options.height==="auto"){var N=D.offsetTop+y.element.offsetTop;y.options.toolbarConfig.pin||(N+=y.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,N)}else y.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,y.element.offsetTop),y.preview.element.contains(f)?f.parentElement.scrollTop=D.offsetTop:f.scrollTop=D.offsetTop;else window.scrollTo(window.scrollX,D.offsetTop);break}v=v.parentElement}}),E)}},591:(m,u,g)=>{g.d(u,{M:()=>f});var S=g(913),k=g(161),h=g(59),f=function(b,y){b===void 0&&(b=document),y===void 0&&(y=S.Y.CDN);var E=h.plantumlRenderAdapter.getElements(b);E.length!==0&&(0,k.Z)("".concat(y,"/dist/js/plantuml/plantuml-encoder.min.js"),"vditorPlantumlScript").then(function(){E.forEach(function(w){if(!(w.parentElement.classList.contains("vditor-wysiwyg__pre")||w.parentElement.classList.contains("vditor-ir__marker--pre"))){var C=h.plantumlRenderAdapter.getCode(w).trim();if(C)try{w.innerHTML='<object type="image/svg+xml" data="https://www.plantuml.com/plantuml/svg/~1'.concat(plantumlEncoder.encode(C),'"/>')}catch(_){w.className="vditor-reset--error",w.innerHTML="plantuml render error: <br>".concat(_)}}})})}},796:(m,u,g)=>{g.d(u,{X:()=>S});var S=function(k){var h=Lute.New();return h.PutEmojis(k.emojis),h.SetEmojiSite(k.emojiSite),h.SetHeadingAnchor(k.headingAnchor),h.SetInlineMathAllowDigitAfterOpenMarker(k.inlineMathDigit),h.SetAutoSpace(k.autoSpace),h.SetToC(k.toc),h.SetFootnotes(k.footnotes),h.SetFixTermTypo(k.fixTermTypo),h.SetVditorCodeBlockPreview(k.codeBlockPreview),h.SetVditorMathBlockPreview(k.mathBlockPreview),h.SetSanitize(k.sanitize),h.SetChineseParagraphBeginningSpace(k.paragraphBeginningSpace),h.SetRenderListStyle(k.listStyle),h.SetLinkBase(k.linkBase),h.SetLinkPrefix(k.linkPrefix),h.SetMark(k.mark),h.SetGFMAutoLink(k.gfmAutoLink),k.lazyLoadImage&&h.SetImageLazyLoading(k.lazyLoadImage),h}},726:(m,u,g)=>{g.d(u,{o:()=>S});var S=function(k,h,f){f===void 0&&(f="classic");var b=k.getBoundingClientRect(),y=36;document.body.insertAdjacentHTML("beforeend",'<div class="vditor vditor-img'.concat(f==="dark"?" vditor--dark":"",`">
    <div class="vditor-img__bar">
      <span class="vditor-img__btn" data-deg="0">
        <svg><use xlink:href="#vditor-icon-redo"></use></svg>
        `).concat(window.VditorI18n.spin,`
      </span>
      <span class="vditor-img__btn"  onclick="this.parentElement.parentElement.outerHTML = '';document.body.style.overflow = ''">
        X &nbsp;`).concat(window.VditorI18n.close,`
      </span>
    </div>
    <div class="vditor-img__img" onclick="this.parentElement.outerHTML = '';document.body.style.overflow = ''">
      <img style="width: `).concat(k.width,"px;height:").concat(k.height,"px;transform: translate3d(").concat(b.left,"px, ").concat(b.top-y,'px, 0)" src="').concat(k.getAttribute("src"),`">
    </div>
</div>`)),document.body.style.overflow="hidden";var E=document.querySelector(".vditor-img img"),w="translate3d(".concat(Math.max(0,window.innerWidth-k.naturalWidth)/2,"px, ").concat(Math.max(0,window.innerHeight-y-k.naturalHeight)/2,"px, 0)");setTimeout(function(){E.setAttribute("style","transition: transform .3s ease-in-out;transform: ".concat(w)),setTimeout(function(){E.parentElement.scrollTo((E.parentElement.scrollWidth-E.parentElement.clientWidth)/2,(E.parentElement.scrollHeight-E.parentElement.clientHeight)/2)},400)});var C=document.querySelector(".vditor-img__btn");C.addEventListener("click",function(){var _=parseInt(C.getAttribute("data-deg"),10)+90;_/90%2===1&&k.naturalWidth>E.parentElement.clientHeight?E.style.transform="translate3d(".concat(Math.max(0,window.innerWidth-k.naturalWidth)/2,"px, ").concat(k.naturalWidth/2-k.naturalHeight/2,"px, 0) rotateZ(").concat(_,"deg)"):E.style.transform="".concat(w," rotateZ(").concat(_,"deg)"),C.setAttribute("data-deg",_.toString()),setTimeout(function(){E.parentElement.scrollTo((E.parentElement.scrollWidth-E.parentElement.clientWidth)/2,(E.parentElement.scrollHeight-E.parentElement.clientHeight)/2)},400)})}},13:(m,u,g)=>{g.d(u,{h:()=>h});var S=g(913),k=g(505),h=function(f,b){b===void 0&&(b=S.Y.CDN),S.Y.CODE_THEME.includes(f)||(f="github");var y=document.getElementById("vditorHljsStyle"),E="".concat(b,"/dist/js/highlight.js/styles/").concat(f,".min.css");y?y.getAttribute("href")!==E&&(y.remove(),(0,k.T)(E,"vditorHljsStyle")):(0,k.T)(E,"vditorHljsStyle")}},873:(m,u,g)=>{g.d(u,{H:()=>k});var S=g(505),k=function(h,f){if(!(!h||!f)){var b=document.getElementById("vditorContentTheme"),y="".concat(f,"/").concat(h,".css");b?b.getAttribute("href")!==y&&(b.remove(),(0,S.T)(y,"vditorContentTheme")):(0,S.T)(y,"vditorContentTheme")}}},161:(m,u,g)=>{g.d(u,{U:()=>S,Z:()=>k});var S=function(h,f){if(document.getElementById(f))return!1;var b=new XMLHttpRequest;b.open("GET",h,!1),b.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),b.send("");var y=document.createElement("script");y.type="text/javascript",y.text=b.responseText,y.id=f,document.head.appendChild(y)},k=function(h,f){return new Promise(function(b,y){if(document.getElementById(f))return b(!0),!1;var E=document.createElement("script");E.src=h,E.async=!0,document.head.appendChild(E),E.onerror=function(w){y(w)},E.onload=function(){if(document.getElementById(f))return E.remove(),b(!0),!1;E.id=f,b(!0)}})}},505:(m,u,g)=>{g.d(u,{T:()=>S});var S=function(k,h){if(!document.getElementById(h)){var f=document.createElement("link");f.id=h,f.rel="stylesheet",f.type="text/css",f.href=k,document.getElementsByTagName("head")[0].appendChild(f)}}},695:(m,u,g)=>{g.d(u,{p:()=>S});var S=function(k){return k.replace(/\u00a0/g," ")}},629:(m,u,g)=>{g.d(u,{D:()=>h,H8:()=>E,_0:()=>b,fG:()=>y,gm:()=>k,nr:()=>S,y3:()=>f});var S=function(){return navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")===-1},k=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},h=function(){try{return typeof localStorage<"u"}catch{return!1}},f=function(){return navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click"},b=function(w){return navigator.platform.toUpperCase().indexOf("MAC")>=0?!!(w.metaKey&&!w.ctrlKey):!!(!w.metaKey&&w.ctrlKey)},y=function(w){return/Mac/.test(navigator.platform)||navigator.platform==="iPhone"?w.indexOf("⇧")>-1&&k()&&(w=w.replace(";",":").replace("=","+").replace("-","_")):(w.startsWith("⌘")?w=w.replace("⌘","⌘+"):w.startsWith("⌥")&&w.substr(1,1)!=="⌘"?w=w.replace("⌥","⌥+"):w=w.replace("⇧⌘","⌘+⇧+").replace("⌥⌘","⌥+⌘+"),w=w.replace("⌘","Ctrl").replace("⇧","Shift").replace("⌥","Alt"),w.indexOf("Shift")>-1&&(w=w.replace(";",":").replace("=","+").replace("-","_"))),w},E=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}},933:(m,u,g)=>{g.d(u,{Ee:()=>S,TK:()=>k,kY:()=>h});var S=function(){return([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(f){return(parseInt(f,10)^window.crypto.getRandomValues(new Uint32Array(1))[0]&15>>parseInt(f,10)/4).toString(16)})},k=function(f,b){b===void 0&&(b=window.location.search);var y=b.substring(b.indexOf("?")),E=y.indexOf("#"),w=new URLSearchParams(y.substring(0,E>=0?E:void 0));return w.get(f)},h=function(f){return Function('"use strict";return ('.concat(f,")"))()}},598:(m,u,g)=>{g.d(u,{Ab:()=>h,KJ:()=>w,KR:()=>f,Rp:()=>C,Th:()=>b,XW:()=>k,_Y:()=>E,pt:()=>y});var S=g(164),k=function(_,T){for(var M=w(_,T),v=!1,D=!1;M&&!M.classList.contains("vditor-reset")&&!D;)v=w(M.parentElement,T),v?M=v:D=!0;return M||!1},h=function(_,T){for(var M=(0,S.f)(_,T),v=!1,D=!1;M&&!M.classList.contains("vditor-reset")&&!D;)v=(0,S.f)(M.parentElement,T),v?M=v:D=!0;return M||!1},f=function(_){var T=h(_,"UL"),M=h(_,"OL"),v=T;return M&&(!T||T&&M.contains(T))&&(v=M),v},b=function(_,T,M){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var v=_,D=!1;v&&!D&&!v.classList.contains("vditor-reset");)v.getAttribute(T)===M?D=!0:v=v.parentElement;return D&&v},y=function(_){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);var T=_,M=!1,v=b(_,"data-block","0");if(v)return v;for(;T&&!M&&!T.classList.contains("vditor-reset");)T.tagName==="H1"||T.tagName==="H2"||T.tagName==="H3"||T.tagName==="H4"||T.tagName==="H5"||T.tagName==="H6"||T.tagName==="P"||T.tagName==="BLOCKQUOTE"||T.tagName==="OL"||T.tagName==="UL"?M=!0:T=T.parentElement;return M&&T},E=function(_,T){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var M=_,v=!1;M&&!v&&!M.classList.contains("vditor-reset");)M.nodeName===T?v=!0:M=M.parentElement;return v&&M},w=function(_,T){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var M=_,v=!1;M&&!v&&!M.classList.contains("vditor-reset");)M.classList.contains(T)?v=!0:M=M.parentElement;return v&&M},C=function(_){for(;_&&_.lastChild;)_=_.lastChild;return _}},164:(m,u,g)=>{g.d(u,{c:()=>k,f:()=>S});var S=function(h,f){if(!h)return!1;h.nodeType===3&&(h=h.parentElement);for(var b=h,y=!1;b&&!y&&!b.classList.contains("vditor-reset");)b.nodeName.indexOf(f)===0?y=!0:b=b.parentElement;return y&&b},k=function(h){var f=S(h,"H");return f&&f.tagName.length===2&&f.tagName!=="HR"?f:!1}},905:(m,u,g)=>{g.d(u,{h:()=>S});var S=function(){for(var k=[],h=0;h<arguments.length;h++)k[h]=arguments[h];for(var f={},b=function(E){for(var w in E)E.hasOwnProperty(w)&&(Object.prototype.toString.call(E[w])==="[object Object]"?f[w]=S(f[w],E[w]):f[w]=E[w])},y=0;y<k.length;y++)b(k[y]);return f}},827:(m,u,g)=>{g.d(u,{Co:()=>y,ED:()=>w,Ey:()=>b,Fm:()=>C,RN:()=>f,Z2:()=>T,ir:()=>_,jl:()=>E});var S=g(913),k=g(629),h=g(598),f=function(M){var v,D=M[M.currentMode].element;return getSelection().rangeCount>0&&(v=getSelection().getRangeAt(0),D.isEqualNode(v.startContainer)||D.contains(v.startContainer))?v:M[M.currentMode].range?M[M.currentMode].range:(D.focus(),v=D.ownerDocument.createRange(),v.setStart(D,0),v.collapse(!0),v)},b=function(M){var v=window.getSelection().getRangeAt(0);if(!M.contains(v.startContainer)&&!(0,h.KJ)(v.startContainer,"vditor-panel--none"))return{left:0,top:0};var D=M.parentElement.getBoundingClientRect(),N;if(v.getClientRects().length===0)if(v.startContainer.nodeType===3){var V=v.startContainer.parentElement;if(V&&V.getClientRects().length>0)N=V.getClientRects()[0];else return{left:0,top:0}}else{var H=v.startContainer.children;if(H[v.startOffset]&&H[v.startOffset].getClientRects().length>0)N=H[v.startOffset].getClientRects()[0];else if(v.startContainer.childNodes.length>0){var $=v.cloneRange();v.selectNode(v.startContainer.childNodes[Math.max(0,v.startOffset-1)]),N=v.getClientRects()[0],v.setEnd($.endContainer,$.endOffset),v.setStart($.startContainer,$.startOffset)}else N=v.startContainer.getClientRects()[0];if(!N){for(var z=v.startContainer.childNodes[v.startOffset];!z.getClientRects||z.getClientRects&&z.getClientRects().length===0;)z=z.parentElement;N=z.getClientRects()[0]}}else N=v.getClientRects()[0];return{left:N.left-D.left,top:N.top-D.top}},y=function(M,v){if(!v){if(getSelection().rangeCount===0)return!1;v=getSelection().getRangeAt(0)}var D=v.commonAncestorContainer;return M.isEqualNode(D)||M.contains(D)},E=function(M){var v=window.getSelection();v.removeAllRanges(),v.addRange(M)},w=function(M,v,D){var N={end:0,start:0};if(!D){if(getSelection().rangeCount===0)return N;D=window.getSelection().getRangeAt(0)}if(y(v,D)){var V=D.cloneRange();M.childNodes[0]&&M.childNodes[0].childNodes[0]?V.setStart(M.childNodes[0].childNodes[0],0):V.selectNodeContents(M),V.setEnd(D.startContainer,D.startOffset),N.start=V.toString().length,N.end=N.start+D.toString().length}return N},C=function(M,v,D){var N=0,V=0,H=D.childNodes[V],$=!1,z=!1;M=Math.max(0,M),v=Math.max(0,v);var F=D.ownerDocument.createRange();for(F.setStart(H||D,0),F.collapse(!0);!z&&H;){var le=N+H.textContent.length;if(!$&&M>=N&&M<=le&&(M===0?F.setStart(H,0):H.childNodes[0].nodeType===3?F.setStart(H.childNodes[0],M-N):H.nextSibling?F.setStartBefore(H.nextSibling):F.setStartAfter(H),$=!0,M===v)){z=!0;break}$&&v>=N&&v<=le&&(v===0?F.setEnd(H,0):H.childNodes[0].nodeType===3?F.setEnd(H.childNodes[0],v-N):H.nextSibling?F.setEndBefore(H.nextSibling):F.setEndAfter(H),z=!0),N=le,H=D.childNodes[++V]}return!z&&D.childNodes[V-1]&&F.setStartBefore(D.childNodes[V-1]),E(F),F},_=function(M,v){var D=M.querySelector("wbr");if(D){if(!D.previousElementSibling)D.previousSibling?v.setStart(D.previousSibling,D.previousSibling.textContent.length):D.nextSibling?D.nextSibling.nodeType===3?v.setStart(D.nextSibling,0):v.setStartBefore(D.nextSibling):v.setStart(D.parentElement,0);else if(D.previousElementSibling.isSameNode(D.previousSibling))if(D.previousElementSibling.lastChild){v.setStartBefore(D),v.collapse(!0),E(v),(0,k.H8)()&&(D.previousElementSibling.tagName==="EM"||D.previousElementSibling.tagName==="STRONG"||D.previousElementSibling.tagName==="S")&&(v.insertNode(document.createTextNode(S.Y.ZWSP)),v.collapse(!1)),D.remove();return}else v.setStartAfter(D.previousElementSibling);else v.setStart(D.previousSibling,D.previousSibling.textContent.length);v.collapse(!0),D.remove(),E(v)}},T=function(M,v){var D=document.createElement("div");D.innerHTML=M;var N=D.querySelectorAll("p");N.length===1&&!N[0].previousSibling&&!N[0].nextSibling&&v[v.currentMode].element.children.length>0&&D.firstElementChild.tagName==="P"&&(M=N[0].innerHTML.trim());var V=document.createElement("div");V.innerHTML=M;var H=f(v);if(H.toString()!==""&&(v[v.currentMode].preventInput=!0,document.execCommand("delete",!1,"")),V.firstElementChild&&V.firstElementChild.getAttribute("data-block")==="0"){V.lastElementChild.insertAdjacentHTML("beforeend","<wbr>");var $=(0,h.pt)(H.startContainer);$?$.insertAdjacentHTML("afterend",V.innerHTML):v[v.currentMode].element.insertAdjacentHTML("beforeend",V.innerHTML),_(v[v.currentMode].element,H)}else{var z=document.createElement("template");z.innerHTML=M,H.insertNode(z.content.cloneNode(!0)),H.collapse(!1),E(H)}}}},s={};function l(m){var u=s[m];if(u!==void 0)return u.exports;var g=s[m]={exports:{}};return r[m](g,g.exports,l),g.exports}l.d=(m,u)=>{for(var g in u)l.o(u,g)&&!l.o(m,g)&&Object.defineProperty(m,g,{enumerable:!0,get:u[g]})},l.o=(m,u)=>Object.prototype.hasOwnProperty.call(m,u),l.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})};var d={};return(()=>{l.d(d,{default:()=>sc});var m=l(923),u=l(913),g=l(695),S=function(t){return t.currentMode==="sv"?(0,g.p)("".concat(t.sv.element.textContent,`
`).replace(/\n\n$/,`
`)):t.currentMode==="wysiwyg"?t.lute.VditorDOM2Md(t.wysiwyg.element.innerHTML):t.currentMode==="ir"?t.lute.VditorIRDOM2Md(t.ir.element.innerHTML):""},k=l(161),h=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-devtools",this.element.innerHTML='<div class="vditor-reset--error"></div><div style="height: 100%;"></div>'}return t.prototype.renderEchart=function(n){var i=this;n.devtools.element.style.display==="block"&&(0,k.Z)("".concat(n.options.cdn,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){i.ASTChart||(i.ASTChart=echarts.init(n.devtools.element.lastElementChild));try{i.element.lastElementChild.style.display="block",i.element.firstElementChild.innerHTML="",i.ASTChart.setOption({series:[{data:JSON.parse(n.lute.RenderEChartsJSON(S(n))),initialTreeDepth:-1,label:{align:"left",backgroundColor:"rgba(68, 77, 86, .68)",borderRadius:3,color:"#d1d5da",fontSize:12,lineHeight:12,offset:[9,12],padding:[2,4,2,4],position:"top",verticalAlign:"middle"},lineStyle:{color:"#4285f4",type:"curve",width:1},orient:"vertical",roam:!0,type:"tree"}],toolbox:{bottom:25,emphasis:{iconStyle:{color:"#4285f4"}},feature:{restore:{show:!0},saveAsImage:{show:!0}},right:15,show:!0}}),i.ASTChart.resize()}catch(a){i.element.lastElementChild.style.display="none",i.element.firstElementChild.innerHTML=a}})},t}(),f=l(629),b=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&a.classList.contains("vditor-menu--current")&&a.classList.remove("vditor-menu--current")}})},y=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&!a.classList.contains("vditor-menu--current")&&a.classList.add("vditor-menu--current")}})},E=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&a.classList.contains(u.Y.CLASS_MENU_DISABLED)&&a.classList.remove(u.Y.CLASS_MENU_DISABLED)}})},w=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&!a.classList.contains(u.Y.CLASS_MENU_DISABLED)&&a.classList.add(u.Y.CLASS_MENU_DISABLED)}})},C=function(t,n){n.forEach(function(i){t[i]&&t[i]&&(t[i].style.display="none")})},_=function(t,n){n.forEach(function(i){t[i]&&t[i]&&(t[i].style.display="block")})},T=function(t,n,i){n.includes("subToolbar")&&(t.toolbar.element.querySelectorAll(".vditor-hint").forEach(function(a){i&&a.isEqualNode(i)||(a.style.display="none")}),t.toolbar.elements.emoji&&(t.toolbar.elements.emoji.lastElementChild.style.display="none")),n.includes("hint")&&(t.hint.element.style.display="none"),t.wysiwyg.popover&&n.includes("popover")&&(t.wysiwyg.popover.style.display="none")},M=function(t,n,i,a){i.addEventListener((0,f.y3)(),function(o){o.preventDefault(),o.stopPropagation(),!i.classList.contains(u.Y.CLASS_MENU_DISABLED)&&(t.toolbar.element.querySelectorAll(".vditor-hint--current").forEach(function(c){c.classList.remove("vditor-hint--current")}),n.style.display==="block"?n.style.display="none":(T(t,["subToolbar","hint","popover"],i.parentElement.parentElement),i.classList.contains("vditor-tooltipped")||i.classList.add("vditor-hint--current"),n.style.display="block",t.toolbar.element.getBoundingClientRect().right-i.getBoundingClientRect().right<250?n.classList.add("vditor-panel--left"):n.classList.remove("vditor-panel--left")))})},v=l(598),D=l(164),N=function(t,n,i,a){a&&console.log("".concat(t," - ").concat(i,": ").concat(n))},V=l(288),H=l(784),$=l(51),z=l(500),F=l(339),le=l(108),de=l(960),Pe=l(975),Ue=l(597),Te=l(162),Le=l(591),Re=l(931),Je=function(t,n,i){i===void 0&&(i="sv");var a=document.createElement("div");a.innerHTML=t;var o=!1;a.childElementCount===1&&a.lastElementChild.style.fontFamily.indexOf("monospace")>-1&&(o=!0);var c=a.querySelectorAll("pre");if(a.childElementCount===1&&c.length===1&&c[0].className!=="vditor-wysiwyg"&&c[0].className!=="vditor-sv"&&(o=!0),t.indexOf(`
<p class="p1">`)===0&&(o=!0),a.childElementCount===1&&a.firstElementChild.tagName==="TABLE"&&a.querySelector(".line-number")&&a.querySelector(".line-content")&&(o=!0),o){var x=n||t;return/\n/.test(x)||c.length===1?i==="wysiwyg"?'<div class="vditor-wysiwyg__block" data-block="0" data-type="code-block"><pre><code>'.concat(x.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"<wbr></code></pre></div>"):"\n```\n"+x.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"\n```":i==="wysiwyg"?"<code>".concat(x.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"</code><wbr>"):"`".concat(x,"`")}return!1},tt=function(t,n){if(t){if(t.parentElement.getAttribute("data-type")==="html-block"){t.setAttribute("data-render","1");return}var i=t.firstElementChild.className.replace("language-","");if(i==="abc")(0,V.$)(t,n.options.cdn);else if(i==="mermaid")(0,Pe.e)(t,n.options.cdn,n.options.theme);else if(i==="smiles")(0,Re.Y)(t,n.options.cdn,n.options.theme);else if(i==="markmap")(0,Ue.K)(t,n.options.cdn);else if(i==="flowchart")(0,z.D)(t,n.options.cdn);else if(i==="echarts")(0,H.v)(t,n.options.cdn,n.options.theme);else if(i==="mindmap")(0,Te.l)(t,n.options.cdn,n.options.theme);else if(i==="plantuml")(0,Le.M)(t,n.options.cdn);else if(i==="graphviz")(0,F.m)(t,n.options.cdn);else if(i==="math")(0,de.T)(t,{cdn:n.options.cdn,math:n.options.preview.math});else{var a=n.options.customRenders.find(function(o){if(o.language===i)return o.render(t,n),!0});a||((0,le.$)(Object.assign({},n.options.preview.hljs),t,n.options.cdn),(0,$.o)(t,n.options.preview.hljs))}t.setAttribute("data-render","1")}},U=l(827),oe=function(t){if(t.currentMode!=="sv"){var n=t[t.currentMode].element,i=t.outline.render(t);i===""&&(i="[ToC]"),n.querySelectorAll('[data-type="toc-block"]').forEach(function(a){a.innerHTML=i,(0,de.T)(a,{cdn:t.options.cdn,math:t.options.preview.math})})}},re=function(t,n){var i=(0,v._Y)(t.target,"SPAN");if(i&&(0,v.KJ)(i,"vditor-toc")){var a=n[n.currentMode].element.querySelector("#"+i.getAttribute("data-target-id"));if(a)if(n.options.height==="auto"){var o=a.offsetTop+n.element.offsetTop;n.options.toolbarConfig.pin||(o+=n.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,o)}else n.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,n.element.offsetTop),n[n.currentMode].element.scrollTop=a.offsetTop;return}},Ae=function(t,n,i,a){if(t.previousElementSibling&&t.previousElementSibling.classList.contains("vditor-toc")){if(i.key==="Backspace"&&(0,U.ED)(t,n[n.currentMode].element,a).start===0)return t.previousElementSibling.remove(),rt(n),!0;if(ii(n,i,a,t,t.previousElementSibling))return!0}if(t.nextElementSibling&&t.nextElementSibling.classList.contains("vditor-toc")){if(i.key==="Delete"&&(0,U.ED)(t,n[n.currentMode].element,a).start>=t.textContent.trimRight().length)return t.nextElementSibling.remove(),rt(n),!0;if(mi(n,i,a,t,t.nextElementSibling))return!0}if(i.key==="Backspace"||i.key==="Delete"){var o=(0,v.KJ)(a.startContainer,"vditor-toc");if(o)return o.remove(),rt(n),!0}},Ge=function(t,n,i,a){i===void 0&&(i=!1);var o=(0,v.pt)(n.startContainer);if(o&&!i&&o.getAttribute("data-type")!=="code-block"){if(_i(o.innerHTML)&&o.previousElementSibling||fr(o.innerHTML))return;for(var c=(0,U.ED)(o,t.ir.element,n).start,x=!0,A=c-1;A>o.textContent.substr(0,c).lastIndexOf(`
`);A--)if(o.textContent.charAt(A)!==" "&&o.textContent.charAt(A)!=="	"){x=!1;break}c===0&&(x=!1);for(var O=!0,A=c-1;A<o.textContent.length;A++)if(o.textContent.charAt(A)!==" "&&o.textContent.charAt(A)!==`
`){O=!1;break}if(x){typeof t.options.input=="function"&&t.options.input(S(t));return}if(O&&/^#{1,6} $/.test(o.textContent)&&(O=!1),O){var L=(0,v.KJ)(n.startContainer,"vditor-ir__marker");if(!L){var B=n.startContainer.previousSibling;B&&B.nodeType!==3&&B.classList.contains("vditor-ir__node--expand")&&B.classList.remove("vditor-ir__node--expand"),typeof t.options.input=="function"&&t.options.input(S(t));return}}}if(t.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(st){st.classList.remove("vditor-ir__node--expand")}),o||(o=t.ir.element),!o.querySelector("wbr")){var K=(0,v.KJ)(n.startContainer,"vditor-ir__preview");K?K.previousElementSibling.insertAdjacentHTML("beforeend","<wbr>"):n.insertNode(document.createElement("wbr"))}o.querySelectorAll("[style]").forEach(function(st){st.removeAttribute("style")}),o.getAttribute("data-type")==="link-ref-defs-block"&&(o=t.ir.element);var me=o.isEqualNode(t.ir.element),pe=(0,v.Th)(o,"data-type","footnotes-block"),fe="";if(me)fe=o.innerHTML;else{var je=(0,D.f)(n.startContainer,"BLOCKQUOTE"),Se=(0,v.KR)(n.startContainer);if(Se&&(o=Se),je&&(!Se||Se&&!je.contains(Se))&&(o=je),pe&&(o=pe),fe=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var ue=o.previousElementSibling,Ye=o.nextElementSibling;ue&&(ue.tagName==="UL"||ue.tagName==="OL")&&(fe=ue.outerHTML+fe,ue.remove()),Ye&&(Ye.tagName==="UL"||Ye.tagName==="OL")&&(fe=fe+Ye.outerHTML,Ye.remove()),fe=fe.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}else o.previousElementSibling&&o.previousElementSibling.textContent.replace(u.Y.ZWSP,"")!==""&&a&&a.inputType==="insertParagraph"&&(fe=o.previousElementSibling.outerHTML+fe,o.previousElementSibling.remove());o.innerText.startsWith("```")||(t.ir.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(st){st&&!o.isEqualNode(st)&&(fe+=st.outerHTML,st.remove())}),t.ir.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(st){st&&!o.isEqualNode(st)&&(fe+=st.outerHTML,st.remove())}))}if(N("SpinVditorIRDOM",fe,"argument",t.options.debugger),fe=t.lute.SpinVditorIRDOM(fe),N("SpinVditorIRDOM",fe,"result",t.options.debugger),me)o.innerHTML=fe;else if(o.outerHTML=fe,pe){var He=(0,v.Th)(t.ir.element.querySelector("wbr"),"data-type","footnotes-def");if(He){var Ze=He.textContent,Tt=Ze.substring(1,Ze.indexOf("]:")),Ct=t.ir.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(Tt,'"]'));Ct&&Ct.setAttribute("aria-label",Ze.substr(Tt.length+3).trim().substr(0,24))}}var At,pn=t.ir.element.querySelectorAll("[data-type='link-ref-defs-block']");pn.forEach(function(st,Wt){Wt===0?At=st:(At.insertAdjacentHTML("beforeend",st.innerHTML),st.remove())}),pn.length>0&&t.ir.element.insertAdjacentElement("beforeend",pn[0]);var nn,mn=t.ir.element.querySelectorAll("[data-type='footnotes-block']");mn.forEach(function(st,Wt){Wt===0?nn=st:(nn.insertAdjacentHTML("beforeend",st.innerHTML),st.remove())}),mn.length>0&&t.ir.element.insertAdjacentElement("beforeend",mn[0]),(0,U.ir)(t.ir.element,n),t.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(st){tt(st,t)}),oe(t),Ot(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Z=function(t,n){if(t==="")return!1;if(t.indexOf("⇧")===-1&&t.indexOf("⌘")===-1&&t.indexOf("⌥")===-1)return!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&n.code===t;if(t==="⇧Tab")return!!(!(0,f._0)(n)&&!n.altKey&&n.shiftKey&&n.code==="Tab");var i=t.split("");if(t.startsWith("⌥")){var a=i.length===3?i[2]:i[1];return!!((i.length===3?(0,f._0)(n):!(0,f._0)(n))&&n.altKey&&!n.shiftKey&&n.code===(/^[0-9]$/.test(a)?"Digit":"Key")+a)}t==="⌘Enter"&&(i=["⌘","Enter"]);var o=i.length>2&&i[0]==="⇧",c=o?i[2]:i[1];return o&&((0,f.gm)()||!/Mac/.test(navigator.platform))&&(c==="-"?c="_":c==="="&&(c="+")),!!((0,f._0)(n)&&n.key.toLowerCase()===c.toLowerCase()&&!n.altKey&&(!o&&!n.shiftKey||o&&n.shiftKey))},ke=function(t){var n=t.startContainer;if(n.nodeType===3&&n.nodeValue.length!==t.startOffset)return!1;for(var i=n.nextSibling;i&&i.textContent==="";)i=i.nextSibling;if(i){if(i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block"))return i}else{var a=(0,v.KJ)(n,"vditor-ir__marker");if(a&&!a.nextSibling){var o=n.parentElement.parentElement.nextSibling;if(o&&o.nodeType!==3&&o.classList.contains("vditor-ir__node"))return o}return!1}return!1},se=function(t){var n=t.startContainer,i=n.previousSibling;return n.nodeType===3&&t.startOffset===0&&i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block")?i:!1},ee=function(t,n){n.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(x){x.classList.remove("vditor-ir__node--expand")});var i=(0,v.XW)(t.startContainer,"vditor-ir__node"),a=!t.collapsed&&(0,v.XW)(t.endContainer,"vditor-ir__node");if(!(!t.collapsed&&(!i||i!==a))){i&&(i.classList.add("vditor-ir__node--expand"),i.classList.remove("vditor-ir__node--hidden"),(0,U.jl)(t));var o=ke(t);if(o){o.classList.add("vditor-ir__node--expand"),o.classList.remove("vditor-ir__node--hidden");return}var c=se(t);if(c){c.classList.add("vditor-ir__node--expand"),c.classList.remove("vditor-ir__node--hidden");return}}},Ie=function(t,n){if(t.ir.composingLock=n.isComposing,n.isComposing)return!1;n.key.indexOf("Arrow")===-1&&n.key!=="Meta"&&n.key!=="Control"&&n.key!=="Alt"&&n.key!=="Shift"&&n.key!=="CapsLock"&&n.key!=="Escape"&&!/^F\d{1,2}$/.test(n.key)&&t.undo.recordFirstPosition(t,n);var i=(0,U.RN)(t),a=i.startContainer;if(!ur(n,t,a)||(qi(i,t,n),Wn(i),n.key!=="Enter"&&n.key!=="Tab"&&n.key!=="Backspace"&&n.key.indexOf("Arrow")===-1&&!(0,f._0)(n)&&n.key!=="Escape"&&n.key!=="Delete"))return!1;var o=(0,v.Th)(a,"data-newline","1");if(!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&n.key==="Enter"&&o&&i.startOffset<o.textContent.length){var c=o.previousElementSibling;c&&(i.insertNode(document.createTextNode(c.textContent)),i.collapse(!1));var x=o.nextSibling;x&&(i.insertNode(document.createTextNode(x.textContent)),i.collapse(!0))}var A=(0,v._Y)(a,"P");if(jr(n,t,A,i)||Ti(i,t,A,n)||_t(t,i,n,A))return!0;var O=(0,v.KJ)(a,"vditor-ir__marker--pre");if(O&&O.tagName==="PRE"){var L=O.firstChild;if(ot(t,n,O,i)||(L.getAttribute("data-type")==="math-block"||L.getAttribute("data-type")==="html-block")&&ii(t,n,i,L,O.parentElement)||mi(t,n,i,L,O.parentElement))return!0}var B=(0,v.Th)(a,"data-type","code-block-info");if(B){if(n.key==="Enter"||n.key==="Tab")return i.selectNodeContents(B.nextElementSibling.firstChild),i.collapse(!0),n.preventDefault(),T(t,["hint"]),!0;if(n.key==="Backspace"){var K=(0,U.ED)(B,t.ir.element).start;K===1&&i.setStart(a,0),K===2&&(t.hint.recentLanguage="")}if(ii(t,n,i,B,B.parentElement))return T(t,["hint"]),!0}var me=(0,v._Y)(a,"TD")||(0,v._Y)(a,"TH");if(n.key.indexOf("Arrow")>-1&&me){var pe=Ir(me);if(pe&&ii(t,n,i,me,pe))return!0;var fe=Hr(me);if(fe&&mi(t,n,i,me,fe))return!0}if(xe(t,n,i)||Gt(t,i,n)||hr(t,i,n))return!0;var je=(0,D.c)(a);if(je){if(Z("⌘=",n)){var Se=je.querySelector(".vditor-ir__marker--heading");return Se&&Se.textContent.trim().length>1&&$n(t,Se.textContent.substr(1)),n.preventDefault(),!0}if(Z("⌘-",n)){var Se=je.querySelector(".vditor-ir__marker--heading");return Se&&Se.textContent.trim().length<6&&$n(t,Se.textContent.trim()+"# "),n.preventDefault(),!0}}var ue=(0,v.pt)(a);if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&i.toString()===""){if(Nn(t,i,n,A))return!0;if(ue&&ue.previousElementSibling&&ue.tagName!=="UL"&&ue.tagName!=="OL"&&(ue.previousElementSibling.getAttribute("data-type")==="code-block"||ue.previousElementSibling.getAttribute("data-type")==="math-block")){var Ye=(0,U.ED)(ue,t.ir.element,i).start;if(Ye===0||Ye===1&&ue.innerText.startsWith(u.Y.ZWSP))return i.selectNodeContents(ue.previousElementSibling.querySelector(".vditor-ir__marker--pre code")),i.collapse(!1),ee(i,t),ue.textContent.trim().replace(u.Y.ZWSP,"")===""&&(ue.remove(),Ot(t)),n.preventDefault(),!0}if(je){var He=je.firstElementChild.textContent.length;(0,U.ED)(je,t.ir.element).start===He&&He!==0&&(i.setStart(je.firstElementChild.firstChild,He-1),i.collapse(!0),(0,U.jl)(i))}}return(n.key==="ArrowUp"||n.key==="ArrowDown")&&ue&&(ue.querySelectorAll(".vditor-ir__node").forEach(function(Ze){Ze.contains(a)||Ze.classList.add("vditor-ir__node--hidden")}),ri(n,ue,i))?!0:(Rr(i,n.key),ue&&Ae(ue,t,n,i)?(n.preventDefault(),!0):!1)},ye=l(726),lt=function(t,n){t.querySelectorAll("[data-type=footnotes-link]").forEach(function(i){for(var a=i.parentElement,o=a.nextSibling;o&&o.textContent.startsWith("    ");){var c=o;c.childNodes.forEach(function(x){a.append(x.cloneNode(!0))}),o=o.nextSibling,c.remove()}n&&n(a)})},Ve=function(t,n){var i,a=getSelection().getRangeAt(0).cloneRange(),o=a.startContainer;a.startContainer.nodeType!==3&&a.startContainer.tagName==="DIV"&&(o=a.startContainer.childNodes[a.startOffset-1]);var c=(0,v.Th)(o,"data-block","0");if(c&&n&&(n.inputType==="deleteContentBackward"||n.data===" ")){for(var x=(0,U.ED)(c,t.sv.element,a).start,A=!0,O=x-1;O>c.textContent.substr(0,x).lastIndexOf(`
`);O--)if(c.textContent.charAt(O)!==" "&&c.textContent.charAt(O)!=="	"){A=!1;break}if(x===0&&(A=!1),A){ze(t);return}if(n.inputType==="deleteContentBackward"){var L=(0,v.Th)(o,"data-type","code-block-open-marker")||(0,v.Th)(o,"data-type","code-block-close-marker");if(L){if(L.getAttribute("data-type")==="code-block-close-marker"){var B=X(o,"code-block-open-marker");if(B){B.textContent=L.textContent,ze(t);return}}if(L.getAttribute("data-type")==="code-block-open-marker"){var B=X(o,"code-block-close-marker",!1);if(B){B.textContent=L.textContent,ze(t);return}}}var K=(0,v.Th)(o,"data-type","math-block-open-marker");if(K){var me=K.nextElementSibling.nextElementSibling;me&&me.getAttribute("data-type")==="math-block-close-marker"&&(me.remove(),ze(t));return}c.querySelectorAll('[data-type="code-block-open-marker"]').forEach(function(ue){ue.textContent.length===1&&ue.remove()}),c.querySelectorAll('[data-type="code-block-close-marker"]').forEach(function(ue){ue.textContent.length===1&&ue.remove()});var pe=(0,v.Th)(o,"data-type","heading-marker");if(pe&&pe.textContent.indexOf("#")===-1){ze(t);return}}if((n.data===" "||n.inputType==="deleteContentBackward")&&((0,v.Th)(o,"data-type","padding")||(0,v.Th)(o,"data-type","li-marker")||(0,v.Th)(o,"data-type","task-marker")||(0,v.Th)(o,"data-type","blockquote-marker"))){ze(t);return}}if(c&&c.textContent.trimRight()==="$$"){ze(t);return}c||(c=t.sv.element),((i=c.firstElementChild)===null||i===void 0?void 0:i.getAttribute("data-type"))==="link-ref-defs-block"&&(c=t.sv.element),(0,v.Th)(o,"data-type","footnotes-link")&&(c=t.sv.element),c.textContent.indexOf(Lute.Caret)===-1&&a.insertNode(document.createTextNode(Lute.Caret)),c.querySelectorAll("[style]").forEach(function(ue){ue.removeAttribute("style")}),c.querySelectorAll("font").forEach(function(ue){ue.outerHTML=ue.innerHTML});var fe=c.textContent,je=c.isEqualNode(t.sv.element);if(je)fe=c.textContent;else{c.previousElementSibling&&(fe=c.previousElementSibling.textContent+fe,c.previousElementSibling.remove()),c.previousElementSibling&&fe.indexOf(`---
`)===0&&(fe=c.previousElementSibling.textContent+fe,c.previousElementSibling.remove());var Se="";t.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ue,Ye){ue&&!c.isEqualNode(ue.parentElement)&&(Se+=ue.parentElement.textContent+`
`,ue.parentElement.remove())}),t.sv.element.querySelectorAll("[data-type='footnotes-link']").forEach(function(ue,Ye){ue&&!c.isEqualNode(ue.parentElement)&&(Se+=ue.parentElement.textContent+`
`,ue.parentElement.remove())}),fe=Se+fe}fe=Ee(fe,t),je?c.innerHTML=fe:c.outerHTML=fe,t.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(ue){t.sv.element.insertAdjacentElement("beforeend",ue.parentElement)}),lt(t.sv.element,function(ue){t.sv.element.insertAdjacentElement("beforeend",ue)}),(0,U.ir)(t.sv.element,a),Xe(t),ze(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Qe=function(t,n){var i,a,o,c,x;if(t.sv.composingLock=n.isComposing,n.isComposing||(n.key.indexOf("Arrow")===-1&&n.key!=="Meta"&&n.key!=="Control"&&n.key!=="Alt"&&n.key!=="Shift"&&n.key!=="CapsLock"&&n.key!=="Escape"&&!/^F\d{1,2}$/.test(n.key)&&t.undo.recordFirstPosition(t,n),n.key!=="Enter"&&n.key!=="Tab"&&n.key!=="Backspace"&&n.key.indexOf("Arrow")===-1&&!(0,f._0)(n)&&n.key!=="Escape"))return!1;var A=(0,U.RN)(t),O=A.startContainer;A.startContainer.nodeType!==3&&A.startContainer.tagName==="DIV"&&(O=A.startContainer.childNodes[A.startOffset-1]);var L=(0,v.Th)(O,"data-type","text"),B=(0,v.Th)(O,"data-type","blockquote-marker");if(!B&&A.startOffset===0&&L&&L.previousElementSibling&&L.previousElementSibling.getAttribute("data-type")==="blockquote-marker"&&(B=L.previousElementSibling),B&&n.key==="Enter"&&!(0,f._0)(n)&&!n.altKey&&B.nextElementSibling.textContent.trim()===""&&(0,U.ED)(B,t.sv.element,A).start===B.textContent.length)return((i=B.previousElementSibling)===null||i===void 0?void 0:i.getAttribute("data-type"))==="padding"&&B.previousElementSibling.setAttribute("data-action","enter-remove"),B.remove(),ze(t),n.preventDefault(),!0;var K=(0,v.Th)(O,"data-type","li-marker"),me=(0,v.Th)(O,"data-type","task-marker"),pe=K;if(pe||me&&me.nextElementSibling.getAttribute("data-type")!=="task-marker"&&(pe=me),!pe&&A.startOffset===0&&L&&L.previousElementSibling&&(L.previousElementSibling.getAttribute("data-type")==="li-marker"||L.previousElementSibling.getAttribute("data-type")==="task-marker")&&(pe=L.previousElementSibling),pe){var fe=(0,U.ED)(pe,t.sv.element,A).start,je=pe.getAttribute("data-type")==="task-marker",Se=pe;if(je&&(Se=pe.previousElementSibling.previousElementSibling.previousElementSibling),fe===pe.textContent.length){if(n.key==="Enter"&&!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&pe.nextElementSibling.textContent.trim()==="")return((a=Se.previousElementSibling)===null||a===void 0?void 0:a.getAttribute("data-type"))==="padding"?(Se.previousElementSibling.remove(),Ve(t)):(je&&(Se.remove(),pe.previousElementSibling.previousElementSibling.remove(),pe.previousElementSibling.remove()),pe.nextElementSibling.remove(),pe.remove(),ze(t)),n.preventDefault(),!0;if(n.key==="Tab")return n.shiftKey?Se.previousElementSibling.getAttribute("data-type")==="padding"&&Se.previousElementSibling.remove():Se.insertAdjacentHTML("beforebegin",'<span data-type="padding">'.concat(Se.textContent.replace(/\S/g," "),"</span>")),/^\d/.test(Se.textContent)&&(Se.textContent=Se.textContent.replace(/^\d{1,}/,"1"),A.selectNodeContents(pe.firstChild),A.collapse(!1)),Ve(t),n.preventDefault(),!0}}if(hr(t,A,n))return!0;var ue=(0,v.Th)(O,"data-block","0"),Ye=(0,D.f)(O,"SPAN");if(n.key==="Enter"&&!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&ue){var He=!1,Ze=ue.textContent.match(/^\n+/);(0,U.ED)(ue,t.sv.element).start<=(Ze?Ze[0].length:0)&&(He=!0);var Tt=`
`;if(Ye){if(((o=Ye.previousElementSibling)===null||o===void 0?void 0:o.getAttribute("data-action"))==="enter-remove")return Ye.previousElementSibling.remove(),ze(t),n.preventDefault(),!0;Tt+=$e(Ye)}return A.insertNode(document.createTextNode(Tt)),A.collapse(!1),ue&&ue.textContent.trim()!==""&&!He?Ve(t):ze(t),n.preventDefault(),!0}if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.altKey&&!n.shiftKey){if(Ye&&((c=Ye.previousElementSibling)===null||c===void 0?void 0:c.getAttribute("data-type"))==="newline"&&(0,U.ED)(Ye,t.sv.element,A).start===1&&Ye.getAttribute("data-type").indexOf("code-block-")===-1)return A.setStart(Ye,0),A.extractContents(),Ye.textContent.trim()!==""?Ve(t):ze(t),n.preventDefault(),!0;if(ue&&(0,U.ED)(ue,t.sv.element,A).start===0&&ue.previousElementSibling){A.extractContents();var Ct=ue.previousElementSibling.lastElementChild;return Ct.getAttribute("data-type")==="newline"&&(Ct.remove(),Ct=ue.previousElementSibling.lastElementChild),Ct.getAttribute("data-type")!=="newline"&&(Ct.insertAdjacentHTML("afterend",ue.innerHTML),ue.remove()),ue.textContent.trim()!==""&&!(!((x=ue.previousElementSibling)===null||x===void 0)&&x.querySelector('[data-type="code-block-open-marker"]'))?Ve(t):(Ct.getAttribute("data-type")!=="newline"&&(A.selectNodeContents(Ct.lastChild),A.collapse(!1)),ze(t)),n.preventDefault(),!0}}return!1},De=l(873),nt=function(t){t.options.theme==="dark"?t.element.classList.add("vditor--dark"):t.element.classList.remove("vditor--dark")},ct=function(t){t.element.innerHTML="",t.element.classList.add("vditor"),t.options.rtl&&t.element.setAttribute("dir","rtl"),nt(t),(0,De.H)(t.options.preview.theme.current,t.options.preview.theme.path),typeof t.options.height=="number"?t.element.style.height=t.options.height+"px":t.element.style.height=t.options.height,typeof t.options.minHeight=="number"&&(t.element.style.minHeight=t.options.minHeight+"px"),typeof t.options.width=="number"?t.element.style.width=t.options.width+"px":t.element.style.width=t.options.width,t.element.appendChild(t.toolbar.element);var n=document.createElement("div");if(n.className="vditor-content",t.options.outline.position==="left"&&n.appendChild(t.outline.element),n.appendChild(t.wysiwyg.element.parentElement),n.appendChild(t.sv.element),n.appendChild(t.ir.element.parentElement),n.appendChild(t.preview.element),t.toolbar.elements.devtools&&n.appendChild(t.devtools.element),t.options.outline.position==="right"&&(t.outline.element.classList.add("vditor-outline--right"),n.appendChild(t.outline.element)),t.upload&&n.appendChild(t.upload.element),t.options.resize.enable&&n.appendChild(t.resize.element),n.appendChild(t.hint.element),n.appendChild(t.tip.element),t.element.appendChild(n),n.addEventListener("click",function(){T(t,["subToolbar"])}),t.toolbar.elements.export&&t.element.insertAdjacentHTML("beforeend",'<iframe id="vditorExportIframe" style="width: 100%;height: 0;border: 0"></iframe>'),Tn(t,t.options.mode,an(t)),document.execCommand("DefaultParagraphSeparator",!1,"p"),navigator.userAgent.indexOf("iPhone")>-1&&typeof window.visualViewport<"u"){var i=!1,a=function(o){i||(i=!0,requestAnimationFrame(function(){i=!1;var c=t.toolbar.element;c.style.transform="none",c.getBoundingClientRect().top<0&&(c.style.transform="translate(0, ".concat(-c.getBoundingClientRect().top,"px)"))}))};window.visualViewport.addEventListener("scroll",a),window.visualViewport.addEventListener("resize",a)}},dt=function(t){var n=window.innerWidth<=u.Y.MOBILE_WIDTH?10:35;if(t.wysiwyg.element.parentElement.style.display!=="none"){var i=(t.wysiwyg.element.parentElement.clientWidth-t.options.preview.maxWidth)/2;t.wysiwyg.element.style.padding="10px ".concat(Math.max(n,i),"px")}if(t.ir.element.parentElement.style.display!=="none"){var i=(t.ir.element.parentElement.clientWidth-t.options.preview.maxWidth)/2;t.ir.element.style.padding="10px ".concat(Math.max(n,i),"px")}t.preview.element.style.display!=="block"?t.toolbar.element.style.paddingLeft=Math.max(5,parseInt(t[t.currentMode].element.style.paddingLeft||"0",10)+(t.options.outline.position==="left"?t.outline.element.offsetWidth:0))+"px":t.toolbar.element.style.paddingLeft=5+(t.options.outline.position==="left"?t.outline.element.offsetWidth:0)+"px"},ft=function(t){if(t.options.typewriterMode){var n=window.innerHeight;typeof t.options.height=="number"?(n=t.options.height,typeof t.options.minHeight=="number"&&(n=Math.max(n,t.options.minHeight)),n=Math.min(window.innerHeight,n)):n=t.element.clientHeight,t.element.classList.contains("vditor--fullscreen")&&(n=window.innerHeight),t[t.currentMode].element.style.setProperty("--editor-bottom",(n-t.toolbar.element.offsetHeight)/2+"px")}},It;function _n(){window.removeEventListener("resize",It)}var an=function(t){ft(t),_n(),window.addEventListener("resize",It=function(){dt(t),ft(t)});var n=(0,f.D)()&&localStorage.getItem(t.options.cache.id);return(!t.options.cache.enable||!n)&&(t.options.value?n=t.options.value:t.originalInnerHTML?n=t.lute.HTML2Md(t.originalInnerHTML):t.options.cache.enable||(n="")),n||""},on=function(t){clearTimeout(t[t.currentMode].hlToolbarTimeoutId),t[t.currentMode].hlToolbarTimeoutId=window.setTimeout(function(){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"&&(0,U.Co)(t[t.currentMode].element)){b(t.toolbar.elements,u.Y.EDIT_TOOLBARS),E(t.toolbar.elements,u.Y.EDIT_TOOLBARS);var n=(0,U.RN)(t),i=n.startContainer;n.startContainer.nodeType===3&&(i=n.startContainer.parentElement),i.classList.contains("vditor-reset")&&(i=i.childNodes[n.startOffset]);var a=t.currentMode==="sv"?(0,v.Th)(i,"data-type","heading"):(0,D.c)(i);a&&y(t.toolbar.elements,["headings"]);var o=t.currentMode==="sv"?(0,v.Th)(i,"data-type","blockquote"):(0,v._Y)(i,"BLOCKQUOTE");o&&y(t.toolbar.elements,["quote"]);var c=(0,v.Th)(i,"data-type","strong");c&&y(t.toolbar.elements,["bold"]);var x=(0,v.Th)(i,"data-type","em");x&&y(t.toolbar.elements,["italic"]);var A=(0,v.Th)(i,"data-type","s");A&&y(t.toolbar.elements,["strike"]);var O=(0,v.Th)(i,"data-type","a");O&&y(t.toolbar.elements,["link"]);var L=(0,v._Y)(i,"LI");L?(L.classList.contains("vditor-task")?y(t.toolbar.elements,["check"]):L.parentElement.tagName==="OL"?y(t.toolbar.elements,["ordered-list"]):L.parentElement.tagName==="UL"&&y(t.toolbar.elements,["list"]),E(t.toolbar.elements,["outdent","indent"])):w(t.toolbar.elements,["outdent","indent"]);var B=(0,v.Th)(i,"data-type","code-block");B&&(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),y(t.toolbar.elements,["code"]));var K=(0,v.Th)(i,"data-type","code");K&&(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),y(t.toolbar.elements,["inline-code"]));var me=(0,v.Th)(i,"data-type","table");me&&w(t.toolbar.elements,["headings","list","ordered-list","check","line","quote","code","table"])}},200)},it=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),n.enableHint&&t.hint.render(t),clearTimeout(t.wysiwyg.afterRenderTimeoutId),t.wysiwyg.afterRenderTimeoutId=window.setTimeout(function(){if(!t.wysiwyg.composingLock){var i=S(t);typeof t.options.input=="function"&&n.enableInput&&t.options.input(i),t.options.counter.enable&&t.counter.render(t,i),t.options.cache.enable&&(0,f.D)()&&(localStorage.setItem(t.options.cache.id,i),t.options.cache.after&&t.options.cache.after(i)),t.devtools&&t.devtools.renderEchart(t),n.enableAddUndoStack&&t.undo.addToUndoStack(t)}},t.options.undoDelay)},Xt=function(t){for(var n=t.previousSibling;n;){if(n.nodeType!==3&&n.tagName==="A"&&!n.previousSibling&&n.innerHTML.replace(u.Y.ZWSP,"")===""&&n.nextSibling)return n;n=n.previousSibling}return!1},un=function(t){for(var n=t.startContainer.nextSibling;n&&n.textContent==="";)n=n.nextSibling;return!!(n&&n.nodeType!==3&&(n.tagName==="CODE"||n.getAttribute("data-type")==="math-inline"||n.getAttribute("data-type")==="html-entity"||n.getAttribute("data-type")==="html-inline"))},sn=function(t){for(var n="",i=t.nextSibling;i;)i.nodeType===3?n+=i.textContent:n+=i.outerHTML,i=i.nextSibling;return n},dn=function(t){for(var n="",i=t.previousSibling;i;)i.nodeType===3?n=i.textContent+n:n=i.outerHTML+n,i=i.previousSibling;return n},yn=function(t){for(var n=t;n&&!n.nextSibling;)n=n.parentElement;return n.nextSibling},cn=function(t){var n=dn(t.startContainer),i=sn(t.startContainer),a=t.startContainer.textContent,o=t.startOffset,c="",x="";return(a.substr(0,o)!==""&&a.substr(0,o)!==u.Y.ZWSP||n)&&(c="".concat(n).concat(a.substr(0,o))),(a.substr(o)!==""&&a.substr(o)!==u.Y.ZWSP||i)&&(x="".concat(a.substr(o)).concat(i)),{afterHTML:x,beforeHTML:c}},Ft=function(t,n){Array.from(t.wysiwyg.element.childNodes).find(function(i){if(i.nodeType===3){var a=document.createElement("p");a.setAttribute("data-block","0"),a.textContent=i.textContent;var o=n.startContainer.nodeType===3?n.startOffset:i.textContent.length;return i.parentNode.insertBefore(a,i),i.remove(),n.setStart(a.firstChild,Math.min(a.firstChild.textContent.length,o)),n.collapse(!0),(0,U.jl)(n),!0}else if(!i.getAttribute("data-block"))return i.tagName==="P"?i.remove():(i.tagName==="DIV"?(n.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>")):i.tagName==="BR"?i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"<wbr></p>"):(n.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"</p>")),(0,U.ir)(t.wysiwyg.element,n),n=getSelection().getRangeAt(0)),!0})},Dt=function(t,n){var i=(0,U.RN)(t),a=(0,v.pt)(i.startContainer);a||(a=i.startContainer.childNodes[i.startOffset]),!a&&t.wysiwyg.element.children.length===0&&(a=t.wysiwyg.element),a&&!a.classList.contains("vditor-wysiwyg__block")&&(i.insertNode(document.createElement("wbr")),a.innerHTML.trim()==="<wbr>"&&(a.innerHTML="<wbr><br>"),a.tagName==="BLOCKQUOTE"||a.classList.contains("vditor-reset")?a.innerHTML="<".concat(n,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(n,">"):a.outerHTML="<".concat(n,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(n,">"),(0,U.ir)(t.wysiwyg.element,i),oe(t))},ei=function(t){var n=getSelection().getRangeAt(0),i=(0,v.pt)(n.startContainer);i||(i=n.startContainer.childNodes[n.startOffset]),i&&(n.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>"),(0,U.ir)(t.wysiwyg.element,n)),t.wysiwyg.popover.style.display="none"},Ht=function(t,n,i){i===void 0&&(i=!0);var a=t.previousElementSibling,o=a.ownerDocument.createRange();a.tagName==="CODE"?(a.style.display="inline-block",i?o.setStart(a.firstChild,1):o.selectNodeContents(a)):(a.style.display="block",a.firstChild.firstChild||a.firstChild.appendChild(document.createTextNode("")),o.selectNodeContents(a.firstChild)),i?o.collapse(!0):o.collapse(!1),(0,U.jl)(o),!t.firstElementChild.classList.contains("language-mindmap")&&Xe(n)},Nt=function(t,n){if(t.wysiwyg.composingLock=n.isComposing,n.isComposing)return!1;n.key.indexOf("Arrow")===-1&&n.key!=="Meta"&&n.key!=="Control"&&n.key!=="Alt"&&n.key!=="Shift"&&n.key!=="CapsLock"&&n.key!=="Escape"&&!/^F\d{1,2}$/.test(n.key)&&t.undo.recordFirstPosition(t,n);var i=(0,U.RN)(t),a=i.startContainer;if(!ur(n,t,a)||(qi(i,t,n),Wn(i),n.key!=="Enter"&&n.key!=="Tab"&&n.key!=="Backspace"&&n.key.indexOf("Arrow")===-1&&!(0,f._0)(n)&&n.key!=="Escape"&&n.key!=="Delete"))return!1;var o=(0,v.pt)(a),c=(0,v._Y)(a,"P");if(jr(n,t,c,i)||Ti(i,t,c,n)||xe(t,n,i))return!0;var x=(0,v.KJ)(a,"vditor-wysiwyg__block");if(x){if(n.key==="Escape"&&x.children.length===2)return t.wysiwyg.popover.style.display="none",x.firstElementChild.style.display="none",t.wysiwyg.element.blur(),n.preventDefault(),!0;if(!(0,f._0)(n)&&!n.shiftKey&&n.altKey&&n.key==="Enter"&&x.getAttribute("data-type")==="code-block"){var A=t.wysiwyg.popover.querySelector(".vditor-input");return A.focus(),A.select(),n.preventDefault(),!0}if(x.getAttribute("data-block")==="0"&&(ot(t,n,x.firstElementChild,i)||mi(t,n,i,x.firstElementChild,x)||x.getAttribute("data-type")!=="yaml-front-matter"&&ii(t,n,i,x.firstElementChild,x)))return!0}if(_t(t,i,n,c))return!0;var O=(0,v.Ab)(a,"BLOCKQUOTE");if(O&&!n.shiftKey&&n.altKey&&n.key==="Enter"){(0,f._0)(n)?i.setStartBefore(O):i.setStartAfter(O),(0,U.jl)(i);var L=document.createElement("p");return L.setAttribute("data-block","0"),L.innerHTML=`
`,i.insertNode(L),i.collapse(!0),(0,U.jl)(i),it(t),Xe(t),n.preventDefault(),!0}var B=(0,D.c)(a);if(B){if(B.tagName==="H6"&&a.textContent.length===i.startOffset&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&n.key==="Enter"){var K=document.createElement("p");return K.textContent=`
`,K.setAttribute("data-block","0"),a.parentElement.insertAdjacentElement("afterend",K),i.setStart(K,0),(0,U.jl)(i),it(t),Xe(t),n.preventDefault(),!0}if(Z("⌘=",n)){var me=parseInt(B.tagName.substr(1),10)-1;return me>0&&(Dt(t,"h".concat(me)),it(t)),n.preventDefault(),!0}if(Z("⌘-",n)){var me=parseInt(B.tagName.substr(1),10)+1;return me<7&&(Dt(t,"h".concat(me)),it(t)),n.preventDefault(),!0}n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&B.textContent.length===1&&ei(t)}if(Gt(t,i,n))return!0;if(n.altKey&&n.key==="Enter"&&!(0,f._0)(n)&&!n.shiftKey){var pe=(0,v._Y)(a,"A"),fe=(0,v.Th)(a,"data-type","link-ref"),je=(0,v.Th)(a,"data-type","footnotes-ref");if(pe||fe||je||B&&B.tagName.length===2){var Se=t.wysiwyg.popover.querySelector("input");Se.focus(),Se.select()}}if(Vt(t,n))return!0;if(Z("⇧⌘U",n)){var ue=t.wysiwyg.popover.querySelector('[data-type="up"]');if(ue)return ue.click(),n.preventDefault(),!0}if(Z("⇧⌘D",n)){var ue=t.wysiwyg.popover.querySelector('[data-type="down"]');if(ue)return ue.click(),n.preventDefault(),!0}if(hr(t,i,n))return!0;if(!(0,f._0)(n)&&n.shiftKey&&!n.altKey&&n.key==="Enter"&&a.parentElement.tagName!=="LI"&&a.parentElement.tagName!=="P")return["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName)?i.insertNode(document.createTextNode(`
`+u.Y.ZWSP)):i.insertNode(document.createTextNode(`
`)),i.collapse(!1),(0,U.jl)(i),it(t),Xe(t),n.preventDefault(),!0;if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&i.toString()===""){if(Nn(t,i,n,c))return!0;if(o){if(o.previousElementSibling&&o.previousElementSibling.classList.contains("vditor-wysiwyg__block")&&o.previousElementSibling.getAttribute("data-block")==="0"&&o.tagName!=="UL"&&o.tagName!=="OL"){var Ye=(0,U.ED)(o,t.wysiwyg.element,i).start;if(Ye===0&&i.startOffset===0||Ye===1&&o.innerText.startsWith(u.Y.ZWSP))return Ht(o.previousElementSibling.lastElementChild,t,!1),o.innerHTML.trim().replace(u.Y.ZWSP,"")===""&&(o.remove(),it(t)),n.preventDefault(),!0}var He=i.startOffset;if(i.toString()===""&&a.nodeType===3&&a.textContent.charAt(He-2)===`
`&&a.textContent.charAt(He-1)!==u.Y.ZWSP&&["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName))return a.textContent=a.textContent.substring(0,He-1)+u.Y.ZWSP,i.setStart(a,He),i.collapse(!0),it(t),n.preventDefault(),!0;a.textContent===u.Y.ZWSP&&i.startOffset===1&&!a.previousSibling&&un(i)&&(a.textContent=""),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='math-inline']").forEach(function(Tt){Tt.firstElementChild.style.display="inline",Tt.lastElementChild.style.display="none"}),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='html-entity']").forEach(function(Tt){Tt.firstElementChild.style.display="inline",Tt.lastElementChild.style.display="none"})}}if((0,f.gm)()&&i.startOffset===1&&a.textContent.indexOf(u.Y.ZWSP)>-1&&a.previousSibling&&a.previousSibling.nodeType!==3&&a.previousSibling.tagName==="CODE"&&(n.key==="Backspace"||n.key==="ArrowLeft"))return i.selectNodeContents(a.previousSibling),i.collapse(!1),n.preventDefault(),!0;if(ri(n,o,i))return n.preventDefault(),!0;if(Rr(i,n.key),n.key==="ArrowDown"){var Ze=a.nextSibling;Ze&&Ze.nodeType!==3&&Ze.getAttribute("data-type")==="math-inline"&&i.setStartAfter(Ze)}return o&&Ae(o,t,n,i)?(n.preventDefault(),!0):!1},Vt=function(t,n){if(Z("⇧⌘X",n)){var i=t.wysiwyg.popover.querySelector('[data-type="remove"]');return i&&i.click(),n.preventDefault(),!0}},W=function(t){clearTimeout(t.wysiwyg.hlToolbarTimeoutId),t.wysiwyg.hlToolbarTimeoutId=window.setTimeout(function(){if(t.wysiwyg.element.getAttribute("contenteditable")!=="false"&&(0,U.Co)(t.wysiwyg.element)){b(t.toolbar.elements,u.Y.EDIT_TOOLBARS),E(t.toolbar.elements,u.Y.EDIT_TOOLBARS);var n=getSelection().getRangeAt(0),i=n.startContainer;n.startContainer.nodeType===3?i=n.startContainer.parentElement:i=i.childNodes[n.startOffset>=i.childNodes.length?i.childNodes.length-1:n.startOffset];var a=(0,v.Th)(i,"data-type","footnotes-block");if(a){t.wysiwyg.popover.innerHTML="",Fe(a,t),R(t,a);return}var o=(0,v._Y)(i,"LI");o?(o.classList.contains("vditor-task")?y(t.toolbar.elements,["check"]):o.parentElement.tagName==="OL"?y(t.toolbar.elements,["ordered-list"]):o.parentElement.tagName==="UL"&&y(t.toolbar.elements,["list"]),E(t.toolbar.elements,["outdent","indent"])):w(t.toolbar.elements,["outdent","indent"]),(0,v._Y)(i,"BLOCKQUOTE")&&y(t.toolbar.elements,["quote"]),((0,v._Y)(i,"B")||(0,v._Y)(i,"STRONG"))&&y(t.toolbar.elements,["bold"]),((0,v._Y)(i,"I")||(0,v._Y)(i,"EM"))&&y(t.toolbar.elements,["italic"]),((0,v._Y)(i,"STRIKE")||(0,v._Y)(i,"S"))&&y(t.toolbar.elements,["strike"]),t.wysiwyg.element.querySelectorAll(".vditor-comment--focus").forEach(function(Ne){Ne.classList.remove("vditor-comment--focus")});var c=(0,v.KJ)(i,"vditor-comment");if(c){var x=c.getAttribute("data-cmtids").split(" ");if(x.length>1&&c.nextSibling.isSameNode(c.nextElementSibling)){var A=c.nextElementSibling.getAttribute("data-cmtids").split(" ");x.find(function(Ne){if(A.includes(Ne))return x=[Ne],!0})}t.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(Ne){Ne.getAttribute("data-cmtids").indexOf(x[0])>-1&&Ne.classList.add("vditor-comment--focus")})}var O=(0,v._Y)(i,"A");O&&y(t.toolbar.elements,["link"]);var L=(0,v._Y)(i,"TABLE"),B=(0,D.c)(i);(0,v._Y)(i,"CODE")?(0,v._Y)(i,"PRE")?(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),y(t.toolbar.elements,["code"])):(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),y(t.toolbar.elements,["inline-code"])):B?(w(t.toolbar.elements,["bold"]),y(t.toolbar.elements,["headings"])):L&&w(t.toolbar.elements,["table"]);var K=(0,v.KJ)(i,"vditor-toc");if(K){t.wysiwyg.popover.innerHTML="",Fe(K,t),R(t,K);return}var me=(0,D.f)(i,"BLOCKQUOTE");if(me&&(t.wysiwyg.popover.innerHTML="",ie(n,me,t),Oe(n,me,t),Fe(me,t),R(t,me)),o&&(t.wysiwyg.popover.innerHTML="",ie(n,o,t),Oe(n,o,t),Fe(o,t),R(t,o)),L){t.options.lang,t.options,t.wysiwyg.popover.innerHTML="";var pe=function(){var Ne=L.rows.length,ht=L.rows[0].cells.length,vi=parseInt(Wt.value,10)||Ne,bi=parseInt(kn.value,10)||ht;if(!(vi===Ne&&ht===bi)){if(ht!==bi)for(var mr=bi-ht,Yn=0;Yn<L.rows.length;Yn++)if(mr>0)for(var po=0;po<mr;po++)Yn===0?L.rows[Yn].lastElementChild.insertAdjacentHTML("afterend","<th> </th>"):L.rows[Yn].lastElementChild.insertAdjacentHTML("afterend","<td> </td>");else for(var va=ht-1;va>=bi;va--)L.rows[Yn].cells[va].remove();if(Ne!==vi){var mo=vi-Ne;if(mo>0){for(var ba="<tr>",Gi=0;Gi<bi;Gi++)ba+="<td> </td>";for(var go=0;go<mo;go++)L.querySelector("tbody")?L.querySelector("tbody").insertAdjacentHTML("beforeend",ba):L.querySelector("thead").insertAdjacentHTML("afterend",ba+"</tr>")}else for(var Gi=Ne-1;Gi>=vi;Gi--)L.rows[Gi].remove(),L.rows.length===1&&L.querySelector("tbody").remove()}typeof t.options.input=="function"&&t.options.input(S(t))}},fe=function(Ne){Ci(L,Ne),Ne==="right"?(Ye.classList.remove("vditor-icon--current"),He.classList.remove("vditor-icon--current"),Ze.classList.add("vditor-icon--current")):Ne==="center"?(Ye.classList.remove("vditor-icon--current"),Ze.classList.remove("vditor-icon--current"),He.classList.add("vditor-icon--current")):(He.classList.remove("vditor-icon--current"),Ze.classList.remove("vditor-icon--current"),Ye.classList.add("vditor-icon--current")),(0,U.jl)(n),it(t)},je=(0,v._Y)(i,"TD"),Se=(0,v._Y)(i,"TH"),ue="left";je?ue=je.getAttribute("align")||"left":Se&&(ue=Se.getAttribute("align")||"center");var Ye=document.createElement("button");Ye.setAttribute("type","button"),Ye.setAttribute("aria-label",window.VditorI18n.alignLeft+"<"+(0,f.fG)("⇧⌘L")+">"),Ye.setAttribute("data-type","left"),Ye.innerHTML='<svg><use xlink:href="#vditor-icon-align-left"></use></svg>',Ye.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ue==="left"?" vditor-icon--current":""),Ye.onclick=function(){fe("left")};var He=document.createElement("button");He.setAttribute("type","button"),He.setAttribute("aria-label",window.VditorI18n.alignCenter+"<"+(0,f.fG)("⇧⌘C")+">"),He.setAttribute("data-type","center"),He.innerHTML='<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',He.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ue==="center"?" vditor-icon--current":""),He.onclick=function(){fe("center")};var Ze=document.createElement("button");Ze.setAttribute("type","button"),Ze.setAttribute("aria-label",window.VditorI18n.alignRight+"<"+(0,f.fG)("⇧⌘R")+">"),Ze.setAttribute("data-type","right"),Ze.innerHTML='<svg><use xlink:href="#vditor-icon-align-right"></use></svg>',Ze.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(ue==="right"?" vditor-icon--current":""),Ze.onclick=function(){fe("right")};var Tt=document.createElement("button");Tt.setAttribute("type","button"),Tt.setAttribute("aria-label",window.VditorI18n.insertRowBelow+"<"+(0,f.fG)("⌘=")+">"),Tt.setAttribute("data-type","insertRow"),Tt.innerHTML='<svg><use xlink:href="#vditor-icon-insert-row"></use></svg>',Tt.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Tt.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ht=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ht&&j(t,n,ht)};var Ct=document.createElement("button");Ct.setAttribute("type","button"),Ct.setAttribute("aria-label",window.VditorI18n.insertRowAbove+"<"+(0,f.fG)("⇧⌘F")+">"),Ct.setAttribute("data-type","insertRow"),Ct.innerHTML='<svg><use xlink:href="#vditor-icon-insert-rowb"></use></svg>',Ct.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Ct.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ht=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ht&&P(t,n,ht)};var At=document.createElement("button");At.setAttribute("type","button"),At.setAttribute("aria-label",window.VditorI18n.insertColumnRight+"<"+(0,f.fG)("⇧⌘=")+">"),At.setAttribute("data-type","insertColumn"),At.innerHTML='<svg><use xlink:href="#vditor-icon-insert-column"></use></svg>',At.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",At.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ht=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ht&&q(t,L,ht)};var pn=document.createElement("button");pn.setAttribute("type","button"),pn.setAttribute("aria-label",window.VditorI18n.insertColumnLeft+"<"+(0,f.fG)("⇧⌘G")+">"),pn.setAttribute("data-type","insertColumn"),pn.innerHTML='<svg><use xlink:href="#vditor-icon-insert-columnb"></use></svg>',pn.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",pn.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ht=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ht&&q(t,L,ht,"beforebegin")};var nn=document.createElement("button");nn.setAttribute("type","button"),nn.setAttribute("aria-label",window.VditorI18n["delete-row"]+"<"+(0,f.fG)("⌘-")+">"),nn.setAttribute("data-type","deleteRow"),nn.innerHTML='<svg><use xlink:href="#vditor-icon-delete-row"></use></svg>',nn.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",nn.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ht=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ht&&Q(t,n,ht)};var mn=document.createElement("button");mn.setAttribute("type","button"),mn.setAttribute("aria-label",window.VditorI18n["delete-column"]+"<"+(0,f.fG)("⇧⌘-")+">"),mn.setAttribute("data-type","deleteColumn"),mn.innerHTML='<svg><use xlink:href="#vditor-icon-delete-column"></use></svg>',mn.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",mn.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ht=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ht&&we(t,n,L,ht)};var st=document.createElement("span");st.setAttribute("aria-label",window.VditorI18n.row),st.className="vditor-tooltipped vditor-tooltipped__n";var Wt=document.createElement("input");st.appendChild(Wt),Wt.type="number",Wt.min="1",Wt.className="vditor-input",Wt.style.width="42px",Wt.style.textAlign="center",Wt.setAttribute("placeholder",window.VditorI18n.row),Wt.value=L.rows.length.toString(),Wt.oninput=function(){pe()},Wt.onkeydown=function(Ne){if(!Ne.isComposing){if(Ne.key==="Tab"){kn.focus(),kn.select(),Ne.preventDefault();return}Vt(t,Ne)||pt(Ne,n)}};var $r=document.createElement("span");$r.setAttribute("aria-label",window.VditorI18n.column),$r.className="vditor-tooltipped vditor-tooltipped__n";var kn=document.createElement("input");$r.appendChild(kn),kn.type="number",kn.min="1",kn.className="vditor-input",kn.style.width="42px",kn.style.textAlign="center",kn.setAttribute("placeholder",window.VditorI18n.column),kn.value=L.rows[0].cells.length.toString(),kn.oninput=function(){pe()},kn.onkeydown=function(Ne){if(!Ne.isComposing){if(Ne.key==="Tab"){Wt.focus(),Wt.select(),Ne.preventDefault();return}Vt(t,Ne)||pt(Ne,n)}},ie(n,L,t),Oe(n,L,t),Fe(L,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",Ye),t.wysiwyg.popover.insertAdjacentElement("beforeend",He),t.wysiwyg.popover.insertAdjacentElement("beforeend",Ze),t.wysiwyg.popover.insertAdjacentElement("beforeend",Ct),t.wysiwyg.popover.insertAdjacentElement("beforeend",Tt),t.wysiwyg.popover.insertAdjacentElement("beforeend",pn),t.wysiwyg.popover.insertAdjacentElement("beforeend",At),t.wysiwyg.popover.insertAdjacentElement("beforeend",nn),t.wysiwyg.popover.insertAdjacentElement("beforeend",mn),t.wysiwyg.popover.insertAdjacentElement("beforeend",st),t.wysiwyg.popover.insertAdjacentHTML("beforeend"," x "),t.wysiwyg.popover.insertAdjacentElement("beforeend",$r),R(t,L)}var ga=(0,v.Th)(i,"data-type","link-ref");ga&&ne(t,ga,n);var Yi=(0,v.Th)(i,"data-type","footnotes-ref");if(Yi){t.options.lang,t.options,t.wysiwyg.popover.innerHTML="";var st=document.createElement("span");st.setAttribute("aria-label",window.VditorI18n.footnoteRef+"<"+(0,f.fG)("⌥Enter")+">"),st.className="vditor-tooltipped vditor-tooltipped__n";var oi=document.createElement("input");st.appendChild(oi),oi.className="vditor-input",oi.setAttribute("placeholder",window.VditorI18n.footnoteRef+"<"+(0,f.fG)("⌥Enter")+">"),oi.style.width="120px",oi.value=Yi.getAttribute("data-footnotes-label"),oi.oninput=function(){oi.value.trim()!==""&&Yi.setAttribute("data-footnotes-label",oi.value),typeof t.options.input=="function"&&t.options.input(S(t))},oi.onkeydown=function(ht){ht.isComposing||Vt(t,ht)||pt(ht,n)},Fe(Yi,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",st),R(t,Yi)}var Zt=(0,v.KJ)(i,"vditor-wysiwyg__block"),fo=Zt?Zt.getAttribute("data-type").indexOf("block")>-1:!1;if(t.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(Ne){if(!Zt||Zt&&fo&&!Zt.contains(Ne)){var ht=Ne.previousElementSibling;ht.style.display="none"}}),Zt&&fo){if(t.wysiwyg.popover.innerHTML="",ie(n,Zt,t),Oe(n,Zt,t),Fe(Zt,t),Zt.getAttribute("data-type")==="code-block"){var Br=document.createElement("span");Br.setAttribute("aria-label",window.VditorI18n.language+"<"+(0,f.fG)("⌥Enter")+">"),Br.className="vditor-tooltipped vditor-tooltipped__n";var Bn=document.createElement("input");Br.appendChild(Bn);var pr=Zt.firstElementChild.firstElementChild;Bn.className="vditor-input",Bn.setAttribute("placeholder",window.VditorI18n.language+"<"+(0,f.fG)("⌥Enter")+">"),Bn.value=pr.className.indexOf("language-")>-1?pr.className.split("-")[1].split(" ")[0]:"",Bn.oninput=function(Ne){Bn.value.trim()!==""?pr.className="language-".concat(Bn.value):(pr.className="",t.hint.recentLanguage=""),Zt.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(Zt.lastElementChild.innerHTML=Zt.firstElementChild.innerHTML,tt(Zt.lastElementChild,t)),it(t),Ne.detail===1&&(n.setStart(pr.firstChild,0),n.collapse(!0),(0,U.jl)(n))},Bn.onkeydown=function(Ne){if(!Ne.isComposing&&!Vt(t,Ne)){if(Ne.key==="Escape"&&t.hint.element.style.display==="block"){t.hint.element.style.display="none",Ne.preventDefault();return}t.hint.select(Ne,t),pt(Ne,n)}},Bn.onkeyup=function(Ne){var ht,vi;if(!(Ne.isComposing||Ne.key==="Enter"||Ne.key==="ArrowUp"||Ne.key==="Escape"||Ne.key==="ArrowDown")){var bi=[],mr=Bn.value.substring(0,Bn.selectionStart);(t.options.preview.hljs.langs||u.Y.ALIAS_CODE_LANGUAGES.concat(((vi=(ht=window.hljs)===null||ht===void 0?void 0:ht.listLanguages())!==null&&vi!==void 0?vi:[]).sort())).forEach(function(Yn){Yn.indexOf(mr.toLowerCase())>-1&&bi.push({html:Yn,value:Yn})}),t.hint.genHTML(bi,mr,t),Ne.preventDefault()}},t.wysiwyg.popover.insertAdjacentElement("beforeend",Br)}R(t,Zt)}else Zt=void 0;if(B){t.wysiwyg.popover.innerHTML="";var st=document.createElement("span");st.setAttribute("aria-label","ID<"+(0,f.fG)("⌥Enter")+">"),st.className="vditor-tooltipped vditor-tooltipped__n";var gi=document.createElement("input");st.appendChild(gi),gi.className="vditor-input",gi.setAttribute("placeholder","ID<"+(0,f.fG)("⌥Enter")+">"),gi.style.width="120px",gi.value=B.getAttribute("data-id")||"",gi.oninput=function(){B.setAttribute("data-id",gi.value),typeof t.options.input=="function"&&t.options.input(S(t))},gi.onkeydown=function(ht){ht.isComposing||Vt(t,ht)||pt(ht,n)},ie(n,B,t),Oe(n,B,t),Fe(B,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",st),R(t,B)}if(O&&jt(t,O,n),!me&&!o&&!L&&!Zt&&!O&&!ga&&!Yi&&!B&&!K){var Ki=(0,v.Th)(i,"data-block","0");Ki&&Ki.parentElement.isEqualNode(t.wysiwyg.element)?(t.wysiwyg.popover.innerHTML="",ie(n,Ki,t),Oe(n,Ki,t),Fe(Ki,t),R(t,Ki)):t.wysiwyg.popover.style.display="none"}t.wysiwyg.element.querySelectorAll('span[data-type="backslash"] > span').forEach(function(Ne){Ne.style.display="none"});var ho=(0,v.Th)(n.startContainer,"data-type","backslash");ho&&(ho.querySelector("span").style.display="inline")}},200)},R=function(t,n){var i=n,a=(0,v._Y)(n,"TABLE");a&&(i=a),t.wysiwyg.popover.style.left="0",t.wysiwyg.popover.style.display="block",t.wysiwyg.popover.style.top=Math.max(-8,i.offsetTop-21-t.wysiwyg.element.scrollTop)+"px",t.wysiwyg.popover.style.left=Math.min(i.offsetLeft,t.wysiwyg.element.clientWidth-t.wysiwyg.popover.clientWidth)+"px",t.wysiwyg.popover.setAttribute("data-top",(i.offsetTop-21).toString())},ne=function(t,n,i){i===void 0&&(i=getSelection().getRangeAt(0)),t.wysiwyg.popover.innerHTML="";var a=function(){c.value.trim()!==""&&(n.tagName==="IMG"?n.setAttribute("alt",c.value):n.textContent=c.value),A.value.trim()!==""&&n.setAttribute("data-link-label",A.value),typeof t.options.input=="function"&&t.options.input(S(t))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");o.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),c.style.width="120px",c.value=n.getAttribute("alt")||n.textContent,c.oninput=function(){a()},c.onkeydown=function(O){Vt(t,O)||pt(O,i)||et(t,n,O,A)};var x=document.createElement("span");x.setAttribute("aria-label",window.VditorI18n.linkRef),x.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");x.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.linkRef),A.value=n.getAttribute("data-link-label"),A.oninput=function(){a()},A.onkeydown=function(O){Vt(t,O)||pt(O,i)||et(t,n,O,c)},Fe(n,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",o),t.wysiwyg.popover.insertAdjacentElement("beforeend",x),R(t,n)},ie=function(t,n,i){var a=n.previousElementSibling;if(!(!a||!n.parentElement.isEqualNode(i.wysiwyg.element)&&n.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","up"),o.setAttribute("aria-label",window.VditorI18n.up+"<"+(0,f.fG)("⇧⌘U")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-up"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){t.insertNode(document.createElement("wbr")),a.insertAdjacentElement("beforebegin",n),(0,U.ir)(i.wysiwyg.element,t),it(i),W(i),Xe(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},Oe=function(t,n,i){var a=n.nextElementSibling;if(!(!a||!n.parentElement.isEqualNode(i.wysiwyg.element)&&n.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","down"),o.setAttribute("aria-label",window.VditorI18n.down+"<"+(0,f.fG)("⇧⌘D")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-down"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){t.insertNode(document.createElement("wbr")),a.insertAdjacentElement("afterend",n),(0,U.ir)(i.wysiwyg.element,t),it(i),W(i),Xe(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},Fe=function(t,n){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-type","remove"),i.setAttribute("aria-label",window.VditorI18n.remove+"<"+(0,f.fG)("⇧⌘X")+">"),i.innerHTML='<svg><use xlink:href="#vditor-icon-trashcan"></use></svg>',i.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",i.onclick=function(){var a=(0,U.RN)(n);a.setStartAfter(t),(0,U.jl)(a),t.remove(),it(n),W(n),["H1","H2","H3","H4","H5","H6"].includes(t.tagName)&&oe(n)},n.wysiwyg.popover.insertAdjacentElement("beforeend",i)},et=function(t,n,i,a){if(!i.isComposing){if(i.key==="Tab"){a.focus(),a.select(),i.preventDefault();return}if(!(0,f._0)(i)&&!i.shiftKey&&i.altKey&&i.key==="Enter"){var o=(0,U.RN)(t);n.insertAdjacentHTML("afterend",u.Y.ZWSP),o.setStartAfter(n.nextSibling),o.collapse(!0),(0,U.jl)(o),i.preventDefault()}}},jt=function(t,n,i){t.wysiwyg.popover.innerHTML="";var a=function(){c.value.trim()!==""&&(n.innerHTML=c.value),n.setAttribute("href",A.value),n.setAttribute("title",L.value),it(t)};n.querySelectorAll("[data-marker]").forEach(function(B){B.removeAttribute("data-marker")});var o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");o.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),c.style.width="120px",c.value=n.innerHTML||"",c.oninput=function(){a()},c.onkeydown=function(B){Vt(t,B)||pt(B,i)||et(t,n,B,A)};var x=document.createElement("span");x.setAttribute("aria-label",window.VditorI18n.link),x.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");x.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.link),A.value=n.getAttribute("href")||"",A.oninput=function(){a()},A.onkeydown=function(B){Vt(t,B)||pt(B,i)||et(t,n,B,L)};var O=document.createElement("span");O.setAttribute("aria-label",window.VditorI18n.tooltipText),O.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");O.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.tooltipText),L.style.width="60px",L.value=n.getAttribute("title")||"",L.oninput=function(){a()},L.onkeydown=function(B){Vt(t,B)||pt(B,i)||et(t,n,B,c)},Fe(n,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",o),t.wysiwyg.popover.insertAdjacentElement("beforeend",x),t.wysiwyg.popover.insertAdjacentElement("beforeend",O),R(t,n)},ge=function(t,n){var i=t.target;n.wysiwyg.popover.innerHTML="";var a=function(){i.setAttribute("src",c.value),i.setAttribute("alt",A.value),i.setAttribute("title",L.value),typeof n.options.input=="function"&&n.options.input(S(n))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.imageURL),o.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");o.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.imageURL),c.value=i.getAttribute("src")||"",c.oninput=function(){a()},c.onkeydown=function(B){Vt(n,B)};var x=document.createElement("span");x.setAttribute("aria-label",window.VditorI18n.alternateText),x.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");x.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.alternateText),A.style.width="52px",A.value=i.getAttribute("alt")||"",A.oninput=function(){a()},A.onkeydown=function(B){Vt(n,B)};var O=document.createElement("span");O.setAttribute("aria-label",window.VditorI18n.title),O.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");O.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.title),L.value=i.getAttribute("title")||"",L.oninput=function(){a()},L.onkeydown=function(B){Vt(n,B)},Fe(i,n),n.wysiwyg.popover.insertAdjacentElement("beforeend",o),n.wysiwyg.popover.insertAdjacentElement("beforeend",x),n.wysiwyg.popover.insertAdjacentElement("beforeend",O),R(n,i)},pt=function(t,n){if(!(0,f._0)(t)&&!t.shiftKey&&t.key==="Enter"||t.key==="Escape")return n&&(0,U.jl)(n),t.preventDefault(),t.stopPropagation(),!0},mt=function(t){t.currentMode==="wysiwyg"?W(t):t.currentMode==="ir"&&on(t)},Mt=function(t,n,i){i===void 0&&(i={enableAddUndoStack:!0,enableHint:!1,enableInput:!0});var a=t.wysiwyg.element;a.innerHTML=t.lute.Md2VditorDOM(n),a.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(o){tt(o,t),o.previousElementSibling.setAttribute("style","display:none")}),it(t,i)},fn=function(t,n,i){for(var a=t.startContainer.parentElement,o=!1,c="",x="",A=cn(t),O=A.beforeHTML,L=A.afterHTML;a&&!o;){var B=a.tagName;if(B==="STRIKE"&&(B="S"),B==="I"&&(B="EM"),B==="B"&&(B="STRONG"),B==="S"||B==="STRONG"||B==="EM"){var K="",me="",pe="";a.parentElement.getAttribute("data-block")!=="0"&&(me=dn(a),pe=sn(a)),(O||me)&&(K="".concat(me,"<").concat(B,">").concat(O,"</").concat(B,">"),O=K),(i==="bold"&&B==="STRONG"||i==="italic"&&B==="EM"||i==="strikeThrough"&&B==="S")&&(K+="".concat(c).concat(u.Y.ZWSP,"<wbr>").concat(x),o=!0),(L||pe)&&(L="<".concat(B,">").concat(L,"</").concat(B,">").concat(pe),K+=L),a.parentElement.getAttribute("data-block")!=="0"?(a=a.parentElement,a.innerHTML=K):(a.outerHTML=K,a=a.parentElement),c="<".concat(B,">")+c,x="</".concat(B,">")+x}else o=!0}(0,U.ir)(n.wysiwyg.element,t)},yt=function(t,n,i){if(!(t.wysiwyg.composingLock&&i instanceof CustomEvent)){var a=!0,o=!0;t.wysiwyg.element.querySelector("wbr")&&t.wysiwyg.element.querySelector("wbr").remove();var c=(0,U.RN)(t),x=n.getAttribute("data-type");if(n.classList.contains("vditor-menu--current"))if(x==="strike"&&(x="strikeThrough"),x==="quote"){var A=(0,v._Y)(c.startContainer,"BLOCKQUOTE");A||(A=c.startContainer.childNodes[c.startOffset]),A&&(a=!1,n.classList.remove("vditor-menu--current"),c.insertNode(document.createElement("wbr")),A.outerHTML=A.innerHTML.trim()===""?'<p data-block="0">'.concat(A.innerHTML,"</p>"):A.innerHTML,(0,U.ir)(t.wysiwyg.element,c))}else if(x==="inline-code"){var O=(0,v._Y)(c.startContainer,"CODE");O||(O=c.startContainer.childNodes[c.startOffset]),O&&(O.outerHTML=O.innerHTML.replace(u.Y.ZWSP,"")+"<wbr>",(0,U.ir)(t.wysiwyg.element,c))}else x==="link"?(c.collapsed&&c.selectNode(c.startContainer.parentElement),document.execCommand("unlink",!1,"")):x==="check"||x==="list"||x==="ordered-list"?(xi(t,c,x),(0,U.ir)(t.wysiwyg.element,c),a=!1,n.classList.remove("vditor-menu--current")):(a=!1,n.classList.remove("vditor-menu--current"),c.toString()===""?fn(c,t,x):document.execCommand(x,!1,""));else{t.wysiwyg.element.childNodes.length===0&&(t.wysiwyg.element.innerHTML='<p data-block="0"><wbr></p>',(0,U.ir)(t.wysiwyg.element,c));var L=(0,v.pt)(c.startContainer);if(x==="quote"){if(L||(L=c.startContainer.childNodes[c.startOffset]),L){a=!1,n.classList.add("vditor-menu--current"),c.insertNode(document.createElement("wbr"));var B=(0,v._Y)(c.startContainer,"LI");B&&L.contains(B)?B.innerHTML='<blockquote data-block="0">'.concat(B.innerHTML,"</blockquote>"):L.outerHTML='<blockquote data-block="0">'.concat(L.outerHTML,"</blockquote>"),(0,U.ir)(t.wysiwyg.element,c)}}else if(x==="check"||x==="list"||x==="ordered-list")xi(t,c,x,!1),(0,U.ir)(t.wysiwyg.element,c),a=!1,b(t.toolbar.elements,["check","list","ordered-list"]),n.classList.add("vditor-menu--current");else if(x==="inline-code"){if(c.toString()===""){var K=document.createElement("code");K.textContent=u.Y.ZWSP,c.insertNode(K),c.setStart(K.firstChild,1),c.collapse(!0),(0,U.jl)(c)}else if(c.startContainer.nodeType===3){var K=document.createElement("code");c.surroundContents(K),c.insertNode(K),(0,U.jl)(c)}n.classList.add("vditor-menu--current")}else if(x==="code"){var K=document.createElement("div");K.className="vditor-wysiwyg__block",K.setAttribute("data-type","code-block"),K.setAttribute("data-block","0"),K.setAttribute("data-marker","```"),c.toString()===""?K.innerHTML=`<pre><code><wbr>
</code></pre>`:(K.innerHTML="<pre><code>".concat(c.toString(),"<wbr></code></pre>"),c.deleteContents()),c.insertNode(K),L&&(L.outerHTML=t.lute.SpinVditorDOM(L.outerHTML)),(0,U.ir)(t.wysiwyg.element,c),t.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(Tt){tt(Tt,t)}),n.classList.add("vditor-menu--disabled")}else if(x==="link"){if(c.toString()===""){var me=document.createElement("a");me.innerText=u.Y.ZWSP,c.insertNode(me),c.setStart(me.firstChild,1),c.collapse(!0),jt(t,me,c);var pe=t.wysiwyg.popover.querySelector("input");pe.value="",pe.focus(),o=!1}else{var K=document.createElement("a");K.setAttribute("href",""),K.innerHTML=c.toString(),c.surroundContents(K),c.insertNode(K),(0,U.jl)(c),jt(t,K,c);var fe=t.wysiwyg.popover.querySelectorAll("input");fe[0].value=K.innerText,fe[1].focus()}a=!1,n.classList.add("vditor-menu--current")}else if(x==="table"){var je='<table data-block="0"><thead><tr><th>col1<wbr></th><th>col2</th><th>col3</th></tr></thead><tbody><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></tbody></table>';if(c.toString().trim()==="")L&&L.innerHTML.trim().replace(u.Y.ZWSP,"")===""?L.outerHTML=je:document.execCommand("insertHTML",!1,je),c.selectNode(t.wysiwyg.element.querySelector("wbr").previousSibling),t.wysiwyg.element.querySelector("wbr").remove(),(0,U.jl)(c);else{je='<table data-block="0"><thead><tr>';var Se=c.toString().split(`
`),ue=Se[0].split(",").length>Se[0].split("	").length?",":"	";Se.forEach(function(Ze,Tt){Tt===0?(Ze.split(ue).forEach(function(Ct,At){At===0?je+="<th>".concat(Ct,"<wbr></th>"):je+="<th>".concat(Ct,"</th>")}),je+="</tr></thead>"):(Tt===1?je+="<tbody><tr>":je+="<tr>",Ze.split(ue).forEach(function(Ct){je+="<td>".concat(Ct,"</td>")}),je+="</tr>")}),je+="</tbody></table>",document.execCommand("insertHTML",!1,je),(0,U.ir)(t.wysiwyg.element,c)}a=!1,n.classList.add("vditor-menu--disabled")}else if(x==="line"){if(L){var Ye=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;L.innerHTML.trim()===""?L.outerHTML=Ye:L.insertAdjacentHTML("afterend",Ye),(0,U.ir)(t.wysiwyg.element,c)}}else if(a=!1,n.classList.add("vditor-menu--current"),x==="strike"&&(x="strikeThrough"),c.toString()===""&&(x==="bold"||x==="italic"||x==="strikeThrough")){var He="strong";x==="italic"?He="em":x==="strikeThrough"&&(He="s");var K=document.createElement(He);K.textContent=u.Y.ZWSP,c.insertNode(K),K.previousSibling&&K.previousSibling.textContent===u.Y.ZWSP&&(K.previousSibling.textContent=""),c.setStart(K.firstChild,1),c.collapse(!0),(0,U.jl)(c)}else document.execCommand(x,!1,"")}a&&W(t),o&&it(t)}},wt=function(){function t(n,i){var a,o=this;this.element=document.createElement("div"),i.className&&(a=this.element.classList).add.apply(a,i.className.split(" "));var c=i.hotkey?" <".concat((0,f.fG)(i.hotkey),">"):"";i.level===2&&(c=i.hotkey?" &lt;".concat((0,f.fG)(i.hotkey),"&gt;"):"");var x=i.tip?i.tip+c:"".concat(window.VditorI18n[i.name]).concat(c),A=i.name==="upload"?"div":"button";if(i.level===2)this.element.innerHTML="<".concat(A,' data-type="').concat(i.name,'">').concat(x,"</").concat(A,">");else{this.element.classList.add("vditor-toolbar__item");var O=document.createElement(A);O.setAttribute("data-type",i.name),O.className="vditor-tooltipped vditor-tooltipped__".concat(i.tipPosition),O.setAttribute("aria-label",x),O.innerHTML=i.icon,this.element.appendChild(O)}i.prefix&&this.element.children[0].addEventListener((0,f.y3)(),function(L){L.preventDefault(),!o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)&&(n.currentMode==="wysiwyg"?yt(n,o.element.children[0],L):n.currentMode==="ir"?ao(n,o.element.children[0],i.prefix||"",i.suffix||""):Be(n,o.element.children[0],i.prefix||"",i.suffix||""))})}return t}(),wn=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Tn=function(t,n,i){var a;if(typeof i!="string"?(T(t,["subToolbar","hint"]),i.preventDefault(),a=S(t)):a=i,!(t.currentMode===n&&typeof i!="string")){if(t.devtools&&t.devtools.renderEchart(t),t.options.preview.mode==="both"&&n==="sv"?t.preview.element.style.display="block":t.preview.element.style.display="none",E(t.toolbar.elements,u.Y.EDIT_TOOLBARS),b(t.toolbar.elements,u.Y.EDIT_TOOLBARS),w(t.toolbar.elements,["outdent","indent"]),n==="ir")C(t.toolbar.elements,["both"]),_(t.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),t.sv.element.style.display="none",t.wysiwyg.element.parentElement.style.display="none",t.ir.element.parentElement.style.display="block",t.lute.SetVditorIR(!0),t.lute.SetVditorWYSIWYG(!1),t.lute.SetVditorSV(!1),t.currentMode="ir",t.ir.element.innerHTML=t.lute.Md2VditorIRDOM(a),Ot(t,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),dt(t),t.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(c){tt(c,t)}),t.ir.element.querySelectorAll(".vditor-toc").forEach(function(c){(0,de.T)(c,{cdn:t.options.cdn,math:t.options.preview.math})});else if(n==="wysiwyg")C(t.toolbar.elements,["both"]),_(t.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),t.sv.element.style.display="none",t.wysiwyg.element.parentElement.style.display="block",t.ir.element.parentElement.style.display="none",t.lute.SetVditorIR(!1),t.lute.SetVditorWYSIWYG(!0),t.lute.SetVditorSV(!1),t.currentMode="wysiwyg",dt(t),Mt(t,a,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),t.wysiwyg.element.querySelectorAll(".vditor-toc").forEach(function(c){(0,de.T)(c,{cdn:t.options.cdn,math:t.options.preview.math})}),t.wysiwyg.popover.style.display="none";else if(n==="sv"){_(t.toolbar.elements,["both"]),C(t.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),t.wysiwyg.element.parentElement.style.display="none",t.ir.element.parentElement.style.display="none",(t.options.preview.mode==="both"||t.options.preview.mode==="editor")&&(t.sv.element.style.display="block"),t.lute.SetVditorIR(!1),t.lute.SetVditorWYSIWYG(!1),t.lute.SetVditorSV(!0),t.currentMode="sv";var o=Ee(a,t);o==="<div data-block='0'></div>"&&(o=""),t.sv.element.innerHTML=o,lt(t.sv.element),ze(t,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),dt(t)}t.undo.resetIcon(t),typeof i!="string"&&(t[t.currentMode].element.focus(),mt(t)),oe(t),ft(t),t.toolbar.elements["edit-mode"]&&(t.toolbar.elements["edit-mode"].querySelectorAll("button").forEach(function(c){c.classList.remove("vditor-menu--current")}),t.toolbar.elements["edit-mode"].querySelector('button[data-mode="'.concat(t.currentMode,'"]')).classList.add("vditor-menu--current")),t.outline.toggle(t,t.currentMode!=="sv"&&t.options.outline.enable,typeof i!="string")}},Kt=function(t){wn(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=document.createElement("div");return c.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),c.innerHTML='<button data-mode="wysiwyg">'.concat(window.VditorI18n.wysiwyg," &lt;").concat((0,f.fG)("⌥⌘7"),`></button>
<button data-mode="ir">`).concat(window.VditorI18n.instantRendering," &lt;").concat((0,f.fG)("⌥⌘8"),`></button>
<button data-mode="sv">`).concat(window.VditorI18n.splitView," &lt;").concat((0,f.fG)("⌥⌘9"),"></button>"),o.element.appendChild(c),o._bindEvent(i,c,a),o}return n.prototype._bindEvent=function(i,a,o){var c=this.element.children[0];M(i,a,c,o.level),a.children.item(0).addEventListener((0,f.y3)(),function(x){Tn(i,"wysiwyg",x),x.preventDefault(),x.stopPropagation()}),a.children.item(1).addEventListener((0,f.y3)(),function(x){Tn(i,"ir",x),x.preventDefault(),x.stopPropagation()}),a.children.item(2).addEventListener((0,f.y3)(),function(x){Tn(i,"sv",x),x.preventDefault(),x.stopPropagation()})},n}(wt),$t=function(t,n){return(0,U.Co)(t,n)?getSelection().toString():""},Bt=function(t,n){n.addEventListener("focus",function(){t.options.focus&&t.options.focus(S(t)),T(t,["subToolbar","hint"])})},Rn=function(t,n){n.addEventListener("dblclick",function(i){i.target.tagName==="IMG"&&(t.options.image.preview?t.options.image.preview(i.target):t.options.image.isPreview&&(0,ye.o)(i.target,t.options.lang,t.options.theme))})},ti=function(t,n){n.addEventListener("blur",function(i){if(t.currentMode==="ir"){var a=t.ir.element.querySelector(".vditor-ir__node--expand");a&&a.classList.remove("vditor-ir__node--expand")}else t.currentMode==="wysiwyg"&&!t.wysiwyg.selectPopover.contains(i.relatedTarget)&&t.wysiwyg.hideComment();t[t.currentMode].range=(0,U.RN)(t),t.options.blur&&t.options.blur(S(t))})},Mn=function(t,n){n.addEventListener("dragstart",function(i){i.dataTransfer.setData(u.Y.DROP_EDITOR,u.Y.DROP_EDITOR)}),n.addEventListener("drop",function(i){i.dataTransfer.getData(u.Y.DROP_EDITOR)?rt(t):(i.dataTransfer.types.includes("Files")||i.dataTransfer.types.includes("text/html"))&&jn(t,i,{pasteCode:function(a){document.execCommand("insertHTML",!1,a)}})})},en=function(t,n,i){n.addEventListener("copy",function(a){return i(a,t)})},In=function(t,n,i){n.addEventListener("cut",function(a){i(a,t),t.options.comment.enable&&t.currentMode==="wysiwyg"&&t.wysiwyg.getComments(t),document.execCommand("delete")})},Xe=function(t){if(t.currentMode==="wysiwyg"&&t.options.comment.enable&&t.options.comment.adjustTop(t.wysiwyg.getComments(t,!0)),!!t.options.typewriterMode){var n=t[t.currentMode].element,i=(0,U.Ey)(n).top;t.options.height==="auto"&&!t.element.classList.contains("vditor--fullscreen")&&window.scrollTo(window.scrollX,i+t.element.offsetTop+t.toolbar.element.offsetHeight-window.innerHeight/2+10),(t.options.height!=="auto"||t.element.classList.contains("vditor--fullscreen"))&&(n.scrollTop=i+n.scrollTop-n.clientHeight/2+10)}},at=function(t,n){n.addEventListener("keydown",function(i){if(!i.isComposing&&t.options.keydown&&t.options.keydown(i),!((t.options.hint.extend.length>1||t.toolbar.elements.emoji)&&t.hint.select(i,t))){if(t.options.comment.enable&&t.currentMode==="wysiwyg"&&(i.key==="Backspace"||Z("⌘X",i))&&t.wysiwyg.getComments(t),t.currentMode==="sv"){if(Qe(t,i))return}else if(t.currentMode==="wysiwyg"){if(Nt(t,i))return}else if(t.currentMode==="ir"&&Ie(t,i))return;if(t.options.ctrlEnter&&Z("⌘Enter",i)){t.options.ctrlEnter(S(t)),i.preventDefault();return}if(Z("⌘Z",i)&&!t.toolbar.elements.undo){t.undo.undo(t),i.preventDefault();return}if(Z("⌘Y",i)&&!t.toolbar.elements.redo){t.undo.redo(t),i.preventDefault();return}if(i.key==="Escape"){t.hint.element.style.display==="block"?t.hint.element.style.display="none":t.options.esc&&!i.isComposing&&t.options.esc(S(t)),i.preventDefault();return}if((0,f._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[1-6]$/.test(i.code)){if(t.currentMode==="wysiwyg"){var a=i.code.replace("Digit","H");(0,v._Y)(getSelection().getRangeAt(0).startContainer,a)?ei(t):Dt(t,a),it(t)}else t.currentMode==="sv"?ut(t,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" "):t.currentMode==="ir"&&$n(t,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" ");return i.preventDefault(),!0}if((0,f._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[7-9]$/.test(i.code))return i.code==="Digit7"?Tn(t,"wysiwyg",i):i.code==="Digit8"?Tn(t,"ir",i):i.code==="Digit9"&&Tn(t,"sv",i),!0;t.options.toolbar.find(function(o){if(!o.hotkey||o.toolbar){if(o.toolbar){var c=o.toolbar.find(function(x){if(!x.hotkey)return!1;if(Z(x.hotkey,i))return t.toolbar.elements[x.name].children[0].dispatchEvent(new CustomEvent((0,f.y3)())),i.preventDefault(),!0});return!!c}return!1}if(Z(o.hotkey,i))return t.toolbar.elements[o.name].children[0].dispatchEvent(new CustomEvent((0,f.y3)())),i.preventDefault(),!0})}})},Pt=function(t,n){n.addEventListener("selectstart",function(i){n.onmouseup=function(){setTimeout(function(){var a=$t(t[t.currentMode].element);a.trim()?(t.currentMode==="wysiwyg"&&t.options.comment.enable&&(!(0,v.Th)(i.target,"data-type","footnotes-block")&&!(0,v.Th)(i.target,"data-type","link-ref-defs-block")?t.wysiwyg.showComment():t.wysiwyg.hideComment()),t.options.select&&t.options.select(a)):t.currentMode==="wysiwyg"&&t.options.comment.enable&&t.wysiwyg.hideComment()})}})},Y=function(t,n){var i=(0,U.RN)(t);i.extractContents(),i.insertNode(document.createTextNode(Lute.Caret)),i.insertNode(document.createTextNode(n));var a=(0,v.Th)(i.startContainer,"data-block","0");a||(a=t.sv.element);var o=t.lute.SpinVditorSVDOM(a.textContent);o="<div data-block='0'>"+o.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",a.isEqualNode(t.sv.element)?a.innerHTML=o:a.outerHTML=o,lt(t.sv.element),(0,U.ir)(t.sv.element,i),Xe(t)},X=function(t,n,i){i===void 0&&(i=!0);var a=t;for(a.nodeType===3&&(a=a.parentElement);a;){if(a.getAttribute("data-type")===n)return a;i?a=a.previousElementSibling:a=a.nextElementSibling}return!1},Ee=function(t,n){N("SpinVditorSVDOM",t,"argument",n.options.debugger);var i=n.lute.SpinVditorSVDOM(t);return t="<div data-block='0'>"+i.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",N("SpinVditorSVDOM",t,"result",n.options.debugger),t},$e=function(t){var n=t.getAttribute("data-type"),i=t.previousElementSibling,a=n&&n!=="text"&&n!=="table"&&n!=="heading-marker"&&n!=="newline"&&n!=="yaml-front-matter-open-marker"&&n!=="yaml-front-matter-close-marker"&&n!=="code-block-info"&&n!=="code-block-close-marker"&&n!=="code-block-open-marker"?t.textContent:"",o=!1;for(n==="newline"&&(o=!0);i&&!o;){var c=i.getAttribute("data-type");if(c==="li-marker"||c==="blockquote-marker"||c==="task-marker"||c==="padding"){var x=i.textContent;if(c==="li-marker"&&(n==="code-block-open-marker"||n==="code-block-info"))a=x.replace(/\S/g," ")+a;else if(n==="code-block-close-marker"&&i.nextElementSibling.isSameNode(t)){var A=X(t,"code-block-open-marker");A&&A.previousElementSibling&&(i=A.previousElementSibling,a=x+a)}else a=x+a}else c==="newline"&&(o=!0);i=i.previousElementSibling}return a},ze=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),n.enableHint&&t.hint.render(t),t.preview.render(t);var i=S(t);typeof t.options.input=="function"&&n.enableInput&&t.options.input(i),t.options.counter.enable&&t.counter.render(t,i),t.options.cache.enable&&(0,f.D)()&&(localStorage.setItem(t.options.cache.id,i),t.options.cache.after&&t.options.cache.after(i)),t.devtools&&t.devtools.renderEchart(t),clearTimeout(t.sv.processTimeoutId),t.sv.processTimeoutId=window.setTimeout(function(){n.enableAddUndoStack&&!t.sv.composingLock&&t.undo.addToUndoStack(t)},t.options.undoDelay)},ut=function(t,n){var i=(0,U.RN)(t),a=(0,D.f)(i.startContainer,"SPAN");a&&a.textContent.trim()!==""&&(n=`
`+n),i.collapse(!0),document.execCommand("insertHTML",!1,n)},Be=function(t,n,i,a){var o=(0,U.RN)(t),c=n.getAttribute("data-type");t.sv.element.childNodes.length===0&&(t.sv.element.innerHTML=`<span data-type="p" data-block="0"><span data-type="text"><wbr></span></span><span data-type="newline"><br><span style="display: none">
</span></span>`,(0,U.ir)(t.sv.element,o));var x=(0,v.pt)(o.startContainer),A=(0,D.f)(o.startContainer,"SPAN");if(x){if(c==="link"){var O=void 0;o.toString()===""?O="".concat(i).concat(Lute.Caret).concat(a):O="".concat(i).concat(o.toString()).concat(a.replace(")",Lute.Caret+")")),document.execCommand("insertHTML",!1,O);return}else if(c==="italic"||c==="bold"||c==="strike"||c==="inline-code"||c==="code"||c==="table"||c==="line"){var O=void 0;o.toString()===""?O="".concat(i).concat(Lute.Caret).concat(c==="code"?"":a):O="".concat(i).concat(o.toString()).concat(Lute.Caret).concat(c==="code"?"":a),c==="table"||c==="code"&&A&&A.textContent!==""?O=`

`+O:c==="line"&&(O=`

`.concat(i,`
`).concat(Lute.Caret)),document.execCommand("insertHTML",!1,O);return}else if((c==="check"||c==="list"||c==="ordered-list"||c==="quote")&&A){var L="* ";c==="check"?L="* [ ] ":c==="ordered-list"?L="1. ":c==="quote"&&(L="> ");var B=X(A,"newline");B?B.insertAdjacentText("afterend",L):x.insertAdjacentText("afterbegin",L),Ve(t);return}(0,U.ir)(t.sv.element,o),ze(t)}},Rt=function(t){switch(t.currentMode){case"ir":return t.ir.element;case"wysiwyg":return t.wysiwyg.element;case"sv":return t.sv.element}},tn=function(t,n){t.options.upload.setHeaders&&(t.options.upload.headers=t.options.upload.setHeaders()),t.options.upload.headers&&Object.keys(t.options.upload.headers).forEach(function(i){n.setRequestHeader(i,t.options.upload.headers[i])})},St=function(t,n,i,a){function o(c){return c instanceof i?c:new i(function(x){x(c)})}return new(i||(i=Promise))(function(c,x){function A(B){try{L(a.next(B))}catch(K){x(K)}}function O(B){try{L(a.throw(B))}catch(K){x(K)}}function L(B){B.done?c(B.value):o(B.value).then(A,O)}L((a=a.apply(t,n||[])).next())})},Hn=function(t,n){var i={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,o,c,x;return x={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function A(L){return function(B){return O([L,B])}}function O(L){if(a)throw new TypeError("Generator is already executing.");for(;x&&(x=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(c=L[0]&2?o.return:L[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,L[1])).done)return c;switch(o=0,c&&(L=[L[0]&2,c.value]),L[0]){case 0:case 1:c=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(c=i.trys,!(c=c.length>0&&c[c.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!c||L[1]>c[0]&&L[1]<c[3])){i.label=L[1];break}if(L[0]===6&&i.label<c[1]){i.label=c[1],c=L;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(L);break}c[2]&&i.ops.pop(),i.trys.pop();continue}L=n.call(t,i)}catch(B){L=[6,B],o=0}finally{a=c=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},qn=function(){function t(){this.isUploading=!1,this.element=document.createElement("div"),this.element.className="vditor-upload"}return t}(),ni=function(t,n){t.tip.hide();var i=[],a="",o="";t.options.lang,t.options;for(var c=function(O,L){var B=n[L],K=!0;B.name||(a+="<li>".concat(window.VditorI18n.nameEmpty,"</li>"),K=!1),B.size>t.options.upload.max&&(a+="<li>".concat(B.name," ").concat(window.VditorI18n.over," ").concat(t.options.upload.max/1024/1024,"M</li>"),K=!1);var me=B.name.lastIndexOf("."),pe=B.name.substr(me),fe=t.options.upload.filename(B.name.substr(0,me))+pe;if(t.options.upload.accept){var je=t.options.upload.accept.split(",").some(function(Se){var ue=Se.trim();if(ue.indexOf(".")===0){if(pe.toLowerCase()===ue.toLowerCase())return!0}else if(B.type.split("/")[0]===ue.split("/")[0])return!0;return!1});je||(a+="<li>".concat(B.name," ").concat(window.VditorI18n.fileTypeError,"</li>"),K=!1)}K&&(i.push(B),o+="<li>".concat(fe," ").concat(window.VditorI18n.uploading,"</li>"))},x=n.length,A=0;A<x;A++)c(x,A);return t.tip.show("<ul>".concat(a).concat(o,"</ul>")),i},hi=function(t,n){var i=Rt(n);i.focus();var a=JSON.parse(t),o="";a.code===1&&(o="".concat(a.msg)),a.data.errFiles&&a.data.errFiles.length>0&&(o="<ul><li>".concat(o,"</li>"),a.data.errFiles.forEach(function(x){var A=x.lastIndexOf("."),O=n.options.upload.filename(x.substr(0,A))+x.substr(A);o+="<li>".concat(O," ").concat(window.VditorI18n.uploadError,"</li>")}),o+="</ul>"),o?n.tip.show(o):n.tip.hide();var c="";Object.keys(a.data.succMap).forEach(function(x){var A=a.data.succMap[x],O=x.lastIndexOf("."),L=x.substr(O),B=n.options.upload.filename(x.substr(0,O))+L;L=L.toLowerCase(),L.indexOf(".wav")===0||L.indexOf(".mp3")===0||L.indexOf(".ogg")===0?n.currentMode==="wysiwyg"?c+=`<div class="vditor-wysiwyg__block" data-type="html-block"
 data-block="0"><pre><code>&lt;audio controls="controls" src="`.concat(A,'"&gt;&lt;/audio&gt;</code></pre><pre class="vditor-wysiwyg__preview" data-render="1"><audio controls="controls" src="').concat(A,`"></audio></pre></div>
`):n.currentMode==="ir"?c+='<audio controls="controls" src="'.concat(A,`"></audio>
`):c+="[".concat(B,"](").concat(A,`)
`):L.indexOf(".apng")===0||L.indexOf(".bmp")===0||L.indexOf(".gif")===0||L.indexOf(".ico")===0||L.indexOf(".cur")===0||L.indexOf(".jpg")===0||L.indexOf(".jpeg")===0||L.indexOf(".jfif")===0||L.indexOf(".pjp")===0||L.indexOf(".pjpeg")===0||L.indexOf(".png")===0||L.indexOf(".svg")===0||L.indexOf(".webp")===0?n.currentMode==="wysiwyg"?c+='<img alt="'.concat(B,'" src="').concat(A,`">
`):c+="![".concat(B,"](").concat(A,`)
`):n.currentMode==="wysiwyg"?c+='<a href="'.concat(A,'">').concat(B,`</a>
`):c+="[".concat(B,"](").concat(A,`)
`)}),(0,U.jl)(n.upload.range),document.execCommand("insertHTML",!1,c),n.upload.range=getSelection().getRangeAt(0).cloneRange()},hn=function(t,n,i){return St(void 0,void 0,void 0,function(){var a,o,fe,c,x,x,A,O,L,B,K,me,pe,fe,je,Se;return Hn(this,function(ue){switch(ue.label){case 0:for(a=[],o=t.options.upload.multiple===!0?n.length:1,fe=0;fe<o;fe++)c=n[fe],c instanceof DataTransferItem&&(c=c.getAsFile()),a.push(c);return t.options.upload.handler?[4,t.options.upload.handler(a)]:[3,2];case 1:return x=ue.sent(),i&&(i.value=""),typeof x=="string"?(t.tip.show(x),[2]):[2];case 2:return!t.options.upload.url||!t.upload?(i&&(i.value=""),t.tip.show("please config: options.upload.url"),[2]):t.options.upload.file?[4,t.options.upload.file(a)]:[3,4];case 3:a=ue.sent(),ue.label=4;case 4:if(t.options.upload.validate&&(x=t.options.upload.validate(a),typeof x=="string"))return t.tip.show(x),[2];if(A=Rt(t),t.upload.range=(0,U.RN)(t),O=ni(t,a),O.length===0)return i&&(i.value=""),[2];for(L=new FormData,B=t.options.upload.extraData,K=0,me=Object.keys(B);K<me.length;K++)pe=me[K],L.append(pe,B[pe]);for(fe=0,je=O.length;fe<je;fe++)L.append(t.options.upload.fieldName,O[fe]);return Se=new XMLHttpRequest,Se.open("POST",t.options.upload.url),t.options.upload.token&&Se.setRequestHeader("X-Upload-Token",t.options.upload.token),t.options.upload.withCredentials&&(Se.withCredentials=!0),tn(t,Se),t.upload.isUploading=!0,A.setAttribute("contenteditable","false"),Se.onreadystatechange=function(){if(Se.readyState===XMLHttpRequest.DONE){if(t.upload.isUploading=!1,A.setAttribute("contenteditable","true"),Se.status>=200&&Se.status<300)if(t.options.upload.success)t.options.upload.success(A,Se.responseText);else{var Ye=Se.responseText;t.options.upload.format&&(Ye=t.options.upload.format(n,Se.responseText)),hi(Ye,t)}else t.options.upload.error?t.options.upload.error(Se.responseText):t.tip.show(Se.responseText);i&&(i.value=""),t.upload.element.style.display="none"}},Se.upload.onprogress=function(Ye){if(Ye.lengthComputable){var He=Ye.loaded/Ye.total*100;t.upload.element.style.display="block";var Ze=t.upload.element;Ze.style.width=He+"%"}},Se.send(L),[2]}})})},pi=function(t,n,i){var a,o=(0,v.pt)(n.startContainer);if(o||(o=t.wysiwyg.element),i&&i.inputType!=="formatItalic"&&i.inputType!=="deleteByDrag"&&i.inputType!=="insertFromDrop"&&i.inputType!=="formatBold"&&i.inputType!=="formatRemove"&&i.inputType!=="formatStrikeThrough"&&i.inputType!=="insertUnorderedList"&&i.inputType!=="insertOrderedList"&&i.inputType!=="formatOutdent"&&i.inputType!=="formatIndent"&&i.inputType!==""||!i){var c=Xt(n.startContainer);c&&c.remove(),t.wysiwyg.element.querySelectorAll("wbr").forEach(function(He){He.remove()}),n.insertNode(document.createElement("wbr")),o.querySelectorAll("[style]").forEach(function(He){He.removeAttribute("style")}),o.querySelectorAll(".vditor-comment").forEach(function(He){He.textContent.trim()===""&&(He.classList.remove("vditor-comment","vditor-comment--focus"),He.removeAttribute("data-cmtids"))}),(a=o.previousElementSibling)===null||a===void 0||a.querySelectorAll(".vditor-comment").forEach(function(He){He.textContent.trim()===""&&(He.classList.remove("vditor-comment","vditor-comment--focus"),He.removeAttribute("data-cmtids"))});var x="";o.getAttribute("data-type")==="link-ref-defs-block"&&(o=t.wysiwyg.element);var A=o.isEqualNode(t.wysiwyg.element),O=(0,v.Th)(o,"data-type","footnotes-block");if(A)x=o.innerHTML;else{var L=(0,v.KR)(n.startContainer);if(L&&!O){var B=(0,D.f)(n.startContainer,"BLOCKQUOTE");B?o=(0,v.pt)(n.startContainer)||o:o=L}if(O&&(o=O),x=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var K=o.previousElementSibling,me=o.nextElementSibling;K&&(K.tagName==="UL"||K.tagName==="OL")&&(x=K.outerHTML+x,K.remove()),me&&(me.tagName==="UL"||me.tagName==="OL")&&(x=x+me.outerHTML,me.remove()),x=x.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}o.innerText.startsWith("```")||(t.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(He){He&&!o.isEqualNode(He)&&(x+=He.outerHTML,He.remove())}),t.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(He){He&&!o.isEqualNode(He)&&(x+=He.outerHTML,He.remove())}))}if(x=x.replace(/<\/(strong|b)><strong data-marker="\W{2}">/g,"").replace(/<\/(em|i)><em data-marker="\W{1}">/g,"").replace(/<\/(s|strike)><s data-marker="~{1,2}">/g,""),x==='<p data-block="0">```<wbr></p>'&&t.hint.recentLanguage&&(x='<p data-block="0">```<wbr></p>'.replace("```","```"+t.hint.recentLanguage)),N("SpinVditorDOM",x,"argument",t.options.debugger),x=t.lute.SpinVditorDOM(x),N("SpinVditorDOM",x,"result",t.options.debugger),A)o.innerHTML=x;else if(o.outerHTML=x,O){var pe=(0,v.Ab)(t.wysiwyg.element.querySelector("wbr"),"LI");if(pe){var fe=t.wysiwyg.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(pe.getAttribute("data-marker"),'"]'));fe&&fe.setAttribute("aria-label",pe.textContent.trim().substr(0,24))}}var je,Se=t.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']");Se.forEach(function(He,Ze){Ze===0?je=He:(je.insertAdjacentHTML("beforeend",He.innerHTML),He.remove())}),Se.length>0&&t.wysiwyg.element.insertAdjacentElement("beforeend",Se[0]);var ue,Ye=t.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']");Ye.forEach(function(He,Ze){Ze===0?ue=He:(ue.insertAdjacentHTML("beforeend",He.innerHTML),He.remove())}),Ye.length>0&&t.wysiwyg.element.insertAdjacentElement("beforeend",Ye[0]),(0,U.ir)(t.wysiwyg.element,n),t.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(He){tt(He,t)}),i&&(i.inputType==="deleteContentBackward"||i.inputType==="deleteContentForward")&&t.options.comment.enable&&(t.wysiwyg.triggerRemoveComment(t),t.options.comment.adjustTop(t.wysiwyg.getComments(t,!0)))}oe(t),it(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Dr=function(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},Or=function(t,n,i,a){function o(c){return c instanceof i?c:new i(function(x){x(c)})}return new(i||(i=Promise))(function(c,x){function A(B){try{L(a.next(B))}catch(K){x(K)}}function O(B){try{L(a.throw(B))}catch(K){x(K)}}function L(B){B.done?c(B.value):o(B.value).then(A,O)}L((a=a.apply(t,n||[])).next())})},Pr=function(t,n){var i={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,o,c,x;return x={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function A(L){return function(B){return O([L,B])}}function O(L){if(a)throw new TypeError("Generator is already executing.");for(;x&&(x=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(c=L[0]&2?o.return:L[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,L[1])).done)return c;switch(o=0,c&&(L=[L[0]&2,c.value]),L[0]){case 0:case 1:c=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(c=i.trys,!(c=c.length>0&&c[c.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!c||L[1]>c[0]&&L[1]<c[3])){i.label=L[1];break}if(L[0]===6&&i.label<c[1]){i.label=c[1],c=L;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(L);break}c[2]&&i.ops.pop(),i.trys.pop();continue}L=n.call(t,i)}catch(B){L=[6,B],o=0}finally{a=c=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},ur=function(t,n,i){if(t.keyCode===229&&t.code===""&&t.key==="Unidentified"&&n.currentMode!=="sv"){var a=(0,v.pt)(i);if(a&&a.textContent.trim()==="")return n[n.currentMode].composingLock=!0,!1}return!0},qi=function(t,n,i){if(!(i.key==="Enter"||i.key==="Tab"||i.key==="Backspace"||i.key.indexOf("Arrow")>-1||(0,f._0)(i)||i.key==="Escape"||i.shiftKey||i.altKey)){var a=(0,v._Y)(t.startContainer,"P")||(0,v._Y)(t.startContainer,"LI");if(a&&(0,U.ED)(a,n[n.currentMode].element,t).start===0){a.nodeValue&&(a.nodeValue=a.nodeValue.replace(/\u2006/g,""));var o=document.createTextNode(u.Y.ZWSP);t.insertNode(o),t.setStartAfter(o)}}},Rr=function(t,n){if(n==="ArrowDown"||n==="ArrowUp"){var i=(0,v.Th)(t.startContainer,"data-type","math-inline")||(0,v.Th)(t.startContainer,"data-type","html-entity")||(0,v.Th)(t.startContainer,"data-type","html-inline");i&&(n==="ArrowDown"&&t.setStartAfter(i.parentElement),n==="ArrowUp"&&t.setStartBefore(i.parentElement))}},Si=function(t,n){var i=(0,U.RN)(t),a=(0,v.pt)(i.startContainer);a&&(a.insertAdjacentHTML(n,'<p data-block="0">'.concat(u.Y.ZWSP,`<wbr>
</p>`)),(0,U.ir)(t[t.currentMode].element,i),mt(t),rt(t))},Ir=function(t){var n=(0,v._Y)(t,"TABLE");return n&&n.rows[0].cells[0].isSameNode(t)?n:!1},Hr=function(t){var n=(0,v._Y)(t,"TABLE");return n&&n.lastElementChild.lastElementChild.lastElementChild.isSameNode(t)?n:!1},dr=function(t,n,i){i===void 0&&(i=!0);var a=t.previousElementSibling;return a||(t.parentElement.previousElementSibling?a=t.parentElement.previousElementSibling.lastElementChild:t.parentElement.parentElement.tagName==="TBODY"&&t.parentElement.parentElement.previousElementSibling?a=t.parentElement.parentElement.previousElementSibling.lastElementChild.lastElementChild:a=null),a&&(n.selectNodeContents(a),i||n.collapse(!1),(0,U.jl)(n)),a},mi=function(t,n,i,a,o){var c=(0,U.ED)(a,t[t.currentMode].element,i);if(n.key==="ArrowDown"&&a.textContent.trimRight().substr(c.start).indexOf(`
`)===-1||n.key==="ArrowRight"&&c.start>=a.textContent.trimRight().length){var x=o.nextElementSibling;return!x||x&&(x.tagName==="TABLE"||x.getAttribute("data-type"))?(o.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,U.ir)(t[t.currentMode].element,i)):(i.selectNodeContents(x),i.collapse(!0),(0,U.jl)(i)),n.preventDefault(),!0}return!1},ii=function(t,n,i,a,o){var c=(0,U.ED)(a,t[t.currentMode].element,i);if(n.key==="ArrowUp"&&a.textContent.substr(0,c.start).indexOf(`
`)===-1||(n.key==="ArrowLeft"||n.key==="Backspace"&&i.toString()==="")&&c.start===0){var x=o.previousElementSibling;return!x||x&&(x.tagName==="TABLE"||x.getAttribute("data-type"))?(o.insertAdjacentHTML("beforebegin",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,U.ir)(t[t.currentMode].element,i)):(i.selectNodeContents(x),i.collapse(!1),(0,U.jl)(i)),n.preventDefault(),!0}return!1},xi=function(t,n,i,a){a===void 0&&(a=!0);var o=(0,v._Y)(n.startContainer,"LI");if(t[t.currentMode].element.querySelectorAll("wbr").forEach(function(B){B.remove()}),n.insertNode(document.createElement("wbr")),a&&o){for(var c="",x=0;x<o.parentElement.childElementCount;x++){var A=o.parentElement.children[x].querySelector("input");A&&A.remove(),c+='<p data-block="0">'.concat(o.parentElement.children[x].innerHTML.trimLeft(),"</p>")}o.parentElement.insertAdjacentHTML("beforebegin",c),o.parentElement.remove()}else if(o)if(i==="check")o.parentElement.querySelectorAll("li").forEach(function(B){B.insertAdjacentHTML("afterbegin",'<input type="checkbox" />'.concat(B.textContent.indexOf(" ")===0?"":" ")),B.classList.add("vditor-task")});else{o.querySelector("input")&&o.parentElement.querySelectorAll("li").forEach(function(B){B.querySelector("input").remove(),B.classList.remove("vditor-task")});var L=void 0;i==="list"?(L=document.createElement("ul"),L.setAttribute("data-marker","*")):(L=document.createElement("ol"),L.setAttribute("data-marker","1.")),L.setAttribute("data-block","0"),L.setAttribute("data-tight",o.parentElement.getAttribute("data-tight")),L.innerHTML=o.parentElement.innerHTML,o.parentElement.parentNode.replaceChild(L,o.parentElement)}else{var O=(0,v.Th)(n.startContainer,"data-block","0");O||(t[t.currentMode].element.querySelector("wbr").remove(),O=t[t.currentMode].element.querySelector("p"),O.innerHTML="<wbr>"),i==="check"?(O.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li class="vditor-task"><input type="checkbox" /> '.concat(O.innerHTML,"</li></ul>")),O.remove()):i==="list"?(O.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li>'.concat(O.innerHTML,"</li></ul>")),O.remove()):i==="ordered-list"&&(O.insertAdjacentHTML("beforebegin",'<ol data-block="0"><li>'.concat(O.innerHTML,"</li></ol>")),O.remove())}},Nr=function(t,n,i){var a=n.previousElementSibling;if(n&&a){var o=[n];Array.from(i.cloneContents().children).forEach(function(O,L){O.nodeType!==3&&n&&O.textContent.trim()!==""&&n.getAttribute("data-node-id")===O.getAttribute("data-node-id")&&(L!==0&&o.push(n),n=n.nextElementSibling)}),t[t.currentMode].element.querySelectorAll("wbr").forEach(function(O){O.remove()}),i.insertNode(document.createElement("wbr"));var c=a.parentElement,x="";o.forEach(function(O){var L=O.getAttribute("data-marker");L.length!==1&&(L="1".concat(L.slice(-1))),x+='<li data-node-id="'.concat(O.getAttribute("data-node-id"),'" data-marker="').concat(L,'">').concat(O.innerHTML,"</li>"),O.remove()}),a.insertAdjacentHTML("beforeend","<".concat(c.tagName,' data-block="0">').concat(x,"</").concat(c.tagName,">")),t.currentMode==="wysiwyg"?c.outerHTML=t.lute.SpinVditorDOM(c.outerHTML):c.outerHTML=t.lute.SpinVditorIRDOM(c.outerHTML),(0,U.ir)(t[t.currentMode].element,i);var A=(0,v.KR)(i.startContainer);A&&A.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='2']")).forEach(function(O){tt(O,t),t.currentMode==="wysiwyg"&&O.previousElementSibling.setAttribute("style","display:none")}),rt(t),mt(t)}else t[t.currentMode].element.focus()},Wi=function(t,n,i,a){var o=(0,v._Y)(n.parentElement,"LI");if(o){t[t.currentMode].element.querySelectorAll("wbr").forEach(function(K){K.remove()}),i.insertNode(document.createElement("wbr"));var c=n.parentElement,x=c.cloneNode(),A=[n];Array.from(i.cloneContents().children).forEach(function(K,me){K.nodeType!==3&&n&&K.textContent.trim()!==""&&n.getAttribute("data-node-id")===K.getAttribute("data-node-id")&&(me!==0&&A.push(n),n=n.nextElementSibling)});var O=!1,L="";c.querySelectorAll("li").forEach(function(K){O&&(L+=K.outerHTML,!K.nextElementSibling&&!K.previousElementSibling?K.parentElement.remove():K.remove()),K.isSameNode(A[A.length-1])&&(O=!0)}),A.reverse().forEach(function(K){o.insertAdjacentElement("afterend",K)}),L&&(x.innerHTML=L,A[0].insertAdjacentElement("beforeend",x)),t.currentMode==="wysiwyg"?a.outerHTML=t.lute.SpinVditorDOM(a.outerHTML):a.outerHTML=t.lute.SpinVditorIRDOM(a.outerHTML),(0,U.ir)(t[t.currentMode].element,i);var B=(0,v.KR)(i.startContainer);B&&B.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='2']")).forEach(function(K){tt(K,t),t.currentMode==="wysiwyg"&&K.previousElementSibling.setAttribute("style","display:none")}),rt(t),mt(t)}else t[t.currentMode].element.focus()},Ci=function(t,n){for(var i=getSelection().getRangeAt(0).startContainer.parentElement,a=t.rows[0].cells.length,o=t.rows.length,c=0,x=0;x<o;x++)for(var A=0;A<a;A++)if(t.rows[x].cells[A].isSameNode(i)){c=A;break}for(var O=0;O<o;O++)t.rows[O].cells[c].setAttribute("align",n)},_i=function(t){var n=t.trimRight().split(`
`).pop();return n===""?!1:(n.replace(/ |-/g,"")===""||n.replace(/ |_/g,"")===""||n.replace(/ |\*/g,"")==="")&&n.replace(/ /g,"").length>2?!(n.indexOf("-")>-1&&n.trimLeft().indexOf(" ")===-1&&t.trimRight().split(`
`).length>1||n.indexOf("    ")===0||n.indexOf("	")===0):!1},fr=function(t){var n=t.trimRight().split(`
`);return t=n.pop(),t.indexOf("    ")===0||t.indexOf("	")===0||(t=t.trimLeft(),t===""||n.length===0)?!1:t.replace(/-/g,"")===""||t.replace(/=/g,"")===""},rt=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.currentMode==="wysiwyg"?it(t,n):t.currentMode==="ir"?Ot(t,n):t.currentMode==="sv"&&ze(t,n)},Ti=function(t,n,i,a){var o,c=t.startContainer,x=(0,v._Y)(c,"LI");if(x){if(!(0,f._0)(a)&&!a.altKey&&a.key==="Enter"&&!a.shiftKey&&i&&x.contains(i)&&i.nextElementSibling)return x&&!x.textContent.endsWith(`
`)&&x.insertAdjacentText("beforeend",`
`),t.insertNode(document.createTextNode(`

`)),t.collapse(!1),rt(n),a.preventDefault(),!0;if(!(0,f._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&!x.previousElementSibling&&t.toString()===""&&(0,U.ED)(x,n[n.currentMode].element,t).start===0)return x.nextElementSibling?(x.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(x.innerHTML,"</p>")),x.remove()):x.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(x.innerHTML,"</p>"),(0,U.ir)(n[n.currentMode].element,t),rt(n),a.preventDefault(),!0;if(!(0,f._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&x.textContent.trim().replace(u.Y.ZWSP,"")===""&&t.toString()===""&&((o=x.previousElementSibling)===null||o===void 0?void 0:o.tagName)==="LI")return x.previousElementSibling.insertAdjacentText("beforeend",`

`),t.selectNodeContents(x.previousElementSibling),t.collapse(!1),x.remove(),(0,U.ir)(n[n.currentMode].element,t),rt(n),a.preventDefault(),!0;if(!(0,f._0)(a)&&!a.altKey&&a.key==="Tab"){var A=!1;if((t.startOffset===0&&(c.nodeType===3&&!c.previousSibling||c.nodeType!==3&&c.nodeName==="LI")||x.classList.contains("vditor-task")&&t.startOffset===1&&c.previousSibling.nodeType!==3&&c.previousSibling.tagName==="INPUT")&&(A=!0),A||t.toString()!=="")return a.shiftKey?Wi(n,x,t,x.parentElement):Nr(n,x,t),a.preventDefault(),!0}}return!1},hr=function(t,n,i){if(t.options.tab&&i.key==="Tab")return i.shiftKey||(n.toString()===""?(n.insertNode(document.createTextNode(t.options.tab)),n.collapse(!1)):(n.extractContents(),n.insertNode(document.createTextNode(t.options.tab)),n.collapse(!1))),(0,U.jl)(n),rt(t),i.preventDefault(),!0},jr=function(t,n,i,a){if(i){if(!(0,f._0)(t)&&!t.altKey&&t.key==="Enter"){var o=String.raw(ce||(ce=Dr(["",""],["",""])),i.textContent).replace(/\\\|/g,"").trim(),c=o.split("|");if(o.startsWith("|")&&o.endsWith("|")&&c.length>3){var x=c.map(function(){return"---"}).join("|");return x=i.textContent+`
`+x.substring(3,x.length-3)+`
|<wbr>`,i.outerHTML=n.lute.SpinVditorDOM(x),(0,U.ir)(n[n.currentMode].element,a),rt(n),Xe(n),t.preventDefault(),!0}if(_i(i.innerHTML)&&i.previousElementSibling){var A="",O=i.innerHTML.trimRight().split(`
`);return O.length>1&&(O.pop(),A='<p data-block="0">'.concat(O.join(`
`),"</p>")),i.insertAdjacentHTML("afterend","".concat(A,`<hr data-block="0"><p data-block="0"><wbr>
</p>`)),i.remove(),(0,U.ir)(n[n.currentMode].element,a),rt(n),Xe(n),t.preventDefault(),!0}if(fr(i.innerHTML))return n.currentMode==="wysiwyg"?i.outerHTML=n.lute.SpinVditorDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`):i.outerHTML=n.lute.SpinVditorIRDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`),(0,U.ir)(n[n.currentMode].element,a),rt(n),Xe(n),t.preventDefault(),!0}if(a.collapsed&&i.previousElementSibling&&t.key==="Backspace"&&!(0,f._0)(t)&&!t.altKey&&!t.shiftKey&&i.textContent.trimRight().split(`
`).length>1&&(0,U.ED)(i,n[n.currentMode].element,a).start===0){var L=(0,v.Rp)(i.previousElementSibling);return L.textContent.endsWith(`
`)||(L.textContent=L.textContent+`
`),L.parentElement.insertAdjacentHTML("beforeend","<wbr>".concat(i.innerHTML)),i.remove(),(0,U.ir)(n[n.currentMode].element,a),!1}return!1}},j=function(t,n,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');i.tagName==="TH"?i.parentElement.parentElement.insertAdjacentHTML("afterend","<tbody><tr>".concat(a,"</tr></tbody>")):i.parentElement.insertAdjacentHTML("afterend","<tr>".concat(a,"</tr>")),rt(t)},P=function(t,n,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)i.tagName==="TH"?a+='<th align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </th>'):a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');if(i.tagName==="TH"){i.parentElement.parentElement.insertAdjacentHTML("beforebegin","<thead><tr>".concat(a,"</tr></thead>")),n.insertNode(document.createElement("wbr"));var c=i.parentElement.innerHTML.replace(/<th>/g,"<td>").replace(/<\/th>/g,"</td>");i.parentElement.parentElement.nextElementSibling.insertAdjacentHTML("afterbegin",c),i.parentElement.parentElement.remove(),(0,U.ir)(t.ir.element,n)}else i.parentElement.insertAdjacentHTML("beforebegin","<tr>".concat(a,"</tr>"));rt(t)},q=function(t,n,i,a){a===void 0&&(a="afterend");for(var o=0,c=i.previousElementSibling;c;)o++,c=c.previousElementSibling;for(var x=0;x<n.rows.length;x++)x===0?n.rows[x].cells[o].insertAdjacentHTML(a,"<th> </th>"):n.rows[x].cells[o].insertAdjacentHTML(a,"<td> </td>");rt(t)},Q=function(t,n,i){if(i.tagName==="TD"){var a=i.parentElement.parentElement;i.parentElement.previousElementSibling?n.selectNodeContents(i.parentElement.previousElementSibling.lastElementChild):n.selectNodeContents(a.previousElementSibling.lastElementChild.lastElementChild),a.childElementCount===1?a.remove():i.parentElement.remove(),n.collapse(!1),(0,U.jl)(n),rt(t)}},we=function(t,n,i,a){for(var o=0,c=a.previousElementSibling;c;)o++,c=c.previousElementSibling;(a.previousElementSibling||a.nextElementSibling)&&(n.selectNodeContents(a.previousElementSibling||a.nextElementSibling),n.collapse(!0));for(var x=0;x<i.rows.length;x++){var A=i.rows[x].cells;if(A.length===1){i.remove(),mt(t);break}A[o].remove()}(0,U.jl)(n),rt(t)},xe=function(t,n,i){var a=i.startContainer,o=(0,v._Y)(a,"TD")||(0,v._Y)(a,"TH");if(o){if(!(0,f._0)(n)&&!n.altKey&&n.key==="Enter"){(!o.lastElementChild||o.lastElementChild&&(!o.lastElementChild.isSameNode(o.lastChild)||o.lastElementChild.tagName!=="BR"))&&o.insertAdjacentHTML("beforeend","<br>");var c=document.createElement("br");return i.insertNode(c),i.setStartAfter(c),rt(t),Xe(t),n.preventDefault(),!0}if(n.key==="Tab"){if(n.shiftKey)return dr(o,i),n.preventDefault(),!0;var x=o.nextElementSibling;return x||(o.parentElement.nextElementSibling?x=o.parentElement.nextElementSibling.firstElementChild:o.parentElement.parentElement.tagName==="THEAD"&&o.parentElement.parentElement.nextElementSibling?x=o.parentElement.parentElement.nextElementSibling.firstElementChild.firstElementChild:x=null),x&&(i.selectNodeContents(x),(0,U.jl)(i)),n.preventDefault(),!0}var A=o.parentElement.parentElement.parentElement;if(n.key==="ArrowUp"){if(n.preventDefault(),o.tagName==="TH")return A.previousElementSibling?(i.selectNodeContents(A.previousElementSibling),i.collapse(!1),(0,U.jl)(i)):Si(t,"beforebegin"),!0;for(var O=0,L=o.parentElement;O<L.cells.length&&!L.cells[O].isSameNode(o);O++);var B=L.previousElementSibling;return B||(B=L.parentElement.previousElementSibling.firstChild),i.selectNodeContents(B.cells[O]),i.collapse(!1),(0,U.jl)(i),!0}if(n.key==="ArrowDown"){n.preventDefault();var L=o.parentElement;if(!L.nextElementSibling&&o.tagName==="TD")return A.nextElementSibling?(i.selectNodeContents(A.nextElementSibling),i.collapse(!0),(0,U.jl)(i)):Si(t,"afterend"),!0;for(var O=0;O<L.cells.length&&!L.cells[O].isSameNode(o);O++);var x=L.nextElementSibling;return x||(x=L.parentElement.nextElementSibling.firstChild),i.selectNodeContents(x.cells[O]),i.collapse(!0),(0,U.jl)(i),!0}if(t.currentMode==="wysiwyg"&&!(0,f._0)(n)&&n.key==="Enter"&&!n.shiftKey&&n.altKey){var K=t.wysiwyg.popover.querySelector(".vditor-input");return K.focus(),K.select(),n.preventDefault(),!0}if(!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&n.key==="Backspace"&&i.startOffset===0&&i.toString()===""){var me=dr(o,i,!1);return!me&&A&&(A.textContent.trim()===""?(A.outerHTML=`<p data-block="0"><wbr>
</p>`,(0,U.ir)(t[t.currentMode].element,i)):(i.setStartBefore(A),i.collapse(!0)),rt(t)),n.preventDefault(),!0}if(Z("⇧⌘F",n))return P(t,i,o),n.preventDefault(),!0;if(Z("⌘=",n))return j(t,i,o),n.preventDefault(),!0;if(Z("⇧⌘G",n))return q(t,A,o,"beforebegin"),n.preventDefault(),!0;if(Z("⇧⌘=",n))return q(t,A,o),n.preventDefault(),!0;if(Z("⌘-",n))return Q(t,i,o),n.preventDefault(),!0;if(Z("⇧⌘-",n))return we(t,i,A,o),n.preventDefault(),!0;if(Z("⇧⌘L",n)){if(t.currentMode==="ir")return Ci(A,"left"),rt(t),n.preventDefault(),!0;var pe=t.wysiwyg.popover.querySelector('[data-type="left"]');if(pe)return pe.click(),n.preventDefault(),!0}if(Z("⇧⌘C",n)){if(t.currentMode==="ir")return Ci(A,"center"),rt(t),n.preventDefault(),!0;var pe=t.wysiwyg.popover.querySelector('[data-type="center"]');if(pe)return pe.click(),n.preventDefault(),!0}if(Z("⇧⌘R",n)){if(t.currentMode==="ir")return Ci(A,"right"),rt(t),n.preventDefault(),!0;var pe=t.wysiwyg.popover.querySelector('[data-type="right"]');if(pe)return pe.click(),n.preventDefault(),!0}}return!1},ot=function(t,n,i,a){if(i.tagName==="PRE"&&Z("⌘A",n))return a.selectNodeContents(i.firstElementChild),n.preventDefault(),!0;if(t.options.tab&&n.key==="Tab"&&!n.shiftKey&&a.toString()==="")return a.insertNode(document.createTextNode(t.options.tab)),a.collapse(!1),rt(t),n.preventDefault(),!0;if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey){var o=(0,U.ED)(i,t[t.currentMode].element,a);if((o.start===0||o.start===1&&i.innerText===`
`)&&a.toString()==="")return i.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(i.firstElementChild.innerHTML,"</p>"),(0,U.ir)(t[t.currentMode].element,a),rt(t),n.preventDefault(),!0}return!(0,f._0)(n)&&!n.altKey&&n.key==="Enter"?(i.firstElementChild.textContent.endsWith(`
`)||i.firstElementChild.insertAdjacentText("beforeend",`
`),a.extractContents(),a.insertNode(document.createTextNode(`
`)),a.collapse(!1),(0,U.jl)(a),(0,f.gm)()||(t.currentMode==="wysiwyg"?pi(t,a):Ge(t,a)),Xe(t),n.preventDefault(),!0):!1},_t=function(t,n,i,a){var o=n.startContainer,c=(0,v._Y)(o,"BLOCKQUOTE");if(c&&n.toString()===""){if(i.key==="Backspace"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey&&(0,U.ED)(c,t[t.currentMode].element,n).start===0)return n.insertNode(document.createElement("wbr")),c.outerHTML=c.innerHTML,(0,U.ir)(t[t.currentMode].element,n),rt(t),i.preventDefault(),!0;if(a&&i.key==="Enter"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey&&a.parentElement.tagName==="BLOCKQUOTE"){var x=!1;if(a.innerHTML.replace(u.Y.ZWSP,"")===`
`||a.innerHTML.replace(u.Y.ZWSP,"")===""?(x=!0,a.remove()):a.innerHTML.endsWith(`

`)&&(0,U.ED)(a,t[t.currentMode].element,n).start===a.textContent.length-1&&(a.innerHTML=a.innerHTML.substr(0,a.innerHTML.length-2),x=!0),x)return c.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(u.Y.ZWSP,`<wbr>
</p>`)),(0,U.ir)(t[t.currentMode].element,n),rt(t),i.preventDefault(),!0}var A=(0,v.pt)(o);if(t.currentMode==="wysiwyg"&&A&&Z("⇧⌘;",i))return n.insertNode(document.createElement("wbr")),A.outerHTML='<blockquote data-block="0">'.concat(A.outerHTML,"</blockquote>"),(0,U.ir)(t.wysiwyg.element,n),it(t),i.preventDefault(),!0;if(mi(t,i,n,c,c)||ii(t,i,n,c,c))return!0}return!1},Gt=function(t,n,i){var a=n.startContainer,o=(0,v._Y)(a,"li");if(o&&o.classList.contains("vditor-task")){if(Z("⇧⌘J",i)){var c=o.firstElementChild;return c.checked?c.removeAttribute("checked"):c.setAttribute("checked","checked"),rt(t),i.preventDefault(),!0}if(i.key==="Backspace"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey&&n.toString()===""&&n.startOffset===1&&(a.nodeType===3&&a.previousSibling&&a.previousSibling.tagName==="INPUT"||a.nodeType!==3)){var x=o.previousElementSibling;if(o.querySelector("input").remove(),x){var A=(0,v.Rp)(x);A.parentElement.insertAdjacentHTML("beforeend","<wbr>"+o.innerHTML.trim()),o.remove()}else o.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(o.innerHTML.trim()||`
`,"</p>")),o.nextElementSibling?o.remove():o.parentElement.remove();return(0,U.ir)(t[t.currentMode].element,n),rt(t),i.preventDefault(),!0}if(i.key==="Enter"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey){if(o.textContent.trim()==="")if((0,v.KJ)(o.parentElement,"vditor-task")){var O=(0,v.KR)(a);O&&Wi(t,o,n,O)}else if(o.nextElementSibling){var L="",B="",K=!1;Array.from(o.parentElement.children).forEach(function(je){o.isSameNode(je)?K=!0:K?L+=je.outerHTML:B+=je.outerHTML});var me=o.parentElement.tagName,pe=o.parentElement.tagName==="OL"?"":' data-marker="'.concat(o.parentElement.getAttribute("data-marker"),'"'),fe="";B&&(fe=o.parentElement.tagName==="UL"?"":' start="1"',B="<".concat(me,' data-tight="true"').concat(pe,' data-block="0">').concat(B,"</").concat(me,">")),o.parentElement.outerHTML="".concat(B,`<p data-block="0"><wbr>
</p><`).concat(me,`
 data-tight="true"`).concat(pe,' data-block="0"').concat(fe,">").concat(L,"</").concat(me,">")}else o.parentElement.insertAdjacentHTML("afterend",`<p data-block="0"><wbr>
</p>`),o.parentElement.querySelectorAll("li").length===1?o.parentElement.remove():o.remove();else a.nodeType!==3&&n.startOffset===0&&a.firstChild.tagName==="INPUT"?n.setStart(a.childNodes[1],1):(n.setEndAfter(o.lastChild),o.insertAdjacentHTML("afterend",'<li class="vditor-task" data-marker="'.concat(o.getAttribute("data-marker"),'"><input type="checkbox"> <wbr></li>')),document.querySelector("wbr").after(n.extractContents()));return(0,U.ir)(t[t.currentMode].element,n),rt(t),Xe(t),i.preventDefault(),!0}}return!1},Nn=function(t,n,i,a){if(n.startContainer.nodeType!==3){var o=n.startContainer.children[n.startOffset];if(o&&o.tagName==="HR")return n.selectNodeContents(o.previousElementSibling),n.collapse(!1),i.preventDefault(),!0}if(a){var c=a.previousElementSibling;if(c&&(0,U.ED)(a,t[t.currentMode].element,n).start===0&&((0,f.gm)()&&c.tagName==="HR"||c.tagName==="TABLE")){if(c.tagName==="TABLE"){var x=c.lastElementChild.lastElementChild.lastElementChild;x.innerHTML=x.innerHTML.trimLeft()+"<wbr>"+a.textContent.trim(),a.remove()}else c.remove();return(0,U.ir)(t[t.currentMode].element,n),rt(t),i.preventDefault(),!0}}return!1},Wn=function(t){(0,f.gm)()&&t.startContainer.nodeType!==3&&t.startContainer.tagName==="HR"&&t.setStartBefore(t.startContainer)},ri=function(t,n,i){var a,o;if(!(0,f.gm)())return!1;if(t.key==="ArrowUp"&&n&&((a=n.previousElementSibling)===null||a===void 0?void 0:a.tagName)==="TABLE"){var c=n.previousElementSibling;return i.selectNodeContents(c.rows[c.rows.length-1].lastElementChild),i.collapse(!1),t.preventDefault(),!0}return t.key==="ArrowDown"&&n&&((o=n.nextElementSibling)===null||o===void 0?void 0:o.tagName)==="TABLE"?(i.selectNodeContents(n.nextElementSibling.rows[0].cells[0]),i.collapse(!0),t.preventDefault(),!0):!1},jn=function(t,n,i){return Or(void 0,void 0,void 0,function(){var a,o,c,x,A,O,L,B,K,me,pe,fe,je,ue,Se,ue,Ye;return Pr(this,function(He){switch(He.label){case 0:return t[t.currentMode].element.getAttribute("contenteditable")!=="true"?[2]:(n.stopPropagation(),n.preventDefault(),"clipboardData"in n?(a=n.clipboardData.getData("text/html"),o=n.clipboardData.getData("text/plain"),c=n.clipboardData.files):(a=n.dataTransfer.getData("text/html"),o=n.dataTransfer.getData("text/plain"),n.dataTransfer.types.includes("Files")&&(c=n.dataTransfer.items)),x={},A=function(Ze,Tt){if(!Tt)return["",Lute.WalkContinue];if(t.options.upload.renderLinkDest)return t.options.upload.renderLinkDest(t,Ze,Tt);var Ct=Ze.TokensStr();if(Ze.__internal_object__.Parent.Type===34&&Ct&&Ct.indexOf("file://")===-1&&t.options.upload.linkToImgUrl){var At=new XMLHttpRequest;At.open("POST",t.options.upload.linkToImgUrl),t.options.upload.token&&At.setRequestHeader("X-Upload-Token",t.options.upload.token),t.options.upload.withCredentials&&(At.withCredentials=!0),tn(t,At),At.setRequestHeader("Content-Type","application/json; charset=utf-8"),At.onreadystatechange=function(){if(At.readyState===XMLHttpRequest.DONE){if(At.status===200){var pn=At.responseText;t.options.upload.linkToImgFormat&&(pn=t.options.upload.linkToImgFormat(At.responseText));var nn=JSON.parse(pn);if(nn.code!==0){t.tip.show(nn.msg);return}var mn=nn.data.originalURL;if(t.currentMode==="sv")t.sv.element.querySelectorAll(".vditor-sv__marker--link").forEach(function(Wt){Wt.textContent===mn&&(Wt.textContent=nn.data.url)});else{var st=t[t.currentMode].element.querySelector('img[src="'.concat(mn,'"]'));st.src=nn.data.url,t.currentMode==="ir"&&(st.previousElementSibling.previousElementSibling.innerHTML=nn.data.url)}rt(t)}else t.tip.show(At.responseText);t.options.upload.linkToImgCallback&&t.options.upload.linkToImgCallback(At.responseText)}},At.send(JSON.stringify({url:Ct}))}return t.currentMode==="ir"?['<span class="vditor-ir__marker vditor-ir__marker--link">'.concat(Lute.EscapeHTMLStr(Ct),"</span>"),Lute.WalkContinue]:t.currentMode==="wysiwyg"?["",Lute.WalkContinue]:['<span class="vditor-sv__marker--link">'.concat(Lute.EscapeHTMLStr(Ct),"</span>"),Lute.WalkContinue]},(a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<a href="'.concat(o,'">').concat(o,"</a>")||a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<!--StartFragment--><a href="'.concat(o,'">').concat(o,"</a><!--EndFragment-->"))&&(a=""),O=new DOMParser().parseFromString(a,"text/html"),O.body&&(a=O.body.innerHTML),a=Lute.Sanitize(a),t.wysiwyg.getComments(t),L=t[t.currentMode].element.scrollHeight,B=Je(a,o,t.currentMode),K=t.currentMode==="sv"?(0,v.Th)(n.target,"data-type","code-block"):(0,v._Y)(n.target,"CODE"),K?(t.currentMode==="sv"?document.execCommand("insertHTML",!1,o.replace(/&/g,"&amp;").replace(/</g,"&lt;")):(me=(0,U.ED)(n.target,t[t.currentMode].element),K.parentElement.tagName!=="PRE"&&(o+=u.Y.ZWSP),K.textContent=K.textContent.substring(0,me.start)+o+K.textContent.substring(me.end),(0,U.Fm)(me.start+o.length,me.start+o.length,K.parentElement),!((Ye=K.parentElement)===null||Ye===void 0)&&Ye.nextElementSibling.classList.contains("vditor-".concat(t.currentMode,"__preview"))&&(K.parentElement.nextElementSibling.innerHTML=K.outerHTML,tt(K.parentElement.nextElementSibling,t))),[3,8]):[3,1]);case 1:return B?(i.pasteCode(B),[3,8]):[3,2];case 2:return a.trim()===""?[3,3]:(pe=document.createElement("div"),pe.innerHTML=a,pe.querySelectorAll("[style]").forEach(function(Ze){Ze.removeAttribute("style")}),pe.querySelectorAll(".vditor-copy").forEach(function(Ze){Ze.remove()}),t.currentMode==="ir"?(x.HTML2VditorIRDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),(0,U.Z2)(t.lute.HTML2VditorIRDOM(pe.innerHTML),t)):t.currentMode==="wysiwyg"?(x.HTML2VditorDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),(0,U.Z2)(t.lute.HTML2VditorDOM(pe.innerHTML),t)):(x.Md2VditorSVDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),Y(t,t.lute.HTML2Md(pe.innerHTML).trimRight())),t.outline.render(t),[3,8]);case 3:return c.length>0?t.options.upload.url||t.options.upload.handler?[4,hn(t,c)]:[3,5]:[3,7];case 4:return He.sent(),[3,6];case 5:fe=new FileReader,"clipboardData"in n?(c=n.clipboardData.files,je=c[0]):n.dataTransfer.types.includes("Files")&&(c=n.dataTransfer.items,je=c[0].getAsFile()),je&&je.type.startsWith("image")&&(fe.readAsDataURL(je),fe.onload=function(){var Ze="";t.currentMode==="wysiwyg"?Ze+='<img alt="'.concat(je.name,'" src="').concat(fe.result.toString(),`">
`):Ze+="![".concat(je.name,"](").concat(fe.result.toString(),`)
`),document.execCommand("insertHTML",!1,Ze)}),He.label=6;case 6:return[3,8];case 7:o.trim()!==""&&c.length===0&&(ue=(0,U.RN)(t),ue.toString()!==""&&t.lute.IsValidLinkDest(o)&&(o="[".concat(ue.toString(),"](").concat(o,")")),t.currentMode==="ir"?(x.Md2VditorIRDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),(0,U.Z2)(t.lute.Md2VditorIRDOM(o),t)):t.currentMode==="wysiwyg"?(x.Md2VditorDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),(0,U.Z2)(t.lute.Md2VditorDOM(o),t)):(x.Md2VditorSVDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:x}),Y(t,o)),t.outline.render(t)),He.label=8;case 8:return t.currentMode!=="sv"&&(Se=(0,v.pt)((0,U.RN)(t).startContainer),Se&&(ue=(0,U.RN)(t),t[t.currentMode].element.querySelectorAll("wbr").forEach(function(Ze){Ze.remove()}),ue.insertNode(document.createElement("wbr")),t.currentMode==="wysiwyg"?Se.outerHTML=t.lute.SpinVditorDOM(Se.outerHTML):Se.outerHTML=t.lute.SpinVditorIRDOM(Se.outerHTML),(0,U.ir)(t[t.currentMode].element,ue)),t[t.currentMode].element.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='2']")).forEach(function(Ze){tt(Ze,t)})),t.wysiwyg.triggerRemoveComment(t),rt(t),t[t.currentMode].element.scrollHeight-L>Math.min(t[t.currentMode].element.clientHeight,window.innerHeight)/2&&Xe(t),[2]}})})},ce,qt=function(t){var n,i;t.hint.render(t);var a=(0,U.RN)(t).startContainer,o=(0,v.Th)(a,"data-type","code-block-info");if(o)if(o.textContent.replace(u.Y.ZWSP,"")===""&&t.hint.recentLanguage){o.textContent=u.Y.ZWSP+t.hint.recentLanguage;var c=(0,U.RN)(t);c.selectNodeContents(o)}else{var x=[],A=o.textContent.substring(0,(0,U.ED)(o,t.ir.element).start).replace(u.Y.ZWSP,"");(t.options.preview.hljs.langs||u.Y.ALIAS_CODE_LANGUAGES.concat(((i=(n=window.hljs)===null||n===void 0?void 0:n.listLanguages())!==null&&i!==void 0?i:[]).sort())).forEach(function(O){O.indexOf(A.toLowerCase())>-1&&x.push({html:O,value:O})}),t.hint.genHTML(x,A,t)}},Ot=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),n.enableHint&&qt(t),clearTimeout(t.ir.processTimeoutId),t.ir.processTimeoutId=window.setTimeout(function(){if(!t.ir.composingLock){var i=S(t);typeof t.options.input=="function"&&n.enableInput&&t.options.input(i),t.options.counter.enable&&t.counter.render(t,i),t.options.cache.enable&&(0,f.D)()&&(localStorage.setItem(t.options.cache.id,i),t.options.cache.after&&t.options.cache.after(i)),t.devtools&&t.devtools.renderEchart(t),n.enableAddUndoStack&&t.undo.addToUndoStack(t)}},t.options.undoDelay)},$n=function(t,n){var i=(0,U.RN)(t),a=(0,v.pt)(i.startContainer)||i.startContainer;if(a){var o=a.querySelector(".vditor-ir__marker--heading");o?o.innerHTML=n:(a.insertAdjacentText("afterbegin",n),i.selectNodeContents(a),i.collapse(!1)),Ge(t,i.cloneRange()),on(t)}},ai=function(t,n,i){var a=(0,v.Th)(t.startContainer,"data-type",i);if(a){a.firstElementChild.remove(),a.lastElementChild.remove(),t.insertNode(document.createElement("wbr"));var o=document.createElement("div");o.innerHTML=n.lute.SpinVditorIRDOM(a.outerHTML),a.outerHTML=o.firstElementChild.innerHTML.trim()}},ao=function(t,n,i,a){var o=(0,U.RN)(t),c=n.getAttribute("data-type"),x=o.startContainer;x.nodeType===3&&(x=x.parentElement);var A=!0;if(n.classList.contains("vditor-menu--current"))if(c==="quote"){var O=(0,v._Y)(x,"BLOCKQUOTE");O&&(o.insertNode(document.createElement("wbr")),O.outerHTML=O.innerHTML.trim()===""?'<p data-block="0">'.concat(O.innerHTML,"</p>"):O.innerHTML)}else if(c==="link"){var L=(0,v.Th)(o.startContainer,"data-type","a");if(L){var B=(0,v.KJ)(o.startContainer,"vditor-ir__link");B?(o.insertNode(document.createElement("wbr")),L.outerHTML=B.innerHTML):L.outerHTML=L.querySelector(".vditor-ir__link").innerHTML+"<wbr>"}}else c==="italic"?ai(o,t,"em"):c==="bold"?ai(o,t,"strong"):c==="strike"?ai(o,t,"s"):c==="inline-code"?ai(o,t,"code"):(c==="check"||c==="list"||c==="ordered-list")&&(xi(t,o,c),A=!1,n.classList.remove("vditor-menu--current"));else{t.ir.element.childNodes.length===0&&(t.ir.element.innerHTML='<p data-block="0"><wbr></p>',(0,U.ir)(t.ir.element,o));var K=(0,v.pt)(o.startContainer);if(c==="line"){if(K){var me=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;K.innerHTML.trim()===""?K.outerHTML=me:K.insertAdjacentHTML("afterend",me)}}else if(c==="quote")K&&(o.insertNode(document.createElement("wbr")),K.outerHTML='<blockquote data-block="0">'.concat(K.outerHTML,"</blockquote>"),A=!1,n.classList.add("vditor-menu--current"));else if(c==="link"){var pe=void 0;o.toString()===""?pe="".concat(i,"<wbr>").concat(a):pe="".concat(i).concat(o.toString()).concat(a.replace(")","<wbr>)")),document.execCommand("insertHTML",!1,pe),A=!1,n.classList.add("vditor-menu--current")}else if(c==="italic"||c==="bold"||c==="strike"||c==="inline-code"||c==="code"||c==="table"){var pe=void 0;o.toString()===""?pe="".concat(i,"<wbr>").concat(a):(c==="code"?pe="".concat(i,`
`).concat(o.toString(),"<wbr>").concat(a):c==="table"?pe="".concat(i).concat(o.toString(),"<wbr>").concat(a):pe="".concat(i).concat(o.toString()).concat(a,"<wbr>"),o.deleteContents()),(c==="table"||c==="code")&&(pe=`
`+pe+`

`);var fe=document.createElement("span");fe.innerHTML=pe,o.insertNode(fe),Ge(t,o),c==="table"&&(o.selectNodeContents(getSelection().getRangeAt(0).startContainer.parentElement),(0,U.jl)(o))}else(c==="check"||c==="list"||c==="ordered-list")&&(xi(t,o,c,!1),A=!1,b(t.toolbar.elements,["check","list","ordered-list"]),n.classList.add("vditor-menu--current"))}(0,U.ir)(t.ir.element,o),Ot(t),A&&on(t)},Mi=function(t,n,i,a){function o(c){return c instanceof i?c:new i(function(x){x(c)})}return new(i||(i=Promise))(function(c,x){function A(B){try{L(a.next(B))}catch(K){x(K)}}function O(B){try{L(a.throw(B))}catch(K){x(K)}}function L(B){B.done?c(B.value):o(B.value).then(A,O)}L((a=a.apply(t,n||[])).next())})},Gs=function(t,n){var i={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,o,c,x;return x={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(x[Symbol.iterator]=function(){return this}),x;function A(L){return function(B){return O([L,B])}}function O(L){if(a)throw new TypeError("Generator is already executing.");for(;x&&(x=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(c=L[0]&2?o.return:L[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,L[1])).done)return c;switch(o=0,c&&(L=[L[0]&2,c.value]),L[0]){case 0:case 1:c=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(c=i.trys,!(c=c.length>0&&c[c.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!c||L[1]>c[0]&&L[1]<c[3])){i.label=L[1];break}if(L[0]===6&&i.label<c[1]){i.label=c[1],c=L;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(L);break}c[2]&&i.ops.pop(),i.trys.pop();continue}L=n.call(t,i)}catch(B){L=[6,B],o=0}finally{a=c=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},Xs=function(){function t(n){var i=this;this.splitChar="",this.lastIndex=-1,this.fillEmoji=function(a,o){i.element.style.display="none";var c=decodeURIComponent(a.getAttribute("data-value")),x=window.getSelection().getRangeAt(0);if(o.currentMode==="ir"){var A=(0,v.Th)(x.startContainer,"data-type","code-block-info");if(A){A.textContent=u.Y.ZWSP+c.trimRight(),x.selectNodeContents(A),x.collapse(!1),Ot(o),A.parentElement.querySelectorAll("code").forEach(function(K){K.className="language-"+c.trimRight()}),tt(A.parentElement.querySelector(".vditor-ir__preview"),o),i.recentLanguage=c.trimRight();return}}if(o.currentMode==="wysiwyg"&&x.startContainer.nodeType!==3){var O=x.startContainer,L=void 0;if(O.classList.contains("vditor-input")?L=O:L=O.firstElementChild,L&&L.classList.contains("vditor-input")){L.value=c.trimRight(),x.selectNodeContents(L),x.collapse(!1),L.dispatchEvent(new CustomEvent("input",{detail:1})),i.recentLanguage=c.trimRight();return}}if(x.setStart(x.startContainer,i.lastIndex),x.deleteContents(),o.options.hint.parse?o.currentMode==="sv"?(0,U.Z2)(o.lute.SpinVditorSVDOM(c),o):o.currentMode==="wysiwyg"?(0,U.Z2)(o.lute.SpinVditorDOM(c),o):(0,U.Z2)(o.lute.SpinVditorIRDOM(c),o):(0,U.Z2)(c,o),i.splitChar===":"&&c.indexOf(":")>-1&&o.currentMode!=="sv"&&x.insertNode(document.createTextNode(" ")),x.collapse(!1),(0,U.jl)(x),o.currentMode==="wysiwyg"){var B=(0,v.KJ)(x.startContainer,"vditor-wysiwyg__block");B&&B.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(B.lastElementChild.innerHTML=B.firstElementChild.innerHTML,tt(B.lastElementChild,o))}else if(o.currentMode==="ir"){var B=(0,v.KJ)(x.startContainer,"vditor-ir__marker--pre");B&&B.nextElementSibling.classList.contains("vditor-ir__preview")&&(B.nextElementSibling.innerHTML=B.innerHTML,tt(B.nextElementSibling,o))}rt(o)},this.timeId=-1,this.element=document.createElement("div"),this.element.className="vditor-hint",this.recentLanguage="",n.push({key:":"})}return t.prototype.render=function(n){var i=this;if(window.getSelection().focusNode){var a,o=getSelection().getRangeAt(0);a=o.startContainer.textContent.substring(0,o.startOffset)||"";var c=this.getKey(a,n.options.hint.extend);if(typeof c>"u")this.element.style.display="none",clearTimeout(this.timeId);else if(this.splitChar===":"){var x=c===""?n.options.hint.emoji:n.lute.GetEmojis(),A=[];Object.keys(x).forEach(function(O){O.indexOf(c.toLowerCase())===0&&(x[O].indexOf(".")>-1?A.push({html:'<img src="'.concat(x[O],'" title=":').concat(O,':"/> :').concat(O,":"),value:":".concat(O,":")}):A.push({html:'<span class="vditor-hint__emoji">'.concat(x[O],"</span>").concat(O),value:x[O]}))}),this.genHTML(A,c,n)}else n.options.hint.extend.forEach(function(O){O.key===i.splitChar&&(clearTimeout(i.timeId),i.timeId=window.setTimeout(function(){return Mi(i,void 0,void 0,function(){var L;return Gs(this,function(B){switch(B.label){case 0:return L=this.genHTML,[4,O.hint(c)];case 1:return L.apply(this,[B.sent(),c,n]),[2]}})})},n.options.hint.delay))})}},t.prototype.genHTML=function(n,i,a){var o=this;if(n.length===0){this.element.style.display="none";return}var c=a[a.currentMode].element,x=(0,U.Ey)(c),A=x.left+(a.options.outline.position==="left"?a.outline.element.offsetWidth:0),O=x.top,L="";n.forEach(function(K,me){if(!(me>7)){var pe=K.html;if(i!==""){var fe=pe.lastIndexOf(">")+1,je=pe.substr(fe),Se=je.toLowerCase().indexOf(i.toLowerCase());Se>-1&&(je=je.substring(0,Se)+"<b>"+je.substring(Se,Se+i.length)+"</b>"+je.substring(Se+i.length),pe=pe.substr(0,fe)+je)}L+='<button type="button" data-value="'.concat(encodeURIComponent(K.value),` "
`).concat(me===0?"class='vditor-hint--current'":"","> ").concat(pe,"</button>")}}),this.element.innerHTML=L;var B=parseInt(document.defaultView.getComputedStyle(c,null).getPropertyValue("line-height"),10);this.element.style.top="".concat(O+(B||22),"px"),this.element.style.left="".concat(A,"px"),this.element.style.display="block",this.element.style.right="auto",this.element.querySelectorAll("button").forEach(function(K){K.addEventListener("click",function(me){o.fillEmoji(K,a),me.preventDefault()})}),this.element.getBoundingClientRect().bottom>window.innerHeight&&(this.element.style.top="".concat(O-this.element.offsetHeight,"px")),this.element.getBoundingClientRect().right>window.innerWidth&&(this.element.style.left="auto",this.element.style.right="0")},t.prototype.select=function(n,i){if(this.element.querySelectorAll("button").length===0||this.element.style.display==="none")return!1;var a=this.element.querySelector(".vditor-hint--current");if(n.key==="ArrowDown")return n.preventDefault(),n.stopPropagation(),a.removeAttribute("class"),a.nextElementSibling?a.nextElementSibling.className="vditor-hint--current":this.element.children[0].className="vditor-hint--current",!0;if(n.key==="ArrowUp"){if(n.preventDefault(),n.stopPropagation(),a.removeAttribute("class"),a.previousElementSibling)a.previousElementSibling.className="vditor-hint--current";else{var o=this.element.children.length;this.element.children[o-1].className="vditor-hint--current"}return!0}else if(!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&n.key==="Enter"&&!n.isComposing)return n.preventDefault(),n.stopPropagation(),this.fillEmoji(a,i),!0;return!1},t.prototype.getKey=function(n,i){var a=this;this.lastIndex=-1,this.splitChar="",i.forEach(function(L){var B=n.lastIndexOf(L.key);a.lastIndex<B&&(a.splitChar=L.key,a.lastIndex=B)});var o;if(this.lastIndex===-1)return o;var c=n.split(this.splitChar),x=c[c.length-1],A=32;if(c.length>1&&x.trim()===x)if(c.length===2&&c[0]===""&&c[1].length<A)o=c[1];else{var O=c[c.length-2].slice(-1);(0,g.p)(O)===" "&&x.length<A&&(o=x)}return o},t}(),Zs=function(){function t(n){this.composingLock=!1;var i=document.createElement("div");i.className="vditor-ir",i.innerHTML='<pre class="vditor-reset" placeholder="'.concat(n.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>`),this.element=i.firstElementChild,this.bindEvent(n),Bt(n,this.element),Rn(n,this.element),ti(n,this.element),at(n,this.element),Pt(n,this.element),Mn(n,this.element),en(n,this.element,this.copy),In(n,this.element,this.copy)}return t.prototype.copy=function(n,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){n.stopPropagation(),n.preventDefault();var o=document.createElement("div");o.appendChild(a.cloneContents()),n.clipboardData.setData("text/plain",i.lute.VditorIRDOM2Md(o.innerHTML).trim()),n.clipboardData.setData("text/html","")}},t.prototype.bindEvent=function(n){var i=this;this.element.addEventListener("paste",function(a){jn(n,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){T(n,["hint"])}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,f.gm)()||Ge(n,getSelection().getRangeAt(0).cloneRange()),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,Ot(n,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"||Ge(n,getSelection().getRangeAt(0).cloneRange(),!1,a)}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){a.target.checked?a.target.setAttribute("checked","checked"):a.target.removeAttribute("checked"),i.preventInput=!0,Ot(n);return}var o=(0,U.RN)(n),c=(0,v.KJ)(a.target,"vditor-ir__preview");if(c||(c=(0,v.KJ)(o.startContainer,"vditor-ir__preview")),c&&(c.previousElementSibling.firstElementChild?o.selectNodeContents(c.previousElementSibling.firstElementChild):o.selectNodeContents(c.previousElementSibling),o.collapse(!0),(0,U.jl)(o),Xe(n)),a.target.tagName==="IMG"){var x=a.target.parentElement.querySelector(".vditor-ir__marker--link");x&&(o.selectNode(x),(0,U.jl)(o))}var A=(0,v.Th)(a.target,"data-type","a");if(A&&!A.classList.contains("vditor-ir__node--expand")){n.options.link.click?n.options.link.click(A.querySelector(":scope > .vditor-ir__marker--link")):n.options.link.isOpen&&window.open(A.querySelector(":scope > .vditor-ir__marker--link").textContent);return}if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&o.collapsed){var O=i.element.lastElementChild.getBoundingClientRect();a.y>O.top+O.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(u.Y.ZWSP,"")===""?(o.selectNodeContents(i.element.lastElementChild),o.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,U.ir)(i.element,o)))}o.toString()===""?ee(o,n):setTimeout(function(){ee((0,U.RN)(n),n)}),re(a,n),on(n)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,f._0)(a))){if(a.key==="Enter"&&Xe(n),on(n),(a.key==="Backspace"||a.key==="Delete")&&n.ir.element.innerHTML!==""&&n.ir.element.childNodes.length===1&&n.ir.element.firstElementChild&&n.ir.element.firstElementChild.tagName==="P"&&n.ir.element.firstElementChild.childElementCount===0&&(n.ir.element.textContent===""||n.ir.element.textContent===`
`)){n.ir.element.innerHTML="";return}var o=(0,U.RN)(n);a.key==="Backspace"?((0,f.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent="",ee(o,n)),i.element.querySelectorAll(".language-math").forEach(function(x){var A=x.querySelector("br");A&&A.remove()})):a.key.indexOf("Arrow")>-1?((a.key==="ArrowLeft"||a.key==="ArrowRight")&&qt(n),ee(o,n)):a.keyCode===229&&a.code===""&&a.key==="Unidentified"&&ee(o,n);var c=(0,v.KJ)(o.startContainer,"vditor-ir__preview");if(c){if(a.key==="ArrowUp"||a.key==="ArrowLeft")return c.previousElementSibling.firstElementChild?o.selectNodeContents(c.previousElementSibling.firstElementChild):o.selectNodeContents(c.previousElementSibling),o.collapse(!1),a.preventDefault(),!0;if(c.tagName==="SPAN"&&(a.key==="ArrowDown"||a.key==="ArrowRight"))return c.parentElement.getAttribute("data-type")==="html-entity"?(c.parentElement.insertAdjacentText("afterend",u.Y.ZWSP),o.setStart(c.parentElement.nextSibling,1)):o.selectNodeContents(c.parentElement.lastElementChild),o.collapse(!1),a.preventDefault(),!0}}})},t}(),oo=function(t){if(t.currentMode==="sv")return t.lute.Md2HTML(S(t));if(t.currentMode==="wysiwyg")return t.lute.VditorDOM2HTML(t.wysiwyg.element.innerHTML);if(t.currentMode==="ir")return t.lute.VditorIRDOM2HTML(t.ir.element.innerHTML)},Js=l(796),so=l(70),Qs=function(){function t(n){this.element=document.createElement("div"),this.element.className="vditor-outline",this.element.innerHTML='<div class="vditor-outline__title">'.concat(n,`</div>
<div class="vditor-outline__content"></div>`)}return t.prototype.render=function(n){var i="";return n.preview.element.style.display==="block"?i=(0,so.N)(n.preview.previewElement,this.element.lastElementChild,n):i=(0,so.N)(n[n.currentMode].element,this.element.lastElementChild,n),i},t.prototype.toggle=function(n,i,a){var o;i===void 0&&(i=!0),a===void 0&&(a=!0);var c=(o=n.toolbar.elements.outline)===null||o===void 0?void 0:o.firstElementChild;if(i&&window.innerWidth>=u.Y.MOBILE_WIDTH?(this.element.style.display="block",this.render(n),c==null||c.classList.add("vditor-menu--current")):(this.element.style.display="none",c==null||c.classList.remove("vditor-menu--current")),a&&getSelection().rangeCount>0){var x=getSelection().getRangeAt(0);n[n.currentMode].element.contains(x.startContainer)&&(0,U.jl)(x)}dt(n)},t}(),el=l(0),tl=function(){function t(n){var i=this;this.element=document.createElement("div"),this.element.className="vditor-preview",this.previewElement=document.createElement("div"),this.previewElement.className="vditor-reset",n.options.classes.preview&&this.previewElement.classList.add(n.options.classes.preview),this.previewElement.style.maxWidth=n.options.preview.maxWidth+"px",this.previewElement.addEventListener("copy",function(O){if(O.target.tagName!=="TEXTAREA"){var L=document.createElement("div");L.className="vditor-reset",L.appendChild(getSelection().getRangeAt(0).cloneContents()),i.copyToX(n,L,"default"),O.preventDefault()}}),this.previewElement.addEventListener("click",function(O){var L=(0,v._Y)(O.target,"SPAN");if(L&&(0,v.KJ)(L,"vditor-toc")){var B=i.previewElement.querySelector("#"+L.getAttribute("data-target-id"));B&&(i.element.scrollTop=B.offsetTop);return}if(O.target.tagName==="A"){n.options.link.click?n.options.link.click(O.target):n.options.link.isOpen&&window.open(O.target.getAttribute("href")),O.preventDefault();return}O.target.tagName==="IMG"&&(n.options.image.preview?n.options.image.preview(O.target):n.options.image.isPreview&&(0,ye.o)(O.target,n.options.lang,n.options.theme))}),this.element.appendChild(this.previewElement);var a=n.options.preview.actions;if(a.length!==0){var o=document.createElement("div");o.className="vditor-preview__action";for(var c=[],x=0;x<a.length;x++){var A=a[x];if(typeof A=="object"){c.push('<button type="button" data-type="'.concat(A.key,'" class="').concat(A.className,'"').concat(A.tooltip?' aria-label="'.concat(A.tooltip,'"'):"",'">').concat(A.text,"</button>"));continue}switch(A){case"desktop":c.push('<button type="button" class="vditor-preview__action--current" data-type="desktop">Desktop</button>');break;case"tablet":c.push('<button type="button" data-type="tablet">Tablet</button>');break;case"mobile":c.push('<button type="button" data-type="mobile">Mobile/Wechat</button>');break;case"mp-wechat":c.push('<button type="button" data-type="mp-wechat" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到公众号"><svg><use xlink:href="#vditor-icon-mp-wechat"></use></svg></button>');break;case"zhihu":c.push('<button type="button" data-type="zhihu" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到知乎"><svg><use xlink:href="#vditor-icon-zhihu"></use></svg></button>');break}}o.innerHTML=c.join(""),o.addEventListener((0,f.y3)(),function(O){var L=(0,D.f)(O.target,"BUTTON");if(L){var B=L.getAttribute("data-type"),K=a.find(function(me){return(me==null?void 0:me.key)===B});if(K){K.click(B);return}if(B==="mp-wechat"||B==="zhihu"){i.copyToX(n,i.previewElement.cloneNode(!0),B);return}B==="desktop"?i.previewElement.style.width="auto":B==="tablet"?i.previewElement.style.width="780px":i.previewElement.style.width="360px",i.previewElement.scrollWidth>i.previewElement.parentElement.clientWidth&&(i.previewElement.style.width="auto"),i.render(n),o.querySelectorAll("button").forEach(function(me){me.classList.remove("vditor-preview__action--current")}),L.classList.add("vditor-preview__action--current")}}),this.element.insertBefore(o,this.previewElement)}}return t.prototype.render=function(n,i){var a=this;if(clearTimeout(this.mdTimeoutId),this.element.style.display==="none"){this.element.getAttribute("data-type")==="renderPerformance"&&n.tip.hide();return}if(i){this.previewElement.innerHTML=i;return}if(S(n).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")===""){this.previewElement.innerHTML="";return}var o=new Date().getTime(),c=S(n);this.mdTimeoutId=window.setTimeout(function(){if(n.options.preview.url){var x=new XMLHttpRequest;x.open("POST",n.options.preview.url),x.setRequestHeader("Content-Type","application/json;charset=UTF-8"),x.onreadystatechange=function(){if(x.readyState===XMLHttpRequest.DONE)if(x.status===200){var O=JSON.parse(x.responseText);if(O.code!==0){n.tip.show(O.msg);return}n.options.preview.transform&&(O.data=n.options.preview.transform(O.data)),a.previewElement.innerHTML=O.data,a.afterRender(n,o)}else{var L=n.lute.Md2HTML(c);n.options.preview.transform&&(L=n.options.preview.transform(L)),a.previewElement.innerHTML=L,a.afterRender(n,o)}},x.send(JSON.stringify({markdownText:c}))}else{var A=n.lute.Md2HTML(c);n.options.preview.transform&&(A=n.options.preview.transform(A)),a.previewElement.innerHTML=A,a.afterRender(n,o)}},n.options.preview.delay)},t.prototype.afterRender=function(n,i){n.options.preview.parse&&n.options.preview.parse(this.element);var a=new Date().getTime()-i;new Date().getTime()-i>2600?(n.tip.show(window.VditorI18n.performanceTip.replace("${x}",a.toString())),n.preview.element.setAttribute("data-type","renderPerformance")):n.preview.element.getAttribute("data-type")==="renderPerformance"&&(n.tip.hide(),n.preview.element.removeAttribute("data-type"));var o=n.preview.element.querySelector(".vditor-comment--focus");o&&o.classList.remove("vditor-comment--focus"),(0,$.o)(n.preview.previewElement,n.options.preview.hljs),(0,le.$)(n.options.preview.hljs,n.preview.previewElement,n.options.cdn),(0,Pe.e)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,Ue.K)(n.preview.previewElement,n.options.cdn),(0,Re.Y)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,z.D)(n.preview.previewElement,n.options.cdn),(0,F.m)(n.preview.previewElement,n.options.cdn),(0,H.v)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,Te.l)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,Le.M)(n.preview.previewElement,n.options.cdn),(0,V.$)(n.preview.previewElement,n.options.cdn),n.options.preview.render.media.enable&&(0,el.l)(n.preview.previewElement),n.options.customRenders.forEach(function(A){A.render(n.preview.previewElement,n)});var c=n.preview.element,x=n.outline.render(n);x===""&&(x="[ToC]"),c.querySelectorAll('[data-type="toc-block"]').forEach(function(A){A.innerHTML=x,(0,de.T)(A,{cdn:n.options.cdn,math:n.options.preview.math})}),(0,de.T)(n.preview.previewElement,{cdn:n.options.cdn,math:n.options.preview.math})},t.prototype.copyToX=function(n,i,a){a===void 0&&(a="mp-wechat"),a!=="zhihu"?i.querySelectorAll(".katex-html .base").forEach(function(c){c.style.display="initial"}):i.querySelectorAll(".language-math").forEach(function(c){c.outerHTML='<img class="Formula-image" data-eeimg="true" src="//www.zhihu.com/equation?tex=" alt="'.concat(c.getAttribute("data-math"),'\\" style="display: block; margin: 0 auto; max-width: 100%;">')}),i.style.backgroundColor="#fff",i.querySelectorAll("code").forEach(function(c){c.style.backgroundImage="none"}),this.element.append(i);var o=i.ownerDocument.createRange();o.selectNode(i),(0,U.jl)(o),document.execCommand("copy"),i.remove(),n.tip.show(["zhihu","mp-wechat"].includes(a)?"已复制，可到".concat(a==="zhihu"?"知乎":"微信公众号平台","进行粘贴"):"已复制到剪切板")},t}(),nl=function(){function t(n){this.element=document.createElement("div"),this.element.className="vditor-resize vditor-resize--".concat(n.options.resize.position),this.element.innerHTML='<div><svg><use xlink:href="#vditor-icon-resize"></use></svg></div>',this.bindEvent(n)}return t.prototype.bindEvent=function(n){var i=this;this.element.addEventListener("mousedown",function(a){var o=document,c=a.clientY,x=n.element.offsetHeight,A=63+n.element.querySelector(".vditor-toolbar").clientHeight;o.ondragstart=function(){return!1},window.captureEvents&&window.captureEvents(),i.element.classList.add("vditor-resize--selected"),o.onmousemove=function(O){n.options.resize.position==="top"?n.element.style.height=Math.max(A,x+(c-O.clientY))+"px":n.element.style.height=Math.max(A,x+(O.clientY-c))+"px",n.options.typewriterMode&&(n.sv.element.style.paddingBottom=n.sv.element.parentElement.offsetHeight/2+"px")},o.onmouseup=function(){n.options.resize.after&&n.options.resize.after(n.element.offsetHeight-x),window.captureEvents&&window.captureEvents(),o.onmousemove=null,o.onmouseup=null,o.ondragstart=null,o.onselectstart=null,o.onselect=null,i.element.classList.remove("vditor-resize--selected")}})},t}(),il=function(){function t(n){this.composingLock=!1,this.element=document.createElement("pre"),this.element.className="vditor-sv vditor-reset",this.element.setAttribute("placeholder",n.options.placeholder),this.element.setAttribute("contenteditable","true"),this.element.setAttribute("spellcheck","false"),this.bindEvent(n),Bt(n,this.element),ti(n,this.element),at(n,this.element),Pt(n,this.element),Mn(n,this.element),en(n,this.element,this.copy),In(n,this.element,this.copy)}return t.prototype.copy=function(n,i){n.stopPropagation(),n.preventDefault(),n.clipboardData.setData("text/plain",$t(i[i.currentMode].element))},t.prototype.bindEvent=function(n){var i=this;this.element.addEventListener("paste",function(a){jn(n,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){if(n.preview.element.style.display==="block"){var a=i.element.scrollTop,o=i.element.clientHeight,c=i.element.scrollHeight-parseFloat(i.element.style.paddingBottom||"0"),x=n.preview.element;a/o>.5?x.scrollTop=(a+o)*x.scrollHeight/c-o:x.scrollTop=a*x.scrollHeight/c}}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,f.gm)()||Ve(n,a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")&&!(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《")){if(i.preventInput){i.preventInput=!1,ze(n,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}Ve(n,a)}}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,f._0)(a))){if((a.key==="Backspace"||a.key==="Delete")&&n.sv.element.innerHTML!==""&&n.sv.element.childNodes.length===1&&n.sv.element.firstElementChild&&n.sv.element.firstElementChild.tagName==="DIV"&&n.sv.element.firstElementChild.childElementCount===2&&(n.sv.element.firstElementChild.textContent===""||n.sv.element.textContent===`
`)){n.sv.element.innerHTML="";return}a.key==="Enter"&&Xe(n)}})},t}(),lo=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-tip"}return t.prototype.show=function(n,i){var a=this;i===void 0&&(i=6e3),this.element.className="vditor-tip vditor-tip--show",i===0?(this.element.innerHTML='<div class="vditor-tip__content">'.concat(n,`
<div class="vditor-tip__close">X</div></div>`),this.element.querySelector(".vditor-tip__close").addEventListener("click",function(){a.hide()})):(this.element.innerHTML='<div class="vditor-tip__content">'.concat(n,"</div>"),setTimeout(function(){a.hide()},i)),this.element.removeAttribute("style"),setTimeout(function(){var o=a.element.getBoundingClientRect();o.top<46&&(a.element.style.position="fixed",a.element.style.top="46px")},150)},t.prototype.hide=function(){this.element.className="vditor-messageElementtip",this.element.innerHTML=""},t}(),ma=function(t,n){if(n.options.preview.mode!==t){switch(n.options.preview.mode=t,t){case"both":n.sv.element.style.display="block",n.preview.element.style.display="block",n.preview.render(n),y(n.toolbar.elements,["both"]);break;case"editor":n.sv.element.style.display="block",n.preview.element.style.display="none",b(n.toolbar.elements,["both"]);break}n.devtools&&n.devtools.renderEchart(n)}},rl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),al=function(t){rl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return i.options.preview.mode==="both"&&o.element.children[0].classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,f.y3)(),function(c){var x=o.element.firstElementChild;x.classList.contains(u.Y.CLASS_MENU_DISABLED)||(c.preventDefault(),i.currentMode==="sv"&&(i.options.preview.mode==="both"?ma("editor",i):ma("both",i)))}),o}return n}(wt),ol=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__br"}return t}(),co=l(13),sl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ll=function(t){sl(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=o.element.children[0],x=document.createElement("div");x.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var A="";return u.Y.CODE_THEME.forEach(function(O){A+="<button>".concat(O,"</button>")}),x.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(A,"</div>"),x.addEventListener((0,f.y3)(),function(O){O.target.tagName==="BUTTON"&&(T(i,["subToolbar"]),i.options.preview.hljs.style=O.target.textContent,(0,co.h)(O.target.textContent,i.options.cdn),O.preventDefault(),O.stopPropagation())}),o.element.appendChild(x),M(i,x,c,a.level),o}return n}(wt),cl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ul=function(t){cl(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=o.element.children[0],x=document.createElement("div");x.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var A="";return Object.keys(i.options.preview.theme.list).forEach(function(O){A+='<button data-type="'.concat(O,'">').concat(i.options.preview.theme.list[O],"</button>")}),x.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(A,"</div>"),x.addEventListener((0,f.y3)(),function(O){O.target.tagName==="BUTTON"&&(T(i,["subToolbar"]),i.options.preview.theme.current=O.target.getAttribute("data-type"),(0,De.H)(i.options.preview.theme.current,i.options.preview.theme.path),O.preventDefault(),O.stopPropagation())}),o.element.appendChild(x),M(i,x,c,a.level),o}return n}(wt),dl=function(){function t(n){this.element=document.createElement("span"),this.element.className="vditor-counter vditor-tooltipped vditor-tooltipped__nw",this.render(n,"")}return t.prototype.render=function(n,i){var a=i.endsWith(`
`)?i.length-1:i.length;if(n.options.counter.type==="text"&&n[n.currentMode]){var o=n[n.currentMode].element.cloneNode(!0);o.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(c){c.remove()}),a=o.textContent.length}typeof n.options.counter.max=="number"?(a>n.options.counter.max?this.element.className="vditor-counter vditor-counter--error":this.element.className="vditor-counter",this.element.innerHTML="".concat(a,"/").concat(n.options.counter.max)):this.element.innerHTML="".concat(a),this.element.setAttribute("aria-label",n.options.counter.type),n.options.counter.after&&n.options.counter.after(a,{enable:n.options.counter.enable,max:n.options.counter.max,type:n.options.counter.type})},t}(),fl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),hl=function(t){fl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].innerHTML=a.icon,o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!c.currentTarget.classList.contains(u.Y.CLASS_MENU_DISABLED)&&a.click(c,i)}),o}return n}(wt),pl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ml=function(t){pl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.firstElementChild.addEventListener((0,f.y3)(),function(c){var x=o.element.firstElementChild;x.classList.contains(u.Y.CLASS_MENU_DISABLED)||(c.preventDefault(),x.classList.contains("vditor-menu--current")?(x.classList.remove("vditor-menu--current"),i.devtools.element.style.display="none",dt(i)):(x.classList.add("vditor-menu--current"),i.devtools.element.style.display="block",dt(i),i.devtools.renderEchart(i)))}),o}return n}(wt),gl=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__divider"}return t}(),vl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),bl=function(t){vl(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=document.createElement("div");c.className="vditor-panel vditor-panel--arrow";var x="";return Object.keys(i.options.hint.emoji).forEach(function(A){var O=i.options.hint.emoji[A];O.indexOf(".")>-1?x+='<button data-value=":'.concat(A,': " data-key=":').concat(A,`:"><img
data-value=":`).concat(A,': " data-key=":').concat(A,':" class="vditor-emojis__icon" src="').concat(O,'"/></button>'):x+='<button data-value="'.concat(O,` "
 data-key="`).concat(A,'"><span class="vditor-emojis__icon">').concat(O,"</span></button>")}),c.innerHTML='<div class="vditor-emojis" style="max-height: '.concat(i.options.height==="auto"?"auto":i.options.height-80,'px">').concat(x,`</div><div class="vditor-emojis__tail">
    <span class="vditor-emojis__tip"></span><span>`).concat(i.options.hint.emojiTail||"",`</span>
</div>`),o.element.appendChild(c),M(i,c,o.element.firstElementChild,a.level),o.bindEvent(i),o}return n.prototype.bindEvent=function(i){var a=this;this.element.lastElementChild.addEventListener((0,f.y3)(),function(o){var c=(0,D.f)(o.target,"BUTTON");if(c){o.preventDefault();var x=c.getAttribute("data-value"),A=(0,U.RN)(i),O=x;if(i.currentMode==="wysiwyg"?O=i.lute.SpinVditorDOM(x):i.currentMode==="ir"&&(O=i.lute.SpinVditorIRDOM(x)),x.indexOf(":")>-1&&i.currentMode!=="sv"){var L=document.createElement("div");L.innerHTML=O,O=L.firstElementChild.firstElementChild.outerHTML+" ",(0,U.Z2)(O,i)}else A.extractContents(),A.insertNode(document.createTextNode(x)),(0,v.pt)(A.startContainer)||Ft(i,A);A.collapse(!1),(0,U.jl)(A),a.element.lastElementChild.style.display="none",rt(i)}}),this.element.lastElementChild.addEventListener("mouseover",function(o){var c=(0,D.f)(o.target,"BUTTON");c&&(a.element.querySelector(".vditor-emojis__tip").innerHTML=c.getAttribute("data-key"))})},n}(wt),uo=function(t,n,i){var a=document.createElement("a");"download"in a?(a.download=i,a.style.display="none",a.href=URL.createObjectURL(new Blob([n])),document.body.appendChild(a),a.click(),a.remove()):t.tip.show(window.VditorI18n.downloadTip,0)},yl=function(t){var n=S(t);uo(t,n,n.substr(0,10)+".md")},wl=function(t){t.tip.show(window.VditorI18n.generate,3800);var n=document.querySelector("#vditorExportIframe");n.contentDocument.open(),n.contentDocument.write('<link rel="stylesheet" href="'.concat(t.options.cdn,`/dist/index.css"/>
<script src="`).concat(t.options.cdn,`/dist/method.min.js"><\/script>
<div id="preview" style="width: 800px"></div>
<script>
window.addEventListener("message", (e) => {
  if(!e.data) {
    return;
  }
  Vditor.preview(document.getElementById('preview'), e.data, {
    cdn: "`).concat(t.options.cdn,`",
    markdown: {
      theme: `).concat(JSON.stringify(t.options.preview.theme),`
    },
    hljs: {
      style: "`).concat(t.options.preview.hljs.style,`"
    }
  });
  setTimeout(() => {
        window.print();
    }, 3600);
}, false);
<\/script>`)),n.contentDocument.close(),setTimeout(function(){n.contentWindow.postMessage(S(t),"*")},200)},kl=function(t){var n=oo(t),i='<html><head><link rel="stylesheet" type="text/css" href="'.concat(t.options.cdn,`/dist/index.css"/>
<script src="`).concat(t.options.cdn,"/dist/js/i18n/").concat(t.options.lang,`.js"><\/script>
<script src="`).concat(t.options.cdn,`/dist/method.min.js"><\/script></head>
<body><div class="vditor-reset" id="preview">`).concat(n,`</div>
<script>
    const previewElement = document.getElementById('preview')
    Vditor.setContentTheme('`).concat(t.options.preview.theme.current,"', '").concat(t.options.preview.theme.path,`');
    Vditor.codeRender(previewElement);
    Vditor.highlightRender(`).concat(JSON.stringify(t.options.preview.hljs),", previewElement, '").concat(t.options.cdn,`');
    Vditor.mathRender(previewElement, {
        cdn: '`).concat(t.options.cdn,`',
        math: `).concat(JSON.stringify(t.options.preview.math),`,
    });
    Vditor.mermaidRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.SMILESRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.markmapRender(previewElement, '`).concat(t.options.cdn,`');
    Vditor.flowchartRender(previewElement, '`).concat(t.options.cdn,`');
    Vditor.graphvizRender(previewElement, '`).concat(t.options.cdn,`');
    Vditor.chartRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.mindmapRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.abcRender(previewElement, '`).concat(t.options.cdn,`');
    `).concat(t.options.preview.render.media.enable?"Vditor.mediaRender(previewElement);":"",`
    Vditor.speechRender(previewElement);
<\/script>
<script src="`).concat(t.options.cdn,"/dist/js/icons/").concat(t.options.icon,'.js"><\/script></body></html>');uo(t,i,n.substr(0,10)+".html")},El=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Sl=function(t){El(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=o.element.children[0],x=document.createElement("div");return x.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),x.innerHTML=`<button data-type="markdown">Markdown</button>
<button data-type="pdf">PDF</button>
<button data-type="html">HTML</button>`,x.addEventListener((0,f.y3)(),function(A){var O=A.target;if(O.tagName==="BUTTON"){switch(O.getAttribute("data-type")){case"markdown":yl(i);break;case"pdf":wl(i);break;case"html":kl(i);break}T(i,["subToolbar"]),A.preventDefault(),A.stopPropagation()}}),o.element.appendChild(x),M(i,x,c,a.level),o}return n}(wt),xl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Cl=function(t){xl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o._bindEvent(i,a),o}return n.prototype._bindEvent=function(i,a){this.element.children[0].addEventListener((0,f.y3)(),function(o){o.preventDefault(),i.element.className.includes("vditor--fullscreen")?(a.level||(this.innerHTML=a.icon),i.element.style.zIndex="",document.body.style.overflow="",i.element.classList.remove("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(c){var x=i.toolbar.elements[c].firstChild;x&&(x.className=x.className.replace("__s","__n"),i.options.toolbar.forEach(function(A){typeof A!="string"&&A.tipPosition&&A.name===x.dataset.type&&(x.className="vditor-tooltipped vditor-tooltipped__".concat(A.tipPosition))}))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__s","__n"))):(a.level||(this.innerHTML='<svg><use xlink:href="#vditor-icon-contract"></use></svg>'),i.element.style.zIndex=i.options.fullscreen.index.toString(),document.body.style.overflow="hidden",i.element.classList.add("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(c){var x=i.toolbar.elements[c].firstChild;x&&(x.className=x.className.replace("__n","__s"))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__n","__s"))),i.devtools&&i.devtools.renderEchart(i),a.click&&a.click(o,i),dt(i),ft(i)})},n}(wt),_l=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Tl=function(t){_l(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=document.createElement("div");return c.className="vditor-hint vditor-panel--arrow",c.innerHTML='<button data-tag="h1" data-value="# ">'.concat(window.VditorI18n.heading1," ").concat((0,f.fG)("&lt;⌥⌘1>"),`</button>
<button data-tag="h2" data-value="## ">`).concat(window.VditorI18n.heading2," &lt;").concat((0,f.fG)("⌥⌘2"),`></button>
<button data-tag="h3" data-value="### ">`).concat(window.VditorI18n.heading3," &lt;").concat((0,f.fG)("⌥⌘3"),`></button>
<button data-tag="h4" data-value="#### ">`).concat(window.VditorI18n.heading4," &lt;").concat((0,f.fG)("⌥⌘4"),`></button>
<button data-tag="h5" data-value="##### ">`).concat(window.VditorI18n.heading5," &lt;").concat((0,f.fG)("⌥⌘5"),`></button>
<button data-tag="h6" data-value="###### ">`).concat(window.VditorI18n.heading6," &lt;").concat((0,f.fG)("⌥⌘6"),"></button>"),o.element.appendChild(c),o._bindEvent(i,c),o}return n.prototype._bindEvent=function(i,a){var o=this.element.children[0];o.addEventListener((0,f.y3)(),function(x){x.preventDefault(),clearTimeout(i.wysiwyg.afterRenderTimeoutId),clearTimeout(i.ir.processTimeoutId),clearTimeout(i.sv.processTimeoutId),!o.classList.contains(u.Y.CLASS_MENU_DISABLED)&&(o.blur(),o.classList.contains("vditor-menu--current")?(i.currentMode==="wysiwyg"?(ei(i),it(i)):i.currentMode==="ir"&&$n(i,""),o.classList.remove("vditor-menu--current")):(T(i,["subToolbar"]),a.style.display="block"))});for(var c=0;c<6;c++)a.children.item(c).addEventListener((0,f.y3)(),function(x){x.preventDefault(),i.currentMode==="wysiwyg"?(Dt(i,x.target.getAttribute("data-tag")),it(i),o.classList.add("vditor-menu--current")):i.currentMode==="ir"?($n(i,x.target.getAttribute("data-value")),o.classList.add("vditor-menu--current")):ut(i,x.target.getAttribute("data-value")),a.style.display="none"})},n}(wt),Ml=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Al=function(t){Ml(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),i.tip.show(`<div style="margin-bottom:14px;font-size: 14px;line-height: 22px;min-width:300px;max-width: 360px;display: flex;">
<div style="margin-top: 14px;flex: 1">
    <div>Markdown 使用指南</div>
    <ul style="list-style: none">
        <li><a href="https://ld246.com/article/1583308420519" target="_blank">语法速查手册</a></li>
        <li><a href="https://ld246.com/article/1583129520165" target="_blank">基础语法</a></li>
        <li><a href="https://ld246.com/article/1583305480675" target="_blank">扩展语法</a></li>
        <li><a href="https://ld246.com/article/1582778815353" target="_blank">键盘快捷键</a></li>
    </ul>
</div>
<div style="margin-top: 14px;flex: 1">
    <div>Vditor 支持</div>
    <ul style="list-style: none">
        <li><a href="https://github.com/Vanessa219/vditor/issues" target="_blank">Issues</a></li>
        <li><a href="https://ld246.com/tag/vditor" target="_blank">官方讨论区</a></li>
        <li><a href="https://ld246.com/article/1549638745630" target="_blank">开发手册</a></li>
        <li><a href="https://ld246.com/guide/markdown" target="_blank">演示地址</a></li>
    </ul>
</div></div>`,0)}),o}return n}(wt),Ll=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Dl=function(t){Ll(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){if(c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var x=(0,U.RN)(i),A=(0,v._Y)(x.startContainer,"LI");A&&Nr(i,A,x)}}),o}return n}(wt),Ol=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Pl=function(t){Ol(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),i.tip.show(`<div style="max-width: 520px; font-size: 14px;line-height: 22px;margin-bottom: 14px;">
<p style="text-align: center;margin: 14px 0">
    <em>下一代的 Markdown 编辑器，为未来而构建</em>
</p>
<div style="display: flex;margin-bottom: 14px;flex-wrap: wrap;align-items: center">
    <img src="https://unpkg.com/vditor/dist/images/logo.png" style="margin: 0 auto;height: 68px"/>
    <div>&nbsp;&nbsp;</div>
    <div style="flex: 1;min-width: 250px">
        Vditor 是一款浏览器端的 Markdown 编辑器，支持所见即所得、即时渲染（类似 Typora）和分屏预览模式。
        它使用 TypeScript 实现，支持原生 JavaScript 以及 Vue、React、Angular 和 Svelte 等框架。
    </div>
</div>
<div style="display: flex;flex-wrap: wrap;">
    <ul style="list-style: none;flex: 1;min-width:148px">
        <li>
        项目地址：<a href="https://b3log.org/vditor" target="_blank">b3log.org/vditor</a>
        </li>
        <li>
        开源协议：MIT
        </li>
    </ul>
    <ul style="list-style: none;margin-right: 18px">
        <li>
        组件版本：Vditor v`.concat(u.g," / Lute v").concat(Lute.Version,`
        </li>
        <li>
        赞助捐赠：<a href="https://ld246.com/sponsor" target="_blank">https://ld246.com/sponsor</a>
        </li>
    </ul>
</div>
</div>`),0)}),o}return n}(wt),Rl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Il=function(t){Rl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&Si(i,"afterend")}),o}return n}(wt),Hl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Nl=function(t){Hl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&Si(i,"beforebegin")}),o}return n}(wt),jl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),$l=function(t){jl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){if(c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var x=(0,U.RN)(i),A=(0,v._Y)(x.startContainer,"LI");A&&Wi(i,A,x,A.parentElement)}}),o}return n}(wt),Bl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ul=function(t){Bl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return i.options.outline&&o.element.firstElementChild.classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault();var x=i.toolbar.elements.outline.firstElementChild;x.classList.contains(u.Y.CLASS_MENU_DISABLED)||(i.options.outline.enable=!o.element.firstElementChild.classList.contains("vditor-menu--current"),i.outline.toggle(i,i.options.outline.enable))}),o}return n}(wt),zl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Fl=function(t){zl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o._bindEvent(i),o}return n.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,f.y3)(),function(o){o.preventDefault();var c=a.element.firstElementChild;if(!c.classList.contains(u.Y.CLASS_MENU_DISABLED)){var x=u.Y.EDIT_TOOLBARS.concat(["both","edit-mode","devtools"]);c.classList.contains("vditor-menu--current")?(c.classList.remove("vditor-menu--current"),i.currentMode==="sv"?(i.sv.element.style.display="block",i.options.preview.mode==="both"?i.preview.element.style.display="block":i.preview.element.style.display="none"):(i[i.currentMode].element.parentElement.style.display="block",i.preview.element.style.display="none"),E(i.toolbar.elements,x),i.outline.render(i)):(w(i.toolbar.elements,x),i.preview.element.style.display="block",i.currentMode==="sv"?i.sv.element.style.display="none":i[i.currentMode].element.parentElement.style.display="none",i.preview.render(i),c.classList.add("vditor-menu--current"),T(i,["subToolbar","hint","popover"]),setTimeout(function(){i.outline.render(i)},i.options.preview.delay+10)),dt(i)}})},n}(wt),Vl=function(){function t(n){this.SAMPLE_RATE=5e3,this.isRecording=!1,this.readyFlag=!1,this.leftChannel=[],this.rightChannel=[],this.recordingLength=0;var i;if(typeof AudioContext<"u")i=new AudioContext;else if(webkitAudioContext)i=new webkitAudioContext;else return;this.DEFAULT_SAMPLE_RATE=i.sampleRate;var a=i.createGain(),o=i.createMediaStreamSource(n);o.connect(a),this.recorder=i.createScriptProcessor(2048,2,1),this.recorder.onaudioprocess=null,a.connect(this.recorder),this.recorder.connect(i.destination),this.readyFlag=!0}return t.prototype.cloneChannelData=function(n,i){this.leftChannel.push(new Float32Array(n)),this.rightChannel.push(new Float32Array(i)),this.recordingLength+=2048},t.prototype.startRecordingNewWavFile=function(){this.readyFlag&&(this.isRecording=!0,this.leftChannel.length=this.rightChannel.length=0,this.recordingLength=0)},t.prototype.stopRecording=function(){this.isRecording=!1},t.prototype.buildWavFileBlob=function(){for(var n=this.mergeBuffers(this.leftChannel),i=this.mergeBuffers(this.rightChannel),a=new Float32Array(n.length),o=0;o<n.length;++o)a[o]=.5*(n[o]+i[o]);this.DEFAULT_SAMPLE_RATE>this.SAMPLE_RATE&&(a=this.downSampleBuffer(a,this.SAMPLE_RATE));var c=44+a.length*2,x=new ArrayBuffer(c),A=new DataView(x);this.writeUTFBytes(A,0,"RIFF"),A.setUint32(4,c,!0),this.writeUTFBytes(A,8,"WAVE"),this.writeUTFBytes(A,12,"fmt "),A.setUint32(16,16,!0),A.setUint16(20,1,!0),A.setUint16(22,1,!0),A.setUint32(24,this.SAMPLE_RATE,!0),A.setUint32(28,this.SAMPLE_RATE*2,!0),A.setUint16(32,2,!0),A.setUint16(34,16,!0);var O=a.length*2;this.writeUTFBytes(A,36,"data"),A.setUint32(40,O,!0);for(var L=a.length,B=44,K=1,me=0;me<L;me++)A.setInt16(B,a[me]*(32767*K),!0),B+=2;return new Blob([A],{type:"audio/wav"})},t.prototype.downSampleBuffer=function(n,i){if(i===this.DEFAULT_SAMPLE_RATE||i>this.DEFAULT_SAMPLE_RATE)return n;for(var a=this.DEFAULT_SAMPLE_RATE/i,o=Math.round(n.length/a),c=new Float32Array(o),x=0,A=0;x<c.length;){for(var O=Math.round((x+1)*a),L=0,B=0,K=A;K<O&&K<n.length;K++)L+=n[K],B++;c[x]=L/B,x++,A=O}return c},t.prototype.mergeBuffers=function(n){for(var i=new Float32Array(this.recordingLength),a=0,o=n.length,c=0;c<o;++c){var x=n[c];i.set(x,a),a+=x.length}return i},t.prototype.writeUTFBytes=function(n,i,a){for(var o=a.length,c=0;c<o;c++)n.setUint8(i+c,a.charCodeAt(c))},t}(),ql=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Wl=function(t){ql(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o._bindEvent(i),o}return n.prototype._bindEvent=function(i){var a=this,o;this.element.children[0].addEventListener((0,f.y3)(),function(c){if(c.preventDefault(),!a.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)){var x=i[i.currentMode].element;if(!o){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(O){o=new Vl(O),o.recorder.onaudioprocess=function(L){if(o.isRecording){var B=L.inputBuffer.getChannelData(0),K=L.inputBuffer.getChannelData(1);o.cloneChannelData(B,K)}},o.startRecordingNewWavFile(),i.tip.show(window.VditorI18n.recording),x.setAttribute("contenteditable","false"),a.element.children[0].classList.add("vditor-menu--current")}).catch(function(){i.tip.show(window.VditorI18n["record-tip"])});return}if(o.isRecording){o.stopRecording(),i.tip.hide();var A=new File([o.buildWavFileBlob()],"record".concat(new Date().getTime(),".wav"),{type:"video/webm"});hn(i,[A]),a.element.children[0].classList.remove("vditor-menu--current")}else i.tip.show(window.VditorI18n.recording),x.setAttribute("contenteditable","false"),o.startRecordingNewWavFile(),a.element.children[0].classList.add("vditor-menu--current")}})},n}(wt),Yl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Kl=function(t){Yl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return w({redo:o.element},["redo"]),o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)&&i.undo.redo(i)}),o}return n}(wt),Gl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Xl=function(t){Gl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return w({undo:o.element},["undo"]),o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)&&i.undo.undo(i)}),o}return n}(wt),Zl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Jl=function(t){Zl(n,t);function n(i,a){var o=t.call(this,i,a)||this,c='<input type="file"';return i.options.upload.multiple&&(c+=' multiple="multiple"'),i.options.upload.accept&&(c+=' accept="'.concat(i.options.upload.accept,'"')),o.element.children[0].innerHTML="".concat(a.icon||'<svg><use xlink:href="#vditor-icon-upload"></use></svg>').concat(c,">"),o._bindEvent(i),o}return n.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,f.y3)(),function(o){if(a.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}}),this.element.querySelector("input").addEventListener("change",function(o){if(a.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}o.target.files.length!==0&&hn(i,o.target.files,o.target)})},n}(wt),Ql=function(){function t(n){var i=this,a=n.options;this.elements={},this.element=document.createElement("div"),this.element.className="vditor-toolbar",a.toolbar.forEach(function(o,c){var x=i.genItem(n,o,c);if(i.element.appendChild(x),o.toolbar){var A=document.createElement("div");A.className="vditor-hint vditor-panel--arrow",A.addEventListener((0,f.y3)(),function(O){A.style.display="none"}),o.toolbar.forEach(function(O,L){O.level=2,A.appendChild(i.genItem(n,O,c+L))}),x.appendChild(A),M(n,A,x.children[0])}}),n.options.toolbarConfig.hide&&this.element.classList.add("vditor-toolbar--hide"),n.options.toolbarConfig.pin&&this.element.classList.add("vditor-toolbar--pin"),n.options.counter.enable&&(n.counter=new dl(n),this.element.appendChild(n.counter.element))}return t.prototype.updateConfig=function(n,i){n.options.toolbarConfig=Object.assign({hide:!1,pin:!1},i),n.options.toolbarConfig.hide?this.element.classList.add("vditor-toolbar--hide"):this.element.classList.remove("vditor-toolbar--hide"),n.options.toolbarConfig.pin?this.element.classList.add("vditor-toolbar--pin"):this.element.classList.remove("vditor-toolbar--pin")},t.prototype.genItem=function(n,i,a){var o;switch(i.name){case"bold":case"italic":case"more":case"strike":case"line":case"quote":case"list":case"ordered-list":case"check":case"code":case"inline-code":case"link":case"table":o=new wt(n,i);break;case"emoji":o=new bl(n,i);break;case"headings":o=new Tl(n,i);break;case"|":o=new gl;break;case"br":o=new ol;break;case"undo":o=new Xl(n,i);break;case"redo":o=new Kl(n,i);break;case"help":o=new Al(n,i);break;case"both":o=new al(n,i);break;case"preview":o=new Fl(n,i);break;case"fullscreen":o=new Cl(n,i);break;case"upload":o=new Jl(n,i);break;case"record":o=new Wl(n,i);break;case"info":o=new Pl(n,i);break;case"edit-mode":o=new Kt(n,i);break;case"devtools":o=new ml(n,i);break;case"outdent":o=new $l(n,i);break;case"indent":o=new Dl(n,i);break;case"outline":o=new Ul(n,i);break;case"insert-after":o=new Il(n,i);break;case"insert-before":o=new Nl(n,i);break;case"code-theme":o=new ll(n,i);break;case"content-theme":o=new ul(n,i);break;case"export":o=new Sl(n,i);break;default:o=new hl(n,i);break}if(o){var c=i.name;return(c==="br"||c==="|")&&(c=c+a),this.elements[c]=o.element,o.element}},t}(),ec=l(192),tc=function(){function t(){this.stackSize=50,this.resetStack(),this.dmp=new ec}return t.prototype.clearStack=function(n){this.resetStack(),this.resetIcon(n)},t.prototype.resetIcon=function(n){n.toolbar&&(this[n.currentMode].undoStack.length>1?E(n.toolbar.elements,["undo"]):w(n.toolbar.elements,["undo"]),this[n.currentMode].redoStack.length!==0?E(n.toolbar.elements,["redo"]):w(n.toolbar.elements,["redo"]))},t.prototype.undo=function(n){if(n[n.currentMode].element.getAttribute("contenteditable")!=="false"&&!(this[n.currentMode].undoStack.length<2)){var i=this[n.currentMode].undoStack.pop();i&&(this[n.currentMode].redoStack.push(i),this.renderDiff(i,n),this[n.currentMode].hasUndo=!0,T(n,["hint"]))}},t.prototype.redo=function(n){if(n[n.currentMode].element.getAttribute("contenteditable")!=="false"){var i=this[n.currentMode].redoStack.pop();i&&(this[n.currentMode].undoStack.push(i),this.renderDiff(i,n,!0))}},t.prototype.recordFirstPosition=function(n,i){if(getSelection().rangeCount!==0&&!(this[n.currentMode].undoStack.length!==1||this[n.currentMode].undoStack[0].length===0||this[n.currentMode].redoStack.length>0)&&!((0,f.gm)()&&i.key==="Backspace")&&!(0,f.nr)()){var a=this.addCaret(n);a.replace("<wbr>","").replace(" vditor-ir__node--expand","")===this[n.currentMode].undoStack[0][0].diffs[0][1].replace("<wbr>","")&&(this[n.currentMode].undoStack[0][0].diffs[0][1]=a,this[n.currentMode].lastText=a)}},t.prototype.addToUndoStack=function(n){var i=this.addCaret(n,!0),a=this.dmp.diff_main(i,this[n.currentMode].lastText,!0),o=this.dmp.patch_make(i,this[n.currentMode].lastText,a);o.length===0&&this[n.currentMode].undoStack.length>0||(this[n.currentMode].lastText=i,this[n.currentMode].undoStack.push(o),this[n.currentMode].undoStack.length>this.stackSize&&this[n.currentMode].undoStack.shift(),this[n.currentMode].hasUndo&&(this[n.currentMode].redoStack=[],this[n.currentMode].hasUndo=!1,w(n.toolbar.elements,["redo"])),this[n.currentMode].undoStack.length>1&&E(n.toolbar.elements,["undo"]))},t.prototype.renderDiff=function(n,i,a){a===void 0&&(a=!1);var o;if(a){var c=this.dmp.patch_deepCopy(n).reverse();c.forEach(function(A){A.diffs.forEach(function(O){O[0]=-O[0]})}),o=this.dmp.patch_apply(c,this[i.currentMode].lastText)[0]}else o=this.dmp.patch_apply(n,this[i.currentMode].lastText)[0];if(this[i.currentMode].lastText=o,i[i.currentMode].element.innerHTML=o,i.currentMode!=="sv"&&(i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview")).forEach(function(A){A.parentElement.querySelector(".language-echarts")&&(i.currentMode==="ir"?A.parentElement.outerHTML=i.lute.SpinVditorIRDOM(A.parentElement.outerHTML):A.parentElement.outerHTML=i.lute.SpinVditorDOM(A.parentElement.outerHTML))}),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(A){tt(A,i)})),i[i.currentMode].element.querySelector("wbr"))(0,U.ir)(i[i.currentMode].element,i[i.currentMode].element.ownerDocument.createRange()),Xe(i);else{var x=getSelection().getRangeAt(0);x.setEndBefore(i[i.currentMode].element),x.collapse(!1)}oe(i),rt(i,{enableAddUndoStack:!1,enableHint:!1,enableInput:!0}),mt(i),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(A){tt(A,i)}),this[i.currentMode].undoStack.length>1?E(i.toolbar.elements,["undo"]):w(i.toolbar.elements,["undo"]),this[i.currentMode].redoStack.length!==0?E(i.toolbar.elements,["redo"]):w(i.toolbar.elements,["redo"])},t.prototype.resetStack=function(){this.ir={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.sv={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.wysiwyg={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]}},t.prototype.addCaret=function(n,i){i===void 0&&(i=!1);var a;if(getSelection().rangeCount!==0&&!n[n.currentMode].element.querySelector("wbr")){var o=getSelection().getRangeAt(0);if(n[n.currentMode].element.contains(o.startContainer)){a=o.cloneRange();var c=document.createElement("span");c.className="vditor-wbr",o.insertNode(c)}}var x=n[n.currentMode].element.cloneNode(!0);x.querySelectorAll(".vditor-".concat(n.currentMode,"__preview[data-render='1']")).forEach(function(O){O.firstElementChild&&(O.firstElementChild.classList.contains("language-echarts")||O.firstElementChild.classList.contains("language-plantuml")||O.firstElementChild.classList.contains("language-mindmap")?(O.firstElementChild.removeAttribute("_echarts_instance_"),O.firstElementChild.removeAttribute("data-processed"),O.firstElementChild.innerHTML=O.previousElementSibling.firstElementChild.innerHTML,O.setAttribute("data-render","2")):O.firstElementChild.classList.contains("language-math")&&(O.setAttribute("data-render","2"),O.firstElementChild.textContent=O.firstElementChild.getAttribute("data-math"),O.firstElementChild.removeAttribute("data-math")))});var A=x.innerHTML;return n[n.currentMode].element.querySelectorAll(".vditor-wbr").forEach(function(O){O.remove()}),i&&a&&(0,U.jl)(a),A.replace('<span class="vditor-wbr"></span>',"<wbr>")},t}(),nc=l(905),ic=function(){function t(n){this.defaultOptions={rtl:!1,after:void 0,cache:{enable:!0},cdn:u.Y.CDN,classes:{preview:""},comment:{enable:!1},counter:{enable:!1,type:"markdown"},customRenders:[],debugger:!1,fullscreen:{index:90},height:"auto",hint:{delay:200,emoji:{"+1":"👍","-1":"👎",confused:"😕",eyes:"👀️",heart:"❤️",rocket:"🚀️",smile:"😄",tada:"🎉️"},emojiPath:"".concat(u.Y.CDN,"/dist/images/emoji"),extend:[],parse:!0},icon:"ant",lang:"zh_CN",mode:"ir",outline:{enable:!1,position:"left"},placeholder:"",preview:{actions:["desktop","tablet","mobile","mp-wechat","zhihu"],delay:1e3,hljs:u.Y.HLJS_OPTIONS,markdown:u.Y.MARKDOWN_OPTIONS,math:u.Y.MATH_OPTIONS,maxWidth:800,mode:"both",theme:u.Y.THEME_OPTIONS,render:{media:{enable:!0}}},link:{isOpen:!0},image:{isPreview:!0},resize:{enable:!1,position:"bottom"},theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","fullscreen","edit-mode",{name:"more",toolbar:["both","code-theme","content-theme","export","outline","preview","devtools","info","help"]}],toolbarConfig:{hide:!1,pin:!1},typewriterMode:!1,undoDelay:800,upload:{extraData:{},fieldName:"file[]",filename:function(i){return i.replace(/\W/g,"")},linkToImgUrl:"",max:10*1024*1024,multiple:!0,url:"",withCredentials:!1},value:"",width:"auto"},this.options=n}return t.prototype.merge=function(){var n,i,a,o,c,x,A,O,L;this.options&&(this.options.toolbar?this.options.toolbar=this.mergeToolbar(this.options.toolbar):this.options.toolbar=this.mergeToolbar(this.defaultOptions.toolbar),!((i=(n=this.options.preview)===null||n===void 0?void 0:n.theme)===null||i===void 0)&&i.list&&(this.defaultOptions.preview.theme.list=this.options.preview.theme.list),!((c=(o=(a=this.options.preview)===null||a===void 0?void 0:a.render)===null||o===void 0?void 0:o.media)===null||c===void 0)&&c.enable&&(this.defaultOptions.preview.render.media.enable=this.options.preview.render.media.enable),!((x=this.options.hint)===null||x===void 0)&&x.emoji&&(this.defaultOptions.hint.emoji=this.options.hint.emoji),this.options.comment&&(this.defaultOptions.comment=this.options.comment),this.options.cdn&&(!((O=(A=this.options.preview)===null||A===void 0?void 0:A.theme)===null||O===void 0)&&O.path||(this.defaultOptions.preview.theme.path="".concat(this.options.cdn,"/dist/css/content-theme")),!((L=this.options.hint)===null||L===void 0)&&L.emojiPath||(this.defaultOptions.hint.emojiPath="".concat(this.options.cdn,"/dist/images/emoji"))));var B=(0,nc.h)(this.defaultOptions,this.options);if(B.cache.enable&&!B.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");return B},t.prototype.mergeToolbar=function(n){var i=this,a=[{icon:'<svg><use xlink:href="#vditor-icon-export"></use></svg>',name:"export",tipPosition:"ne"},{hotkey:"⌘E",icon:'<svg><use xlink:href="#vditor-icon-emoji"></use></svg>',name:"emoji",tipPosition:"ne"},{hotkey:"⌘H",icon:'<svg><use xlink:href="#vditor-icon-headings"></use></svg>',name:"headings",tipPosition:"ne"},{hotkey:"⌘B",icon:'<svg><use xlink:href="#vditor-icon-bold"></use></svg>',name:"bold",prefix:"**",suffix:"**",tipPosition:"ne"},{hotkey:"⌘I",icon:'<svg><use xlink:href="#vditor-icon-italic"></use></svg>',name:"italic",prefix:"*",suffix:"*",tipPosition:"ne"},{hotkey:"⌘D",icon:'<svg><use xlink:href="#vditor-icon-strike"></use></svg>',name:"strike",prefix:"~~",suffix:"~~",tipPosition:"ne"},{hotkey:"⌘K",icon:'<svg><use xlink:href="#vditor-icon-link"></use></svg>',name:"link",prefix:"[",suffix:"](https://)",tipPosition:"n"},{name:"|"},{hotkey:"⌘L",icon:'<svg><use xlink:href="#vditor-icon-list"></use></svg>',name:"list",prefix:"* ",tipPosition:"n"},{hotkey:"⌘O",icon:'<svg><use xlink:href="#vditor-icon-ordered-list"></use></svg>',name:"ordered-list",prefix:"1. ",tipPosition:"n"},{hotkey:"⌘J",icon:'<svg><use xlink:href="#vditor-icon-check"></use></svg>',name:"check",prefix:"* [ ] ",tipPosition:"n"},{hotkey:"⇧⌘I",icon:'<svg><use xlink:href="#vditor-icon-outdent"></use></svg>',name:"outdent",tipPosition:"n"},{hotkey:"⇧⌘O",icon:'<svg><use xlink:href="#vditor-icon-indent"></use></svg>',name:"indent",tipPosition:"n"},{name:"|"},{hotkey:"⌘;",icon:'<svg><use xlink:href="#vditor-icon-quote"></use></svg>',name:"quote",prefix:"> ",tipPosition:"n"},{hotkey:"⇧⌘H",icon:'<svg><use xlink:href="#vditor-icon-line"></use></svg>',name:"line",prefix:"---",tipPosition:"n"},{hotkey:"⌘U",icon:'<svg><use xlink:href="#vditor-icon-code"></use></svg>',name:"code",prefix:"```",suffix:"\n```",tipPosition:"n"},{hotkey:"⌘G",icon:'<svg><use xlink:href="#vditor-icon-inline-code"></use></svg>',name:"inline-code",prefix:"`",suffix:"`",tipPosition:"n"},{hotkey:"⇧⌘B",icon:'<svg><use xlink:href="#vditor-icon-before"></use></svg>',name:"insert-before",tipPosition:"n"},{hotkey:"⇧⌘E",icon:'<svg><use xlink:href="#vditor-icon-after"></use></svg>',name:"insert-after",tipPosition:"n"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-upload"></use></svg>',name:"upload",tipPosition:"n"},{icon:'<svg><use xlink:href="#vditor-icon-record"></use></svg>',name:"record",tipPosition:"n"},{hotkey:"⌘M",icon:'<svg><use xlink:href="#vditor-icon-table"></use></svg>',name:"table",prefix:"| col1",suffix:` | col2 | col3 |
| --- | --- | --- |
|  |  |  |
|  |  |  |`,tipPosition:"n"},{name:"|"},{hotkey:"⌘Z",icon:'<svg><use xlink:href="#vditor-icon-undo"></use></svg>',name:"undo",tipPosition:"nw"},{hotkey:"⌘Y",icon:'<svg><use xlink:href="#vditor-icon-redo"></use></svg>',name:"redo",tipPosition:"nw"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-more"></use></svg>',name:"more",tipPosition:"e"},{hotkey:"⌘'",icon:'<svg><use xlink:href="#vditor-icon-fullscreen"></use></svg>',name:"fullscreen",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-edit"></use></svg>',name:"edit-mode",tipPosition:"nw"},{hotkey:"⌘P",icon:'<svg><use xlink:href="#vditor-icon-both"></use></svg>',name:"both",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-preview"></use></svg>',name:"preview",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',name:"outline",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-theme"></use></svg>',name:"content-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-code-theme"></use></svg>',name:"code-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-bug"></use></svg>',name:"devtools",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-info"></use></svg>',name:"info",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-help"></use></svg>',name:"help",tipPosition:"nw"},{name:"br"}],o=[];return n.forEach(function(c){var x=c;a.forEach(function(A){typeof c=="string"&&A.name===c&&(x=A),typeof c=="object"&&A.name===c.name&&(x=Object.assign({},A,c))}),c.toolbar&&(x.toolbar=i.mergeToolbar(c.toolbar)),o.push(x)}),o},t}(),rc=function(){function t(n){var i=this;this.composingLock=!1,this.commentIds=[];var a=document.createElement("div");a.className="vditor-wysiwyg",a.innerHTML='<pre class="vditor-reset" placeholder="'.concat(n.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>
<div class="vditor-panel vditor-panel--none"></div>
<div class="vditor-panel vditor-panel--none">
    <button type="button" aria-label="`).concat(window.VditorI18n.comment,`" class="vditor-icon vditor-tooltipped vditor-tooltipped__n">
        <svg><use xlink:href="#vditor-icon-comment"></use></svg>
    </button>
</div>`),this.element=a.firstElementChild,this.popover=a.firstElementChild.nextElementSibling,this.selectPopover=a.lastElementChild,this.bindEvent(n),Bt(n,this.element),Rn(n,this.element),ti(n,this.element),at(n,this.element),Pt(n,this.element),Mn(n,this.element),en(n,this.element,this.copy),In(n,this.element,this.copy),n.options.comment.enable&&(this.selectPopover.querySelector("button").onclick=function(){var o=Lute.NewNodeID(),c=getSelection().getRangeAt(0),x=c.cloneRange(),A=c.extractContents(),O,L,B=!1,K=!1;A.childNodes.forEach(function(fe,je){var Se=!1;if(fe.nodeType===3?Se=!0:fe.classList.contains("vditor-comment")?fe.classList.contains("vditor-comment")&&fe.setAttribute("data-cmtids",fe.getAttribute("data-cmtids")+" "+o):Se=!0,Se)if(fe.nodeType!==3&&fe.getAttribute("data-block")==="0"&&je===0&&x.startOffset>0)fe.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(fe.innerHTML,"</span>"),O=fe;else if(fe.nodeType!==3&&fe.getAttribute("data-block")==="0"&&je===A.childNodes.length-1&&x.endOffset<x.endContainer.textContent.length)fe.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(fe.innerHTML,"</span>"),L=fe;else if(fe.nodeType!==3&&fe.getAttribute("data-block")==="0")je===0?B=!0:je===A.childNodes.length-1&&(K=!0),fe.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(fe.innerHTML,"</span>");else{var ue=document.createElement("span");ue.classList.add("vditor-comment"),ue.setAttribute("data-cmtids",o),fe.parentNode.insertBefore(ue,fe),ue.appendChild(fe)}});var me=(0,v.pt)(x.startContainer);me&&(O?(me.insertAdjacentHTML("beforeend",O.innerHTML),O.remove()):me.textContent.trim().replace(u.Y.ZWSP,"")===""&&B&&me.remove());var pe=(0,v.pt)(x.endContainer);pe&&(L?(pe.insertAdjacentHTML("afterbegin",L.innerHTML),L.remove()):pe.textContent.trim().replace(u.Y.ZWSP,"")===""&&K&&pe.remove()),c.insertNode(A),n.options.comment.add(o,c.toString(),i.getComments(n,!0)),it(n,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),i.hideComment()})}return t.prototype.getComments=function(n,i){var a=this;if(i===void 0&&(i=!1),n.currentMode==="wysiwyg"&&n.options.comment.enable){this.commentIds=[],this.element.querySelectorAll(".vditor-comment").forEach(function(c){a.commentIds=a.commentIds.concat(c.getAttribute("data-cmtids").split(" "))}),this.commentIds=Array.from(new Set(this.commentIds));var o=[];if(i)return this.commentIds.forEach(function(c){o.push({id:c,top:a.element.querySelector('.vditor-comment[data-cmtids="'.concat(c,'"]')).offsetTop})}),o}else return[]},t.prototype.triggerRemoveComment=function(n){var i=function(c,x){var A=new Set(x);return c.filter(function(O){return!A.has(O)})};if(n.currentMode==="wysiwyg"&&n.options.comment.enable&&n.wysiwyg.commentIds.length>0){var a=JSON.parse(JSON.stringify(this.commentIds));this.getComments(n);var o=i(a,this.commentIds);o.length>0&&n.options.comment.remove(o)}},t.prototype.showComment=function(){var n=(0,U.Ey)(this.element);this.selectPopover.setAttribute("style","left:".concat(n.left,"px;display:block;top:").concat(Math.max(-8,n.top-21),"px"))},t.prototype.hideComment=function(){this.selectPopover.setAttribute("style","display:none")},t.prototype.unbindListener=function(){window.removeEventListener("scroll",this.scrollListener)},t.prototype.copy=function(n,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){n.stopPropagation(),n.preventDefault();var o=(0,v._Y)(a.startContainer,"CODE"),c=(0,v._Y)(a.endContainer,"CODE");if(o&&c&&c.isSameNode(o)){var x="";o.parentElement.tagName==="PRE"?x=a.toString():x="`"+a.toString()+"`",n.clipboardData.setData("text/plain",x),n.clipboardData.setData("text/html","");return}var A=(0,v._Y)(a.startContainer,"A"),O=(0,v._Y)(a.endContainer,"A");if(A&&O&&O.isSameNode(A)){var L=A.getAttribute("title")||"";L&&(L=' "'.concat(L,'"')),n.clipboardData.setData("text/plain","[".concat(a.toString(),"](").concat(A.getAttribute("href")).concat(L,")")),n.clipboardData.setData("text/html","");return}var B=document.createElement("div");B.appendChild(a.cloneContents()),n.clipboardData.setData("text/plain",i.lute.VditorDOM2Md(B.innerHTML).trim()),n.clipboardData.setData("text/html","")}},t.prototype.bindEvent=function(n){var i=this;this.unbindListener(),window.addEventListener("scroll",this.scrollListener=function(){if(T(n,["hint"]),!(i.popover.style.display!=="block"||i.selectPopover.style.display!=="block")){var a=parseInt(i.popover.getAttribute("data-top"),10);if(n.options.height!=="auto"){if(n.options.toolbarConfig.pin&&n.toolbar.element.getBoundingClientRect().top===0){var o=Math.max(window.scrollY-n.element.offsetTop-8,Math.min(a-n.wysiwyg.element.scrollTop,i.element.clientHeight-21))+"px";i.popover.style.display==="block"&&(i.popover.style.top=o),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=o)}return}else if(!n.options.toolbarConfig.pin)return;var c=Math.max(a,window.scrollY-n.element.offsetTop-8)+"px";i.popover.style.display==="block"&&(i.popover.style.top=c),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=c)}}),this.element.addEventListener("scroll",function(){if(T(n,["hint"]),n.options.comment&&n.options.comment.enable&&n.options.comment.scroll&&n.options.comment.scroll(n.wysiwyg.element.scrollTop),i.popover.style.display==="block"){var a=parseInt(i.popover.getAttribute("data-top"),10)-n.wysiwyg.element.scrollTop,o=-8;n.options.toolbarConfig.pin&&n.toolbar.element.getBoundingClientRect().top===0&&(o=window.scrollY-n.element.offsetTop+o);var c=Math.max(o,Math.min(a,i.element.clientHeight-21))+"px";i.popover.style.top=c,i.selectPopover.style.top=c}}),this.element.addEventListener("paste",function(a){jn(n,a,{pasteCode:function(o){var c=(0,U.RN)(n),x=document.createElement("template");x.innerHTML=o,c.insertNode(x.content.cloneNode(!0));var A=(0,v.Th)(c.startContainer,"data-block","0");A?A.outerHTML=n.lute.SpinVditorDOM(A.outerHTML):n.wysiwyg.element.innerHTML=n.lute.SpinVditorDOM(n.wysiwyg.element.innerHTML),(0,U.ir)(n.wysiwyg.element,c)}})}),this.element.addEventListener("compositionstart",function(){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){var o=(0,D.c)(getSelection().getRangeAt(0).startContainer);if(o&&o.textContent===""){oe(n);return}(0,f.gm)()||pi(n,getSelection().getRangeAt(0).cloneRange(),a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,it(n);return}if(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"){it(n);return}var o=getSelection().getRangeAt(0),c=(0,v.pt)(o.startContainer);if(c||(Ft(n,o),c=(0,v.pt)(o.startContainer)),!!c){for(var x=(0,U.ED)(c,n.wysiwyg.element,o).start,A=!0,O=x-1;O>c.textContent.substr(0,x).lastIndexOf(`
`);O--)if(c.textContent.charAt(O)!==" "&&c.textContent.charAt(O)!=="	"){A=!1;break}x===0&&(A=!1);for(var L=!0,O=x-1;O<c.textContent.length;O++)if(c.textContent.charAt(O)!==" "&&c.textContent.charAt(O)!==`
`){L=!1;break}L&&/^#{1,6} $/.test(c.textContent)&&(L=!1);var B=(0,D.c)(getSelection().getRangeAt(0).startContainer);if(B&&B.textContent===""&&(oe(n),B.remove()),A&&c.getAttribute("data-type")!=="code-block"||L||fr(c.innerHTML)||_i(c.innerHTML)&&c.previousElementSibling){typeof n.options.input=="function"&&n.options.input(S(n));return}a.inputType==="insertParagraph"&&i.element.innerHTML==="<p><br></p><p><br></p>"&&c.previousElementSibling.remove(),pi(n,o,a)}}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){var o=a.target;o.checked?o.setAttribute("checked","checked"):o.removeAttribute("checked"),i.preventInput=!0,getSelection().rangeCount>0&&(0,U.jl)(getSelection().getRangeAt(0)),it(n);return}if(a.target.tagName==="IMG"&&!a.target.parentElement.classList.contains("vditor-wysiwyg__preview")){a.target.getAttribute("data-type")==="link-ref"?ne(n,a.target):ge(a,n);return}var c=(0,v._Y)(a.target,"A");if(c){n.options.link.click?n.options.link.click(c):n.options.link.isOpen&&window.open(c.getAttribute("href")),a.preventDefault();return}var x=(0,U.RN)(n);if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&x.collapsed){var A=i.element.lastElementChild.getBoundingClientRect();a.y>A.top+A.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(u.Y.ZWSP,"")===""?(x.selectNodeContents(i.element.lastElementChild),x.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,U.ir)(i.element,x)))}W(n);var O=(0,v.KJ)(a.target,"vditor-wysiwyg__preview");O||(O=(0,v.KJ)((0,U.RN)(n).startContainer,"vditor-wysiwyg__preview")),O&&Ht(O,n),re(a,n)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,f._0)(a))){a.key==="Enter"&&Xe(n),(a.key==="Backspace"||a.key==="Delete")&&n.wysiwyg.element.innerHTML!==""&&n.wysiwyg.element.childNodes.length===1&&n.wysiwyg.element.firstElementChild&&n.wysiwyg.element.firstElementChild.tagName==="P"&&n.wysiwyg.element.firstElementChild.childElementCount===0&&(n.wysiwyg.element.textContent===""||n.wysiwyg.element.textContent===`
`)&&(n.wysiwyg.element.innerHTML="");var o=(0,U.RN)(n);if(a.key==="Backspace"&&(0,f.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent=""),Ft(n,o),W(n),!(a.key!=="ArrowDown"&&a.key!=="ArrowRight"&&a.key!=="Backspace"&&a.key!=="ArrowLeft"&&a.key!=="ArrowUp")){(a.key==="ArrowLeft"||a.key==="ArrowRight")&&n.hint.render(n);var c=(0,v.KJ)(o.startContainer,"vditor-wysiwyg__preview");if(!c&&o.startContainer.nodeType!==3&&o.startOffset>0){var x=o.startContainer;x.classList.contains("vditor-wysiwyg__block")&&(c=x.lastElementChild)}if(c){var A=c.previousElementSibling;if(A.style.display==="none"){a.key==="ArrowDown"||a.key==="ArrowRight"?Ht(c,n):Ht(c,n,!1);return}var O=c.previousElementSibling;if(O.tagName==="PRE"&&(O=O.firstElementChild),a.key==="ArrowDown"||a.key==="ArrowRight"){var x=c.parentElement,L=yn(x);if(L&&L.nodeType!==3){var B=L.querySelector(".vditor-wysiwyg__preview");if(B){Ht(B,n);return}}if(L.nodeType===3){for(;L.textContent.length===0&&L.nextSibling;)L=L.nextSibling;o.setStart(L,1)}else o.setStart(L.firstChild,0)}else o.selectNodeContents(O),o.collapse(!1)}}}})},t}(),ac=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),oc=function(t){ac(n,t);function n(i,a){var o=t.call(this)||this;if(o.version=u.g,typeof i=="string"){if(a?a.cache?a.cache.id||(a.cache.id="vditor".concat(i)):a.cache={id:"vditor".concat(i)}:a={cache:{id:"vditor".concat(i)}},!document.getElementById(i))return o.showErrorTip("Failed to get element by id: ".concat(i)),o;i=document.getElementById(i)}var c=new ic(a),x=c.merge();if(x.i18n)window.VditorI18n=x.i18n,o.init(i,x);else if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(x.lang)){var A="vditorI18nScript",O=A+x.lang;document.querySelectorAll('head script[id^="'.concat(A,'"]')).forEach(function(L){L.id!==O&&document.head.removeChild(L)}),(0,k.Z)("".concat(x.cdn,"/dist/js/i18n/").concat(x.lang,".js"),O).then(function(){o.init(i,x)}).catch(function(L){o.showErrorTip("GET ".concat(x.cdn,"/dist/js/i18n/").concat(x.lang,".js net::ERR_ABORTED 404 (Not Found)"))})}else throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");return o}return n.prototype.showErrorTip=function(i){var a=new lo;document.body.appendChild(a.element),a.show(i,0)},n.prototype.updateToolbarConfig=function(i){this.vditor.toolbar.updateConfig(this.vditor,i)},n.prototype.setTheme=function(i,a,o,c){this.vditor.options.theme=i,nt(this.vditor),a&&(this.vditor.options.preview.theme.current=a,(0,De.H)(a,c||this.vditor.options.preview.theme.path)),o&&(this.vditor.options.preview.hljs.style=o,(0,co.h)(o,this.vditor.options.cdn))},n.prototype.getValue=function(){return S(this.vditor)},n.prototype.getCurrentMode=function(){return this.vditor.currentMode},n.prototype.focus=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.focus():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.focus():this.vditor.currentMode==="ir"&&this.vditor.ir.element.focus()},n.prototype.blur=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.blur():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.blur():this.vditor.currentMode==="ir"&&this.vditor.ir.element.blur()},n.prototype.disabled=function(){T(this.vditor,["subToolbar","hint","popover"]),w(this.vditor.toolbar.elements,u.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","false")},n.prototype.enable=function(){E(this.vditor.toolbar.elements,u.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor.undo.resetIcon(this.vditor),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","true")},n.prototype.getSelection=function(){if(this.vditor.currentMode==="wysiwyg")return $t(this.vditor.wysiwyg.element);if(this.vditor.currentMode==="sv")return $t(this.vditor.sv.element);if(this.vditor.currentMode==="ir")return $t(this.vditor.ir.element)},n.prototype.renderPreview=function(i){this.vditor.preview.render(this.vditor,i)},n.prototype.getCursorPosition=function(){return(0,U.Ey)(this.vditor[this.vditor.currentMode].element)},n.prototype.isUploading=function(){return this.vditor.upload.isUploading},n.prototype.clearCache=function(){this.vditor.options.cache.enable&&(0,f.D)()&&localStorage.removeItem(this.vditor.options.cache.id)},n.prototype.disabledCache=function(){this.vditor.options.cache.enable=!1},n.prototype.enableCache=function(){if(!this.vditor.options.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");this.vditor.options.cache.enable=!0},n.prototype.html2md=function(i){return this.vditor.lute.HTML2Md(i)},n.prototype.exportJSON=function(i){return this.vditor.lute.RenderJSON(i)},n.prototype.getHTML=function(){return oo(this.vditor)},n.prototype.tip=function(i,a){this.vditor.tip.show(i,a)},n.prototype.setPreviewMode=function(i){ma(i,this.vditor)},n.prototype.deleteValue=function(){window.getSelection().isCollapsed||document.execCommand("delete",!1)},n.prototype.updateValue=function(i){document.execCommand("insertHTML",!1,i)},n.prototype.insertValue=function(i,a){a===void 0&&(a=!0);var o=(0,U.RN)(this.vditor);o.collapse(!0);var c=document.createElement("template");c.innerHTML=i,o.insertNode(c.content.cloneNode(!0)),o.collapse(!1),this.vditor.currentMode==="sv"?(this.vditor.sv.preventInput=!0,a&&Ve(this.vditor)):this.vditor.currentMode==="wysiwyg"?a&&pi(this.vditor,getSelection().getRangeAt(0)):this.vditor.currentMode==="ir"&&(this.vditor.ir.preventInput=!0,a&&Ge(this.vditor,getSelection().getRangeAt(0),!0))},n.prototype.insertMD=function(i){this.vditor.currentMode==="ir"?(0,U.Z2)(this.vditor.lute.Md2VditorIRDOM(i),this.vditor):this.vditor.currentMode==="wysiwyg"?(0,U.Z2)(this.vditor.lute.Md2VditorDOM(i),this.vditor):Y(this.vditor,i),this.vditor.outline.render(this.vditor),rt(this.vditor)},n.prototype.setValue=function(i,a){var o=this;a===void 0&&(a=!1),this.vditor.currentMode==="sv"?(this.vditor.sv.element.innerHTML="<div data-block='0'>".concat(this.vditor.lute.SpinVditorSVDOM(i),"</div>"),ze(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})):this.vditor.currentMode==="wysiwyg"?Mt(this.vditor,i,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}):(this.vditor.ir.element.innerHTML=this.vditor.lute.Md2VditorIRDOM(i),this.vditor.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(c){tt(c,o.vditor)}),Ot(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})),this.vditor.outline.render(this.vditor),i||(T(this.vditor,["emoji","headings","submenu","hint"]),this.vditor.wysiwyg.popover&&(this.vditor.wysiwyg.popover.style.display="none"),this.clearCache()),a&&this.clearStack()},n.prototype.insertEmptyBlock=function(i){Si(this.vditor,i)},n.prototype.clearStack=function(){this.vditor.undo.clearStack(this.vditor),this.vditor.undo.addToUndoStack(this.vditor)},n.prototype.destroy=function(){this.vditor.element.innerHTML=this.vditor.originalInnerHTML,this.vditor.element.classList.remove("vditor"),this.vditor.element.removeAttribute("style");var i=document.getElementById("vditorIconScript");i&&i.remove(),this.clearCache(),_n(),this.vditor.wysiwyg.unbindListener()},n.prototype.getCommentIds=function(){return this.vditor.currentMode!=="wysiwyg"?[]:this.vditor.wysiwyg.getComments(this.vditor,!0)},n.prototype.hlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){o.classList.remove("vditor-comment--hover"),i.forEach(function(c){o.getAttribute("data-cmtids").indexOf(c)>-1&&o.classList.add("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},n.prototype.unHlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){i.forEach(function(c){o.getAttribute("data-cmtids").indexOf(c)>-1&&o.classList.remove("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},n.prototype.removeCommentIds=function(i){var a=this;if(this.vditor.currentMode==="wysiwyg"){var o=function(c,x){var A=c.getAttribute("data-cmtids").split(" ");A.find(function(O,L){if(O===x)return A.splice(L,1),!0}),A.length===0?(c.outerHTML=c.innerHTML,(0,U.RN)(a.vditor).collapse(!0)):c.setAttribute("data-cmtids",A.join(" "))};i.forEach(function(c){a.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(x){o(x,c)}),a.vditor.preview.element.style.display!=="none"&&a.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(x){o(x,c)})}),it(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})}},n.prototype.init=function(i,a){var o=this;this.vditor={currentMode:a.mode,element:i,hint:new Xs(a.hint.extend),lute:void 0,options:a,originalInnerHTML:i.innerHTML,outline:new Qs(window.VditorI18n.outline),tip:new lo},this.vditor.sv=new il(this.vditor),this.vditor.undo=new tc,this.vditor.wysiwyg=new rc(this.vditor),this.vditor.ir=new Zs(this.vditor),this.vditor.toolbar=new Ql(this.vditor),a.resize.enable&&(this.vditor.resize=new nl(this.vditor)),this.vditor.toolbar.elements.devtools&&(this.vditor.devtools=new h),(a.upload.url||a.upload.handler)&&(this.vditor.upload=new qn),(0,k.Z)(a._lutePath||"".concat(a.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){o.vditor.lute=(0,Js.X)({autoSpace:o.vditor.options.preview.markdown.autoSpace,gfmAutoLink:o.vditor.options.preview.markdown.gfmAutoLink,codeBlockPreview:o.vditor.options.preview.markdown.codeBlockPreview,emojiSite:o.vditor.options.hint.emojiPath,emojis:o.vditor.options.hint.emoji,fixTermTypo:o.vditor.options.preview.markdown.fixTermTypo,footnotes:o.vditor.options.preview.markdown.footnotes,headingAnchor:!1,inlineMathDigit:o.vditor.options.preview.math.inlineDigit,linkBase:o.vditor.options.preview.markdown.linkBase,linkPrefix:o.vditor.options.preview.markdown.linkPrefix,listStyle:o.vditor.options.preview.markdown.listStyle,mark:o.vditor.options.preview.markdown.mark,mathBlockPreview:o.vditor.options.preview.markdown.mathBlockPreview,paragraphBeginningSpace:o.vditor.options.preview.markdown.paragraphBeginningSpace,sanitize:o.vditor.options.preview.markdown.sanitize,toc:o.vditor.options.preview.markdown.toc}),o.vditor.preview=new tl(o.vditor),ct(o.vditor),a.after&&a.after(),a.icon&&(0,k.U)("".concat(a.cdn,"/dist/js/icons/").concat(a.icon,".js"),"vditorIconScript")})},n}(m.default);const sc=oc})(),d=d.default,d})())}(ra)),ra.exports}var Sd=Ed();const Cr=wd(Sd),xd=rn({__name:"VditorEditor",props:{modelValue:{type:String,default:""},theme:{type:String,default:"classic"}},emits:["update:modelValue"],setup(p,{expose:e,emit:r}){const s=p,l=r,d=G();let m=null;const u={mode:"ir",height:"auto",minHeight:150,resize:{enable:!0,position:"bottom"},icon:"ant",lang:"zh_CN",theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","|","quote","line","code","inline-code","table","upload","undo","redo","|","preview","fullscreen"],toolbarConfig:{pin:!0,hideTooltip:!0},counter:{enable:!1},cache:{enable:!0,id:"vue-vditor"},input:g=>{l("update:modelValue",g)},preview:{hljs:{style:"native"},markdown:{listStyle:!0,mark:!0},actions:[]},placeholder:"灵感记录~"};return zt(async()=>{if(!d.value)return;const g={...u,theme:s.theme==="dark"?"dark":"classic",preview:{...u.preview,hljs:{style:s.theme==="dark"?"native":"github"}},after:()=>{m==null||m.setValue(s.modelValue),m==null||m.setTheme(s.theme==="dark"?"dark":"classic")}};m=new Cr(d.value,g)}),$i(()=>{try{m&&(m.destroy(),m=null)}catch(g){console.warn("Vditor destroy error",g)}}),e({clear:()=>{m&&(m.setValue(""),l("update:modelValue",""))},insertValue:g=>{m&&(m.insertValue(g),l("update:modelValue",m.getValue()))}}),Et(()=>s.theme,g=>{m&&m.setTheme(g==="dark"?"dark":"classic")}),(g,S)=>(J(),ae("div",{ref_key:"editorContainer",ref:d,class:"vditor-container"},null,512))}}),Cd={class:"flex items-center gap-2"},_d={class:"space-y-4"},Td={class:"relative"},Md={class:"flex justify-between items-center"},Ad={class:"flex justify-end gap-2"},Ld=rn({__name:"Searchmode",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","search-result"],setup(p,{expose:e,emit:r}){const s=Ke(),d=gn().public.baseApi||"/api",m=p,u=r,g=he({get:()=>m.modelValue,set:f=>u("update:modelValue",f)}),S=()=>{u("update:modelValue",!1)},k=G(""),h=async()=>{var f,b;if(!k.value.trim()){s.add({title:"提示",description:"请输入搜索关键词",color:"yellow"});return}try{const{data:y,error:E}=await Bc("/messages/search",{method:"GET",baseURL:d,params:{keyword:k.value,page:1,pageSize:10}},"$4cD5OWGgav");if(E.value)throw new Error(((f=E.value)==null?void 0:f.message)||"网络请求失败");if(!y.value)throw new Error("未收到服务器响应");if(y.value.code===1)u("search-result",y.value),u("update:modelValue",!1),k.value="",s.add({title:"成功",description:"搜索完成",color:"green"});else throw new Error(((b=y.value)==null?void 0:b.msg)||"搜索失败")}catch(y){console.error("Search error:",y),s.add({title:"错误",description:y instanceof Error?y.message:"搜索失败，请稍后重试",color:"red"})}};return e({handleSearch:h}),(f,b)=>{const y=fi,E=fa,w=Mr,C=da,_=ha;return J(),Lt(_,{modelValue:g.value,"onUpdate:modelValue":b[1]||(b[1]=T=>g.value=T),ui:{container:"items-center",base:"backdrop-blur-sm"}},{default:Ce(()=>[te(C,{class:"search-card"},{header:Ce(()=>[I("div",Cd,[te(y,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5"}),b[2]||(b[2]=I("h3",{class:"text-base font-semibold"},"站内搜索",-1))])]),default:Ce(()=>[I("div",_d,[I("div",Td,[te(y,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 opacity-70"}),te(E,{modelValue:k.value,"onUpdate:modelValue":b[0]||(b[0]=T=>k.value=T),placeholder:"请输入关键词",class:"w-full pl-10",ui:{base:"rounded-xl"},onKeyup:us(h,["enter"]),autofocus:""},null,8,["modelValue"])]),I("div",Md,[b[5]||(b[5]=I("div",{class:"text-xs opacity-70"},"按 Enter 搜索，Esc 关闭",-1)),I("div",Ad,[te(w,{variant:"ghost",color:"gray",onClick:S},{default:Ce(()=>b[3]||(b[3]=[gt("取消")])),_:1}),te(w,{color:"orange",onClick:h},{default:Ce(()=>b[4]||(b[4]=[gt("搜索")])),_:1})])])])]),_:1})]),_:1},8,["modelValue"])}}}),Ys=Cn(Ld,[["__scopeId","data-v-16a007f5"]]),Dd=ls("notify",{state:()=>({config:{webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:"",twitterEnabled:!1,twitterApiKey:"",twitterApiSecret:"",twitterAccessToken:"",twitterAccessTokenSecret:"",customHttpEnabled:!1,customHttpUrl:"",customHttpMethod:"POST",customHttpHeaders:"",customHttpBody:'{"content":"{{content}}"}'}}),actions:{async fetchConfig(){try{const e=await(await fetch("/api/notify/config",{credentials:"include"})).json();e.code===1&&(this.config=e.data)}catch(p){console.error("获取推送配置失败:",p)}},async saveConfig(p){try{const r=await(await fetch("/api/notify/config",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).json();if(r.code===1){const s=r.data||p;return Object.keys(this.config).forEach(l=>{l.endsWith("Enabled")?this.config[l]=!!s[l]&&s[l]!=="false":s[l]!==void 0&&(this.config[l]=s[l])}),!0}return!1}catch(e){return console.error("保存推送配置失败:",e),!1}},async testNotify(p){try{return(await(await fetch("/api/notify/test",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:p})})).json()).code===1}catch(e){return console.error("测试推送失败:",e),!1}},async sendNotify(p){try{let e=p.content;return p.images&&p.images.length>0&&(e+=`

`,p.images.forEach(l=>{e+=`![](${l})
`})),(await(await fetch("/api/notify/send",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e,format:p.format||"markdown",config:this.config})})).json()).code===1}catch(e){return console.error("发送推送失败:",e),!1}}}}),Od=rn({__name:"VideoUpload",emits:["video-uploaded","upload-progress"],setup(p,{emit:e}){const r=e,s=G(null),l=Ke(),d=gn().public.baseApi||"/api",m=()=>{var g;(g=s.value)==null||g.click()},u=async g=>{const S=g.target,k=S.files?S.files[0]:null;if(!k){l.add({title:"错误",description:"未选择视频",color:"red"});return}const h=200*1024*1024;if(k.size>h){l.add({title:"错误",description:"视频不能超过200MB",color:"red"});return}const f=new FormData;f.append("video",k);const b=new XMLHttpRequest;b.open("POST",`${d}/video/upload`,!0),b.withCredentials=!0,b.upload.onprogress=y=>{if(y.lengthComputable){const E=Math.round(y.loaded/y.total*100);r("upload-progress",E)}},b.onload=()=>{if(b.status===200)try{const y=JSON.parse(b.responseText);if(y.code===1&&y.data)r("video-uploaded",y.data),l.add({title:"成功",description:"视频上传成功",color:"green"});else throw new Error(y.msg||"视频上传失败")}catch(y){l.add({title:"错误",description:y.message||"视频上传失败",color:"red"})}else l.add({title:"错误",description:"视频上传失败",color:"red"});r("upload-progress",0),s.value&&(s.value.value="")},b.onerror=()=>{l.add({title:"错误",description:"视频上传失败",color:"red"}),r("upload-progress",0),s.value&&(s.value.value="")},b.send(f)};return(g,S)=>{const k=fi;return J(),ae("div",null,[I("input",{ref_key:"videoInput",ref:s,type:"file",accept:"video/*",class:"hidden",onChange:u},null,544),I("button",{class:"tb-btn",onClick:m,title:"上传视频"},[te(k,{name:"i-mdi-video",class:"w-5 h-5"})])])}}}),Pd=Cn(Od,[["__scopeId","data-v-8ae38874"]]),Rd={class:"flex justify-between items-center mb-3"},Id={class:"mb-4"},Hd={class:"flex gap-2 mb-3"},Nd={key:0,class:"space-y-2 mb-3"},jd={class:"flex items-center gap-2"},$d={class:"flex justify-end mt-2 mb-3"},Bd=["src"],Ud={key:3,class:"text-sm text-gray-300"},zd={key:4,class:"text-sm text-gray-300"},Fd={key:1,class:"flex justify-end mt-2"},Vd={key:2,class:"mt-2 text-red-400 text-sm"},qd={key:3,class:"mt-2"},Wd={class:"flex items-center gap-2 bg-gray-800 p-2 rounded"},Yd=["value"],Kd={class:"flex justify-end mt-2"},Gd=rn({__name:"ImageHostingUploader",props:{position:{type:Object,required:!0,default:()=>({x:0,y:0})},editorRef:{type:Object,required:!1,default:null}},emits:["close","upload-success"],setup(p,{emit:e}){const r=p,s=he(()=>{if(typeof window>"u")return{};const oe=window.innerWidth,re=window.innerHeight,Ae=400,Ge=500;let Z=r.position.x,ke=r.position.y;return Z+Ae>oe&&(Z=oe-Ae-20),Z<0&&(Z=20),ke+Ge>re&&(ke=re-Ge-20),ke<0&&(ke=20),oe<1024&&(Z=(oe-Ae)/2,ke=60),{position:"fixed",top:`${ke}px`,left:`${Z}px`,maxWidth:`${Math.min(Ae,oe-40)}px`,width:"100%",cursor:"move",userSelect:"none",touchAction:"none"}}),l=G(!1),d=G({x:0,y:0}),m=oe=>{l.value=!0;const re="touches"in oe?oe.touches[0].clientX:oe.clientX,Ae="touches"in oe?oe.touches[0].clientY:oe.clientY;d.value={x:re-r.position.x,y:Ae-r.position.y},document.addEventListener("mousemove",u),document.addEventListener("touchmove",u),document.addEventListener("mouseup",g),document.addEventListener("touchend",g)},u=oe=>{if(!l.value)return;const re="touches"in oe?oe.touches[0].clientX:oe.clientX,Ae="touches"in oe?oe.touches[0].clientY:oe.clientY;S("update:position",{x:re-d.value.x,y:Ae-d.value.y})},g=()=>{l.value=!1,document.removeEventListener("mousemove",u),document.removeEventListener("touchmove",u),document.removeEventListener("mouseup",g),document.removeEventListener("touchend",g)},S=e,k=Ke(),h=G("smms"),f=G(null),b=G(!1),y=G(!1),E=G(0),w=G(""),C=G(""),_=G(""),T=G(""),M=G(""),v=G("main"),D=G("images/"),N=G(!1),V=G(""),H=G(""),$=G(""),z=()=>{var oe;(oe=f.value)==null||oe.click()},F=oe=>{var Ae;b.value=!1;const re=(Ae=oe.dataTransfer)==null?void 0:Ae.files;re&&re.length>0&&Pe(re[0])},le=oe=>{const Ae=oe.target.files;Ae&&Ae.length>0&&Pe(Ae[0])},de=G(null),Pe=async oe=>{if(!oe.type.startsWith("image/")){_.value="请选择图片文件";return}const re=5*1024*1024;if(oe.size>re){_.value="图片大小不能超过 5MB";return}_.value="",de.value=oe;const Ae=new FileReader;Ae.onload=Ge=>{var Z;w.value=(Z=Ge.target)==null?void 0:Z.result},Ae.readAsDataURL(oe)},Ue=()=>{if(!C.value){_.value="请先上传图片";return}const oe=`![](${C.value})`;S("upload-success",oe),S("close"),de.value=null,w.value="",C.value="",E.value=0,y.value=!1,_.value=""},Te=async oe=>{try{await navigator.clipboard.writeText(oe),k.add({title:"成功",description:"已复制到剪贴板",color:"green",timeout:2e3})}catch{k.add({title:"错误",description:"复制失败",color:"red",timeout:2e3})}},Le=async()=>{if(!de.value){_.value="请先选择图片";return}y.value=!0,E.value=0,_.value="";try{switch(h.value){case"github":await Re(de.value);break;default:throw new Error("未知的图床类型")}}catch(oe){console.error("上传错误:",oe),_.value=oe.message||"上传失败",y.value=!1,oe.name==="AbortError"?_.value="请求超时，请检查网络连接":oe.message.includes("Failed to fetch")&&(_.value="网络请求失败，可能是跨域问题或API不可用")}},Re=async oe=>{if(!T.value||!M.value){_.value="请先配置 GitHub Token 和仓库名";return}try{E.value=30;const re=Date.now(),Ae=oe.name.split(".").pop(),Ge=`${re}.${Ae}`,Z=`${D.value}${Ge}`.replace(/\/\//g,"/"),ke=await Je(oe),se={message:`Upload image ${Ge}`,content:ke,branch:v.value||"main"};E.value=50;const ee=await fetch(`https://api.github.com/repos/${M.value}/contents/${Z}`,{method:"PUT",headers:{Authorization:`token ${T.value}`,"Content-Type":"application/json"},body:JSON.stringify(se)});if(E.value=80,!ee.ok)throw new Error(`GitHub 上传失败: ${ee.status}`);const Ie=await ee.json();C.value=N.value&&V.value?`https://${V.value}/gh/${M.value}@${v.value||"main"}/${Z}`:Ie.content.download_url,E.value=100,y.value=!1,k.add({title:"成功",description:`图片已上传到 GitHub${N.value&&V.value?" (CDN加速)":""}`,color:"green",timeout:2e3})}catch(re){console.error("GitHub 上传错误:",re),_.value=re.message||"GitHub 上传失败",y.value=!1}},Je=oe=>new Promise((re,Ae)=>{const Ge=new FileReader;Ge.onload=()=>re(Ge.result.split(",")[1]),Ge.onerror=Ae,Ge.readAsDataURL(oe)}),tt=()=>{try{const oe={selectedHost:h.value,github:{token:T.value,repo:M.value,branch:v.value,path:D.value,enableCDN:N.value,cdnDomain:V.value},smms:{token:H.value},freeimage:{token:$.value}};localStorage.setItem("imageHostingConfig",JSON.stringify(oe)),k.add({title:"成功",description:"配置已保存",color:"green",timeout:2e3})}catch(oe){console.error("保存配置失败:",oe),k.add({title:"错误",description:"保存配置失败",color:"red",timeout:2e3})}},U=()=>{const oe=localStorage.getItem("imageHostingConfig");if(oe)try{const re=JSON.parse(oe);h.value=re.selectedHost||"smms",re.github&&(T.value=re.github.token||"",M.value=re.github.repo||"",v.value=re.github.branch||"main",D.value=re.github.path||"images/",N.value=re.github.enableCDN||!1,V.value=re.github.cdnDomain||""),re.smms&&(H.value=re.smms.token||""),re.imgtp&&(imgtpToken.value=re.imgtp.token||""),re.freeimage&&($.value=re.freeimage.token||"")}catch(re){console.error("加载配置失败:",re)}};return Et([h,T,M,v,D,H],()=>{tt()},{deep:!0}),zt(()=>{U()}),(oe,re)=>{const Ae=Mr,Ge=fa,Z=_c,ke=fi,se=Tc;return J(),ae("div",{class:"fixed z-[5000] bg-black/80 backdrop-blur-sm rounded-lg shadow-lg p-4 text-white",style:wi(s.value),onMousedown:m,onTouchstart:m},[I("div",Rd,[re[11]||(re[11]=I("h3",{class:"text-lg font-medium"},"图床上传",-1)),te(Ae,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",size:"xs",onClick:re[0]||(re[0]=ee=>oe.$emit("close"))})]),I("div",Id,[I("div",Hd,[te(Ae,{color:h.value==="github"?"blue":"gray",variant:"solid",size:"sm",onClick:re[1]||(re[1]=ee=>h.value="github")},{default:Ce(()=>re[12]||(re[12]=[gt(" GitHub ")])),_:1},8,["color"])]),h.value==="github"?(J(),ae("div",Nd,[te(Ge,{modelValue:T.value,"onUpdate:modelValue":re[2]||(re[2]=ee=>T.value=ee),placeholder:"GitHub Token",size:"sm",type:"password"},null,8,["modelValue"]),te(Ge,{modelValue:M.value,"onUpdate:modelValue":re[3]||(re[3]=ee=>M.value=ee),placeholder:"仓库名 (用户名/仓库)",size:"sm"},null,8,["modelValue"]),te(Ge,{modelValue:v.value,"onUpdate:modelValue":re[4]||(re[4]=ee=>v.value=ee),placeholder:"分支名 (默认: main)",size:"sm"},null,8,["modelValue"]),te(Ge,{modelValue:D.value,"onUpdate:modelValue":re[5]||(re[5]=ee=>D.value=ee),placeholder:"存储路径 (默认: images/)",size:"sm"},null,8,["modelValue"]),I("div",jd,[te(Z,{modelValue:N.value,"onUpdate:modelValue":re[6]||(re[6]=ee=>N.value=ee)},null,8,["modelValue"]),re[13]||(re[13]=I("span",{class:"text-sm"},"启用CDN加速",-1))]),N.value?(J(),Lt(Ge,{key:0,modelValue:V.value,"onUpdate:modelValue":re[7]||(re[7]=ee=>V.value=ee),placeholder:"输入CDN域名 (如: jsd.cdn.noisework.cn)",size:"sm"},null,8,["modelValue"])):Me("",!0)])):Me("",!0),I("div",$d,[te(Ae,{color:"green",variant:"solid",size:"sm",icon:"i-heroicons-check",onClick:tt},{default:Ce(()=>re[14]||(re[14]=[gt(" 保存配置 ")])),_:1})]),I("div",{class:be(["flex flex-col items-center justify-center border-2 border-dashed border-gray-500 rounded-lg p-4 cursor-pointer hover:border-blue-400 transition-colors",{"border-blue-400":b.value}]),onClick:z,onDragover:re[8]||(re[8]=rr(ee=>b.value=!0,["prevent"])),onDragleave:re[9]||(re[9]=rr(ee=>b.value=!1,["prevent"])),onDrop:rr(F,["prevent"])},[I("input",{ref_key:"fileInput",ref:f,type:"file",accept:"image/*",onChange:le,class:"hidden"},null,544),!y.value&&!w.value?(J(),Lt(ke,{key:0,name:"i-heroicons-cloud-arrow-up",class:"w-10 h-10 text-gray-400 mb-2"})):Me("",!0),w.value&&!y.value?(J(),ae("img",{key:1,src:w.value,class:"max-h-32 max-w-full mb-2 rounded"},null,8,Bd)):Me("",!0),y.value?(J(),Lt(se,{key:2,value:E.value,color:"blue",class:"w-full mb-2"},null,8,["value"])):Me("",!0),!y.value&&!w.value?(J(),ae("p",Ud," 点击或拖拽图片到此处上传 ")):Me("",!0),y.value?(J(),ae("p",zd," 上传中... "+qe(E.value)+"% ",1)):Me("",!0)],34),w.value&&!y.value&&!C.value?(J(),ae("div",Fd,[te(Ae,{color:"blue",variant:"solid",size:"sm",icon:"i-heroicons-cloud-arrow-up",onClick:Le},{default:Ce(()=>re[15]||(re[15]=[gt(" 开始上传 ")])),_:1})])):Me("",!0),_.value?(J(),ae("div",Vd,qe(_.value),1)):Me("",!0),C.value?(J(),ae("div",qd,[I("div",Wd,[I("input",{type:"text",value:C.value,readonly:"",class:"bg-transparent flex-1 text-sm outline-none"},null,8,Yd),te(Ae,{icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",size:"xs",onClick:re[10]||(re[10]=ee=>Te(C.value))})]),I("div",Kd,[te(Ae,{color:"blue",variant:"solid",size:"sm",onClick:Ue},{default:Ce(()=>re[16]||(re[16]=[gt(" 插入图片 ")])),_:1})])])):Me("",!0)])],36)}}}),Xd=Cn(Gd,[["__scopeId","data-v-9124ba85"]]),Zd={class:"editor-box"},Jd={class:"editor-toolbar"},Qd={class:"toolbar-left"},ef={key:0,class:"w-full mt-2"},tf={class:"bg-gray-700 rounded h-2"},nf={class:"text-xs text-gray-300 mt-1 text-right"},rf=["title"],af=["title"],of={class:"toolbar-right"},sf={key:0,class:"mx-auto sm:max-w-2xl mt-4 preview-card"},lf=["innerHTML"],cf=rn({__name:"AddForm",emits:["search-result","video-uploaded","before-upload","upload-progress"],setup(p,{emit:e}){const r=G(!1),s=G({x:400,y:320}),l=U=>{var oe;(oe=v.value)!=null&&oe.insertValue&&v.value.insertValue(U),r.value=!1},d=U=>{s.value=U},m=G(0),u=U=>{m.value=U},g=G(!1),S=e,k=U=>{S("search-result",U)},h=Ke(),f=gn().public.baseApi||"/api",{save:b}=Ms(),y=Bi("showHeatmap");kr("showHeatmap",y);const E=G(""),w=G(""),C=G(""),_=G(typeof window<"u"&&localStorage.getItem("postPrivate")==="true"),T=Bi("contentTheme");Bi("toggleContentTheme");const M=G(null),v=G(null),D=he(()=>_.value?"i-mdi-eye-off-outline":"i-mdi-eye-outline"),N=he(()=>T.value==="dark"?"prose prose-invert":"prose");Dd();const V=G(localStorage.getItem("enableNotify")==="true"),H=()=>{E.value="",w.value="",C.value="",v.value&&v.value.clear()},$=Gn(),z=()=>$.isLogin?!0:(h.add({title:"提示",description:"请先登录",color:"orange",timeout:2e3}),!1),F=()=>{const U=document.getElementById("file-input");U&&U.click()},le=async U=>{var se;if(!z())return;const oe=U.target,re=oe.files?oe.files[0]:null;if(!re){h.add({title:"错误",description:"没有选择文件",color:"red",timeout:2e3});return}const Ae=["image/jpeg","image/png","image/gif","image/webp"],Ge=[".jpg",".jpeg",".png",".gif",".webp"],Z=re.name.toLowerCase().substring(re.name.lastIndexOf("."));if(!Ae.includes(re.type)||!Ge.includes(Z)){h.add({title:"错误",description:"仅支持 JPG、PNG、GIF、WEBP 格式的图片",color:"red",timeout:2e3});return}const ke=5*1024*1024;if(re.size>ke){h.add({title:"错误",description:"图片大小不能超过 5MB",color:"red",timeout:2e3});return}try{const ee=new FormData;ee.append("image",re);const Ie=await fetch(`${f}/images/upload`,{method:"POST",body:ee,credentials:"include"});if(!Ie.ok){const lt=await Ie.json();throw new Error(lt.msg||"图片上传失败")}const ye=await Ie.json();if(ye.code===1&&ye.data){if((se=v.value)!=null&&se.insertValue){const lt=typeof window<"u"?window.location.origin:"",Ve=String(f||"/api"),Qe=String(ye.data||"");let De="";if(Qe.startsWith("http"))De=Qe;else{const ct=Qe.startsWith("/")?Qe:`/${Qe}`;/^https?:\/\//.test(Ve)?De=`${Ve}${ct}`:De=`${lt}${Ve}${ct}`}const nt=`
![](${De})
`;v.value.insertValue(nt)}h.add({title:"成功",description:"图片上传成功",color:"green",timeout:2e3})}else throw new Error(ye.msg||"图片上传失败")}catch(ee){console.error("上传错误:",ee),h.add({title:"错误",description:ee.message||"图片上传失败",color:"red",timeout:2e3})}finally{M.value&&(M.value.value="")}},de=U=>{var Z;const oe=String(U||""),re=gn().public.baseApi||"/api";let Ae=oe;if(!/^https?:\/\//.test(oe)){const ke=oe.startsWith("/")?oe:`/${oe}`;/^https?:\/\//.test(String(re))?Ae=`${String(re).replace(/\/api$/,"")}${ke}`:Ae=`${typeof window<"u"?window.location.origin:""}${ke}`}const Ge=`<video width="100%" height="100%" src="${Ae}" controls loop></video>
`;(Z=v.value)!=null&&Z.insertValue&&v.value.insertValue(Ge)},Pe=/!\s*(https?:\/\/[^\s!]+\.(?:png|jpe?g|gif|webp))(?:\?[^\s!]*)?/gi,Ue=U=>U.replace(Pe,(oe,re)=>`![](${re})`),Te=U=>{const re=new DOMParser().parseFromString(U,"text/html"),Ae=se=>{let ee=!0;const Ie=Array.from(se.childNodes);if(Ie.length===0)return!1;for(const ye of Ie)if(ye.nodeType===Node.ELEMENT_NODE){const lt=ye,Ve=lt.tagName.toLowerCase();if(Ve==="img"||Ve==="a"&&lt.childElementCount===1&&lt.querySelector("img"))continue;if(Ve==="br"){ee=!1;break}ee=!1;break}else if(ye.nodeType===Node.TEXT_NODE&&(ye.textContent||"").trim()!==""){ee=!1;break}return ee},Ge=Array.from(re.body.querySelectorAll("p")),Z=[];let ke=[];for(const se of Ge)if(Ae(se)){const ee=ke[ke.length-1];!ee||ee.nextElementSibling===se?ke.push(se):(ke.length>=2&&Z.push(ke),ke=[se])}else ke.length>=2&&Z.push(ke),ke=[];ke.length>=2&&Z.push(ke);for(const se of Z){const ee=re.createElement("div"),Ie=se.length,ye=Ie===2||Ie===4?2:Math.min(3,Ie);ee.className=`image-grid cols-${ye}`;const lt=`grid-${Math.random().toString(36).slice(2)}`;for(const Qe of se){const De=Qe.querySelector("img"),nt=Qe.querySelector("a");if(!De&&!nt)continue;const ct=re.createElement("div");ct.className="image-grid-item";let dt;if(nt&&nt.querySelector("img")){if(dt=nt,dt.setAttribute("data-fancybox",lt),!dt.getAttribute("href")){const ft=nt.querySelector("img");dt.setAttribute("href",ft.src)}}else if(De)dt=re.createElement("a"),dt.setAttribute("href",De.src),dt.setAttribute("data-fancybox",lt),dt.appendChild(De);else continue;ct.appendChild(dt),ee.appendChild(ct)}se[0].replaceWith(ee);for(let Qe=1;Qe<se.length;Qe++)se[Qe].remove()}return re.body.innerHTML};Et(w,U=>{const oe=Cr.md2html(Ue(U||""));C.value=Te(oe),bt(()=>{document.querySelectorAll(".editor-preview").forEach(Ae=>{Ae.querySelectorAll(".image-grid-item img").forEach(Ge=>{const Z=Ge,ke=Z.parentElement,se=()=>{const ee=Z.naturalWidth,Ie=Z.naturalHeight;ke.classList.remove("ar-169","ar-34","ar-11"),ee>Ie?ke.classList.add("ar-169"):Ie>ee?ke.classList.add("ar-34"):ke.classList.add("ar-11")};Z.complete&&Z.naturalWidth&&Z.naturalHeight?se():Z.addEventListener("load",se,{once:!0})})})})}),Et(()=>$.isLogin,U=>{U&&(V.value=localStorage.getItem("enableNotify")==="true")},{immediate:!0}),zt(async()=>{vt.bind("[data-fancybox]",{}),$.isLogin||localStorage.getItem("token")&&$.fetchUserInfo&&await $.fetchUserInfo(),_.value=localStorage.getItem("postPrivate")==="true",T.value=localStorage.getItem("contentTheme")||T.value}),$i(()=>{vt.destroy()});const Le=()=>{V.value=!V.value,localStorage.setItem("enableNotify",V.value.toString())},Re=()=>{_.value=!_.value,localStorage.setItem("postPrivate",_.value?"true":"false")},Je=U=>$.isLogin?!0:(h.add({title:"提示",description:"请登录后操作",color:"orange",timeout:2e3}),U.preventDefault&&U.preventDefault(),!1),tt=async()=>{if(!z())return;if(!w.value.trim()){h.add({title:"错误",description:"请输入内容或上传图片/视频",color:"red",timeout:2e3});return}const U={username:E.value,content:w.value,private:_.value,notify:V.value};try{await b(U)&&H()}catch(oe){console.error("发布错误:",oe),h.add({title:"错误",description:oe.message||"发布失败",color:"red",timeout:2e3})}};return(U,oe)=>{const re=fi;return J(),ae(Ut,null,[I("div",{class:be(U.containerClass)},[I("div",Zd,[te(xd,{ref_key:"vditorEditor",ref:v,modelValue:w.value,"onUpdate:modelValue":oe[0]||(oe[0]=Ae=>w.value=Ae),theme:ve(T)},null,8,["modelValue","theme"]),I("div",Jd,[I("div",Qd,[I("input",{id:"file-input",ref_key:"fileInput",ref:M,type:"file",accept:"image/*",onChange:le,class:"hidden",placeholder:"选择图片"},null,544),te(Pd,{onVideoUploaded:de,onBeforeUpload:Je,onUploadProgress:u}),m.value>0&&m.value<100?(J(),ae("div",ef,[I("div",tf,[I("div",{class:"bg-blue-500 h-2 rounded",style:wi({width:m.value+"%"})},null,4)]),I("div",nf,qe(m.value)+"%",1)])):Me("",!0),I("button",{class:"tb-btn",onClick:F,title:"插入图片"},[te(re,{name:"i-fluent-image-20-regular",class:"w-5 h-5"})]),I("button",{class:"tb-btn",onClick:oe[1]||(oe[1]=Ae=>r.value=!0),title:"图床上传"},[te(re,{name:"i-mdi-cloud-upload-outline",class:"w-5 h-5"})]),I("button",{class:"tb-btn",onClick:Re,title:_.value?"设为公开":"设为私密"},[te(re,{name:D.value,class:"w-5 h-5"},null,8,["name"])],8,rf),I("button",{class:"tb-btn",onClick:Le,title:V.value?"关闭推送":"开启推送"},[te(re,{name:V.value?"i-mdi-bell":"i-mdi-bell-off",class:"w-5 h-5"},null,8,["name"])],8,af)]),I("div",of,[I("button",{class:"tb-btn",onClick:H,title:"清空"},[te(re,{name:"i-fluent-broom-16-regular",class:"w-5 h-5"})]),I("button",{class:"tb-btn primary",onClick:tt,title:"发布"},[te(re,{name:"i-fluent-add-12-filled",class:"w-5 h-5"})])])])])],2),C.value?(J(),ae("div",sf,[I("div",{class:be([N.value,"max-w-none editor-preview"])},[I("div",{innerHTML:C.value},null,8,lf)],2)])):Me("",!0),te(Ys,{modelValue:g.value,"onUpdate:modelValue":oe[2]||(oe[2]=Ae=>g.value=Ae),onSearchResult:k},null,8,["modelValue"]),r.value?(J(),Lt(Xd,{key:1,position:s.value,onClose:oe[3]||(oe[3]=Ae=>r.value=!1),onUploadSuccess:l,"onUpdate:position":d},null,8,["position"])):Me("",!0)],64)}}}),uf=Cn(cf,[["__scopeId","data-v-e8e01b9d"]]),ki=rn({__name:"MarkdownRenderer",props:{content:{type:String,required:!0},enableGithubCard:{type:Boolean,default:!0}},emits:["tagClick","rendered"],setup(p,{emit:e}){const r=/https:\/\/www\.bilibili\.com\/video\/(BV[\w]+)\/?$/,s=/https:\/\/(?:www\.)?youtube\.com\/watch\?v=([\w-]+)|https:\/\/youtu\.be\/([\w-]+)/,l=/https:\/\/music\.163\.com(?:\/#)?\/song\?id=(\d+)/,d=/https:\/\/y\.qq\.com\/n\/yqq\/song(\w+)\.html/,m=/https:\/\/v\.qq\.com\/x\/cover\/\w+\/(\w+)\.html/,u=/https:\/\/open\.spotify\.com\/(track|album|playlist)\/([a-zA-Z0-9]+)/,g=/https:\/\/v\.youku\.com\/v_show\/id_([a-zA-Z0-9]+)\.html/,S=e,k=G(null);let h=null;const f=p,b=Bi("contentTheme"),y=()=>{if(!k.value)return;const D=b&&b.value==="dark";k.value.classList.toggle("theme-dark",!!D),k.value.classList.toggle("theme-light",!D)},E=()=>{var D;if(window.mediumZoom){h&&h.detach();const N=(D=k.value)==null?void 0:D.getElementsByTagName("img");N&&N.length>0&&(h=window.mediumZoom(N,{background:"rgba(0, 0, 0, 0.9)",margin:24,scrollOffset:0}))}},w=()=>{if(!k.value)return;const D=$=>{let z=!0;const F=Array.from($.childNodes);if(F.length===0)return!1;for(const le of F)if(le.nodeType===Node.ELEMENT_NODE){const de=le,Pe=de.tagName.toLowerCase();if(Pe==="img"||Pe==="a"&&de.childElementCount===1&&de.querySelector("img"))continue;if(Pe==="br"){z=!1;break}z=!1;break}else if(le.nodeType===Node.TEXT_NODE&&(le.textContent||"").trim()!==""){z=!1;break}return z},N=Array.from(k.value.querySelectorAll("p")),V=[];let H=[];for(const $ of N)if(D($)){const z=H[H.length-1];!z||z.nextElementSibling===$?H.push($):(H.length>=2&&V.push(H),H=[$])}else H.length>=2&&V.push(H),H=[];H.length>=2&&V.push(H);for(const $ of V){const z=document.createElement("div"),F=$.length,le=F===2||F===4?2:Math.min(3,F);z.className=`image-grid cols-${le}`;const de=`grid-${Math.random().toString(36).slice(2)}`;for(const Ue of $){const Te=Ue.querySelector("img"),Le=Ue.querySelector("a");if(!Te&&!Le)continue;const Re=document.createElement("div");Re.className="image-grid-item";let Je;if(Le&&Le.querySelector("img")){if(Je=Le,Je.setAttribute("data-fancybox",de),!Je.getAttribute("href")&&Le.querySelector("img")){const tt=Le.querySelector("img");Je.setAttribute("href",tt.src)}}else if(Te)Je=document.createElement("a"),Je.setAttribute("href",Te.src),Je.setAttribute("data-fancybox",de),Je.appendChild(Te);else continue;Re.appendChild(Je),z.appendChild(Re)}z.querySelectorAll("img").forEach(Ue=>{const Te=Ue,Le=Te.closest(".image-grid-item"),Re=()=>{const Je=Te.naturalWidth,tt=Te.naturalHeight;Le&&(Le.classList.remove("ar-169","ar-34","ar-11"),Je>tt?Le.classList.add("ar-169"):tt>Je?Le.classList.add("ar-34"):Le.classList.add("ar-11"))};Te.complete&&Te.naturalWidth&&Te.naturalHeight?Re():Te.addEventListener("load",Re,{once:!0})}),$[0].replaceWith(z);for(let Ue=1;Ue<$.length;Ue++)$[Ue].remove()}},C=new RegExp("(?<!!)\\[([^\\]]+)\\]\\((https:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s)]*)?)\\)","g"),_=new RegExp(`(?<!["'\\(])\\bhttps:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s<\\)]*)?\\b`,"g"),T=D=>{f.enableGithubCard&&(D=D.replace(C,(V,H,$,z,F)=>`<div class="github-card" id="${`github-card-${z}-${F}`}" data-owner="${z}" data-repo="${F}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`),D=D.replace(_,(V,H,$)=>`<div class="github-card" id="${`github-card-${H}-${$}`}" data-owner="${H}" data-repo="${$}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`));const N=new RegExp(`(?<!["'\\(])\\bhttps?:\\/\\/[^\\s<]+\\.(mp4|webm|mov|avi)(\\?[^\\s<\\)]*)?\\b`,"g");return D=D.replace(N,V=>`<video src="${V}" controls preload="metadata" style="width:100%;height:auto"></video>`),D.replace(r,"<div class='video-wrapper'><iframe src='https://www.bilibili.com/blackboard/html5mobileplayer.html?bvid=$1&as_wide=1&high_quality=1&danmaku=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' style='position:absolute;height:100%;width:100%'></iframe></div>").replace(s,"<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$1$2' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></div>").replace(l,"<div class='music-wrapper'><meting-js auto='https://music.163.com/#/song?id=$1'></meting-js></div>").replace(d,"<meting-js auto='https://y.qq.com/n/yqq/song$1.html'></meting-js>").replace(m,"<div class='video-wrapper'><iframe src='//v.qq.com/iframe/player.html?vid=$1' allowFullScreen='true' frameborder='no'></iframe></div>").replace(u,"<div class='spotify-wrapper'><iframe style='border-radius:12px' src='https://open.spotify.com/embed/$1/$2?utm_source=generator&theme=0' width='100%' frameBorder='0' allowfullscreen='' allow='autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture' loading='lazy'></iframe></div>").replace(g,"<div class='video-wrapper'><iframe src='https://player.youku.com/embed/$1' frameborder=0 'allowfullscreen'></iframe></div>")},M=async(D,N,V)=>{try{const H=await fetch(`https://api.github.com/repos/${D}/${N}`);if(!H.ok)return;const $=await H.json(),z=document.getElementById(V);z&&(z.innerHTML=`
        <div class="github-card-header">
          <img src="${$.owner.avatar_url}" class="github-card-avatar" />
          <div>
            <a href="${$.html_url}" target="_blank" class="github-card-title">${$.full_name}</a>
            <div class="github-card-desc">${$.description||""}</div>
          </div>
        </div>
        <div class="github-card-footer">
          <span>⭐ ${$.stargazers_count}</span>
          <span>🍴 ${$.forks_count}</span>
          <span>🛠️ ${$.language||""}</span>
        </div>
      `)}catch{}},v=async D=>{if(k.value)try{if(typeof Cr>"u"){console.error("Vditor is not loaded.");return}let N="";try{N=normalizeInlineImageLinks(D??"")}catch{N=D??""}const V=T(N),$=(de=>de.replace(/(^|\s)(https?:\/\/[^\s<]+)/g,(Pe,Ue,Te)=>`${Ue}<a href="${Te}" target="_blank" rel="noopener noreferrer">${Te}</a>`))(V);let z="";try{z=$.replace(/<a /g,'<a target="_blank" ').replace(new RegExp("(?<!<[^>]*)#([^\\s#<>]+)(?![^<]*>)","g"),`<span class="clickable-tag" onclick="window.handleTagClick('$1')" style="cursor: pointer;">#$1</span>`)}catch{z=$.replace(/<a /g,'<a target="_blank" ')}const F=b&&b.value==="dark"?"dark":"light",le=F==="dark"?"github-dark":"github";try{Cr.preview(k.value,z,{mode:"light",lang:"zh_CN",theme:{current:F},hljs:{style:le,lineNumber:!0,enable:!0},markdown:{sanitize:!1},after:()=>{var Le,Re,Je,tt;const de=(Le=k.value)==null?void 0:Le.querySelectorAll("a");de==null||de.forEach(U=>{U.hasAttribute("target")||(U.setAttribute("target","_blank"),U.setAttribute("rel","noopener noreferrer"))}),y(),w(),E(),(((Re=k.value)==null?void 0:Re.querySelectorAll("a[href]"))||[]).forEach(U=>{const oe=U.getAttribute("href")||"";if(/\.(mp4|webm|mov|avi)(\?.*)?$/i.test(oe)){const re=document.createElement("video");re.setAttribute("src",oe),re.setAttribute("controls","true"),re.setAttribute("preload","metadata"),re.style.width="100%",re.style.height="auto",U.replaceWith(re)}}),console.log("Rendering complete."),S("rendered");const Ue=window.processNMPv2Shortcodes;Ue&&k.value&&Ue(k.value);const Te=(Je=k.value)==null?void 0:Je.querySelectorAll(".clickable-tag");if(Te==null||Te.forEach(U=>{U.addEventListener("click",oe=>{var Ae;oe.preventDefault();const re=(Ae=U.textContent)==null?void 0:Ae.substring(1);re&&S("tagClick",re)})}),f.enableGithubCard){const U=(tt=k.value)==null?void 0:tt.querySelectorAll(".github-card");U==null||U.forEach(oe=>{const re=oe.getAttribute("data-owner"),Ae=oe.getAttribute("data-repo"),Ge=oe.id;re&&Ae&&Ge&&M(re,Ae,Ge)})}}})}catch{try{k.value.innerHTML=Cr.md2html(z),y()}catch{k.value.innerHTML=z}}}catch(N){console.error("Error rendering markdown:",N),k.value.innerHTML=""}};return Et(()=>f.content,async D=>{await v(D)},{immediate:!0}),zt(()=>{v(f.content),window.APlayer&&window.MetingJSElement?console.log("MetingJS is ready"):console.error("MetingJS or APlayer is not loaded properly"),y()}),$i(()=>{h&&(h.detach(),h=null)}),Et(()=>b&&b.value,()=>{y(),v(f.content)}),(D,N)=>(J(),ae("div",{ref_key:"previewElement",ref:k,class:"markdown-preview"},null,512))}}),df={class:"builtin-comments"},ff={key:0,class:"comments-list"},hf=["src","data-mail","onError"],pf={class:"comment-body"},mf={class:"comment-nick"},gf=["href"],vf={class:"comment-footer"},bf={class:"comment-time"},yf={class:"comment-replies"},wf={class:"comment-actions"},kf=["onClick"],Ef=["onClick"],Sf={key:0,class:"mt-2 replies-list"},xf=["src","data-mail","onError"],Cf={class:"comment-body"},_f={class:"comment-nick"},Tf=["href"],Mf={class:"comment-footer"},Af={class:"comment-time"},Lf={class:"comment-actions"},Df=["onClick"],Of=["onClick"],Pf={key:1,class:"flex justify-end w-full"},Rf=["onClick"],If={key:1,class:"flex justify-center"},Hf={key:4,class:"space-y-3 mt-3 md:mt-4"},Nf={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},jf={class:"flex flex-wrap items-center gap-2 mb-2"},$f={class:"relative"},Bf={class:"flex flex-wrap gap-1 w-56"},Uf=["onClick"],zf={class:"comment-input-card"},Ff=["src","data-mail"],Vf={class:"input-main"},qf={class:"input-actions"},Wf=["disabled"],Yf={class:"flex justify-between items-center"},Kf={class:"space-y-3"},Gf={class:"text-sm"},Xf={class:"text-sm"},Zf={class:"text-sm break-words"},Jf={class:"flex items-center gap-2 text-sm"},Qf={class:"flex justify-end gap-2"},ja="w-full px-2 py-1 border rounded ring-0 focus:ring-0 outline-none",$a="w-full px-2 py-1 bg-[rgba(24,28,32,0.85)] text-white border rounded focus:ring-0 outline-none placeholder:text-gray-400",eh=rn({__name:"BuiltinComments",props:{messageId:{},siteConfig:{},showInput:{type:Boolean}},setup(p){const e=p,r=G([]),s=G(""),l=G(""),d=G(!1),m=G(""),u=G(""),g=G(""),S=G(null),k=G(!1),h=G(null),f=G(!1),b=G(!1),y=G(null),E=Gn(),w=he(()=>{var Y;return!!((Y=E.user)!=null&&Y.is_admin)}),C=he(()=>{const Y=e.siteConfig||{};return!!(Y&&(Y.commentEnabled===!0||Y.commentEnabled==="true"))}),_=he(()=>{const Y=e.siteConfig||{};return!!(Y&&(Y.commentLoginRequired===!0||Y.commentLoginRequired==="true"))}),T=he(()=>(!_.value||E.isLogin)&&C.value),M=Bi("contentTheme",G("light")),v=he(()=>{const Y=M&&typeof M.value<"u"?M.value:M;return String(Y||"light")==="dark"}),D=he(()=>"bg-transparent"),N=he(()=>v.value?"border-white/20":"border-black"),V=he(()=>v.value?"text-gray-200":"text-black"),H=he(()=>v.value?"text-gray-400":"text-gray-500");he(()=>v.value?"bg-[rgba(24,28,32,0.7)]":"bg-white"),he(()=>v.value?"border-white/20":"border-black");const $=he(()=>v.value?"rounded-md p-3 bg-transparent border border-white/20 shadow-[0_6px_16px_rgba(0,0,0,0.35)]":"rounded-md p-3 bg-transparent border border-black/10 shadow-[0_4px_12px_rgba(0,0,0,0.12)]"),z=he(()=>v.value?"rounded-md p-2 bg-transparent border border-white/20":"rounded-md p-2 bg-transparent border border-black/10"),F=he(()=>f.value?"ring-1 ring-red-500":v.value?`${$a} border-white/20`:`bg-gray-50 ${ja} border-black`),le=he(()=>b.value?"ring-1 ring-red-500":v.value?`${$a} border-white/20`:`bg-gray-50 ${ja} border-black`),de=he(()=>v.value?`${$a} border-white/20`:`bg-white ${ja} border-black`),Pe=he(()=>v.value?"w-full px-3 py-2 bg-[rgba(24,28,32,0.95)] text-white border border-blue-500 focus:border-blue-400 rounded-md ring-0 outline-none":"w-full px-3 py-2 bg-white text-black border border-blue-500 focus:border-blue-600 rounded-md ring-0 outline-none"),Ue=he(()=>{const Y=e.siteConfig||{},X=String(Y.avatarURL||"").trim();return X?/^https?:\/\//i.test(X)?X:`${se}${X}`:String(Y.rssFaviconURL||"/favicon.svg").trim()}),Te=(Y,X=60)=>{const Ee=encodeURIComponent(String(Y||"").trim());return Ee?`https://api.dicebear.com/7.x/initials/svg?seed=${Ee}&backgroundType=gradient&radius=50&scale=100&size=${X}`:""},Le=Y=>{const X=String(Y||"").trim().match(/^([0-9]{5,12})@qq\.com$/i);return X?X[1]:""},Re=(Y,X=100)=>Y?`https://q1.qlogo.cn/g?b=qq&nk=${Y}&s=${X}`:"",Je=Y=>{var Hn,qn,ni,hi;const X=String((Y==null?void 0:Y.nick)||"").trim(),Ee=String((Y==null?void 0:Y.mail)||"").trim(),$e=Le(Ee),ze=Re($e),ut=Gn(),Be=String(((Hn=ut.user)==null?void 0:Hn.username)||((qn=ut.user)==null?void 0:qn.Username)||"").trim(),Rt=String(((ni=ut.user)==null?void 0:ni.avatar_url)||((hi=ut.user)==null?void 0:hi.AvatarURL)||"").trim(),tn=hn=>hn?/^https?:\/\//i.test(hn)?hn:`${se}${hn}`:"";return Be&&X&&Be===X&&Rt?tn(Rt):ze||tt(X||Ee||"anonymous")||Ue.value},tt=(Y,X=60)=>{const Ee=encodeURIComponent(String(Y||"").trim());return Ee?`https://i.pravatar.cc/${X}?u=${Ee}`:""},U=(Y=60)=>{const X=`<svg xmlns="http://www.w3.org/2000/svg" width="${Y}" height="${Y}" viewBox="0 0 64 64"><rect width="64" height="64" rx="32" fill="#9ca3af"/><circle cx="32" cy="24" r="12" fill="#e5e7eb"/><path d="M16 52c0-10 8-18 16-18s16 8 16 18" fill="#e5e7eb"/></svg>`;return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(X)},oe=(Y,X)=>{var Rt;const Ee=Y.target,$e=((Rt=Ee==null?void 0:Ee.dataset)==null?void 0:Rt.mail)||"",ze=Le($e),Be=Re(ze)||tt(X||$e||"anonymous")||U(60);Ee&&Be&&(Ee.src=Be)},re=he(()=>{const Y=!!Le(String(m.value||"")),X=!!String(s.value||"").trim()&&d.value;return Y||X}),Ae=he(()=>{const Y=String(m.value||"").trim(),X=Le(Y);if(X)return Re(X,100);const Ee=String(s.value||"").trim();return Ee?Te(Ee):""}),Ge=G(!1),Z=()=>{Ge.value=!0};Et([s,m],()=>{Ge.value=!1});const ke=()=>{d.value=!0};zt(()=>{l.value=s.value});const se=gn().public.baseApi||"/api",ee=G(!1),Ie=G(!1),ye=he(()=>{const Y=y.value;return Y&&(r.value||[]).find(X=>Number(X.id)===Number(Y))||null}),lt=he(()=>{const Y=ye.value,X=String(Y&&Y.content||"").trim();return X.length>120?X.slice(0,120)+"...":X}),Ve=()=>{Ie.value=!1,ee.value=!1},Qe=async()=>{try{const Y=async ze=>{const ut=await fetch(ze,{credentials:"include",headers:{Accept:"application/json"}});if(!ut||!ut.ok)return null;const Be=await ut.json();return!Be||Be.code!==1||!Array.isArray(Be.data)?[]:Be.data},X=typeof window<"u"?window.location.origin:"",Ee=[`${se}/messages/${e.messageId}/comments`,`${X}/api/messages/${e.messageId}/comments`,`http://localhost:1315/api/messages/${e.messageId}/comments`,`http://127.0.0.1:1315/api/messages/${e.messageId}/comments`];let $e=[];for(const ze of Ee){const ut=await Y(ze);if(ut&&ut.length>=0&&($e=ut,$e.length>0))break}r.value=($e||[]).sort((ze,ut)=>new Date(ut.created_at).getTime()-new Date(ze.created_at).getTime());try{window.dispatchEvent(new CustomEvent("comment-count-updated",{detail:{messageId:e.messageId,count:r.value.length}}))}catch{}}catch{r.value=[]}},De=async()=>{try{if(k.value)return;if(k.value=!0,f.value=!s.value.trim(),b.value=!m.value.trim(),f.value||b.value){Ke().add({title:"缺少必填字段",description:(s.value?"":"昵称 ")+(m.value?"":"邮箱"),color:"red"}),k.value=!1;return}const Y=g.value.trim(),X={nick:s.value.trim(),mail:m.value.trim(),link:u.value.trim(),content:Y};if(!X.content){Ke().add({title:"内容不能为空",color:"red"}),k.value=!1;return}if(X.mail&&!/^\S+@\S+\.\S+$/.test(X.mail)){Ke().add({title:"邮箱格式不正确",color:"red"}),k.value=!1;return}h.value&&(X.parent_id=h.value);const Ee=await Ni(`messages/${e.messageId}/comments`,X,{credentials:"include"});if(Ee&&Ee.code===1){g.value="",h.value=null,r.value=[...r.value,Ee.data],await Qe(),await bt();const $e=document.querySelector(`.content-container[data-msg-id="${e.messageId}"] .builtin-comments`),ze=$e==null?void 0:$e.querySelectorAll(".rounded-md"),ut=ze&&ze.length?ze[ze.length-1]:null;ut==null||ut.scrollIntoView({behavior:"smooth",block:"center"}),Ke().add({title:"已发布",color:"green"});try{window.dispatchEvent(new CustomEvent("comment-count-updated",{detail:{messageId:e.messageId,count:r.value.length}}))}catch{}}else Ke().add({title:"发布失败",description:Ee==null?void 0:Ee.msg,color:"red"})}catch{Ke().add({title:"发布失败",color:"red"})}finally{k.value=!1}},nt=Y=>{const X=new Date(Y),Ee=X.getMonth()+1,$e=X.getDate();return`${Ee}月${$e}日`},ct=Y=>{const X=String(Y||"").trim();return X&&/^https?:\/\//i.test(X)?X:""},dt=(Y,X)=>{for(const Ee of X){const $e=String((Y||{})[Ee]||"").trim();if($e)return $e}return""},ft=()=>{const Y=E.user||{},X=dt(Y,["nick","nickname","Nick","Nickname","username","Username","name","Name"]),Ee=dt(Y,["email","Email","mail","Mail"]),$e=dt(Y,["link","Link","website","Website","homepage","HomePage","url","Url"]);!s.value&&X&&(s.value=X),!m.value&&Ee&&(m.value=Ee),!u.value&&$e&&(u.value=$e)},It=G(!1),_n=he(()=>(e.showInput&&!It.value||!!h.value)&&T.value);Et(()=>e.showInput,Y=>{Y&&(It.value=!1)}),Et([_n,()=>E.isLogin],()=>{_n.value&&E.isLogin&&ft()},{immediate:!0}),zt(Qe);const an=()=>Qe();zt(()=>{window.addEventListener(`refresh-comments-${e.messageId}`,an)}),$i(()=>{window.removeEventListener(`refresh-comments-${e.messageId}`,an)}),Et(()=>e.messageId,Qe);const on=(Y,X)=>{h.value=Y,g.value.startsWith(`@${X} `)||(g.value=`@${X} `+g.value),ft()},it=Y=>{y.value=Y,confirm("确认删除该评论吗？此操作不可恢复。")?(Ie.value=!1,ee.value=!0):y.value=null},Xt=async()=>{if(y.value)try{if(!Ie.value){Ke().add({title:"请先勾选确认",color:"orange"});return}const Y=await cs(`messages/${e.messageId}/comments/${y.value}`,void 0,{credentials:"include"});Y&&Y.code===1?(r.value=r.value.filter(X=>X.id!==y.value),Ke().add({title:"已删除",color:"green"}),un()):Ke().add({title:"删除失败",description:Y==null?void 0:Y.msg,color:"red"})}catch{Ke().add({title:"删除失败",color:"red"})}finally{y.value=null,Ve()}},un=()=>{const Y=document.querySelector(`.content-container[data-msg-id="${e.messageId}"]`);Y==null||Y.scrollIntoView({behavior:"smooth",block:"start"})},sn=he(()=>{const Y=Array.isArray(r.value)?r.value:[],X=new Set;return Y.forEach(Ee=>{const $e=String((Ee==null?void 0:Ee.nick)||"").trim();$e&&X.add($e)}),Array.from(X)}),dn=G(!1),yn=G(""),cn=G(0),Ft=he(()=>{const Y=yn.value.toLowerCase();return sn.value.filter(Ee=>Ee.toLowerCase().startsWith(Y)).slice(0,20)}),Dt=()=>{dn.value=!1,cn.value=0,yn.value=""},ei=()=>{dn.value=!0,cn.value=0},Ht=()=>{const Y=S.value;return Y?{start:Y.selectionStart||0,end:Y.selectionEnd||0}:{start:0,end:0}},Nt=(Y,X,Ee,$e)=>{const ze=Y.slice(0,X),ut=Y.slice(Ee);return ze+$e+ut},Vt=()=>{const Y=S.value;if(!Y)return;const X=Y.selectionStart||0,Ee=g.value;let $e=X-1;for(;$e>=0&&Ee[$e]!==`
`&&Ee[$e]!==" ";)$e--;const ze=$e+1;if(Ee[ze]!=="@"){Dt();return}const ut=X,Be=Ee.slice(ze+1,ut);yn.value=Be,ei()},W=()=>{const Y=S.value;Y&&(Y.style.height="auto",Y.style.height=Math.max(80,Y.scrollHeight)+"px")},R=()=>{Vt(),W()},ne=Y=>{if(Y.key==="Enter"&&(Y.ctrlKey||Y.metaKey)){Y.preventDefault(),g.value.trim()&&De();return}if(Y.key==="@"){bt(Vt);return}if(dn.value)if(Y.key==="ArrowDown")Y.preventDefault(),cn.value=Math.min(cn.value+1,Ft.value.length-1);else if(Y.key==="ArrowUp")Y.preventDefault(),cn.value=Math.max(cn.value-1,0);else if(Y.key==="Enter"){Y.preventDefault();const X=Ft.value[cn.value];X&&jt(X)}else Y.key==="Escape"&&Dt()};zt(()=>{bt(W)});const ie=he(()=>(v.value,"bg-blue-500 text-white hover:bg-blue-600 disabled:opacity-60")),Oe=he(()=>v.value?"bg-gray-600 text-white hover:bg-gray-500":"bg-gray-200 text-black hover:bg-gray-300"),Fe=()=>{g.value="",Dt(),bt(W)},et=()=>{var X;g.value="",h.value=null,It.value=!0,Dt();const Y=S.value;(X=Y==null?void 0:Y.blur)==null||X.call(Y),bt(W),emit("cancel",{empty:(r.value||[]).length===0})},jt=Y=>{const X=S.value;if(!X)return;const Ee=X.selectionStart||0,$e=g.value;let ze=Ee-1;for(;ze>=0&&$e[ze]!==`
`&&$e[ze]!==" ";)ze--;const ut=ze+1,Be=Ee;g.value=Nt($e,ut,Be,`@${Y} `),Dt(),bt(()=>{const Rt=ut+Y.length+2;X.setSelectionRange(Rt,Rt),X.focus()})},ge=G(!1),pt=["😀","😄","😁","😆","😊","😍","🤔","👍","🔥","🎉","❤️","🥳","✨","🌟","🍀"],mt=()=>{ge.value=!ge.value},Mt=Y=>{const X=S.value;if(!X){g.value+=Y;return}const{start:Ee,end:$e}=Ht();g.value=Nt(g.value,Ee,$e,Y);const ze=Ee+Y.length;bt(()=>{X.setSelectionRange(ze,ze),X.focus()})},fn=Y=>{Mt(Y),ge.value=!1},yt=Y=>{S.value;const{start:X,end:Ee}=Ht(),$e=g.value.slice(X,Ee);if(Y==="bold")Mt($e?`**${$e}**`:"**加粗**");else if(Y==="italic")Mt($e?`*${$e}*`:"*斜体*");else if(Y==="link"){const ze=window.prompt("请输入链接地址","https://")||"";/^https?:\/\//i.test(ze)&&Mt($e?`[${$e}](${ze})`:`[链接文本](${ze})`)}else if(Y==="image"){const ze=window.prompt("请输入图片地址","https://")||"";/^https?:\/\//i.test(ze)&&Mt(`![图片](${ze})`)}},wt=he(()=>(Array.isArray(r.value)?r.value:[]).filter(Ee=>Ee&&(Ee.parent_id===null||Number(Ee.parent_id||0)===0))),wn=he(()=>{const Y={};return(Array.isArray(r.value)?r.value:[]).forEach(Ee=>{Y[Number(Ee.id)]=Ee}),Y}),Tn=he(()=>{const Y={},X={};return(Array.isArray(r.value)?r.value:[]).forEach($e=>{const ze=Number(($e==null?void 0:$e.parent_id)||0);if(ze>0){const ut=wn.value[ze];if(!ut)return;X[Number($e.id)]=String(ut.nick||"");let Be=ut;for(;Number((Be==null?void 0:Be.parent_id)||0)>0;){const tn=wn.value[Number(Be.parent_id)];if(!tn)break;Be=tn}const Rt=Number(Be.id);Y[Rt]||(Y[Rt]=[]),Y[Rt].push($e)}}),Object.keys(Y).forEach($e=>{Y[Number($e)]=(Y[Number($e)]||[]).sort((ze,ut)=>new Date(ut.created_at).getTime()-new Date(ze.created_at).getTime())}),{map:Y,targetMap:X}}),Kt=he(()=>Tn.value.map);he(()=>Tn.value.targetMap);const $t=he(()=>(Array.isArray(wt.value)?wt.value:[]).slice().sort((X,Ee)=>new Date(Ee.created_at).getTime()-new Date(X.created_at).getTime())),Bt=G(3),Rn=he(()=>$t.value.slice(0,Bt.value)),ti=he(()=>$t.value.length>Bt.value),Mn=()=>{Bt.value+=3};Et(()=>e.messageId,()=>{Bt.value=3});const en=G({}),In=Y=>{const X=en.value[Y]??3;return(Kt.value[Y]||[]).slice(0,X)},Xe=Y=>{const X=(Kt.value[Y]||[]).length,Ee=en.value[Y]??3;return X>Ee},at=Y=>{const X=en.value[Y]??3;en.value[Y]=X+3};Et(Kt,Y=>{const X={...en.value};Object.keys(Y||{}).forEach(Ee=>{const $e=Number(Ee);X[$e]||(X[$e]=3)}),en.value=X}),Et(()=>e.messageId,()=>{en.value={}});const Pt=Y=>(Kt.value[Y]||[]).length;return(Y,X)=>{var ut;const Ee=Mr,$e=da,ze=ha;return J(),ae("div",df,[I("div",{class:be(["waline-wrapper px-2 py-2 rounded-lg",[D.value]])},[I("div",{class:be(["text-sm mb-2",V.value])},"评论 ("+qe(r.value.length)+")",3),$t.value.length?(J(),ae("div",ff,[(J(!0),ae(Ut,null,Qt(Rn.value,(Be,Rt)=>{var tn;return J(),ae("div",{key:Be.id,class:be(["comment-item",$.value])},[I("img",{class:"comment-avatar avatar-img",src:Je(Be),alt:"avatar","data-mail":Be.mail||"",onError:St=>oe(St,Be.nick||"")},null,40,hf),I("div",pf,[I("div",{class:be(["comment-header",V.value])},[I("span",mf,[ct(Be.link)?(J(),ae("a",{key:0,href:ct(Be.link),target:"_blank",rel:"noopener noreferrer"},qe(Be.nick||"匿名"),9,gf)):(J(),ae(Ut,{key:1},[gt(qe(Be.nick||"匿名"),1)],64))])],2),I("div",{class:be(["comment-content",V.value])},[te(ki,{content:Be.content},null,8,["content"])],2),I("div",vf,[I("span",bf,qe(nt(Be.created_at)),1),I("span",yf,"回复 "+qe(Pt(Be.id)),1)]),I("div",wf,[I("button",{class:"action-btn",onClick:St=>on(Be.id,Be.nick||"匿名")},"回复",8,kf),w.value?(J(),ae("button",{key:0,class:"action-btn text-red-500",onClick:St=>it(Be.id)},"删除",8,Ef)):Me("",!0)]),(tn=Kt.value[Be.id])!=null&&tn.length?(J(),ae("div",Sf,[(J(!0),ae(Ut,null,Qt(In(Be.id),St=>(J(),ae("div",{key:St.id,class:be(["comment-item child",z.value])},[I("img",{class:"comment-avatar avatar-img",src:Je(St),alt:"avatar","data-mail":St.mail||"",onError:Hn=>oe(Hn,St.nick||"")},null,40,xf),I("div",Cf,[I("div",{class:be(["comment-header",V.value])},[I("span",_f,[ct(St.link)?(J(),ae("a",{key:0,href:ct(St.link),target:"_blank",rel:"noopener noreferrer"},qe(St.nick||"匿名"),9,Tf)):(J(),ae(Ut,{key:1},[gt(qe(St.nick||"匿名"),1)],64))])],2),I("div",{class:be(["comment-content",V.value])},[te(ki,{content:St.content},null,8,["content"])],2),I("div",Mf,[I("span",Af,qe(nt(St.created_at)),1)]),I("div",Lf,[I("button",{class:"action-btn",onClick:Hn=>on(St.id,St.nick||"匿名")},"回复",8,Df),w.value?(J(),ae("button",{key:0,class:"action-btn text-red-500",onClick:Hn=>it(St.id)},"删除",8,Of)):Me("",!0)])])],2))),128))])):Me("",!0),Xe(Be.id)?(J(),ae("div",Pf,[I("button",{class:be(["text-xs px-2 py-1 rounded border",N.value]),onClick:St=>at(Be.id)},"加载更多回复",10,Rf)])):Me("",!0)])],2)}),128))])):Me("",!0),ti.value?(J(),ae("div",If,[I("button",{class:be(["text-xs px-3 py-1 rounded border",N.value]),onClick:Mn},"加载更多评论",2)])):Me("",!0),$t.value.length?Me("",!0):(J(),ae("div",{key:2,class:be(["text-xs mb-4",H.value])},"暂无评论",2)),(e.showInput||h.value)&&C.value&&((ut=Y.siteConfig)!=null&&ut.commentEmailEnabled)&&T.value?(J(),ae("div",{key:3,class:be(["text-xs mb-2",H.value])},"新评论或回复会发送通知邮件",2)):Me("",!0),(e.showInput||h.value)&&C.value&&T.value?(J(),ae("div",Hf,[I("div",Nf,[Ii(I("input",{"onUpdate:modelValue":X[0]||(X[0]=Be=>s.value=Be),placeholder:"昵称",class:be(F.value),onInput:ke},null,34),[[zr,s.value]]),Ii(I("input",{"onUpdate:modelValue":X[1]||(X[1]=Be=>m.value=Be),placeholder:"邮箱",class:be(le.value)},null,2),[[zr,m.value]]),Ii(I("input",{"onUpdate:modelValue":X[2]||(X[2]=Be=>u.value=Be),placeholder:"网址（可选）",class:be(de.value)},null,2),[[zr,u.value]])]),I("div",jf,[I("button",{class:be(["text-xs px-2 py-1 rounded border",N.value]),onClick:X[3]||(X[3]=Be=>yt("bold"))},"加粗",2),I("button",{class:be(["text-xs px-2 py-1 rounded border",N.value]),onClick:X[4]||(X[4]=Be=>yt("italic"))},"斜体",2),I("button",{class:be(["text-xs px-2 py-1 rounded border",N.value]),onClick:X[5]||(X[5]=Be=>yt("link"))},"链接",2),I("button",{class:be(["text-xs px-2 py-1 rounded border",N.value]),onClick:X[6]||(X[6]=Be=>yt("image"))},"图片",2),I("div",$f,[I("button",{class:be(["text-xs px-2 py-1 rounded border",N.value]),onClick:mt},"表情",2),ge.value?(J(),ae("div",{key:0,class:be(["absolute z-10 mt-1 p-2 rounded border bg-white shadow",N.value])},[I("div",Bf,[(J(),ae(Ut,null,Qt(pt,Be=>I("button",{key:Be,class:"px-2 py-1 text-sm",onClick:Rt=>fn(Be)},qe(Be),9,Uf)),64))])],2)):Me("",!0)])]),I("div",zf,[re.value&&!Ge.value?(J(),ae("img",{key:0,class:"input-avatar avatar-img",src:Ae.value,"data-mail":m.value,alt:"avatar",onError:Z},null,40,Ff)):Me("",!0),I("div",Vf,[Ii(I("textarea",{ref_key:"taRef",ref:S,"onUpdate:modelValue":X[7]||(X[7]=Be=>g.value=Be),class:be(Pe.value),rows:"4",placeholder:"说说你的想法",onInput:R,onKeydown:ne,onBlur:Dt},null,34),[[zr,g.value]]),I("div",qf,[g.value.trim()?(J(),ae("button",{key:0,class:be(["cancel-btn",Oe.value]),onClick:Fe},"清除",2)):Me("",!0),I("button",{class:be(["cancel-btn",Oe.value]),onClick:et},"取消",2),I("button",{class:be(["submit-btn",ie.value]),disabled:k.value||!g.value.trim(),onClick:De},"提交",10,Wf)])])])])):e.showInput&&!C.value?(J(),ae("div",{key:5,class:be(["text-xs text-center mt-4 mb-2",H.value])},"评论功能未开启",2)):e.showInput&&C.value&&!T.value?(J(),ae("div",{key:6,class:be(["text-xs text-center mt-4 mb-2",H.value])},"请登录后评论",2)):Me("",!0)],2),te(ze,{modelValue:ee.value,"onUpdate:modelValue":X[9]||(X[9]=Be=>ee.value=Be),ui:{width:"sm:max-w-md"}},{default:Ce(()=>[te($e,null,{header:Ce(()=>[I("div",Yf,[X[10]||(X[10]=I("h3",{class:"text-lg font-medium"},"再次确认删除",-1)),te(Ee,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:Ve})])]),footer:Ce(()=>[I("div",Qf,[te(Ee,{color:"gray",variant:"outline",onClick:Ve},{default:Ce(()=>X[13]||(X[13]=[gt("取消")])),_:1}),te(Ee,{color:"red",disabled:!Ie.value,onClick:Xt},{default:Ce(()=>X[14]||(X[14]=[gt("确认删除")])),_:1},8,["disabled"])])]),default:Ce(()=>{var Be,Rt;return[I("div",Kf,[X[12]||(X[12]=I("div",{class:"text-sm"},"此操作不可恢复，确认删除该评论？",-1)),I("div",Gf,"评论ID："+qe(((Be=ye.value)==null?void 0:Be.id)||y.value),1),I("div",Xf,"昵称："+qe(((Rt=ye.value)==null?void 0:Rt.nick)||"匿名"),1),I("div",Zf,"内容片段："+qe(lt.value),1),I("label",Jf,[Ii(I("input",{type:"checkbox","onUpdate:modelValue":X[8]||(X[8]=tn=>Ie.value=tn)},null,512),[[Sc,Ie.value]]),X[11]||(X[11]=gt(" 我已知晓此操作不可恢复 "))])])]}),_:1})]),_:1},8,["modelValue"])])}}}),Ks=Cn(eh,[["__scopeId","data-v-2e994d72"]]),th={class:"min-h-screen flex flex-col"},nh={key:0,class:"text-center text-gray-500 py-8"},ih={key:0,class:"flex justify-between items-center mb-4 p-4 rounded-lg"},rh={class:"text-gray-400"},ah={class:"my-4"},oh={key:0,class:"text-center text-gray-500 py-8"},sh={class:"p-0"},lh=["data-msg-id"],ch={class:"flex items-center gap-2 mb-2 author-row"},uh=["src","onError"],dh={class:"min-w-0"},fh={class:"text-sm font-semibold leading-tight"},hh={class:"text-xs opacity-70"},ph={class:"ml-auto flex items-center gap-2 text-xs opacity-80"},mh=["href","data-fancybox"],gh=["src","fetchpriority"],vh={key:1,class:"border-t border-gray-600 my-4"},bh=["onClick"],yh={class:"message-socialbar"},wh=["onClick"],kh={class:"ml-1 text-xs opacity-80"},Eh=["onClick"],Sh={class:"ml-1 text-xs opacity-80"},xh={class:"toolbox-anchor"},Ch={class:"tool-icons"},_h={key:0,class:"tool-icon"},Th=["onClick","title"],Mh=["onClick"],Ah=["onClick"],Lh=["onClick"],Dh=["onClick"],Oh=["id"],Ph=["id"],Rh={key:1,class:"flex justify-center items-center space-x-4 w-full my-4 flex-wrap md:flex-nowrap"},Ih={class:"flex justify-center items-center space-x-4 w-full md:w-auto"},Hh={key:2,class:"ml-2 text-orange-400"},Nh={class:"flex items-center justify-center space-x-2 w-full md:w-auto mt-3 md:mt-0"},jh={class:"text-gray-500 text-shadow-sm text-sm"},$h={key:2,class:"text-center text-gray-500 mt-4"},Bh={class:"flex justify-between items-center"},Uh={class:"flex flex-col space-y-4"},zh={class:"border-t border-gray-200 my-2 pt-2"},Fh={class:"p-4 rounded-lg overflow-auto max-h-[300px] bg-[rgba(36,43,50,0.95)]"},Vh={class:"text-white"},qh={class:"flex justify-end space-x-2"},Wh=rn({__name:"MessageList",props:{siteConfig:{type:Object,required:!0},targetMessageId:{type:String,default:null},wide:{type:Boolean,default:!1}},setup(p,{expose:e}){const r=Bi("contentTheme",G(typeof window<"u"&&localStorage.getItem("contentTheme")||"dark")),s=he(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white":"bg-white text-black"),l=he(()=>r.value==="dark"?"text-white":"text-black"),d=he(()=>r.value==="dark"?"from-[rgba(36,43,50,1)] via-[rgba(36,43,50,0.8)] to-transparent":"from-[rgba(255,255,255,1)] via-[rgba(255,255,255,0.8)] to-transparent"),m=W=>{var Fe,et,jt,ge;const R=String(((Fe=Gn().user)==null?void 0:Fe.username)||"").trim(),ne=String(((et=Gn().user)==null?void 0:et.avatar_url)||((jt=Gn().user)==null?void 0:jt.AvatarURL)||"").trim(),ie=String(((ge=v.siteConfig)==null?void 0:ge.avatarURL)||"").trim(),Oe=pt=>pt?/^https?:\/\//i.test(pt)?pt:`${H}${pt}`:"";return R&&String((W==null?void 0:W.username)||"").trim()===R&&ne?Oe(ne):Oe(ie)||`https://api.dicebear.com/7.x/initials/svg?seed=${encodeURIComponent(String((W==null?void 0:W.username)||"匿名"))}&backgroundType=gradient&radius=50&scale=100&size=64`},u=(W,R)=>{const ne=W.target,ie=`https://i.pravatar.cc/64?u=${encodeURIComponent(R)}`;ne&&(ne.src=ie)},g=he(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white hover:text-white border-none shadow-sm rounded-full":"bg-white text-black hover:text-black border border-gray-300 shadow-sm rounded-full"),S=he(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.75)] text-white hover:text-white hover:bg-[rgba(36,43,50,0.85)] active:bg-[rgba(36,43,50,0.9)] focus:bg-[rgba(36,43,50,0.85)] border border-white/70":"bg-[rgba(24,28,32,0.6)] text-white hover:text-white hover:bg-[rgba(24,28,32,0.7)] active:bg-[rgba(24,28,32,0.75)] focus:bg-[rgba(24,28,32,0.7)] border border-white/70"),k=G(null),h=W=>{k.value=k.value===W?null:W},f=W=>{const R=W.target;if(!R){k.value=null;return}const ne=!!R.closest(".message-toolbox"),ie=!!R.closest(".tool-open-btn");!ne&&!ie&&(k.value=null)};zt(()=>{window.addEventListener("scroll",()=>{k.value=null}),document.addEventListener("click",f,!0)}),$i(()=>{document.removeEventListener("click",f,!0)});const b=he(()=>r.value==="dark"?"toolbox-dark":"toolbox-light"),y=G({}),E=G({}),w=G({}),C=async W=>{var R,ne;try{const ie=await fetch(`${H}/messages/${W}/like/toggle`,{method:"POST",credentials:"include",headers:{Accept:"application/json"}});if(!ie.ok)throw new Error("点赞失败");const Oe=await ie.json(),Fe=((R=Oe==null?void 0:Oe.data)==null?void 0:R.like_count)??(y.value[W]||0),et=!!((ne=Oe==null?void 0:Oe.data)!=null&&ne.liked);y.value[W]=Fe,E.value[W]=et}catch{Ke().add({title:"点赞失败",color:"red",timeout:2e3})}},_=G(""),T=he(()=>Math.ceil(F.total/15)),M=async()=>{const W=parseInt(_.value);if(!W||W<1||W>T.value||F.loading){Ke().add({title:"页码无效",description:`请输入 1-${T.value} 之间的数字`,color:"orange",timeout:2e3});return}try{const R=document.querySelector(".content-wrapper"),ne=R?R.scrollTop:window.scrollY,ie=await F.getMessages({page:W,pageSize:15});if(!ie)throw new Error("跳转页面失败");const Oe=ie.items.filter(Fe=>!Fe.pinned);F.messages=[...Ie.value,...Oe],F.page=ie.page||W,_.value="",await bt(),R?R.scrollTo({top:ne,behavior:"instant"}):window.scrollTo({top:ne,behavior:"instant"})}catch(R){console.error("跳转页面失败:",R),Ke().add({title:"跳转失败",color:"red",timeout:2e3})}},v=p,D=he(()=>v.wide?"flex-grow w-full px-1 sm:px-2":"flex-grow mx-auto w-full sm:max-w-4xl px-1 sm:px-2"),N=he(()=>v.wide?"":"mx-auto sm:max-w-4xl"),V=he(()=>!1);Et(()=>v.targetMessageId,async W=>{if(!W)return;await bt();const R=document.querySelector(`.content-container[data-msg-id="${W}"]`);R&&(R.scrollIntoView({behavior:"smooth",block:"center"}),R.classList.add("highlight-message"),setTimeout(()=>{R.classList.remove("highlight-message")},2e3))},{immediate:!0});const H=gn().public.baseApi||"/api",$=G(!0),z=async()=>{try{const W=await fetch(`${H}/status`,{credentials:"include"});$.value=!!W&&W.ok}catch{$.value=!1}};Ms();const F=Ts(),le=G(null),de=G({}),Pe=G({}),Ue=he(()=>{var R;const W=(R=v.siteConfig)==null?void 0:R.commentEnabled;return W===!0||W==="true"}),Te=he(()=>!0),Le=G(null),Re=W=>{if(!W)return!1;if(Le.value&&W.id===Le.value)return!0;const R=String(W.content||"").toLowerCase();return/#guestbook|#留言|留言板/.test(R)},Je=async()=>{var W;try{const R=await fetch(`${H}/guestbook/message`,{credentials:"include",headers:{Accept:"application/json"}});if(R.ok){const ne=await R.json(),ie=(W=ne==null?void 0:ne.data)==null?void 0:W.id;ie&&(Le.value=Number(ie))}}catch{}},tt=W=>(F.messages||[]).find(R=>R.id===W),U=Gn(),oe=he(()=>U.isLogin),re=async W=>{try{const R=encodeURIComponent(W.trim()),ne=await fetch(`${H}/messages/tags/${R}`,{credentials:"include",headers:{Accept:"application/json"}});if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);const ie=await ne.json();if(ie.code===1&&Array.isArray(ie.data))Ft.value=!0,Dt.value=ie.data,await bt(),ct(),Z();else throw new Error(ie.msg||"获取标签内容失败")}catch(R){console.error("获取标签消息失败:",R),Ke().add({title:"获取标签消息失败",description:R.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},Ae=async()=>{Dt.value=[],Ft.value=!1,await F.getMessages({page:1,pageSize:15}),await bt(),ct(),Z()},Ge=async W=>{if(confirm("确定要删除这条消息吗？"))try{await F.deleteMessage(W),F.messages=F.messages.filter(ne=>ne.id!==W),Ke().add({title:"删除成功",color:"green",timeout:2e3})}catch(ne){console.error("删除失败:",ne),Ke().add({title:"删除失败",color:"red",timeout:2e3})}},Z=()=>{if(window.Fancybox){window.Fancybox.destroy();const W={Carousel:{infinite:!1},Toolbar:{display:[{id:"prev",position:"center"},{id:"counter",position:"center"},{id:"next",position:"center"},"zoom","slideshow","fullscreen","close"]},Image:{zoom:!0,click:!0,wheel:"slide"}};document.querySelectorAll(".markdown-preview img").forEach(ne=>{const ie=ne.getAttribute("src")||"",Oe=/^https?:\/\//i.test(ie),Fe=ne.parentElement;if(Fe&&Fe.tagName==="A"&&Fe.hasAttribute("data-fancybox")){Oe||Fe.replaceWith(ne);return}if(Oe){const et=document.createElement("a");et.href=ie,et.setAttribute("data-fancybox","uploaded-image"),et.style.display="block",ne.parentNode.insertBefore(et,ne),et.appendChild(ne)}else Fe&&Fe.tagName==="A"&&Fe.hasAttribute("data-fancybox")&&Fe.replaceWith(ne)}),window.Fancybox.bind("[data-fancybox]",W)}},ke=async W=>{var ie,Oe;const R=tt(W);if(Re(R))return;if(!!(Pe.value[W]||le.value===W)){Pe.value[W]=!1,le.value===W&&(le.value=null);return}if(le.value=W,await bt(),de.value[W]=(de.value[W]||0)+1,Pe.value[W]=!0,(((ie=v.siteConfig)==null?void 0:ie.commentSystem)||"waline")==="builtin"){window.dispatchEvent(new Event(`refresh-comments-${W}`));const Fe=document.querySelector(`.content-container[data-msg-id="${W}"] .builtin-comments`);if(Fe){Fe.scrollIntoView({behavior:"smooth",block:"center"});const et=Fe.querySelector("textarea");(Oe=et==null?void 0:et.focus)==null||Oe.call(et)}return}if(V.value){if(await ft(),!window.Waline)return;document.querySelector(`#waline-${W}`)?window.Waline.init({el:`#waline-${W}`,serverURL:v.siteConfig.walineServerURL,path:`messages/${W}`,reaction:!1,meta:["nick","mail","link"],requiredMeta:["mail","nick"],pageview:!0,search:!1,wordLimit:200,pageSize:5,avatar:"monsterid",emoji:["https://unpkg.com/@waline/emojis@1.2.0/tieba"],imageUploader:!1,copyright:!1,dark:'html[class="dark"]'}):console.error(`评论容器 #waline-${W} 未找到`)}},se=(W,R)=>{if(R&&R.empty===!0){ke(W);return}le.value===W&&(le.value=null),de.value[W]=(de.value[W]||0)+1},ee=W=>{if(!oe.value)return!1;const R=U.user;if(!R)return!1;const ne=!!(R.IsAdmin||R.is_admin),ie=(R.ID||R.userid)===W.user_id;return ne||ie},Ie=G([]),ye=async W=>{try{const R=!W.pinned;await F.setPinned(W.id,R)&&(R?Ie.value.some(ie=>ie.id===W.id)||(Ie.value=[W,...Ie.value]):Ie.value=Ie.value.filter(ie=>ie.id!==W.id),Ke().add({title:R?"已置顶":"已取消置顶",color:"green",timeout:1500}))}catch{Ke().add({title:"操作失败",color:"red",timeout:2e3})}},lt=W=>{const R=new Date(W),ie=new Date().getTime()-R.getTime(),Oe=Math.floor(ie/(1e3*60*60*24)),Fe=Math.floor(ie/(1e3*60*60)),et=Math.floor(ie/(1e3*60));return Math.floor(ie/1e3)<60?"刚刚":et<60?`${et}分钟前`:Fe<24?`${Fe}小时前`:Oe<3?`${Oe}天前`:R.toLocaleString()},Ve=G({}),Qe=G({}),De=G({}),nt=W=>{Ve.value[W]=!Ve.value[W]},ct=()=>{bt(()=>{(Ft.value?Dt.value:F.messages).forEach(R=>{const ne=document.querySelector(`.content-container[data-msg-id="${R.id}"] .overflow-y-hidden`);if(!ne)return;const ie=!!document.querySelector(`.content-container[data-msg-id="${R.id}"] .image-grid`);if(De.value[R.id]=ie,ie){Qe.value[R.id]=!1,Ve.value[R.id]=!0;return}ne.scrollHeight>700?(Qe.value[R.id]=!0,Ve.value[R.id]===void 0&&(Ve.value[R.id]=!1)):Qe.value[R.id]=!1})})};Et(()=>F.messages,()=>{dt.hash.includes("/messages/")||bt(()=>{requestAnimationFrame(()=>{ct(),Z()})})},{deep:!0});const dt=ds(),ft=async()=>{if(V.value&&!window.Waline){const W=document.createElement("link");W.rel="stylesheet",W.href="https://unpkg.com/@waline/client@v2/dist/waline.css",document.head.appendChild(W),await new Promise((R,ne)=>{const ie=document.createElement("script");ie.src="https://unpkg.com/@waline/client@v2/dist/waline.js",ie.crossOrigin="anonymous",ie.onload=R,ie.onerror=ne,document.head.appendChild(ie)})}};zt(async()=>{try{await z(),await Je();const W=dt.hash.split("/messages/").pop();if(await ft(),W){const R=await fetch(`${H}/messages/${W}`,{credentials:"include",headers:{Accept:"application/json"}});if(!R.ok)throw new Error("消息加载失败");const ne=await R.json();if(ne.code===1&&ne.data){const ie=ne.data;Re(ie)?F.messages=[]:F.messages=[ie],F.hasMore=!1,F.page=1,await bt();const Oe=document.querySelector(`.content-container[data-msg-id="${W}"]`);Oe&&Oe.scrollIntoView({behavior:"instant",block:"start"})}else throw new Error("消息不存在")}else if(!dt.hash.includes("/messages/")){const R=await fetch(`${H}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:1,pageSize:15})});if(R.ok){const ne=await R.json();if(ne.code===1&&ne.data){const ie=(ne.data.items||[]).filter(jt=>!Re(jt));F.messages=ie;const Fe=(ne.data.total||0)-(Le.value?1:0);F.total=Math.max(0,Fe);const et=Math.max(1,Math.ceil((F.total||0)/15));F.page=1,F.hasMore=F.page<et}}}await bt(),ct(),Z();try{const R=(F.messages||[]).filter(ne=>!Re(ne)).map(async ne=>{try{let ie=null;const Oe=await fetch(`${H}/messages/${ne.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(Oe&&Oe.ok)ie=await Oe.json();else{const et=await fetch(`http://localhost:1315/api/messages/${ne.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});et&&et.ok&&(ie=await et.json())}const Fe=ie&&Array.isArray(ie.data)?ie.data.length:0;w.value[ne.id]=Fe,Te.value&&Fe>0&&(Pe.value[ne.id]=!0)}catch{}});await Promise.allSettled(R),await bt()}catch{}}catch(W){console.error("初始化失败:",W),W instanceof Error&&Ke().add({title:"加载失败",description:W.message||"请刷新重试",color:"red",timeout:2e3})}}),Et(()=>dt.hash,async W=>{const R=W.split("/messages/").pop();if(!R){if(!dt.hash.includes("/messages/")){const ne=await fetch(`${H}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:1,pageSize:15})});if(ne.ok){const ie=await ne.json();if(ie.code===1&&ie.data){const Oe=(ie.data.items||[]).filter(ge=>!Re(ge));F.messages=Oe;const et=(ie.data.total||0)-(Le.value?1:0);F.total=Math.max(0,et);const jt=Math.max(1,Math.ceil((F.total||0)/15));F.page=1,F.hasMore=F.page<jt,Pe.value={};try{const ge=(F.messages||[]).filter(pt=>!Re(pt)).map(async pt=>{try{const mt=await fetch(`${H}/messages/${pt.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(mt.ok){const Mt=await mt.json(),fn=Array.isArray(Mt.data)?Mt.data.length:0;w.value[pt.id]=fn,Te.value&&fn>0&&(Pe.value[pt.id]=!0)}}catch{}});await Promise.allSettled(ge)}catch{}}}}return}try{const ne=await fetch(`${H}/messages/${R}`,{credentials:"include",headers:{Accept:"application/json"}});if(!ne.ok)throw new Error("消息加载失败");const ie=await ne.json();if(ie.code===1&&ie.data){F.messages=Re(ie.data)?[]:[ie.data],F.hasMore=!1,F.page=1,await bt();const Oe=document.querySelector(`.content-container[data-msg-id="${R}"]`);Oe&&Oe.scrollIntoView({behavior:"instant",block:"start"})}}catch(ne){console.error("加载消息失败:",ne),Ke().add({title:"加载失败",color:"red",timeout:2e3})}},{immediate:!0});const It=G(!1),_n=async()=>{if(!(It.value||F.page<=1)){It.value=!0;try{const W=document.querySelector(".content-wrapper"),R=W?W.scrollTop:window.scrollY,ne=F.page-1,ie=await F.getMessages({page:ne,pageSize:15});if(ie&&Array.isArray(ie.items)){const Oe=ie.items.filter(ge=>!ge.pinned&&!Re(ge));F.messages=[...Ie.value,...Oe];const et=(ie.total||F.total||0)-(Le.value?1:0);F.total=Math.max(0,et),F.page=ie.page||ne;const jt=Math.max(1,Math.ceil((F.total||0)/15));F.hasMore=F.page<jt}else F.page=ne;await bt(),W?W.scrollTo({top:R,behavior:"instant"}):window.scrollTo({top:R,behavior:"instant"})}catch{Ke().add({title:"加载失败",color:"red",timeout:2e3})}finally{It.value=!1}}},an=async()=>{if(!(It.value||!F.hasMore)){It.value=!0;try{const W=document.querySelector(".content-wrapper"),R=W?W.scrollTop:window.scrollY,ne=F.page+1,ie=await F.getMessages({page:ne,pageSize:15});if(ie&&Array.isArray(ie.items)){const Oe=ie.items.filter(ge=>!ge.pinned&&!Re(ge));F.messages=[...Ie.value,...Oe];const et=(ie.total||F.total||0)-(Le.value?1:0);F.total=Math.max(0,et),F.page=ie.page||ne;const jt=Math.max(1,Math.ceil((F.total||0)/15));F.hasMore=F.page<jt}else F.page=ne;await bt(),W?W.scrollTo({top:R,behavior:"instant"}):window.scrollTo({top:R,behavior:"instant"})}catch{Ke().add({title:"加载失败",color:"red",timeout:2e3})}finally{It.value=!1}}};Et(()=>U.isLogin,W=>{W&&F.getMessages({page:1,pageSize:15})}),Et(()=>F.messages,async()=>{try{if(F.page===1){const R=(F.messages||[]).filter(ne=>ne.pinned&&!Re(ne)).filter((ne,ie,Oe)=>Oe.findIndex(Fe=>Fe.id===ne.id)===ie);Ie.value=R}try{const R=(F.messages||[]).filter(ne=>!Re(ne)).map(async ne=>{try{const ie=await fetch(`${H}/messages/${ne.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(ie.ok){const Oe=await ie.json(),Fe=Array.isArray(Oe.data)?Oe.data.length:0;w.value[ne.id]=Fe}}catch{}});await Promise.allSettled(R)}catch{}await bt(),ct(),Z()}catch(W){console.error("更新视图失败:",W)}},{deep:!0}),$i(()=>{window.Fancybox&&window.Fancybox.destroy()});const on=async W=>{try{await navigator.clipboard.writeText(W),Ke().add({title:"复制成功",color:"green",timeout:2e3})}catch(R){console.error("复制失败:",R),Ke().add({title:"复制失败",color:"red",timeout:2e3})}},it=G(!1),Xt=G(""),un=G(null),sn=G(!1),dn=W=>{if(un.value=W.id,Xt.value=W.content,W.image_url){const R=`

<!-- 附件图片(编辑时可删除) -->
![附件图片](${H}${W.image_url})
<!-- 附件图片结束 -->`;Xt.value+=R}it.value=!0},yn=async()=>{if(un.value){sn.value=!0;try{const W=F.messages.find(Oe=>Oe.id===un.value);if(!W)return;let R=Xt.value;if(R=R.replace(/\n*<!-- 附件图片\(编辑时可删除\) -->\n!\[附件图片\]\(.*?\)\n<!-- 附件图片结束 -->\n*/g,""),R===W.content){Ke().add({title:"内容未修改",description:"请修改内容后再保存",color:"orange",timeout:2e3}),sn.value=!1;return}const ne=await fetch(`${H}/messages/${un.value}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({content:R,image_url:W.image_url})});if(!ne.ok)throw new Error(`HTTP error! status: ${ne.status}`);const ie=await ne.json();if(ie.code===1){const Oe=F.messages.findIndex(Fe=>Fe.id===un.value);Oe!==-1&&(F.messages[Oe]={...F.messages[Oe],content:Xt.value,image_url:W.image_url}),it.value=!1,Ke().add({title:"更新成功",color:"green",timeout:2e3})}else throw new Error(ie.msg||"保存失败")}catch(W){console.error("更新消息失败:",W),Ke().add({title:"更新失败",color:"red",timeout:2e3})}finally{sn.value=!1}}},cn=async W=>{var R,ne;try{const ie=document.querySelector(`.content-container[data-msg-id="${W}"]`);if(!ie)return;const Oe=(ne=(R=ie.querySelector(".markdown-preview"))==null?void 0:R.textContent)==null?void 0:ne.trim(),Fe=ie.querySelector("img"),et=ie.querySelector("video"),jt=ie.querySelector("audio");if(!Oe&&!Fe&&et||!Oe&&!Fe&&jt){Ke().add({title:"此内容不可生成卡片",color:"orange",timeout:2e3});return}const ge=setTimeout(()=>{Ke().add({title:"生成超时",description:"卡片生成时间过长，请稍后重试",color:"red",timeout:3e3})},1e4),pt=Ve.value[W];Ve.value[W]=!0,await bt();const mt=document.createElement("div");mt.style.cssText=`
  padding: 16px;
  background: transparent;
  border-radius: 12px;
  width: ${Fe?"640px":"480px"};
  position: absolute;
  left: -9999px;
  top: 0;
  z-index: -1;
  overflow: visible;
  min-height: fit-content;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
  border: none;
`,document.body.appendChild(mt);const Mt=ie.cloneNode(!0),fn=window.getComputedStyle(ie),yt=fn.backgroundColor&&fn.backgroundColor!=="rgba(0, 0, 0, 0)"?fn.backgroundColor:"#ffffff",wt=fn.color||"#333";Mt.querySelectorAll('.text-center.mt-2, .bg-gradient-to-t, .expand-toggle-btn, .message-socialbar, .message-toolbox, .toolbox-anchor, .tool-open-btn, .builtin-comments, [id^="comment-container-"], [id^="waline-"]').forEach(Xe=>Xe.remove()),Mt.querySelectorAll(".i-mdi-pin, .i-mdi-pin-outline").forEach(Xe=>{const at=Xe.parentElement;at&&at.classList.contains("opacity-80")?at.remove():Xe.remove()}),Mt.querySelectorAll(".author-row .ml-auto").forEach(Xe=>Xe.remove()),Mt.style.cssText=`
      max-height: none;
      overflow: visible;
      padding: 0;
      margin: 0;
      background: ${yt};
      border-radius: 12px;
    `;const wn=Mt.querySelector(".overflow-y-hidden");wn&&(wn.className="",wn.style.cssText=`
        overflow: visible;
        max-height: none !important;
        height: auto !important;
        padding: 4px 12px;
        line-height: 1.6;
        margin-top: 0;
        margin-bottom: 0;
        white-space: pre-wrap;
        background: ${yt};
        border-radius: 12px;
        font-size: 14px;
        color: ${wt};
      `);const Kt=Array.from(Mt.children).find(Xe=>Xe.tagName==="IMG");Kt&&(Kt.style.margin="1px 0",Kt.style.display="block"),Mt.querySelectorAll("img").forEach(Xe=>{Xe.style.margin="1px 0",Xe.style.display="block"});const $t=Mt.querySelector(".border-t");$t&&($t.style.margin="1px 0");const Bt=Mt.querySelector(".markdown-preview");if(Bt){Bt.style.marginTop="1px";const Xe=Bt.firstElementChild;Xe&&(Xe.style.marginTop="1px"),Bt.querySelectorAll("p, h1, h2, h3, h4, h5, h6").forEach(at=>{at.style.marginTop=at.style.marginTop||"2px"})}Mt.querySelectorAll("video, audio, iframe").forEach(Xe=>{var Pt;const at=document.createElement("div");at.style.cssText=`
        padding: 15px;
        background: rgba(251, 146, 60, 0.1);
        border: 1px solid rgba(251, 146, 60, 0.3);
        border-radius: 8px;
        color: #fb923c;
        margin: 15px 0;
        word-break: break-all;
      `,Xe instanceof HTMLVideoElement?at.innerHTML=`🎬 视频链接：${Xe.src||"未知链接"}`:Xe instanceof HTMLAudioElement?at.innerHTML=`🎵 音频链接：${Xe.src||"未知链接"}`:Xe instanceof HTMLIFrameElement&&(at.innerHTML=`🔗 嵌入内容链接：${Xe.src||"未知链接"}`),(Pt=Xe.parentNode)==null||Pt.replaceChild(at,Xe)}),await(async()=>{const Xe=Mt.querySelectorAll("img");await Promise.all(Array.from(Xe).map(async at=>new Promise(Pt=>{const Y=at.src;at.crossOrigin="anonymous",Y.startsWith("/")?(at.src=`${H}${Y}`,fetch(at.src,{credentials:"include"}).then(X=>X.blob()).then(X=>{at.src=URL.createObjectURL(X),Pt()}).catch(()=>{var X;console.error("图片加载失败:",Y),(X=at.parentElement)==null||X.removeChild(at),Pt()})):at.complete?Pt():(at.onload=()=>Pt(),at.onerror=()=>{var X;console.error("图片加载失败:",Y),(X=at.parentElement)==null||X.removeChild(at),Pt()})})))})(),mt.appendChild(Mt);const Mn=document.createElement("div");Mn.style.cssText=`
    margin-top: 12px;
    padding-top: 12px;
    text-align: center;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: transparent;
  `,Mn.innerHTML=`
    <div style="color: #fb923c; font-size: 13px; margin-bottom: 4px; font-weight: 500;">
      ${v.siteConfig.cardFooterTitle}
    </div>
    <a href="https://note.noisework.cn" 
       target="_blank" 
       rel="noopener noreferrer" 
       style="color: rgba(255,255,255,0.5); text-decoration: none;">
      ${v.siteConfig.cardFooterSubtitle}
    </a>
  `,mt.appendChild(Mn),await bt();const en=await html2canvas(mt,{backgroundColor:yt,scale:2,useCORS:!0,allowTaint:!0,logging:!1,width:mt.offsetWidth,height:mt.scrollHeight,borderRadius:"16px",onclone:Xe=>{const at=Xe.querySelector(".content-container");at&&(at.style.cssText=`
            overflow: visible !important;
            max-height: none !important;
            height: auto !important;
            padding: 0;
            min-height: ${(wn==null?void 0:wn.scrollHeight)||0}px;
            background: ${yt};
            border-radius: 12px;
          `)}});clearTimeout(ge);const In=document.createElement("a");In.download=`message-${W}.png`,In.href=en.toDataURL("image/png"),In.click(),document.body.removeChild(mt),Ve.value[W]=pt,Ke().add({title:"下载成功",color:"green",timeout:2e3})}catch(ie){console.error("下载失败:",ie),Ke().add({title:"下载失败",color:"red",timeout:2e3})}},Ft=G(!1),Dt=G([]),ei=async W=>{var R;try{const ne=Ft.value?null:window.scrollY;if(console.debug("API返回的原始数据:",W),!W)throw new Error("API返回数据为空");let ie=[],Oe=0;if(W.code===1?Array.isArray(W.data)?ie=W.data:(R=W.data)!=null&&R.items&&(ie=W.data.items):Array.isArray(W)&&(ie=W),!Array.isArray(ie))throw new Error("无效的数据格式");ie=ie.filter(Fe=>!Re(Fe)),Oe=ie.length,Ft.value=!0,Dt.value=ie,Oe===0?Ke().add({title:"未找到相关内容",color:"orange",timeout:2e3}):Ke().add({title:`找到 ${Oe} 条结果`,color:"green",timeout:2e3}),ne!==null&&window.scrollTo({top:0,behavior:"smooth"}),await bt(),ct(),Z()}catch(ne){console.error("处理搜索结果时出错:",ne),Ke().add({title:"搜索失败",description:ne.message||"处理搜索结果时发生错误",color:"red",timeout:2e3}),Ht()}},Ht=()=>{Dt.value=[],Ft.value=!1,console.log("重置搜索 - searchResults:",Dt.value),console.log("重置搜索 - isSearchMode:",Ft.value),bt(()=>{ct(),Z()})},Nt=he(()=>{if(Ft.value&&Array.isArray(Dt.value))return(Dt.value||[]).filter(ne=>!Re(ne));const W=(F.messages||[]).filter(ne=>!Re(ne));if(!Ie.value.length)return W;const R=W.filter(ne=>!Ie.value.some(ie=>ie.id===ne.id));return[...Ie.value,...R]});e({handleSearchResult:ei}),Et(Dt,W=>{console.log("searchResults变化:",W),bt(()=>{ct(),Z()})},{deep:!0,immediate:!0}),Et(Ft,W=>{console.log("isSearchMode变化:",W),bt(()=>{ct(),Z()})});const Vt=W=>{try{const R=(W==null?void 0:W.detail)||{},ne=Number((R==null?void 0:R.messageId)||0),ie=Number((R==null?void 0:R.count)||0);ne&&(w.value[ne]=ie)}catch{}};return zt(()=>{try{window.addEventListener("comment-count-updated",Vt)}catch{}}),$i(()=>{try{window.removeEventListener("comment-count-updated",Vt)}catch{}}),he(()=>({cardFooterTitle:v.siteConfig.cardFooterTitle,cardFooterSubtitle:v.siteConfig.cardFooterSubtitle,pageFooterHTML:v.siteConfig.pageFooterHTML,walineServerURL:v.siteConfig.walineServerURL})),(W,R)=>{const ne=fi,ie=Mr,Oe=fa,Fe=hs,et=da,jt=ha;return J(),ae(Ut,null,[I("div",th,[ve(Nt).length?Me("",!0):(J(),ae("div",nh,[te(ne,{name:"i-heroicons-inbox",class:"w-12 h-12 mx-auto mb-4"}),R[5]||(R[5]=I("p",null,"暂无消息内容",-1))])),I("div",{class:be(ve(D))},[ve(Ft)?(J(),ae("div",ih,[I("p",rh,"搜索结果 ("+qe(ve(Dt).length)+" 条)",1),te(ie,{size:"sm",variant:"ghost",class:"text-gray-400 hover:text-orange-500",icon:"i-heroicons-arrow-left",onClick:Ae},{default:Ce(()=>R[6]||(R[6]=[gt(" 返回完整列表 ")])),_:1})])):Me("",!0),I("div",ah,[ve(Ft)&&ve(Dt).length===0?(J(),ae("div",oh,[te(ne,{name:"i-heroicons-magnifying-glass",class:"w-12 h-12 mx-auto mb-4"}),R[7]||(R[7]=I("p",null,"未找到相关内容",-1))])):Me("",!0),(J(!0),ae(Ut,null,Qt(ve(Nt),ge=>{var pt;return J(),ae("div",{key:ge.id,class:"w-full h-auto overflow-hidden flex flex-col justify-between"},[I("div",sh,[ge.image_url||ge.content?(J(),ae("div",{key:0,class:be(["content-container",ve(N),ve(s)]),"data-msg-id":ge.id},[I("div",ch,[I("img",{src:m(ge),alt:"avatar",class:"avatar-img w-8 h-8 rounded-full object-cover",onError:mt=>u(mt,ge.username||"匿名")},null,40,uh),I("div",dh,[I("div",fh,qe(ge.username||p.siteConfig.username||"匿名"),1),I("div",hh,qe(lt(ge.created_at)),1)]),I("div",ph,[ge.private?(J(),Lt(ne,{key:0,name:"i-mdi-lock-outline",class:"w-4 h-4"})):Me("",!0),ge.pinned?(J(),Lt(ne,{key:1,name:"i-mdi-pin",class:"w-4 h-4"})):Me("",!0)])]),ge.image_url?(J(),ae("a",{key:0,href:`${ve(H)}${ge.image_url}`,"data-fancybox":`message-image-${ge.id}`,class:"block"},[I("img",{src:`${ve(H)}${ge.image_url}`,alt:"Image",class:"message-image-box",loading:"lazy",fetchpriority:W.index<3?"high":"low"},null,8,gh)],8,mh)):Me("",!0),ge.image_url&&ge.content?(J(),ae("div",vh)):Me("",!0),I("div",{class:be(["overflow-y-hidden relative",[{"max-h-[700px]":!ve(Ve)[ge.id]&&!ve(De)[ge.id]},ve(l)]])},[te(ki,{content:ge.content,enableGithubCard:((pt=p.siteConfig)==null?void 0:pt.enableGithubCard)===!0,onTagClick:re,onRendered:ct,"link-target":"_blank"},null,8,["content","enableGithubCard"]),ve(Qe)[ge.id]&&!ve(Ve)[ge.id]?(J(),ae("div",{key:0,class:be(["absolute bottom-0 left-0 right-0 h-24 bg-gradient-to-t backdrop-blur-md pointer-events-none content-fade-mask",ve(d)]),style:{"z-index":"20"}},null,2)):Me("",!0)],2),ve(Qe)[ge.id]?(J(),ae("button",{key:2,class:be(["expand-toggle-btn absolute bottom-0 left-1/2 -translate-x-1/2 px-4 py-1.5 text-sm inline-flex items-center gap-1 z-30",ve(g)]),onClick:mt=>nt(ge.id),"aria-label":"toggle-expand"},[gt(qe(ve(Ve)[ge.id]?"收起全文":"展开全文")+" ",1),te(ne,{name:ve(Ve)[ge.id]?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"w-4 h-4"},null,8,["name"])],10,bh)):Me("",!0),R[9]||(R[9]=I("div",{class:"border-t border-gray-300 dark:border-gray-700 my-3"},null,-1)),I("div",yh,[I("button",{class:"social-item",onClick:mt=>C(ge.id),title:"点赞"},[te(ne,{name:ve(E)[ge.id]?"i-mdi-heart":"i-mdi-heart-outline",style:{"font-size":"20px","line-height":"1"},class:be([ve(E)[ge.id]?"text-red-500":""])},null,8,["name","class"]),I("span",kh,qe(ve(y)[ge.id]??(ge.like_count||0)),1)],8,wh),Re(ge)?Me("",!0):(J(),ae("button",{key:0,class:"social-item",onClick:mt=>ke(ge.id),title:"评论"},[te(ne,{name:"i-mdi-comment-outline",style:{"font-size":"20px","line-height":"1"}}),I("span",Sh,qe(ve(w)[ge.id]||0),1)],8,Eh)),R[8]||(R[8]=I("div",{class:"flex-1"},null,-1)),I("div",xh,[te(ie,{size:"xs",color:"gray",variant:"ghost",ui:{base:"rounded-full"},class:"tool-open-btn",onClick:mt=>h(ge.id),title:"展开工具"},{default:Ce(()=>[te(ne,{name:"i-heroicons-ellipsis-horizontal",style:{"font-size":"16px","line-height":"1"}})]),_:2},1032,["onClick"]),Ii(I("div",{class:be(["message-toolbox overlay",ve(b)])},[I("div",Ch,[ge.private?(J(),ae("div",_h,[te(ne,{name:"i-mdi-lock-outline"})])):Me("",!0),ee(ge)?(J(),ae("div",{key:1,class:"tool-icon",onClick:mt=>ye(ge),title:ge.pinned?"取消置顶":"置顶内容"},[te(ne,{name:ge.pinned?"i-mdi-pin":"i-mdi-pin-outline"},null,8,["name"])],8,Th)):Me("",!0),ve(oe)?(J(),ae("div",{key:2,class:"tool-icon",onClick:mt=>dn(ge),title:"编辑"},[te(ne,{name:"i-mdi-pencil-outline"})],8,Mh)):Me("",!0),I("div",{class:"tool-icon",onClick:mt=>on(ge.content),title:"复制"},[te(ne,{name:"i-mdi-content-copy"})],8,Ah),I("div",{class:"tool-icon",onClick:mt=>cn(ge.id),title:"下载卡片"},[te(ne,{name:"i-mdi-image-outline"})],8,Lh),ve(oe)?(J(),ae("div",{key:3,class:"tool-icon",onClick:mt=>Ge(ge.id),title:"删除"},[te(ne,{name:"i-mdi-trash-can-outline"})],8,Dh)):Me("",!0)])],2),[[fs,ve(k)===ge.id]])])]),(ve(Pe)[ge.id]||ve(le)===ge.id)&&ve(Ue)&&!Re(ge)?(J(),ae("div",{key:3,id:`comment-container-${ge.id}`,class:"mt-2",style:{position:"relative"}},[ve(Te)&&ve($)?(J(),Lt(Ks,{key:ve(de)[ge.id]||0,"message-id":ge.id,"site-config":p.siteConfig,"show-input":ve(le)===ge.id,onCancel:mt=>se(ge.id,mt)},null,8,["message-id","site-config","show-input","onCancel"])):ve(V)&&ve($)?(J(),ae("div",{key:1,id:`waline-${ge.id}`},null,8,Ph)):Me("",!0)],8,Oh)):Me("",!0)],10,lh)):Me("",!0)])])}),128))]),ve(Ft)?Me("",!0):(J(),ae("div",Rh,[I("div",Ih,[ve(F).page>1?(J(),Lt(ie,{key:0,color:"gray",variant:"ghost",size:"xs",class:be(["rounded-full px-4 py-1.5 shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",ve(S)]),onClick:_n,disabled:ve(It)},{default:Ce(()=>[te(ne,{name:"i-heroicons-arrow-left",class:"mr-1 w-4 h-4"}),R[10]||(R[10]=gt(" 上一页 "))]),_:1},8,["class","disabled"])):Me("",!0),ve(F).hasMore?(J(),Lt(ie,{key:1,color:"gray",variant:"ghost",size:"xs",class:be(["rounded-full px-4 py-1.5 shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",ve(S)]),onClick:an,disabled:ve(It)},{default:Ce(()=>[R[11]||(R[11]=gt(" 下一页 ")),te(ne,{name:"i-heroicons-arrow-right",class:"ml-1 w-4 h-4"})]),_:1},8,["class","disabled"])):Me("",!0),ve(It)?(J(),ae("span",Hh,"加载中...")):Me("",!0)]),I("div",Nh,[I("span",jh,"第 "+qe(ve(F).page)+" 页",1),te(Oe,{modelValue:ve(_),"onUpdate:modelValue":R[0]||(R[0]=ge=>ya(_)?_.value=ge:null),type:"number",min:"1",max:ve(T),class:"w-12 text-center text-sm",placeholder:"#",onKeyup:us(M,["enter"])},null,8,["modelValue","max"]),te(ie,{size:"xs",color:"gray",variant:"ghost",class:"text-gray-400 hover:text-orange-500 text-sm",onClick:M},{default:Ce(()=>R[12]||(R[12]=[gt(" 跳转 ")])),_:1})])])),!ve(Ft)&&ve(F).messages.length>0&&!ve(F).hasMore?(J(),ae("div",$h,[te(ne,{name:"i-fluent-emoji-flat-confetti-ball",size:"lg"}),R[13]||(R[13]=gt(" 加载完毕~ "))])):Me("",!0)],2)]),te(jt,{modelValue:ve(it),"onUpdate:modelValue":R[4]||(R[4]=ge=>ya(it)?it.value=ge:null),ui:{width:"sm:max-w-2xl"}},{default:Ce(()=>[te(et,null,{header:Ce(()=>[I("div",Bh,[R[14]||(R[14]=I("h3",{class:"text-lg font-medium"},"编辑内容",-1)),te(ie,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:R[1]||(R[1]=ge=>it.value=!1)})])]),footer:Ce(()=>[I("div",qh,[te(ie,{color:"gray",variant:"outline",onClick:R[3]||(R[3]=ge=>it.value=!1),class:"text-white"},{default:Ce(()=>R[16]||(R[16]=[gt(" 取消 ")])),_:1}),te(ie,{color:"orange",onClick:yn,loading:ve(sn),class:"text-white"},{default:Ce(()=>R[17]||(R[17]=[gt(" 保存 ")])),_:1},8,["loading"])])]),default:Ce(()=>{var ge;return[I("div",Uh,[te(Fe,{modelValue:ve(Xt),"onUpdate:modelValue":R[2]||(R[2]=pt=>ya(Xt)?Xt.value=pt:null),placeholder:"编辑内容...",rows:"10",class:"font-mono text-sm"},null,8,["modelValue"]),I("div",zh,[R[15]||(R[15]=I("div",{class:"text-sm text-gray-500 mb-2"},"预览：",-1)),I("div",Fh,[I("div",Vh,[te(ki,{content:ve(Xt),enableGithubCard:((ge=p.siteConfig)==null?void 0:ge.enableGithubCard)===!0},null,8,["content","enableGithubCard"])])])])])]}),_:1})]),_:1},8,["modelValue"])],64)}}}),Yh=Cn(Wh,[["__scopeId","data-v-baf47c50"]]),Kh={class:"calendar-wrapper"},Gh={class:"heatmap-grid"},Xh=["onMouseenter"],Zh=rn({__name:"heatmap",setup(p){const e=G([]),r=G([]),s=G(null),l=G({visible:!1,text:"",x:0,y:0}),d=Bi("contentTheme",G("light")),m=he(()=>String(d&&d.value!==void 0?d.value:d)==="dark");he(()=>m.value?"text-white/70":"text-black/60"),he(()=>{if(!e.value.length)return Array(12).fill("").map((D,N)=>`${N+1}月`);const C=e.value.map(D=>new Date(D.date)),_=new Date(Math.min(...C)),T=[];let M=new Date(_);M.setDate(1);let v=M.getFullYear();for(let D=0;D<12;D++){const N=M.getMonth(),V=M.getFullYear();V!==v||D===0?(T.push(`${V}年${N+1}月`),v=V):T.push(`${N+1}月`),M.setMonth(N+1)}return T});const u=C=>{const _=["#9be9a8","#40c463","#30a14e","#216e39","#0e4429"],T=["rgba(16, 185, 129, 0.28)","rgba(16, 185, 129, 0.45)","rgba(16, 185, 129, 0.62)","rgba(16, 185, 129, 0.80)","rgba(16, 185, 129, 0.98)"];return(m.value?T:_)[Math.min(Math.max(C-1,0),4)]||(m.value?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.06)")},g=C=>C.count?u(C.level):m.value?"rgba(255, 255, 255, 0.10)":"#e5e7eb",S=async()=>{try{const _=await(await fetch("/api/messages/calendar")).json();_&&_.code===1&&_.data&&_.data.length>0?(e.value=_.data,E()):b()}catch(C){console.error("获取热力图数据失败:",C),b()}},k=(C,_)=>{var V;l.value.text=`${_.date} · ${_.count||0} 条`;const M=C.target.getBoundingClientRect(),v=(V=s.value)==null?void 0:V.getBoundingClientRect(),D=M.left-((v==null?void 0:v.left)||0)+M.width/2,N=M.top-((v==null?void 0:v.top)||0)-6;l.value.x=D,l.value.y=N,l.value.visible=!0},h=C=>{var N;const T=C.target.getBoundingClientRect(),M=(N=s.value)==null?void 0:N.getBoundingClientRect(),v=T.left-((M==null?void 0:M.left)||0)+T.width/2,D=T.top-((M==null?void 0:M.top)||0)-6;l.value.x=v,l.value.y=D},f=()=>{l.value.visible=!1},b=()=>{const C=new Date,_=new Date(C);_.setMonth(C.getMonth()-11),_.setDate(1);const T=[];let M=new Date(_);for(;M<=C;){const v=Math.random()>.7?Math.floor(Math.random()*10)+1:0;T.push({date:y(M),count:v}),M.setDate(M.getDate()+1)}e.value=T,E()},y=C=>{const _=C.getFullYear(),T=String(C.getMonth()+1).padStart(2,"0"),M=String(C.getDate()).padStart(2,"0");return`${_}-${T}-${M}`},E=()=>{if(!e.value.length)return;const C=e.value.map(V=>new Date(V.date)),_=new Date(Math.min(...C));new Date(Math.max(...C));const T=new Date(_);T.setDate(1);const M=new Date(T);M.setMonth(T.getMonth()+11),M.setDate(M.getDate()+(6-M.getDay()));const v=new Map;e.value.forEach(V=>{V&&V.date&&V.count!==void 0&&v.set(V.date,V.count)});const D=[];let N=new Date(T);for(N.setDate(N.getDate()-N.getDay());N<=M;){const V=[];for(let H=0;H<7;H++){const $=y(N),z=v.get($)||0;V.push({date:$,count:z,level:z?Math.min(Math.ceil(z/2),5):0}),N.setDate(N.getDate()+1)}D.push(V)}r.value=D},w=()=>{const C=new Date,_=new Date(C);_.setMonth(C.getMonth()-11),_.setDate(1);const T=new Date(_);T.setMonth(_.getMonth()+11),T.setDate(T.getDate()+(6-T.getDay()));const M=[];let v=new Date(_);for(v.setDate(v.getDate()-v.getDay());v<=T;){const D=[];for(let N=0;N<7;N++)D.push({date:y(v),count:0,level:0}),v.setDate(v.getDate()+1);M.push(D)}r.value=M};return zt(()=>{w(),S()}),(C,_)=>(J(),ae("div",Kh,[I("div",{class:be(["calendar-container",m.value?"heatmap-dark":"heatmap-light"]),ref_key:"calendarContainer",ref:s},[I("div",Gh,[(J(!0),ae(Ut,null,Qt(r.value,(T,M)=>(J(),ae("div",{key:M,class:"heatmap-week"},[(J(!0),ae(Ut,null,Qt(T,(v,D)=>(J(),ae("div",{key:D,class:"heatmap-day",style:wi({backgroundColor:g(v)}),onMouseenter:N=>k(N,v),onMouseleave:f,onMousemove:h},null,44,Xh))),128))]))),128))]),l.value.visible?(J(),ae("div",{key:0,class:be(["heatmap-tooltip",m.value?"heatmap-tooltip-dark":"heatmap-tooltip-light"]),style:wi({left:l.value.x+"px",top:l.value.y+"px"})},qe(l.value.text),7)):Me("",!0)],2)]))}}),rs=Cn(Zh,[["__scopeId","data-v-d332f5cb"]]),Jh={class:"tags-container w-full"},Qh={class:"relative"},ep={class:"tags-wrapper"},tp={class:"tags-scroll"},np=["onClick"],ip={class:"tag-count"},rp=rn({__name:"TagList",props:{tags:{type:Array,default:()=>[]}},emits:["tagClick","updateTags"],setup(p,{emit:e}){const r=e,s=G(!1),l=G(Date.now()),d=p,m=he(()=>{const S=/[/?=&]/,k=/^(song|video|playlist)\?id=\d+$/,h=new Map;return d.tags.reduce((f,b)=>(h.has(b.name)||!S.test(b.name)&&!k.test(b.name)&&(h.set(b.name,!0),f.push(b)),f),[])},{}),u=S=>{r("tagClick",S)},g=async()=>{s.value||(s.value=!0,l.value=Date.now(),r("updateTags"),setTimeout(()=>{s.value=!1},1e3))};return(S,k)=>{const h=fi;return J(),ae("div",Jh,[I("div",Qh,[I("div",ep,[I("div",tp,[(J(!0),ae(Ut,null,Qt(m.value,f=>(J(),ae("span",{key:f.name+l.value,class:"tag-item",onClick:b=>u(f.name)},[gt(" #"+qe(f.name)+" ",1),I("span",ip,"("+qe(f.count)+")",1)],8,np))),128))])]),I("div",{class:"absolute -right-1 top-1/2 -translate-y-1/2 p-2 cursor-pointer transition-all duration-200 hover:scale-110 z-10 refresh-toggle",onClick:g,title:"刷新标签"},[te(h,{name:"i-mdi-refresh",class:be(["w-5 h-5 refresh-icon",{"animate-spin":s.value}])},null,8,["class"])]),k[0]||(k[0]=I("div",{class:"scroll-fade"},null,-1))])])}}}),ap=Cn(rp,[["__scopeId","data-v-0448707a"]]),op={class:"announcement-container mx-auto w-full sm:max-w-2xl px-2"},sp={class:"announcement-wrapper"},lp=["title"],cp={class:"marquee-item"},up=60,dp=rn({__name:"AnnouncementBar",props:{text:{}},setup(p){const e=p,r=G(null),s=G(null),l=G(null),d=G(0),m=G(18),u=()=>{const g=l.value;if(!g)return;const S=g.scrollWidth,k=40;d.value=S+k,m.value=Math.max(Math.round(d.value/up),12)};return zt(()=>{bt(()=>{u(),window.addEventListener("resize",u)})}),ci(()=>{window.removeEventListener("resize",u)}),Et(()=>e.text,()=>bt(u)),(g,S)=>{const k=fi;return J(),ae("div",op,[I("div",sp,[te(k,{name:"i-mdi-bell-outline",class:"w-4 h-4 mr-2 flex-shrink-0 text-orange-500"}),I("div",{class:"announcement-text",ref_key:"textContainer",ref:r,title:g.text},[I("div",{class:"marquee animate",ref_key:"marquee",ref:s,style:wi({"--distance":d.value+"px",animationDuration:m.value+"s"})},[I("div",{class:"marquee-item",ref_key:"firstItem",ref:l},[te(ki,{content:g.text,enableGithubCard:!1},null,8,["content"])],512),I("div",cp,[te(ki,{content:g.text,enableGithubCard:!1},null,8,["content"])])],4)],8,lp)])])}}}),as=Cn(dp,[["__scopeId","data-v-571a4c47"]]),fp=rn({__name:"FloatingToolSidebar",props:{contentTheme:{},layoutIcon:{}},setup(p){const e=p,r=he(()=>e.contentTheme==="dark"),s=he(()=>e.contentTheme==="dark"?"i-mdi-weather-night":"i-mdi-white-balance-sunny"),l=he(()=>e.layoutIcon||"i-mdi-view-grid");return(d,m)=>{const u=fi;return J(),ae("div",{class:be(["floating-sidebar",ve(r)?"fs-dark":"fs-light"])},[I("button",{class:be(["tool-btn btn-layout",ve(r)?"btn-dark":"btn-light"]),onClick:m[0]||(m[0]=g=>d.$emit("toggle-layout")),"aria-label":"布局"},[te(u,{name:ve(l),class:"w-6 h-6"},null,8,["name"]),m[5]||(m[5]=I("span",{class:"btn-label"},"布局",-1))],2),I("button",{class:be(["tool-btn",ve(r)?"btn-dark":"btn-light"]),onClick:m[1]||(m[1]=g=>d.$emit("search")),"aria-label":"搜索"},[te(u,{name:"i-heroicons-magnifying-glass",class:"w-6 h-6"}),m[6]||(m[6]=I("span",{class:"btn-label"},"搜索",-1))],2),I("button",{class:be(["tool-btn",ve(r)?"btn-dark":"btn-light"]),onClick:m[2]||(m[2]=g=>d.$emit("switch-background")),"aria-label":"背景"},[te(u,{name:"i-mdi-image-outline",class:"w-6 h-6"}),m[7]||(m[7]=I("span",{class:"btn-label"},"背景",-1))],2),I("button",{class:be(["tool-btn",ve(r)?"btn-dark":"btn-light"]),onClick:m[3]||(m[3]=g=>d.$emit("toggle-theme")),"aria-label":"切换亮暗"},[te(u,{name:ve(s),class:"w-6 h-6"},null,8,["name"]),m[8]||(m[8]=I("span",{class:"btn-label"},"切换亮暗",-1))],2),I("a",{href:"/rss",target:"_blank",rel:"noopener noreferrer",class:be(["tool-btn",ve(r)?"btn-dark":"btn-light"]),"aria-label":"RSS"},[te(u,{name:"i-mdi-rss",class:"w-6 h-6"}),m[9]||(m[9]=I("span",{class:"btn-label"},"RSS",-1))],2),I("button",{class:be(["tool-btn",ve(r)?"btn-dark":"btn-light"]),"aria-label":"后台",onClick:m[4]||(m[4]=g=>d.$emit("open-admin"))},[te(u,{name:"i-mdi-server-outline",class:"w-6 h-6"}),m[10]||(m[10]=I("span",{class:"btn-label"},"后台",-1))],2)],2)}}}),hp=Cn(fp,[["__scopeId","data-v-bb3179ad"]]),pp={key:0,class:"loading"},mp={key:0,class:"left-col"},gp={class:"profile-card"},vp={class:"avatar-wrap relative"},bp=["src","alt"],yp={class:"profile-name text-center"},wp={key:0,class:"mt-1"},kp={class:"profile-desc"},Ep={key:1,class:"auth-actions"},Sp={class:"p-0 grid grid-cols-3 gap-2 text-center text-sm"},xp={class:"font-semibold"},Cp={class:"font-semibold"},_p={class:"font-semibold"},Tp={class:"social-list"},Mp=["href","data-label"],Ap=["src"],Lp={class:"p-0 text-center clock-card"},Dp={class:"clock-display"},Op={class:"clock-date"},Pp={key:0,class:"relative"},Rp=["href"],Ip=["src"],Hp={class:"ad-overlay"},Np={key:0,class:"absolute bottom-2 left-0 right-0 flex justify-center gap-2"},jp=["onClick"],$p={class:"hitokoto-container mx-auto w-full sm:max-w-2xl px-2"},Bp=["title"],Up={key:3,class:"mt-2 space-y-3"},zp={class:"scroll-tags mb-2"},Fp={class:"tag-grid"},Vp=["onClick"],qp={class:"ml-1 opacity-60"},Wp={class:"scroll-images"},Yp={class:"recommend-grid"},Kp=["href"],Gp=["src"],Xp={class:"scroll-list p-0"},Zp={class:"flex flex-wrap gap-2"},Jp=["src","data-mail","data-qq","onError"],Qp={class:"center-col"},em={class:"moments-header"},tm={class:"header-title"},nm={class:"hero-tabs"},im=["onClick"],rm={key:0,class:"links-page"},am={key:0,class:"section-subtitle"},om={key:1,class:"mx-auto w-full max-w-3xl px-4 sm:px-6 mt-3 mb-3"},sm={class:"link-grid"},lm=["href"],cm={class:"link-content"},um={class:"link-title"},dm={key:0,class:"text-xs opacity-75"},fm={key:2,class:"mt-2"},hm={class:"mt-4"},pm={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},mm={class:"flex justify-center mt-2"},gm={key:1,class:"comment-page"},vm={key:0,class:"section-subtitle"},bm={class:"max-w-3xl mx-auto"},ym={key:1,class:"text-sm opacity-70"},wm={key:2,class:"about-page"},km={key:0,class:"section-subtitle"},Em={class:"mx-auto w-full max-w-3xl px-4 sm:px-6"},Sm={class:"mx-auto w-full sm:max-w-4xl mt-3"},xm=["innerHTML"],Cm={key:0,class:"right-col space-y-3"},_m={class:"scroll-tags mb-2"},Tm={class:"tag-grid"},Mm=["onClick"],Am={class:"ml-1 opacity-60"},Lm={class:"text-xs opacity-70 mb-2"},Dm={class:"scroll-images"},Om={class:"recommend-grid"},Pm=["href"],Rm=["src"],Im={class:"scroll-list p-0"},Hm={class:"flex flex-wrap gap-2"},Nm=["src","data-mail","data-qq","onError"];const jm=["data-playlist-id","data-song-id","data-position","data-theme","data-lyric","data-default-minimized","data-embed","data-autoplay"],$m={class:"flex justify-between items-center"},Bm={class:"text-xl font-semibold"},Um={class:"flex items-center gap-2"},zm={class:"space-y-3"},Fm={key:0},Vm={class:"space-y-3"},qm={class:"flex items-center justify-between text-sm mt-2"},Wm={key:0,class:"text-center text-sm opacity-80 mt-3"},Ym={key:1,class:"mt-2"},Km={key:1},Gm={class:"space-y-3"},Xm={class:"flex items-center gap-2"},Zm=["src"],Jm={class:"space-y-3"},Qm={class:"flex justify-end gap-2"},Ba="https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",lg=rn({__name:"index",setup(p){const e=xc(),r=ds(),s=gn().public.baseApi||"/api",l=(()=>{if(typeof window>"u")return"three";const j=window.matchMedia("(max-width: 1024px)").matches,P=localStorage.getItem(j?"homeLayoutMobile":"homeLayoutDesktop");return P||(j?"single":"three")})(),d=G(l),m=typeof window<"u"?window.matchMedia("(max-width: 1024px)"):null,u=G(!!(m!=null&&m.matches)),g=()=>{u.value||(d.value=d.value==="three"?"two":d.value==="two"?"single":"three",typeof window<"u"&&localStorage.setItem("homeLayoutDesktop",d.value))},S=he(()=>d.value==="three"?"grid-3":d.value==="two"?"grid-2":"grid-1"),k=he(()=>d.value==="three"?"i-mdi-view-grid":d.value==="two"?"i-mdi-view-column":"i-mdi-view-stream"),h=he(()=>d.value==="two"?"w-full max-w-none":d.value==="single"?"mx-auto w-full max-w-[640px] sm:max-w-3xl":"mx-auto w-full sm:max-w-4xl"),f=[{key:"latest",name:"最新"},{key:"links",name:"友链"},{key:"comment",name:"留言"},{key:"about",name:"关于"}],b=G("latest"),y=G(null),E=G(!1),w=G(!1),C=G("login"),_=yr({username:"",password:""}),T=yr({username:"",password:"",captcha:""}),M=G(!1),v=G(!1),D=G(!1),N=G(!1),V=G(""),H=G(0);let $=null,z=null;const F=G(!1),le=yr({account:""}),de=G(0);let Pe=null;const Ue=G(!0),Te=G(!1),Le=async()=>{try{V.value=`${s}/captcha?ts=${Date.now()}`,$=Date.now()+12e4,H.value=120,z&&clearInterval(z),z=Xi(()=>{const j=Math.max(0,Math.ceil((($||Date.now())-Date.now())/1e3));H.value=j,j<=0&&clearInterval(z)},1e3)}catch{H.value=0}},Re=async()=>{var j;try{const q=await(await fetch(`${s}/frontend/config`,{credentials:"include"})).json();if(!!!((j=q==null?void 0:q.data)!=null&&j.allowRegistration)){Ke().add({title:"提示",description:"站点已关闭用户注册",color:"orange"});return}}catch{}C.value="register",Le()},Je=()=>{C.value="login"},tt=()=>{w.value=!1;const{login:j,...P}=r.query;e.replace({path:r.path,query:P})},U=async()=>{D.value=!0;try{if(await Gn().login({username:_.username,password:_.password})){Ke().add({title:"登录成功",color:"green"}),w.value=!1;const P=r.query.redirect||"/status";e.push(P)}}catch{Ke().add({title:"登录失败",color:"red"})}finally{D.value=!1}},oe=async()=>{N.value=!0;try{if(!T.username||!T.password||!T.captcha)throw new Error("请完整填写用户名、密码与验证码");if(($||0)<Date.now())throw new Error("验证码已过期，请刷新后再提交");const j=await fetch(`${s}/register`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(T)}),P=await j.json().catch(()=>({}));if(!j.ok||P.code!==1)throw new Error((P==null?void 0:P.msg)||"注册失败");Ke().add({title:"注册成功",color:"green"}),C.value="login"}catch(j){Ke().add({title:"注册失败",description:j.message||"请稍后重试",color:"red"}),Le()}finally{N.value=!1}},re=async()=>{var P,q,Q;if(await Gn().checkLoginStatus())e.push("/status");else{C.value="login",w.value=!0;try{const xe=await(await fetch(`${s}/frontend/config`,{credentials:"include"})).json();Te.value=!!((q=(P=xe==null?void 0:xe.data)==null?void 0:P.frontendSettings)!=null&&q.githubOAuthEnabled),Ue.value=!!((Q=xe==null?void 0:xe.data)!=null&&Q.smtpEnabled)}catch{}}};ci(()=>{z&&clearInterval(z)}),Et(()=>r.query.login,j=>{j&&(C.value="login",w.value=!0)},{immediate:!0}),Et(w,j=>{if(!j&&r.query.login){const{login:P,...q}=r.query;e.replace({path:r.path,query:q})}});const Ae=()=>{window.location.href=`${s}/oauth/github/login`},Ge=async()=>{try{const j=await fetch(`${s}/password/forgot`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({account:le.account})}),P=await j.json().catch(()=>({}));if(!j.ok||P.code!==1)throw new Error((P==null?void 0:P.msg)||"发送失败");Ke().add({title:(P==null?void 0:P.msg)||"已发送",description:"请查收重置邮件",color:"green"}),de.value=60,Pe&&clearInterval(Pe),Pe=Xi(()=>{de.value>0?de.value--:clearInterval(Pe)},1e3)}catch(j){Ke().add({title:"失败",description:j.message||"发送失败",color:"red"})}},Z=G(null),ke=j=>{console.log("接收到搜索结果:",j),y.value&&y.value.handleSearchResult(j)},se=G(null),ee=async()=>{var j;try{const q=await(await fetch((gn().public.baseApi||"/api")+"/guestbook/message",{method:"GET",headers:{Accept:"application/json"},credentials:"include"})).json().catch(()=>null),Q=(j=q==null?void 0:q.data)==null?void 0:j.id;se.value=typeof Q=="number"?Q:null}catch{se.value=null}};Et(()=>b.value,j=>{j==="comment"&&!se.value&&ee()}),zt(()=>{ee()});const Ie=Gn(),ye=he(()=>!!Ie.isLogin),lt=he(()=>{var q,Q;const j=((q=$e.value)==null?void 0:q.users)||((Q=$e.value)==null?void 0:Q.Users)||[];return(Array.isArray(j)?j.find(we=>!!((we==null?void 0:we.is_admin)??(we==null?void 0:we.IsAdmin))):null)||(Array.isArray(j)?j[0]:null)||null}),Ve=he(()=>{const j=Ie.user;if(j)return!!(j!=null&&j.is_admin||j!=null&&j.IsAdmin);const P=lt.value;return!!(P&&(P!=null&&P.is_admin||P!=null&&P.IsAdmin))}),Qe=he(()=>{var Q;const j=Ie.user,P=String((j==null?void 0:j.username)||(j==null?void 0:j.Username)||"").trim();return P||String(((Q=R.value)==null?void 0:Q.welcomeName)||"").trim()||"匿名"}),De=he(()=>{var we;const j=Ie.user,P=String((j==null?void 0:j.avatar_url)||(j==null?void 0:j.AvatarURL)||"").trim(),q=gn().public.baseApi||"/api";if(P)return P.startsWith("http")?P:`${q}${P}`;const Q=String(((we=R.value)==null?void 0:we.welcomeAvatarURL)||"").trim();return Q?Q.startsWith("http")?Q:`${q}${Q}`:Ba}),nt=j=>{const P=j.target;P&&P.src!==Ba&&(P.src=Ba)},ct=he(()=>{var Q;const j=Ie.user,P=String((j==null?void 0:j.description)||"").trim();return P||String(((Q=R.value)==null?void 0:Q.welcomeDescription)||"").trim()||"执迷不悟"}),dt=G(!0),ft=G(typeof window<"u"&&localStorage.getItem("contentTheme")||"light");he(()=>ft.value==="dark"?"i-mdi-weather-night":"i-mdi-white-balance-sunny");const It=G(!1);kr("showHeatmap",dt),kr("contentTheme",ft),kr("toggleContentTheme",()=>{ft.value=ft.value==="dark"?"light":"dark",typeof window<"u"&&(localStorage.setItem("contentTheme",ft.value),document.documentElement.classList.toggle("dark",ft.value==="dark"))}),Et(()=>ft.value,j=>{typeof window<"u"&&document.documentElement.classList.toggle("dark",j==="dark")},{immediate:!0});const _n=()=>{ft.value=ft.value==="dark"?"light":"dark",typeof window<"u"&&(localStorage.setItem("contentTheme",ft.value),document.documentElement.classList.toggle("dark",ft.value==="dark"))},an=G(null),on=()=>{const j=an.value;j?j.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},it=()=>{const j=an.value;if(j)j.scrollTo({top:j.scrollHeight,behavior:"smooth"});else{const P=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);window.scrollTo({top:P,behavior:"smooth"})}},Xt=[],un=()=>{Array.from(document.querySelectorAll(".scroll-list, .scroll-images")).forEach(P=>{let q=0,Q=performance.now(),we=0;const xe=P.classList.contains("scroll-list")?.25:.35,ot=1200,_t=Gt=>{q=requestAnimationFrame(_t);const Nn=Gt-Q;Q=Gt,!(we&&Gt<we)&&(P.scrollTop+=xe*Nn/16,P.scrollTop>=P.scrollHeight-P.clientHeight-1&&(P.scrollTop=0,we=Gt+ot))};q=requestAnimationFrame(_t),Xt.push(()=>cancelAnimationFrame(q))})},sn=G(!1),dn=G(!0),yn=G(!1),cn=()=>{const j=an.value;if(!j){const Q=window.scrollY||document.documentElement.scrollTop||0,we=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);dn.value=Q<=2,yn.value=window.innerHeight+Q>=we-2;return}const P=j.scrollTop,q=j.scrollHeight;dn.value=P<=2,yn.value=j.clientHeight+P>=q-2};zt(()=>{var j;cn(),(j=an.value)==null||j.addEventListener("scroll",cn,{passive:!0}),It.value&&bt(()=>un())}),ci(()=>{var j;(j=an.value)==null||j.removeEventListener("scroll",cn),Xt.forEach(P=>P())});const Ft=he(()=>dn.value||yn.value||sn.value),Dt=he(()=>yn.value&&!dn.value?"i-heroicons-arrow-up":"i-heroicons-arrow-down"),ei=()=>{yn.value&&!dn.value?on():it()},Ht=he(()=>ft.value==="dark"),Nt=he(()=>Ht.value?"bg-[rgba(36,43,50,0.95)] text-white border border-white/20":"bg-white text-black border border-black/10"),Vt=he(()=>Ht.value?"scroll-button bg-[rgba(36,43,50,0.85)] hover:bg-[rgba(36,43,50,0.95)] text-white shadow-[0_6px_16px_rgba(0,0,0,0.35)]":"scroll-button bg-white/95 hover:bg-white text-gray-700 ring-1 ring-gray-200 shadow-[0_4px_12px_rgba(0,0,0,0.12)]"),W=he(()=>Ht.value?"text-white w-6 h-6":"text-gray-600 w-6 h-6");Et(dt,j=>{console.log("index.vue 中热力图状态变化:",j)}),bo({meta:[{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}]}),Et(()=>r.hash,j=>{const P=(j||"").split("/messages/").pop();Z.value=P||null},{immediate:!0});const R=G({siteTitle:"",subtitleText:"",avatarURL:"",username:"",description:"",backgrounds:[],cardFooterTitle:"",cardFooterSubtitle:"",pageFooterHTML:"",rssTitle:"",rssDescription:"",rssAuthorName:"",rssFaviconURL:"",linksTitle:"",linksDescription:"",commentPageTitle:"",commentPageDescription:"",aboutPageTitle:"",aboutPageDescription:"",aboutMarkdown:"",friendLinks:[],enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",announcementText:"",announcementEnabled:!0,hitokotoEnabled:!0,commentEnabled:!0,commentSystem:"builtin",commentEmailEnabled:!1,commentLoginRequired:!1,musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:"",calendarEnabled:!0,timeEnabled:!0,leftAdEnabled:!0,leftAdImageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,leftAdLinkURL:"https://note.noisework.cn",leftAdDescription:"示例广告（单条配置）",leftAds:[{imageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,linkURL:"https://note.noisework.cn",description:"写作与记录，开启灵感之旅"},{imageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,linkURL:"https://noisework.cn",description:"探索新主题与小工具"},{imageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,linkURL:"https://github.com",description:"开源项目，欢迎 Star"}],leftAdsIntervalMs:4e3}),ne=async()=>{await bt();const j=window.NeteaseMiniPlayer;j&&typeof j.init=="function"&&j.init()},ie=async()=>{if(typeof window>"u")return!1;if(window.NeteaseMiniPlayer)return!0;const j=document.head,P=document.body,q="nmp-css";if(!document.getElementById(q)){const we=document.createElement("link");we.id=q,we.rel="stylesheet";const xe=R.value.musicCssCdnURL||"",ot="/NeteaseMiniPlayer/netease-mini-player-v2.css";we.href=xe&&xe.trim()!==""?xe.trim():ot,we.onerror=()=>{we.href=ot},j.appendChild(we)}const Q="nmp-js";return document.getElementById(Q)?!!window.NeteaseMiniPlayer:await new Promise(we=>{const xe=document.createElement("script");xe.id=Q;const ot=R.value.musicJsCdnURL||"",_t="/NeteaseMiniPlayer/netease-mini-player-v2.js";xe.src=ot&&ot.trim()!==""?ot.trim():_t,xe.defer=!0,xe.onload=()=>we(!!window.NeteaseMiniPlayer),xe.onerror=()=>{if(xe.src!==_t){xe.src=_t,xe.onload=()=>we(!!window.NeteaseMiniPlayer),xe.onerror=()=>we(!1);return}we(!1)},P.appendChild(xe)})},Oe=async(j,P=2500)=>{const q=new AbortController,Q=setTimeout(()=>q.abort(),P);try{const we=await fetch(j,{cache:"no-cache",signal:q.signal});return clearTimeout(Q),we}catch(we){throw clearTimeout(Q),we}},Fe=async()=>{if(typeof window>"u")return;await bt();try{const P=await Oe("https://v1.hitokoto.cn/?encode=json",2500);if(P.ok){const q=await P.json(),Q=String((q==null?void 0:q.hitokoto)||"").trim();if(Q){Kt.value=Q;return}}}catch{}try{const P=await Oe("https://v1.hitokoto.cn/?encode=text",2500);if(P.ok){const q=String(await P.text()).trim();if(q){Kt.value=q;return}}}catch{}try{if(!document.getElementById("hitokoto-script-left")){const P=document.createElement("script");P.id="hitokoto-script-left",P.src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto",P.defer=!0,P.onload=()=>{try{const q=document.getElementById("hitokoto"),Q=((q==null?void 0:q.textContent)||(q==null?void 0:q.innerText)||"").trim();Q&&(Kt.value=Q)}catch{}},document.body.appendChild(P)}}catch{}String(Kt.value||"").trim()||(Kt.value="身为冒险者，如果安静的老死在床上，那简直就是耻辱！")};Et(()=>R.value.musicEnabled,async j=>{j&&await ie()&&await ne()}),Et(()=>R.value.hitokotoEnabled,async j=>{j&&await Fe()},{immediate:!0});const et=he(()=>({"--bg-image":`url(${$t.value||R.value.backgrounds[0]})`})),jt=he(()=>({"background-image":`url(${$t.value||R.value.backgrounds[0]})`,"background-size":"cover","background-position":"center"})),ge={siteTitle:"说说笔记",subtitleText:"欢迎访问，点击头像可更换封面背景！",avatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",username:"Noise",description:"执迷不悟",welcomeAvatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",welcomeName:"Noise",welcomeDescription:"执迷不悟",welcomeUseAdmin:!0,backgrounds:["https://s2.loli.net/2025/03/27/KJ1trnU2ksbFEYM.jpg","https://s2.loli.net/2025/03/27/MZqaLczCvwjSmW7.jpg","https://s2.loli.net/2025/03/27/UMijKXwJ9yTqSeE.jpg","https://s2.loli.net/2025/03/27/WJQIlkXvBg2afcR.jpg","https://s2.loli.net/2025/03/27/oHNQtf4spkq2iln.jpg","https://s2.loli.net/2025/03/27/PMRuX5loc6Uaimw.jpg","https://s2.loli.net/2025/03/27/U2WIslbNyTLt4rD.jpg","https://s2.loli.net/2025/03/27/xu1jZL5Og4pqT9d.jpg","https://s2.loli.net/2025/03/27/OXqwzZ6v3PVIns9.jpg","https://s2.loli.net/2025/03/27/HGuqlE6apgNywbh.jpg","https://s2.loli.net/2025/03/26/d7iyuPYA8cRqD1K.jpg","https://s2.loli.net/2025/03/27/wYy12qDMH6bGJOI.jpg","https://s2.loli.net/2025/03/27/y67m2k5xcSdTsHN.jpg"],cardFooterTitle:"Noise·说说·笔记~",cardFooterSubtitle:"note.noisework.cn",pageFooterHTML:'<div class="text-center text-xs text-gray-400 py-4">来自<a href="https://www.noisework.cn" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Noise</a> 使用<a href="https://github.com/rcy1314/echo-noise" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Ech0-Noise</a>发布</div>',rssTitle:"Noise的说说笔记",rssDescription:"一个说说笔记~",rssAuthorName:"Noise",rssFaviconURL:"/favicon.ico",aboutMarkdown:`# 关于我

这里是一个默认的个人简介示例：

- 喜欢记录与分享
- 热爱开源与学习
- 持续打磨产品体验

欢迎通过友链或留言与我交流！`,linksTitle:"友情链接",linksDescription:"推荐站点和朋友们的主页",linksApplyTitle:"申请友链须知",linksApplyText:"请提供站点名称、网址、图标（可选）、简介与有效邮箱。提交后需管理员审核，审核通过后展示。",commentPageTitle:"留言",commentPageDescription:"欢迎留下你的看法",aboutPageTitle:"关于本站",aboutPageDescription:"这里是站点的介绍与说明",enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",announcementText:"欢迎访问我的说说笔记！",announcementEnabled:!0,hitokotoEnabled:!0,commentEnabled:!0,commentSystem:"builtin",commentEmailEnabled:!1,commentLoginRequired:!1,musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:"",socialLinks:[{name:"GitHub",url:"https://github.com/rcy1314",icon:"i-mdi-github"},{name:"X",url:"https://x.com/liangwenhao3",icon:"i-mdi-twitter"},{name:"主页",url:"https://www.noisework.cn/",icon:"i-mdi-home"},{name:"博客",url:"https://www.noiseblogs.top/",icon:"i-mdi-notebook"}],friendLinks:[{title:"NoiseWork",link:"https://www.noisework.cn/",icon:"i-mdi-home",description:"个人主页与作品集合"},{title:"NoiseBlogs",link:"https://www.noiseblogs.top/",icon:"i-mdi-notebook",description:"技术随笔与学习记录"}],calendarEnabled:!0,timeEnabled:!0,leftAdEnabled:!0,leftAds:[],leftAdsIntervalMs:4e3},pt=async()=>{var j;try{R.value={...ge};const P=await Un("frontend/config",void 0,{credentials:"include"});if(P&&P.code===1&&P.data&&P.data.frontendSettings){const q=P.data.frontendSettings,Q=["enableGithubCard","pwaEnabled","announcementEnabled","hitokotoEnabled","commentEnabled","commentEmailEnabled","commentLoginRequired","musicEnabled","musicLyric","musicAutoplay","musicDefaultMinimized","musicEmbed","calendarEnabled","timeEnabled","leftAdEnabled","welcomeUseAdmin"];Object.keys(R.value).forEach(xe=>{if(q[xe]!==null&&q[xe]!==void 0)if(xe==="backgrounds"&&Array.isArray(q[xe]))R.value.backgrounds=[...q[xe]];else if(xe==="socialLinks"&&Array.isArray(q[xe]))R.value.socialLinks=[...q[xe]];else if(xe==="leftAds"&&Array.isArray(q[xe]))R.value.leftAds=[...q[xe]];else if(xe==="friendLinks"&&Array.isArray(q[xe]))R.value.friendLinks=[...q[xe]];else if(Q.includes(xe)){const ot=q[xe];R.value[xe]=ot===!0||ot==="true"}else{const ot=q[xe];R.value[xe]=typeof ot=="string"?ot.trim():ot}});const we=(q.defaultContentTheme||"light").trim();typeof window<"u"&&!localStorage.getItem("contentTheme")?(ft.value=we==="light"?"light":"dark",document.documentElement.className=ft.value==="dark"?"dark":""):typeof window<"u"&&(document.documentElement.className=ft.value==="dark"?"dark":"")}if((j=R.value.backgrounds)!=null&&j.length||(R.value.backgrounds=[...ge.backgrounds]),R.value.backgrounds.length>0){const q=Math.floor(Math.random()*R.value.backgrounds.length);$t.value=R.value.backgrounds[q]}Bt.value=!0}catch(P){console.error("获取配置失败:",P),R.value={...ge},Bt.value=!0}},mt=j=>{const P=j&&typeof j.icon=="string"?j.icon.trim():"";if(P)return P;const q=String((j==null?void 0:j.url)||"").trim();if(!q)return"i-mdi-link-variant";const Q=q.toLowerCase();if(Q.startsWith("mailto:"))return"i-mdi-email";let we="";try{we=new URL(Q).hostname.toLowerCase()}catch{}return we?we.includes("github.com")?"i-mdi-github":we.includes("twitter.com")||we.includes("x.com")?"i-mdi-twitter":we.includes("t.me")||we.includes("telegram.me")||we.includes("telegram.org")?"i-mdi-telegram":we.includes("discord.com")||we.includes("discord.gg")?"i-mdi-discord":we.includes("youtube.com")||we.includes("youtu.be")?"i-mdi-youtube":we.includes("linkedin.com")?"i-mdi-linkedin":we.includes("facebook.com")?"i-mdi-facebook":we.includes("instagram.com")?"i-mdi-instagram":we.includes("bilibili.com")?"i-mdi-bilibili":we.includes("zhihu.com")?"i-mdi-zhihu":we.includes("medium.com")?"i-mdi-medium":we.includes("tiktok.com")||we.includes("douyin.com")?"i-mdi-tiktok":we.includes("weibo.com")?"i-mdi-sina-weibo":we.includes("wechat")||we.includes("weixin")?"i-mdi-wechat":we.includes("rss")||we.endsWith("/rss")?"i-mdi-rss":"i-mdi-link-variant":"i-mdi-link-variant"},Mt=he(()=>{var q;const j=((q=R.value)==null?void 0:q.socialLinks)??R.socialLinks;return(Array.isArray(j)?j:[]).filter(Q=>String((Q==null?void 0:Q.url)||"").trim()!=="").map(Q=>({...Q,name:(Q==null?void 0:Q.name)||(Q==null?void 0:Q.url)}))});he(()=>Mt.value);const fn=he(()=>{var q;const j=((q=R.value)==null?void 0:q.friendLinks)??R.friendLinks;return(Array.isArray(j)?j:[]).filter(Q=>String((Q==null?void 0:Q.link)||"").trim()!=="").map(Q=>({title:String((Q==null?void 0:Q.title)||(Q==null?void 0:Q.link)||"").trim(),link:String((Q==null?void 0:Q.link)||"").trim(),icon:String((Q==null?void 0:Q.icon)||"").trim(),description:String((Q==null?void 0:Q.description)||"").trim()}))}),yt=yr({title:"",link:"",icon:"",email:"",description:""}),wt=G(!1),wn=async()=>{if(!String(yt.link||"").trim()){Ke().add({title:"提示",description:"请填写网址（必填）",color:"orange"});return}const j=String(yt.link||"").trim();if(!/^https?:\/\//i.test(j)){Ke().add({title:"提示",description:"网址需以 http(s):// 开头",color:"orange"});return}wt.value=!0;try{const P=await fetch(`${s}/friend-links/apply`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:String(yt.title||"").trim(),link:j,icon:String(yt.icon||"").trim(),description:String(yt.description||"").trim(),email:String(yt.email||"").trim()})}),q=await P.json().catch(()=>({}));P.ok&&((q==null?void 0:q.code)===1||q!=null&&q.data)?(Ke().add({title:"已提交，待审核",color:"green"}),yt.title="",yt.link="",yt.icon="",yt.email="",yt.description=""):Ke().add({title:"提交失败",description:(q==null?void 0:q.msg)||"请稍后重试",color:"red"})}catch(P){Ke().add({title:"提交失败",description:(P==null?void 0:P.message)||"网络异常",color:"red"})}finally{wt.value=!1}},Kt=G(["身为冒险者，如果安静的老死在床上，那简直就是耻辱！","愿你出走半生，归来仍是少年。","愿你眼里有光，心里有海。"][0]),$t=G(""),Bt=G(!1),Rn=G(!1),ti=async j=>{const P=q=>new Promise(Q=>{const we=new Image;we.src=q,we.onload=()=>Q(q),we.onerror=()=>Q(null)});await Promise.all(j.map(q=>P(q)))};ci(()=>{window.removeEventListener("frontend-config-updated",pt)});const Mn=async()=>{if(Rn.value)return;Rn.value=!0;const j=Math.floor(Math.random()*R.value.backgrounds.length),P=R.value.backgrounds[j];if(P===$t.value){Rn.value=!1;return}const q=`${P}?imageView2/2/w/10/blur/1/q/10`;$t.value=q,requestAnimationFrame(()=>{const Q=new Image;Q.src=P,Q.onload=()=>{requestAnimationFrame(()=>{$t.value=P,Rn.value=!1})},Q.onerror=()=>{Rn.value=!1}})};let en=null;const In=()=>{en&&clearTimeout(en),en=setTimeout(()=>Xe(),100)},Xe=()=>{const j=(R.value.pwaTitle||R.value.siteTitle||"说说笔记").trim(),P=(R.value.rssFaviconURL||"/favicon.ico").trim(),q=R.value.pwaIconURL&&R.value.pwaIconURL.trim()!==""?R.value.pwaIconURL.trim():P.toLowerCase().endsWith(".png")?P:"/android-chrome-192x192.png",Q=(R.value.pwaDescription||R.value.description||"").trim();bo({title:j,meta:[{key:"description",name:"description",content:Q},{key:"theme-color",name:"theme-color",content:"#000000"}],link:[{key:"icon-32",rel:"icon",type:"image/png",href:"/favicon-32x32.png",sizes:"32x32"},{key:"shortcut-icon-32",rel:"shortcut icon",type:"image/png",href:"/favicon-32x32.png",sizes:"32x32"},{key:"icon-fallback",rel:"icon",href:P},...R.value.pwaEnabled?[{key:"manifest",rel:"manifest",href:"/manifest.webmanifest"},{key:"apple-touch",rel:"apple-touch-icon",href:q,sizes:"180x180"},{key:"pwa-192",rel:"icon",href:q,sizes:"192x192"},{key:"pwa-512",rel:"icon",href:q.toLowerCase().endsWith(".png")?q:"/android-chrome-512x512.png",sizes:"512x512"}]:[]]})};Et(()=>[R.value.pwaEnabled,R.value.pwaTitle,R.value.pwaIconURL,R.value.pwaDescription,R.value.siteTitle,R.value.rssFaviconURL,R.value.description],()=>{In()},{immediate:!0});const at=G(null),Pt=G([]),Y=async()=>{await X()},X=async()=>{try{const j=await Un("messages/tags");j&&j.code===1?Pt.value=j.data||[]:Pt.value=[]}catch(j){console.error("获取标签失败:",j),Pt.value=[]}},Ee=G([]),$e=G(null),ze=async()=>{try{const j=await Un("messages/images");j&&j.code===1&&Array.isArray(j.data)&&(Ee.value=j.data)}catch{}},ut=async()=>{try{const j=await Un("status");j&&j.code===1&&($e.value=j.data)}catch{}},Be=he(()=>(Array.isArray(Pt.value)?[...Pt.value]:[]).sort((P,q)=>(q.count||0)-(P.count||0)).slice(0,8)),Rt=he(()=>Ee.value.slice(0,60)),tn=j=>{const P=typeof j=="string"?j:(j==null?void 0:j.image_url)||(j==null?void 0:j.url),q=gn().public.baseApi||"/api";return P!=null&&P.startsWith("http")?P:`${q}${P}`},St=he(()=>Array.isArray(R.value.leftAds)?R.value.leftAds.filter(j=>String((j==null?void 0:j.imageURL)||"").trim()!==""):[]),Hn=j=>{const P=gn().public.baseApi||"/api",q=String(j||"").trim();return q.startsWith("http")?q:q?`${P}${q}`:""},qn=G(0),ni=he(()=>St.value[Math.max(0,Math.min(qn.value,St.value.length-1))]||{imageURL:"",linkURL:"",description:""});let hi;zt(()=>{const j=Number(R.leftAdsIntervalMs||5e3);St.value.length>1&&(hi=Xi(()=>{qn.value=(qn.value+1)%St.value.length},Math.max(2e3,j)))}),ci(()=>{hi&&clearInterval(hi)});const hn=G([]),pi=G(0),Dr=j=>/!\[[^\]]*\]\([^)]*\)/.test(String(j||""))||/<img[^>]*>/i.test(String(j||"")),Or=he(()=>{const j=hn.value.filter(Q=>!Dr((Q==null?void 0:Q.content)||""));if(j.length<=8)return j;const P=pi.value%j.length,q=(P+8)%j.length;return P<q?j.slice(P,q):[...j.slice(P),...j.slice(0,q)]}),Pr=j=>{const Q=String(j||"").replace(/!\[[^\]]*\]\([^)]*\)/g,"").replace(/<img[^>]*>/gi,"").replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim();return Q.length>20?Q.slice(0,20):Q||"评论"},ur=j=>`https://i.pravatar.cc/64?u=${encodeURIComponent(j||Math.random().toString(36).slice(2))}`,qi=j=>{const q=String(j||"").trim().match(/^(\d+)@qq\.com$/i);return q?q[1]:""},Rr=j=>{let P=0;const q=String(j||"");for(let Q=0;Q<q.length;Q++)P=(P<<5)-P+q.charCodeAt(Q),P|=0;return Math.abs(P)},Si=j=>{const P=String(j||"").trim();if(!P)return"U";if(/^[\u4e00-\u9fa5]/.test(P))return P.slice(0,1);const q=P.split(/\s+|[_.-]+/).filter(Boolean),Q=(q[0]||P)[0]||"U",we=(q[1]||"")[0]||"";return(Q+we).toUpperCase()},Ir=(j,P=40)=>{const q=Si(j),we=`hsl(${Rr(j)%360},70%,50%)`,xe=`<svg xmlns="http://www.w3.org/2000/svg" width="${P}" height="${P}"><rect width="${P}" height="${P}" rx="${P/2}" fill="${we}"/><text x="50%" y="55%" font-size="${Math.floor(P*.5)}" text-anchor="middle" fill="#fff" font-family="-apple-system,Segoe UI,Roboto,Helvetica,Arial">${q}</text></svg>`;return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(xe)},Hr=he(()=>{const j=String(R.value.avatarURL||"").trim(),P=gn().public.baseApi||"/api";return j?j.startsWith("http")?j:`${P}${j}`:String(R.value.rssFaviconURL||"/favicon.svg").trim()}),dr=(j,P=100)=>[j?`https://q1.qlogo.cn/g?b=qq&nk=${j}&s=${P}`:"",j?`https://q2.qlogo.cn/g?b=qq&nk=${j}&s=${P}`:"",j?`https://q.qlogo.cn/g?b=qq&nk=${j}&s=${P}`:""].filter(Boolean),mi=j=>{const P=qi((j==null?void 0:j.mail)||""),q=String((j==null?void 0:j.nick)||"").trim();return dr(P)[0]||""||Ir(q||(j==null?void 0:j.mail)||"anonymous")||Hr.value||ur(q||(j==null?void 0:j.mail)||"")},ii=(j,P)=>{var Gt,Nn,Wn;const q=j.target,Q=((Gt=q==null?void 0:q.dataset)==null?void 0:Gt.mail)||"",we=String(((Nn=q==null?void 0:q.dataset)==null?void 0:Nn.qq)||""),xe=Number(((Wn=q==null?void 0:q.dataset)==null?void 0:Wn.try)||0),ot=dr(we);if(we&&xe<ot.length){const ri=Math.min(xe+1,ot.length-1),jn=ot[ri];q.dataset.try=String(ri),q.src=jn;return}const _t=Ir(P||Q||"anonymous")||Hr.value||ur(P||Q||"anonymous");q&&_t&&(q.src=_t)},xi=gn().public.baseApi||"/api",Nr=async()=>{var j,P;try{let q=1,Q=50,we=0;const xe=[];for(let ot=0;ot<3;ot++){const _t=await fetch(`${xi}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:q,pageSize:Q})});if(!_t.ok)break;const Gt=await _t.json().catch(()=>null),Nn=((j=Gt==null?void 0:Gt.data)==null?void 0:j.items)||[];we=Number(((P=Gt==null?void 0:Gt.data)==null?void 0:P.total)||0);const ri=Nn.map(Ot=>Ot.id).filter(Ot=>Ot!==se.value).map(async Ot=>{try{const $n=await fetch(`${xi}/messages/${Ot}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(!$n.ok)return[];const ai=await $n.json();return(Array.isArray(ai==null?void 0:ai.data)?ai.data:[]).map(Mi=>({id:Mi.id,nick:Mi.nick,mail:Mi.mail,content:Mi.content,created_at:Mi.created_at,message_id:Ot}))}catch{return[]}}),jn=await Promise.all(ri),ce=[].concat(...jn);xe.push(...ce);const qt=Math.max(1,Math.ceil(we/Q));if(xe.length>=24||q>=qt)break;q+=1}if(xe.sort((ot,_t)=>new Date(_t.created_at||0).getTime()-new Date(ot.created_at||0).getTime()),hn.value=xe.filter(ot=>ot.message_id!==se.value).filter(ot=>!Dr((ot==null?void 0:ot.content)||"")).map(ot=>({id:ot.id,nick:ot.nick,mail:ot.mail,content:ot.content})).slice(0,24),hn.value.length>0)return}catch{}hn.value=["期待","对方的","发个","困难","路口提示","测试","你好","加油","真不错","赞同","有趣","哈哈","有用","收藏","不错","灵感","记录"].map((q,Q)=>({id:Q+1,nick:"匿名",mail:"",content:q}))};zt(async()=>{await Nr(),Xi(()=>{pi.value=(pi.value+1)%Math.max(1,hn.value.length)},3e3)}),zt(()=>{var j,P;try{(P=(j=window.Fancybox)==null?void 0:j.bind)==null||P.call(j,"[data-fancybox]",{})}catch{}});const Wi=he(()=>Ht.value?"bg-[rgba(36,43,50,0.75)] text-white":"bg-slate-100 text-slate-800"),Ci=he(()=>Ht.value?"text-white":"text-slate-800");zt(()=>{const j=()=>pt();window.addEventListener("frontend-config-updated",j),pt(),X(),ze(),ut(),ci(()=>window.removeEventListener("frontend-config-updated",j))});const _i=async j=>{try{const P=encodeURIComponent(j.trim()),q=await Un(`messages/tags/${P}`,void 0,{credentials:"include"});if(q&&q.code===1&&Array.isArray(q.data))y.value&&y.value.handleSearchResult(q.data);else throw new Error((q==null?void 0:q.msg)||"获取标签内容失败")}catch(P){console.error("获取标签消息失败:",P),Ke().add({title:"获取标签消息失败",description:P.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},fr=()=>{if(!at.value)return;let j=0,P=!1,q=!1;const Q=Xi(()=>{if(!at.value){clearInterval(Q);return}q||(P?(j--,at.value.textContent=R.value.subtitleText.slice(0,j),j<=0&&(q=!0,at.value.textContent="",setTimeout(()=>{P=!1,q=!1,j=0},1e3))):(at.value.textContent=R.value.subtitleText.slice(0,j+1),j++,j>=R.value.subtitleText.length&&(q=!0,setTimeout(()=>{P=!0,q=!1},2e3))))},100);return Q};zt(async()=>{try{if(Bt.value=!1,window.requestIdleCallback=window.requestIdleCallback||(P=>setTimeout(P,1)),await pt(),R.value.musicEnabled&&await ne(),yo(async()=>{await X(),await ti(R.value.backgrounds)}),R.value.backgrounds.length>0){const P=R.value.backgrounds[Math.floor(Math.random()*R.value.backgrounds.length)],q=`${P}?imageView2/2/w/100/q/30`;$t.value=q,yo(async()=>{await ti(R.value.backgrounds)});const Q=new Image;Q.src=P,Q.onload=()=>{requestAnimationFrame(()=>{$t.value=P,Bt.value=!0})},Q.onerror=()=>{Bt.value=!0},setTimeout(()=>{Bt.value||(Bt.value=!0)},2e3)}const j=fr();ci(()=>{j&&clearInterval(j)}),window.addEventListener("frontend-config-updated",async P=>{var q;if(await pt(),((q=R.value.backgrounds)==null?void 0:q.length)>0){const Q=Math.floor(Math.random()*R.value.backgrounds.length),we=R.value.backgrounds[Q];$t.value=we}})}catch(j){console.error("初始化失败:",j),Bt.value=!0}}),G(new Date);const rt=G(new Date);let Ti=null;zt(()=>{Ti=Xi(()=>{rt.value=new Date},1e3)}),ci(()=>{Ti&&(clearInterval(Ti),Ti=null)});const hr=j=>{const P=String(j.getHours()).padStart(2,"0"),q=String(j.getMinutes()).padStart(2,"0"),Q=String(j.getSeconds()).padStart(2,"0");return`${P}:${q}:${Q}`},jr=j=>{const P=j.getFullYear(),q=String(j.getMonth()+1).padStart(2,"0"),Q=String(j.getDate()).padStart(2,"0"),we=["周日","周一","周二","周三","周四","周五","周六"][j.getDay()];return`${P}-${q}-${Q} ${we}`};return(j,P)=>{const q=fi,Q=Mr,we=Qu,xe=da,ot=td,_t=fa,Gt=hs,Nn=ad,Wn=Cc,ri=Ac,jn=ha;return J(),ae("div",{class:"background-container",style:wi(et.value)},[Bt.value?Me("",!0):(J(),ae("div",pp,P[25]||(P[25]=[I("div",{class:"rainbow-spinner"},null,-1),I("div",{class:"loading-text"},"加载中...",-1)]))),I("div",{ref_key:"contentWrapper",ref:an,class:be(["content-wrapper",{"gpu-accelerated":!0}])},[te(Nn,{class:"container-fixed py-2 pb-4 my-4"},{default:Ce(()=>[I("div",{class:be(["layout-container",S.value])},[te(ot,null,{default:Ce(()=>[!u.value&&d.value!=="single"?(J(),ae("div",mp,[te(xe,{class:be(["sidebar-card",Nt.value])},{default:Ce(()=>[I("div",gp,[I("div",vp,[I("img",{class:"avatar-lg",src:De.value,alt:Qe.value,onClick:Mn,onError:nt},null,40,bp),I("span",{class:be(["avatar-status",ye.value?"bg-green-500":"bg-gray-400"])},null,2)]),I("div",yp,qe(Qe.value),1),Ve.value?(J(),ae("div",wp,P[26]||(P[26]=[I("span",{class:"px-1.5 py-0.5 rounded bg-orange-500 text-white text-[10px]"},"管理员",-1)]))):Me("",!0),I("div",kp,qe(ct.value),1),ye.value?Me("",!0):(J(),ae("div",Ep,[te(we,{text:"登录"},{default:Ce(()=>[te(Q,{variant:"ghost",color:"indigo",class:"auth-btn",onClick:P[0]||(P[0]=ce=>{C.value="login",w.value=!0})},{default:Ce(()=>[te(q,{name:"i-heroicons-arrow-right-end-on-rectangle",class:"w-5 h-5"})]),_:1})]),_:1}),te(we,{text:"注册"},{default:Ce(()=>[te(Q,{variant:"ghost",color:"orange",class:"auth-btn",onClick:P[1]||(P[1]=ce=>{Re(),w.value=!0})},{default:Ce(()=>[te(q,{name:"i-heroicons-user-plus",class:"w-5 h-5"})]),_:1})]),_:1})]))])]),_:1},8,["class"]),te(xe,{class:be(["sidebar-card no-padding-card mt-2",Nt.value])},{default:Ce(()=>{var ce,qt,Ot,$n;return[I("div",Sp,[I("div",null,[I("div",xp,qe(((ce=$e.value)==null?void 0:ce.total_messages)??((qt=$e.value)==null?void 0:qt.TotalMessages)??0),1),P[27]||(P[27]=I("div",{class:"opacity-70"},"笔记数",-1))]),I("div",null,[I("div",Cp,qe(((Ot=Pt.value)==null?void 0:Ot.length)||0),1),P[28]||(P[28]=I("div",{class:"opacity-70"},"标签",-1))]),I("div",null,[I("div",_p,qe((($n=Ee.value)==null?void 0:$n.length)||0),1),P[29]||(P[29]=I("div",{class:"opacity-70"},"图片",-1))])])]}),_:1},8,["class"]),te(xe,{class:be(["sidebar-card no-padding-card mt-2",Nt.value])},{default:Ce(()=>[I("div",Tp,[(J(!0),ae(Ut,null,Qt(R.value.socialLinks||[],ce=>(J(),ae("a",{key:ce.url||ce.name,class:"social-item",href:ce.url,target:"_blank",rel:"noopener noreferrer","data-label":ce.name||ce.url},[ce.imageURL?(J(),ae("img",{key:0,src:ce.imageURL,alt:"icon",class:"social-icon-img"},null,8,Ap)):(J(),Lt(q,{key:1,name:mt(ce),class:"w-7 h-7"},null,8,["name"]))],8,Mp))),128))])]),_:1},8,["class"]),R.value.timeEnabled?(J(),Lt(xe,{key:0,class:be(["sidebar-card no-padding-card mt-2",Nt.value])},{default:Ce(()=>[I("div",Lp,[I("div",Dp,qe(hr(rt.value)),1),I("div",Op,qe(jr(rt.value)),1)])]),_:1},8,["class"])):Me("",!0),R.value.leftAdEnabled&&St.value.length>0?(J(),Lt(xe,{key:1,class:be(["sidebar-card mt-2",Nt.value])},{default:Ce(()=>[I("div",null,[St.value.length>0?(J(),ae("div",Pp,[I("a",{href:ni.value.linkURL||"#",target:"_blank",rel:"noopener noreferrer",class:"block ad-wrap group rounded-lg overflow-hidden",style:wi({"--ad-bg":`url(${Hn(ni.value.imageURL)})`})},[I("img",{src:Hn(ni.value.imageURL),alt:"ad",class:"ad-image w-full object-cover transition duration-200 rounded-lg"},null,8,Ip),I("div",Hp,[I("div",{class:be(["ad-overlay-box transition-colors duration-200",[Ht.value?"":"group-hover:text-orange-500"]])},qe((ni.value.description||"").trim()||"广告"),3)])],12,Rp),St.value.length>1?(J(),ae("div",Np,[(J(!0),ae(Ut,null,Qt(St.value,(ce,qt)=>(J(),ae("button",{key:qt,onClick:Ot=>qn.value=qt,class:be(["w-2 h-2 rounded-full",qt===qn.value?"bg-white":"bg-white/40"]),"aria-label":"switch-ad"},null,10,jp))),128))])):Me("",!0)])):Me("",!0)])]),_:1},8,["class"])):Me("",!0),R.value.hitokotoEnabled?(J(),Lt(xe,{key:2,class:be(["sidebar-card mt-2",Nt.value])},{default:Ce(()=>[P[30]||(P[30]=I("div",{class:"hidden"},[I("span",{id:"hitokoto"},"正在获取中...")],-1)),I("div",$p,[I("div",{class:"hitokoto-text",title:Kt.value||"正在获取中..."},[te(ki,{content:Kt.value||"正在获取中...",enableGithubCard:!1},null,8,["content"])],8,Bp)])]),_:1},8,["class"])):Me("",!0),d.value==="two"?(J(),ae("div",Up,[R.value.announcementEnabled&&(R.value.announcementText||"").trim()!==""?(J(),Lt(xe,{key:0,class:be(["sidebar-card",Nt.value])},{default:Ce(()=>[te(as,{text:R.value.announcementText||"欢迎访问我的说说笔记！"},null,8,["text"])]),_:1},8,["class"])):Me("",!0),te(xe,{class:be(["sidebar-card no-padding-card",Nt.value])},{default:Ce(()=>[I("div",null,[P[31]||(P[31]=I("div",{class:"text-xs opacity-70 mb-2"},"热门标签",-1)),I("div",zp,[I("div",Fp,[(J(!0),ae(Ut,null,Qt(Be.value,ce=>(J(),ae("button",{key:ce.name,class:"px-2 py-1 rounded text-xs border opacity-80 hover:opacity-100",onClick:qt=>_i(ce.name)},[gt("#"+qe(ce.name),1),I("span",qp,qe(ce.count),1)],8,Vp))),128))])])])]),_:1},8,["class"]),te(xe,{class:be(["sidebar-card no-padding-card",Nt.value])},{default:Ce(()=>[I("div",null,[P[32]||(P[32]=I("div",{class:"text-xs opacity-70 mb-2"},"图集",-1)),I("div",Wp,[I("div",Yp,[(J(!0),ae(Ut,null,Qt(Rt.value,ce=>(J(),ae("a",{key:ce.id||ce,href:tn(ce),"data-fancybox":"recommend-gallery",class:"block"},[I("img",{src:tn(ce),class:"recommend-image-box",loading:"lazy",alt:"recommend"},null,8,Gp)],8,Kp))),128))])])])]),_:1},8,["class"]),te(xe,{class:be(["sidebar-card no-padding-card",Nt.value])},{default:Ce(()=>[te(rs)]),_:1},8,["class"]),te(xe,{class:"sidebar-card no-padding-card"},{default:Ce(()=>[P[33]||(P[33]=I("div",{class:"text-xs opacity-70 mb-1"},"最新评论",-1)),I("div",Xp,[I("div",Zp,[(J(!0),ae(Ut,null,Qt(Or.value,(ce,qt)=>(J(),ae("div",{key:ce.id||qt,class:be(["inline-flex items-center gap-2 px-2 py-1 rounded-full",Wi.value])},[I("img",{src:mi(ce),"data-mail":ce.mail||"","data-qq":qi((ce==null?void 0:ce.mail)||""),"data-try":"0",class:"w-5 h-5 rounded-full object-cover",alt:"avatar",onError:Ot=>ii(Ot,ce.nick||"")},null,40,Jp),I("span",{class:be(["text-xs",Ci.value])},qe(Pr(ce.content)),3)],2))),128))])])]),_:1})])):Me("",!0)])):Me("",!0)]),_:1}),I("div",Qp,[I("div",{class:be(h.value)},[I("div",em,[I("div",{class:"header-image",style:wi(jt.value)},[I("h1",tm,qe(R.value.siteTitle||"说说笔记"),1),I("div",{class:"header-subtitle",ref_key:"subtitleEl",ref:at},null,512),I("div",nm,[(J(),ae(Ut,null,Qt(f,ce=>I("button",{key:ce.key,class:be(["hero-tab",b.value===ce.key?"active":""]),onClick:qt=>b.value=ce.key},qe(ce.name),11,im)),64))])],4)]),b.value==="links"?(J(),ae("div",rm,[te(xe,{class:"search-card mb-3",ui:{body:"p-3 md:p-4"}},{default:Ce(()=>[I("div",{class:be(["card-title text-center",Ht.value?"text-white":"text-black"])},qe(R.value.linksTitle||"友情链接"),3),(R.value.linksDescription||"").trim()!==""?(J(),ae("div",am,qe(R.value.linksDescription),1)):Me("",!0),fn.value.length>0?(J(),ae("div",om,[I("div",sm,[(J(!0),ae(Ut,null,Qt(fn.value,ce=>(J(),ae("a",{key:ce.link||ce.title,href:ce.link,target:"_blank",rel:"noopener noreferrer",class:be(["link-card",Ht.value?"link-card-dark":"link-card-light"])},[te(q,{name:mt({url:ce.link,icon:ce.icon}),class:"w-7 h-7"},null,8,["name"]),I("div",cm,[I("div",um,qe(ce.title),1),ce.description?(J(),ae("div",dm,qe(ce.description),1)):Me("",!0)])],10,lm))),128))])])):Me("",!0),(R.value.linksApplyTitle||"").trim()!==""||(R.value.linksApplyText||"").trim()!==""?(J(),ae("div",fm,[I("div",{class:be(["text-sm font-medium text-center mb-1",Ht.value?"text-white":"text-black"])},qe(R.value.linksApplyTitle||"申请友链须知"),3),I("div",{class:be(["apply-text",Ht.value?"text-white/80":"text-black/70"])},qe((R.value.linksApplyText||"").trim()),3)])):Me("",!0),I("div",hm,[P[35]||(P[35]=I("div",{class:"text-center text-xs opacity-70 mb-2"},"提交后需管理员审核",-1)),I("div",pm,[te(_t,{modelValue:ve(yt).title,"onUpdate:modelValue":P[2]||(P[2]=ce=>ve(yt).title=ce),placeholder:"站点名称（可选）"},null,8,["modelValue"]),te(_t,{modelValue:ve(yt).link,"onUpdate:modelValue":P[3]||(P[3]=ce=>ve(yt).link=ce),placeholder:"网址（必填，如 https://example.com）"},null,8,["modelValue"]),te(_t,{modelValue:ve(yt).icon,"onUpdate:modelValue":P[4]||(P[4]=ce=>ve(yt).icon=ce),placeholder:"图标标识（可选，例如 i-mdi-home）"},null,8,["modelValue"]),te(_t,{modelValue:ve(yt).email,"onUpdate:modelValue":P[5]||(P[5]=ce=>ve(yt).email=ce),placeholder:"邮箱（用于通知，可选）"},null,8,["modelValue"]),te(Gt,{modelValue:ve(yt).description,"onUpdate:modelValue":P[6]||(P[6]=ce=>ve(yt).description=ce),rows:2,placeholder:"简介（可选）",class:"sm:col-span-2"},null,8,["modelValue"])]),I("div",mm,[te(Q,{loading:wt.value,color:"primary",onClick:wn},{default:Ce(()=>P[34]||(P[34]=[gt("提交申请")])),_:1},8,["loading"])])])]),_:1})])):b.value==="comment"?(J(),ae("div",gm,[te(xe,{class:"search-card mb-3",ui:{body:"p-5"}},{default:Ce(()=>[I("div",{class:be(["card-title text-center mb-3",Ht.value?"text-white":"text-black"])},qe(R.value.commentPageTitle||"留言"),3),(R.value.commentPageDescription||"").trim()!==""?(J(),ae("div",vm,qe(R.value.commentPageDescription),1)):Me("",!0),I("div",bm,[se.value?(J(),Lt(Ks,{key:0,"message-id":se.value,"site-config":R.value,"show-input":!0},null,8,["message-id","site-config"])):(J(),ae("div",ym,"正在准备留言板..."))])]),_:1})])):b.value==="about"?(J(),ae("div",wm,[te(xe,{class:"search-card mb-3",ui:{body:"p-6"}},{default:Ce(()=>[I("div",{class:be(["card-title text-center",Ht.value?"text-white":"text-black"])},qe(R.value.aboutPageTitle||"关于本站"),3),(R.value.aboutPageDescription||"").trim()!==""?(J(),ae("div",km,qe(R.value.aboutPageDescription),1)):Me("",!0),I("div",Em,[te(ki,{content:(R.value.aboutMarkdown||"").trim()||ge.aboutMarkdown},null,8,["content"])])]),_:1})])):(J(),ae(Ut,{key:3},[te(uf,{onSearchResult:ke,"hide-header-tools":d.value==="three",wide:d.value==="two"},null,8,["hide-header-tools","wide"]),I("div",Sm,[Pt.value&&Pt.value.length>0?(J(),Lt(ap,{key:0,tags:Pt.value,onTagClick:_i,onUpdateTags:Y},null,8,["tags"])):Me("",!0)]),te(Yh,{ref_key:"messageList",ref:y,class:"message-list-container","site-config":R.value,"target-message-id":Z.value,wide:d.value==="two"},null,8,["site-config","target-message-id","wide"])],64)),I("div",{class:"page-footer",innerHTML:R.value.pageFooterHTML||ge.pageFooterHTML},null,8,xm)],2)]),te(ot,null,{default:Ce(()=>[!u.value&&d.value==="three"?(J(),ae("div",Cm,[R.value.announcementEnabled&&(R.value.announcementText||"").trim()!==""?(J(),Lt(xe,{key:0,class:be(["sidebar-card",Nt.value])},{default:Ce(()=>[te(as,{text:R.value.announcementText||"欢迎访问我的说说笔记！"},null,8,["text"])]),_:1},8,["class"])):Me("",!0),te(xe,{class:be(["sidebar-card no-padding-card",Nt.value])},{default:Ce(()=>[I("div",null,[P[36]||(P[36]=I("div",{class:"text-xs opacity-70 mb-2"},"热门标签",-1)),I("div",_m,[I("div",Tm,[(J(!0),ae(Ut,null,Qt(Be.value,ce=>(J(),ae("button",{key:ce.name,class:"px-2 py-1 rounded text-xs border opacity-80 hover:opacity-100",onClick:qt=>_i(ce.name)},[gt("#"+qe(ce.name),1),I("span",Am,qe(ce.count),1)],8,Mm))),128))])])])]),_:1},8,["class"]),te(xe,{class:be(["sidebar-card no-padding-card",Nt.value])},{default:Ce(()=>[I("div",null,[I("div",Lm,"最新图集（"+qe(Rt.value.length)+"）",1),I("div",Dm,[I("div",Om,[(J(!0),ae(Ut,null,Qt(Rt.value,ce=>(J(),ae("a",{key:ce.id||ce,href:tn(ce),"data-fancybox":"recommend-gallery",class:"block"},[I("img",{src:tn(ce),class:"recommend-image-box",loading:"lazy",alt:"recommend"},null,8,Rm)],8,Pm))),128))])])])]),_:1},8,["class"]),te(xe,{class:be(["sidebar-card no-padding-card",Nt.value])},{default:Ce(()=>[te(rs)]),_:1},8,["class"]),te(xe,{class:be(["sidebar-card mt-2 no-padding-card",Nt.value])},{default:Ce(()=>[P[37]||(P[37]=I("div",{class:"text-xs opacity-70 mb-1"},"最新评论",-1)),I("div",Im,[I("div",Hm,[(J(!0),ae(Ut,null,Qt(Or.value,(ce,qt)=>(J(),ae("div",{key:ce.id||qt,class:be(["inline-flex items-center gap-2 px-2 py-1 rounded-full",Wi.value])},[I("img",{src:mi(ce),"data-mail":ce.mail||"","data-qq":qi((ce==null?void 0:ce.mail)||""),"data-try":"0",class:"w-5 h-5 rounded-full object-cover",alt:"avatar",onError:Ot=>ii(Ot,ce.nick||"")},null,40,Nm),I("span",{class:be(["text-xs",Ci.value])},qe(Pr(ce.content)),3)],2))),128))])])]),_:1},8,["class"])])):Me("",!0)]),_:1})],2),Me("",!0),R.value.musicEnabled?(J(),ae("div",{key:1,class:"netease-mini-player","data-playlist-id":R.value.musicPlaylistId||"","data-song-id":R.value.musicSongId||"","data-position":R.value.musicPosition||"bottom-left","data-theme":R.value.musicTheme||"auto","data-lyric":R.value.musicLyric?"true":"false","data-default-minimized":R.value.musicDefaultMinimized?"true":"false","data-embed":R.value.musicEmbed?"true":"false","data-autoplay":R.value.musicAutoplay?"true":"false"},null,8,jm)):Me("",!0)]),_:1}),te(Mc),te(Ys,{modelValue:E.value,"onUpdate:modelValue":P[7]||(P[7]=ce=>E.value=ce),onSearchResult:ke},null,8,["modelValue"]),te(hp,{"content-theme":ft.value,"layout-icon":k.value,onSearch:P[8]||(P[8]=ce=>E.value=!0),onSwitchBackground:Mn,onToggleTheme:_n,onToggleLayout:g,onOpenAdmin:re},null,8,["content-theme","layout-icon"]),te(jn,{modelValue:w.value,"onUpdate:modelValue":P[19]||(P[19]=ce=>w.value=ce),ui:{width:"sm:max-w-md",container:"items-center",base:"backdrop-blur-sm"}},{default:Ce(()=>[te(xe,{class:"search-card"},{header:Ce(()=>[I("div",$m,[I("h3",Bm,qe(C.value==="login"?"欢迎回来":"创建账户"),1),I("div",Um,[C.value==="login"?(J(),Lt(Q,{key:0,variant:"link",color:"orange",onClick:Re},{default:Ce(()=>P[41]||(P[41]=[gt("去注册")])),_:1})):(J(),Lt(Q,{key:1,variant:"link",color:"orange",onClick:Je},{default:Ce(()=>P[42]||(P[42]=[gt("去登录")])),_:1})),te(Q,{icon:"i-mdi-close",variant:"ghost",color:"gray",onClick:tt})])])]),default:Ce(()=>[I("div",zm,[C.value==="login"?(J(),ae("div",Fm,[te(Wn,{onSubmit:rr(U,["prevent"])},{default:Ce(()=>[I("div",Vm,[te(_t,{modelValue:ve(_).username,"onUpdate:modelValue":P[9]||(P[9]=ce=>ve(_).username=ce),placeholder:"用户名或邮箱"},null,8,["modelValue"]),te(_t,{modelValue:ve(_).password,"onUpdate:modelValue":P[12]||(P[12]=ce=>ve(_).password=ce),type:M.value?"text":"password",placeholder:"密码",autocomplete:"current-password",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},{trailing:Ce(()=>[M.value?(J(),Lt(Q,{key:1,icon:"i-heroicons-eye-slash",variant:"ghost",color:"gray",onClick:P[11]||(P[11]=ce=>M.value=!1),ui:{rounded:"rounded-full"}})):(J(),Lt(Q,{key:0,icon:"i-heroicons-eye",variant:"ghost",color:"gray",onClick:P[10]||(P[10]=ce=>M.value=!0),ui:{rounded:"rounded-full"}}))]),_:1},8,["modelValue","type"]),te(Q,{class:"w-full",loading:D.value,disabled:D.value,type:"submit",color:"primary"},{default:Ce(()=>P[43]||(P[43]=[gt("登录")])),_:1},8,["loading","disabled"])])]),_:1}),I("div",qm,[te(Q,{variant:"link",onClick:Re},{default:Ce(()=>P[44]||(P[44]=[gt("账号注册")])),_:1}),te(Q,{variant:"link",onClick:P[13]||(P[13]=ce=>F.value=!0)},{default:Ce(()=>P[45]||(P[45]=[gt("忘记密码？")])),_:1})]),Te.value?(J(),ae("div",Wm,"其他登录方式")):Me("",!0),Te.value?(J(),ae("div",Ym,[te(Q,{class:"w-full h-10 px-3 gap-2 justify-center font-medium bg-[#24292f] hover:bg-[#1f2328] text-white ring-1 ring-black/20",onClick:Ae},{default:Ce(()=>[te(q,{name:"i-mdi-github",class:"w-5 h-5"}),P[46]||(P[46]=I("span",null,"GitHub 一键登录",-1))]),_:1})])):Me("",!0)])):(J(),ae("div",Km,[te(Wn,{onSubmit:rr(oe,["prevent"])},{default:Ce(()=>[I("div",Gm,[te(_t,{modelValue:ve(T).username,"onUpdate:modelValue":P[14]||(P[14]=ce=>ve(T).username=ce),placeholder:"用户名"},null,8,["modelValue"]),te(_t,{modelValue:ve(T).password,"onUpdate:modelValue":P[17]||(P[17]=ce=>ve(T).password=ce),type:v.value?"text":"password",placeholder:"密码",autocomplete:"new-password",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},{trailing:Ce(()=>[v.value?(J(),Lt(Q,{key:1,icon:"i-heroicons-eye-slash",variant:"ghost",color:"gray",onClick:P[16]||(P[16]=ce=>v.value=!1),ui:{rounded:"rounded-full"}})):(J(),Lt(Q,{key:0,icon:"i-heroicons-eye",variant:"ghost",color:"gray",onClick:P[15]||(P[15]=ce=>v.value=!0),ui:{rounded:"rounded-full"}}))]),_:1},8,["modelValue","type"]),I("div",Xm,[te(_t,{modelValue:ve(T).captcha,"onUpdate:modelValue":P[18]||(P[18]=ce=>ve(T).captcha=ce),placeholder:"验证码"},null,8,["modelValue"]),I("img",{src:V.value,onClick:Le,class:"h-10 w-24 rounded border cursor-pointer",alt:"captcha"},null,8,Zm),te(ri,{color:H.value>0?"primary":"red",variant:"soft"},{default:Ce(()=>[gt(qe(H.value>0?`有效 ${H.value}s`:"已过期"),1)]),_:1},8,["color"])]),te(Q,{class:"w-full",loading:N.value,disabled:H.value<=0||N.value,type:"submit",color:"primary"},{default:Ce(()=>[gt(qe(H.value>0?"注册":"验证码已过期"),1)]),_:1},8,["loading","disabled"])])]),_:1})]))])]),_:1})]),_:1},8,["modelValue"]),te(jn,{modelValue:F.value,"onUpdate:modelValue":P[22]||(P[22]=ce=>F.value=ce),ui:{container:"items-center",base:"backdrop-blur-sm"}},{default:Ce(()=>[te(xe,{class:"search-card"},{default:Ce(()=>[P[48]||(P[48]=I("div",{class:"font-semibold mb-2"},"找回密码",-1)),te(Wn,{onSubmit:rr(Ge,["prevent"])},{default:Ce(()=>[I("div",Jm,[te(_t,{modelValue:ve(le).account,"onUpdate:modelValue":P[20]||(P[20]=ce=>ve(le).account=ce),placeholder:"用户名或邮箱"},null,8,["modelValue"]),I("div",Qm,[te(Q,{variant:"ghost",onClick:P[21]||(P[21]=ce=>F.value=!1)},{default:Ce(()=>P[47]||(P[47]=[gt("取消")])),_:1}),te(Q,{disabled:de.value>0||!Ue.value,type:"submit",color:"primary"},{default:Ce(()=>[gt(qe(Ue.value?de.value>0?`请稍候(${de.value}s)`:"发送重置邮件":"邮件未开启"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),I("div",{class:"scroll-buttons",onMouseenter:P[23]||(P[23]=ce=>sn.value=!0),onMouseleave:P[24]||(P[24]=ce=>sn.value=!1)},[Ii(te(Q,{class:be(Vt.value),variant:"ghost",size:"sm",onClick:ei},{default:Ce(()=>[te(q,{class:be(W.value),name:Dt.value},null,8,["class","name"])]),_:1},8,["class"]),[[fs,Ft.value]])],32)],512)],4)}}});export{lg as default};
