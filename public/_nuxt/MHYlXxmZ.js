var lc=Object.defineProperty;var cc=(p,e,r)=>e in p?lc(p,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):p[e]=r;var Mi=(p,e,r)=>cc(p,typeof e!="symbol"?e+"":e,r);import{s as uc,u as dc,a as sr,r as G,b as fc,t as Pr,g as hc,o as pc,c as li,w as xt,d as wo,e as mc,f as gc,h as we,i as ge,j as Pi,k as _r,l as vc,m as Xa,n as cr,_ as Mn,p as rn,q as oe,v as Z,x as la,y as mt,z as Fe,A as ca,B as Za,C as cs,D as us,E as Ht,F as bc,G as Oe,H as ke,I as ie,J as Me,K as I,L as It,M as Jt,N as Lt,T as yc,O as wc,P as kc,Q as Mr,R as Ec,S as ds,U as We,V as zn,W as vt,X as Er,Y as Hi,Z as fs,$ as gn,a0 as ji,a1 as pa,a2 as di,a3 as hs,a4 as Ir,a5 as bi,a6 as lr,a7 as $i,a8 as Zn,a9 as Ri,aa as qr,ab as xc,ac as ps,ad as xa,ae as ms,af as Sc,ag as ko,ah as Eo}from"./BBBtd_Ly.js";import{u as xo,_ as ma,a as Cc}from"./uRvDbVn5.js";import{_ as _c,a as Tc,b as gs,N as Mc}from"./jUHVuQk-.js";import{_ as Ac}from"./CNnyWLvS.js";import{_ as ga}from"./XOvRLRgc.js";import{s as er}from"./x_rD_Ya3.js";const Lc=[1779033703,-1150833019,1013904242,-1521486534,1359893119,-1694144372,528734635,1541459225],Dc=[1116352408,1899447441,-1245643825,-373957723,961987163,1508970993,-1841331548,-1424204075,-670586216,310598401,607225278,1426881987,1925078388,-2132889090,-1680079193,-1046744716,-459576895,-272742522,264347078,604807628,770255983,1249150122,1555081692,1996064986,-1740746414,-1473132947,-1341970488,-1084653625,-958395405,-710438585,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,-2117940946,-1838011259,-1564481375,-1474664885,-1035236496,-949202525,-778901479,-694614492,-200395387,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,-2067236844,-1933114872,-1866530822,-1538233109,-1090935817,-965641998],Oc="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",Ai=[];let Pc=class{constructor(){Mi(this,"_data",new Wr);Mi(this,"_hash",new Wr([...Lc]));Mi(this,"_nDataBytes",0);Mi(this,"_minBufferSize",0)}finalize(e){e&&this._append(e);const r=this._nDataBytes*8,s=this._data.sigBytes*8;return this._data.words[s>>>5]|=128<<24-s%32,this._data.words[(s+64>>>9<<4)+14]=Math.floor(r/4294967296),this._data.words[(s+64>>>9<<4)+15]=r,this._data.sigBytes=this._data.words.length*4,this._process(),this._hash}_doProcessBlock(e,r){const s=this._hash.words;let l=s[0],d=s[1],m=s[2],u=s[3],g=s[4],x=s[5],k=s[6],h=s[7];for(let f=0;f<64;f++){if(f<16)Ai[f]=e[r+f]|0;else{const T=Ai[f-15],M=(T<<25|T>>>7)^(T<<14|T>>>18)^T>>>3,v=Ai[f-2],D=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;Ai[f]=M+Ai[f-7]+D+Ai[f-16]}const b=g&x^~g&k,y=l&d^l&m^d&m,E=(l<<30|l>>>2)^(l<<19|l>>>13)^(l<<10|l>>>22),w=(g<<26|g>>>6)^(g<<21|g>>>11)^(g<<7|g>>>25),C=h+w+b+Dc[f]+Ai[f],_=E+y;h=k,k=x,x=g,g=u+C|0,u=m,m=d,d=l,l=C+_|0}s[0]=s[0]+l|0,s[1]=s[1]+d|0,s[2]=s[2]+m|0,s[3]=s[3]+u|0,s[4]=s[4]+g|0,s[5]=s[5]+x|0,s[6]=s[6]+k|0,s[7]=s[7]+h|0}_append(e){typeof e=="string"&&(e=Wr.fromUtf8(e)),this._data.concat(e),this._nDataBytes+=e.sigBytes}_process(e){let r,s=this._data.sigBytes/64;e?s=Math.ceil(s):s=Math.max((s|0)-this._minBufferSize,0);const l=s*16,d=Math.min(l*4,this._data.sigBytes);if(l){for(let m=0;m<l;m+=16)this._doProcessBlock(this._data.words,m);r=this._data.words.splice(0,l),this._data.sigBytes-=d}return new Wr(r,d)}},Wr=class vs{constructor(e,r){Mi(this,"words");Mi(this,"sigBytes");e=this.words=e||[],this.sigBytes=r===void 0?e.length*4:r}static fromUtf8(e){const r=unescape(encodeURIComponent(e)),s=r.length,l=[];for(let d=0;d<s;d++)l[d>>>2]|=(r.charCodeAt(d)&255)<<24-d%4*8;return new vs(l,s)}toBase64(){const e=[];for(let r=0;r<this.sigBytes;r+=3){const s=this.words[r>>>2]>>>24-r%4*8&255,l=this.words[r+1>>>2]>>>24-(r+1)%4*8&255,d=this.words[r+2>>>2]>>>24-(r+2)%4*8&255,m=s<<16|l<<8|d;for(let u=0;u<4&&r*8+u*6<this.sigBytes*8;u++)e.push(Oc.charAt(m>>>6*(3-u)&63))}return e.join("")}concat(e){if(this.words[this.sigBytes>>>2]&=4294967295<<32-this.sigBytes%4*8,this.words.length=Math.ceil(this.sigBytes/4),this.sigBytes%4)for(let r=0;r<e.sigBytes;r++){const s=e.words[r>>>2]>>>24-r%4*8&255;this.words[this.sigBytes+r>>>2]|=s<<24-(this.sigBytes+r)%4*8}else for(let r=0;r<e.sigBytes;r+=4)this.words[this.sigBytes+r>>>2]=e.words[r>>>2];this.sigBytes+=e.sigBytes}};function Rc(p){return new Pc().finalize(p).toBase64()}function Ic(p){return Rc(uc(p))}const Hc=p=>p==="defer"||p===!1;function Nc(...p){var E;const e=typeof p[p.length-1]=="string"?p.pop():void 0;typeof p[0]!="string"&&p.unshift(e);let[r,s,l={}]=p;if(typeof r!="string")throw new TypeError("[nuxt] [asyncData] key must be a string.");if(typeof s!="function")throw new TypeError("[nuxt] [asyncData] handler must be a function.");const d=dc(),m=s,u=()=>sr.value,g=()=>d.isHydrating?d.payload.data[r]:d.static.data[r];l.server??(l.server=!0),l.default??(l.default=u),l.getCachedData??(l.getCachedData=g),l.lazy??(l.lazy=!1),l.immediate??(l.immediate=!0),l.deep??(l.deep=sr.deep),l.dedupe??(l.dedupe="cancel");const x=l.getCachedData(r,d),k=x!=null;if(!d._asyncData[r]||!l.immediate){(E=d.payload._errors)[r]??(E[r]=sr.errorValue);const w=l.deep?G:fc;d._asyncData[r]={data:w(k?x:l.default()),pending:G(!k),error:Pr(d.payload._errors,r),status:G("idle"),_default:l.default}}const h={...d._asyncData[r]};delete h._default,h.refresh=h.execute=(w={})=>{if(d._asyncDataPromises[r]){if(Hc(w.dedupe??l.dedupe))return d._asyncDataPromises[r];d._asyncDataPromises[r].cancelled=!0}if(w._initial||d.isHydrating&&w._initial!==!1){const _=w._initial?x:l.getCachedData(r,d);if(_!=null)return Promise.resolve(_)}h.pending.value=!0,h.status.value="pending";const C=new Promise((_,T)=>{try{_(m(d))}catch(M){T(M)}}).then(async _=>{if(C.cancelled)return d._asyncDataPromises[r];let T=_;l.transform&&(T=await l.transform(_)),l.pick&&(T=$c(T,l.pick)),d.payload.data[r]=T,h.data.value=T,h.error.value=sr.errorValue,h.status.value="success"}).catch(_=>{if(C.cancelled)return d._asyncDataPromises[r];h.error.value=gc(_),h.data.value=we(l.default()),h.status.value="error"}).finally(()=>{C.cancelled||(h.pending.value=!1,delete d._asyncDataPromises[r])});return d._asyncDataPromises[r]=C,d._asyncDataPromises[r]},h.clear=()=>jc(d,r);const f=()=>h.refresh({_initial:!0}),b=l.server!==!1&&d.payload.serverRendered;{const w=hc();if(w&&b&&l.immediate&&!w.sp&&(w.sp=[]),w&&!w._nuxtOnBeforeMountCbs){w._nuxtOnBeforeMountCbs=[];const T=w._nuxtOnBeforeMountCbs;pc(()=>{T.forEach(M=>{M()}),T.splice(0,T.length)}),li(()=>T.splice(0,T.length))}b&&d.isHydrating&&(h.error.value||x!=null)?(h.pending.value=!1,h.status.value=h.error.value?"error":"success"):w&&(d.payload.serverRendered&&d.isHydrating||l.lazy)&&l.immediate?w._nuxtOnBeforeMountCbs.push(f):l.immediate&&f();const C=mc();if(l.watch){const T=xt(l.watch,()=>h.refresh());C&&wo(T)}const _=d.hook("app:data:refresh",async T=>{(!T||T.includes(r))&&await h.refresh()});C&&wo(_)}const y=Promise.resolve(d._asyncDataPromises[r]).then(()=>h);return Object.assign(y,h),y}function jc(p,e){e in p.payload.data&&(p.payload.data[e]=void 0),e in p.payload._errors&&(p.payload._errors[e]=sr.errorValue),p._asyncData[e]&&(p._asyncData[e].data.value=void 0,p._asyncData[e].error.value=sr.errorValue,p._asyncData[e].pending.value=!1,p._asyncData[e].status.value="idle"),e in p._asyncDataPromises&&(p._asyncDataPromises[e]&&(p._asyncDataPromises[e].cancelled=!0),p._asyncDataPromises[e]=void 0)}function $c(p,e){const r={};for(const s of e)r[s]=p[s];return r}function Bc(p,e,r){const[s={},l]=typeof e=="string"?[{},e]:[e,r],d=ge(()=>Pi(p)),m=s.key||Ic([l,typeof d.value=="string"?d.value:"",...Uc(s)]);if(!m||typeof m!="string")throw new TypeError("[nuxt] [useFetch] key must be a string: "+m);const u=m===l?"$f"+m:m;if(!s.baseURL&&typeof d.value=="string"&&d.value[0]==="/"&&d.value[1]==="/")throw new Error('[nuxt] [useFetch] the request URL must not start with "//".');const{server:g,lazy:x,default:k,transform:h,pick:f,watch:b,immediate:y,getCachedData:E,deep:w,dedupe:C,..._}=s,T=_r({...vc,..._,cache:typeof s.cache=="boolean"?void 0:s.cache}),M={server:g,lazy:x,default:k,transform:h,pick:f,immediate:y,getCachedData:E,deep:w,dedupe:C,watch:b===!1?[]:[T,d,...b||[]]};let v;return Nc(u,()=>{var Y;(Y=v==null?void 0:v.abort)==null||Y.call(v,new DOMException("Request aborted as another request to the same endpoint was initiated.","AbortError")),v=typeof AbortController<"u"?new AbortController:{};const N=Pi(s.timeout);let z;return N&&(z=setTimeout(()=>v.abort(new DOMException("Request aborted due to timeout.","AbortError")),N),v.signal.onabort=()=>clearTimeout(z)),(s.$fetch||globalThis.$fetch)(d.value,{signal:v.signal,...T}).finally(()=>{clearTimeout(z)})},M)}function Uc(p){var r;const e=[((r=Pi(p.method))==null?void 0:r.toUpperCase())||"GET",Pi(p.baseURL)];for(const s of[p.params||p.query]){const l=Pi(s);if(!l)continue;const d={};for(const[m,u]of Object.entries(l))d[Pi(m)]=Pi(u);e.push(d)}return e}const zc={base:"invisible before:visible before:block before:rotate-45 before:z-[-1] before:w-2 before:h-2",ring:"before:ring-1 before:ring-gray-200 dark:before:ring-gray-800",rounded:"before:rounded-sm",background:"before:bg-gray-200 dark:before:bg-gray-800",shadow:"before:shadow",placement:"group-data-[popper-placement*='right']:-left-1 group-data-[popper-placement*='left']:-right-1 group-data-[popper-placement*='top']:-bottom-1 group-data-[popper-placement*='bottom']:-top-1"},Fc={base:"inline-flex items-center justify-center text-gray-900 dark:text-white",padding:"px-1",size:{xs:"h-4 min-w-[16px] text-[10px]",sm:"h-5 min-w-[20px] text-[11px]",md:"h-6 min-w-[24px] text-[12px]"},rounded:"rounded",font:"font-medium font-sans",background:"bg-gray-100 dark:bg-gray-800",ring:"ring-1 ring-gray-300 dark:ring-gray-700 ring-inset",default:{size:"sm"}},Vc={base:"mx-auto",padding:"px-4 sm:px-6 lg:px-8",constrained:"max-w-7xl"},qc={wrapper:"relative inline-flex",container:"z-20 group",width:"max-w-xs",background:"bg-white dark:bg-gray-900",color:"text-gray-900 dark:text-white",shadow:"shadow",rounded:"rounded",ring:"ring-1 ring-gray-200 dark:ring-gray-800",base:"[@media(pointer:coarse)]:hidden h-6 px-2 py-1 text-xs font-normal truncate relative",shortcuts:"hidden md:inline-flex flex-shrink-0 gap-0.5",middot:"mx-1 text-gray-700 dark:text-gray-200",transition:{enterActiveClass:"transition ease-out duration-200",enterFromClass:"opacity-0 translate-y-1",enterToClass:"opacity-100 translate-y-0",leaveActiveClass:"transition ease-in duration-150",leaveFromClass:"opacity-100 translate-y-0",leaveToClass:"opacity-0 translate-y-1"},popper:{strategy:"fixed"},default:{openDelay:0,closeDelay:0},arrow:{...zc,base:"[@media(pointer:coarse)]:hidden invisible before:visible before:block before:rotate-45 before:z-[-1] before:w-2 before:h-2"}},Sa=Xa(cr.ui.strategy,cr.ui.kbd,Fc),Wc=rn({inheritAttrs:!1,props:{value:{type:String,default:null},size:{type:String,default:()=>Sa.default.size,validator(p){return Object.keys(Sa.size).includes(p)}},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(p){const{ui:e,attrs:r}=Za("kbd",Pr(p,"ui"),Sa),s=ge(()=>cs(us(e.value.base,e.value.size[p.size],e.value.padding,e.value.rounded,e.value.font,e.value.background,e.value.ring),p.class));return{ui:e,attrs:r,kbdClass:s}}});function Yc(p,e,r,s,l,d){return Z(),oe("kbd",ca({class:p.kbdClass},p.attrs),[la(p.$slots,"default",{},()=>[mt(Fe(p.value),1)])],16)}const bs=Mn(Wc,[["render",Yc]]);function Tn(p){if(p==null)return window;if(p.toString()!=="[object Window]"){var e=p.ownerDocument;return e&&e.defaultView||window}return p}function zi(p){var e=Tn(p).Element;return p instanceof e||p instanceof Element}function Rn(p){var e=Tn(p).HTMLElement;return p instanceof e||p instanceof HTMLElement}function Ja(p){if(typeof ShadowRoot>"u")return!1;var e=Tn(p).ShadowRoot;return p instanceof e||p instanceof ShadowRoot}var Bi=Math.max,ua=Math.min,ur=Math.round;function qa(){var p=navigator.userAgentData;return p!=null&&p.brands&&Array.isArray(p.brands)?p.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function ys(){return!/^((?!chrome|android).)*safari/i.test(qa())}function dr(p,e,r){e===void 0&&(e=!1),r===void 0&&(r=!1);var s=p.getBoundingClientRect(),l=1,d=1;e&&Rn(p)&&(l=p.offsetWidth>0&&ur(s.width)/p.offsetWidth||1,d=p.offsetHeight>0&&ur(s.height)/p.offsetHeight||1);var m=zi(p)?Tn(p):window,u=m.visualViewport,g=!ys()&&r,x=(s.left+(g&&u?u.offsetLeft:0))/l,k=(s.top+(g&&u?u.offsetTop:0))/d,h=s.width/l,f=s.height/d;return{width:h,height:f,top:k,right:x+h,bottom:k+f,left:x,x,y:k}}function Qa(p){var e=Tn(p),r=e.pageXOffset,s=e.pageYOffset;return{scrollLeft:r,scrollTop:s}}function Kc(p){return{scrollLeft:p.scrollLeft,scrollTop:p.scrollTop}}function Gc(p){return p===Tn(p)||!Rn(p)?Qa(p):Kc(p)}function ti(p){return p?(p.nodeName||"").toLowerCase():null}function wi(p){return((zi(p)?p.ownerDocument:p.document)||window.document).documentElement}function eo(p){return dr(wi(p)).left+Qa(p).scrollLeft}function ui(p){return Tn(p).getComputedStyle(p)}function to(p){var e=ui(p),r=e.overflow,s=e.overflowX,l=e.overflowY;return/auto|scroll|overlay|hidden/.test(r+l+s)}function Xc(p){var e=p.getBoundingClientRect(),r=ur(e.width)/p.offsetWidth||1,s=ur(e.height)/p.offsetHeight||1;return r!==1||s!==1}function Zc(p,e,r){r===void 0&&(r=!1);var s=Rn(e),l=Rn(e)&&Xc(e),d=wi(e),m=dr(p,l,r),u={scrollLeft:0,scrollTop:0},g={x:0,y:0};return(s||!s&&!r)&&((ti(e)!=="body"||to(d))&&(u=Gc(e)),Rn(e)?(g=dr(e,!0),g.x+=e.clientLeft,g.y+=e.clientTop):d&&(g.x=eo(d))),{x:m.left+u.scrollLeft-g.x,y:m.top+u.scrollTop-g.y,width:m.width,height:m.height}}function no(p){var e=dr(p),r=p.offsetWidth,s=p.offsetHeight;return Math.abs(e.width-r)<=1&&(r=e.width),Math.abs(e.height-s)<=1&&(s=e.height),{x:p.offsetLeft,y:p.offsetTop,width:r,height:s}}function va(p){return ti(p)==="html"?p:p.assignedSlot||p.parentNode||(Ja(p)?p.host:null)||wi(p)}function ws(p){return["html","body","#document"].indexOf(ti(p))>=0?p.ownerDocument.body:Rn(p)&&to(p)?p:ws(va(p))}function Ar(p,e){var r;e===void 0&&(e=[]);var s=ws(p),l=s===((r=p.ownerDocument)==null?void 0:r.body),d=Tn(s),m=l?[d].concat(d.visualViewport||[],to(s)?s:[]):s,u=e.concat(m);return l?u:u.concat(Ar(va(m)))}function Jc(p){return["table","td","th"].indexOf(ti(p))>=0}function So(p){return!Rn(p)||ui(p).position==="fixed"?null:p.offsetParent}function Qc(p){var e=/firefox/i.test(qa()),r=/Trident/i.test(qa());if(r&&Rn(p)){var s=ui(p);if(s.position==="fixed")return null}var l=va(p);for(Ja(l)&&(l=l.host);Rn(l)&&["html","body"].indexOf(ti(l))<0;){var d=ui(l);if(d.transform!=="none"||d.perspective!=="none"||d.contain==="paint"||["transform","perspective"].indexOf(d.willChange)!==-1||e&&d.willChange==="filter"||e&&d.filter&&d.filter!=="none")return l;l=l.parentNode}return null}function Hr(p){for(var e=Tn(p),r=So(p);r&&Jc(r)&&ui(r).position==="static";)r=So(r);return r&&(ti(r)==="html"||ti(r)==="body"&&ui(r).position==="static")?e:r||Qc(p)||e}var Cn="top",Fn="bottom",Vn="right",_n="left",io="auto",Nr=[Cn,Fn,Vn,_n],fr="start",Rr="end",eu="clippingParents",ks="viewport",xr="popper",tu="reference",Co=Nr.reduce(function(p,e){return p.concat([e+"-"+fr,e+"-"+Rr])},[]),Es=[].concat(Nr,[io]).reduce(function(p,e){return p.concat([e,e+"-"+fr,e+"-"+Rr])},[]),nu="beforeRead",iu="read",ru="afterRead",au="beforeMain",ou="main",su="afterMain",lu="beforeWrite",cu="write",uu="afterWrite",du=[nu,iu,ru,au,ou,su,lu,cu,uu];function fu(p){var e=new Map,r=new Set,s=[];p.forEach(function(d){e.set(d.name,d)});function l(d){r.add(d.name);var m=[].concat(d.requires||[],d.requiresIfExists||[]);m.forEach(function(u){if(!r.has(u)){var g=e.get(u);g&&l(g)}}),s.push(d)}return p.forEach(function(d){r.has(d.name)||l(d)}),s}function hu(p){var e=fu(p);return du.reduce(function(r,s){return r.concat(e.filter(function(l){return l.phase===s}))},[])}function pu(p){var e;return function(){return e||(e=new Promise(function(r){Promise.resolve().then(function(){e=void 0,r(p())})})),e}}function mu(p){var e=p.reduce(function(r,s){var l=r[s.name];return r[s.name]=l?Object.assign({},l,s,{options:Object.assign({},l.options,s.options),data:Object.assign({},l.data,s.data)}):s,r},{});return Object.keys(e).map(function(r){return e[r]})}function gu(p,e){var r=Tn(p),s=wi(p),l=r.visualViewport,d=s.clientWidth,m=s.clientHeight,u=0,g=0;if(l){d=l.width,m=l.height;var x=ys();(x||!x&&e==="fixed")&&(u=l.offsetLeft,g=l.offsetTop)}return{width:d,height:m,x:u+eo(p),y:g}}function vu(p){var e,r=wi(p),s=Qa(p),l=(e=p.ownerDocument)==null?void 0:e.body,d=Bi(r.scrollWidth,r.clientWidth,l?l.scrollWidth:0,l?l.clientWidth:0),m=Bi(r.scrollHeight,r.clientHeight,l?l.scrollHeight:0,l?l.clientHeight:0),u=-s.scrollLeft+eo(p),g=-s.scrollTop;return ui(l||r).direction==="rtl"&&(u+=Bi(r.clientWidth,l?l.clientWidth:0)-d),{width:d,height:m,x:u,y:g}}function xs(p,e){var r=e.getRootNode&&e.getRootNode();if(p.contains(e))return!0;if(r&&Ja(r)){var s=e;do{if(s&&p.isSameNode(s))return!0;s=s.parentNode||s.host}while(s)}return!1}function Wa(p){return Object.assign({},p,{left:p.x,top:p.y,right:p.x+p.width,bottom:p.y+p.height})}function bu(p,e){var r=dr(p,!1,e==="fixed");return r.top=r.top+p.clientTop,r.left=r.left+p.clientLeft,r.bottom=r.top+p.clientHeight,r.right=r.left+p.clientWidth,r.width=p.clientWidth,r.height=p.clientHeight,r.x=r.left,r.y=r.top,r}function _o(p,e,r){return e===ks?Wa(gu(p,r)):zi(e)?bu(e,r):Wa(vu(wi(p)))}function yu(p){var e=Ar(va(p)),r=["absolute","fixed"].indexOf(ui(p).position)>=0,s=r&&Rn(p)?Hr(p):p;return zi(s)?e.filter(function(l){return zi(l)&&xs(l,s)&&ti(l)!=="body"}):[]}function wu(p,e,r,s){var l=e==="clippingParents"?yu(p):[].concat(e),d=[].concat(l,[r]),m=d[0],u=d.reduce(function(g,x){var k=_o(p,x,s);return g.top=Bi(k.top,g.top),g.right=ua(k.right,g.right),g.bottom=ua(k.bottom,g.bottom),g.left=Bi(k.left,g.left),g},_o(p,m,s));return u.width=u.right-u.left,u.height=u.bottom-u.top,u.x=u.left,u.y=u.top,u}function ei(p){return p.split("-")[0]}function hr(p){return p.split("-")[1]}function ro(p){return["top","bottom"].indexOf(p)>=0?"x":"y"}function Ss(p){var e=p.reference,r=p.element,s=p.placement,l=s?ei(s):null,d=s?hr(s):null,m=e.x+e.width/2-r.width/2,u=e.y+e.height/2-r.height/2,g;switch(l){case Cn:g={x:m,y:e.y-r.height};break;case Fn:g={x:m,y:e.y+e.height};break;case Vn:g={x:e.x+e.width,y:u};break;case _n:g={x:e.x-r.width,y:u};break;default:g={x:e.x,y:e.y}}var x=l?ro(l):null;if(x!=null){var k=x==="y"?"height":"width";switch(d){case fr:g[x]=g[x]-(e[k]/2-r[k]/2);break;case Rr:g[x]=g[x]+(e[k]/2-r[k]/2);break}}return g}function Cs(){return{top:0,right:0,bottom:0,left:0}}function _s(p){return Object.assign({},Cs(),p)}function Ts(p,e){return e.reduce(function(r,s){return r[s]=p,r},{})}function ao(p,e){e===void 0&&(e={});var r=e,s=r.placement,l=s===void 0?p.placement:s,d=r.strategy,m=d===void 0?p.strategy:d,u=r.boundary,g=u===void 0?eu:u,x=r.rootBoundary,k=x===void 0?ks:x,h=r.elementContext,f=h===void 0?xr:h,b=r.altBoundary,y=b===void 0?!1:b,E=r.padding,w=E===void 0?0:E,C=_s(typeof w!="number"?w:Ts(w,Nr)),_=f===xr?tu:xr,T=p.rects.popper,M=p.elements[y?_:f],v=wu(zi(M)?M:M.contextElement||wi(p.elements.popper),g,k,m),D=dr(p.elements.reference),N=Ss({reference:D,element:T,placement:l}),z=Wa(Object.assign({},T,N)),H=f===xr?z:D,Y={top:v.top-H.top+C.top,bottom:H.bottom-v.bottom+C.bottom,left:v.left-H.left+C.left,right:H.right-v.right+C.right},U=p.modifiersData.offset;if(f===xr&&U){var j=U[l];Object.keys(Y).forEach(function(X){var he=[Vn,Fn].indexOf(X)>=0?1:-1,Se=[Cn,Fn].indexOf(X)>=0?"y":"x";Y[X]+=j[Se]*he})}return Y}var To={placement:"bottom",modifiers:[],strategy:"absolute"};function Mo(){for(var p=arguments.length,e=new Array(p),r=0;r<p;r++)e[r]=arguments[r];return!e.some(function(s){return!(s&&typeof s.getBoundingClientRect=="function")})}function ku(p){p===void 0&&(p={});var e=p,r=e.defaultModifiers,s=r===void 0?[]:r,l=e.defaultOptions,d=l===void 0?To:l;return function(u,g,x){x===void 0&&(x=d);var k={placement:"bottom",orderedModifiers:[],options:Object.assign({},To,d),modifiersData:{},elements:{reference:u,popper:g},attributes:{},styles:{}},h=[],f=!1,b={state:k,setOptions:function(C){var _=typeof C=="function"?C(k.options):C;E(),k.options=Object.assign({},d,k.options,_),k.scrollParents={reference:zi(u)?Ar(u):u.contextElement?Ar(u.contextElement):[],popper:Ar(g)};var T=hu(mu([].concat(s,k.options.modifiers)));return k.orderedModifiers=T.filter(function(M){return M.enabled}),y(),b.update()},forceUpdate:function(){if(!f){var C=k.elements,_=C.reference,T=C.popper;if(Mo(_,T)){k.rects={reference:Zc(_,Hr(T),k.options.strategy==="fixed"),popper:no(T)},k.reset=!1,k.placement=k.options.placement,k.orderedModifiers.forEach(function(Y){return k.modifiersData[Y.name]=Object.assign({},Y.data)});for(var M=0;M<k.orderedModifiers.length;M++){if(k.reset===!0){k.reset=!1,M=-1;continue}var v=k.orderedModifiers[M],D=v.fn,N=v.options,z=N===void 0?{}:N,H=v.name;typeof D=="function"&&(k=D({state:k,options:z,name:H,instance:b})||k)}}}},update:pu(function(){return new Promise(function(w){b.forceUpdate(),w(k)})}),destroy:function(){E(),f=!0}};if(!Mo(u,g))return b;b.setOptions(x).then(function(w){!f&&x.onFirstUpdate&&x.onFirstUpdate(w)});function y(){k.orderedModifiers.forEach(function(w){var C=w.name,_=w.options,T=_===void 0?{}:_,M=w.effect;if(typeof M=="function"){var v=M({state:k,name:C,instance:b,options:T}),D=function(){};h.push(v||D)}})}function E(){h.forEach(function(w){return w()}),h=[]}return b}}var Yr={passive:!0};function Eu(p){var e=p.state,r=p.instance,s=p.options,l=s.scroll,d=l===void 0?!0:l,m=s.resize,u=m===void 0?!0:m,g=Tn(e.elements.popper),x=[].concat(e.scrollParents.reference,e.scrollParents.popper);return d&&x.forEach(function(k){k.addEventListener("scroll",r.update,Yr)}),u&&g.addEventListener("resize",r.update,Yr),function(){d&&x.forEach(function(k){k.removeEventListener("scroll",r.update,Yr)}),u&&g.removeEventListener("resize",r.update,Yr)}}const Ms={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Eu,data:{}};function xu(p){var e=p.state,r=p.name;e.modifiersData[r]=Ss({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const Su={name:"popperOffsets",enabled:!0,phase:"read",fn:xu,data:{}};var Cu={top:"auto",right:"auto",bottom:"auto",left:"auto"};function _u(p,e){var r=p.x,s=p.y,l=e.devicePixelRatio||1;return{x:ur(r*l)/l||0,y:ur(s*l)/l||0}}function Ao(p){var e,r=p.popper,s=p.popperRect,l=p.placement,d=p.variation,m=p.offsets,u=p.position,g=p.gpuAcceleration,x=p.adaptive,k=p.roundOffsets,h=p.isFixed,f=m.x,b=f===void 0?0:f,y=m.y,E=y===void 0?0:y,w=typeof k=="function"?k({x:b,y:E}):{x:b,y:E};b=w.x,E=w.y;var C=m.hasOwnProperty("x"),_=m.hasOwnProperty("y"),T=_n,M=Cn,v=window;if(x){var D=Hr(r),N="clientHeight",z="clientWidth";if(D===Tn(r)&&(D=wi(r),ui(D).position!=="static"&&u==="absolute"&&(N="scrollHeight",z="scrollWidth")),D=D,l===Cn||(l===_n||l===Vn)&&d===Rr){M=Fn;var H=h&&D===v&&v.visualViewport?v.visualViewport.height:D[N];E-=H-s.height,E*=g?1:-1}if(l===_n||(l===Cn||l===Fn)&&d===Rr){T=Vn;var Y=h&&D===v&&v.visualViewport?v.visualViewport.width:D[z];b-=Y-s.width,b*=g?1:-1}}var U=Object.assign({position:u},x&&Cu),j=k===!0?_u({x:b,y:E},Tn(r)):{x:b,y:E};if(b=j.x,E=j.y,g){var X;return Object.assign({},U,(X={},X[M]=_?"0":"",X[T]=C?"0":"",X.transform=(v.devicePixelRatio||1)<=1?"translate("+b+"px, "+E+"px)":"translate3d("+b+"px, "+E+"px, 0)",X))}return Object.assign({},U,(e={},e[M]=_?E+"px":"",e[T]=C?b+"px":"",e.transform="",e))}function Tu(p){var e=p.state,r=p.options,s=r.gpuAcceleration,l=s===void 0?!0:s,d=r.adaptive,m=d===void 0?!0:d,u=r.roundOffsets,g=u===void 0?!0:u,x={placement:ei(e.placement),variation:hr(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:l,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Ao(Object.assign({},x,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:m,roundOffsets:g})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Ao(Object.assign({},x,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:g})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const As={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:Tu,data:{}};function Mu(p){var e=p.state;Object.keys(e.elements).forEach(function(r){var s=e.styles[r]||{},l=e.attributes[r]||{},d=e.elements[r];!Rn(d)||!ti(d)||(Object.assign(d.style,s),Object.keys(l).forEach(function(m){var u=l[m];u===!1?d.removeAttribute(m):d.setAttribute(m,u===!0?"":u)}))})}function Au(p){var e=p.state,r={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,r.popper),e.styles=r,e.elements.arrow&&Object.assign(e.elements.arrow.style,r.arrow),function(){Object.keys(e.elements).forEach(function(s){var l=e.elements[s],d=e.attributes[s]||{},m=Object.keys(e.styles.hasOwnProperty(s)?e.styles[s]:r[s]),u=m.reduce(function(g,x){return g[x]="",g},{});!Rn(l)||!ti(l)||(Object.assign(l.style,u),Object.keys(d).forEach(function(g){l.removeAttribute(g)}))})}}const Lu={name:"applyStyles",enabled:!0,phase:"write",fn:Mu,effect:Au,requires:["computeStyles"]};var Du=[Ms,Su,As,Lu],Ou={left:"right",right:"left",bottom:"top",top:"bottom"};function oa(p){return p.replace(/left|right|bottom|top/g,function(e){return Ou[e]})}var Pu={start:"end",end:"start"};function Lo(p){return p.replace(/start|end/g,function(e){return Pu[e]})}function Ru(p,e){e===void 0&&(e={});var r=e,s=r.placement,l=r.boundary,d=r.rootBoundary,m=r.padding,u=r.flipVariations,g=r.allowedAutoPlacements,x=g===void 0?Es:g,k=hr(s),h=k?u?Co:Co.filter(function(y){return hr(y)===k}):Nr,f=h.filter(function(y){return x.indexOf(y)>=0});f.length===0&&(f=h);var b=f.reduce(function(y,E){return y[E]=ao(p,{placement:E,boundary:l,rootBoundary:d,padding:m})[ei(E)],y},{});return Object.keys(b).sort(function(y,E){return b[y]-b[E]})}function Iu(p){if(ei(p)===io)return[];var e=oa(p);return[Lo(p),e,Lo(e)]}function Hu(p){var e=p.state,r=p.options,s=p.name;if(!e.modifiersData[s]._skip){for(var l=r.mainAxis,d=l===void 0?!0:l,m=r.altAxis,u=m===void 0?!0:m,g=r.fallbackPlacements,x=r.padding,k=r.boundary,h=r.rootBoundary,f=r.altBoundary,b=r.flipVariations,y=b===void 0?!0:b,E=r.allowedAutoPlacements,w=e.options.placement,C=ei(w),_=C===w,T=g||(_||!y?[oa(w)]:Iu(w)),M=[w].concat(T).reduce(function(re,Re){return re.concat(ei(Re)===io?Ru(e,{placement:Re,boundary:k,rootBoundary:h,padding:x,flipVariations:y,allowedAutoPlacements:E}):Re)},[]),v=e.rects.reference,D=e.rects.popper,N=new Map,z=!0,H=M[0],Y=0;Y<M.length;Y++){var U=M[Y],j=ei(U),X=hr(U)===fr,he=[Cn,Fn].indexOf(j)>=0,Se=he?"width":"height",Ue=ao(e,{placement:U,boundary:k,rootBoundary:h,altBoundary:f,padding:x}),Le=he?X?Vn:_n:X?Fn:Cn;v[Se]>D[Se]&&(Le=oa(Le));var Pe=oa(Le),Ie=[];if(d&&Ie.push(Ue[j]<=0),u&&Ie.push(Ue[Le]<=0,Ue[Pe]<=0),Ie.every(function(re){return re})){H=U,z=!1;break}N.set(U,Ie)}if(z)for(var et=y?3:1,rt=function(Re){var Ge=M.find(function(Q){var Ce=N.get(Q);if(Ce)return Ce.slice(0,Re).every(function(ce){return ce})});if(Ge)return H=Ge,"break"},B=et;B>0;B--){var le=rt(B);if(le==="break")break}e.placement!==H&&(e.modifiersData[s]._skip=!0,e.placement=H,e.reset=!0)}}const Nu={name:"flip",enabled:!0,phase:"main",fn:Hu,requiresIfExists:["offset"],data:{_skip:!1}};function ju(p,e,r){var s=ei(p),l=[_n,Cn].indexOf(s)>=0?-1:1,d=typeof r=="function"?r(Object.assign({},e,{placement:p})):r,m=d[0],u=d[1];return m=m||0,u=(u||0)*l,[_n,Vn].indexOf(s)>=0?{x:u,y:m}:{x:m,y:u}}function $u(p){var e=p.state,r=p.options,s=p.name,l=r.offset,d=l===void 0?[0,0]:l,m=Es.reduce(function(k,h){return k[h]=ju(h,e.rects,d),k},{}),u=m[e.placement],g=u.x,x=u.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=g,e.modifiersData.popperOffsets.y+=x),e.modifiersData[s]=m}const Bu={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:$u};function Uu(p){return p==="x"?"y":"x"}function Lr(p,e,r){return Bi(p,ua(e,r))}function zu(p,e,r){var s=Lr(p,e,r);return s>r?r:s}function Fu(p){var e=p.state,r=p.options,s=p.name,l=r.mainAxis,d=l===void 0?!0:l,m=r.altAxis,u=m===void 0?!1:m,g=r.boundary,x=r.rootBoundary,k=r.altBoundary,h=r.padding,f=r.tether,b=f===void 0?!0:f,y=r.tetherOffset,E=y===void 0?0:y,w=ao(e,{boundary:g,rootBoundary:x,padding:h,altBoundary:k}),C=ei(e.placement),_=hr(e.placement),T=!_,M=ro(C),v=Uu(M),D=e.modifiersData.popperOffsets,N=e.rects.reference,z=e.rects.popper,H=typeof E=="function"?E(Object.assign({},e.rects,{placement:e.placement})):E,Y=typeof H=="number"?{mainAxis:H,altAxis:H}:Object.assign({mainAxis:0,altAxis:0},H),U=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,j={x:0,y:0};if(D){if(d){var X,he=M==="y"?Cn:_n,Se=M==="y"?Fn:Vn,Ue=M==="y"?"height":"width",Le=D[M],Pe=Le+w[he],Ie=Le-w[Se],et=b?-z[Ue]/2:0,rt=_===fr?N[Ue]:z[Ue],B=_===fr?-z[Ue]:-N[Ue],le=e.elements.arrow,re=b&&le?no(le):{width:0,height:0},Re=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:Cs(),Ge=Re[he],Q=Re[Se],Ce=Lr(0,N[Ue],re[Ue]),ce=T?N[Ue]/2-et-Ce-Ge-Y.mainAxis:rt-Ce-Ge-Y.mainAxis,ne=T?-N[Ue]/2+et+Ce+Q+Y.mainAxis:B+Ce+Q+Y.mainAxis,Ve=e.elements.arrow&&Hr(e.elements.arrow),pe=Ve?M==="y"?Ve.clientTop||0:Ve.clientLeft||0:0,ct=(X=U==null?void 0:U[M])!=null?X:0,Je=Le+ce-ct-pe,ot=Le+ne-ct,_e=Lr(b?ua(Pe,Je):Pe,Le,b?Bi(Ie,ot):Ie);D[M]=_e,j[M]=_e-Le}if(u){var tt,kt=M==="x"?Cn:_n,wt=M==="x"?Fn:Vn,nt=D[v],Yt=v==="y"?"height":"width",yn=nt+w[kt],Pt=nt-w[wt],an=[Cn,_n].indexOf(C)!==-1,ht=(tt=U==null?void 0:U[v])!=null?tt:0,In=an?yn:nt-N[Yt]-z[Yt]-ht+Y.altAxis,on=an?nt+N[Yt]+z[Yt]-ht-Y.altAxis:Pt,Vt=b&&an?zu(In,nt,on):Lr(b?In:yn,nt,b?on:Pt);D[v]=Vt,j[v]=Vt-nt}e.modifiersData[s]=j}}const Vu={name:"preventOverflow",enabled:!0,phase:"main",fn:Fu,requiresIfExists:["offset"]};var qu=function(e,r){return e=typeof e=="function"?e(Object.assign({},r.rects,{placement:r.placement})):e,_s(typeof e!="number"?e:Ts(e,Nr))};function Wu(p){var e,r=p.state,s=p.name,l=p.options,d=r.elements.arrow,m=r.modifiersData.popperOffsets,u=ei(r.placement),g=ro(u),x=[_n,Vn].indexOf(u)>=0,k=x?"height":"width";if(!(!d||!m)){var h=qu(l.padding,r),f=no(d),b=g==="y"?Cn:_n,y=g==="y"?Fn:Vn,E=r.rects.reference[k]+r.rects.reference[g]-m[g]-r.rects.popper[k],w=m[g]-r.rects.reference[g],C=Hr(d),_=C?g==="y"?C.clientHeight||0:C.clientWidth||0:0,T=E/2-w/2,M=h[b],v=_-f[k]-h[y],D=_/2-f[k]/2+T,N=Lr(M,D,v),z=g;r.modifiersData[s]=(e={},e[z]=N,e.centerOffset=N-D,e)}}function Yu(p){var e=p.state,r=p.options,s=r.element,l=s===void 0?"[data-popper-arrow]":s;l!=null&&(typeof l=="string"&&(l=e.elements.popper.querySelector(l),!l)||xs(e.elements.popper,l)&&(e.elements.arrow=l))}const Ku={name:"arrow",enabled:!0,phase:"main",fn:Wu,effect:Yu,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]},Gu=ku({defaultModifiers:[...Du,Bu,Nu,Vu,As,Ms,Ku]});function Xu({locked:p=!1,overflowPadding:e=8,offsetDistance:r=8,offsetSkid:s=0,gpuAcceleration:l=!0,adaptive:d=!0,scroll:m=!0,resize:u=!0,arrow:g=!1,placement:x,strategy:k},h){const f=G(null),b=G(null),y=G(null);return Ht(()=>{bc(E=>{if(!b.value||!f.value)return;const w=xo(b),C=xo(f);if(!(w instanceof HTMLElement)||!C)return;const _={modifiers:[{name:"flip",enabled:!p},{name:"preventOverflow",options:{padding:e}},{name:"offset",options:{offset:[s,r]}},{name:"computeStyles",options:{adaptive:d,gpuAcceleration:l}},{name:"eventListeners",options:{scroll:m,resize:u}},{name:"arrow",enabled:g}]};x&&(_.placement=x),k&&(_.strategy=k),y.value=Gu(C,w,_),E(y.value.destroy)})}),[f,b,y]}const Ca=Xa(cr.ui.strategy,cr.ui.tooltip,qc),Zu=rn({components:{UKbd:bs},inheritAttrs:!1,props:{text:{type:String,default:null},prevent:{type:Boolean,default:!1},shortcuts:{type:Array,default:()=>[]},openDelay:{type:Number,default:()=>Ca.default.openDelay},closeDelay:{type:Number,default:()=>Ca.default.closeDelay},popper:{type:Object,default:()=>({})},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(p){const{ui:e,attrs:r}=Za("tooltip",Pr(p,"ui"),Ca,Pr(p,"class")),s=ge(()=>wc({},p.popper,e.value.popper)),[l,d]=Xu(s.value),m=G(!1);let u=null,g=null;const x=ge(()=>!!(kc().text||p.text));function k(){g&&(clearTimeout(g),g=null),!m.value&&(u=u||setTimeout(()=>{m.value=!0,u=null},p.openDelay))}function h(){u&&(clearTimeout(u),u=null),m.value&&(g=g||setTimeout(()=>{m.value=!1,g=null},p.closeDelay))}return{ui:e,attrs:r,popper:s,trigger:l,container:d,open:m,onMouseEnter:k,onMouseLeave:h,isVisible:x}}});function Ju(p,e,r,s,l,d){const m=bs;return Z(),oe("div",ca({ref:"trigger",class:p.ui.wrapper},p.attrs,{onMouseenter:e[0]||(e[0]=(...u)=>p.onMouseEnter&&p.onMouseEnter(...u)),onMouseleave:e[1]||(e[1]=(...u)=>p.onMouseLeave&&p.onMouseLeave(...u))}),[la(p.$slots,"default",{open:p.open},()=>[e[2]||(e[2]=mt(" Hover "))]),p.open&&!p.prevent&&p.isVisible?(Z(),oe("div",{key:0,ref:"container",class:ke([p.ui.container,p.ui.width])},[ie(yc,ca({appear:""},p.ui.transition),{default:Me(()=>{var u;return[I("div",null,[p.popper.arrow?(Z(),oe("div",{key:0,"data-popper-arrow":"",class:ke(Object.values(p.ui.arrow))},null,2)):Oe("",!0),I("div",{class:ke([p.ui.base,p.ui.background,p.ui.color,p.ui.rounded,p.ui.shadow,p.ui.ring])},[la(p.$slots,"text",{},()=>[mt(Fe(p.text),1)]),(u=p.shortcuts)!=null&&u.length?(Z(),oe("span",{key:0,class:ke(p.ui.shortcuts)},[I("span",{class:ke(p.ui.middot)},"·",2),(Z(!0),oe(It,null,Jt(p.shortcuts,g=>(Z(),Lt(m,{key:g,size:"xs"},{default:Me(()=>[mt(Fe(g),1)]),_:2},1024))),128))],2)):Oe("",!0)],2)])]}),_:3},16)],2)):Oe("",!0)],16)}const Qu=Mn(Zu,[["render",Ju]]),ed=Symbol.for("nuxt:client-only"),td=rn({name:"ClientOnly",inheritAttrs:!1,props:["fallback","placeholder","placeholderTag","fallbackTag"],setup(p,{slots:e,attrs:r}){const s=G(!1);return Ht(()=>{s.value=!0}),Mr(ed,!0),l=>{var g;if(s.value)return(g=e.default)==null?void 0:g.call(e);const d=e.fallback||e.placeholder;if(d)return d();const m=l.fallback||l.placeholder||"",u=l.fallbackTag||l.placeholderTag||"span";return oe(u,r,m)}}}),nd=Xa(cr.ui.strategy,cr.ui.container,Vc),id=rn({inheritAttrs:!1,props:{as:{type:String,default:"div"},class:{type:[String,Object,Array],default:()=>""},ui:{type:Object,default:()=>({})}},setup(p){const{ui:e,attrs:r}=Za("container",Pr(p,"ui"),nd),s=ge(()=>cs(us(e.value.base,e.value.padding,e.value.constrained),p.class));return{ui:e,attrs:r,containerClass:s}}});function rd(p,e,r,s,l,d){return Z(),Lt(Ec(p.as),ca({class:p.containerClass},p.attrs),{default:Me(()=>[la(p.$slots,"default")]),_:3},16,["class"])}const ad=Mn(id,[["render",rd]]),Ls=ds("messageStore",()=>{const p=G([]),e=G(0),r=G(!0),s=G(1),l=G(15),d=We(),m=G(!1),u=G(null),g=G([]),x=G([]),k=G(null);return{messages:p,total:e,hasMore:r,page:s,pageSize:l,loading:m,siteConfig:u,reset:()=>{p.value=[],e.value=0,r.value=!0,s.value=1,m.value=!1},getMessages:async U=>{if(!m.value){m.value=!0;try{const j=await Hi("messages/page",U,{credentials:"include"});if(!j)return d.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const X=j.data.items.filter(he=>!p.value.some(Se=>Se.id===he.id));return U.page===1?p.value=j.data.items:p.value=[...p.value,...X],e.value=j.data.total,s.value=U.page,l.value=U.pageSize,r.value=p.value.length<e.value,j.data}catch(j){console.error("获取笔记列表失败:",j),d.add({title:"获取笔记列表失败",description:"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3})}finally{m.value=!1}}},deleteMessage:async U=>{try{const j=await fs(`messages/${U}`,void 0,{credentials:"include"});return!j||j.code!==1?(d.add({title:"删除笔记失败",description:j==null?void 0:j.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(p.value=p.value.filter(X=>X.id!==U),e.value-=1,j)}catch(j){throw console.error("删除笔记失败:",j),j}},updateMessage:async(U,j)=>{try{const X=await Er(`messages/${U}`,{content:j},{credentials:"include"});if(!X||X.code!==1)return d.add({title:"更新笔记失败",description:X==null?void 0:X.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const he=p.value.findIndex(Se=>Se.id===U);return he!==-1&&(p.value[he]=X.data),X}catch(X){throw console.error("更新笔记失败:",X),X}},setPrivate:async(U,j)=>{try{const X=await Er(`messages/${U}`,{private:j},{credentials:"include"});if(!X||X.code!==1)return d.add({title:"更新私密状态失败",description:X==null?void 0:X.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const he=p.value.findIndex(Se=>Se.id===U);return he!==-1&&(p.value[he]=X.data),X}catch(X){throw console.error("更新私密状态失败:",X),X}},setPinned:async(U,j)=>{try{const X=await Er(`messages/${U}/pin`,{pinned:j},{credentials:"include"});if(!X||X.code!==1)return d.add({title:"更新置顶状态失败",description:X==null?void 0:X.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const he=p.value.findIndex(Se=>Se.id===U);return he!==-1&&(p.value[he]={...p.value[he],pinned:j},p.value=[...p.value].sort((Se,Ue)=>{const Le=Se.pinned?1:0,Pe=Ue.pinned?1:0;return Le!==Pe?Pe-Le:new Date(Ue.created_at).getTime()-new Date(Se.created_at).getTime()})),X}catch(X){throw console.error("更新置顶状态失败:",X),X}},getMessageById:async U=>{try{const j=await zn(`messages/${U}`,void 0,{credentials:"include"});return!j||j.code!==1?(d.add({title:"获取消息失败",description:(j==null?void 0:j.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):j.data}catch(j){throw console.error("获取消息失败:",j),j}},getSiteConfig:async()=>{try{const U=await zn("site/config",void 0,{credentials:"include"});return!U||U.code!==1?(d.add({title:"获取网站配置失败",description:(U==null?void 0:U.msg)||"请稍后重试",icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(u.value=U.data,vt(),U.data)}catch(U){throw console.error("获取网站配置失败:",U),U}},updateSiteConfig:async(U,j)=>{try{const X=await Er("site/config",{[U]:j},{credentials:"include"});return!X||X.code!==1?(d.add({title:"更新配置失败",description:X==null?void 0:X.msg,icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):(u.value={...u.value,[U]:j},X.data)}catch(X){throw console.error("更新配置失败:",X),X}},tags:g,images:x,getAllTags:async()=>{try{const U=await zn("messages/tags",void 0,{credentials:"include"});return!U||U.code!==1?(d.add({title:"获取标签列表失败",description:(U==null?void 0:U.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(g.value=U.data,U.data)}catch(U){throw console.error("获取标签列表失败:",U),U}},getMessagesByTag:async U=>{try{const j=await zn(`messages/tags/${encodeURIComponent(U)}`,void 0,{credentials:"include"});return!j||j.code!==1?(d.add({title:"获取标签消息失败",description:(j==null?void 0:j.msg)||"请稍后重试",color:"red",timeout:2e3}),null):j.data}catch(j){throw console.error("获取标签消息失败:",j),j}},getAllImages:async()=>{try{const U=await zn("messages/images",void 0,{credentials:"include"});return!U||U.code!==1?(d.add({title:"获取图片列表失败",description:(U==null?void 0:U.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(x.value=U.data,U.data)}catch(U){throw console.error("获取图片列表失败:",U),U}},notifyConfig:k,getNotifyConfig:async()=>{try{const U=await zn("notify/config",void 0,{credentials:"include"});return!U||U.code!==1?(d.add({title:"获取推送配置失败",description:(U==null?void 0:U.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(k.value=U.data,U.data)}catch(U){throw console.error("获取推送配置失败:",U),U}},updateNotifyConfig:async U=>{try{const j=await Er("notify/config",U,{credentials:"include"});return!j||j.code!==1?(d.add({title:"更新推送配置失败",description:(j==null?void 0:j.msg)||"请稍后重试",color:"red",timeout:2e3}),null):(k.value=j.data,j.data)}catch(j){throw console.error("更新推送配置失败:",j),j}},testNotify:async U=>{try{const j=await Hi(`notify/test?type=${U}`,{},{credentials:"include"});if(!j||j.code!==1)throw new Error((j==null?void 0:j.msg)||"测试失败");return j.data}catch(j){throw console.error("推送测试失败:",j),j}},createMessage:async U=>{try{const j=await Hi("messages",U,{credentials:"include"});if(!j||j.code!==1)throw new Error((j==null?void 0:j.msg)||"创建消息失败");if(U.notify)try{const X=gn().public.baseApi,he={content:U.content,images:U.image_url?[`${X}${U.image_url}`].filter(Boolean):[],format:"markdown"},Se=await Hi("notify/send",he,{credentials:"include"});(!Se||Se.code!==1)&&console.warn("推送失败:",Se==null?void 0:Se.msg)}catch(X){console.error("消息推送失败:",X)}return d.add({title:"成功",description:"发布成功",color:"green",timeout:2e3}),j.data}catch(j){throw console.error("创建消息失败:",j),j}}}}),Ds=()=>{const p=Ls(),e=We();return{save:async d=>{try{const m=await Hi("messages",d,{credentials:"include"});if(!m||m.code!==1)return console.log(m==null?void 0:m.code),e.add({title:"添加失败",description:String(m==null?void 0:m.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null;const u=m.data;return p.messages.unshift(u),e.add({title:"保存成功",description:"消息已保存",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),m.data}catch(m){console.error(m)}},uploadImage:async d=>{try{const m=new FormData;m.append("image",d);const u=await Hi("images/upload",m,{credentials:"include"});return!u||u.code!==1?(console.log(u==null?void 0:u.code),e.add({title:"上传失败",description:String(u==null?void 0:u.msg),icon:"i-fluent-error-circle-16-filled",color:"red",timeout:2e3}),null):u.data}catch(m){return console.error("上传图片错误:",m),null}},deleteMessage:async d=>{try{const m=await p.deleteMessage(d);if(m&&m.code===1)return e.add({title:"删除成功",description:"笔记已删除",icon:"i-fluent-checkmark-starburst-16-filled",color:"green",timeout:1e3}),!0}catch(m){console.error(m)}}}},Ae=(p,e=1e4)=>(p=parseFloat(p+"")||0,Math.round((p+Number.EPSILON)*e)/e),Ya=function(p){if(!(p&&p instanceof Element&&p.offsetParent))return!1;const e=p.scrollHeight>p.clientHeight,r=window.getComputedStyle(p).overflowY,s=r.indexOf("hidden")!==-1,l=r.indexOf("visible")!==-1;return e&&!s&&!l},da=function(p,e=void 0){return!(!p||p===document.body||e&&p===e)&&(Ya(p)?p:da(p.parentElement,e))},Jn=function(p){var e=new DOMParser().parseFromString(p,"text/html").body;if(e.childElementCount>1){for(var r=document.createElement("div");e.firstChild;)r.appendChild(e.firstChild);return r}return e.firstChild},oo=p=>`${p||""}`.split(" ").filter(e=>!!e),Qn=(p,e,r)=>{p&&oo(e).forEach(s=>{p.classList.toggle(s,r||!1)})};class tr{constructor(e){Object.defineProperty(this,"pageX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"pageY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"nativePointer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.nativePointer=e,this.pageX=e.pageX,this.pageY=e.pageY,this.clientX=e.clientX,this.clientY=e.clientY,this.id=self.Touch&&e instanceof Touch?e.identifier:-1,this.time=Date.now()}}const nr={passive:!1};class od{constructor(e,{start:r=()=>!0,move:s=()=>{},end:l=()=>{}}){Object.defineProperty(this,"element",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"startCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"moveCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"endCallback",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"currentPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"startPointers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.element=e,this.startCallback=r,this.moveCallback=s,this.endCallback=l;for(const d of["onPointerStart","onTouchStart","onMove","onTouchEnd","onPointerEnd","onWindowBlur"])this[d]=this[d].bind(this);this.element.addEventListener("mousedown",this.onPointerStart,nr),this.element.addEventListener("touchstart",this.onTouchStart,nr),this.element.addEventListener("touchmove",this.onMove,nr),this.element.addEventListener("touchend",this.onTouchEnd),this.element.addEventListener("touchcancel",this.onTouchEnd)}onPointerStart(e){if(!e.buttons||e.button!==0)return;const r=new tr(e);this.currentPointers.some(s=>s.id===r.id)||this.triggerPointerStart(r,e)&&(window.addEventListener("mousemove",this.onMove),window.addEventListener("mouseup",this.onPointerEnd),window.addEventListener("blur",this.onWindowBlur))}onTouchStart(e){for(const r of Array.from(e.changedTouches||[]))this.triggerPointerStart(new tr(r),e);window.addEventListener("blur",this.onWindowBlur)}onMove(e){const r=this.currentPointers.slice(),s="changedTouches"in e?Array.from(e.changedTouches||[]).map(d=>new tr(d)):[new tr(e)],l=[];for(const d of s){const m=this.currentPointers.findIndex(u=>u.id===d.id);m<0||(l.push(d),this.currentPointers[m]=d)}l.length&&this.moveCallback(e,this.currentPointers.slice(),r)}onPointerEnd(e){e.buttons>0&&e.button!==0||(this.triggerPointerEnd(e,new tr(e)),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur))}onTouchEnd(e){for(const r of Array.from(e.changedTouches||[]))this.triggerPointerEnd(e,new tr(r))}triggerPointerStart(e,r){return!!this.startCallback(r,e,this.currentPointers.slice())&&(this.currentPointers.push(e),this.startPointers.push(e),!0)}triggerPointerEnd(e,r){const s=this.currentPointers.findIndex(l=>l.id===r.id);s<0||(this.currentPointers.splice(s,1),this.startPointers.splice(s,1),this.endCallback(e,r,this.currentPointers.slice()))}onWindowBlur(){this.clear()}clear(){for(;this.currentPointers.length;){const e=this.currentPointers[this.currentPointers.length-1];this.currentPointers.splice(this.currentPointers.length-1,1),this.startPointers.splice(this.currentPointers.length-1,1),this.endCallback(new Event("touchend",{bubbles:!0,cancelable:!0,clientX:e.clientX,clientY:e.clientY}),e,this.currentPointers.slice())}}stop(){this.element.removeEventListener("mousedown",this.onPointerStart,nr),this.element.removeEventListener("touchstart",this.onTouchStart,nr),this.element.removeEventListener("touchmove",this.onMove,nr),this.element.removeEventListener("touchend",this.onTouchEnd),this.element.removeEventListener("touchcancel",this.onTouchEnd),window.removeEventListener("mousemove",this.onMove),window.removeEventListener("mouseup",this.onPointerEnd),window.removeEventListener("blur",this.onWindowBlur)}}function Do(p,e){return e?Math.sqrt(Math.pow(e.clientX-p.clientX,2)+Math.pow(e.clientY-p.clientY,2)):0}function Oo(p,e){return e?{clientX:(p.clientX+e.clientX)/2,clientY:(p.clientY+e.clientY)/2}:p}const Ka=p=>typeof p=="object"&&p!==null&&p.constructor===Object&&Object.prototype.toString.call(p)==="[object Object]",bn=(p,...e)=>{const r=e.length;for(let s=0;s<r;s++){const l=e[s]||{};Object.entries(l).forEach(([d,m])=>{const u=Array.isArray(m)?[]:{};p[d]||Object.assign(p,{[d]:u}),Ka(m)?Object.assign(p[d],bn(u,m)):Array.isArray(m)?Object.assign(p,{[d]:[...m]}):Object.assign(p,{[d]:m})})}return p},_a=function(p,e){return p.split(".").reduce((r,s)=>typeof r=="object"?r[s]:void 0,e)};class fa{constructor(e={}){Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),this.setOptions(e);for(const r of Object.getOwnPropertyNames(Object.getPrototypeOf(this)))r.startsWith("on")&&typeof this[r]=="function"&&(this[r]=this[r].bind(this))}setOptions(e){this.options=e?bn({},this.constructor.defaults,e):{};for(const[r,s]of Object.entries(this.option("on")||{}))this.on(r,s)}option(e,...r){let s=_a(e,this.options);return s&&typeof s=="function"&&(s=s.call(this,this,...r)),s}optionFor(e,r,s,...l){let d=_a(r,e);var m;typeof(m=d)!="string"||isNaN(m)||isNaN(parseFloat(m))||(d=parseFloat(d)),d==="true"&&(d=!0),d==="false"&&(d=!1),d&&typeof d=="function"&&(d=d.call(this,this,e,...l));let u=_a(r,this.options);return u&&typeof u=="function"?d=u.call(this,this,e,...l,d):d===void 0&&(d=u),d===void 0?s:d}cn(e){const r=this.options.classes;return r&&r[e]||""}localize(e,r=[]){e=String(e).replace(/\{\{(\w+).?(\w+)?\}\}/g,(s,l,d)=>{let m="";return d?m=this.option(`${l[0]+l.toLowerCase().substring(1)}.l10n.${d}`):l&&(m=this.option(`l10n.${l}`)),m||(m=s),m});for(let s=0;s<r.length;s++)e=e.split(r[s][0]).join(r[s][1]);return e=e.replace(/\{\{(.*?)\}\}/g,(s,l)=>l)}on(e,r){let s=[];typeof e=="string"?s=e.split(" "):Array.isArray(e)&&(s=e),this.events||(this.events=new Map),s.forEach(l=>{let d=this.events.get(l);d||(this.events.set(l,[]),d=[]),d.includes(r)||d.push(r),this.events.set(l,d)})}off(e,r){let s=[];typeof e=="string"?s=e.split(" "):Array.isArray(e)&&(s=e),s.forEach(l=>{const d=this.events.get(l);if(Array.isArray(d)){const m=d.indexOf(r);m>-1&&d.splice(m,1)}})}emit(e,...r){[...this.events.get(e)||[]].forEach(s=>s(this,...r)),e!=="*"&&this.emit("*",e,...r)}}Object.defineProperty(fa,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(fa,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{}});class so extends fa{constructor(e={}){super(e),Object.defineProperty(this,"plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}})}attachPlugins(e={}){const r=new Map;for(const[s,l]of Object.entries(e)){const d=this.option(s),m=this.plugins[s];m||d===!1?m&&d===!1&&(m.detach(),delete this.plugins[s]):r.set(s,new l(this,d||{}))}for(const[s,l]of r)this.plugins[s]=l,l.attach()}detachPlugins(e){e=e||Object.keys(this.plugins);for(const r of e){const s=this.plugins[r];s&&s.detach(),delete this.plugins[r]}return this.emit("detachPlugins"),this}}var Ct;(function(p){p[p.Init=0]="Init",p[p.Error=1]="Error",p[p.Ready=2]="Ready",p[p.Panning=3]="Panning",p[p.Mousemove=4]="Mousemove",p[p.Destroy=5]="Destroy"})(Ct||(Ct={}));const oi=["a","b","c","d","e","f"],Os={PANUP:"Move up",PANDOWN:"Move down",PANLEFT:"Move left",PANRIGHT:"Move right",ZOOMIN:"Zoom in",ZOOMOUT:"Zoom out",TOGGLEZOOM:"Toggle zoom level",TOGGLE1TO1:"Toggle zoom level",ITERATEZOOM:"Toggle zoom level",ROTATECCW:"Rotate counterclockwise",ROTATECW:"Rotate clockwise",FLIPX:"Flip horizontally",FLIPY:"Flip vertically",FITX:"Fit horizontally",FITY:"Fit vertically",RESET:"Reset",TOGGLEFS:"Toggle fullscreen"},sd={content:null,width:"auto",height:"auto",panMode:"drag",touch:!0,dragMinThreshold:3,lockAxis:!1,mouseMoveFactor:1,mouseMoveFriction:.12,zoom:!0,pinchToZoom:!0,panOnlyZoomed:"auto",minScale:1,maxScale:2,friction:.25,dragFriction:.35,decelFriction:.05,click:"toggleZoom",dblClick:!1,wheel:"zoom",wheelLimit:7,spinner:!0,bounds:"auto",infinite:!1,rubberband:!0,bounce:!0,maxVelocity:75,transformParent:!1,classes:{content:"f-panzoom__content",isLoading:"is-loading",canZoomIn:"can-zoom_in",canZoomOut:"can-zoom_out",isDraggable:"is-draggable",isDragging:"is-dragging",inFullscreen:"in-fullscreen",htmlHasFullscreen:"with-panzoom-in-fullscreen"},l10n:Os},Po='<circle cx="25" cy="25" r="20"></circle>',lo='<div class="f-spinner"><svg viewBox="0 0 50 50">'+Po+Po+"</svg></div>",vn=p=>p&&p!==null&&p instanceof Element&&"nodeType"in p,St=(p,e)=>{p&&oo(e).forEach(r=>{p.classList.remove(r)})},qe=(p,e)=>{p&&oo(e).forEach(r=>{p.classList.add(r)})},Kr={a:1,b:0,c:0,d:1,e:0,f:0},ld=1e5,Gr=1e4,Ln="mousemove",Ro="drag",Io="content",Dn="auto";let Ta=null,Ma=null;class Fi extends so{get fits(){return this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1}get isTouchDevice(){return Ma===null&&(Ma=window.matchMedia("(hover: none)").matches),Ma}get isMobile(){return Ta===null&&(Ta=/iPhone|iPad|iPod|Android/i.test(navigator.userAgent)),Ta}get panMode(){return this.options.panMode!==Ln||this.isTouchDevice?Ro:Ln}get panOnlyZoomed(){const e=this.options.panOnlyZoomed;return e===Dn?this.isTouchDevice:e}get isInfinite(){return this.option("infinite")}get angle(){return 180*Math.atan2(this.current.b,this.current.a)/Math.PI||0}get targetAngle(){return 180*Math.atan2(this.target.b,this.target.a)/Math.PI||0}get scale(){const{a:e,b:r}=this.current;return Math.sqrt(e*e+r*r)||1}get targetScale(){const{a:e,b:r}=this.target;return Math.sqrt(e*e+r*r)||1}get minScale(){return this.option("minScale")||1}get fullScale(){const{contentRect:e}=this;return e.fullWidth/e.fitWidth||1}get maxScale(){return this.fullScale*(this.option("maxScale")||1)||1}get coverScale(){const{containerRect:e,contentRect:r}=this,s=Math.max(e.height/r.fitHeight,e.width/r.fitWidth)||1;return Math.min(this.fullScale,s)}get isScaling(){return Math.abs(this.targetScale-this.scale)>1e-5&&!this.isResting}get isContentLoading(){const e=this.content;return!!(e&&e instanceof HTMLImageElement)&&!e.complete}get isResting(){if(this.isBouncingX||this.isBouncingY)return!1;for(const e of oi){const r=e=="e"||e==="f"?1e-4:1e-5;if(Math.abs(this.target[e]-this.current[e])>r)return!1}return!(!this.ignoreBounds&&!this.checkBounds().inBounds)}constructor(e,r={},s={}){var l;if(super(r),Object.defineProperty(this,"pointerTracker",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"resizeObserver",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"updateTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"rAF",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isTicking",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreBounds",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingX",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"isBouncingY",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"clicks",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"trackingPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"cwd",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"pmme",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"friction",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Ct.Init}),Object.defineProperty(this,"isDragging",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"spinner",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"containerRect",{enumerable:!0,configurable:!0,writable:!0,value:{width:0,height:0,innerWidth:0,innerHeight:0}}),Object.defineProperty(this,"contentRect",{enumerable:!0,configurable:!0,writable:!0,value:{top:0,right:0,bottom:0,left:0,fullWidth:0,fullHeight:0,fitWidth:0,fitHeight:0,width:0,height:0}}),Object.defineProperty(this,"dragStart",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,top:0,left:0,time:0}}),Object.defineProperty(this,"dragOffset",{enumerable:!0,configurable:!0,writable:!0,value:{x:0,y:0,time:0}}),Object.defineProperty(this,"current",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},Kr)}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:Object.assign({},Kr)}),Object.defineProperty(this,"velocity",{enumerable:!0,configurable:!0,writable:!0,value:{a:0,b:0,c:0,d:0,e:0,f:0}}),Object.defineProperty(this,"lockedAxis",{enumerable:!0,configurable:!0,writable:!0,value:!1}),!e)throw new Error("Container Element Not Found");this.container=e,this.initContent(),this.attachPlugins(Object.assign(Object.assign({},Fi.Plugins),s)),this.emit("attachPlugins"),this.emit("init");const d=this.content;if(d.addEventListener("load",this.onLoad),d.addEventListener("error",this.onError),this.isContentLoading){if(this.option("spinner")){e.classList.add(this.cn("isLoading"));const m=Jn(lo);!e.contains(d)||d.parentElement instanceof HTMLPictureElement?this.spinner=e.appendChild(m):this.spinner=((l=d.parentElement)===null||l===void 0?void 0:l.insertBefore(m,d))||null}this.emit("beforeLoad")}else queueMicrotask(()=>{this.enable()})}initContent(){const{container:e}=this,r=this.cn(Io);let s=this.option(Io)||e.querySelector(`.${r}`);if(s||(s=e.querySelector("img,picture")||e.firstElementChild,s&&qe(s,r)),s instanceof HTMLPictureElement&&(s=s.querySelector("img")),!s)throw new Error("No content found");this.content=s}onLoad(){const{spinner:e,container:r,state:s}=this;e&&(e.remove(),this.spinner=null),this.option("spinner")&&r.classList.remove(this.cn("isLoading")),this.emit("afterLoad"),s===Ct.Init?this.enable():this.updateMetrics()}onError(){this.state!==Ct.Destroy&&(this.spinner&&(this.spinner.remove(),this.spinner=null),this.stop(),this.detachEvents(),this.state=Ct.Error,this.emit("error"))}getNextScale(e){const{fullScale:r,targetScale:s,coverScale:l,maxScale:d,minScale:m}=this;let u=m;switch(e){case"toggleMax":u=s-m<.5*(d-m)?d:m;break;case"toggleCover":u=s-m<.5*(l-m)?l:m;break;case"toggleZoom":u=s-m<.5*(r-m)?r:m;break;case"iterateZoom":let g=[1,r,d].sort((k,h)=>k-h),x=g.findIndex(k=>k>s+1e-5);u=g[x]||1}return u}attachObserver(){var e;const r=()=>{const{container:s,containerRect:l}=this;return Math.abs(l.width-s.getBoundingClientRect().width)>.1||Math.abs(l.height-s.getBoundingClientRect().height)>.1};this.resizeObserver||window.ResizeObserver===void 0||(this.resizeObserver=new ResizeObserver(()=>{this.updateTimer||(r()?(this.onResize(),this.isMobile&&(this.updateTimer=setTimeout(()=>{r()&&this.onResize(),this.updateTimer=null},500))):this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null))})),(e=this.resizeObserver)===null||e===void 0||e.observe(this.container)}detachObserver(){var e;(e=this.resizeObserver)===null||e===void 0||e.disconnect()}attachEvents(){const{container:e}=this;e.addEventListener("click",this.onClick,{passive:!1,capture:!1}),e.addEventListener("wheel",this.onWheel,{passive:!1}),this.pointerTracker=new od(e,{start:this.onPointerDown,move:this.onPointerMove,end:this.onPointerUp}),document.addEventListener(Ln,this.onMouseMove)}detachEvents(){var e;const{container:r}=this;r.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),r.removeEventListener("wheel",this.onWheel,{passive:!1}),(e=this.pointerTracker)===null||e===void 0||e.stop(),this.pointerTracker=null,document.removeEventListener(Ln,this.onMouseMove),document.removeEventListener("keydown",this.onKeydown,!0),this.clickTimer&&(clearTimeout(this.clickTimer),this.clickTimer=null),this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null)}animate(){this.setTargetForce();const e=this.friction,r=this.option("maxVelocity");for(const s of oi)e?(this.velocity[s]*=1-e,r&&!this.isScaling&&(this.velocity[s]=Math.max(Math.min(this.velocity[s],r),-1*r)),this.current[s]+=this.velocity[s]):this.current[s]=this.target[s];this.setTransform(),this.setEdgeForce(),!this.isResting||this.isDragging?this.rAF=requestAnimationFrame(()=>this.animate()):this.stop("current")}setTargetForce(){for(const e of oi)e==="e"&&this.isBouncingX||e==="f"&&this.isBouncingY||(this.velocity[e]=(1/(1-this.friction)-1)*(this.target[e]-this.current[e]))}checkBounds(e=0,r=0){const{current:s}=this,l=s.e+e,d=s.f+r,m=this.getBounds(),{x:u,y:g}=m,x=u.min,k=u.max,h=g.min,f=g.max;let b=0,y=0;return x!==1/0&&l<x?b=x-l:k!==1/0&&l>k&&(b=k-l),h!==1/0&&d<h?y=h-d:f!==1/0&&d>f&&(y=f-d),Math.abs(b)<1e-4&&(b=0),Math.abs(y)<1e-4&&(y=0),Object.assign(Object.assign({},m),{xDiff:b,yDiff:y,inBounds:!b&&!y})}clampTargetBounds(){const{target:e}=this,{x:r,y:s}=this.getBounds();r.min!==1/0&&(e.e=Math.max(e.e,r.min)),r.max!==1/0&&(e.e=Math.min(e.e,r.max)),s.min!==1/0&&(e.f=Math.max(e.f,s.min)),s.max!==1/0&&(e.f=Math.min(e.f,s.max))}calculateContentDim(e=this.current){const{content:r,contentRect:s}=this,{fitWidth:l,fitHeight:d,fullWidth:m,fullHeight:u}=s;let g=m,x=u;if(this.option("zoom")||this.angle!==0){const k=!(r instanceof HTMLImageElement)&&(window.getComputedStyle(r).maxWidth==="none"||window.getComputedStyle(r).maxHeight==="none"),h=k?m:l,f=k?u:d,b=this.getMatrix(e),y=new DOMPoint(0,0).matrixTransform(b),E=new DOMPoint(0+h,0).matrixTransform(b),w=new DOMPoint(0+h,0+f).matrixTransform(b),C=new DOMPoint(0,0+f).matrixTransform(b),_=Math.abs(w.x-y.x),T=Math.abs(w.y-y.y),M=Math.abs(C.x-E.x),v=Math.abs(C.y-E.y);g=Math.max(_,M),x=Math.max(T,v)}return{contentWidth:g,contentHeight:x}}setEdgeForce(){if(this.ignoreBounds||this.isDragging||this.panMode===Ln||this.targetScale<this.scale)return this.isBouncingX=!1,void(this.isBouncingY=!1);const{target:e}=this,{x:r,y:s,xDiff:l,yDiff:d}=this.checkBounds(),m=this.option("maxVelocity");let u=this.velocity.e,g=this.velocity.f;l!==0?(this.isBouncingX=!0,l*u<=0?u+=.14*l:(u=.14*l,r.min!==1/0&&(this.target.e=Math.max(e.e,r.min)),r.max!==1/0&&(this.target.e=Math.min(e.e,r.max))),m&&(u=Math.max(Math.min(u,m),-1*m))):this.isBouncingX=!1,d!==0?(this.isBouncingY=!0,d*g<=0?g+=.14*d:(g=.14*d,s.min!==1/0&&(this.target.f=Math.max(e.f,s.min)),s.max!==1/0&&(this.target.f=Math.min(e.f,s.max))),m&&(g=Math.max(Math.min(g,m),-1*m))):this.isBouncingY=!1,this.isBouncingX&&(this.velocity.e=u),this.isBouncingY&&(this.velocity.f=g)}enable(){const{content:e}=this,r=new DOMMatrixReadOnly(window.getComputedStyle(e).transform);for(const s of oi)this.current[s]=this.target[s]=r[s];this.updateMetrics(),this.attachObserver(),this.attachEvents(),this.state=Ct.Ready,this.emit("ready")}onClick(e){var r;e.type==="click"&&e.detail===0&&(this.dragOffset.x=0,this.dragOffset.y=0),this.isDragging&&((r=this.pointerTracker)===null||r===void 0||r.clear(),this.trackingPoints=[],this.startDecelAnim());const s=e.target;if(!s||e.defaultPrevented)return;if(s.hasAttribute("disabled"))return e.preventDefault(),void e.stopPropagation();if((()=>{const b=window.getSelection();return b&&b.type==="Range"})()&&!s.closest("button"))return;const l=s.closest("[data-panzoom-action]"),d=s.closest("[data-panzoom-change]"),m=l||d,u=m&&vn(m)?m.dataset:null;if(u){const b=u.panzoomChange,y=u.panzoomAction;if((b||y)&&e.preventDefault(),b){let E={};try{E=JSON.parse(b)}catch{console&&console.warn("The given data was not valid JSON")}return void this.applyChange(E)}if(y)return void(this[y]&&this[y]())}if(Math.abs(this.dragOffset.x)>3||Math.abs(this.dragOffset.y)>3)return e.preventDefault(),void e.stopPropagation();if(s.closest("[data-fancybox]"))return;const g=this.content.getBoundingClientRect(),x=this.dragStart;if(x.time&&!this.canZoomOut()&&(Math.abs(g.x-x.x)>2||Math.abs(g.y-x.y)>2))return;this.dragStart.time=0;const k=b=>{this.option("zoom",e)&&b&&typeof b=="string"&&/(iterateZoom)|(toggle(Zoom|Full|Cover|Max)|(zoomTo(Fit|Cover|Max)))/.test(b)&&typeof this[b]=="function"&&(e.preventDefault(),this[b]({event:e}))},h=this.option("click",e),f=this.option("dblClick",e);f?(this.clicks++,this.clicks==1&&(this.clickTimer=setTimeout(()=>{this.clicks===1?(this.emit("click",e),!e.defaultPrevented&&h&&k(h)):(this.emit("dblClick",e),e.defaultPrevented||k(f)),this.clicks=0,this.clickTimer=null},350))):(this.emit("click",e),!e.defaultPrevented&&h&&k(h))}addTrackingPoint(e){const r=this.trackingPoints.filter(s=>s.time>Date.now()-100);r.push(e),this.trackingPoints=r}onPointerDown(e,r,s){var l;if(this.option("touch",e)===!1)return!1;this.pwt=0,this.dragOffset={x:0,y:0,time:0},this.trackingPoints=[];const d=this.content.getBoundingClientRect();if(this.dragStart={x:d.x,y:d.y,top:d.top,left:d.left,time:Date.now()},this.clickTimer)return!1;if(this.panMode===Ln&&this.targetScale>1)return e.preventDefault(),e.stopPropagation(),!1;const m=e.composedPath()[0];if(!s.length){if(["TEXTAREA","OPTION","INPUT","SELECT","VIDEO","IFRAME"].includes(m.nodeName)||m.closest("[contenteditable],[data-selectable],[data-draggable],[data-clickable],[data-panzoom-change],[data-panzoom-action]"))return!1;(l=window.getSelection())===null||l===void 0||l.removeAllRanges()}if(e.type==="mousedown")["A","BUTTON"].includes(m.nodeName)||e.preventDefault();else if(Math.abs(this.velocity.a)>.3)return!1;return this.target.e=this.current.e,this.target.f=this.current.f,this.stop(),this.isDragging||(this.isDragging=!0,this.addTrackingPoint(r),this.emit("touchStart",e)),!0}onPointerMove(e,r,s){if(this.option("touch",e)===!1||!this.isDragging||r.length<2&&this.panOnlyZoomed&&Ae(this.targetScale)<=Ae(this.minScale)||(this.emit("touchMove",e),e.defaultPrevented))return;this.addTrackingPoint(r[0]);const{content:l}=this,d=Oo(s[0],s[1]),m=Oo(r[0],r[1]);let u=0,g=0;if(r.length>1){const T=l.getBoundingClientRect();u=d.clientX-T.left-.5*T.width,g=d.clientY-T.top-.5*T.height}const x=Do(s[0],s[1]),k=Do(r[0],r[1]);let h=x?k/x:1,f=m.clientX-d.clientX,b=m.clientY-d.clientY;this.dragOffset.x+=f,this.dragOffset.y+=b,this.dragOffset.time=Date.now()-this.dragStart.time;let y=Ae(this.targetScale)===Ae(this.minScale)&&this.option("lockAxis");if(y&&!this.lockedAxis)if(y==="xy"||y==="y"||e.type==="touchmove"){if(Math.abs(this.dragOffset.x)<6&&Math.abs(this.dragOffset.y)<6)return void e.preventDefault();const T=Math.abs(180*Math.atan2(this.dragOffset.y,this.dragOffset.x)/Math.PI);this.lockedAxis=T>45&&T<135?"y":"x",this.dragOffset.x=0,this.dragOffset.y=0,f=0,b=0}else this.lockedAxis=y;if(da(e.target,this.content)&&(y="x",this.dragOffset.y=0),y&&y!=="xy"&&this.lockedAxis!==y&&Ae(this.targetScale)===Ae(this.minScale))return;e.cancelable&&e.preventDefault(),this.container.classList.add(this.cn("isDragging"));const E=this.checkBounds(f,b);this.option("rubberband")?(this.isInfinite!=="x"&&(E.xDiff>0&&f<0||E.xDiff<0&&f>0)&&(f*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitWidth*E.xDiff))),this.isInfinite!=="y"&&(E.yDiff>0&&b<0||E.yDiff<0&&b>0)&&(b*=Math.max(0,.5-Math.abs(.75/this.contentRect.fitHeight*E.yDiff)))):(E.xDiff&&(f=0),E.yDiff&&(b=0));const w=this.targetScale,C=this.minScale,_=this.maxScale;w<.5*C&&(h=Math.max(h,C)),w>1.5*_&&(h=Math.min(h,_)),this.lockedAxis==="y"&&Ae(w)===Ae(C)&&(f=0),this.lockedAxis==="x"&&Ae(w)===Ae(C)&&(b=0),this.applyChange({originX:u,originY:g,panX:f,panY:b,scale:h,friction:this.option("dragFriction"),ignoreBounds:!0})}onPointerUp(e,r,s){if(s.length)return this.dragOffset.x=0,this.dragOffset.y=0,void(this.trackingPoints=[]);this.container.classList.remove(this.cn("isDragging")),this.isDragging&&(this.addTrackingPoint(r),this.panOnlyZoomed&&this.contentRect.width-this.contentRect.fitWidth<1&&this.contentRect.height-this.contentRect.fitHeight<1&&(this.trackingPoints=[]),da(e.target,this.content)&&this.lockedAxis==="y"&&(this.trackingPoints=[]),this.emit("touchEnd",e),this.isDragging=!1,this.lockedAxis=!1,this.state!==Ct.Destroy&&(e.defaultPrevented||this.startDecelAnim()))}startDecelAnim(){var e;const r=this.isScaling;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const T of oi)this.velocity[T]=0;this.target.e=this.current.e,this.target.f=this.current.f,St(this.container,"is-scaling"),St(this.container,"is-animating"),this.isTicking=!1;const{trackingPoints:s}=this,l=s[0],d=s[s.length-1];let m=0,u=0,g=0;d&&l&&(m=d.clientX-l.clientX,u=d.clientY-l.clientY,g=d.time-l.time);const x=((e=window.visualViewport)===null||e===void 0?void 0:e.scale)||1;x!==1&&(m*=x,u*=x);let k=0,h=0,f=0,b=0,y=this.option("decelFriction");const E=this.targetScale;if(g>0){f=Math.abs(m)>3?m/(g/30):0,b=Math.abs(u)>3?u/(g/30):0;const T=this.option("maxVelocity");T&&(f=Math.max(Math.min(f,T),-1*T),b=Math.max(Math.min(b,T),-1*T))}f&&(k=f/(1/(1-y)-1)),b&&(h=b/(1/(1-y)-1)),(this.option("lockAxis")==="y"||this.option("lockAxis")==="xy"&&this.lockedAxis==="y"&&Ae(E)===this.minScale)&&(k=f=0),(this.option("lockAxis")==="x"||this.option("lockAxis")==="xy"&&this.lockedAxis==="x"&&Ae(E)===this.minScale)&&(h=b=0);const w=this.dragOffset.x,C=this.dragOffset.y,_=this.option("dragMinThreshold")||0;Math.abs(w)<_&&Math.abs(C)<_&&(k=h=0,f=b=0),(this.option("zoom")&&(E<this.minScale-1e-5||E>this.maxScale+1e-5)||r&&!k&&!h)&&(y=.35),this.applyChange({panX:k,panY:h,friction:y}),this.emit("decel",f,b,w,C)}onWheel(e){var r=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(d,m){return Math.abs(m)>Math.abs(d)?m:d});const s=Math.max(-1,Math.min(1,r));if(this.emit("wheel",e,s),this.panMode===Ln||e.defaultPrevented)return;const l=this.option("wheel");l==="pan"?(e.preventDefault(),this.panOnlyZoomed&&!this.canZoomOut()||this.applyChange({panX:2*-e.deltaX,panY:2*-e.deltaY,bounce:!1})):l==="zoom"&&this.option("zoom")!==!1&&this.zoomWithWheel(e)}onMouseMove(e){this.panWithMouse(e)}onKeydown(e){e.key==="Escape"&&this.toggleFS()}onResize(){this.updateMetrics(),this.checkBounds().inBounds||this.requestTick()}setTransform(){this.emit("beforeTransform");const{current:e,target:r,content:s,contentRect:l}=this,d=Object.assign({},Kr);for(const w of oi){const C=w=="e"||w==="f"?Gr:ld;d[w]=Ae(e[w],C),Math.abs(r[w]-e[w])<(w=="e"||w==="f"?.51:.001)&&(e[w]=r[w])}let{a:m,b:u,c:g,d:x,e:k,f:h}=d,f=`matrix(${m}, ${u}, ${g}, ${x}, ${k}, ${h})`,b=s.parentElement instanceof HTMLPictureElement?s.parentElement:s;if(this.option("transformParent")&&(b=b.parentElement||b),b.style.transform===f)return;b.style.transform=f;const{contentWidth:y,contentHeight:E}=this.calculateContentDim();l.width=y,l.height=E,this.emit("afterTransform")}updateMetrics(e=!1){var r;if(!this||this.state===Ct.Destroy||this.isContentLoading)return;const s=Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1),{container:l,content:d}=this,m=d instanceof HTMLImageElement,u=l.getBoundingClientRect(),g=getComputedStyle(this.container);let x=u.width*s,k=u.height*s;const h=parseFloat(g.paddingTop)+parseFloat(g.paddingBottom),f=x-(parseFloat(g.paddingLeft)+parseFloat(g.paddingRight)),b=k-h;this.containerRect={width:x,height:k,innerWidth:f,innerHeight:b};const y=parseFloat(d.dataset.width||"")||(X=>{let he=0;return he=X instanceof HTMLImageElement?X.naturalWidth:X instanceof SVGElement?X.width.baseVal.value:Math.max(X.offsetWidth,X.scrollWidth),he||0})(d),E=parseFloat(d.dataset.height||"")||(X=>{let he=0;return he=X instanceof HTMLImageElement?X.naturalHeight:X instanceof SVGElement?X.height.baseVal.value:Math.max(X.offsetHeight,X.scrollHeight),he||0})(d);let w=this.option("width",y)||Dn,C=this.option("height",E)||Dn;const _=w===Dn,T=C===Dn;typeof w!="number"&&(w=y),typeof C!="number"&&(C=E),_&&(w=y*(C/E)),T&&(C=E/(y/w));let M=d.parentElement instanceof HTMLPictureElement?d.parentElement:d;this.option("transformParent")&&(M=M.parentElement||M);const v=M.getAttribute("style")||"";M.style.setProperty("transform","none","important"),m&&(M.style.width="",M.style.height=""),M.offsetHeight;const D=d.getBoundingClientRect();let N=D.width*s,z=D.height*s,H=N,Y=z;N=Math.min(N,w),z=Math.min(z,C),m?{width:N,height:z}=((X,he,Se,Ue)=>{const Le=Se/X,Pe=Ue/he,Ie=Math.min(Le,Pe);return{width:X*=Ie,height:he*=Ie}})(w,C,N,z):(N=Math.min(N,w),z=Math.min(z,C));let U=.5*(Y-z),j=.5*(H-N);this.contentRect=Object.assign(Object.assign({},this.contentRect),{top:D.top-u.top+U,bottom:u.bottom-D.bottom+U,left:D.left-u.left+j,right:u.right-D.right+j,fitWidth:N,fitHeight:z,width:N,height:z,fullWidth:w,fullHeight:C}),M.style.cssText=v,m&&(M.style.width=`${N}px`,M.style.height=`${z}px`),this.setTransform(),e!==!0&&this.emit("refresh"),this.ignoreBounds||(Ae(this.targetScale)<Ae(this.minScale)?this.zoomTo(this.minScale,{friction:0}):this.targetScale>this.maxScale?this.zoomTo(this.maxScale,{friction:0}):this.state===Ct.Init||this.checkBounds().inBounds||this.requestTick()),this.updateControls()}calculateBounds(){const{contentWidth:e,contentHeight:r}=this.calculateContentDim(this.target),{targetScale:s,lockedAxis:l}=this,{fitWidth:d,fitHeight:m}=this.contentRect;let u=0,g=0,x=0,k=0;const h=this.option("infinite");if(h===!0||l&&h===l)u=-1/0,x=1/0,g=-1/0,k=1/0;else{let{containerRect:f,contentRect:b}=this,y=Ae(d*s,Gr),E=Ae(m*s,Gr),{innerWidth:w,innerHeight:C}=f;if(f.width===y&&(w=f.width),f.width===E&&(C=f.height),e>w){x=.5*(e-w),u=-1*x;let _=.5*(b.right-b.left);u+=_,x+=_}if(d>w&&e<w&&(u-=.5*(d-w),x-=.5*(d-w)),r>C){k=.5*(r-C),g=-1*k;let _=.5*(b.bottom-b.top);g+=_,k+=_}m>C&&r<C&&(u-=.5*(m-C),x-=.5*(m-C))}return{x:{min:u,max:x},y:{min:g,max:k}}}getBounds(){const e=this.option("bounds");return e!==Dn?e:this.calculateBounds()}updateControls(){const e=this,r=e.container,{panMode:s,contentRect:l,targetScale:d,minScale:m}=e;let u=m,g=e.option("click")||!1;g&&(u=e.getNextScale(g));let x=e.canZoomIn(),k=e.canZoomOut(),h=s===Ro&&!!this.option("touch"),f=k&&h;if(h&&(Ae(d)<Ae(m)&&!this.panOnlyZoomed&&(f=!0),(Ae(l.width,1)>Ae(l.fitWidth,1)||Ae(l.height,1)>Ae(l.fitHeight,1))&&(f=!0)),Ae(l.width*d,1)<Ae(l.fitWidth,1)&&(f=!1),s===Ln&&(f=!1),Qn(r,this.cn("isDraggable"),f),!this.option("zoom"))return;let b=x&&Ae(u)>Ae(d),y=!b&&!f&&k&&Ae(u)<Ae(d);Qn(r,this.cn("canZoomIn"),b),Qn(r,this.cn("canZoomOut"),y);for(const E of r.querySelectorAll("[data-panzoom-action]")){let w=!1,C=!1;switch(E.dataset.panzoomAction){case"zoomIn":x?w=!0:C=!0;break;case"zoomOut":k?w=!0:C=!0;break;case"toggleZoom":case"iterateZoom":x||k?w=!0:C=!0;const _=E.querySelector("g");_&&(_.style.display=x?"":"none")}w?(E.removeAttribute("disabled"),E.removeAttribute("tabindex")):C&&(E.setAttribute("disabled",""),E.setAttribute("tabindex","-1"))}}panTo({x:e=this.target.e,y:r=this.target.f,scale:s=this.targetScale,friction:l=this.option("friction"),angle:d=0,originX:m=0,originY:u=0,flipX:g=!1,flipY:x=!1,ignoreBounds:k=!1}){this.state!==Ct.Destroy&&this.applyChange({panX:e-this.target.e,panY:r-this.target.f,scale:s/this.targetScale,angle:d,originX:m,originY:u,friction:l,flipX:g,flipY:x,ignoreBounds:k})}applyChange({panX:e=0,panY:r=0,scale:s=1,angle:l=0,originX:d=-this.current.e,originY:m=-this.current.f,friction:u=this.option("friction"),flipX:g=!1,flipY:x=!1,ignoreBounds:k=!1,bounce:h=this.option("bounce")}){const f=this.state;if(f===Ct.Destroy)return;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.friction=u||0,this.ignoreBounds=k;const{current:b}=this,y=b.e,E=b.f,w=this.getMatrix(this.target);let C=new DOMMatrix().translate(y,E).translate(d,m).translate(e,r);if(this.option("zoom")){if(!k){const _=this.targetScale,T=this.minScale,M=this.maxScale;_*s<T&&(s=T/_),_*s>M&&(s=M/_)}C=C.scale(s)}C=C.translate(-d,-m).translate(-y,-E).multiply(w),l&&(C=C.rotate(l)),g&&(C=C.scale(-1,1)),x&&(C=C.scale(1,-1));for(const _ of oi)_!=="e"&&_!=="f"&&(C[_]>this.minScale+1e-5||C[_]<this.minScale-1e-5)?this.target[_]=C[_]:this.target[_]=Ae(C[_],Gr);(this.targetScale<this.scale||Math.abs(s-1)>.1||this.panMode===Ln||h===!1)&&!k&&this.clampTargetBounds(),f===Ct.Init?this.animate():this.isResting||(this.state=Ct.Panning,this.requestTick())}stop(e=!1){if(this.state===Ct.Init||this.state===Ct.Destroy)return;const r=this.isTicking;this.rAF&&(cancelAnimationFrame(this.rAF),this.rAF=null),this.isBouncingX=!1,this.isBouncingY=!1;for(const s of oi)this.velocity[s]=0,e==="current"?this.current[s]=this.target[s]:e==="target"&&(this.target[s]=this.current[s]);this.setTransform(),St(this.container,"is-scaling"),St(this.container,"is-animating"),this.isTicking=!1,this.state=Ct.Ready,r&&(this.emit("endAnimation"),this.updateControls())}requestTick(){this.isTicking||(this.emit("startAnimation"),this.updateControls(),qe(this.container,"is-animating"),this.isScaling&&qe(this.container,"is-scaling")),this.isTicking=!0,this.rAF||(this.rAF=requestAnimationFrame(()=>this.animate()))}panWithMouse(e,r=this.option("mouseMoveFriction")){if(this.pmme=e,this.panMode!==Ln||!e||Ae(this.targetScale)<=Ae(this.minScale))return;this.emit("mouseMove",e);const{container:s,containerRect:l,contentRect:d}=this,m=l.width,u=l.height,g=s.getBoundingClientRect(),x=(e.clientX||0)-g.left,k=(e.clientY||0)-g.top;let{contentWidth:h,contentHeight:f}=this.calculateContentDim(this.target);const b=this.option("mouseMoveFactor");b>1&&(h!==m&&(h*=b),f!==u&&(f*=b));let y=.5*(h-m)-x/m*100/100*(h-m);y+=.5*(d.right-d.left);let E=.5*(f-u)-k/u*100/100*(f-u);E+=.5*(d.bottom-d.top),this.applyChange({panX:y-this.target.e,panY:E-this.target.f,friction:r})}zoomWithWheel(e){if(this.state===Ct.Destroy||this.state===Ct.Init)return;const r=Date.now();if(r-this.pwt<45)return void e.preventDefault();this.pwt=r;var s=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(x,k){return Math.abs(k)>Math.abs(x)?k:x});const l=Math.max(-1,Math.min(1,s)),{targetScale:d,maxScale:m,minScale:u}=this;let g=d*(100+45*l)/100;Ae(g)<Ae(u)&&Ae(d)<=Ae(u)?(this.cwd+=Math.abs(l),g=u):Ae(g)>Ae(m)&&Ae(d)>=Ae(m)?(this.cwd+=Math.abs(l),g=m):(this.cwd=0,g=Math.max(Math.min(g,m),u)),this.cwd>this.option("wheelLimit")||(e.preventDefault(),Ae(g)!==Ae(d)&&this.zoomTo(g,{event:e}))}canZoomIn(){return this.option("zoom")&&(Ae(this.contentRect.width,1)<Ae(this.contentRect.fitWidth,1)||Ae(this.targetScale)<Ae(this.maxScale))}canZoomOut(){return this.option("zoom")&&Ae(this.targetScale)>Ae(this.minScale)}zoomIn(e=1.25,r){this.zoomTo(this.targetScale*e,r)}zoomOut(e=.8,r){this.zoomTo(this.targetScale*e,r)}zoomToFit(e){this.zoomTo("fit",e)}zoomToCover(e){this.zoomTo("cover",e)}zoomToFull(e){this.zoomTo("full",e)}zoomToMax(e){this.zoomTo("max",e)}toggleZoom(e){this.zoomTo(this.getNextScale("toggleZoom"),e)}toggleMax(e){this.zoomTo(this.getNextScale("toggleMax"),e)}toggleCover(e){this.zoomTo(this.getNextScale("toggleCover"),e)}iterateZoom(e){this.zoomTo("next",e)}zoomTo(e=1,{friction:r=Dn,originX:s=Dn,originY:l=Dn,event:d}={}){if(this.isContentLoading||this.state===Ct.Destroy)return;const{targetScale:m,fullScale:u,maxScale:g,coverScale:x}=this;if(this.stop(),this.panMode===Ln&&(d=this.pmme||d),d||s===Dn||l===Dn){const h=this.content.getBoundingClientRect(),f=this.container.getBoundingClientRect(),b=d?d.clientX:f.left+.5*f.width,y=d?d.clientY:f.top+.5*f.height;s=b-h.left-.5*h.width,l=y-h.top-.5*h.height}let k=1;typeof e=="number"?k=e:e==="full"?k=u:e==="cover"?k=x:e==="max"?k=g:e==="fit"?k=1:e==="next"&&(k=this.getNextScale("iterateZoom")),k=k/m||1,r=r===Dn?k>1?.15:.25:r,this.applyChange({scale:k,originX:s,originY:l,friction:r}),d&&this.panMode===Ln&&this.panWithMouse(d,r)}rotateCCW(){this.applyChange({angle:-90})}rotateCW(){this.applyChange({angle:90})}flipX(){this.applyChange({flipX:!0})}flipY(){this.applyChange({flipY:!0})}fitX(){this.stop("target");const{containerRect:e,contentRect:r,target:s}=this;this.applyChange({panX:.5*e.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*e.height-(r.top+.5*r.fitHeight)-s.f,scale:e.width/r.fitWidth/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}fitY(){this.stop("target");const{containerRect:e,contentRect:r,target:s}=this;this.applyChange({panX:.5*e.width-(r.left+.5*r.fitWidth)-s.e,panY:.5*e.innerHeight-(r.top+.5*r.fitHeight)-s.f,scale:e.height/r.fitHeight/this.targetScale,originX:0,originY:0,ignoreBounds:!0})}toggleFS(){const{container:e}=this,r=this.cn("inFullscreen"),s=this.cn("htmlHasFullscreen");e.classList.toggle(r);const l=e.classList.contains(r);l?(document.documentElement.classList.add(s),document.addEventListener("keydown",this.onKeydown,!0)):(document.documentElement.classList.remove(s),document.removeEventListener("keydown",this.onKeydown,!0)),this.updateMetrics(),this.emit(l?"enterFS":"exitFS")}getMatrix(e=this.current){const{a:r,b:s,c:l,d,e:m,f:u}=e;return new DOMMatrix([r,s,l,d,m,u])}reset(e){if(this.state!==Ct.Init&&this.state!==Ct.Destroy){this.stop("current");for(const r of oi)this.target[r]=Kr[r];this.target.a=this.minScale,this.target.d=this.minScale,this.clampTargetBounds(),this.isResting||(this.friction=e===void 0?this.option("friction"):e,this.state=Ct.Panning,this.requestTick())}}destroy(){this.stop(),this.state=Ct.Destroy,this.detachEvents(),this.detachObserver();const{container:e,content:r}=this,s=this.option("classes")||{};for(const l of Object.values(s))e.classList.remove(l+"");r&&(r.removeEventListener("load",this.onLoad),r.removeEventListener("error",this.onError)),this.detachPlugins()}}Object.defineProperty(Fi,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:sd}),Object.defineProperty(Fi,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:{}});const Ho=function(p,e){let r=!0;return(...s)=>{r&&(r=!1,p(...s),setTimeout(()=>{r=!0},e))}},No=(p,e)=>{let r=[];return p.childNodes.forEach(s=>{s.nodeType!==Node.ELEMENT_NODE||e&&!s.matches(e)||r.push(s)}),r},cd={viewport:null,track:null,enabled:!0,slides:[],axis:"x",transition:"fade",preload:1,slidesPerPage:"auto",initialPage:0,friction:.12,Panzoom:{decelFriction:.12},center:!0,infinite:!0,fill:!0,dragFree:!1,adaptiveHeight:!1,direction:"ltr",classes:{container:"f-carousel",viewport:"f-carousel__viewport",track:"f-carousel__track",slide:"f-carousel__slide",isLTR:"is-ltr",isRTL:"is-rtl",isHorizontal:"is-horizontal",isVertical:"is-vertical",inTransition:"in-transition",isSelected:"is-selected"},l10n:{NEXT:"Next slide",PREV:"Previous slide",GOTO:"Go to slide #%d"}};var Wt;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Destroy=2]="Destroy"})(Wt||(Wt={}));const Aa=p=>{if(typeof p=="string"||p instanceof HTMLElement)p={html:p};else{const e=p.thumb;e!==void 0&&(typeof e=="string"&&(p.thumbSrc=e),e instanceof HTMLImageElement&&(p.thumbEl=e,p.thumbElSrc=e.src,p.thumbSrc=e.src),delete p.thumb)}return Object.assign({html:"",el:null,isDom:!1,class:"",customClass:"",index:-1,dim:0,gap:0,pos:0,transition:!1},p)},ud=(p={})=>Object.assign({index:-1,slides:[],dim:0,pos:-1},p);class qn extends fa{constructor(e,r){super(r),Object.defineProperty(this,"instance",{enumerable:!0,configurable:!0,writable:!0,value:e})}attach(){}detach(){}}const dd={classes:{list:"f-carousel__dots",isDynamic:"is-dynamic",hasDots:"has-dots",dot:"f-carousel__dot",isBeforePrev:"is-before-prev",isPrev:"is-prev",isCurrent:"is-current",isNext:"is-next",isAfterNext:"is-after-next"},dotTpl:'<button type="button" data-carousel-page="%i" aria-label="{{GOTO}}"><span class="f-carousel__dot" aria-hidden="true"></span></button>',dynamicFrom:11,maxCount:1/0,minCount:2};class Ps extends qn{constructor(){super(...arguments),Object.defineProperty(this,"isDynamic",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"list",{enumerable:!0,configurable:!0,writable:!0,value:null})}onRefresh(){this.refresh()}build(){let e=this.list;if(!e){e=document.createElement("ul"),qe(e,this.cn("list")),e.setAttribute("role","tablist");const r=this.instance.container;r.appendChild(e),qe(r,this.cn("hasDots")),this.list=e}return e}refresh(){var e;const r=this.instance.pages.length,s=Math.min(2,this.option("minCount")),l=Math.max(2e3,this.option("maxCount")),d=this.option("dynamicFrom");if(r<s||r>l)return void this.cleanup();const m=typeof d=="number"&&r>5&&r>=d,u=!this.list||this.isDynamic!==m||this.list.children.length!==r;u&&this.cleanup();const g=this.build();if(Qn(g,this.cn("isDynamic"),!!m),u)for(let h=0;h<r;h++)g.append(this.createItem(h));let x,k=0;for(const h of[...g.children]){const f=k===this.instance.page;f&&(x=h),Qn(h,this.cn("isCurrent"),f),(e=h.children[0])===null||e===void 0||e.setAttribute("aria-selected",f?"true":"false");for(const b of["isBeforePrev","isPrev","isNext","isAfterNext"])St(h,this.cn(b));k++}if(x=x||g.firstChild,m&&x){const h=x.previousElementSibling,f=h&&h.previousElementSibling;qe(h,this.cn("isPrev")),qe(f,this.cn("isBeforePrev"));const b=x.nextElementSibling,y=b&&b.nextElementSibling;qe(b,this.cn("isNext")),qe(y,this.cn("isAfterNext"))}this.isDynamic=m}createItem(e=0){var r;const s=document.createElement("li");s.setAttribute("role","presentation");const l=Jn(this.instance.localize(this.option("dotTpl"),[["%d",e+1]]).replace(/\%i/g,e+""));return s.appendChild(l),(r=s.children[0])===null||r===void 0||r.setAttribute("role","tab"),s}cleanup(){this.list&&(this.list.remove(),this.list=null),this.isDynamic=!1,St(this.instance.container,this.cn("hasDots"))}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(Ps,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:dd});const Xr="disabled",Zr="next",jo="prev";class Rs extends qn{constructor(){super(...arguments),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prev",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"next",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"isDom",{enumerable:!0,configurable:!0,writable:!0,value:!1})}onRefresh(){const e=this.instance,r=e.pages.length,s=e.page;if(r<2)return void this.cleanup();this.build();let l=this.prev,d=this.next;l&&d&&(l.removeAttribute(Xr),d.removeAttribute(Xr),e.isInfinite||(s<=0&&l.setAttribute(Xr,""),s>=r-1&&d.setAttribute(Xr,"")))}addBtn(e){var r;const s=this.instance,l=document.createElement("button");l.setAttribute("tabindex","0"),l.setAttribute("title",s.localize(`{{${e.toUpperCase()}}}`)),qe(l,this.cn("button")+" "+this.cn(e===Zr?"isNext":"isPrev"));const d=s.isRTL?e===Zr?jo:Zr:e;var m;return l.innerHTML=s.localize(this.option(`${d}Tpl`)),l.dataset[`carousel${m=e,m?m.match("^[a-z]")?m.charAt(0).toUpperCase()+m.substring(1):m:""}`]="true",(r=this.container)===null||r===void 0||r.appendChild(l),l}build(){const e=this.instance.container,r=this.cn("container");let{container:s,prev:l,next:d}=this;s||(s=e.querySelector("."+r),this.isDom=!!s),s||(s=document.createElement("div"),qe(s,r),e.appendChild(s)),this.container=s,d||(d=s.querySelector("[data-carousel-next]")),d||(d=this.addBtn(Zr)),this.next=d,l||(l=s.querySelector("[data-carousel-prev]")),l||(l=this.addBtn(jo)),this.prev=l}cleanup(){this.isDom||(this.prev&&this.prev.remove(),this.next&&this.next.remove(),this.container&&this.container.remove()),this.prev=null,this.next=null,this.container=null,this.isDom=!1}attach(){this.instance.on(["refresh","change"],this.onRefresh)}detach(){this.instance.off(["refresh","change"],this.onRefresh),this.cleanup()}}Object.defineProperty(Rs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{classes:{container:"f-carousel__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"},nextTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M9 3l9 9-9 9"/></svg>',prevTpl:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M15 3l-9 9 9 9"/></svg>'}});class Is extends qn{constructor(){super(...arguments),Object.defineProperty(this,"selectedIndex",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"target",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"nav",{enumerable:!0,configurable:!0,writable:!0,value:null})}addAsTargetFor(e){this.target=this.instance,this.nav=e,this.attachEvents()}addAsNavFor(e){this.nav=this.instance,this.target=e,this.attachEvents()}attachEvents(){const{nav:e,target:r}=this;e&&r&&(e.options.initialSlide=r.options.initialPage,e.state===Wt.Ready?this.onNavReady(e):e.on("ready",this.onNavReady),r.state===Wt.Ready?this.onTargetReady(r):r.on("ready",this.onTargetReady))}onNavReady(e){e.on("createSlide",this.onNavCreateSlide),e.on("Panzoom.click",this.onNavClick),e.on("Panzoom.touchEnd",this.onNavTouch),this.onTargetChange()}onTargetReady(e){e.on("change",this.onTargetChange),e.on("Panzoom.refresh",this.onTargetChange),this.onTargetChange()}onNavClick(e,r,s){this.onNavTouch(e,e.panzoom,s)}onNavTouch(e,r,s){var l,d;if(Math.abs(r.dragOffset.x)>3||Math.abs(r.dragOffset.y)>3)return;const m=s.target,{nav:u,target:g}=this;if(!u||!g||!m)return;const x=m.closest("[data-index]");if(s.stopPropagation(),s.preventDefault(),!x)return;const k=parseInt(x.dataset.index||"",10)||0,h=g.getPageForSlide(k),f=u.getPageForSlide(k);u.slideTo(f),g.slideTo(h,{friction:((d=(l=this.nav)===null||l===void 0?void 0:l.plugins)===null||d===void 0?void 0:d.Sync.option("friction"))||0}),this.markSelectedSlide(k)}onNavCreateSlide(e,r){r.index===this.selectedIndex&&this.markSelectedSlide(r.index)}onTargetChange(){var e,r;const{target:s,nav:l}=this;if(!s||!l||l.state!==Wt.Ready||s.state!==Wt.Ready)return;const d=(r=(e=s.pages[s.page])===null||e===void 0?void 0:e.slides[0])===null||r===void 0?void 0:r.index,m=l.getPageForSlide(d);this.markSelectedSlide(d),l.slideTo(m,l.prevPage===null&&s.prevPage===null?{friction:0}:void 0)}markSelectedSlide(e){const r=this.nav;r&&r.state===Wt.Ready&&(this.selectedIndex=e,[...r.slides].map(s=>{s.el&&s.el.classList[s.index===e?"add":"remove"]("is-nav-selected")}))}attach(){const e=this;let r=e.options.target,s=e.options.nav;r?e.addAsNavFor(r):s&&e.addAsTargetFor(s)}detach(){const e=this,r=e.nav,s=e.target;r&&(r.off("ready",e.onNavReady),r.off("createSlide",e.onNavCreateSlide),r.off("Panzoom.click",e.onNavClick),r.off("Panzoom.touchEnd",e.onNavTouch)),e.nav=null,s&&(s.off("ready",e.onTargetReady),s.off("refresh",e.onTargetChange),s.off("change",e.onTargetChange)),e.target=null}}Object.defineProperty(Is,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{friction:.35}});const fd={Navigation:Rs,Dots:Ps,Sync:Is},Jr="animationend",$o="isSelected",Qr="slide";class Ui extends so{get axis(){return this.isHorizontal?"e":"f"}get isEnabled(){return this.state===Wt.Ready}get isInfinite(){let e=!1;const{contentDim:r,viewportDim:s,pages:l,slides:d}=this,m=d[0];return l.length>=2&&m&&r+m.dim>=s&&(e=this.option("infinite")),e}get isRTL(){return this.option("direction")==="rtl"}get isHorizontal(){return this.option("axis")==="x"}constructor(e,r={},s={}){if(super(),Object.defineProperty(this,"bp",{enumerable:!0,configurable:!0,writable:!0,value:""}),Object.defineProperty(this,"lp",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"userOptions",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Wt.Init}),Object.defineProperty(this,"page",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"prevPage",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"viewport",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"slides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"pages",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"panzoom",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"inTransition",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"contentDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"viewportDim",{enumerable:!0,configurable:!0,writable:!0,value:0}),typeof e=="string"&&(e=document.querySelector(e)),!e||!vn(e))throw new Error("No Element found");this.container=e,this.slideNext=Ho(this.slideNext.bind(this),150),this.slidePrev=Ho(this.slidePrev.bind(this),150),this.userOptions=r,this.userPlugins=s,queueMicrotask(()=>{this.processOptions()})}processOptions(){var e,r;const s=bn({},Ui.defaults,this.userOptions);let l="";const d=s.breakpoints;if(d&&Ka(d))for(const[m,u]of Object.entries(d))window.matchMedia(m).matches&&Ka(u)&&(l+=m,bn(s,u));l===this.bp&&this.state!==Wt.Init||(this.bp=l,this.state===Wt.Ready&&(s.initialSlide=((r=(e=this.pages[this.page])===null||e===void 0?void 0:e.slides[0])===null||r===void 0?void 0:r.index)||0),this.state!==Wt.Init&&this.destroy(),super.setOptions(s),this.option("enabled")===!1?this.attachEvents():setTimeout(()=>{this.init()},0))}init(){this.state=Wt.Init,this.emit("init"),this.attachPlugins(Object.assign(Object.assign({},Ui.Plugins),this.userPlugins)),this.emit("attachPlugins"),this.initLayout(),this.initSlides(),this.updateMetrics(),this.setInitialPosition(),this.initPanzoom(),this.attachEvents(),this.state=Wt.Ready,this.emit("ready")}initLayout(){const{container:e}=this,r=this.option("classes");qe(e,this.cn("container")),Qn(e,r.isLTR,!this.isRTL),Qn(e,r.isRTL,this.isRTL),Qn(e,r.isVertical,!this.isHorizontal),Qn(e,r.isHorizontal,this.isHorizontal);let s=this.option("viewport")||e.querySelector(`.${r.viewport}`);s||(s=document.createElement("div"),qe(s,r.viewport),s.append(...No(e,`.${r.slide}`)),e.prepend(s)),s.addEventListener("scroll",this.onScroll);let l=this.option("track")||e.querySelector(`.${r.track}`);l||(l=document.createElement("div"),qe(l,r.track),l.append(...Array.from(s.childNodes))),l.setAttribute("aria-live","polite"),s.contains(l)||s.prepend(l),this.viewport=s,this.track=l,this.emit("initLayout")}initSlides(){const{track:e}=this;if(!e)return;const r=[...this.slides],s=[];[...No(e,`.${this.cn(Qr)}`)].forEach(l=>{if(vn(l)){const d=Aa({el:l,isDom:!0,index:this.slides.length});s.push(d)}});for(let l of[...this.option("slides",[])||[],...r])s.push(Aa(l));this.slides=s;for(let l=0;l<this.slides.length;l++)this.slides[l].index=l;for(const l of s)this.emit("beforeInitSlide",l,l.index),this.emit("initSlide",l,l.index);this.emit("initSlides")}setInitialPage(){const e=this.option("initialSlide");this.page=typeof e=="number"?this.getPageForSlide(e):parseInt(this.option("initialPage",0)+"",10)||0}setInitialPosition(){const{track:e,pages:r,isHorizontal:s}=this;if(!e||!r.length)return;let l=this.page;r[l]||(this.page=l=0);const d=(r[l].pos||0)*(this.isRTL&&s?1:-1),m=s?`${d}px`:"0",u=s?"0":`${d}px`;e.style.transform=`translate3d(${m}, ${u}, 0) scale(1)`,this.option("adaptiveHeight")&&this.setViewportHeight()}initPanzoom(){this.panzoom&&(this.panzoom.destroy(),this.panzoom=null);const e=this.option("Panzoom")||{};this.panzoom=new Fi(this.viewport,bn({},{content:this.track,zoom:!1,panOnlyZoomed:!1,lockAxis:this.isHorizontal?"x":"y",infinite:this.isInfinite,click:!1,dblClick:!1,touch:r=>!(this.pages.length<2&&!r.options.infinite),bounds:()=>this.getBounds(),maxVelocity:r=>Math.abs(r.target[this.axis]-r.current[this.axis])<2*this.viewportDim?100:0},e)),this.panzoom.on("*",(r,s,...l)=>{this.emit(`Panzoom.${s}`,r,...l)}),this.panzoom.on("decel",this.onDecel),this.panzoom.on("refresh",this.onRefresh),this.panzoom.on("beforeTransform",this.onBeforeTransform),this.panzoom.on("endAnimation",this.onEndAnimation)}attachEvents(){const e=this.container;e&&(e.addEventListener("click",this.onClick,{passive:!1,capture:!1}),e.addEventListener("slideTo",this.onSlideTo)),window.addEventListener("resize",this.onResize)}createPages(){let e=[];const{contentDim:r,viewportDim:s}=this;let l=this.option("slidesPerPage");l=(l==="auto"||r<=s)&&this.option("fill")!==!1?1/0:parseFloat(l+"");let d=0,m=0,u=0;for(const g of this.slides)(!e.length||m+g.dim-s>.05||u>=l)&&(e.push(ud()),d=e.length-1,m=0,u=0),e[d].slides.push(g),m+=g.dim+g.gap,u++;return e}processPages(){const e=this.pages,{contentDim:r,viewportDim:s,isInfinite:l}=this,d=this.option("center"),m=this.option("fill"),u=m&&d&&r>s&&!l;if(e.forEach((k,h)=>{var f;k.index=h,k.pos=((f=k.slides[0])===null||f===void 0?void 0:f.pos)||0,k.dim=0;for(const[b,y]of k.slides.entries())k.dim+=y.dim,b<k.slides.length-1&&(k.dim+=y.gap);u&&k.pos+.5*k.dim<.5*s?k.pos=0:u&&k.pos+.5*k.dim>=r-.5*s?k.pos=r-s:d&&(k.pos+=-.5*(s-k.dim))}),e.forEach(k=>{m&&!l&&r>s&&(k.pos=Math.max(k.pos,0),k.pos=Math.min(k.pos,r-s)),k.pos=Ae(k.pos,1e3),k.dim=Ae(k.dim,1e3),Math.abs(k.pos)<=.1&&(k.pos=0)}),l)return e;const g=[];let x;return e.forEach(k=>{const h=Object.assign({},k);x&&h.pos===x.pos?(x.dim+=h.dim,x.slides=[...x.slides,...h.slides]):(h.index=g.length,x=h,g.push(h))}),g}getPageFromIndex(e=0){const r=this.pages.length;let s;return e=parseInt((e||0).toString())||0,s=this.isInfinite?(e%r+r)%r:Math.max(Math.min(e,r-1),0),s}getSlideMetrics(e){var r,s;const l=this.isHorizontal?"width":"height";let d=0,m=0,u=e.el;const g=!(!u||u.parentNode);if(u?d=parseFloat(u.dataset[l]||"")||0:(u=document.createElement("div"),u.style.visibility="hidden",(this.track||document.body).prepend(u)),qe(u,this.cn(Qr)+" "+e.class+" "+e.customClass),d)u.style[l]=`${d}px`,u.style[l==="width"?"height":"width"]="";else{g&&(this.track||document.body).prepend(u),d=u.getBoundingClientRect()[l]*Math.max(1,((r=window.visualViewport)===null||r===void 0?void 0:r.scale)||1);let k=u[this.isHorizontal?"offsetWidth":"offsetHeight"];k-1>d&&(d=k)}const x=getComputedStyle(u);return x.boxSizing==="content-box"&&(this.isHorizontal?(d+=parseFloat(x.paddingLeft)||0,d+=parseFloat(x.paddingRight)||0):(d+=parseFloat(x.paddingTop)||0,d+=parseFloat(x.paddingBottom)||0)),m=parseFloat(x[this.isHorizontal?"marginRight":"marginBottom"])||0,g?(s=u.parentElement)===null||s===void 0||s.removeChild(u):e.el||u.remove(),{dim:Ae(d,1e3),gap:Ae(m,1e3)}}getBounds(){const{isInfinite:e,isRTL:r,isHorizontal:s,pages:l}=this;let d={min:0,max:0};if(e)d={min:-1/0,max:1/0};else if(l.length){const m=l[0].pos,u=l[l.length-1].pos;d=r&&s?{min:m,max:u}:{min:-1*u,max:-1*m}}return{x:s?d:{min:0,max:0},y:s?{min:0,max:0}:d}}repositionSlides(){let e,{isHorizontal:r,isRTL:s,isInfinite:l,viewport:d,viewportDim:m,contentDim:u,page:g,pages:x,slides:k,panzoom:h}=this,f=0,b=0,y=0,E=0;h?E=-1*h.current[this.axis]:x[g]&&(E=x[g].pos||0),e=r?s?"right":"left":"top",s&&r&&(E*=-1);for(const T of k){const M=T.el;M?(e==="top"?(M.style.right="",M.style.left=""):M.style.top="",T.index!==f?M.style[e]=b===0?"":`${Ae(b,1e3)}px`:M.style[e]="",y+=T.dim+T.gap,f++):b+=T.dim+T.gap}if(l&&y&&d){let T=getComputedStyle(d),M="padding",v=r?"Right":"Bottom",D=parseFloat(T[M+(r?"Left":"Top")]);E-=D,m+=D,m+=parseFloat(T[M+v]);for(const N of k)N.el&&(Ae(N.pos)<Ae(m)&&Ae(N.pos+N.dim+N.gap)<Ae(E)&&Ae(E)>Ae(u-m)&&(N.el.style[e]=`${Ae(b+y,1e3)}px`),Ae(N.pos+N.gap)>=Ae(u-m)&&Ae(N.pos)>Ae(E+m)&&Ae(E)<Ae(m)&&(N.el.style[e]=`-${Ae(y,1e3)}px`))}let w,C,_=[...this.inTransition];if(_.length>1&&(w=x[_[0]],C=x[_[1]]),w&&C){let T=0;for(const M of k)M.el?this.inTransition.has(M.index)&&w.slides.indexOf(M)<0&&(M.el.style[e]=`${Ae(T+(w.pos-C.pos),1e3)}px`):T+=M.dim+M.gap}}createSlideEl(e){const{track:r,slides:s}=this;if(!r||!e||e.el&&e.el.parentNode)return;const l=e.el||document.createElement("div");qe(l,this.cn(Qr)),qe(l,e.class),qe(l,e.customClass);const d=e.html;d&&(d instanceof HTMLElement?l.appendChild(d):l.innerHTML=e.html+"");const m=[];s.forEach((k,h)=>{k.el&&m.push(h)});const u=e.index;let g=null;m.length&&(g=s[m.reduce((k,h)=>Math.abs(h-u)<Math.abs(k-u)?h:k)]);const x=g&&g.el&&g.el.parentNode?g.index<e.index?g.el.nextSibling:g.el:null;r.insertBefore(l,r.contains(x)?x:null),e.el=l,this.emit("createSlide",e)}removeSlideEl(e,r=!1){const s=e==null?void 0:e.el;if(!s||!s.parentNode)return;const l=this.cn($o);if(s.classList.contains(l)&&(St(s,l),this.emit("unselectSlide",e)),e.isDom&&!r)return s.removeAttribute("aria-hidden"),s.removeAttribute("data-index"),void(s.style.left="");this.emit("removeSlide",e);const d=new CustomEvent(Jr);s.dispatchEvent(d),e.el&&(e.el.remove(),e.el=null)}transitionTo(e=0,r=this.option("transition")){var s,l,d,m;if(!r)return!1;const u=this.page,{pages:g,panzoom:x}=this;e=parseInt((e||0).toString())||0;const k=this.getPageFromIndex(e);if(!x||!g[k]||g.length<2||Math.abs((((l=(s=g[u])===null||s===void 0?void 0:s.slides[0])===null||l===void 0?void 0:l.dim)||0)-this.viewportDim)>1)return!1;let h=e>u?1:-1;this.isInfinite&&(u===0&&e===g.length-1&&(h=-1),u===g.length-1&&e===0&&(h=1));const f=g[k].pos*(this.isRTL?1:-1);if(u===k&&Math.abs(f-x.target[this.axis])<1)return!1;this.clearTransitions();const b=x.isResting;qe(this.container,this.cn("inTransition"));const y=((d=g[u])===null||d===void 0?void 0:d.slides[0])||null,E=((m=g[k])===null||m===void 0?void 0:m.slides[0])||null;this.inTransition.add(E.index),this.createSlideEl(E);let w=y.el,C=E.el;b||r===Qr||(r="fadeFast",w=null);const _=this.isRTL?"next":"prev",T=this.isRTL?"prev":"next";return w&&(this.inTransition.add(y.index),y.transition=r,w.addEventListener(Jr,this.onAnimationEnd),w.classList.add(`f-${r}Out`,`to-${h>0?T:_}`)),C&&(E.transition=r,C.addEventListener(Jr,this.onAnimationEnd),C.classList.add(`f-${r}In`,`from-${h>0?_:T}`)),x.current[this.axis]=f,x.target[this.axis]=f,x.requestTick(),this.onChange(k),!0}manageSlideVisiblity(){const e=new Set,r=new Set,s=this.getVisibleSlides(parseFloat(this.option("preload",0)+"")||0);for(const l of this.slides)s.has(l)?e.add(l):r.add(l);for(const l of this.inTransition)e.add(this.slides[l]);for(const l of e)this.createSlideEl(l),this.lazyLoadSlide(l);for(const l of r)e.has(l)||this.removeSlideEl(l);this.markSelectedSlides(),this.repositionSlides()}markSelectedSlides(){if(!this.pages[this.page]||!this.pages[this.page].slides)return;const e="aria-hidden";let r=this.cn($o);if(r)for(const s of this.slides){const l=s.el;l&&(l.dataset.index=`${s.index}`,l.classList.contains("f-thumbs__slide")?this.getVisibleSlides(0).has(s)?l.removeAttribute(e):l.setAttribute(e,"true"):this.pages[this.page].slides.includes(s)?(l.classList.contains(r)||(qe(l,r),this.emit("selectSlide",s)),l.removeAttribute(e)):(l.classList.contains(r)&&(St(l,r),this.emit("unselectSlide",s)),l.setAttribute(e,"true")))}}flipInfiniteTrack(){const{axis:e,isHorizontal:r,isInfinite:s,isRTL:l,viewportDim:d,contentDim:m}=this,u=this.panzoom;if(!u||!s)return;let g=u.current[e],x=u.target[e]-g,k=0,h=.5*d;l&&r?(g<-h&&(k=-1,g+=m),g>m-h&&(k=1,g-=m)):(g>h&&(k=1,g-=m),g<-m+h&&(k=-1,g+=m)),k&&(u.current[e]=g,u.target[e]=g+x)}lazyLoadImg(e,r){const s=this,l="f-fadeIn",d="is-preloading";let m=!1,u=null;const g=()=>{m||(m=!0,u&&(u.remove(),u=null),St(r,d),r.complete&&(qe(r,l),setTimeout(()=>{St(r,l)},350)),this.option("adaptiveHeight")&&e.el&&this.pages[this.page].slides.indexOf(e)>-1&&(s.updateMetrics(),s.setViewportHeight()),this.emit("load",e))};qe(r,d),r.src=r.dataset.lazySrcset||r.dataset.lazySrc||"",delete r.dataset.lazySrc,delete r.dataset.lazySrcset,r.addEventListener("error",()=>{g()}),r.addEventListener("load",()=>{g()}),setTimeout(()=>{const x=r.parentNode;x&&e.el&&(r.complete?g():m||(u=Jn(lo),x.insertBefore(u,r)))},300)}lazyLoadSlide(e){const r=e&&e.el;if(!r)return;const s=new Set;let l=Array.from(r.querySelectorAll("[data-lazy-src],[data-lazy-srcset]"));r.dataset.lazySrc&&l.push(r),l.map(d=>{d instanceof HTMLImageElement?s.add(d):d instanceof HTMLElement&&d.dataset.lazySrc&&(d.style.backgroundImage=`url('${d.dataset.lazySrc}')`,delete d.dataset.lazySrc)});for(const d of s)this.lazyLoadImg(e,d)}onAnimationEnd(e){var r;const s=e.target,l=s?parseInt(s.dataset.index||"",10)||0:-1,d=this.slides[l],m=e.animationName;if(!s||!d||!m)return;const u=!!this.inTransition.has(l)&&d.transition;u&&m.substring(0,u.length+2)===`f-${u}`&&this.inTransition.delete(l),this.inTransition.size||this.clearTransitions(),l===this.page&&(!((r=this.panzoom)===null||r===void 0)&&r.isResting)&&this.emit("settle")}onDecel(e,r=0,s=0,l=0,d=0){if(this.option("dragFree"))return void this.setPageFromPosition();const{isRTL:m,isHorizontal:u,axis:g,pages:x}=this,k=x.length,h=Math.abs(Math.atan2(s,r)/(Math.PI/180));let f=0;if(f=h>45&&h<135?u?0:s:u?r:0,!k)return;let b=this.page,y=m&&u?1:-1;const E=e.current[g]*y;let{pageIndex:w}=this.getPageFromPosition(E);Math.abs(f)>5?(x[b].dim<document.documentElement["client"+(this.isHorizontal?"Width":"Height")]-1&&(b=w),b=m&&u?f<0?b-1:b+1:f<0?b+1:b-1):b=l===0&&d===0?b:w,this.slideTo(b,{transition:!1,friction:e.option("decelFriction")})}onClick(e){const r=e.target,s=r&&vn(r)?r.dataset:null;let l,d;s&&(s.carouselPage!==void 0?(d="slideTo",l=s.carouselPage):s.carouselNext!==void 0?d="slideNext":s.carouselPrev!==void 0&&(d="slidePrev")),d?(e.preventDefault(),e.stopPropagation(),r&&!r.hasAttribute("disabled")&&this[d](l)):this.emit("click",e)}onSlideTo(e){const r=e.detail||0;this.slideTo(this.getPageForSlide(r),{friction:0})}onChange(e,r=0){const s=this.page;this.prevPage=s,this.page=e,this.option("adaptiveHeight")&&this.setViewportHeight(),e!==s&&(this.markSelectedSlides(),this.emit("change",e,s,r))}onRefresh(){let e=this.contentDim,r=this.viewportDim;this.updateMetrics(),this.contentDim===e&&this.viewportDim===r||this.slideTo(this.page,{friction:0,transition:!1})}onScroll(){var e;(e=this.viewport)===null||e===void 0||e.scroll(0,0)}onResize(){this.option("breakpoints")&&this.processOptions()}onBeforeTransform(e){this.lp!==e.current[this.axis]&&(this.flipInfiniteTrack(),this.manageSlideVisiblity()),this.lp=e.current.e}onEndAnimation(){this.inTransition.size||this.emit("settle")}reInit(e=null,r=null){this.destroy(),this.state=Wt.Init,this.prevPage=null,this.userOptions=e||this.userOptions,this.userPlugins=r||this.userPlugins,this.processOptions()}slideTo(e=0,{friction:r=this.option("friction"),transition:s=this.option("transition")}={}){if(this.state===Wt.Destroy)return;e=parseInt((e||0).toString())||0;const l=this.getPageFromIndex(e),{axis:d,isHorizontal:m,isRTL:u,pages:g,panzoom:x}=this,k=g.length,h=u&&m?1:-1;if(!x||!k)return;if(this.page!==l){const b=new Event("beforeChange",{bubbles:!0,cancelable:!0});if(this.emit("beforeChange",b,e),b.defaultPrevented)return}if(this.transitionTo(e,s))return;let f=g[l].pos;if(this.isInfinite){const b=this.contentDim,y=x.target[d]*h;k===2?f+=b*Math.floor(parseFloat(e+"")/2):f=[f,f-b,f+b].reduce(function(E,w){return Math.abs(w-y)<Math.abs(E-y)?w:E})}f*=h,Math.abs(x.target[d]-f)<1||(x.panTo({x:m?f:0,y:m?0:f,friction:r}),this.onChange(l))}slideToClosest(e){if(this.panzoom){const{pageIndex:r}=this.getPageFromPosition();this.slideTo(r,e)}}slideNext(){this.slideTo(this.page+1)}slidePrev(){this.slideTo(this.page-1)}clearTransitions(){this.inTransition.clear(),St(this.container,this.cn("inTransition"));const e=["to-prev","to-next","from-prev","from-next"];for(const r of this.slides){const s=r.el;if(s){s.removeEventListener(Jr,this.onAnimationEnd),s.classList.remove(...e);const l=r.transition;l&&s.classList.remove(`f-${l}Out`,`f-${l}In`)}}this.manageSlideVisiblity()}addSlide(e,r){var s,l,d,m;const u=this.panzoom,g=((s=this.pages[this.page])===null||s===void 0?void 0:s.pos)||0,x=((l=this.pages[this.page])===null||l===void 0?void 0:l.dim)||0,k=this.contentDim<this.viewportDim;let h=Array.isArray(r)?r:[r];const f=[];for(const b of h)f.push(Aa(b));this.slides.splice(e,0,...f);for(let b=0;b<this.slides.length;b++)this.slides[b].index=b;for(const b of f)this.emit("beforeInitSlide",b,b.index);if(this.page>=e&&(this.page+=f.length),this.updateMetrics(),u){const b=((d=this.pages[this.page])===null||d===void 0?void 0:d.pos)||0,y=((m=this.pages[this.page])===null||m===void 0?void 0:m.dim)||0,E=this.pages.length||1,w=this.isRTL?x-y:y-x,C=this.isRTL?g-b:b-g;k&&E===1?(e<=this.page&&(u.current[this.axis]-=w,u.target[this.axis]-=w),u.panTo({[this.isHorizontal?"x":"y"]:-1*b})):C&&e<=this.page&&(u.target[this.axis]-=C,u.current[this.axis]-=C,u.requestTick())}for(const b of f)this.emit("initSlide",b,b.index)}prependSlide(e){this.addSlide(0,e)}appendSlide(e){this.addSlide(this.slides.length,e)}removeSlide(e){const r=this.slides.length;e=(e%r+r)%r;const s=this.slides[e];if(s){this.removeSlideEl(s,!0),this.slides.splice(e,1);for(let l=0;l<this.slides.length;l++)this.slides[l].index=l;this.updateMetrics(),this.slideTo(this.page,{friction:0,transition:!1}),this.emit("destroySlide",s)}}updateMetrics(){const{panzoom:e,viewport:r,track:s,slides:l,isHorizontal:d,isInfinite:m}=this;if(!s)return;const u=d?"width":"height",g=d?"offsetWidth":"offsetHeight";if(r){let h=Math.max(r[g],Ae(r.getBoundingClientRect()[u],1e3)),f=getComputedStyle(r),b="padding",y=d?"Right":"Bottom";h-=parseFloat(f[b+(d?"Left":"Top")])+parseFloat(f[b+y]),this.viewportDim=h}let x,k=0;for(const[h,f]of l.entries()){let b=0,y=0;!f.el&&x?(b=x.dim,y=x.gap):({dim:b,gap:y}=this.getSlideMetrics(f),x=f),b=Ae(b,1e3),y=Ae(y,1e3),f.dim=b,f.gap=y,f.pos=k,k+=b,(m||h<l.length-1)&&(k+=y)}k=Ae(k,1e3),this.contentDim=k,e&&(e.contentRect[u]=k,e.contentRect[d?"fullWidth":"fullHeight"]=k),this.pages=this.createPages(),this.pages=this.processPages(),this.state===Wt.Init&&this.setInitialPage(),this.page=Math.max(0,Math.min(this.page,this.pages.length-1)),this.manageSlideVisiblity(),this.emit("refresh")}getProgress(e,r=!1,s=!1){e===void 0&&(e=this.page);const l=this,d=l.panzoom,m=l.contentDim,u=l.pages[e]||0;if(!u||!d)return e>this.page?-1:1;let g=-1*d.current.e,x=Ae((g-u.pos)/(1*u.dim),1e3),k=x,h=x;this.isInfinite&&s!==!0&&(k=Ae((g-u.pos+m)/(1*u.dim),1e3),h=Ae((g-u.pos-m)/(1*u.dim),1e3));let f=[x,k,h].reduce(function(b,y){return Math.abs(y)<Math.abs(b)?y:b});return r?f:f>1?1:f<-1?-1:f}setViewportHeight(){const{page:e,pages:r,viewport:s,isHorizontal:l}=this;if(!s||!r[e])return;let d=0;l&&this.track&&(this.track.style.height="auto",r[e].slides.forEach(m=>{m.el&&(d=Math.max(d,m.el.offsetHeight))})),s.style.height=d?`${d}px`:""}getPageForSlide(e){for(const r of this.pages)for(const s of r.slides)if(s.index===e)return r.index;return-1}getVisibleSlides(e=0){var r;const s=new Set;let{panzoom:l,contentDim:d,viewportDim:m,pages:u,page:g}=this;if(m){d=d+((r=this.slides[this.slides.length-1])===null||r===void 0?void 0:r.gap)||0;let x=0;x=l&&l.state!==Ct.Init&&l.state!==Ct.Destroy?-1*l.current[this.axis]:u[g]&&u[g].pos||0,this.isInfinite&&(x-=Math.floor(x/d)*d),this.isRTL&&this.isHorizontal&&(x*=-1);const k=x-m*e,h=x+m*(e+1),f=this.isInfinite?[-1,0,1]:[0];for(const b of this.slides)for(const y of f){const E=b.pos+y*d,w=E+b.dim+b.gap;E<h&&w>k&&s.add(b)}}return s}getPageFromPosition(e){const{viewportDim:r,contentDim:s,slides:l,pages:d,panzoom:m}=this,u=d.length,g=l.length,x=l[0],k=l[g-1],h=this.option("center");let f=0,b=0,y=0,E=e===void 0?-1*((m==null?void 0:m.target[this.axis])||0):e;h&&(E+=.5*r),this.isInfinite?(E<x.pos-.5*k.gap&&(E-=s,y=-1),E>k.pos+k.dim+.5*k.gap&&(E-=s,y=1)):E=Math.max(x.pos||0,Math.min(E,k.pos));let w=k,C=l.find(_=>{const T=_.pos-.5*w.gap,M=_.pos+_.dim+.5*_.gap;return w=_,E>=T&&E<M});return C||(C=k),b=this.getPageForSlide(C.index),f=b+y*u,{page:f,pageIndex:b}}setPageFromPosition(){const{pageIndex:e}=this.getPageFromPosition();this.onChange(e)}destroy(){if([Wt.Destroy].includes(this.state))return;this.state=Wt.Destroy;const{container:e,viewport:r,track:s,slides:l,panzoom:d}=this,m=this.option("classes");e.removeEventListener("click",this.onClick,{passive:!1,capture:!1}),e.removeEventListener("slideTo",this.onSlideTo),window.removeEventListener("resize",this.onResize),d&&(d.destroy(),this.panzoom=null),l&&l.forEach(g=>{this.removeSlideEl(g)}),this.detachPlugins(),r&&(r.removeEventListener("scroll",this.onScroll),r.offsetParent&&s&&s.offsetParent&&r.replaceWith(...s.childNodes));for(const[g,x]of Object.entries(m))g!=="container"&&x&&e.classList.remove(x);this.track=null,this.viewport=null,this.page=0,this.slides=[];const u=this.events.get("ready");this.events=new Map,u&&this.events.set("ready",u)}}Object.defineProperty(Ui,"Panzoom",{enumerable:!0,configurable:!0,writable:!0,value:Fi}),Object.defineProperty(Ui,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:cd}),Object.defineProperty(Ui,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:fd});const Hs=function(p){if(!vn(p))return 0;const e=window.scrollY,r=window.innerHeight,s=e+r,l=p.getBoundingClientRect(),d=l.y+e,m=l.height,u=d+m;if(e>u||s<d)return 0;if(e<d&&s>u||d<e&&u>s)return 100;let g=m;d<e&&(g-=e-d),u>s&&(g-=u-s);const x=g/r*100;return Math.round(x)},Dr=!(typeof window>"u"||!window.document||!window.document.createElement);let La;const Da=["a[href]","area[href]",'input:not([disabled]):not([type="hidden"]):not([aria-hidden])',"select:not([disabled]):not([aria-hidden])","textarea:not([disabled]):not([aria-hidden])","button:not([disabled]):not([aria-hidden]):not(.fancybox-focus-guard)","iframe","object","embed","video","audio","[contenteditable]",'[tabindex]:not([tabindex^="-"]):not([disabled]):not([aria-hidden])'].join(","),Bo=p=>{if(p&&Dr){La===void 0&&document.createElement("div").focus({get preventScroll(){return La=!0,!1}});try{if(La)p.focus({preventScroll:!0});else{const e=window.scrollY||document.body.scrollTop,r=window.scrollX||document.body.scrollLeft;p.focus(),document.body.scrollTo({top:e,left:r,behavior:"auto"})}}catch{}}},Ns=()=>{const p=document;let e,r="",s="",l="";return p.fullscreenEnabled?(r="requestFullscreen",s="exitFullscreen",l="fullscreenElement"):p.webkitFullscreenEnabled&&(r="webkitRequestFullscreen",s="webkitExitFullscreen",l="webkitFullscreenElement"),r&&(e={request:function(d=p.documentElement){return r==="webkitRequestFullscreen"?d[r](Element.ALLOW_KEYBOARD_INPUT):d[r]()},exit:function(){return p[l]&&p[s]()},isFullscreen:function(){return p[l]}}),e},Ga={animated:!0,autoFocus:!0,backdropClick:"close",Carousel:{classes:{container:"fancybox__carousel",viewport:"fancybox__viewport",track:"fancybox__track",slide:"fancybox__slide"}},closeButton:"auto",closeExisting:!1,commonCaption:!1,compact:()=>window.matchMedia("(max-width: 578px), (max-height: 578px)").matches,contentClick:"toggleZoom",contentDblClick:!1,defaultType:"image",defaultDisplay:"flex",dragToClose:!0,Fullscreen:{autoStart:!1},groupAll:!1,groupAttr:"data-fancybox",hideClass:"f-fadeOut",hideScrollbar:!0,idle:3500,keyboard:{Escape:"close",Delete:"close",Backspace:"close",PageUp:"next",PageDown:"prev",ArrowUp:"prev",ArrowDown:"next",ArrowRight:"next",ArrowLeft:"prev"},l10n:Object.assign(Object.assign({},Os),{CLOSE:"Close",NEXT:"Next",PREV:"Previous",MODAL:"You can close this modal content with the ESC key",ERROR:"Something Went Wrong, Please Try Again Later",IMAGE_ERROR:"Image Not Found",ELEMENT_NOT_FOUND:"HTML Element Not Found",AJAX_NOT_FOUND:"Error Loading AJAX : Not Found",AJAX_FORBIDDEN:"Error Loading AJAX : Forbidden",IFRAME_ERROR:"Error Loading Page",TOGGLE_ZOOM:"Toggle zoom level",TOGGLE_THUMBS:"Toggle thumbnails",TOGGLE_SLIDESHOW:"Toggle slideshow",TOGGLE_FULLSCREEN:"Toggle full-screen mode",DOWNLOAD:"Download"}),parentEl:null,placeFocusBack:!0,showClass:"f-zoomInUp",startIndex:0,tpl:{closeButton:'<button data-fancybox-close class="f-button is-close-btn" title="{{CLOSE}}"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" tabindex="-1"><path d="M20 20L4 4m16 0L4 20"/></svg></button>',main:`<div class="fancybox__container" role="dialog" aria-modal="true" aria-label="{{MODAL}}" tabindex="-1">
    <div class="fancybox__backdrop"></div>
    <div class="fancybox__carousel"></div>
    <div class="fancybox__footer"></div>
  </div>`},trapFocus:!0,wheel:"zoom"};var Zt,dn;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Closing=2]="Closing",p[p.CustomClosing=3]="CustomClosing",p[p.Destroy=4]="Destroy"})(Zt||(Zt={})),function(p){p[p.Loading=0]="Loading",p[p.Opening=1]="Opening",p[p.Ready=2]="Ready",p[p.Closing=3]="Closing"}(dn||(dn={}));let Uo="",Tr=!1,ea=!1,Ii=null;const js=()=>{let p="",e="";const r=gt.getInstance();if(r){const s=r.carousel,l=r.getSlide();if(s&&l){let d=l.slug||void 0,m=l.triggerEl||void 0;e=d||r.option("slug")||"",!e&&m&&m.dataset&&(e=m.dataset.fancybox||""),e&&e!=="true"&&(p="#"+e+(!d&&s.slides.length>1?"-"+(l.index+1):""))}}return{hash:p,slug:e,index:1}},ha=()=>{const p=new URL(document.URL).hash,e=p.slice(1).split("-"),r=e[e.length-1],s=r&&/^\+?\d+$/.test(r)&&parseInt(e.pop()||"1",10)||1;return{hash:p,slug:e.join("-"),index:s}},$s=()=>{const{slug:p,index:e}=ha();if(!p)return;let r=document.querySelector(`[data-slug="${p}"]`);if(r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})),gt.getInstance())return;const s=document.querySelectorAll(`[data-fancybox="${p}"]`);s.length&&(r=s[e-1],r&&r.dispatchEvent(new CustomEvent("click",{bubbles:!0,cancelable:!0})))},Bs=()=>{if(gt.defaults.Hash===!1)return;const p=gt.getInstance();if((p==null?void 0:p.options.Hash)===!1)return;const{slug:e,index:r}=ha(),{slug:s}=js();p&&(e===s?p.jumpTo(r-1):(Tr=!0,p.close())),$s()},Us=()=>{Ii&&clearTimeout(Ii),queueMicrotask(()=>{Bs()})},zo=()=>{window.addEventListener("hashchange",Us,!1),setTimeout(()=>{Bs()},500)};Dr&&(/complete|interactive|loaded/.test(document.readyState)?zo():document.addEventListener("DOMContentLoaded",zo));const ta="is-zooming-in";class zs extends qn{onCreateSlide(e,r,s){const l=this.instance.optionFor(s,"src")||"";s.el&&s.type==="image"&&typeof l=="string"&&this.setImage(s,l)}onRemoveSlide(e,r,s){s.panzoom&&s.panzoom.destroy(),s.panzoom=void 0,s.imageEl=void 0}onChange(e,r,s,l){St(this.instance.container,ta);for(const d of r.slides){const m=d.panzoom;m&&d.index!==s&&m.reset(.35)}}onClose(){var e;const r=this.instance,s=r.container,l=r.getSlide();if(!s||!s.parentElement||!l)return;const{el:d,contentEl:m,panzoom:u,thumbElSrc:g}=l;if(!d||!g||!m||!u||u.isContentLoading||u.state===Ct.Init||u.state===Ct.Destroy)return;u.updateMetrics();let x=this.getZoomInfo(l);if(!x)return;this.instance.state=Zt.CustomClosing,s.classList.remove(ta),s.classList.add("is-zooming-out"),m.style.backgroundImage=`url('${g}')`;const k=s.getBoundingClientRect();(((e=window.visualViewport)===null||e===void 0?void 0:e.scale)||1)===1&&Object.assign(s.style,{position:"absolute",top:`${s.offsetTop+window.scrollY}px`,left:`${s.offsetLeft+window.scrollX}px`,bottom:"auto",right:"auto",width:`${k.width}px`,height:`${k.height}px`,overflow:"hidden"});const{x:h,y:f,scale:b,opacity:y}=x;if(y){const E=((w,C,_,T)=>{const M=C-w,v=T-_;return D=>_+((D-w)/M*v||0)})(u.scale,b,1,0);u.on("afterTransform",()=>{m.style.opacity=E(u.scale)+""})}u.on("endAnimation",()=>{r.destroy()}),u.target.a=b,u.target.b=0,u.target.c=0,u.target.d=b,u.panTo({x:h,y:f,scale:b,friction:y?.2:.33,ignoreBounds:!0}),u.isResting&&r.destroy()}setImage(e,r){const s=this.instance;e.src=r,this.process(e,r).then(l=>{const{contentEl:d,imageEl:m,thumbElSrc:u,el:g}=e;if(s.isClosing()||!d||!m)return;d.offsetHeight;const x=!!s.isOpeningSlide(e)&&this.getZoomInfo(e);if(this.option("protected")&&g){g.addEventListener("contextmenu",f=>{f.preventDefault()});const h=document.createElement("div");qe(h,"fancybox-protected"),d.appendChild(h)}if(u&&x){const h=l.contentRect,f=Math.max(h.fullWidth,h.fullHeight);let b=null;!x.opacity&&f>1200&&(b=document.createElement("img"),qe(b,"fancybox-ghost"),b.src=u,d.appendChild(b));const y=()=>{b&&(qe(b,"f-fadeFastOut"),setTimeout(()=>{b&&(b.remove(),b=null)},200))};(k=u,new Promise((E,w)=>{const C=new Image;C.onload=E,C.onerror=w,C.src=k})).then(()=>{s.hideLoading(e),e.state=dn.Opening,this.instance.emit("reveal",e),this.zoomIn(e).then(()=>{y(),this.instance.done(e)},()=>{}),b&&setTimeout(()=>{y()},f>2500?800:200)},()=>{s.hideLoading(e),s.revealContent(e)})}else{const h=this.optionFor(e,"initialSize"),f=this.optionFor(e,"zoom"),b={event:s.prevMouseMoveEvent||s.options.event,friction:f?.12:0};let y=s.optionFor(e,"showClass")||void 0,E=!0;s.isOpeningSlide(e)&&(h==="full"?l.zoomToFull(b):h==="cover"?l.zoomToCover(b):h==="max"?l.zoomToMax(b):E=!1,l.stop("current")),E&&y&&(y=l.isDragging?"f-fadeIn":""),s.hideLoading(e),s.revealContent(e,y)}var k},()=>{s.setError(e,"{{IMAGE_ERROR}}")})}process(e,r){return new Promise((s,l)=>{var d;const m=this.instance,u=e.el;m.clearContent(e),m.showLoading(e);let g=this.optionFor(e,"content");if(typeof g=="string"&&(g=Jn(g)),!g||!vn(g)){if(g=document.createElement("img"),g instanceof HTMLImageElement){let x="",k=e.caption;x=typeof k=="string"&&k?k.replace(/<[^>]+>/gi,"").substring(0,1e3):`Image ${e.index+1} of ${((d=m.carousel)===null||d===void 0?void 0:d.pages.length)||1}`,g.src=r||"",g.alt=x,g.draggable=!1,e.srcset&&g.setAttribute("srcset",e.srcset),this.instance.isOpeningSlide(e)&&(g.fetchPriority="high")}e.sizes&&g.setAttribute("sizes",e.sizes)}qe(g,"fancybox-image"),e.imageEl=g,m.setContent(e,g,!1),e.panzoom=new Fi(u,bn({transformParent:!0},this.option("Panzoom")||{},{content:g,width:(x,k)=>m.optionFor(e,"width","auto",k)||"auto",height:(x,k)=>m.optionFor(e,"height","auto",k)||"auto",wheel:()=>{const x=m.option("wheel");return(x==="zoom"||x=="pan")&&x},click:(x,k)=>{var h,f;if(m.isCompact||m.isClosing()||e.index!==((h=m.getSlide())===null||h===void 0?void 0:h.index))return!1;if(k){const y=k.composedPath()[0];if(["A","BUTTON","TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].includes(y.nodeName))return!1}let b=!k||k.target&&((f=e.contentEl)===null||f===void 0?void 0:f.contains(k.target));return m.option(b?"contentClick":"backdropClick")||!1},dblClick:()=>m.isCompact?"toggleZoom":m.option("contentDblClick")||!1,spinner:!1,panOnlyZoomed:!0,wheelLimit:1/0,on:{ready:x=>{s(x)},error:()=>{l()},destroy:()=>{l()}}}))})}zoomIn(e){return new Promise((r,s)=>{const l=this.instance,d=l.container,{panzoom:m,contentEl:u,el:g}=e;m&&m.updateMetrics();const x=this.getZoomInfo(e);if(!(x&&g&&u&&m&&d))return void s();const{x:k,y:h,scale:f,opacity:b}=x,y=()=>{e.state!==dn.Closing&&(b&&(u.style.opacity=Math.max(Math.min(1,1-(1-m.scale)/(1-f)),0)+""),m.scale>=1&&m.scale>m.targetScale-.1&&r(m))},E=_=>{(_.scale<.99||_.scale>1.01)&&!_.isDragging||(St(d,ta),u.style.opacity="",_.off("endAnimation",E),_.off("touchStart",E),_.off("afterTransform",y),r(_))};m.on("endAnimation",E),m.on("touchStart",E),m.on("afterTransform",y),m.on(["error","destroy"],()=>{s()}),m.panTo({x:k,y:h,scale:f,friction:0,ignoreBounds:!0}),m.stop("current");const w={event:m.panMode==="mousemove"?l.prevMouseMoveEvent||l.options.event:void 0},C=this.optionFor(e,"initialSize");qe(d,ta),l.hideLoading(e),C==="full"?m.zoomToFull(w):C==="cover"?m.zoomToCover(w):C==="max"?m.zoomToMax(w):m.reset(.172)})}getZoomInfo(e){const{el:r,imageEl:s,thumbEl:l,panzoom:d}=e,m=this.instance,u=m.container;if(!r||!s||!l||!d||Hs(l)<3||!this.optionFor(e,"zoom")||!u||m.state===Zt.Destroy||getComputedStyle(u).getPropertyValue("--f-images-zoom")==="0")return!1;const g=window.visualViewport||null;if((g?g.scale:1)!==1)return!1;let{top:x,left:k,width:h,height:f}=l.getBoundingClientRect(),{top:b,left:y,fitWidth:E,fitHeight:w}=d.contentRect;if(!(h&&f&&E&&w))return!1;const C=d.container.getBoundingClientRect();y+=C.left,b+=C.top;const _=-1*(y+.5*E-(k+.5*h)),T=-1*(b+.5*w-(x+.5*f)),M=h/E;let v=this.option("zoomOpacity")||!1;return v==="auto"&&(v=Math.abs(h/f-E/w)>.1),{x:_,y:T,scale:M,opacity:v}}attach(){const e=this,r=e.instance;r.on("Carousel.change",e.onChange),r.on("Carousel.createSlide",e.onCreateSlide),r.on("Carousel.removeSlide",e.onRemoveSlide),r.on("close",e.onClose)}detach(){const e=this,r=e.instance;r.off("Carousel.change",e.onChange),r.off("Carousel.createSlide",e.onCreateSlide),r.off("Carousel.removeSlide",e.onRemoveSlide),r.off("close",e.onClose)}}Object.defineProperty(zs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{initialSize:"fit",Panzoom:{maxScale:1},protected:!1,zoom:!0,zoomOpacity:"auto"}}),typeof SuppressedError=="function"&&SuppressedError;const Oa="html",Fo="image",Pa="map",si="youtube",Li="vimeo",Sr="html5video",Vo=(p,e={})=>{const r=new URL(p),s=new URLSearchParams(r.search),l=new URLSearchParams;for(const[u,g]of[...s,...Object.entries(e)]){let x=g+"";if(u==="t"){let k=x.match(/((\d*)m)?(\d*)s?/);k&&l.set("start",60*parseInt(k[2]||"0")+parseInt(k[3]||"0")+"")}else l.set(u,x)}let d=l+"",m=p.match(/#t=((.*)?\d+s)/);return m&&(d+=`#t=${m[1]}`),d},hd={ajax:null,autoSize:!0,iframeAttr:{allow:"autoplay; fullscreen",scrolling:"auto"},preload:!0,videoAutoplay:!0,videoRatio:16/9,videoTpl:`<video class="fancybox__html5video" playsinline controls controlsList="nodownload" poster="{{poster}}">
  <source src="{{src}}" type="{{format}}" />Sorry, your browser doesn't support embedded videos.</video>`,videoFormat:"",vimeo:{byline:1,color:"00adef",controls:1,dnt:1,muted:0},youtube:{controls:1,enablejsapi:1,nocookie:1,rel:0,fs:1}},pd=["image","html","ajax","inline","clone","iframe","map","pdf","html5video","youtube","vimeo"];class Fs extends qn{onBeforeInitSlide(e,r,s){this.processType(s)}onCreateSlide(e,r,s){this.setContent(s)}onClearContent(e,r){r.xhr&&(r.xhr.abort(),r.xhr=null);const s=r.iframeEl;s&&(s.onload=s.onerror=null,s.src="//about:blank",r.iframeEl=null);const l=r.contentEl,d=r.placeholderEl;if(r.type==="inline"&&l&&d)l.classList.remove("fancybox__content"),getComputedStyle(l).getPropertyValue("display")!=="none"&&(l.style.display="none"),setTimeout(()=>{d&&(l&&d.parentNode&&d.parentNode.insertBefore(l,d),d.remove())},0),r.contentEl=void 0,r.placeholderEl=void 0;else for(;r.el&&r.el.firstChild;)r.el.removeChild(r.el.firstChild)}onSelectSlide(e,r,s){s.state===dn.Ready&&this.playVideo()}onUnselectSlide(e,r,s){var l,d;if(s.type===Sr){try{(d=(l=s.el)===null||l===void 0?void 0:l.querySelector("video"))===null||d===void 0||d.pause()}catch{}return}let m;s.type===Li?m={method:"pause",value:"true"}:s.type===si&&(m={event:"command",func:"pauseVideo"}),m&&s.iframeEl&&s.iframeEl.contentWindow&&s.iframeEl.contentWindow.postMessage(JSON.stringify(m),"*"),s.poller&&clearTimeout(s.poller)}onDone(e,r){e.isCurrentSlide(r)&&!e.isClosing()&&this.playVideo()}onRefresh(e,r){r.slides.forEach(s=>{s.el&&(this.resizeIframe(s),this.setAspectRatio(s))})}onMessage(e){try{let r=JSON.parse(e.data);if(e.origin==="https://player.vimeo.com"){if(r.event==="ready")for(let s of Array.from(document.getElementsByClassName("fancybox__iframe")))s instanceof HTMLIFrameElement&&s.contentWindow===e.source&&(s.dataset.ready="true")}else if(e.origin.match(/^https:\/\/(www.)?youtube(-nocookie)?.com$/)&&r.event==="onReady"){const s=document.getElementById(r.id);s&&(s.dataset.ready="true")}}catch{}}loadAjaxContent(e){const r=this.instance.optionFor(e,"src")||"";this.instance.showLoading(e);const s=this.instance,l=new XMLHttpRequest;s.showLoading(e),l.onreadystatechange=function(){l.readyState===XMLHttpRequest.DONE&&s.state===Zt.Ready&&(s.hideLoading(e),l.status===200?s.setContent(e,l.responseText):s.setError(e,l.status===404?"{{AJAX_NOT_FOUND}}":"{{AJAX_FORBIDDEN}}"))};const d=e.ajax||null;l.open(d?"POST":"GET",r+""),l.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),l.setRequestHeader("X-Requested-With","XMLHttpRequest"),l.send(d),e.xhr=l}setInlineContent(e){let r=null;if(vn(e.src))r=e.src;else if(typeof e.src=="string"){const s=e.src.split("#",2).pop();r=s?document.getElementById(s):null}if(r){if(e.type==="clone"||r.closest(".fancybox__slide")){r=r.cloneNode(!0);const s=r.dataset.animationName;s&&(r.classList.remove(s),delete r.dataset.animationName);let l=r.getAttribute("id");l=l?`${l}--clone`:`clone-${this.instance.id}-${e.index}`,r.setAttribute("id",l)}else if(r.parentNode){const s=document.createElement("div");s.classList.add("fancybox-placeholder"),r.parentNode.insertBefore(s,r),e.placeholderEl=s}this.instance.setContent(e,r)}else this.instance.setError(e,"{{ELEMENT_NOT_FOUND}}")}setIframeContent(e){const{src:r,el:s}=e;if(!r||typeof r!="string"||!s)return;s.classList.add("is-loading");const l=this.instance,d=document.createElement("iframe");d.className="fancybox__iframe",d.setAttribute("id",`fancybox__iframe_${l.id}_${e.index}`);for(const[u,g]of Object.entries(this.optionFor(e,"iframeAttr")||{}))d.setAttribute(u,g);d.onerror=()=>{l.setError(e,"{{IFRAME_ERROR}}")},e.iframeEl=d;const m=this.optionFor(e,"preload");if(e.type!=="iframe"||m===!1)return d.setAttribute("src",e.src+""),l.setContent(e,d,!1),this.resizeIframe(e),void l.revealContent(e);l.showLoading(e),d.onload=()=>{if(!d.src.length)return;const u=d.dataset.ready!=="true";d.dataset.ready="true",this.resizeIframe(e),u?l.revealContent(e):l.hideLoading(e)},d.setAttribute("src",r),l.setContent(e,d,!1)}resizeIframe(e){const{type:r,iframeEl:s}=e;if(r===si||r===Li)return;const l=s==null?void 0:s.parentElement;if(!s||!l)return;let d=e.autoSize;d===void 0&&(d=this.optionFor(e,"autoSize"));let m=e.width||0,u=e.height||0;m&&u&&(d=!1);const g=l&&l.style;if(e.preload!==!1&&d!==!1&&g)try{const x=window.getComputedStyle(l),k=parseFloat(x.paddingLeft)+parseFloat(x.paddingRight),h=parseFloat(x.paddingTop)+parseFloat(x.paddingBottom),f=s.contentWindow;if(f){const b=f.document,y=b.getElementsByTagName(Oa)[0],E=b.body;g.width="",E.style.overflow="hidden",m=m||y.scrollWidth+k,g.width=`${m}px`,E.style.overflow="",g.flex="0 0 auto",g.height=`${E.scrollHeight}px`,u=y.scrollHeight+h}}catch{}if(m||u){const x={flex:"0 1 auto",width:"",height:""};m&&m!=="auto"&&(x.width=`${m}px`),u&&u!=="auto"&&(x.height=`${u}px`),Object.assign(g,x)}}playVideo(){const e=this.instance.getSlide();if(!e)return;const{el:r}=e;if(!r||!r.offsetParent||!this.optionFor(e,"videoAutoplay"))return;if(e.type===Sr)try{const l=r.querySelector("video");if(l){const d=l.play();d!==void 0&&d.then(()=>{}).catch(m=>{l.muted=!0,l.play()})}}catch{}if(e.type!==si&&e.type!==Li)return;const s=()=>{if(e.iframeEl&&e.iframeEl.contentWindow){let l;if(e.iframeEl.dataset.ready==="true")return l=e.type===si?{event:"command",func:"playVideo"}:{method:"play",value:"true"},l&&e.iframeEl.contentWindow.postMessage(JSON.stringify(l),"*"),void(e.poller=void 0);e.type===si&&(l={event:"listening",id:e.iframeEl.getAttribute("id")},e.iframeEl.contentWindow.postMessage(JSON.stringify(l),"*"))}e.poller=setTimeout(s,250)};s()}processType(e){if(e.html)return e.type=Oa,e.src=e.html,void(e.html="");const r=this.instance.optionFor(e,"src","");if(!r||typeof r!="string")return;let s=e.type,l=null;if(l=r.match(/(youtube\.com|youtu\.be|youtube\-nocookie\.com)\/(?:watch\?(?:.*&)?v=|v\/|u\/|shorts\/|embed\/?)?(videoseries\?list=(?:.*)|[\w-]{11}|\?listType=(?:.*)&list=(?:.*))(?:.*)/i)){const d=this.optionFor(e,si),{nocookie:m}=d,u=function(h,f){var b={};for(var y in h)Object.prototype.hasOwnProperty.call(h,y)&&f.indexOf(y)<0&&(b[y]=h[y]);if(h!=null&&typeof Object.getOwnPropertySymbols=="function"){var E=0;for(y=Object.getOwnPropertySymbols(h);E<y.length;E++)f.indexOf(y[E])<0&&Object.prototype.propertyIsEnumerable.call(h,y[E])&&(b[y[E]]=h[y[E]])}return b}(d,["nocookie"]),g=`www.youtube${m?"-nocookie":""}.com`,x=Vo(r,u),k=encodeURIComponent(l[2]);e.videoId=k,e.src=`https://${g}/embed/${k}?${x}`,e.thumbSrc=e.thumbSrc||`https://i.ytimg.com/vi/${k}/mqdefault.jpg`,s=si}else if(l=r.match(/^.+vimeo.com\/(?:\/)?([\d]+)((\/|\?h=)([a-z0-9]+))?(.*)?/)){const d=Vo(r,this.optionFor(e,Li)),m=encodeURIComponent(l[1]),u=l[4]||"";e.videoId=m,e.src=`https://player.vimeo.com/video/${m}?${u?`h=${u}${d?"&":""}`:""}${d}`,s=Li}if(!s&&e.triggerEl){const d=e.triggerEl.dataset.type;pd.includes(d)&&(s=d)}s||typeof r=="string"&&(r.charAt(0)==="#"?s="inline":(l=r.match(/\.(mp4|mov|ogv|webm)((\?|#).*)?$/i))?(s=Sr,e.videoFormat=e.videoFormat||"video/"+(l[1]==="ogv"?"ogg":l[1])):r.match(/(^data:image\/[a-z0-9+\/=]*,)|(\.(jp(e|g|eg)|gif|png|bmp|webp|svg|ico)((\?|#).*)?$)/i)?s=Fo:r.match(/\.(pdf)((\?|#).*)?$/i)&&(s="pdf")),(l=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:(?:(?:maps\/(?:place\/(?:.*)\/)?\@(.*),(\d+.?\d+?)z))|(?:\?ll=))(.*)?/i))?(e.src=`https://maps.google.${l[1]}/?ll=${(l[2]?l[2]+"&z="+Math.floor(parseFloat(l[3]))+(l[4]?l[4].replace(/^\//,"&"):""):l[4]+"").replace(/\?/,"&")}&output=${l[4]&&l[4].indexOf("layer=c")>0?"svembed":"embed"}`,s=Pa):(l=r.match(/(?:maps\.)?google\.([a-z]{2,3}(?:\.[a-z]{2})?)\/(?:maps\/search\/)(.*)/i))&&(e.src=`https://maps.google.${l[1]}/maps?q=${l[2].replace("query=","q=").replace("api=1","")}&output=embed`,s=Pa),s=s||this.instance.option("defaultType"),e.type=s,s===Fo&&(e.thumbSrc=e.thumbSrc||e.src)}setContent(e){const r=this.instance.optionFor(e,"src")||"";if(e&&e.type&&r){switch(e.type){case Oa:this.instance.setContent(e,r);break;case Sr:const s=this.option("videoTpl");s&&this.instance.setContent(e,s.replace(/\{\{src\}\}/gi,r+"").replace(/\{\{format\}\}/gi,this.optionFor(e,"videoFormat")||"").replace(/\{\{poster\}\}/gi,e.poster||e.thumbSrc||""));break;case"inline":case"clone":this.setInlineContent(e);break;case"ajax":this.loadAjaxContent(e);break;case"pdf":case Pa:case si:case Li:e.preload=!1;case"iframe":this.setIframeContent(e)}this.setAspectRatio(e)}}setAspectRatio(e){const r=e.contentEl;if(!(e.el&&r&&e.type&&[si,Li,Sr].includes(e.type)))return;let s,l=e.width||"auto",d=e.height||"auto";if(l==="auto"||d==="auto"){s=this.optionFor(e,"videoRatio");const x=(s+"").match(/(\d+)\s*\/\s?(\d+)/);s=x&&x.length>2?parseFloat(x[1])/parseFloat(x[2]):parseFloat(s+"")}else l&&d&&(s=l/d);if(!s)return;r.style.aspectRatio="",r.style.width="",r.style.height="",r.offsetHeight;const m=r.getBoundingClientRect(),u=m.width||1,g=m.height||1;r.style.aspectRatio=s+"",s<u/g?(d=d==="auto"?g:Math.min(g,d),r.style.width="auto",r.style.height=`${d}px`):(l=l==="auto"?u:Math.min(u,l),r.style.width=`${l}px`,r.style.height="auto")}attach(){const e=this,r=e.instance;r.on("Carousel.beforeInitSlide",e.onBeforeInitSlide),r.on("Carousel.createSlide",e.onCreateSlide),r.on("Carousel.selectSlide",e.onSelectSlide),r.on("Carousel.unselectSlide",e.onUnselectSlide),r.on("Carousel.Panzoom.refresh",e.onRefresh),r.on("done",e.onDone),r.on("clearContent",e.onClearContent),window.addEventListener("message",e.onMessage)}detach(){const e=this,r=e.instance;r.off("Carousel.beforeInitSlide",e.onBeforeInitSlide),r.off("Carousel.createSlide",e.onCreateSlide),r.off("Carousel.selectSlide",e.onSelectSlide),r.off("Carousel.unselectSlide",e.onUnselectSlide),r.off("Carousel.Panzoom.refresh",e.onRefresh),r.off("done",e.onDone),r.off("clearContent",e.onClearContent),window.removeEventListener("message",e.onMessage)}}Object.defineProperty(Fs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:hd});const na="play",ia="pause",Cr="ready";class Vs extends qn{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Cr}),Object.defineProperty(this,"inHover",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"timer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"progressBar",{enumerable:!0,configurable:!0,writable:!0,value:null})}get isActive(){return this.state!==Cr}onReady(e){this.option("autoStart")&&(e.isInfinite||e.page<e.pages.length-1)&&this.start()}onChange(){this.removeProgressBar(),this.pause()}onSettle(){this.resume()}onVisibilityChange(){document.visibilityState==="visible"?this.resume():this.pause()}onMouseEnter(){this.inHover=!0,this.pause()}onMouseLeave(){var e;this.inHover=!1,!((e=this.instance.panzoom)===null||e===void 0)&&e.isResting&&this.resume()}onTimerEnd(){const e=this.instance;this.state==="play"&&(e.isInfinite||e.page!==e.pages.length-1?e.slideNext():e.slideTo(0))}removeProgressBar(){this.progressBar&&(this.progressBar.remove(),this.progressBar=null)}createProgressBar(){var e;if(!this.option("showProgress"))return null;this.removeProgressBar();const r=this.instance,s=((e=r.pages[r.page])===null||e===void 0?void 0:e.slides)||[];let l=this.option("progressParentEl");if(l||(l=(s.length===1?s[0].el:null)||r.viewport),!l)return null;const d=document.createElement("div");return qe(d,"f-progress"),l.prepend(d),this.progressBar=d,d.offsetHeight,d}set(){const e=this,r=e.instance;if(r.pages.length<2||e.timer)return;const s=e.option("timeout");e.state=na,qe(r.container,"has-autoplay");let l=e.createProgressBar();l&&(l.style.transitionDuration=`${s}ms`,l.style.transform="scaleX(1)"),e.timer=setTimeout(()=>{e.timer=null,e.inHover||e.onTimerEnd()},s),e.emit("set")}clear(){const e=this;e.timer&&(clearTimeout(e.timer),e.timer=null),e.removeProgressBar()}start(){const e=this;if(e.set(),e.state!==Cr){if(e.option("pauseOnHover")){const r=e.instance.container;r.addEventListener("mouseenter",e.onMouseEnter,!1),r.addEventListener("mouseleave",e.onMouseLeave,!1)}document.addEventListener("visibilitychange",e.onVisibilityChange,!1),e.emit("start")}}stop(){const e=this,r=e.state,s=e.instance.container;e.clear(),e.state=Cr,s.removeEventListener("mouseenter",e.onMouseEnter,!1),s.removeEventListener("mouseleave",e.onMouseLeave,!1),document.removeEventListener("visibilitychange",e.onVisibilityChange,!1),St(s,"has-autoplay"),r!==Cr&&e.emit("stop")}pause(){const e=this;e.state===na&&(e.state=ia,e.clear(),e.emit(ia))}resume(){const e=this,r=e.instance;if(r.isInfinite||r.page!==r.pages.length-1)if(e.state!==na){if(e.state===ia&&!e.inHover){const s=new Event("resume",{bubbles:!0,cancelable:!0});e.emit("resume",s),s.defaultPrevented||e.set()}}else e.set();else e.stop()}toggle(){this.state===na||this.state===ia?this.stop():this.start()}attach(){const e=this,r=e.instance;r.on("ready",e.onReady),r.on("Panzoom.startAnimation",e.onChange),r.on("Panzoom.endAnimation",e.onSettle),r.on("Panzoom.touchMove",e.onChange)}detach(){const e=this,r=e.instance;r.off("ready",e.onReady),r.off("Panzoom.startAnimation",e.onChange),r.off("Panzoom.endAnimation",e.onSettle),r.off("Panzoom.touchMove",e.onChange),e.stop()}}Object.defineProperty(Vs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{autoStart:!0,pauseOnHover:!0,progressParentEl:null,showProgress:!0,timeout:3e3}});class qs extends qn{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null})}onPrepare(e){const r=e.carousel;if(!r)return;const s=e.container;s&&(r.options.Autoplay=bn({autoStart:!1},this.option("Autoplay")||{},{pauseOnHover:!1,timeout:this.option("timeout"),progressParentEl:()=>this.option("progressParentEl")||null,on:{start:()=>{e.emit("startSlideshow")},set:l=>{var d;s.classList.add("has-slideshow"),((d=e.getSlide())===null||d===void 0?void 0:d.state)!==dn.Ready&&l.pause()},stop:()=>{s.classList.remove("has-slideshow"),e.isCompact||e.endIdle(),e.emit("endSlideshow")},resume:(l,d)=>{var m,u,g;!d||!d.cancelable||((m=e.getSlide())===null||m===void 0?void 0:m.state)===dn.Ready&&(!((g=(u=e.carousel)===null||u===void 0?void 0:u.panzoom)===null||g===void 0)&&g.isResting)||d.preventDefault()}}}),r.attachPlugins({Autoplay:Vs}),this.ref=r.plugins.Autoplay)}onReady(e){const r=e.carousel,s=this.ref;s&&r&&this.option("playOnStart")&&(r.isInfinite||r.page<r.pages.length-1)&&s.start()}onDone(e,r){const s=this.ref,l=e.carousel;if(!s||!l)return;const d=r.panzoom;d&&d.on("startAnimation",()=>{e.isCurrentSlide(r)&&s.stop()}),e.isCurrentSlide(r)&&s.resume()}onKeydown(e,r){var s;const l=this.ref;l&&r===this.option("key")&&((s=document.activeElement)===null||s===void 0?void 0:s.nodeName)!=="BUTTON"&&l.toggle()}attach(){const e=this,r=e.instance;r.on("Carousel.init",e.onPrepare),r.on("Carousel.ready",e.onReady),r.on("done",e.onDone),r.on("keydown",e.onKeydown)}detach(){const e=this,r=e.instance;r.off("Carousel.init",e.onPrepare),r.off("Carousel.ready",e.onReady),r.off("done",e.onDone),r.off("keydown",e.onKeydown)}}Object.defineProperty(qs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:{key:" ",playOnStart:!1,progressParentEl:p=>{var e;return((e=p.instance.container)===null||e===void 0?void 0:e.querySelector(".fancybox__toolbar [data-fancybox-toggle-slideshow]"))||p.instance.container},timeout:3e3}});const Ws={classes:{container:"f-thumbs f-carousel__thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide",isResting:"is-resting",isSelected:"is-selected",isLoading:"is-loading",hasThumbs:"has-thumbs"},minCount:2,parentEl:null,thumbTpl:'<button class="f-thumbs__slide__button" tabindex="0" type="button" aria-label="{{GOTO}}" data-carousel-index="%i"><img class="f-thumbs__slide__img" data-lazy-src="{{%s}}" alt="" /></button>',type:"modern"};var ci;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Hidden=2]="Hidden"})(ci||(ci={}));const qo="isResting",ra="thumbWidth",ir="thumbHeight",Xn="thumbClipWidth";let Ys=class extends qn{constructor(){super(...arguments),Object.defineProperty(this,"type",{enumerable:!0,configurable:!0,writable:!0,value:"modern"}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"track",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"thumbWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbClipWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"thumbExtraGap",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:ci.Init})}get isModern(){return this.type==="modern"}onInitSlide(p,e){const r=e.el?e.el.dataset:void 0;r&&(e.thumbSrc=r.thumbSrc||e.thumbSrc||"",e[Xn]=parseFloat(r[Xn]||"")||e[Xn]||0,e[ir]=parseFloat(r.thumbHeight||"")||e[ir]||0),this.addSlide(e)}onInitSlides(){this.build()}onChange(){var p;if(!this.isModern)return;const e=this.container,r=this.instance,s=r.panzoom,l=this.carousel,d=l?l.panzoom:null,m=r.page;if(s&&l&&d){if(s.isDragging){St(e,this.cn(qo));let u=((p=l.pages[m])===null||p===void 0?void 0:p.pos)||0;u+=r.getProgress(m)*(this[Xn]+this.thumbGap);let g=d.getBounds();-1*u>g.x.min&&-1*u<g.x.max&&d.panTo({x:-1*u,friction:.12})}else Qn(e,this.cn(qo),s.isResting);this.shiftModern()}}onRefresh(){this.updateProps();for(const p of this.instance.slides||[])this.resizeModernSlide(p);this.shiftModern()}isDisabled(){const p=this.option("minCount")||0;if(p){const r=this.instance;let s=0;for(const l of r.slides||[])l.thumbSrc&&s++;if(s<p)return!0}const e=this.option("type");return["modern","classic"].indexOf(e)<0}getThumb(p){const e=this.option("thumbTpl")||"";return{html:this.instance.localize(e,[["%i",p.index],["%d",p.index+1],["%s",p.thumbSrc||"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"]])}}addSlide(p){const e=this.carousel;e&&e.addSlide(p.index,this.getThumb(p))}getSlides(){const p=[];for(const e of this.instance.slides||[])p.push(this.getThumb(e));return p}resizeModernSlide(p){this.isModern&&(p[ra]=p[Xn]&&p[ir]?Math.round(this[ir]*(p[Xn]/p[ir])):this[ra])}updateProps(){const p=this.container;if(!p)return;const e=r=>parseFloat(getComputedStyle(p).getPropertyValue("--f-thumb-"+r))||0;this.thumbGap=e("gap"),this.thumbExtraGap=e("extra-gap"),this[ra]=e("width")||40,this[Xn]=e("clip-width")||40,this[ir]=e("height")||40}build(){const p=this;if(p.state!==ci.Init)return;if(p.isDisabled())return void p.emit("disabled");const e=p.instance,r=e.container,s=p.getSlides(),l=p.option("type");p.type=l;const d=p.option("parentEl"),m=p.cn("container"),u=p.cn("track");let g=d==null?void 0:d.querySelector("."+m);g||(g=document.createElement("div"),qe(g,m),d?d.appendChild(g):r.after(g)),qe(g,`is-${l}`),qe(r,p.cn("hasThumbs")),p.container=g,p.updateProps();let x=g.querySelector("."+u);x||(x=document.createElement("div"),qe(x,p.cn("track")),g.appendChild(x)),p.track=x;const k=bn({},{track:x,infinite:!1,center:!0,fill:l==="classic",dragFree:!0,slidesPerPage:1,transition:!1,preload:.25,friction:.12,Panzoom:{maxVelocity:0},Dots:!1,Navigation:!1,classes:{container:"f-thumbs",viewport:"f-thumbs__viewport",track:"f-thumbs__track",slide:"f-thumbs__slide"}},p.option("Carousel")||{},{Sync:{target:e},slides:s}),h=new e.constructor(g,k);h.on("createSlide",(f,b)=>{p.setProps(b.index),p.emit("createSlide",b,b.el)}),h.on("ready",()=>{p.shiftModern(),p.emit("ready")}),h.on("refresh",()=>{p.shiftModern()}),h.on("Panzoom.click",(f,b,y)=>{p.onClick(y)}),p.carousel=h,p.state=ci.Ready}onClick(p){p.preventDefault(),p.stopPropagation();const e=this.instance,{pages:r,page:s}=e,l=E=>{if(E){const w=E.closest("[data-carousel-index]");if(w)return[parseInt(w.dataset.carouselIndex||"",10)||0,w]}return[-1,void 0]},d=(E,w)=>{const C=document.elementFromPoint(E,w);return C?l(C):[-1,void 0]};let[m,u]=l(p.target);if(m>-1)return;const g=this[Xn],x=p.clientX,k=p.clientY;let[h,f]=d(x-g,k),[b,y]=d(x+g,k);f&&y?(m=Math.abs(x-f.getBoundingClientRect().right)<Math.abs(x-y.getBoundingClientRect().left)?h:b,m===s&&(m=m===h?b:h)):f?m=h:y&&(m=b),m>-1&&r[m]&&e.slideTo(m)}getShift(p){var e;const r=this,{instance:s}=r,l=r.carousel;if(!s||!l)return 0;const d=r[ra],m=r[Xn],u=r.thumbGap,g=r.thumbExtraGap;if(!(!((e=l.slides[p])===null||e===void 0)&&e.el))return 0;const x=.5*(d-m),k=s.pages.length-1;let h=s.getProgress(0),f=s.getProgress(k),b=s.getProgress(p,!1,!0),y=0,E=x+g+u;const w=h<0&&h>-1,C=f>0&&f<1;return p===0?(y=E*Math.abs(h),C&&h===1&&(y-=E*Math.abs(f))):p===k?(y=E*Math.abs(f)*-1,w&&f===-1&&(y+=E*Math.abs(h))):w||C?(y=-1*E,y+=E*Math.abs(h),y+=E*(1-Math.abs(f))):y=E*b,y}setProps(p){var e;const r=this;if(!r.isModern)return;const{instance:s}=r,l=r.carousel;if(s&&l){const d=(e=l.slides[p])===null||e===void 0?void 0:e.el;if(d&&d.childNodes.length){let m=Ae(1-Math.abs(s.getProgress(p))),u=Ae(r.getShift(p));d.style.setProperty("--progress",m?m+"":""),d.style.setProperty("--shift",u+"")}}}shiftModern(){const p=this;if(!p.isModern)return;const{instance:e,track:r}=p,s=e.panzoom,l=p.carousel;if(!(e&&r&&s&&l)||s.state===Ct.Init||s.state===Ct.Destroy)return;for(const m of e.slides)p.setProps(m.index);let d=(p[Xn]+p.thumbGap)*(l.slides.length||0);r.style.setProperty("--width",d+"")}cleanup(){const p=this;p.carousel&&p.carousel.destroy(),p.carousel=null,p.container&&p.container.remove(),p.container=null,p.track&&p.track.remove(),p.track=null,p.state=ci.Init,St(p.instance.container,p.cn("hasThumbs"))}attach(){const p=this,e=p.instance;e.on("initSlide",p.onInitSlide),e.state===Wt.Init?e.on("initSlides",p.onInitSlides):p.onInitSlides(),e.on(["change","Panzoom.afterTransform"],p.onChange),e.on("Panzoom.refresh",p.onRefresh)}detach(){const p=this,e=p.instance;e.off("initSlide",p.onInitSlide),e.off("initSlides",p.onInitSlides),e.off(["change","Panzoom.afterTransform"],p.onChange),e.off("Panzoom.refresh",p.onRefresh),p.cleanup()}};Object.defineProperty(Ys,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Ws});const md=Object.assign(Object.assign({},Ws),{key:"t",showOnStart:!0,parentEl:null}),Wo="is-masked",Yo="aria-hidden";class Ks extends qn{constructor(){super(...arguments),Object.defineProperty(this,"ref",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hidden",{enumerable:!0,configurable:!0,writable:!0,value:!1})}get isEnabled(){const e=this.ref;return e&&!e.isDisabled()}get isHidden(){return this.hidden}onClick(e,r){r.stopPropagation()}onCreateSlide(e,r){var s,l,d;const m=((d=(l=(s=this.instance)===null||s===void 0?void 0:s.carousel)===null||l===void 0?void 0:l.slides[r.index])===null||d===void 0?void 0:d.type)||"",u=r.el;if(u&&m){let g=`for-${m}`;["video","youtube","vimeo","html5video"].includes(m)&&(g+=" for-video"),qe(u,g)}}onInit(){var e;const r=this,s=r.instance,l=s.carousel;if(r.ref||!l)return;const d=r.option("parentEl")||s.footer||s.container;if(!d)return;const m=bn({},r.options,{parentEl:d,classes:{container:"f-thumbs fancybox__thumbs"},Carousel:{Sync:{friction:s.option("Carousel.friction")||0}},on:{ready:u=>{const g=u.container;g&&this.hidden&&(r.refresh(),g.style.transition="none",r.hide(),g.offsetHeight,queueMicrotask(()=>{g.style.transition="",r.show()}))}}});m.Carousel=m.Carousel||{},m.Carousel.on=bn(((e=r.options.Carousel)===null||e===void 0?void 0:e.on)||{},{click:this.onClick,createSlide:this.onCreateSlide}),l.options.Thumbs=m,l.attachPlugins({Thumbs:Ys}),r.ref=l.plugins.Thumbs,r.option("showOnStart")||(r.ref.state=ci.Hidden,r.hidden=!0)}onResize(){var e;const r=(e=this.ref)===null||e===void 0?void 0:e.container;r&&(r.style.maxHeight="")}onKeydown(e,r){const s=this.option("key");s&&s===r&&this.toggle()}toggle(){const e=this.ref;if(e&&!e.isDisabled())return e.state===ci.Hidden?(e.state=ci.Init,void e.build()):void(this.hidden?this.show():this.hide())}show(){const e=this.ref;if(!e||e.isDisabled())return;const r=e.container;r&&(this.refresh(),r.offsetHeight,r.removeAttribute(Yo),r.classList.remove(Wo),this.hidden=!1)}hide(){const e=this.ref,r=e&&e.container;r&&(this.refresh(),r.offsetHeight,r.classList.add(Wo),r.setAttribute(Yo,"true")),this.hidden=!0}refresh(){const e=this.ref;if(!e||!e.state)return;const r=e.container,s=(r==null?void 0:r.firstChild)||null;r&&s&&s.childNodes.length&&(r.style.maxHeight=`${s.getBoundingClientRect().height}px`)}attach(){const e=this,r=e.instance;r.state===Zt.Init?r.on("Carousel.init",e.onInit):e.onInit(),r.on("resize",e.onResize),r.on("keydown",e.onKeydown)}detach(){var e;const r=this,s=r.instance;s.off("Carousel.init",r.onInit),s.off("resize",r.onResize),s.off("keydown",r.onKeydown),(e=s.carousel)===null||e===void 0||e.detachPlugins(["Thumbs"]),r.ref=null}}Object.defineProperty(Ks,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:md});const Ra={panLeft:{icon:'<svg><path d="M5 12h14M5 12l6 6M5 12l6-6"/></svg>',change:{panX:-100}},panRight:{icon:'<svg><path d="M5 12h14M13 18l6-6M13 6l6 6"/></svg>',change:{panX:100}},panUp:{icon:'<svg><path d="M12 5v14M18 11l-6-6M6 11l6-6"/></svg>',change:{panY:-100}},panDown:{icon:'<svg><path d="M12 5v14M18 13l-6 6M6 13l6 6"/></svg>',change:{panY:100}},zoomIn:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M11 8v6M8 11h6"/></svg>',action:"zoomIn"},zoomOut:{icon:'<svg><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"zoomOut"},toggle1to1:{icon:'<svg><path d="M3.51 3.07c5.74.02 11.48-.02 17.22.02 1.37.1 2.34 1.64 2.18 3.13 0 4.08.02 8.16 0 12.23-.1 1.54-1.47 2.64-2.79 2.46-5.61-.01-11.24.02-16.86-.01-1.36-.12-2.33-1.65-2.17-3.14 0-4.07-.02-8.16 0-12.23.1-1.36 1.22-2.48 2.42-2.46Z"/><path d="M5.65 8.54h1.49v6.92m8.94-6.92h1.49v6.92M11.5 9.4v.02m0 5.18v0"/></svg>',action:"toggleZoom"},toggleZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"toggleZoom"},iterateZoom:{icon:'<svg><g><line x1="11" y1="8" x2="11" y2="14"></line></g><circle cx="11" cy="11" r="7.5"/><path d="m21 21-4.35-4.35M8 11h6"/></svg>',action:"iterateZoom"},rotateCCW:{icon:'<svg><path d="M15 4.55a8 8 0 0 0-6 14.9M9 15v5H4M18.37 7.16v.01M13 19.94v.01M16.84 18.37v.01M19.37 15.1v.01M19.94 11v.01"/></svg>',action:"rotateCCW"},rotateCW:{icon:'<svg><path d="M9 4.55a8 8 0 0 1 6 14.9M15 15v5h5M5.63 7.16v.01M4.06 11v.01M4.63 15.1v.01M7.16 18.37v.01M11 19.94v.01"/></svg>',action:"rotateCW"},flipX:{icon:'<svg style="stroke-width: 1.3"><path d="M12 3v18M16 7v10h5L16 7M8 7v10H3L8 7"/></svg>',action:"flipX"},flipY:{icon:'<svg style="stroke-width: 1.3"><path d="M3 12h18M7 16h10L7 21v-5M7 8h10L7 3v5"/></svg>',action:"flipY"},fitX:{icon:'<svg><path d="M4 12V6a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v6M10 18H3M21 18h-7M6 15l-3 3 3 3M18 15l3 3-3 3"/></svg>',action:"fitX"},fitY:{icon:'<svg><path d="M12 20H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h6M18 14v7M18 3v7M15 18l3 3 3-3M15 6l3-3 3 3"/></svg>',action:"fitY"},reset:{icon:'<svg><path d="M20 11A8.1 8.1 0 0 0 4.5 9M4 5v4h4M4 13a8.1 8.1 0 0 0 15.5 2m.5 4v-4h-4"/></svg>',action:"reset"},toggleFS:{icon:'<svg><g><path d="M14.5 9.5 21 3m0 0h-6m6 0v6M3 21l6.5-6.5M3 21v-6m0 6h6"/></g><g><path d="m14 10 7-7m-7 7h6m-6 0V4M3 21l7-7m0 0v6m0-6H4"/></g></svg>',action:"toggleFS"}};var Ni;(function(p){p[p.Init=0]="Init",p[p.Ready=1]="Ready",p[p.Disabled=2]="Disabled"})(Ni||(Ni={}));const gd={absolute:"auto",display:{left:["infobar"],middle:[],right:["iterateZoom","slideshow","fullscreen","thumbs","close"]},enabled:"auto",items:{infobar:{tpl:'<div class="fancybox__infobar" tabindex="-1"><span data-fancybox-current-index></span>/<span data-fancybox-count></span></div>'},download:{tpl:'<a class="f-button" title="{{DOWNLOAD}}" data-fancybox-download href="javasript:;"><svg><path d="M4 17v2a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-2M7 11l5 5 5-5M12 4v12"/></svg></a>'},prev:{tpl:'<button class="f-button" title="{{PREV}}" data-fancybox-prev><svg><path d="m15 6-6 6 6 6"/></svg></button>'},next:{tpl:'<button class="f-button" title="{{NEXT}}" data-fancybox-next><svg><path d="m9 6 6 6-6 6"/></svg></button>'},slideshow:{tpl:'<button class="f-button" title="{{TOGGLE_SLIDESHOW}}" data-fancybox-toggle-slideshow><svg><g><path d="M8 4v16l13 -8z"></path></g><g><path d="M8 4v15M17 4v15"/></g></svg></button>'},fullscreen:{tpl:'<button class="f-button" title="{{TOGGLE_FULLSCREEN}}" data-fancybox-toggle-fullscreen><svg><g><path d="M4 8V6a2 2 0 0 1 2-2h2M4 16v2a2 2 0 0 0 2 2h2M16 4h2a2 2 0 0 1 2 2v2M16 20h2a2 2 0 0 0 2-2v-2"/></g><g><path d="M15 19v-2a2 2 0 0 1 2-2h2M15 5v2a2 2 0 0 0 2 2h2M5 15h2a2 2 0 0 1 2 2v2M5 9h2a2 2 0 0 0 2-2V5"/></g></svg></button>'},thumbs:{tpl:'<button class="f-button" title="{{TOGGLE_THUMBS}}" data-fancybox-toggle-thumbs><svg><circle cx="5.5" cy="5.5" r="1"/><circle cx="12" cy="5.5" r="1"/><circle cx="18.5" cy="5.5" r="1"/><circle cx="5.5" cy="12" r="1"/><circle cx="12" cy="12" r="1"/><circle cx="18.5" cy="12" r="1"/><circle cx="5.5" cy="18.5" r="1"/><circle cx="12" cy="18.5" r="1"/><circle cx="18.5" cy="18.5" r="1"/></svg></button>'},close:{tpl:'<button class="f-button" title="{{CLOSE}}" data-fancybox-close><svg><path d="m19.5 4.5-15 15M4.5 4.5l15 15"/></svg></button>'}},parentEl:null},vd={tabindex:"-1",width:"24",height:"24",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},Ko="has-toolbar",Ia="fancybox__toolbar";class Gs extends qn{constructor(){super(...arguments),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Ni.Init}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null})}onReady(e){var r;if(!e.carousel)return;let s=this.option("display"),l=this.option("absolute"),d=this.option("enabled");if(d==="auto"){const x=this.instance.carousel;let k=0;if(x)for(const h of x.slides)(h.panzoom||h.type==="image")&&k++;k||(d=!1)}d||(s=void 0);let m=0;const u={left:[],middle:[],right:[]};if(s)for(const x of["left","middle","right"])for(const k of s[x]){const h=this.createEl(k);h&&((r=u[x])===null||r===void 0||r.push(h),m++)}let g=null;if(m&&(g=this.createContainer()),g){for(const[x,k]of Object.entries(u)){const h=document.createElement("div");qe(h,Ia+"__column is-"+x);for(const f of k)h.appendChild(f);l!=="auto"||x!=="middle"||k.length||(l=!0),g.appendChild(h)}l===!0&&qe(g,"is-absolute"),this.state=Ni.Ready,this.onRefresh()}else this.state=Ni.Disabled}onClick(e){var r,s;const l=this.instance,d=l.getSlide(),m=d==null?void 0:d.panzoom,u=e.target,g=u&&vn(u)?u.dataset:null;if(!g)return;if(g.fancyboxToggleThumbs!==void 0)return e.preventDefault(),e.stopPropagation(),void((r=l.plugins.Thumbs)===null||r===void 0||r.toggle());if(g.fancyboxToggleFullscreen!==void 0)return e.preventDefault(),e.stopPropagation(),void this.instance.toggleFullscreen();if(g.fancyboxToggleSlideshow!==void 0){e.preventDefault(),e.stopPropagation();const h=(s=l.carousel)===null||s===void 0?void 0:s.plugins.Autoplay;let f=h.isActive;return m&&m.panMode==="mousemove"&&!f&&m.reset(),void(f?h.stop():h.start())}const x=g.panzoomAction,k=g.panzoomChange;if((k||x)&&(e.preventDefault(),e.stopPropagation()),k){let h={};try{h=JSON.parse(k)}catch{}m&&m.applyChange(h)}else x&&m&&m[x]&&m[x]()}onChange(){this.onRefresh()}onRefresh(){if(this.instance.isClosing())return;const e=this.container;if(!e)return;const r=this.instance.getSlide();if(!r||r.state!==dn.Ready)return;const s=r&&!r.error&&r.panzoom;for(const m of e.querySelectorAll("[data-panzoom-action]"))s?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));let l=s&&s.canZoomIn(),d=s&&s.canZoomOut();for(const m of e.querySelectorAll('[data-panzoom-action="zoomIn"]'))l?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of e.querySelectorAll('[data-panzoom-action="zoomOut"]'))d?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));for(const m of e.querySelectorAll('[data-panzoom-action="toggleZoom"],[data-panzoom-action="iterateZoom"]')){d||l?(m.removeAttribute("disabled"),m.removeAttribute("tabindex")):(m.setAttribute("disabled",""),m.setAttribute("tabindex","-1"));const u=m.querySelector("g");u&&(u.style.display=l?"":"none")}}onDone(e,r){var s;(s=r.panzoom)===null||s===void 0||s.on("afterTransform",()=>{this.instance.isCurrentSlide(r)&&this.onRefresh()}),this.instance.isCurrentSlide(r)&&this.onRefresh()}createContainer(){const e=this.instance.container;if(!e)return null;const r=this.option("parentEl")||e;let s=r.querySelector("."+Ia);return s||(s=document.createElement("div"),qe(s,Ia),r.prepend(s)),s.addEventListener("click",this.onClick,{passive:!1,capture:!0}),e&&qe(e,Ko),this.container=s,s}createEl(e){const r=this.instance,s=r.carousel;if(!s||e==="toggleFS"||e==="fullscreen"&&!Ns())return null;let l=null;const d=s.slides.length||0;let m=0,u=0;for(const x of s.slides)(x.panzoom||x.type==="image")&&m++,(x.type==="image"||x.downloadSrc)&&u++;if(d<2&&["infobar","prev","next"].includes(e))return l;if(Ra[e]!==void 0&&!m||e==="download"&&!u)return null;if(e==="thumbs"){const x=r.plugins.Thumbs;if(!x||!x.isEnabled)return null}if(e==="slideshow"&&(!s.plugins.Autoplay||d<2))return null;if(Ra[e]!==void 0){const x=Ra[e];l=document.createElement("button"),l.setAttribute("title",this.instance.localize(`{{${e.toUpperCase()}}}`)),qe(l,"f-button"),x.action&&(l.dataset.panzoomAction=x.action),x.change&&(l.dataset.panzoomChange=JSON.stringify(x.change)),l.appendChild(Jn(this.instance.localize(x.icon)))}else{const x=(this.option("items")||[])[e];x&&(l=Jn(this.instance.localize(x.tpl)),typeof x.click=="function"&&l.addEventListener("click",k=>{k.preventDefault(),k.stopPropagation(),typeof x.click=="function"&&x.click.call(this,this,k)}))}const g=l==null?void 0:l.querySelector("svg");if(g)for(const[x,k]of Object.entries(vd))g.getAttribute(x)||g.setAttribute(x,String(k));return l}removeContainer(){const e=this.container;e&&e.remove(),this.container=null,this.state=Ni.Disabled;const r=this.instance.container;r&&St(r,Ko)}attach(){const e=this,r=e.instance;r.on("Carousel.initSlides",e.onReady),r.on("done",e.onDone),r.on(["reveal","Carousel.change"],e.onChange),e.onReady(e.instance)}detach(){const e=this,r=e.instance;r.off("Carousel.initSlides",e.onReady),r.off("done",e.onDone),r.off(["reveal","Carousel.change"],e.onChange),e.removeContainer()}}Object.defineProperty(Gs,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:gd});const bd={Hash:class extends qn{onReady(){Tr=!1}onChange(p){Ii&&clearTimeout(Ii);const{hash:e}=js(),{hash:r}=ha(),s=p.isOpeningSlide(p.getSlide());s&&(Uo=r===e?"":r),e&&e!==r&&(Ii=setTimeout(()=>{try{if(p.state===Zt.Ready){let l="replaceState";s&&!ea&&(l="pushState",ea=!0),window.history[l]({},document.title,window.location.pathname+window.location.search+e)}}catch{}},300))}onClose(p){if(Ii&&clearTimeout(Ii),!Tr&&ea)return ea=!1,Tr=!1,void window.history.back();if(!Tr)try{window.history.replaceState({},document.title,window.location.pathname+window.location.search+(Uo||""))}catch{}}attach(){const p=this.instance;p.on("ready",this.onReady),p.on(["Carousel.ready","Carousel.change"],this.onChange),p.on("close",this.onClose)}detach(){const p=this.instance;p.off("ready",this.onReady),p.off(["Carousel.ready","Carousel.change"],this.onChange),p.off("close",this.onClose)}static parseURL(){return ha()}static startFromUrl(){$s()}static destroy(){window.removeEventListener("hashchange",Us,!1)}},Html:Fs,Images:zs,Slideshow:qs,Thumbs:Ks,Toolbar:Gs},Go="with-fancybox",Ha="hide-scrollbar",Xo="--fancybox-scrollbar-compensate",Zo="--fancybox-body-margin",Na="aria-hidden",ja="is-using-tab",$a="is-animated",Jo="is-compact",Qo="is-loading",Ba="is-opening",aa="has-caption",rr="disabled",Di="tabindex",es="download",Ua="href",ar="src",vi=p=>typeof p=="string",ts=function(){var p=window.getSelection();return!!p&&p.type==="Range"};let On,Pn=null,Oi=null,ns=0,is=0,rs=0,as=0;const or=new Map;let yd=0;class gt extends so{get isIdle(){return this.idle}get isCompact(){return this.option("compact")}constructor(e=[],r={},s={}){super(r),Object.defineProperty(this,"userSlides",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"userPlugins",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"idle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"idleTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"clickTimer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"pwt",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"ignoreFocusChange",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"startedFs",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:Zt.Init}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"container",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"caption",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"footer",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"carousel",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"lastFocus",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"prevMouseMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),On||(On=Ns()),this.id=r.id||++yd,or.set(this.id,this),this.userSlides=e,this.userPlugins=s,queueMicrotask(()=>{this.init()})}init(){if(this.state===Zt.Destroy)return;this.state=Zt.Init,this.attachPlugins(Object.assign(Object.assign({},gt.Plugins),this.userPlugins)),this.emit("init"),this.emit("attachPlugins"),this.option("hideScrollbar")===!0&&(()=>{if(!Dr)return;const r=document,s=r.body,l=r.documentElement;if(s.classList.contains(Ha))return;let d=window.innerWidth-l.getBoundingClientRect().width;const m=parseFloat(window.getComputedStyle(s).marginRight);d<0&&(d=0),l.style.setProperty(Xo,`${d}px`),m&&s.style.setProperty(Zo,`${m}px`),s.classList.add(Ha)})(),this.initLayout(),this.scale();const e=()=>{this.initCarousel(this.userSlides),this.state=Zt.Ready,this.attachEvents(),this.emit("ready"),setTimeout(()=>{this.container&&this.container.setAttribute(Na,"false")},16)};this.option("Fullscreen.autoStart")&&On&&!On.isFullscreen()?On.request().then(()=>{this.startedFs=!0,e()}).catch(()=>e()):e()}initLayout(){var e,r;const s=this.option("parentEl")||document.body,l=Jn(this.localize(this.option("tpl.main")||""));if(l){if(l.setAttribute("id",`fancybox-${this.id}`),l.setAttribute("aria-label",this.localize("{{MODAL}}")),l.classList.toggle(Jo,this.isCompact),qe(l,this.option("mainClass")||""),qe(l,Ba),this.container=l,this.footer=l.querySelector(".fancybox__footer"),s.appendChild(l),qe(document.documentElement,Go),Pn&&Oi||(Pn=document.createElement("span"),qe(Pn,"fancybox-focus-guard"),Pn.setAttribute(Di,"0"),Pn.setAttribute(Na,"true"),Pn.setAttribute("aria-label","Focus guard"),Oi=Pn.cloneNode(),(e=l.parentElement)===null||e===void 0||e.insertBefore(Pn,l),(r=l.parentElement)===null||r===void 0||r.append(Oi)),l.addEventListener("mousedown",d=>{ns=d.pageX,is=d.pageY,St(l,ja)}),this.option("closeExisting"))for(const d of or.values())d.id!==this.id&&d.close();else this.option("animated")&&(qe(l,$a),setTimeout(()=>{this.isClosing()||St(l,$a)},350));this.emit("initLayout")}}initCarousel(e){const r=this.container;if(!r)return;const s=r.querySelector(".fancybox__carousel");if(!s)return;const l=this.carousel=new Ui(s,bn({},{slides:e,transition:"fade",Panzoom:{lockAxis:this.option("dragToClose")?"xy":"x",infinite:!!this.option("dragToClose")&&"y"},Dots:!1,Navigation:{classes:{container:"fancybox__nav",button:"f-button",isNext:"is-next",isPrev:"is-prev"}},initialPage:this.option("startIndex"),l10n:this.option("l10n")},this.option("Carousel")||{}));l.on("*",(d,m,...u)=>{this.emit(`Carousel.${m}`,d,...u)}),l.on(["ready","change"],()=>{this.manageCaption()}),this.on("Carousel.removeSlide",(d,m,u)=>{this.clearContent(u),u.state=void 0}),l.on("Panzoom.touchStart",()=>{var d,m;this.isCompact||this.endIdle(),!((d=document.activeElement)===null||d===void 0)&&d.closest(".f-thumbs")&&((m=this.container)===null||m===void 0||m.focus())}),l.on("settle",()=>{this.idleTimer||this.isCompact||!this.option("idle")||this.setIdle(),this.option("autoFocus")&&!this.isClosing&&this.checkFocus()}),this.option("dragToClose")&&(l.on("Panzoom.afterTransform",(d,m)=>{const u=this.getSlide();if(u&&Ya(u.el))return;const g=this.container;if(g){const x=Math.abs(m.current.f),k=x<1?"":Math.max(.5,Math.min(1,1-x/m.contentRect.fitHeight*1.5));g.style.setProperty("--fancybox-ts",k?"0s":""),g.style.setProperty("--fancybox-opacity",k+"")}}),l.on("Panzoom.touchEnd",(d,m,u)=>{var g;const x=this.getSlide();if(x&&Ya(x.el)||m.isMobile&&document.activeElement&&["TEXTAREA","INPUT"].indexOf((g=document.activeElement)===null||g===void 0?void 0:g.nodeName)!==-1)return;const k=Math.abs(m.dragOffset.y);m.lockedAxis==="y"&&(k>=200||k>=50&&m.dragOffset.time<300)&&(u&&u.cancelable&&u.preventDefault(),this.close(u,"f-throwOut"+(m.current.f<0?"Up":"Down")))})),l.on("change",d=>{var m;let u=(m=this.getSlide())===null||m===void 0?void 0:m.triggerEl;if(u){const g=new CustomEvent("slideTo",{bubbles:!0,cancelable:!0,detail:d.page});u.dispatchEvent(g)}}),l.on(["refresh","change"],d=>{const m=this.container;if(!m)return;for(const x of m.querySelectorAll("[data-fancybox-current-index]"))x.innerHTML=d.page+1;for(const x of m.querySelectorAll("[data-fancybox-count]"))x.innerHTML=d.pages.length;if(!d.isInfinite){for(const x of m.querySelectorAll("[data-fancybox-next]"))d.page<d.pages.length-1?(x.removeAttribute(rr),x.removeAttribute(Di)):(x.setAttribute(rr,""),x.setAttribute(Di,"-1"));for(const x of m.querySelectorAll("[data-fancybox-prev]"))d.page>0?(x.removeAttribute(rr),x.removeAttribute(Di)):(x.setAttribute(rr,""),x.setAttribute(Di,"-1"))}const u=this.getSlide();if(!u)return;let g=u.downloadSrc||"";g||u.type!=="image"||u.error||!vi(u[ar])||(g=u[ar]);for(const x of m.querySelectorAll("[data-fancybox-download]")){const k=u.downloadFilename;g?(x.removeAttribute(rr),x.removeAttribute(Di),x.setAttribute(Ua,g),x.setAttribute(es,k||g),x.setAttribute("target","_blank")):(x.setAttribute(rr,""),x.setAttribute(Di,"-1"),x.removeAttribute(Ua),x.removeAttribute(es))}}),this.emit("initCarousel")}attachEvents(){const e=this,r=e.container;if(!r)return;r.addEventListener("click",e.onClick,{passive:!1,capture:!1}),r.addEventListener("wheel",e.onWheel,{passive:!1,capture:!1}),document.addEventListener("keydown",e.onKeydown,{passive:!1,capture:!0}),document.addEventListener("visibilitychange",e.onVisibilityChange,!1),document.addEventListener("mousemove",e.onMousemove),e.option("trapFocus")&&document.addEventListener("focus",e.onFocus,!0),window.addEventListener("resize",e.onResize);const s=window.visualViewport;s&&(s.addEventListener("scroll",e.onResize),s.addEventListener("resize",e.onResize))}detachEvents(){const e=this,r=e.container;if(!r)return;document.removeEventListener("keydown",e.onKeydown,{passive:!1,capture:!0}),r.removeEventListener("wheel",e.onWheel,{passive:!1,capture:!1}),r.removeEventListener("click",e.onClick,{passive:!1,capture:!1}),document.removeEventListener("mousemove",e.onMousemove),window.removeEventListener("resize",e.onResize);const s=window.visualViewport;s&&(s.removeEventListener("resize",e.onResize),s.removeEventListener("scroll",e.onResize)),document.removeEventListener("visibilitychange",e.onVisibilityChange,!1),document.removeEventListener("focus",e.onFocus,!0)}scale(){const e=this.container;if(!e)return;const r=window.visualViewport,s=Math.max(1,(r==null?void 0:r.scale)||1);let l="",d="",m="";if(r&&s>1){let u=`${r.offsetLeft}px`,g=`${r.offsetTop}px`;l=r.width*s+"px",d=r.height*s+"px",m=`translate3d(${u}, ${g}, 0) scale(${1/s})`}e.style.transform=m,e.style.width=l,e.style.height=d}onClick(e){var r;const{container:s,isCompact:l}=this;if(!s||this.isClosing())return;!l&&this.option("idle")&&this.resetIdle();const d=e.composedPath()[0];if(d.closest(".fancybox-spinner")||d.closest("[data-fancybox-close]"))return e.preventDefault(),void this.close(e);if(d.closest("[data-fancybox-prev]"))return e.preventDefault(),void this.prev();if(d.closest("[data-fancybox-next]"))return e.preventDefault(),void this.next();if(e.type==="click"&&e.detail===0||Math.abs(e.pageX-ns)>30||Math.abs(e.pageY-is)>30)return;const m=document.activeElement;if(ts()&&m&&s.contains(m))return;if(l&&((r=this.getSlide())===null||r===void 0?void 0:r.type)==="image")return void(this.clickTimer?(clearTimeout(this.clickTimer),this.clickTimer=null):this.clickTimer=setTimeout(()=>{this.toggleIdle(),this.clickTimer=null},350));if(this.emit("click",e),e.defaultPrevented)return;let u=!1;if(d.closest(".fancybox__content")){if(m){if(m.closest("[contenteditable]"))return;d.matches(Da)||m.blur()}if(ts())return;u=this.option("contentClick")}else d.closest(".fancybox__carousel")&&!d.matches(Da)&&(u=this.option("backdropClick"));u==="close"?(e.preventDefault(),this.close(e)):u==="next"?(e.preventDefault(),this.next()):u==="prev"&&(e.preventDefault(),this.prev())}onWheel(e){const r=e.target;let s=this.option("wheel",e);r.closest(".fancybox__thumbs")&&(s="slide");const l=s==="slide",d=[-e.deltaX||0,-e.deltaY||0,-e.detail||0].reduce(function(g,x){return Math.abs(x)>Math.abs(g)?x:g}),m=Math.max(-1,Math.min(1,d)),u=Date.now();this.pwt&&u-this.pwt<300?l&&e.preventDefault():(this.pwt=u,this.emit("wheel",e,m),e.defaultPrevented||(s==="close"?(e.preventDefault(),this.close(e)):s==="slide"&&(da(r)||(e.preventDefault(),this[m>0?"prev":"next"]()))))}onScroll(){window.scrollTo(rs,as)}onKeydown(e){if(!this.isTopmost())return;this.isCompact||!this.option("idle")||this.isClosing()||this.resetIdle();const r=e.key,s=this.option("keyboard");if(!s)return;const l=e.composedPath()[0],d=document.activeElement&&document.activeElement.classList,m=d&&d.contains("f-button")||l.dataset.carouselPage||l.dataset.carouselIndex;if(r!=="Escape"&&!m&&vn(l)&&(l.isContentEditable||["TEXTAREA","OPTION","INPUT","SELECT","VIDEO"].indexOf(l.nodeName)!==-1)||(e.key==="Tab"?qe(this.container,ja):St(this.container,ja),e.ctrlKey||e.altKey||e.shiftKey))return;this.emit("keydown",r,e);const u=s[r];u&&typeof this[u]=="function"&&(e.preventDefault(),this[u]())}onResize(){const e=this.container;if(!e)return;const r=this.isCompact;e.classList.toggle(Jo,r),this.manageCaption(this.getSlide()),this.isCompact?this.clearIdle():this.endIdle(),this.scale(),this.emit("resize")}onFocus(e){this.isTopmost()&&this.checkFocus(e)}onMousemove(e){this.prevMouseMoveEvent=e,!this.isCompact&&this.option("idle")&&this.resetIdle()}onVisibilityChange(){document.visibilityState==="visible"?this.checkFocus():this.endIdle()}manageCloseBtn(e){const r=this.optionFor(e,"closeButton")||!1;if(r==="auto"){const l=this.plugins.Toolbar;if(l&&l.state===Ni.Ready)return}if(!r||!e.contentEl||e.closeBtnEl)return;const s=this.option("tpl.closeButton");if(s){const l=Jn(this.localize(s));e.closeBtnEl=e.contentEl.appendChild(l),e.el&&qe(e.el,"has-close-btn")}}manageCaption(e=void 0){var r,s;const l="fancybox__caption",d=this.container;if(!d)return;St(d,aa);const m=this.isCompact||this.option("commonCaption"),u=!m;if(this.caption&&this.stop(this.caption),u&&this.caption&&(this.caption.remove(),this.caption=null),m&&!this.caption)for(const h of((r=this.carousel)===null||r===void 0?void 0:r.slides)||[])h.captionEl&&(h.captionEl.remove(),h.captionEl=void 0,St(h.el,aa),(s=h.el)===null||s===void 0||s.removeAttribute("aria-labelledby"));if(e||(e=this.getSlide()),!e||m&&!this.isCurrentSlide(e))return;const g=e.el;let x=this.optionFor(e,"caption","");if(!x)return void(m&&this.caption&&this.animate(this.caption,"f-fadeOut",()=>{this.caption&&(this.caption.innerHTML="")}));let k=null;if(u){if(k=e.captionEl||null,g&&!k){const h=l+`_${this.id}_${e.index}`;k=document.createElement("div"),qe(k,l),k.setAttribute("id",h),e.captionEl=g.appendChild(k),qe(g,aa),g.setAttribute("aria-labelledby",h)}}else k=this.caption,k||(k=d.querySelector("."+l)),!k&&(k=document.createElement("div"),k.dataset.fancyboxCaption="",qe(k,l),(this.footer||d).prepend(k)),qe(d,aa),this.caption=k;k&&(k.innerHTML="",vi(x)||typeof x=="number"?k.innerHTML=x+"":x instanceof HTMLElement&&k.appendChild(x))}checkFocus(e){this.focus(e)}focus(e){var r;if(this.ignoreFocusChange)return;const s=document.activeElement||null,l=(e==null?void 0:e.target)||null,d=this.container,m=(r=this.carousel)===null||r===void 0?void 0:r.viewport;if(!d||!m||!e&&s&&d.contains(s))return;const u=this.getSlide(),g=u&&u.state===dn.Ready?u.el:null;if(!g||g.contains(s)||d===s)return;e&&e.cancelable&&e.preventDefault(),this.ignoreFocusChange=!0;const x=Array.from(d.querySelectorAll(Da));let k=[],h=null;for(let b of x){const y=!b.offsetParent||!!b.closest('[aria-hidden="true"]'),E=g&&g.contains(b),w=!m.contains(b);if(b===d||(E||w)&&!y){k.push(b);const C=b.dataset.origTabindex;C!==void 0&&C&&(b.tabIndex=parseFloat(C)),b.removeAttribute("data-orig-tabindex"),!b.hasAttribute("autoFocus")&&h||(h=b)}else{const C=b.dataset.origTabindex===void 0?b.getAttribute("tabindex")||"":b.dataset.origTabindex;C&&(b.dataset.origTabindex=C),b.tabIndex=-1}}let f=null;e?(!l||k.indexOf(l)<0)&&(f=h||d,k.length&&(s===Oi?f=k[0]:this.lastFocus!==d&&s!==Pn||(f=k[k.length-1]))):f=u&&u.type==="image"?d:h||d,f&&Bo(f),this.lastFocus=document.activeElement,this.ignoreFocusChange=!1}next(){const e=this.carousel;e&&e.pages.length>1&&e.slideNext()}prev(){const e=this.carousel;e&&e.pages.length>1&&e.slidePrev()}jumpTo(...e){this.carousel&&this.carousel.slideTo(...e)}isTopmost(){var e;return((e=gt.getInstance())===null||e===void 0?void 0:e.id)==this.id}animate(e=null,r="",s){if(!e||!r)return void(s&&s());this.stop(e);const l=d=>{d.target===e&&e.dataset.animationName&&(e.removeEventListener("animationend",l),delete e.dataset.animationName,s&&s(),St(e,r))};e.dataset.animationName=r,e.addEventListener("animationend",l),qe(e,r)}stop(e){e&&e.dispatchEvent(new CustomEvent("animationend",{bubbles:!1,cancelable:!0,currentTarget:e}))}setContent(e,r="",s=!0){if(this.isClosing())return;const l=e.el;if(!l)return;let d=null;if(vn(r)?d=r:(d=Jn(r+""),vn(d)||(d=document.createElement("div"),d.innerHTML=r+"")),["img","picture","iframe","video","audio"].includes(d.nodeName.toLowerCase())){const m=document.createElement("div");m.appendChild(d),d=m}vn(d)&&e.filter&&!e.error&&(d=d.querySelector(e.filter)),d&&vn(d)?(qe(d,"fancybox__content"),e.id&&d.setAttribute("id",e.id),l.classList.add(`has-${e.error?"error":e.type||"unknown"}`),l.prepend(d),d.style.display==="none"&&(d.style.display=""),getComputedStyle(d).getPropertyValue("display")==="none"&&(d.style.display=e.display||this.option("defaultDisplay")||"flex"),e.contentEl=d,s&&this.revealContent(e),this.manageCloseBtn(e),this.manageCaption(e)):this.setError(e,"{{ELEMENT_NOT_FOUND}}")}revealContent(e,r){const s=e.el,l=e.contentEl;s&&l&&(this.emit("reveal",e),this.hideLoading(e),e.state=dn.Opening,(r=this.isOpeningSlide(e)?r===void 0?this.optionFor(e,"showClass"):r:"f-fadeIn")?this.animate(l,r,()=>{this.done(e)}):this.done(e))}done(e){this.isClosing()||(e.state=dn.Ready,this.emit("done",e),qe(e.el,"is-done"),this.isCurrentSlide(e)&&this.option("autoFocus")&&queueMicrotask(()=>{var r;(r=e.panzoom)===null||r===void 0||r.updateControls(),this.option("autoFocus")&&this.focus()}),this.isOpeningSlide(e)&&(St(this.container,Ba),!this.isCompact&&this.option("idle")&&this.setIdle()))}isCurrentSlide(e){const r=this.getSlide();return!(!e||!r)&&r.index===e.index}isOpeningSlide(e){var r,s;return((r=this.carousel)===null||r===void 0?void 0:r.prevPage)===null&&e&&e.index===((s=this.getSlide())===null||s===void 0?void 0:s.index)}showLoading(e){e.state=dn.Loading;const r=e.el;r&&(qe(r,Qo),this.emit("loading",e),e.spinnerEl||setTimeout(()=>{if(!this.isClosing()&&!e.spinnerEl&&e.state===dn.Loading){let s=Jn(lo);qe(s,"fancybox-spinner"),e.spinnerEl=s,r.prepend(s),this.animate(s,"f-fadeIn")}},250))}hideLoading(e){const r=e.el;if(!r)return;const s=e.spinnerEl;this.isClosing()?s==null||s.remove():(St(r,Qo),s&&this.animate(s,"f-fadeOut",()=>{s.remove()}),e.state===dn.Loading&&(this.emit("loaded",e),e.state=dn.Ready))}setError(e,r){if(this.isClosing())return;const s=new Event("error",{bubbles:!0,cancelable:!0});if(this.emit("error",s,e),s.defaultPrevented)return;e.error=r,this.hideLoading(e),this.clearContent(e);const l=document.createElement("div");l.classList.add("fancybox-error"),l.innerHTML=this.localize(r||"<p>{{ERROR}}</p>"),this.setContent(e,l)}clearContent(e){if(e.state===void 0)return;this.emit("clearContent",e),e.contentEl&&(e.contentEl.remove(),e.contentEl=void 0);const r=e.el;r&&(St(r,"has-error"),St(r,"has-unknown"),St(r,`has-${e.type||"unknown"}`)),e.closeBtnEl&&e.closeBtnEl.remove(),e.closeBtnEl=void 0,e.captionEl&&e.captionEl.remove(),e.captionEl=void 0,e.spinnerEl&&e.spinnerEl.remove(),e.spinnerEl=void 0}getSlide(){var e;const r=this.carousel;return((e=r==null?void 0:r.pages[r==null?void 0:r.page])===null||e===void 0?void 0:e.slides[0])||void 0}close(e,r){if(this.isClosing())return;const s=new Event("shouldClose",{bubbles:!0,cancelable:!0});if(this.emit("shouldClose",s,e),s.defaultPrevented)return;e&&e.cancelable&&(e.preventDefault(),e.stopPropagation());const l=()=>{this.proceedClose(e,r)};this.startedFs&&On&&On.isFullscreen()?Promise.resolve(On.exit()).then(()=>l()):l()}clearIdle(){this.idleTimer&&clearTimeout(this.idleTimer),this.idleTimer=null}setIdle(e=!1){const r=()=>{this.clearIdle(),this.idle=!0,qe(this.container,"is-idle"),this.emit("setIdle")};if(this.clearIdle(),!this.isClosing())if(e)r();else{const s=this.option("idle");s&&(this.idleTimer=setTimeout(r,s))}}endIdle(){this.clearIdle(),this.idle&&!this.isClosing()&&(this.idle=!1,St(this.container,"is-idle"),this.emit("endIdle"))}resetIdle(){this.endIdle(),this.setIdle()}toggleIdle(){this.idle?this.endIdle():this.setIdle(!0)}toggleFullscreen(){On&&(On.isFullscreen()?On.exit():On.request().then(()=>{this.startedFs=!0}))}isClosing(){return[Zt.Closing,Zt.CustomClosing,Zt.Destroy].includes(this.state)}proceedClose(e,r){var s,l;this.state=Zt.Closing,this.clearIdle(),this.detachEvents();const d=this.container,m=this.carousel,u=this.getSlide(),g=u&&this.option("placeFocusBack")?u.triggerEl||this.option("triggerEl"):null;if(g&&(Hs(g)?Bo(g):g.focus()),d&&(St(d,Ba),qe(d,"is-closing"),d.setAttribute(Na,"true"),this.option("animated")&&qe(d,$a),d.style.pointerEvents="none"),m){m.clearTransitions(),(s=m.panzoom)===null||s===void 0||s.destroy(),(l=m.plugins.Navigation)===null||l===void 0||l.detach();for(const x of m.slides){x.state=dn.Closing,this.hideLoading(x);const k=x.contentEl;k&&this.stop(k);const h=x==null?void 0:x.panzoom;h&&(h.stop(),h.detachEvents(),h.detachObserver()),this.isCurrentSlide(x)||m.emit("removeSlide",x)}}rs=window.scrollX,as=window.scrollY,window.addEventListener("scroll",this.onScroll),this.emit("close",e),this.state!==Zt.CustomClosing?(r===void 0&&u&&(r=this.optionFor(u,"hideClass")),r&&u?(this.animate(u.contentEl,r,()=>{m&&m.emit("removeSlide",u)}),setTimeout(()=>{this.destroy()},500)):this.destroy()):setTimeout(()=>{this.destroy()},500)}destroy(){var e;if(this.state===Zt.Destroy)return;window.removeEventListener("scroll",this.onScroll),this.state=Zt.Destroy,(e=this.carousel)===null||e===void 0||e.destroy();const r=this.container;r&&r.remove(),or.delete(this.id);const s=gt.getInstance();s?s.focus():(Pn&&(Pn.remove(),Pn=null),Oi&&(Oi.remove(),Oi=null),St(document.documentElement,Go),(()=>{if(!Dr)return;const l=document,d=l.body;d.classList.remove(Ha),d.style.setProperty(Zo,""),l.documentElement.style.setProperty(Xo,"")})(),this.emit("destroy"))}static bind(e,r,s){if(!Dr)return;let l,d="",m={};if(e===void 0?l=document.body:vi(e)?(l=document.body,d=e,typeof r=="object"&&(m=r||{})):(l=e,vi(r)&&(d=r),typeof s=="object"&&(m=s||{})),!l||!vn(l))return;d=d||"[data-fancybox]";const u=gt.openers.get(l)||new Map;u.set(d,m),gt.openers.set(l,u),u.size===1&&l.addEventListener("click",gt.fromEvent)}static unbind(e,r){let s,l="";if(vi(e)?(s=document.body,l=e):(s=e,vi(r)&&(l=r)),!s)return;const d=gt.openers.get(s);d&&l&&d.delete(l),l&&d||(gt.openers.delete(s),s.removeEventListener("click",gt.fromEvent))}static destroy(){let e;for(;e=gt.getInstance();)e.destroy();for(const r of gt.openers.keys())r.removeEventListener("click",gt.fromEvent);gt.openers=new Map}static fromEvent(e){if(e.defaultPrevented||e.button&&e.button!==0||e.ctrlKey||e.metaKey||e.shiftKey)return;let r=e.composedPath()[0];const s=r.closest("[data-fancybox-trigger]");if(s){const y=s.dataset.fancyboxTrigger||"",E=document.querySelectorAll(`[data-fancybox="${y}"]`),w=parseInt(s.dataset.fancyboxIndex||"",10)||0;r=E[w]||r}if(!(r&&r instanceof Element))return;let l,d,m,u;if([...gt.openers].reverse().find(([y,E])=>!(!y.contains(r)||![...E].reverse().find(([w,C])=>{let _=r.closest(w);return!!_&&(l=y,d=w,m=_,u=C,!0)}))),!l||!d||!m)return;u=u||{},e.preventDefault(),r=m;let g=[],x=bn({},Ga,u);x.event=e,x.triggerEl=r,x.delegate=s;const k=x.groupAll,h=x.groupAttr,f=h&&r?r.getAttribute(`${h}`):"";if((!r||f||k)&&(g=[].slice.call(l.querySelectorAll(d))),r&&!k&&(g=f?g.filter(y=>y.getAttribute(`${h}`)===f):[r]),!g.length)return;const b=gt.getInstance();return b&&b.options.triggerEl&&g.indexOf(b.options.triggerEl)>-1?void 0:(r&&(x.startIndex=g.indexOf(r)),gt.fromNodes(g,x))}static fromSelector(e,r,s){let l=null,d="",m={};if(vi(e)?(l=document.body,d=e,typeof r=="object"&&(m=r||{})):e instanceof HTMLElement&&vi(r)&&(l=e,d=r,typeof s=="object"&&(m=s||{})),!l||!d)return!1;const u=gt.openers.get(l);return!!u&&(m=bn({},u.get(d)||{},m),!!m&&gt.fromNodes(Array.from(l.querySelectorAll(d)),m))}static fromNodes(e,r){r=bn({},Ga,r||{});const s=[];for(const l of e){const d=l.dataset||{},m=d[ar]||l.getAttribute(Ua)||l.getAttribute("currentSrc")||l.getAttribute(ar)||void 0;let u;const g=r.delegate;let x;g&&s.length===r.startIndex&&(u=g instanceof HTMLImageElement?g:g.querySelector("img:not([aria-hidden])")),u||(u=l instanceof HTMLImageElement?l:l.querySelector("img:not([aria-hidden])")),u&&(x=u.currentSrc||u[ar]||void 0,!x&&u.dataset&&(x=u.dataset.lazySrc||u.dataset[ar]||void 0));const k={src:m,triggerEl:l,thumbEl:u,thumbElSrc:x,thumbSrc:x};for(const h in d){let f=d[h]+"";f=f!=="false"&&(f==="true"||f),k[h]=f}s.push(k)}return new gt(s,r)}static getInstance(e){return e?or.get(e):Array.from(or.values()).reverse().find(r=>!r.isClosing()&&r)||null}static getSlide(){var e;return((e=gt.getInstance())===null||e===void 0?void 0:e.getSlide())||null}static show(e=[],r={}){return new gt(e,r)}static next(){const e=gt.getInstance();e&&e.next()}static prev(){const e=gt.getInstance();e&&e.prev()}static close(e=!0,...r){if(e)for(const s of or.values())s.close(...r);else{const s=gt.getInstance();s&&s.close(...r)}}}Object.defineProperty(gt,"version",{enumerable:!0,configurable:!0,writable:!0,value:"5.0.36"}),Object.defineProperty(gt,"defaults",{enumerable:!0,configurable:!0,writable:!0,value:Ga}),Object.defineProperty(gt,"Plugins",{enumerable:!0,configurable:!0,writable:!0,value:bd}),Object.defineProperty(gt,"openers",{enumerable:!0,configurable:!0,writable:!0,value:new Map});function wd(p){return p&&p.__esModule&&Object.prototype.hasOwnProperty.call(p,"default")?p.default:p}var sa={exports:{}};/*!
 * Vditor v3.10.9 - A markdown editor written in TypeScript.
 *
 * MIT License
 *
 * Copyright (c) 2018-present B3log 开源, b3log.org
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */var kd=sa.exports,os;function Ed(){return os||(os=1,function(p,e){(function(s,l){p.exports=l()})(kd,()=>(()=>{var r={192:m=>{var u=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},g=-1,x=1,k=0;u.Diff=function(h,f){return[h,f]},u.prototype.diff_main=function(h,f,b,y){typeof y>"u"&&(this.Diff_Timeout<=0?y=Number.MAX_VALUE:y=new Date().getTime()+this.Diff_Timeout*1e3);var E=y;if(h==null||f==null)throw new Error("Null input. (diff_main)");if(h==f)return h?[new u.Diff(k,h)]:[];typeof b>"u"&&(b=!0);var w=b,C=this.diff_commonPrefix(h,f),_=h.substring(0,C);h=h.substring(C),f=f.substring(C),C=this.diff_commonSuffix(h,f);var T=h.substring(h.length-C);h=h.substring(0,h.length-C),f=f.substring(0,f.length-C);var M=this.diff_compute_(h,f,w,E);return _&&M.unshift(new u.Diff(k,_)),T&&M.push(new u.Diff(k,T)),this.diff_cleanupMerge(M),M},u.prototype.diff_compute_=function(h,f,b,y){var E;if(!h)return[new u.Diff(x,f)];if(!f)return[new u.Diff(g,h)];var w=h.length>f.length?h:f,C=h.length>f.length?f:h,_=w.indexOf(C);if(_!=-1)return E=[new u.Diff(x,w.substring(0,_)),new u.Diff(k,C),new u.Diff(x,w.substring(_+C.length))],h.length>f.length&&(E[0][0]=E[2][0]=g),E;if(C.length==1)return[new u.Diff(g,h),new u.Diff(x,f)];var T=this.diff_halfMatch_(h,f);if(T){var M=T[0],v=T[1],D=T[2],N=T[3],z=T[4],H=this.diff_main(M,D,b,y),Y=this.diff_main(v,N,b,y);return H.concat([new u.Diff(k,z)],Y)}return b&&h.length>100&&f.length>100?this.diff_lineMode_(h,f,y):this.diff_bisect_(h,f,y)},u.prototype.diff_lineMode_=function(h,f,b){var y=this.diff_linesToChars_(h,f);h=y.chars1,f=y.chars2;var E=y.lineArray,w=this.diff_main(h,f,!1,b);this.diff_charsToLines_(w,E),this.diff_cleanupSemantic(w),w.push(new u.Diff(k,""));for(var C=0,_=0,T=0,M="",v="";C<w.length;){switch(w[C][0]){case x:T++,v+=w[C][1];break;case g:_++,M+=w[C][1];break;case k:if(_>=1&&T>=1){w.splice(C-_-T,_+T),C=C-_-T;for(var D=this.diff_main(M,v,!1,b),N=D.length-1;N>=0;N--)w.splice(C,0,D[N]);C=C+D.length}T=0,_=0,M="",v="";break}C++}return w.pop(),w},u.prototype.diff_bisect_=function(h,f,b){for(var y=h.length,E=f.length,w=Math.ceil((y+E)/2),C=w,_=2*w,T=new Array(_),M=new Array(_),v=0;v<_;v++)T[v]=-1,M[v]=-1;T[C+1]=0,M[C+1]=0;for(var D=y-E,N=D%2!=0,z=0,H=0,Y=0,U=0,j=0;j<w&&!(new Date().getTime()>b);j++){for(var X=-j+z;X<=j-H;X+=2){var he=C+X,Se;X==-j||X!=j&&T[he-1]<T[he+1]?Se=T[he+1]:Se=T[he-1]+1;for(var Ue=Se-X;Se<y&&Ue<E&&h.charAt(Se)==f.charAt(Ue);)Se++,Ue++;if(T[he]=Se,Se>y)H+=2;else if(Ue>E)z+=2;else if(N){var Le=C+D-X;if(Le>=0&&Le<_&&M[Le]!=-1){var Pe=y-M[Le];if(Se>=Pe)return this.diff_bisectSplit_(h,f,Se,Ue,b)}}}for(var Ie=-j+Y;Ie<=j-U;Ie+=2){var Le=C+Ie,Pe;Ie==-j||Ie!=j&&M[Le-1]<M[Le+1]?Pe=M[Le+1]:Pe=M[Le-1]+1;for(var et=Pe-Ie;Pe<y&&et<E&&h.charAt(y-Pe-1)==f.charAt(E-et-1);)Pe++,et++;if(M[Le]=Pe,Pe>y)U+=2;else if(et>E)Y+=2;else if(!N){var he=C+D-Ie;if(he>=0&&he<_&&T[he]!=-1){var Se=T[he],Ue=C+Se-he;if(Pe=y-Pe,Se>=Pe)return this.diff_bisectSplit_(h,f,Se,Ue,b)}}}}return[new u.Diff(g,h),new u.Diff(x,f)]},u.prototype.diff_bisectSplit_=function(h,f,b,y,E){var w=h.substring(0,b),C=f.substring(0,y),_=h.substring(b),T=f.substring(y),M=this.diff_main(w,C,!1,E),v=this.diff_main(_,T,!1,E);return M.concat(v)},u.prototype.diff_linesToChars_=function(h,f){var b=[],y={};b[0]="";function E(T){for(var M="",v=0,D=-1,N=b.length;D<T.length-1;){D=T.indexOf(`
`,v),D==-1&&(D=T.length-1);var z=T.substring(v,D+1);(y.hasOwnProperty?y.hasOwnProperty(z):y[z]!==void 0)?M+=String.fromCharCode(y[z]):(N==w&&(z=T.substring(v),D=T.length),M+=String.fromCharCode(N),y[z]=N,b[N++]=z),v=D+1}return M}var w=4e4,C=E(h);w=65535;var _=E(f);return{chars1:C,chars2:_,lineArray:b}},u.prototype.diff_charsToLines_=function(h,f){for(var b=0;b<h.length;b++){for(var y=h[b][1],E=[],w=0;w<y.length;w++)E[w]=f[y.charCodeAt(w)];h[b][1]=E.join("")}},u.prototype.diff_commonPrefix=function(h,f){if(!h||!f||h.charAt(0)!=f.charAt(0))return 0;for(var b=0,y=Math.min(h.length,f.length),E=y,w=0;b<E;)h.substring(w,E)==f.substring(w,E)?(b=E,w=b):y=E,E=Math.floor((y-b)/2+b);return E},u.prototype.diff_commonSuffix=function(h,f){if(!h||!f||h.charAt(h.length-1)!=f.charAt(f.length-1))return 0;for(var b=0,y=Math.min(h.length,f.length),E=y,w=0;b<E;)h.substring(h.length-E,h.length-w)==f.substring(f.length-E,f.length-w)?(b=E,w=b):y=E,E=Math.floor((y-b)/2+b);return E},u.prototype.diff_commonOverlap_=function(h,f){var b=h.length,y=f.length;if(b==0||y==0)return 0;b>y?h=h.substring(b-y):b<y&&(f=f.substring(0,b));var E=Math.min(b,y);if(h==f)return E;for(var w=0,C=1;;){var _=h.substring(E-C),T=f.indexOf(_);if(T==-1)return w;C+=T,(T==0||h.substring(E-C)==f.substring(0,C))&&(w=C,C++)}},u.prototype.diff_halfMatch_=function(h,f){if(this.Diff_Timeout<=0)return null;var b=h.length>f.length?h:f,y=h.length>f.length?f:h;if(b.length<4||y.length*2<b.length)return null;var E=this;function w(H,Y,U){for(var j=H.substring(U,U+Math.floor(H.length/4)),X=-1,he="",Se,Ue,Le,Pe;(X=Y.indexOf(j,X+1))!=-1;){var Ie=E.diff_commonPrefix(H.substring(U),Y.substring(X)),et=E.diff_commonSuffix(H.substring(0,U),Y.substring(0,X));he.length<et+Ie&&(he=Y.substring(X-et,X)+Y.substring(X,X+Ie),Se=H.substring(0,U-et),Ue=H.substring(U+Ie),Le=Y.substring(0,X-et),Pe=Y.substring(X+Ie))}return he.length*2>=H.length?[Se,Ue,Le,Pe,he]:null}var C=w(b,y,Math.ceil(b.length/4)),_=w(b,y,Math.ceil(b.length/2)),T;if(!C&&!_)return null;_?C?T=C[4].length>_[4].length?C:_:T=_:T=C;var M,v,D,N;h.length>f.length?(M=T[0],v=T[1],D=T[2],N=T[3]):(D=T[0],N=T[1],M=T[2],v=T[3]);var z=T[4];return[M,v,D,N,z]},u.prototype.diff_cleanupSemantic=function(h){for(var f=!1,b=[],y=0,E=null,w=0,C=0,_=0,T=0,M=0;w<h.length;)h[w][0]==k?(b[y++]=w,C=T,_=M,T=0,M=0,E=h[w][1]):(h[w][0]==x?T+=h[w][1].length:M+=h[w][1].length,E&&E.length<=Math.max(C,_)&&E.length<=Math.max(T,M)&&(h.splice(b[y-1],0,new u.Diff(g,E)),h[b[y-1]+1][0]=x,y--,y--,w=y>0?b[y-1]:-1,C=0,_=0,T=0,M=0,E=null,f=!0)),w++;for(f&&this.diff_cleanupMerge(h),this.diff_cleanupSemanticLossless(h),w=1;w<h.length;){if(h[w-1][0]==g&&h[w][0]==x){var v=h[w-1][1],D=h[w][1],N=this.diff_commonOverlap_(v,D),z=this.diff_commonOverlap_(D,v);N>=z?(N>=v.length/2||N>=D.length/2)&&(h.splice(w,0,new u.Diff(k,D.substring(0,N))),h[w-1][1]=v.substring(0,v.length-N),h[w+1][1]=D.substring(N),w++):(z>=v.length/2||z>=D.length/2)&&(h.splice(w,0,new u.Diff(k,v.substring(0,z))),h[w-1][0]=x,h[w-1][1]=D.substring(0,D.length-z),h[w+1][0]=g,h[w+1][1]=v.substring(z),w++),w++}w++}},u.prototype.diff_cleanupSemanticLossless=function(h){function f(z,H){if(!z||!H)return 6;var Y=z.charAt(z.length-1),U=H.charAt(0),j=Y.match(u.nonAlphaNumericRegex_),X=U.match(u.nonAlphaNumericRegex_),he=j&&Y.match(u.whitespaceRegex_),Se=X&&U.match(u.whitespaceRegex_),Ue=he&&Y.match(u.linebreakRegex_),Le=Se&&U.match(u.linebreakRegex_),Pe=Ue&&z.match(u.blanklineEndRegex_),Ie=Le&&H.match(u.blanklineStartRegex_);return Pe||Ie?5:Ue||Le?4:j&&!he&&Se?3:he||Se?2:j||X?1:0}for(var b=1;b<h.length-1;){if(h[b-1][0]==k&&h[b+1][0]==k){var y=h[b-1][1],E=h[b][1],w=h[b+1][1],C=this.diff_commonSuffix(y,E);if(C){var _=E.substring(E.length-C);y=y.substring(0,y.length-C),E=_+E.substring(0,E.length-C),w=_+w}for(var T=y,M=E,v=w,D=f(y,E)+f(E,w);E.charAt(0)===w.charAt(0);){y+=E.charAt(0),E=E.substring(1)+w.charAt(0),w=w.substring(1);var N=f(y,E)+f(E,w);N>=D&&(D=N,T=y,M=E,v=w)}h[b-1][1]!=T&&(T?h[b-1][1]=T:(h.splice(b-1,1),b--),h[b][1]=M,v?h[b+1][1]=v:(h.splice(b+1,1),b--))}b++}},u.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,u.whitespaceRegex_=/\s/,u.linebreakRegex_=/[\r\n]/,u.blanklineEndRegex_=/\n\r?\n$/,u.blanklineStartRegex_=/^\r?\n\r?\n/,u.prototype.diff_cleanupEfficiency=function(h){for(var f=!1,b=[],y=0,E=null,w=0,C=!1,_=!1,T=!1,M=!1;w<h.length;)h[w][0]==k?(h[w][1].length<this.Diff_EditCost&&(T||M)?(b[y++]=w,C=T,_=M,E=h[w][1]):(y=0,E=null),T=M=!1):(h[w][0]==g?M=!0:T=!0,E&&(C&&_&&T&&M||E.length<this.Diff_EditCost/2&&C+_+T+M==3)&&(h.splice(b[y-1],0,new u.Diff(g,E)),h[b[y-1]+1][0]=x,y--,E=null,C&&_?(T=M=!0,y=0):(y--,w=y>0?b[y-1]:-1,T=M=!1),f=!0)),w++;f&&this.diff_cleanupMerge(h)},u.prototype.diff_cleanupMerge=function(h){h.push(new u.Diff(k,""));for(var f=0,b=0,y=0,E="",w="",C;f<h.length;)switch(h[f][0]){case x:y++,w+=h[f][1],f++;break;case g:b++,E+=h[f][1],f++;break;case k:b+y>1?(b!==0&&y!==0&&(C=this.diff_commonPrefix(w,E),C!==0&&(f-b-y>0&&h[f-b-y-1][0]==k?h[f-b-y-1][1]+=w.substring(0,C):(h.splice(0,0,new u.Diff(k,w.substring(0,C))),f++),w=w.substring(C),E=E.substring(C)),C=this.diff_commonSuffix(w,E),C!==0&&(h[f][1]=w.substring(w.length-C)+h[f][1],w=w.substring(0,w.length-C),E=E.substring(0,E.length-C))),f-=b+y,h.splice(f,b+y),E.length&&(h.splice(f,0,new u.Diff(g,E)),f++),w.length&&(h.splice(f,0,new u.Diff(x,w)),f++),f++):f!==0&&h[f-1][0]==k?(h[f-1][1]+=h[f][1],h.splice(f,1)):f++,y=0,b=0,E="",w="";break}h[h.length-1][1]===""&&h.pop();var _=!1;for(f=1;f<h.length-1;)h[f-1][0]==k&&h[f+1][0]==k&&(h[f][1].substring(h[f][1].length-h[f-1][1].length)==h[f-1][1]?(h[f][1]=h[f-1][1]+h[f][1].substring(0,h[f][1].length-h[f-1][1].length),h[f+1][1]=h[f-1][1]+h[f+1][1],h.splice(f-1,1),_=!0):h[f][1].substring(0,h[f+1][1].length)==h[f+1][1]&&(h[f-1][1]+=h[f+1][1],h[f][1]=h[f][1].substring(h[f+1][1].length)+h[f+1][1],h.splice(f+1,1),_=!0)),f++;_&&this.diff_cleanupMerge(h)},u.prototype.diff_xIndex=function(h,f){var b=0,y=0,E=0,w=0,C;for(C=0;C<h.length&&(h[C][0]!==x&&(b+=h[C][1].length),h[C][0]!==g&&(y+=h[C][1].length),!(b>f));C++)E=b,w=y;return h.length!=C&&h[C][0]===g?w:w+(f-E)},u.prototype.diff_prettyHtml=function(h){for(var f=[],b=/&/g,y=/</g,E=/>/g,w=/\n/g,C=0;C<h.length;C++){var _=h[C][0],T=h[C][1],M=T.replace(b,"&amp;").replace(y,"&lt;").replace(E,"&gt;").replace(w,"&para;<br>");switch(_){case x:f[C]='<ins style="background:#e6ffe6;">'+M+"</ins>";break;case g:f[C]='<del style="background:#ffe6e6;">'+M+"</del>";break;case k:f[C]="<span>"+M+"</span>";break}}return f.join("")},u.prototype.diff_text1=function(h){for(var f=[],b=0;b<h.length;b++)h[b][0]!==x&&(f[b]=h[b][1]);return f.join("")},u.prototype.diff_text2=function(h){for(var f=[],b=0;b<h.length;b++)h[b][0]!==g&&(f[b]=h[b][1]);return f.join("")},u.prototype.diff_levenshtein=function(h){for(var f=0,b=0,y=0,E=0;E<h.length;E++){var w=h[E][0],C=h[E][1];switch(w){case x:b+=C.length;break;case g:y+=C.length;break;case k:f+=Math.max(b,y),b=0,y=0;break}}return f+=Math.max(b,y),f},u.prototype.diff_toDelta=function(h){for(var f=[],b=0;b<h.length;b++)switch(h[b][0]){case x:f[b]="+"+encodeURI(h[b][1]);break;case g:f[b]="-"+h[b][1].length;break;case k:f[b]="="+h[b][1].length;break}return f.join("	").replace(/%20/g," ")},u.prototype.diff_fromDelta=function(h,f){for(var b=[],y=0,E=0,w=f.split(/\t/g),C=0;C<w.length;C++){var _=w[C].substring(1);switch(w[C].charAt(0)){case"+":try{b[y++]=new u.Diff(x,decodeURI(_))}catch{throw new Error("Illegal escape in diff_fromDelta: "+_)}break;case"-":case"=":var T=parseInt(_,10);if(isNaN(T)||T<0)throw new Error("Invalid number in diff_fromDelta: "+_);var M=h.substring(E,E+=T);w[C].charAt(0)=="="?b[y++]=new u.Diff(k,M):b[y++]=new u.Diff(g,M);break;default:if(w[C])throw new Error("Invalid diff operation in diff_fromDelta: "+w[C])}}if(E!=h.length)throw new Error("Delta length ("+E+") does not equal source text length ("+h.length+").");return b},u.prototype.match_main=function(h,f,b){if(h==null||f==null||b==null)throw new Error("Null input. (match_main)");return b=Math.max(0,Math.min(b,h.length)),h==f?0:h.length?h.substring(b,b+f.length)==f?b:this.match_bitap_(h,f,b):-1},u.prototype.match_bitap_=function(h,f,b){if(f.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var y=this.match_alphabet_(f),E=this;function w(Se,Ue){var Le=Se/f.length,Pe=Math.abs(b-Ue);return E.Match_Distance?Le+Pe/E.Match_Distance:Pe?1:Le}var C=this.Match_Threshold,_=h.indexOf(f,b);_!=-1&&(C=Math.min(w(0,_),C),_=h.lastIndexOf(f,b+f.length),_!=-1&&(C=Math.min(w(0,_),C)));var T=1<<f.length-1;_=-1;for(var M,v,D=f.length+h.length,N,z=0;z<f.length;z++){for(M=0,v=D;M<v;)w(z,b+v)<=C?M=v:D=v,v=Math.floor((D-M)/2+M);D=v;var H=Math.max(1,b-v+1),Y=Math.min(b+v,h.length)+f.length,U=Array(Y+2);U[Y+1]=(1<<z)-1;for(var j=Y;j>=H;j--){var X=y[h.charAt(j-1)];if(z===0?U[j]=(U[j+1]<<1|1)&X:U[j]=(U[j+1]<<1|1)&X|((N[j+1]|N[j])<<1|1)|N[j+1],U[j]&T){var he=w(z,j-1);if(he<=C)if(C=he,_=j-1,_>b)H=Math.max(1,2*b-_);else break}}if(w(z+1,b)>C)break;N=U}return _},u.prototype.match_alphabet_=function(h){for(var f={},b=0;b<h.length;b++)f[h.charAt(b)]=0;for(var b=0;b<h.length;b++)f[h.charAt(b)]|=1<<h.length-b-1;return f},u.prototype.patch_addContext_=function(h,f){if(f.length!=0){if(h.start2===null)throw Error("patch not initialized");for(var b=f.substring(h.start2,h.start2+h.length1),y=0;f.indexOf(b)!=f.lastIndexOf(b)&&b.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)y+=this.Patch_Margin,b=f.substring(h.start2-y,h.start2+h.length1+y);y+=this.Patch_Margin;var E=f.substring(h.start2-y,h.start2);E&&h.diffs.unshift(new u.Diff(k,E));var w=f.substring(h.start2+h.length1,h.start2+h.length1+y);w&&h.diffs.push(new u.Diff(k,w)),h.start1-=E.length,h.start2-=E.length,h.length1+=E.length+w.length,h.length2+=E.length+w.length}},u.prototype.patch_make=function(h,f,b){var y,E;if(typeof h=="string"&&typeof f=="string"&&typeof b>"u")y=h,E=this.diff_main(y,f,!0),E.length>2&&(this.diff_cleanupSemantic(E),this.diff_cleanupEfficiency(E));else if(h&&typeof h=="object"&&typeof f>"u"&&typeof b>"u")E=h,y=this.diff_text1(E);else if(typeof h=="string"&&f&&typeof f=="object"&&typeof b>"u")y=h,E=f;else if(typeof h=="string"&&typeof f=="string"&&b&&typeof b=="object")y=h,E=b;else throw new Error("Unknown call format to patch_make.");if(E.length===0)return[];for(var w=[],C=new u.patch_obj,_=0,T=0,M=0,v=y,D=y,N=0;N<E.length;N++){var z=E[N][0],H=E[N][1];switch(!_&&z!==k&&(C.start1=T,C.start2=M),z){case x:C.diffs[_++]=E[N],C.length2+=H.length,D=D.substring(0,M)+H+D.substring(M);break;case g:C.length1+=H.length,C.diffs[_++]=E[N],D=D.substring(0,M)+D.substring(M+H.length);break;case k:H.length<=2*this.Patch_Margin&&_&&E.length!=N+1?(C.diffs[_++]=E[N],C.length1+=H.length,C.length2+=H.length):H.length>=2*this.Patch_Margin&&_&&(this.patch_addContext_(C,v),w.push(C),C=new u.patch_obj,_=0,v=D,T=M);break}z!==x&&(T+=H.length),z!==g&&(M+=H.length)}return _&&(this.patch_addContext_(C,v),w.push(C)),w},u.prototype.patch_deepCopy=function(h){for(var f=[],b=0;b<h.length;b++){var y=h[b],E=new u.patch_obj;E.diffs=[];for(var w=0;w<y.diffs.length;w++)E.diffs[w]=new u.Diff(y.diffs[w][0],y.diffs[w][1]);E.start1=y.start1,E.start2=y.start2,E.length1=y.length1,E.length2=y.length2,f[b]=E}return f},u.prototype.patch_apply=function(h,f){if(h.length==0)return[f,[]];h=this.patch_deepCopy(h);var b=this.patch_addPadding(h);f=b+f+b,this.patch_splitMax(h);for(var y=0,E=[],w=0;w<h.length;w++){var C=h[w].start2+y,_=this.diff_text1(h[w].diffs),T,M=-1;if(_.length>this.Match_MaxBits?(T=this.match_main(f,_.substring(0,this.Match_MaxBits),C),T!=-1&&(M=this.match_main(f,_.substring(_.length-this.Match_MaxBits),C+_.length-this.Match_MaxBits),(M==-1||T>=M)&&(T=-1))):T=this.match_main(f,_,C),T==-1)E[w]=!1,y-=h[w].length2-h[w].length1;else{E[w]=!0,y=T-C;var v;if(M==-1?v=f.substring(T,T+_.length):v=f.substring(T,M+this.Match_MaxBits),_==v)f=f.substring(0,T)+this.diff_text2(h[w].diffs)+f.substring(T+_.length);else{var D=this.diff_main(_,v,!1);if(_.length>this.Match_MaxBits&&this.diff_levenshtein(D)/_.length>this.Patch_DeleteThreshold)E[w]=!1;else{this.diff_cleanupSemanticLossless(D);for(var N=0,z,H=0;H<h[w].diffs.length;H++){var Y=h[w].diffs[H];Y[0]!==k&&(z=this.diff_xIndex(D,N)),Y[0]===x?f=f.substring(0,T+z)+Y[1]+f.substring(T+z):Y[0]===g&&(f=f.substring(0,T+z)+f.substring(T+this.diff_xIndex(D,N+Y[1].length))),Y[0]!==g&&(N+=Y[1].length)}}}}}return f=f.substring(b.length,f.length-b.length),[f,E]},u.prototype.patch_addPadding=function(h){for(var f=this.Patch_Margin,b="",y=1;y<=f;y++)b+=String.fromCharCode(y);for(var y=0;y<h.length;y++)h[y].start1+=f,h[y].start2+=f;var E=h[0],w=E.diffs;if(w.length==0||w[0][0]!=k)w.unshift(new u.Diff(k,b)),E.start1-=f,E.start2-=f,E.length1+=f,E.length2+=f;else if(f>w[0][1].length){var C=f-w[0][1].length;w[0][1]=b.substring(w[0][1].length)+w[0][1],E.start1-=C,E.start2-=C,E.length1+=C,E.length2+=C}if(E=h[h.length-1],w=E.diffs,w.length==0||w[w.length-1][0]!=k)w.push(new u.Diff(k,b)),E.length1+=f,E.length2+=f;else if(f>w[w.length-1][1].length){var C=f-w[w.length-1][1].length;w[w.length-1][1]+=b.substring(0,C),E.length1+=C,E.length2+=C}return b},u.prototype.patch_splitMax=function(h){for(var f=this.Match_MaxBits,b=0;b<h.length;b++)if(!(h[b].length1<=f)){var y=h[b];h.splice(b--,1);for(var E=y.start1,w=y.start2,C="";y.diffs.length!==0;){var _=new u.patch_obj,T=!0;for(_.start1=E-C.length,_.start2=w-C.length,C!==""&&(_.length1=_.length2=C.length,_.diffs.push(new u.Diff(k,C)));y.diffs.length!==0&&_.length1<f-this.Patch_Margin;){var M=y.diffs[0][0],v=y.diffs[0][1];M===x?(_.length2+=v.length,w+=v.length,_.diffs.push(y.diffs.shift()),T=!1):M===g&&_.diffs.length==1&&_.diffs[0][0]==k&&v.length>2*f?(_.length1+=v.length,E+=v.length,T=!1,_.diffs.push(new u.Diff(M,v)),y.diffs.shift()):(v=v.substring(0,f-_.length1-this.Patch_Margin),_.length1+=v.length,E+=v.length,M===k?(_.length2+=v.length,w+=v.length):T=!1,_.diffs.push(new u.Diff(M,v)),v==y.diffs[0][1]?y.diffs.shift():y.diffs[0][1]=y.diffs[0][1].substring(v.length))}C=this.diff_text2(_.diffs),C=C.substring(C.length-this.Patch_Margin);var D=this.diff_text1(y.diffs).substring(0,this.Patch_Margin);D!==""&&(_.length1+=D.length,_.length2+=D.length,_.diffs.length!==0&&_.diffs[_.diffs.length-1][0]===k?_.diffs[_.diffs.length-1][1]+=D:_.diffs.push(new u.Diff(k,D))),T||h.splice(++b,0,_)}}},u.prototype.patch_toText=function(h){for(var f=[],b=0;b<h.length;b++)f[b]=h[b];return f.join("")},u.prototype.patch_fromText=function(h){var f=[];if(!h)return f;for(var b=h.split(`
`),y=0,E=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;y<b.length;){var w=b[y].match(E);if(!w)throw new Error("Invalid patch string: "+b[y]);var C=new u.patch_obj;for(f.push(C),C.start1=parseInt(w[1],10),w[2]===""?(C.start1--,C.length1=1):w[2]=="0"?C.length1=0:(C.start1--,C.length1=parseInt(w[2],10)),C.start2=parseInt(w[3],10),w[4]===""?(C.start2--,C.length2=1):w[4]=="0"?C.length2=0:(C.start2--,C.length2=parseInt(w[4],10)),y++;y<b.length;){var _=b[y].charAt(0);try{var T=decodeURI(b[y].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+T)}if(_=="-")C.diffs.push(new u.Diff(g,T));else if(_=="+")C.diffs.push(new u.Diff(x,T));else if(_==" ")C.diffs.push(new u.Diff(k,T));else{if(_=="@")break;if(_!=="")throw new Error('Invalid patch mode "'+_+'" in: '+T)}y++}}return f},u.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},u.patch_obj.prototype.toString=function(){var h,f;this.length1===0?h=this.start1+",0":this.length1==1?h=this.start1+1:h=this.start1+1+","+this.length1,this.length2===0?f=this.start2+",0":this.length2==1?f=this.start2+1:f=this.start2+1+","+this.length2;for(var b=["@@ -"+h+" +"+f+` @@
`],y,E=0;E<this.diffs.length;E++){switch(this.diffs[E][0]){case x:y="+";break;case g:y="-";break;case k:y=" ";break}b[E+1]=y+encodeURI(this.diffs[E][1])+`
`}return b.join("").replace(/%20/g," ")},m.exports=u,m.exports.diff_match_patch=u,m.exports.DIFF_DELETE=g,m.exports.DIFF_INSERT=x,m.exports.DIFF_EQUAL=k},923:(m,u,g)=>{g.d(u,{default:()=>Ge});var x=g(288),k=g(59),h=g(784),f=g(51),b=g(500),y=g(339),E=g(108),w=function(Q){Q===void 0&&(Q=document);var Ce=function(ce){var ne=document.createElement("img");ne.src=ce.getAttribute("data-src"),ne.addEventListener("load",function(){!ce.getAttribute("style")&&!ce.getAttribute("class")&&!ce.getAttribute("width")&&!ce.getAttribute("height")&&ne.naturalHeight>ne.naturalWidth&&ne.naturalWidth/ne.naturalHeight<document.querySelector(".vditor-reset").clientWidth/(window.innerHeight-40)&&ne.naturalHeight>window.innerHeight-40&&(ce.style.height=window.innerHeight-40+"px"),ce.src=ne.src}),ce.removeAttribute("data-src")};if(!("IntersectionObserver"in window))return Q.querySelectorAll("img").forEach(function(ce){ce.getAttribute("data-src")&&Ce(ce)}),!1;window.vditorImageIntersectionObserver?(window.vditorImageIntersectionObserver.disconnect(),Q.querySelectorAll("img").forEach(function(ce){window.vditorImageIntersectionObserver.observe(ce)})):(window.vditorImageIntersectionObserver=new IntersectionObserver(function(ce){ce.forEach(function(ne){(typeof ne.isIntersecting>"u"?ne.intersectionRatio!==0:ne.isIntersecting)&&ne.target.getAttribute("data-src")&&Ce(ne.target)})}),Q.querySelectorAll("img").forEach(function(ce){window.vditorImageIntersectionObserver.observe(ce)}))},C=g(960),_=g(0),T=g(975),M=g(931),v=g(597),D=g(162),N=g(70),z=g(591),H=g(913),Y=g(873),U=g(161),j=g(598),X=g(905),he=function(Q){document.querySelectorAll(".vditor-anchor").forEach(function(Ce){Q===1&&Ce.classList.add("vditor-anchor--left"),Ce.onclick=function(){var ce=Ce.getAttribute("href").substr(1),ne=document.getElementById("vditorAnchor-"+ce).offsetTop;document.querySelector("html").scrollTop=ne}}),window.onhashchange=function(){var Ce=document.getElementById("vditorAnchor-"+decodeURIComponent(window.location.hash.substr(1)));Ce&&(document.querySelector("html").scrollTop=Ce.offsetTop)}},Se=g(796),Ue=g(827),Le=function(Q,Ce){if(Ce===void 0&&(Ce="zh_CN"),!(typeof speechSynthesis>"u"||typeof SpeechSynthesisUtterance>"u")){var ce=function(){var ot=speechSynthesis.getVoices(),_e,tt;return ot.forEach(function(kt){kt.lang===Ce.replace("_","-")&&(_e=kt),kt.default&&(tt=kt)}),_e||(_e=tt),_e},ne='<svg><use xlink:href="#vditor-icon-play"></use></svg>',Ve='<svg><use xlink:href="#vditor-icon-pause"></use></svg>';document.getElementById("vditorIconScript")||(ne='<svg viewBox="0 0 32 32"><path d="M3.436 0l25.128 16-25.128 16v-32z"></path></svg>',Ve='<svg viewBox="0 0 32 32"><path d="M20.617 0h9.128v32h-9.128v-32zM2.255 32v-32h9.128v32h-9.128z"></path></svg>');var pe=document.querySelector(".vditor-speech");pe||(pe=document.createElement("button"),pe.className="vditor-speech",Q.insertAdjacentElement("beforeend",pe),speechSynthesis.onvoiceschanged!==void 0&&(speechSynthesis.onvoiceschanged=ce));var ct=ce(),Je=new SpeechSynthesisUtterance;Je.voice=ct,Je.onend=Je.onerror=function(){pe.style.display="none",speechSynthesis.cancel(),pe.classList.remove("vditor-speech--current"),pe.innerHTML=ne},Q.addEventListener(window.ontouchstart!==void 0?"touchend":"click",function(ot){var _e=ot.target;if(_e.classList.contains("vditor-speech")||_e.parentElement.classList.contains("vditor-speech")){pe.classList.contains("vditor-speech--current")?speechSynthesis.speaking&&(speechSynthesis.paused?(speechSynthesis.resume(),pe.innerHTML=Ve):(speechSynthesis.pause(),pe.innerHTML=ne)):(Je.text=pe.getAttribute("data-text"),speechSynthesis.speak(Je),pe.classList.add("vditor-speech--current"),pe.innerHTML=Ve),(0,Ue.jl)(window.vditorSpeechRange),Q.focus();return}if(pe.style.display="none",speechSynthesis.cancel(),pe.classList.remove("vditor-speech--current"),pe.innerHTML=ne,getSelection().rangeCount!==0){var tt=getSelection().getRangeAt(0),kt=tt.toString().trim();if(kt){window.vditorSpeechRange=tt.cloneRange();var wt=tt.getBoundingClientRect();pe.innerHTML=ne,pe.style.display="block",pe.style.top=wt.top+wt.height+document.querySelector("html").scrollTop-20+"px",window.ontouchstart!==void 0?pe.style.left=ot.changedTouches[ot.changedTouches.length-1].pageX+2+"px":pe.style.left=ot.clientX+2+"px",pe.setAttribute("data-text",kt)}}})}},Pe=function(Q,Ce,ce,ne){function Ve(pe){return pe instanceof ce?pe:new ce(function(ct){ct(pe)})}return new(ce||(ce=Promise))(function(pe,ct){function Je(tt){try{_e(ne.next(tt))}catch(kt){ct(kt)}}function ot(tt){try{_e(ne.throw(tt))}catch(kt){ct(kt)}}function _e(tt){tt.done?pe(tt.value):Ve(tt.value).then(Je,ot)}_e((ne=ne.apply(Q,Ce||[])).next())})},Ie=function(Q,Ce){var ce={label:0,sent:function(){if(pe[0]&1)throw pe[1];return pe[1]},trys:[],ops:[]},ne,Ve,pe,ct;return ct={next:Je(0),throw:Je(1),return:Je(2)},typeof Symbol=="function"&&(ct[Symbol.iterator]=function(){return this}),ct;function Je(_e){return function(tt){return ot([_e,tt])}}function ot(_e){if(ne)throw new TypeError("Generator is already executing.");for(;ct&&(ct=0,_e[0]&&(ce=0)),ce;)try{if(ne=1,Ve&&(pe=_e[0]&2?Ve.return:_e[0]?Ve.throw||((pe=Ve.return)&&pe.call(Ve),0):Ve.next)&&!(pe=pe.call(Ve,_e[1])).done)return pe;switch(Ve=0,pe&&(_e=[_e[0]&2,pe.value]),_e[0]){case 0:case 1:pe=_e;break;case 4:return ce.label++,{value:_e[1],done:!1};case 5:ce.label++,Ve=_e[1],_e=[0];continue;case 7:_e=ce.ops.pop(),ce.trys.pop();continue;default:if(pe=ce.trys,!(pe=pe.length>0&&pe[pe.length-1])&&(_e[0]===6||_e[0]===2)){ce=0;continue}if(_e[0]===3&&(!pe||_e[1]>pe[0]&&_e[1]<pe[3])){ce.label=_e[1];break}if(_e[0]===6&&ce.label<pe[1]){ce.label=pe[1],pe=_e;break}if(pe&&ce.label<pe[2]){ce.label=pe[2],ce.ops.push(_e);break}pe[2]&&ce.ops.pop(),ce.trys.pop();continue}_e=Ce.call(Q,ce)}catch(tt){_e=[6,tt],Ve=0}finally{ne=pe=0}if(_e[0]&5)throw _e[1];return{value:_e[0]?_e[1]:void 0,done:!0}}},et=function(Q){var Ce,ce={anchor:0,cdn:H.Y.CDN,customEmoji:{},emojiPath:"".concat(H.Y.CDN,"/dist/images/emoji"),hljs:H.Y.HLJS_OPTIONS,icon:"ant",lang:"zh_CN",markdown:H.Y.MARKDOWN_OPTIONS,math:H.Y.MATH_OPTIONS,mode:"light",speech:{enable:!1},render:{media:{enable:!0}},theme:H.Y.THEME_OPTIONS};return Q.cdn&&(!((Ce=Q.theme)===null||Ce===void 0)&&Ce.path||(ce.theme.path="".concat(Q.cdn,"/dist/css/content-theme")),Q.emojiPath||(ce.emojiPath="".concat(Q.cdn,"/dist/images/emoji"))),(0,X.h)(ce,Q)},rt=function(Q,Ce){var ce=et(Ce);return(0,U.Z)("".concat(ce.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){var ne=(0,Se.X)({autoSpace:ce.markdown.autoSpace,gfmAutoLink:ce.markdown.gfmAutoLink,codeBlockPreview:ce.markdown.codeBlockPreview,emojiSite:ce.emojiPath,emojis:ce.customEmoji,fixTermTypo:ce.markdown.fixTermTypo,footnotes:ce.markdown.footnotes,headingAnchor:ce.anchor!==0,inlineMathDigit:ce.math.inlineDigit,lazyLoadImage:ce.lazyLoadImage,linkBase:ce.markdown.linkBase,linkPrefix:ce.markdown.linkPrefix,listStyle:ce.markdown.listStyle,mark:ce.markdown.mark,mathBlockPreview:ce.markdown.mathBlockPreview,paragraphBeginningSpace:ce.markdown.paragraphBeginningSpace,sanitize:ce.markdown.sanitize,toc:ce.markdown.toc});return Ce!=null&&Ce.renderers&&ne.SetJSRenderers({renderers:{Md2HTML:Ce.renderers}}),ne.SetHeadingID(!0),ne.Md2HTML(Q)})},B=function(Q,Ce,ce){return Pe(void 0,void 0,void 0,function(){var ne,Ve,pe,ct;return Ie(this,function(Je){switch(Je.label){case 0:return ne=et(ce),[4,rt(Ce,ne)];case 1:if(Ve=Je.sent(),ne.transform&&(Ve=ne.transform(Ve)),Q.innerHTML=Ve,Q.classList.add("vditor-reset"),ne.i18n)return[3,5];if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(ne.lang))return[3,2];throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");case 2:return pe="vditorI18nScript",ct=pe+ne.lang,document.querySelectorAll('head script[id^="'.concat(pe,'"]')).forEach(function(ot){ot.id!==ct&&document.head.removeChild(ot)}),[4,(0,U.Z)("".concat(ne.cdn,"/dist/js/i18n/").concat(ne.lang,".js"),ct)];case 3:Je.sent(),Je.label=4;case 4:return[3,6];case 5:window.VditorI18n=ne.i18n,Je.label=6;case 6:return ne.icon?[4,(0,U.Z)("".concat(ne.cdn,"/dist/js/icons/").concat(ne.icon,".js"),"vditorIconScript")]:[3,8];case 7:Je.sent(),Je.label=8;case 8:return(0,Y.H)(ne.theme.current,ne.theme.path),ne.anchor===1&&Q.classList.add("vditor-reset--anchor"),(0,f.o)(Q,ne.hljs),(0,E.$)(ne.hljs,Q,ne.cdn),(0,C.T)(Q,{cdn:ne.cdn,math:ne.math}),(0,T.e)(Q,ne.cdn,ne.mode),(0,M.Y)(Q,ne.cdn,ne.mode),(0,v.K)(Q,ne.cdn),(0,b.D)(Q,ne.cdn),(0,y.m)(Q,ne.cdn),(0,h.v)(Q,ne.cdn,ne.mode),(0,D.l)(Q,ne.cdn,ne.mode),(0,z.M)(Q,ne.cdn),(0,x.$)(Q,ne.cdn),ne.render.media.enable&&(0,_.l)(Q),ne.speech.enable&&Le(Q),ne.anchor!==0&&he(ne.anchor),ne.after&&ne.after(),ne.lazyLoadImage&&w(Q),Q.addEventListener("click",function(ot){var _e=(0,j._Y)(ot.target,"SPAN");if(_e&&(0,j.KJ)(_e,"vditor-toc")){var tt=Q.querySelector("#"+_e.getAttribute("data-target-id"));tt&&window.scrollTo(window.scrollX,tt.offsetTop);return}}),[2]}})})},le=g(726),re=g(13),Re=function(){function Q(){}return Q.adapterRender=k,Q.previewImage=le.o,Q.codeRender=f.o,Q.graphvizRender=y.m,Q.highlightRender=E.$,Q.mathRender=C.T,Q.mermaidRender=T.e,Q.SMILESRender=M.Y,Q.markmapRender=v.K,Q.flowchartRender=b.D,Q.chartRender=h.v,Q.abcRender=x.$,Q.mindmapRender=D.l,Q.plantumlRender=z.M,Q.outlineRender=N.N,Q.mediaRender=_.l,Q.speechRender=Le,Q.lazyLoadImageRender=w,Q.md2html=rt,Q.preview=B,Q.setCodeTheme=re.h,Q.setContentTheme=Y.H,Q}();const Ge=Re},913:(m,u,g)=>{g.d(u,{Y:()=>k,g:()=>x});var x="3.10.9",k=function(){function h(){}return h.ZWSP="​",h.DROP_EDITOR="application/editor",h.MOBILE_WIDTH=520,h.CLASS_MENU_DISABLED="vditor-menu--disabled",h.EDIT_TOOLBARS=["emoji","headings","bold","italic","strike","link","list","ordered-list","outdent","indent","check","line","quote","code","inline-code","insert-after","insert-before","upload","record","table"],h.CODE_THEME=["a11y-dark","agate","an-old-hope","androidstudio","arta","atom-one-dark","atom-one-dark-reasonable","base16/3024","base16/apathy","base16/apprentice","base16/ashes","base16/atelier-cave","base16/atelier-dune","base16/atelier-estuary","base16/atelier-forest","base16/atelier-heath","base16/atelier-lakeside","base16/atelier-plateau","base16/atelier-savanna","base16/atelier-seaside","base16/atelier-sulphurpool","base16/atlas","base16/bespin","base16/black-metal","base16/black-metal-bathory","base16/black-metal-burzum","base16/black-metal-dark-funeral","base16/black-metal-gorgoroth","base16/black-metal-immortal","base16/black-metal-khold","base16/black-metal-marduk","base16/black-metal-mayhem","base16/black-metal-nile","base16/black-metal-venom","base16/brewer","base16/bright","base16/brogrammer","base16/brush-trees-dark","base16/chalk","base16/circus","base16/classic-dark","base16/codeschool","base16/colors","base16/danqing","base16/darcula","base16/dark-violet","base16/darkmoss","base16/darktooth","base16/decaf","base16/default-dark","base16/dracula","base16/edge-dark","base16/eighties","base16/embers","base16/equilibrium-dark","base16/equilibrium-gray-dark","base16/espresso","base16/eva","base16/eva-dim","base16/flat","base16/framer","base16/gigavolt","base16/google-dark","base16/grayscale-dark","base16/green-screen","base16/gruvbox-dark-hard","base16/gruvbox-dark-medium","base16/gruvbox-dark-pale","base16/gruvbox-dark-soft","base16/hardcore","base16/harmonic16-dark","base16/heetch-dark","base16/helios","base16/hopscotch","base16/horizon-dark","base16/humanoid-dark","base16/ia-dark","base16/icy-dark","base16/ir-black","base16/isotope","base16/kimber","base16/london-tube","base16/macintosh","base16/marrakesh","base16/materia","base16/material","base16/material-darker","base16/material-palenight","base16/material-vivid","base16/mellow-purple","base16/mocha","base16/monokai","base16/nebula","base16/nord","base16/nova","base16/ocean","base16/oceanicnext","base16/onedark","base16/outrun-dark","base16/papercolor-dark","base16/paraiso","base16/pasque","base16/phd","base16/pico","base16/pop","base16/porple","base16/qualia","base16/railscasts","base16/rebecca","base16/ros-pine","base16/ros-pine-moon","base16/sandcastle","base16/seti-ui","base16/silk-dark","base16/snazzy","base16/solar-flare","base16/solarized-dark","base16/spacemacs","base16/summercamp","base16/summerfruit-dark","base16/synth-midnight-terminal-dark","base16/tango","base16/tender","base16/tomorrow-night","base16/twilight","base16/unikitty-dark","base16/vulcan","base16/windows-10","base16/windows-95","base16/windows-high-contrast","base16/windows-nt","base16/woodland","base16/xcode-dusk","base16/zenburn","codepen-embed","dark","devibeans","far","felipec","github-dark","github-dark-dimmed","gml","gradient-dark","hybrid","ir-black","isbl-editor-dark","kimbie-dark","lioshi","monokai","monokai-sublime","night-owl","nnfx-dark","nord","obsidian","panda-syntax-dark","paraiso-dark","pojoaque","qtcreator-dark","rainbow","shades-of-purple","srcery","stackoverflow-dark","sunburst","tomorrow-night-blue","tomorrow-night-bright","tokyo-night-dark","vs2015","xt256","ant-design","a11y-light","arduino-light","ascetic","atom-one-light","base16/atelier-cave-light","base16/atelier-dune-light","base16/atelier-estuary-light","base16/atelier-forest-light","base16/atelier-heath-light","base16/atelier-lakeside-light","base16/atelier-plateau-light","base16/atelier-savanna-light","base16/atelier-seaside-light","base16/atelier-sulphurpool-light","base16/brush-trees","base16/classic-light","base16/cupcake","base16/cupertino","base16/default-light","base16/dirtysea","base16/edge-light","base16/equilibrium-gray-light","base16/equilibrium-light","base16/fruit-soda","base16/github","base16/google-light","base16/grayscale-light","base16/gruvbox-light-hard","base16/gruvbox-light-medium","base16/gruvbox-light-soft","base16/harmonic16-light","base16/heetch-light","base16/humanoid-light","base16/horizon-light","base16/ia-light","base16/material-lighter","base16/mexico-light","base16/one-light","base16/papercolor-light","base16/ros-pine-dawn","base16/sagelight","base16/shapeshifter","base16/silk-light","base16/solar-flare-light","base16/solarized-light","base16/summerfruit-light","base16/synth-midnight-terminal-light","base16/tomorrow","base16/unikitty-light","base16/windows-10-light","base16/windows-95-light","base16/windows-high-contrast-light","brown-paper","base16/windows-nt-light","color-brewer","docco","foundation","github","googlecode","gradient-light","grayscale","idea","intellij-light","isbl-editor-light","kimbie-light","lightfair","magula","mono-blue","nnfx-light","panda-syntax-light","paraiso-light","purebasic","qtcreator-light","routeros","school-book","stackoverflow-light","tokyo-night-light","vs","xcode","default"],h.ALIAS_CODE_LANGUAGES=["abc","plantuml","mermaid","flowchart","echarts","mindmap","graphviz","math","markmap","smiles","js","ts","html","toml","c#","bat"],h.CDN="https://unpkg.com/vditor@".concat("3.10.9"),h.MARKDOWN_OPTIONS={autoSpace:!1,gfmAutoLink:!0,codeBlockPreview:!0,fixTermTypo:!1,footnotes:!0,linkBase:"",linkPrefix:"",listStyle:!1,mark:!1,mathBlockPreview:!0,paragraphBeginningSpace:!1,sanitize:!0,toc:!1},h.HLJS_OPTIONS={enable:!0,lineNumber:!1,defaultLang:"",style:"github"},h.MATH_OPTIONS={engine:"KaTeX",inlineDigit:!1,macros:{}},h.THEME_OPTIONS={current:"light",list:{"ant-design":"Ant Design",dark:"Dark",light:"Light",wechat:"WeChat"},path:"".concat(h.CDN,"/dist/css/content-theme")},h}()},931:(m,u,g)=>{g.d(u,{Y:()=>b});var x=g(913),k=g(161),h=g(59),f=g(933),b=function(y,E,w){y===void 0&&(y=document),E===void 0&&(E=x.Y.CDN);var C=h.SMILESRenderAdapter.getElements(y);C.length>0&&(0,k.Z)("".concat(E,"/dist/js/smiles-drawer/smiles-drawer.min.js?v=2.1.7"),"vditorAbcjsScript").then(function(){var _=new SmiDrawer({},{});C.forEach(function(T){var M=h.SMILESRenderAdapter.getCode(T).trim();if(!(T.getAttribute("data-processed")==="true"||M.trim()==="")){var v="smiles"+(0,f.Ee)();T.innerHTML='<svg id="'.concat(v,'"></svg>'),_.draw(M,"#"+v,w==="dark"?"dark":void 0),T.setAttribute("data-processed","true")}})})}},288:(m,u,g)=>{g.d(u,{$:()=>f});var x=g(913),k=g(161),h=g(59),f=function(b,y){b===void 0&&(b=document),y===void 0&&(y=x.Y.CDN);var E=h.abcRenderAdapter.getElements(b);E.length>0&&(0,k.Z)("".concat(y,"/dist/js/abcjs/abcjs_basic.min.js"),"vditorAbcjsScript").then(function(){E.forEach(function(w){w.parentElement.classList.contains("vditor-wysiwyg__pre")||w.parentElement.classList.contains("vditor-ir__marker--pre")||w.getAttribute("data-processed")!=="true"&&(ABCJS.renderAbc(w,h.abcRenderAdapter.getCode(w).trim()),w.style.overflowX="auto",w.setAttribute("data-processed","true"))})})}},59:(m,u,g)=>{g.r(u),g.d(u,{SMILESRenderAdapter:()=>k,abcRenderAdapter:()=>E,chartRenderAdapter:()=>y,flowchartRenderAdapter:()=>C,graphvizRenderAdapter:()=>w,markmapRenderAdapter:()=>f,mathRenderAdapter:()=>x,mermaidRenderAdapter:()=>h,mindmapRenderAdapter:()=>b,plantumlRenderAdapter:()=>_});var x={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-math")}},k={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-smiles")}},h={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-mermaid")}},f={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-markmap")}},b={getCode:function(T){return T.getAttribute("data-code")},getElements:function(T){return T.querySelectorAll(".language-mindmap")}},y={getCode:function(T){return T.innerText},getElements:function(T){return T.querySelectorAll(".language-echarts")}},E={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-abc")}},w={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-graphviz")}},C={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-flowchart")}},_={getCode:function(T){return T.textContent},getElements:function(T){return T.querySelectorAll(".language-plantuml")}}},784:(m,u,g)=>{g.d(u,{v:()=>E});var x=g(913),k=g(161),h=g(59),f=g(933),b=function(w,C,_,T){function M(v){return v instanceof _?v:new _(function(D){D(v)})}return new(_||(_=Promise))(function(v,D){function N(Y){try{H(T.next(Y))}catch(U){D(U)}}function z(Y){try{H(T.throw(Y))}catch(U){D(U)}}function H(Y){Y.done?v(Y.value):M(Y.value).then(N,z)}H((T=T.apply(w,C||[])).next())})},y=function(w,C){var _={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},T,M,v,D;return D={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function N(H){return function(Y){return z([H,Y])}}function z(H){if(T)throw new TypeError("Generator is already executing.");for(;D&&(D=0,H[0]&&(_=0)),_;)try{if(T=1,M&&(v=H[0]&2?M.return:H[0]?M.throw||((v=M.return)&&v.call(M),0):M.next)&&!(v=v.call(M,H[1])).done)return v;switch(M=0,v&&(H=[H[0]&2,v.value]),H[0]){case 0:case 1:v=H;break;case 4:return _.label++,{value:H[1],done:!1};case 5:_.label++,M=H[1],H=[0];continue;case 7:H=_.ops.pop(),_.trys.pop();continue;default:if(v=_.trys,!(v=v.length>0&&v[v.length-1])&&(H[0]===6||H[0]===2)){_=0;continue}if(H[0]===3&&(!v||H[1]>v[0]&&H[1]<v[3])){_.label=H[1];break}if(H[0]===6&&_.label<v[1]){_.label=v[1],v=H;break}if(v&&_.label<v[2]){_.label=v[2],_.ops.push(H);break}v[2]&&_.ops.pop(),_.trys.pop();continue}H=C.call(w,_)}catch(Y){H=[6,Y],M=0}finally{T=v=0}if(H[0]&5)throw H[1];return{value:H[0]?H[1]:void 0,done:!0}}},E=function(w,C,_){w===void 0&&(w=document),C===void 0&&(C=x.Y.CDN);var T=h.chartRenderAdapter.getElements(w);T.length>0&&(0,k.Z)("".concat(C,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){T.forEach(function(M){return b(void 0,void 0,void 0,function(){var v,D,N;return y(this,function(z){switch(z.label){case 0:if(M.parentElement.classList.contains("vditor-wysiwyg__pre")||M.parentElement.classList.contains("vditor-ir__marker--pre"))return[2];if(v=h.chartRenderAdapter.getCode(M).trim(),!v)return[2];z.label=1;case 1:return z.trys.push([1,3,,4]),M.getAttribute("data-processed")==="true"?[2]:[4,(0,f.kY)(v)];case 2:return D=z.sent(),echarts.init(M,_==="dark"?"dark":void 0).setOption(D),M.setAttribute("data-processed","true"),[3,4];case 3:return N=z.sent(),M.className="vditor-reset--error",M.innerHTML="echarts render error: <br>".concat(N),[3,4];case 4:return[2]}})})})})}},51:(m,u,g)=>{g.d(u,{o:()=>h});var x=g(695),k=g(913),h=function(f,b){Array.from(f.querySelectorAll("pre > code")).filter(function(y,E){return!(y.parentElement.classList.contains("vditor-wysiwyg__pre")||y.parentElement.classList.contains("vditor-ir__marker--pre")||y.classList.contains("language-mermaid")||y.classList.contains("language-flowchart")||y.classList.contains("language-echarts")||y.classList.contains("language-mindmap")||y.classList.contains("language-plantuml")||y.classList.contains("language-markmap")||y.classList.contains("language-abc")||y.classList.contains("language-graphviz")||y.classList.contains("language-math")||y.classList.contains("language-smiles")||y.style.maxHeight.indexOf("px")>-1||f.classList.contains("vditor-preview")&&E>5)}).forEach(function(y){var E,w,C,_=y.innerText;if(y.classList.contains("highlight-chroma")){var T=y.cloneNode(!0);T.querySelectorAll(".highlight-ln").forEach(function(N){N.remove()}),_=T.innerText}else _.endsWith(`
`)&&(_=_.substr(0,_.length-1));var M='<svg><use xlink:href="#vditor-icon-copy"></use></svg>';document.getElementById("vditorIconScript")||(M='<svg viewBox="0 0 32 32"><path d="M22.545-0h-17.455c-1.6 0-2.909 1.309-2.909 2.909v20.364h2.909v-20.364h17.455v-2.909zM26.909 5.818h-16c-1.6 0-2.909 1.309-2.909 2.909v20.364c0 1.6 1.309 2.909 2.909 2.909h16c1.6 0 2.909-1.309 2.909-2.909v-20.364c0-1.6-1.309-2.909-2.909-2.909zM26.909 29.091h-16v-20.364h16v20.364z"></path></svg>');var v=document.createElement("div");v.className="vditor-copy",v.innerHTML='<span aria-label="'.concat(((E=window.VditorI18n)===null||E===void 0?void 0:E.copy)||"复制",`"
onmouseover="this.setAttribute('aria-label', '`).concat(((w=window.VditorI18n)===null||w===void 0?void 0:w.copy)||"复制",`')"
class="vditor-tooltipped vditor-tooltipped__w"
onclick="this.previousElementSibling.select();document.execCommand('copy');this.setAttribute('aria-label', '`).concat(((C=window.VditorI18n)===null||C===void 0?void 0:C.copied)||"已复制",`');this.previousElementSibling.blur()">`).concat(M,"</span>");var D=document.createElement("textarea");D.value=(0,x.p)(_),v.insertAdjacentElement("afterbegin",D),b&&b.renderMenu&&b.renderMenu(y,v),y.before(v),y.style.maxHeight=window.outerHeight-40+"px",y.insertAdjacentHTML("afterend",'<span style="position: absolute">'.concat(k.Y.ZWSP,"</span>"))})}},500:(m,u,g)=>{g.d(u,{D:()=>f});var x=g(913),k=g(161),h=g(59),f=function(b,y){y===void 0&&(y=x.Y.CDN);var E=h.flowchartRenderAdapter.getElements(b);E.length!==0&&(0,k.Z)("".concat(y,"/dist/js/flowchart.js/flowchart.min.js"),"vditorFlowchartScript").then(function(){E.forEach(function(w){if(w.getAttribute("data-processed")!=="true"){var C=flowchart.parse(h.flowchartRenderAdapter.getCode(w));w.innerHTML="",C.drawSVG(w),w.setAttribute("data-processed","true")}})})}},339:(m,u,g)=>{g.d(u,{m:()=>f});var x=g(913),k=g(161),h=g(59),f=function(b,y){y===void 0&&(y=x.Y.CDN);var E=h.graphvizRenderAdapter.getElements(b);E.length!==0&&(0,k.Z)("".concat(y,"/dist/js/graphviz/viz.js"),"vditorGraphVizScript").then(function(){E.forEach(function(w){var C=h.graphvizRenderAdapter.getCode(w);if(!(w.parentElement.classList.contains("vditor-wysiwyg__pre")||w.parentElement.classList.contains("vditor-ir__marker--pre"))&&!(w.getAttribute("data-processed")==="true"||C.trim()==="")){try{var _=new Blob(["importScripts('".concat(document.getElementById("vditorGraphVizScript").src.replace("viz.js","full.render.js"),"');")],{type:"application/javascript"}),T=window.URL||window.webkitURL,M=T.createObjectURL(_),v=new Worker(M);new Viz({worker:v}).renderSVGElement(C).then(function(D){w.innerHTML=D.outerHTML}).catch(function(D){w.innerHTML="graphviz render error: <br>".concat(D),w.className="vditor-reset--error"})}catch(D){console.error("graphviz error",D)}w.setAttribute("data-processed","true")}})})}},108:(m,u,g)=>{g.d(u,{$:()=>f});var x=g(913),k=g(161),h=g(505),f=function(b,y,E){y===void 0&&(y=document),E===void 0&&(E=x.Y.CDN);var w=b.style;x.Y.CODE_THEME.includes(w)||(w="github");var C=document.getElementById("vditorHljsStyle"),_="".concat(E,"/dist/js/highlight.js/styles/").concat(w,".min.css");if(C&&C.getAttribute("href")!==_&&C.remove(),(0,h.T)("".concat(E,"/dist/js/highlight.js/styles/").concat(w,".min.css"),"vditorHljsStyle"),b.enable!==!1){var T=y.querySelectorAll("pre > code");T.length!==0&&(0,k.Z)("".concat(E,"/dist/js/highlight.js/highlight.min.js?v=11.7.0"),"vditorHljsScript").then(function(){(0,k.Z)("".concat(E,"/dist/js/highlight.js/third-languages.js?v=1.0.1"),"vditorHljsThirdScript").then(function(){y.querySelectorAll("pre > code").forEach(function(M){if(!(M.parentElement.classList.contains("vditor-ir__marker--pre")||M.parentElement.classList.contains("vditor-wysiwyg__pre"))&&!(M.classList.contains("language-mermaid")||M.classList.contains("language-flowchart")||M.classList.contains("language-echarts")||M.classList.contains("language-mindmap")||M.classList.contains("language-plantuml")||M.classList.contains("language-smiles")||M.classList.contains("language-abc")||M.classList.contains("language-graphviz")||M.classList.contains("language-math"))){b.defaultLang!==""&&M.className.indexOf("language-")===-1&&M.classList.add("language-"+b.defaultLang);var v=M.className.replace("language-","");if(window.hljs.getLanguage(v)||(v="plaintext"),M.innerHTML=window.hljs.highlight(M.textContent,{language:v,ignoreIllegals:!0}).value,M.classList.add("hljs"),!!b.lineNumber){M.classList.add("vditor-linenumber");var D=M.querySelector(".vditor-linenumber__temp");D||(D=document.createElement("div"),D.className="vditor-linenumber__temp",M.insertAdjacentElement("beforeend",D));var N=getComputedStyle(M).whiteSpace,z=!1;(N==="pre-wrap"||N==="pre-line")&&(z=!0);var H="",Y=M.textContent.split(/\r\n|\r|\n/g);Y.pop(),Y.map(function(U){var j="";z&&(D.textContent=U||`
`,j=' style="height:'.concat(D.getBoundingClientRect().height,'px"')),H+="<span".concat(j,"></span>")}),D.style.display="none",H='<span class="vditor-linenumber__rows">'.concat(H,"</span>"),M.insertAdjacentHTML("beforeend",H)}}})})})}}},597:(m,u,g)=>{g.d(u,{K:()=>E});var x=g(913),k=g(161),h=g(59),f={},b=function(w,C){var _=w.transform(C),T=Object.keys(_.features).filter(function(z){return!f[z]});T.forEach(function(z){f[z]=!0});var M=w.getAssets(T),v=M.styles,D=M.scripts,N=window.markmap;return v&&N.loadCSS(v),D&&N.loadJS(D),_},y=function(w,C){var _=window.markmap,T=_.Transformer,M=_.Markmap,v=_.deriveOptions;_.globalCSS;var D=new T;w.innerHTML='<svg style="width:100%"></svg>';var N=w.firstChild,z=M.create(N,null),H=b(D,C),Y=H.root,U=H.frontmatter,j=U==null?void 0:U.markmap,X=v(j);z.setData(Y,X),z.fit()},E=function(w,C){w===void 0&&(w=document),C===void 0&&(C=x.Y.CDN);var _=h.markmapRenderAdapter.getElements(w);_.length!==0&&(0,k.Z)("".concat(C,"/dist/js/markmap/markmap.min.js"),"vditorMarkerScript").then(function(){_.forEach(function(T){var M=h.markmapRenderAdapter.getCode(T);if(!(T.getAttribute("data-processed")==="true"||M.trim()==="")){var v=document.createElement("div");v.className="language-markmap",T.parentNode.appendChild(v),y(v,M),T.parentNode.childNodes[0].nodeName=="CODE"&&T.parentNode.removeChild(T.parentNode.childNodes[0])}})})}},960:(m,u,g)=>{g.d(u,{T:()=>y});var x=g(913),k=g(161),h=g(505),f=g(695),b=g(59),y=function(E,w){E===void 0&&(E=document);var C=b.mathRenderAdapter.getElements(E);if(C.length!==0){var _={cdn:x.Y.CDN,math:{engine:"KaTeX",inlineDigit:!1,macros:{}}};if(w&&w.math&&(w.math=Object.assign({},_.math,w.math)),w=Object.assign({},_,w),w.math.engine==="KaTeX")(0,h.T)("".concat(w.cdn,"/dist/js/katex/katex.min.css?v=0.16.9"),"vditorKatexStyle"),(0,k.Z)("".concat(w.cdn,"/dist/js/katex/katex.min.js?v=0.16.9"),"vditorKatexScript").then(function(){(0,k.Z)("".concat(w.cdn,"/dist/js/katex/mhchem.min.js?v=0.16.9"),"vditorKatexChemScript").then(function(){C.forEach(function(v){if(!(v.parentElement.classList.contains("vditor-wysiwyg__pre")||v.parentElement.classList.contains("vditor-ir__marker--pre"))&&!v.getAttribute("data-math")){var D=(0,f.p)(b.mathRenderAdapter.getCode(v));v.setAttribute("data-math",D);try{v.innerHTML=katex.renderToString(D,{displayMode:v.tagName==="DIV",output:"html",macros:w.math.macros})}catch(N){v.innerHTML=N.message,v.className="language-math vditor-reset--error"}v.addEventListener("copy",function(N){N.stopPropagation(),N.preventDefault();var z=N.currentTarget.closest(".language-math");N.clipboardData.setData("text/html",z.innerHTML),N.clipboardData.setData("text/plain",z.getAttribute("data-math"))})}})})});else if(w.math.engine==="MathJax"){var T=function(v){if(v.length!==0){var D=0,N=v[v.length-1],z=function(){var H=v[D++];H===N?H():H(z)};z()}};window.MathJax||(window.MathJax={loader:{paths:{mathjax:"".concat(w.cdn,"/dist/js/mathjax")}},startup:{typeset:!1},tex:{macros:w.math.macros}},Object.assign(window.MathJax,w.math.mathJaxOptions)),(0,k.U)("".concat(w.cdn,"/dist/js/mathjax/tex-svg-full.js"),"protyleMathJaxScript");var M=function(v,D){var N=(0,f.p)(v.textContent).trim(),z=window.MathJax.getMetricsFor(v);z.display=v.tagName==="DIV",window.MathJax.tex2svgPromise(N,z).then(function(H){v.innerHTML="",v.setAttribute("data-math",N),v.append(H),window.MathJax.startup.document.clear(),window.MathJax.startup.document.updateDocument();var Y=H.querySelector('[data-mml-node="merror"]');Y&&Y.textContent.trim()!==""&&(v.innerHTML=Y.textContent.trim(),v.className="vditor-reset--error"),D&&D()})};window.MathJax.startup.promise.then(function(){for(var v=[],D=function(z){var H=C[z];!H.parentElement.classList.contains("vditor-wysiwyg__pre")&&!H.parentElement.classList.contains("vditor-ir__marker--pre")&&!H.getAttribute("data-math")&&(0,f.p)(H.textContent).trim()&&v.push(function(Y){z===C.length-1?M(H):M(H,Y)})},N=0;N<C.length;N++)D(N);T(v)})}}}},0:(m,u,g)=>{g.d(u,{l:()=>b});var x=g(933),k=function(y,E){y.insertAdjacentHTML("afterend",'<video controls="controls" src="'.concat(E,'"></video>')),y.remove()},h=function(y,E){y.insertAdjacentHTML("afterend",'<audio controls="controls" src="'.concat(E,'"></audio>')),y.remove()},f=function(y,E){var w=E.match(/\/\/(?:www\.)?(?:youtu\.be\/|youtube\.com\/(?:embed\/|v\/|watch\?v=|watch\?.+&v=))([\w|-]{11})(?:(?:[\?&]t=)(\S+))?/),C=E.match(/\/\/v\.youku\.com\/v_show\/id_(\w+)=*\.html/),_=E.match(/\/\/v\.qq\.com\/x\/cover\/.*\/([^\/]+)\.html\??.*/),T=E.match(/(?:www\.|\/\/)coub\.com\/view\/(\w+)/),M=E.match(/(?:www\.|\/\/)facebook\.com\/([^\/]+)\/videos\/([0-9]+)/),v=E.match(/.+dailymotion.com\/(video|hub)\/(\w+)\?/),D=E.match(/(?:www\.|\/\/)bilibili\.com\/video\/(\w+)/),N=E.match(/(?:www\.|\/\/)ted\.com\/talks\/(\w+)/);if(w&&w[1].length===11)y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//www.youtube.com/embed/'.concat(w[1]+(w[2]?"?start="+w[2]:""),'"></iframe>')),y.remove();else if(C&&C[1])y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//player.youku.com/embed/'.concat(C[1],'"></iframe>')),y.remove();else if(_&&_[1])y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="https://v.qq.com/txp/iframe/player.html?vid='.concat(_[1],'"></iframe>')),y.remove();else if(T&&T[1])y.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="//coub.com/embed/`.concat(T[1],'?muted=false&autostart=false&originalSize=true&startWithHD=true"></iframe>')),y.remove();else if(M&&M[0])y.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.facebook.com/plugins/video.php?href=`.concat(encodeURIComponent(M[0]),'"></iframe>')),y.remove();else if(v&&v[2])y.insertAdjacentHTML("afterend",`<iframe class="iframe__video"
 src="https://www.dailymotion.com/embed/video/`.concat(v[2],'"></iframe>')),y.remove();else if(E.indexOf("bilibili.com")>-1&&(E.indexOf("bvid=")>-1||D&&D[1])){var z={bvid:(0,x.TK)("bvid",E)||D&&D[1],page:"1",high_quality:"1",as_wide:"1",allowfullscreen:"true",autoplay:"0"};new URL(E.startsWith("http")?E:"https:"+E).search.split("&").forEach(function(U,j){if(U){j===0&&(U=U.substr(1));var X=U.split("=");z[X[0]]=X[1]}});var H="https://player.bilibili.com/player.html?",Y=Object.keys(z);Y.forEach(function(U,j){H+="".concat(U,"=").concat(z[U]),j<Y.length-1&&(H+="&")}),y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="'.concat(H,'"></iframe>')),y.remove()}else N&&N[1]&&(y.insertAdjacentHTML("afterend",'<iframe class="iframe__video" src="//embed.ted.com/talks/'.concat(N[1],'"></iframe>')),y.remove())},b=function(y){y&&y.querySelectorAll("a").forEach(function(E){var w=E.getAttribute("href");w&&(w.match(/^.+.(mp4|m4v|ogg|ogv|webm)$/)?k(E,w):w.match(/^.+.(mp3|wav|flac)$/)?h(E,w):f(E,w))})}},975:(m,u,g)=>{g.d(u,{e:()=>E});var x=g(913),k=g(161),h=g(59),f=g(933),b=function(w,C,_,T){function M(v){return v instanceof _?v:new _(function(D){D(v)})}return new(_||(_=Promise))(function(v,D){function N(Y){try{H(T.next(Y))}catch(U){D(U)}}function z(Y){try{H(T.throw(Y))}catch(U){D(U)}}function H(Y){Y.done?v(Y.value):M(Y.value).then(N,z)}H((T=T.apply(w,C||[])).next())})},y=function(w,C){var _={label:0,sent:function(){if(v[0]&1)throw v[1];return v[1]},trys:[],ops:[]},T,M,v,D;return D={next:N(0),throw:N(1),return:N(2)},typeof Symbol=="function"&&(D[Symbol.iterator]=function(){return this}),D;function N(H){return function(Y){return z([H,Y])}}function z(H){if(T)throw new TypeError("Generator is already executing.");for(;D&&(D=0,H[0]&&(_=0)),_;)try{if(T=1,M&&(v=H[0]&2?M.return:H[0]?M.throw||((v=M.return)&&v.call(M),0):M.next)&&!(v=v.call(M,H[1])).done)return v;switch(M=0,v&&(H=[H[0]&2,v.value]),H[0]){case 0:case 1:v=H;break;case 4:return _.label++,{value:H[1],done:!1};case 5:_.label++,M=H[1],H=[0];continue;case 7:H=_.ops.pop(),_.trys.pop();continue;default:if(v=_.trys,!(v=v.length>0&&v[v.length-1])&&(H[0]===6||H[0]===2)){_=0;continue}if(H[0]===3&&(!v||H[1]>v[0]&&H[1]<v[3])){_.label=H[1];break}if(H[0]===6&&_.label<v[1]){_.label=v[1],v=H;break}if(v&&_.label<v[2]){_.label=v[2],_.ops.push(H);break}v[2]&&_.ops.pop(),_.trys.pop();continue}H=C.call(w,_)}catch(Y){H=[6,Y],M=0}finally{T=v=0}if(H[0]&5)throw H[1];return{value:H[0]?H[1]:void 0,done:!0}}},E=function(w,C,_){w===void 0&&(w=document),C===void 0&&(C=x.Y.CDN);var T=h.mermaidRenderAdapter.getElements(w);T.length!==0&&(0,k.Z)("".concat(C,"/dist/js/mermaid/mermaid.min.js"),"vditorMermaidScript").then(function(){var M={securityLevel:"loose",altFontFamily:"sans-serif",fontFamily:"sans-serif",startOnLoad:!1,flowchart:{htmlLabels:!0,useMaxWidth:!0},sequence:{useMaxWidth:!0,diagramMarginX:8,diagramMarginY:8,boxMargin:8,showSequenceNumbers:!0},gantt:{leftPadding:75,rightPadding:20}};_==="dark"&&(M.theme="dark"),mermaid.initialize(M),T.forEach(function(v){return b(void 0,void 0,void 0,function(){var D,N,z,H,Y;return y(this,function(U){switch(U.label){case 0:if(D=h.mermaidRenderAdapter.getCode(v),v.getAttribute("data-processed")==="true"||D.trim()==="")return[2];N="mermaid"+(0,f.Ee)(),U.label=1;case 1:return U.trys.push([1,3,,4]),[4,mermaid.render(N,v.textContent)];case 2:return z=U.sent(),v.innerHTML=z.svg,[3,4];case 3:return H=U.sent(),Y=document.querySelector("#"+N),v.innerHTML="".concat(Y.outerHTML,`<br>
<div style="text-align: left"><small>`).concat(H.message.replace(/\n/,"<br>"),"</small></div>"),Y.parentElement.remove(),[3,4];case 4:return v.setAttribute("data-processed","true"),[2]}})})})})}},162:(m,u,g)=>{g.d(u,{l:()=>f});var x=g(913),k=g(161),h=g(59),f=function(b,y,E){b===void 0&&(b=document),y===void 0&&(y=x.Y.CDN);var w=h.mindmapRenderAdapter.getElements(b);w.length>0&&(0,k.Z)("".concat(y,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){w.forEach(function(C){if(!(C.parentElement.classList.contains("vditor-wysiwyg__pre")||C.parentElement.classList.contains("vditor-ir__marker--pre"))){var _=h.mindmapRenderAdapter.getCode(C);if(_)try{if(C.getAttribute("data-processed")==="true")return;echarts.init(C,E==="dark"?"dark":void 0).setOption({series:[{data:[JSON.parse(decodeURIComponent(_))],initialTreeDepth:-1,itemStyle:{borderWidth:0,color:"#4285f4"},label:{backgroundColor:"#f6f8fa",borderColor:"#d1d5da",borderRadius:5,borderWidth:.5,color:"#586069",lineHeight:20,offset:[-5,0],padding:[0,5],position:"insideRight"},lineStyle:{color:"#d1d5da",width:1},roam:!0,symbol:function(T,M){var v;return!((v=M==null?void 0:M.data)===null||v===void 0)&&v.children?"circle":"path://"},type:"tree"}],tooltip:{trigger:"item",triggerOn:"mousemove"}}),C.setAttribute("data-processed","true")}catch(T){C.className="vditor-reset--error",C.innerHTML="mindmap render error: <br>".concat(T)}}})})}},70:(m,u,g)=>{g.d(u,{N:()=>h});var x=g(164),k=g(960),h=function(f,b,y){var E="",w=[];if(Array.from(f.children).forEach(function(M,v){if((0,x.c)(M)){if(y){var D=M.id.lastIndexOf("_");M.id=M.id.substring(0,D===-1?void 0:D)+"_"+v}w.push(M.id),E+=M.outerHTML.replace("<wbr>","")}}),E==="")return b.innerHTML="","";var C=document.createElement("div");if(y)y.lute.SetToC(!0),y.currentMode==="wysiwyg"&&!y.preview.element.contains(f)?C.innerHTML=y.lute.SpinVditorDOM("<p>[ToC]</p>"+E):y.currentMode==="ir"&&!y.preview.element.contains(f)?C.innerHTML=y.lute.SpinVditorIRDOM("<p>[ToC]</p>"+E):C.innerHTML=y.lute.HTML2VditorDOM("<p>[ToC]</p>"+E),y.lute.SetToC(y.options.preview.markdown.toc);else{b.classList.add("vditor-outline");var _=Lute.New();_.SetToC(!0),C.innerHTML=_.HTML2VditorDOM("<p>[ToC]</p>"+E)}var T=C.firstElementChild.querySelectorAll("li > span[data-target-id]");return T.forEach(function(M,v){if(M.nextElementSibling&&M.nextElementSibling.tagName==="UL"){var D="<svg class='vditor-outline__action'><use xlink:href='#vditor-icon-down'></use></svg>";document.getElementById("vditorIconScript")||(D='<svg class="vditor-outline__action" viewBox="0 0 32 32"><path d="M3.76 6.12l12.24 12.213 12.24-12.213 3.76 3.76-16 16-16-16 3.76-3.76z"></path></svg>'),M.innerHTML="".concat(D,"<span>").concat(M.innerHTML,"</span>")}else M.innerHTML="<svg></svg><span>".concat(M.innerHTML,"</span>");M.setAttribute("data-target-id",w[v])}),E=C.firstElementChild.innerHTML,T.length===0?(b.innerHTML="",E):(b.innerHTML=E,y&&(0,k.T)(b,{cdn:y.options.cdn,math:y.options.preview.math}),b.firstElementChild.addEventListener("click",function(M){for(var v=M.target;v&&!v.isEqualNode(b);){if(v.classList.contains("vditor-outline__action")){v.classList.contains("vditor-outline__action--close")?(v.classList.remove("vditor-outline__action--close"),v.parentElement.nextElementSibling.setAttribute("style","display:block")):(v.classList.add("vditor-outline__action--close"),v.parentElement.nextElementSibling.setAttribute("style","display:none")),M.preventDefault(),M.stopPropagation();break}else if(v.getAttribute("data-target-id")){M.preventDefault(),M.stopPropagation();var D=document.getElementById(v.getAttribute("data-target-id"));if(!D)return;if(y)if(y.options.height==="auto"){var N=D.offsetTop+y.element.offsetTop;y.options.toolbarConfig.pin||(N+=y.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,N)}else y.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,y.element.offsetTop),y.preview.element.contains(f)?f.parentElement.scrollTop=D.offsetTop:f.scrollTop=D.offsetTop;else window.scrollTo(window.scrollX,D.offsetTop);break}v=v.parentElement}}),E)}},591:(m,u,g)=>{g.d(u,{M:()=>f});var x=g(913),k=g(161),h=g(59),f=function(b,y){b===void 0&&(b=document),y===void 0&&(y=x.Y.CDN);var E=h.plantumlRenderAdapter.getElements(b);E.length!==0&&(0,k.Z)("".concat(y,"/dist/js/plantuml/plantuml-encoder.min.js"),"vditorPlantumlScript").then(function(){E.forEach(function(w){if(!(w.parentElement.classList.contains("vditor-wysiwyg__pre")||w.parentElement.classList.contains("vditor-ir__marker--pre"))){var C=h.plantumlRenderAdapter.getCode(w).trim();if(C)try{w.innerHTML='<object type="image/svg+xml" data="https://www.plantuml.com/plantuml/svg/~1'.concat(plantumlEncoder.encode(C),'"/>')}catch(_){w.className="vditor-reset--error",w.innerHTML="plantuml render error: <br>".concat(_)}}})})}},796:(m,u,g)=>{g.d(u,{X:()=>x});var x=function(k){var h=Lute.New();return h.PutEmojis(k.emojis),h.SetEmojiSite(k.emojiSite),h.SetHeadingAnchor(k.headingAnchor),h.SetInlineMathAllowDigitAfterOpenMarker(k.inlineMathDigit),h.SetAutoSpace(k.autoSpace),h.SetToC(k.toc),h.SetFootnotes(k.footnotes),h.SetFixTermTypo(k.fixTermTypo),h.SetVditorCodeBlockPreview(k.codeBlockPreview),h.SetVditorMathBlockPreview(k.mathBlockPreview),h.SetSanitize(k.sanitize),h.SetChineseParagraphBeginningSpace(k.paragraphBeginningSpace),h.SetRenderListStyle(k.listStyle),h.SetLinkBase(k.linkBase),h.SetLinkPrefix(k.linkPrefix),h.SetMark(k.mark),h.SetGFMAutoLink(k.gfmAutoLink),k.lazyLoadImage&&h.SetImageLazyLoading(k.lazyLoadImage),h}},726:(m,u,g)=>{g.d(u,{o:()=>x});var x=function(k,h,f){f===void 0&&(f="classic");var b=k.getBoundingClientRect(),y=36;document.body.insertAdjacentHTML("beforeend",'<div class="vditor vditor-img'.concat(f==="dark"?" vditor--dark":"",`">
    <div class="vditor-img__bar">
      <span class="vditor-img__btn" data-deg="0">
        <svg><use xlink:href="#vditor-icon-redo"></use></svg>
        `).concat(window.VditorI18n.spin,`
      </span>
      <span class="vditor-img__btn"  onclick="this.parentElement.parentElement.outerHTML = '';document.body.style.overflow = ''">
        X &nbsp;`).concat(window.VditorI18n.close,`
      </span>
    </div>
    <div class="vditor-img__img" onclick="this.parentElement.outerHTML = '';document.body.style.overflow = ''">
      <img style="width: `).concat(k.width,"px;height:").concat(k.height,"px;transform: translate3d(").concat(b.left,"px, ").concat(b.top-y,'px, 0)" src="').concat(k.getAttribute("src"),`">
    </div>
</div>`)),document.body.style.overflow="hidden";var E=document.querySelector(".vditor-img img"),w="translate3d(".concat(Math.max(0,window.innerWidth-k.naturalWidth)/2,"px, ").concat(Math.max(0,window.innerHeight-y-k.naturalHeight)/2,"px, 0)");setTimeout(function(){E.setAttribute("style","transition: transform .3s ease-in-out;transform: ".concat(w)),setTimeout(function(){E.parentElement.scrollTo((E.parentElement.scrollWidth-E.parentElement.clientWidth)/2,(E.parentElement.scrollHeight-E.parentElement.clientHeight)/2)},400)});var C=document.querySelector(".vditor-img__btn");C.addEventListener("click",function(){var _=parseInt(C.getAttribute("data-deg"),10)+90;_/90%2===1&&k.naturalWidth>E.parentElement.clientHeight?E.style.transform="translate3d(".concat(Math.max(0,window.innerWidth-k.naturalWidth)/2,"px, ").concat(k.naturalWidth/2-k.naturalHeight/2,"px, 0) rotateZ(").concat(_,"deg)"):E.style.transform="".concat(w," rotateZ(").concat(_,"deg)"),C.setAttribute("data-deg",_.toString()),setTimeout(function(){E.parentElement.scrollTo((E.parentElement.scrollWidth-E.parentElement.clientWidth)/2,(E.parentElement.scrollHeight-E.parentElement.clientHeight)/2)},400)})}},13:(m,u,g)=>{g.d(u,{h:()=>h});var x=g(913),k=g(505),h=function(f,b){b===void 0&&(b=x.Y.CDN),x.Y.CODE_THEME.includes(f)||(f="github");var y=document.getElementById("vditorHljsStyle"),E="".concat(b,"/dist/js/highlight.js/styles/").concat(f,".min.css");y?y.getAttribute("href")!==E&&(y.remove(),(0,k.T)(E,"vditorHljsStyle")):(0,k.T)(E,"vditorHljsStyle")}},873:(m,u,g)=>{g.d(u,{H:()=>k});var x=g(505),k=function(h,f){if(!(!h||!f)){var b=document.getElementById("vditorContentTheme"),y="".concat(f,"/").concat(h,".css");b?b.getAttribute("href")!==y&&(b.remove(),(0,x.T)(y,"vditorContentTheme")):(0,x.T)(y,"vditorContentTheme")}}},161:(m,u,g)=>{g.d(u,{U:()=>x,Z:()=>k});var x=function(h,f){if(document.getElementById(f))return!1;var b=new XMLHttpRequest;b.open("GET",h,!1),b.setRequestHeader("Accept","text/javascript, application/javascript, application/ecmascript, application/x-ecmascript, */*; q=0.01"),b.send("");var y=document.createElement("script");y.type="text/javascript",y.text=b.responseText,y.id=f,document.head.appendChild(y)},k=function(h,f){return new Promise(function(b,y){if(document.getElementById(f))return b(!0),!1;var E=document.createElement("script");E.src=h,E.async=!0,document.head.appendChild(E),E.onerror=function(w){y(w)},E.onload=function(){if(document.getElementById(f))return E.remove(),b(!0),!1;E.id=f,b(!0)}})}},505:(m,u,g)=>{g.d(u,{T:()=>x});var x=function(k,h){if(!document.getElementById(h)){var f=document.createElement("link");f.id=h,f.rel="stylesheet",f.type="text/css",f.href=k,document.getElementsByTagName("head")[0].appendChild(f)}}},695:(m,u,g)=>{g.d(u,{p:()=>x});var x=function(k){return k.replace(/\u00a0/g," ")}},629:(m,u,g)=>{g.d(u,{D:()=>h,H8:()=>E,_0:()=>b,fG:()=>y,gm:()=>k,nr:()=>x,y3:()=>f});var x=function(){return navigator.userAgent.indexOf("Safari")>-1&&navigator.userAgent.indexOf("Chrome")===-1},k=function(){return navigator.userAgent.toLowerCase().indexOf("firefox")>-1},h=function(){try{return typeof localStorage<"u"}catch{return!1}},f=function(){return navigator.userAgent.indexOf("iPhone")>-1?"touchstart":"click"},b=function(w){return navigator.platform.toUpperCase().indexOf("MAC")>=0?!!(w.metaKey&&!w.ctrlKey):!!(!w.metaKey&&w.ctrlKey)},y=function(w){return/Mac/.test(navigator.platform)||navigator.platform==="iPhone"?w.indexOf("⇧")>-1&&k()&&(w=w.replace(";",":").replace("=","+").replace("-","_")):(w.startsWith("⌘")?w=w.replace("⌘","⌘+"):w.startsWith("⌥")&&w.substr(1,1)!=="⌘"?w=w.replace("⌥","⌥+"):w=w.replace("⇧⌘","⌘+⇧+").replace("⌥⌘","⌥+⌘+"),w=w.replace("⌘","Ctrl").replace("⇧","Shift").replace("⌥","Alt"),w.indexOf("Shift")>-1&&(w=w.replace(";",":").replace("=","+").replace("-","_"))),w},E=function(){return/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor)}},933:(m,u,g)=>{g.d(u,{Ee:()=>x,TK:()=>k,kY:()=>h});var x=function(){return([1e7].toString()+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,function(f){return(parseInt(f,10)^window.crypto.getRandomValues(new Uint32Array(1))[0]&15>>parseInt(f,10)/4).toString(16)})},k=function(f,b){b===void 0&&(b=window.location.search);var y=b.substring(b.indexOf("?")),E=y.indexOf("#"),w=new URLSearchParams(y.substring(0,E>=0?E:void 0));return w.get(f)},h=function(f){return Function('"use strict";return ('.concat(f,")"))()}},598:(m,u,g)=>{g.d(u,{Ab:()=>h,KJ:()=>w,KR:()=>f,Rp:()=>C,Th:()=>b,XW:()=>k,_Y:()=>E,pt:()=>y});var x=g(164),k=function(_,T){for(var M=w(_,T),v=!1,D=!1;M&&!M.classList.contains("vditor-reset")&&!D;)v=w(M.parentElement,T),v?M=v:D=!0;return M||!1},h=function(_,T){for(var M=(0,x.f)(_,T),v=!1,D=!1;M&&!M.classList.contains("vditor-reset")&&!D;)v=(0,x.f)(M.parentElement,T),v?M=v:D=!0;return M||!1},f=function(_){var T=h(_,"UL"),M=h(_,"OL"),v=T;return M&&(!T||T&&M.contains(T))&&(v=M),v},b=function(_,T,M){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var v=_,D=!1;v&&!D&&!v.classList.contains("vditor-reset");)v.getAttribute(T)===M?D=!0:v=v.parentElement;return D&&v},y=function(_){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);var T=_,M=!1,v=b(_,"data-block","0");if(v)return v;for(;T&&!M&&!T.classList.contains("vditor-reset");)T.tagName==="H1"||T.tagName==="H2"||T.tagName==="H3"||T.tagName==="H4"||T.tagName==="H5"||T.tagName==="H6"||T.tagName==="P"||T.tagName==="BLOCKQUOTE"||T.tagName==="OL"||T.tagName==="UL"?M=!0:T=T.parentElement;return M&&T},E=function(_,T){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var M=_,v=!1;M&&!v&&!M.classList.contains("vditor-reset");)M.nodeName===T?v=!0:M=M.parentElement;return v&&M},w=function(_,T){if(!_)return!1;_.nodeType===3&&(_=_.parentElement);for(var M=_,v=!1;M&&!v&&!M.classList.contains("vditor-reset");)M.classList.contains(T)?v=!0:M=M.parentElement;return v&&M},C=function(_){for(;_&&_.lastChild;)_=_.lastChild;return _}},164:(m,u,g)=>{g.d(u,{c:()=>k,f:()=>x});var x=function(h,f){if(!h)return!1;h.nodeType===3&&(h=h.parentElement);for(var b=h,y=!1;b&&!y&&!b.classList.contains("vditor-reset");)b.nodeName.indexOf(f)===0?y=!0:b=b.parentElement;return y&&b},k=function(h){var f=x(h,"H");return f&&f.tagName.length===2&&f.tagName!=="HR"?f:!1}},905:(m,u,g)=>{g.d(u,{h:()=>x});var x=function(){for(var k=[],h=0;h<arguments.length;h++)k[h]=arguments[h];for(var f={},b=function(E){for(var w in E)E.hasOwnProperty(w)&&(Object.prototype.toString.call(E[w])==="[object Object]"?f[w]=x(f[w],E[w]):f[w]=E[w])},y=0;y<k.length;y++)b(k[y]);return f}},827:(m,u,g)=>{g.d(u,{Co:()=>y,ED:()=>w,Ey:()=>b,Fm:()=>C,RN:()=>f,Z2:()=>T,ir:()=>_,jl:()=>E});var x=g(913),k=g(629),h=g(598),f=function(M){var v,D=M[M.currentMode].element;return getSelection().rangeCount>0&&(v=getSelection().getRangeAt(0),D.isEqualNode(v.startContainer)||D.contains(v.startContainer))?v:M[M.currentMode].range?M[M.currentMode].range:(D.focus(),v=D.ownerDocument.createRange(),v.setStart(D,0),v.collapse(!0),v)},b=function(M){var v=window.getSelection().getRangeAt(0);if(!M.contains(v.startContainer)&&!(0,h.KJ)(v.startContainer,"vditor-panel--none"))return{left:0,top:0};var D=M.parentElement.getBoundingClientRect(),N;if(v.getClientRects().length===0)if(v.startContainer.nodeType===3){var z=v.startContainer.parentElement;if(z&&z.getClientRects().length>0)N=z.getClientRects()[0];else return{left:0,top:0}}else{var H=v.startContainer.children;if(H[v.startOffset]&&H[v.startOffset].getClientRects().length>0)N=H[v.startOffset].getClientRects()[0];else if(v.startContainer.childNodes.length>0){var Y=v.cloneRange();v.selectNode(v.startContainer.childNodes[Math.max(0,v.startOffset-1)]),N=v.getClientRects()[0],v.setEnd(Y.endContainer,Y.endOffset),v.setStart(Y.startContainer,Y.startOffset)}else N=v.startContainer.getClientRects()[0];if(!N){for(var U=v.startContainer.childNodes[v.startOffset];!U.getClientRects||U.getClientRects&&U.getClientRects().length===0;)U=U.parentElement;N=U.getClientRects()[0]}}else N=v.getClientRects()[0];return{left:N.left-D.left,top:N.top-D.top}},y=function(M,v){if(!v){if(getSelection().rangeCount===0)return!1;v=getSelection().getRangeAt(0)}var D=v.commonAncestorContainer;return M.isEqualNode(D)||M.contains(D)},E=function(M){var v=window.getSelection();v.removeAllRanges(),v.addRange(M)},w=function(M,v,D){var N={end:0,start:0};if(!D){if(getSelection().rangeCount===0)return N;D=window.getSelection().getRangeAt(0)}if(y(v,D)){var z=D.cloneRange();M.childNodes[0]&&M.childNodes[0].childNodes[0]?z.setStart(M.childNodes[0].childNodes[0],0):z.selectNodeContents(M),z.setEnd(D.startContainer,D.startOffset),N.start=z.toString().length,N.end=N.start+D.toString().length}return N},C=function(M,v,D){var N=0,z=0,H=D.childNodes[z],Y=!1,U=!1;M=Math.max(0,M),v=Math.max(0,v);var j=D.ownerDocument.createRange();for(j.setStart(H||D,0),j.collapse(!0);!U&&H;){var X=N+H.textContent.length;if(!Y&&M>=N&&M<=X&&(M===0?j.setStart(H,0):H.childNodes[0].nodeType===3?j.setStart(H.childNodes[0],M-N):H.nextSibling?j.setStartBefore(H.nextSibling):j.setStartAfter(H),Y=!0,M===v)){U=!0;break}Y&&v>=N&&v<=X&&(v===0?j.setEnd(H,0):H.childNodes[0].nodeType===3?j.setEnd(H.childNodes[0],v-N):H.nextSibling?j.setEndBefore(H.nextSibling):j.setEndAfter(H),U=!0),N=X,H=D.childNodes[++z]}return!U&&D.childNodes[z-1]&&j.setStartBefore(D.childNodes[z-1]),E(j),j},_=function(M,v){var D=M.querySelector("wbr");if(D){if(!D.previousElementSibling)D.previousSibling?v.setStart(D.previousSibling,D.previousSibling.textContent.length):D.nextSibling?D.nextSibling.nodeType===3?v.setStart(D.nextSibling,0):v.setStartBefore(D.nextSibling):v.setStart(D.parentElement,0);else if(D.previousElementSibling.isSameNode(D.previousSibling))if(D.previousElementSibling.lastChild){v.setStartBefore(D),v.collapse(!0),E(v),(0,k.H8)()&&(D.previousElementSibling.tagName==="EM"||D.previousElementSibling.tagName==="STRONG"||D.previousElementSibling.tagName==="S")&&(v.insertNode(document.createTextNode(x.Y.ZWSP)),v.collapse(!1)),D.remove();return}else v.setStartAfter(D.previousElementSibling);else v.setStart(D.previousSibling,D.previousSibling.textContent.length);v.collapse(!0),D.remove(),E(v)}},T=function(M,v){var D=document.createElement("div");D.innerHTML=M;var N=D.querySelectorAll("p");N.length===1&&!N[0].previousSibling&&!N[0].nextSibling&&v[v.currentMode].element.children.length>0&&D.firstElementChild.tagName==="P"&&(M=N[0].innerHTML.trim());var z=document.createElement("div");z.innerHTML=M;var H=f(v);if(H.toString()!==""&&(v[v.currentMode].preventInput=!0,document.execCommand("delete",!1,"")),z.firstElementChild&&z.firstElementChild.getAttribute("data-block")==="0"){z.lastElementChild.insertAdjacentHTML("beforeend","<wbr>");var Y=(0,h.pt)(H.startContainer);Y?Y.insertAdjacentHTML("afterend",z.innerHTML):v[v.currentMode].element.insertAdjacentHTML("beforeend",z.innerHTML),_(v[v.currentMode].element,H)}else{var U=document.createElement("template");U.innerHTML=M,H.insertNode(U.content.cloneNode(!0)),H.collapse(!1),E(H)}}}},s={};function l(m){var u=s[m];if(u!==void 0)return u.exports;var g=s[m]={exports:{}};return r[m](g,g.exports,l),g.exports}l.d=(m,u)=>{for(var g in u)l.o(u,g)&&!l.o(m,g)&&Object.defineProperty(m,g,{enumerable:!0,get:u[g]})},l.o=(m,u)=>Object.prototype.hasOwnProperty.call(m,u),l.r=m=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(m,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(m,"__esModule",{value:!0})};var d={};return(()=>{l.d(d,{default:()=>sc});var m=l(923),u=l(913),g=l(695),x=function(t){return t.currentMode==="sv"?(0,g.p)("".concat(t.sv.element.textContent,`
`).replace(/\n\n$/,`
`)):t.currentMode==="wysiwyg"?t.lute.VditorDOM2Md(t.wysiwyg.element.innerHTML):t.currentMode==="ir"?t.lute.VditorIRDOM2Md(t.ir.element.innerHTML):""},k=l(161),h=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-devtools",this.element.innerHTML='<div class="vditor-reset--error"></div><div style="height: 100%;"></div>'}return t.prototype.renderEchart=function(n){var i=this;n.devtools.element.style.display==="block"&&(0,k.Z)("".concat(n.options.cdn,"/dist/js/echarts/echarts.min.js?v=5.5.1"),"vditorEchartsScript").then(function(){i.ASTChart||(i.ASTChart=echarts.init(n.devtools.element.lastElementChild));try{i.element.lastElementChild.style.display="block",i.element.firstElementChild.innerHTML="",i.ASTChart.setOption({series:[{data:JSON.parse(n.lute.RenderEChartsJSON(x(n))),initialTreeDepth:-1,label:{align:"left",backgroundColor:"rgba(68, 77, 86, .68)",borderRadius:3,color:"#d1d5da",fontSize:12,lineHeight:12,offset:[9,12],padding:[2,4,2,4],position:"top",verticalAlign:"middle"},lineStyle:{color:"#4285f4",type:"curve",width:1},orient:"vertical",roam:!0,type:"tree"}],toolbox:{bottom:25,emphasis:{iconStyle:{color:"#4285f4"}},feature:{restore:{show:!0},saveAsImage:{show:!0}},right:15,show:!0}}),i.ASTChart.resize()}catch(a){i.element.lastElementChild.style.display="none",i.element.firstElementChild.innerHTML=a}})},t}(),f=l(629),b=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&a.classList.contains("vditor-menu--current")&&a.classList.remove("vditor-menu--current")}})},y=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&!a.classList.contains("vditor-menu--current")&&a.classList.add("vditor-menu--current")}})},E=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&a.classList.contains(u.Y.CLASS_MENU_DISABLED)&&a.classList.remove(u.Y.CLASS_MENU_DISABLED)}})},w=function(t,n){n.forEach(function(i){if(t[i]){var a=t[i].children[0];a&&!a.classList.contains(u.Y.CLASS_MENU_DISABLED)&&a.classList.add(u.Y.CLASS_MENU_DISABLED)}})},C=function(t,n){n.forEach(function(i){t[i]&&t[i]&&(t[i].style.display="none")})},_=function(t,n){n.forEach(function(i){t[i]&&t[i]&&(t[i].style.display="block")})},T=function(t,n,i){n.includes("subToolbar")&&(t.toolbar.element.querySelectorAll(".vditor-hint").forEach(function(a){i&&a.isEqualNode(i)||(a.style.display="none")}),t.toolbar.elements.emoji&&(t.toolbar.elements.emoji.lastElementChild.style.display="none")),n.includes("hint")&&(t.hint.element.style.display="none"),t.wysiwyg.popover&&n.includes("popover")&&(t.wysiwyg.popover.style.display="none")},M=function(t,n,i,a){i.addEventListener((0,f.y3)(),function(o){o.preventDefault(),o.stopPropagation(),!i.classList.contains(u.Y.CLASS_MENU_DISABLED)&&(t.toolbar.element.querySelectorAll(".vditor-hint--current").forEach(function(c){c.classList.remove("vditor-hint--current")}),n.style.display==="block"?n.style.display="none":(T(t,["subToolbar","hint","popover"],i.parentElement.parentElement),i.classList.contains("vditor-tooltipped")||i.classList.add("vditor-hint--current"),n.style.display="block",t.toolbar.element.getBoundingClientRect().right-i.getBoundingClientRect().right<250?n.classList.add("vditor-panel--left"):n.classList.remove("vditor-panel--left")))})},v=l(598),D=l(164),N=function(t,n,i,a){a&&console.log("".concat(t," - ").concat(i,": ").concat(n))},z=l(288),H=l(784),Y=l(51),U=l(500),j=l(339),X=l(108),he=l(960),Se=l(975),Ue=l(597),Le=l(162),Pe=l(591),Ie=l(931),et=function(t,n,i){i===void 0&&(i="sv");var a=document.createElement("div");a.innerHTML=t;var o=!1;a.childElementCount===1&&a.lastElementChild.style.fontFamily.indexOf("monospace")>-1&&(o=!0);var c=a.querySelectorAll("pre");if(a.childElementCount===1&&c.length===1&&c[0].className!=="vditor-wysiwyg"&&c[0].className!=="vditor-sv"&&(o=!0),t.indexOf(`
<p class="p1">`)===0&&(o=!0),a.childElementCount===1&&a.firstElementChild.tagName==="TABLE"&&a.querySelector(".line-number")&&a.querySelector(".line-content")&&(o=!0),o){var S=n||t;return/\n/.test(S)||c.length===1?i==="wysiwyg"?'<div class="vditor-wysiwyg__block" data-block="0" data-type="code-block"><pre><code>'.concat(S.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"<wbr></code></pre></div>"):"\n```\n"+S.replace(/&/g,"&amp;").replace(/</g,"&lt;")+"\n```":i==="wysiwyg"?"<code>".concat(S.replace(/&/g,"&amp;").replace(/</g,"&lt;"),"</code><wbr>"):"`".concat(S,"`")}return!1},rt=function(t,n){if(t){if(t.parentElement.getAttribute("data-type")==="html-block"){t.setAttribute("data-render","1");return}var i=t.firstElementChild.className.replace("language-","");if(i==="abc")(0,z.$)(t,n.options.cdn);else if(i==="mermaid")(0,Se.e)(t,n.options.cdn,n.options.theme);else if(i==="smiles")(0,Ie.Y)(t,n.options.cdn,n.options.theme);else if(i==="markmap")(0,Ue.K)(t,n.options.cdn);else if(i==="flowchart")(0,U.D)(t,n.options.cdn);else if(i==="echarts")(0,H.v)(t,n.options.cdn,n.options.theme);else if(i==="mindmap")(0,Le.l)(t,n.options.cdn,n.options.theme);else if(i==="plantuml")(0,Pe.M)(t,n.options.cdn);else if(i==="graphviz")(0,j.m)(t,n.options.cdn);else if(i==="math")(0,he.T)(t,{cdn:n.options.cdn,math:n.options.preview.math});else{var a=n.options.customRenders.find(function(o){if(o.language===i)return o.render(t,n),!0});a||((0,X.$)(Object.assign({},n.options.preview.hljs),t,n.options.cdn),(0,Y.o)(t,n.options.preview.hljs))}t.setAttribute("data-render","1")}},B=l(827),le=function(t){if(t.currentMode!=="sv"){var n=t[t.currentMode].element,i=t.outline.render(t);i===""&&(i="[ToC]"),n.querySelectorAll('[data-type="toc-block"]').forEach(function(a){a.innerHTML=i,(0,he.T)(a,{cdn:t.options.cdn,math:t.options.preview.math})})}},re=function(t,n){var i=(0,v._Y)(t.target,"SPAN");if(i&&(0,v.KJ)(i,"vditor-toc")){var a=n[n.currentMode].element.querySelector("#"+i.getAttribute("data-target-id"));if(a)if(n.options.height==="auto"){var o=a.offsetTop+n.element.offsetTop;n.options.toolbarConfig.pin||(o+=n.toolbar.element.offsetHeight),window.scrollTo(window.scrollX,o)}else n.element.offsetTop<window.scrollY&&window.scrollTo(window.scrollX,n.element.offsetTop),n[n.currentMode].element.scrollTop=a.offsetTop;return}},Re=function(t,n,i,a){if(t.previousElementSibling&&t.previousElementSibling.classList.contains("vditor-toc")){if(i.key==="Backspace"&&(0,B.ED)(t,n[n.currentMode].element,a).start===0)return t.previousElementSibling.remove(),st(n),!0;if(ri(n,i,a,t,t.previousElementSibling))return!0}if(t.nextElementSibling&&t.nextElementSibling.classList.contains("vditor-toc")){if(i.key==="Delete"&&(0,B.ED)(t,n[n.currentMode].element,a).start>=t.textContent.trimRight().length)return t.nextElementSibling.remove(),st(n),!0;if(Ei(n,i,a,t,t.nextElementSibling))return!0}if(i.key==="Backspace"||i.key==="Delete"){var o=(0,v.KJ)(a.startContainer,"vditor-toc");if(o)return o.remove(),st(n),!0}},Ge=function(t,n,i,a){i===void 0&&(i=!1);var o=(0,v.pt)(n.startContainer);if(o&&!i&&o.getAttribute("data-type")!=="code-block"){if(Yi(o.innerHTML)&&o.previousElementSibling||br(o.innerHTML))return;for(var c=(0,B.ED)(o,t.ir.element,n).start,S=!0,A=c-1;A>o.textContent.substr(0,c).lastIndexOf(`
`);A--)if(o.textContent.charAt(A)!==" "&&o.textContent.charAt(A)!=="	"){S=!1;break}c===0&&(S=!1);for(var O=!0,A=c-1;A<o.textContent.length;A++)if(o.textContent.charAt(A)!==" "&&o.textContent.charAt(A)!==`
`){O=!1;break}if(S){typeof t.options.input=="function"&&t.options.input(x(t));return}if(O&&/^#{1,6} $/.test(o.textContent)&&(O=!1),O){var L=(0,v.KJ)(n.startContainer,"vditor-ir__marker");if(!L){var $=n.startContainer.previousSibling;$&&$.nodeType!==3&&$.classList.contains("vditor-ir__node--expand")&&$.classList.remove("vditor-ir__node--expand"),typeof t.options.input=="function"&&t.options.input(x(t));return}}}if(t.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(lt){lt.classList.remove("vditor-ir__node--expand")}),o||(o=t.ir.element),!o.querySelector("wbr")){var K=(0,v.KJ)(n.startContainer,"vditor-ir__preview");K?K.previousElementSibling.insertAdjacentHTML("beforeend","<wbr>"):n.insertNode(document.createElement("wbr"))}o.querySelectorAll("[style]").forEach(function(lt){lt.removeAttribute("style")}),o.getAttribute("data-type")==="link-ref-defs-block"&&(o=t.ir.element);var ye=o.isEqualNode(t.ir.element),be=(0,v.Th)(o,"data-type","footnotes-block"),me="";if(ye)me=o.innerHTML;else{var $e=(0,D.f)(n.startContainer,"BLOCKQUOTE"),Te=(0,v.KR)(n.startContainer);if(Te&&(o=Te),$e&&(!Te||Te&&!$e.contains(Te))&&(o=$e),be&&(o=be),me=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var fe=o.previousElementSibling,Ke=o.nextElementSibling;fe&&(fe.tagName==="UL"||fe.tagName==="OL")&&(me=fe.outerHTML+me,fe.remove()),Ke&&(Ke.tagName==="UL"||Ke.tagName==="OL")&&(me=me+Ke.outerHTML,Ke.remove()),me=me.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}else o.previousElementSibling&&o.previousElementSibling.textContent.replace(u.Y.ZWSP,"")!==""&&a&&a.inputType==="insertParagraph"&&(me=o.previousElementSibling.outerHTML+me,o.previousElementSibling.remove());o.innerText.startsWith("```")||(t.ir.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(lt){lt&&!o.isEqualNode(lt)&&(me+=lt.outerHTML,lt.remove())}),t.ir.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(lt){lt&&!o.isEqualNode(lt)&&(me+=lt.outerHTML,lt.remove())}))}if(N("SpinVditorIRDOM",me,"argument",t.options.debugger),me=t.lute.SpinVditorIRDOM(me),N("SpinVditorIRDOM",me,"result",t.options.debugger),ye)o.innerHTML=me;else if(o.outerHTML=me,be){var He=(0,v.Th)(t.ir.element.querySelector("wbr"),"data-type","footnotes-def");if(He){var Xe=He.textContent,At=Xe.substring(1,Xe.indexOf("]:")),_t=t.ir.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(At,'"]'));_t&&_t.setAttribute("aria-label",Xe.substr(At.length+3).trim().substr(0,24))}}var Ot,pn=t.ir.element.querySelectorAll("[data-type='link-ref-defs-block']");pn.forEach(function(lt,qt){qt===0?Ot=lt:(Ot.insertAdjacentHTML("beforeend",lt.innerHTML),lt.remove())}),pn.length>0&&t.ir.element.insertAdjacentElement("beforeend",pn[0]);var nn,mn=t.ir.element.querySelectorAll("[data-type='footnotes-block']");mn.forEach(function(lt,qt){qt===0?nn=lt:(nn.insertAdjacentHTML("beforeend",lt.innerHTML),lt.remove())}),mn.length>0&&t.ir.element.insertAdjacentElement("beforeend",mn[0]),(0,B.ir)(t.ir.element,n),t.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(lt){rt(lt,t)}),le(t),un(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},Q=function(t,n){if(t==="")return!1;if(t.indexOf("⇧")===-1&&t.indexOf("⌘")===-1&&t.indexOf("⌥")===-1)return!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&n.code===t;if(t==="⇧Tab")return!!(!(0,f._0)(n)&&!n.altKey&&n.shiftKey&&n.code==="Tab");var i=t.split("");if(t.startsWith("⌥")){var a=i.length===3?i[2]:i[1];return!!((i.length===3?(0,f._0)(n):!(0,f._0)(n))&&n.altKey&&!n.shiftKey&&n.code===(/^[0-9]$/.test(a)?"Digit":"Key")+a)}t==="⌘Enter"&&(i=["⌘","Enter"]);var o=i.length>2&&i[0]==="⇧",c=o?i[2]:i[1];return o&&((0,f.gm)()||!/Mac/.test(navigator.platform))&&(c==="-"?c="_":c==="="&&(c="+")),!!((0,f._0)(n)&&n.key.toLowerCase()===c.toLowerCase()&&!n.altKey&&(!o&&!n.shiftKey||o&&n.shiftKey))},Ce=function(t){var n=t.startContainer;if(n.nodeType===3&&n.nodeValue.length!==t.startOffset)return!1;for(var i=n.nextSibling;i&&i.textContent==="";)i=i.nextSibling;if(i){if(i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block"))return i}else{var a=(0,v.KJ)(n,"vditor-ir__marker");if(a&&!a.nextSibling){var o=n.parentElement.parentElement.nextSibling;if(o&&o.nodeType!==3&&o.classList.contains("vditor-ir__node"))return o}return!1}return!1},ce=function(t){var n=t.startContainer,i=n.previousSibling;return n.nodeType===3&&t.startOffset===0&&i&&i.nodeType!==3&&i.classList.contains("vditor-ir__node")&&!i.getAttribute("data-block")?i:!1},ne=function(t,n){n.ir.element.querySelectorAll(".vditor-ir__node--expand").forEach(function(S){S.classList.remove("vditor-ir__node--expand")});var i=(0,v.XW)(t.startContainer,"vditor-ir__node"),a=!t.collapsed&&(0,v.XW)(t.endContainer,"vditor-ir__node");if(!(!t.collapsed&&(!i||i!==a))){i&&(i.classList.add("vditor-ir__node--expand"),i.classList.remove("vditor-ir__node--hidden"),(0,B.jl)(t));var o=Ce(t);if(o){o.classList.add("vditor-ir__node--expand"),o.classList.remove("vditor-ir__node--hidden");return}var c=ce(t);if(c){c.classList.add("vditor-ir__node--expand"),c.classList.remove("vditor-ir__node--hidden");return}}},Ve=function(t,n){if(t.ir.composingLock=n.isComposing,n.isComposing)return!1;n.key.indexOf("Arrow")===-1&&n.key!=="Meta"&&n.key!=="Control"&&n.key!=="Alt"&&n.key!=="Shift"&&n.key!=="CapsLock"&&n.key!=="Escape"&&!/^F\d{1,2}$/.test(n.key)&&t.undo.recordFirstPosition(t,n);var i=(0,B.RN)(t),a=i.startContainer;if(!qi(n,t,a)||(pr(i,t,n),Qe(i),n.key!=="Enter"&&n.key!=="Tab"&&n.key!=="Backspace"&&n.key.indexOf("Arrow")===-1&&!(0,f._0)(n)&&n.key!=="Escape"&&n.key!=="Delete"))return!1;var o=(0,v.Th)(a,"data-newline","1");if(!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&n.key==="Enter"&&o&&i.startOffset<o.textContent.length){var c=o.previousElementSibling;c&&(i.insertNode(document.createTextNode(c.textContent)),i.collapse(!1));var S=o.nextSibling;S&&(i.insertNode(document.createTextNode(S.textContent)),i.collapse(!0))}var A=(0,v._Y)(a,"P");if(Ur(n,t,A,i)||yr(i,t,A,n)||ae(t,i,n,A))return!0;var O=(0,v.KJ)(a,"vditor-ir__marker--pre");if(O&&O.tagName==="PRE"){var L=O.firstChild;if(V(t,n,O,i)||(L.getAttribute("data-type")==="math-block"||L.getAttribute("data-type")==="html-block")&&ri(t,n,i,L,O.parentElement)||Ei(t,n,i,L,O.parentElement))return!0}var $=(0,v.Th)(a,"data-type","code-block-info");if($){if(n.key==="Enter"||n.key==="Tab")return i.selectNodeContents($.nextElementSibling.firstChild),i.collapse(!0),n.preventDefault(),T(t,["hint"]),!0;if(n.key==="Backspace"){var K=(0,B.ED)($,t.ir.element).start;K===1&&i.setStart(a,0),K===2&&(t.hint.recentLanguage="")}if(ri(t,n,i,$,$.parentElement))return T(t,["hint"]),!0}var ye=(0,v._Y)(a,"TD")||(0,v._Y)(a,"TH");if(n.key.indexOf("Arrow")>-1&&ye){var be=$r(ye);if(be&&ri(t,n,i,ye,be))return!0;var me=gr(ye);if(me&&Ei(t,n,i,ye,me))return!0}if(P(t,n,i)||de(t,i,n)||Ci(t,i,n))return!0;var $e=(0,D.c)(a);if($e){if(Q("⌘=",n)){var Te=$e.querySelector(".vditor-ir__marker--heading");return Te&&Te.textContent.trim().length>1&&An(t,Te.textContent.substr(1)),n.preventDefault(),!0}if(Q("⌘-",n)){var Te=$e.querySelector(".vditor-ir__marker--heading");return Te&&Te.textContent.trim().length<6&&An(t,Te.textContent.trim()+"# "),n.preventDefault(),!0}}var fe=(0,v.pt)(a);if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&i.toString()===""){if(Ee(t,i,n,A))return!0;if(fe&&fe.previousElementSibling&&fe.tagName!=="UL"&&fe.tagName!=="OL"&&(fe.previousElementSibling.getAttribute("data-type")==="code-block"||fe.previousElementSibling.getAttribute("data-type")==="math-block")){var Ke=(0,B.ED)(fe,t.ir.element,i).start;if(Ke===0||Ke===1&&fe.innerText.startsWith(u.Y.ZWSP))return i.selectNodeContents(fe.previousElementSibling.querySelector(".vditor-ir__marker--pre code")),i.collapse(!1),ne(i,t),fe.textContent.trim().replace(u.Y.ZWSP,"")===""&&(fe.remove(),un(t)),n.preventDefault(),!0}if($e){var He=$e.firstElementChild.textContent.length;(0,B.ED)($e,t.ir.element).start===He&&He!==0&&(i.setStart($e.firstElementChild.firstChild,He-1),i.collapse(!0),(0,B.jl)(i))}}return(n.key==="ArrowUp"||n.key==="ArrowDown")&&fe&&(fe.querySelectorAll(".vditor-ir__node").forEach(function(Xe){Xe.contains(a)||Xe.classList.add("vditor-ir__node--hidden")}),Mt(n,fe,i))?!0:(mr(i,n.key),fe&&Re(fe,t,n,i)?(n.preventDefault(),!0):!1)},pe=l(726),ct=function(t,n){t.querySelectorAll("[data-type=footnotes-link]").forEach(function(i){for(var a=i.parentElement,o=a.nextSibling;o&&o.textContent.startsWith("    ");){var c=o;c.childNodes.forEach(function(S){a.append(S.cloneNode(!0))}),o=o.nextSibling,c.remove()}n&&n(a)})},Je=function(t,n){var i,a=getSelection().getRangeAt(0).cloneRange(),o=a.startContainer;a.startContainer.nodeType!==3&&a.startContainer.tagName==="DIV"&&(o=a.startContainer.childNodes[a.startOffset-1]);var c=(0,v.Th)(o,"data-block","0");if(c&&n&&(n.inputType==="deleteContentBackward"||n.data===" ")){for(var S=(0,B.ED)(c,t.sv.element,a).start,A=!0,O=S-1;O>c.textContent.substr(0,S).lastIndexOf(`
`);O--)if(c.textContent.charAt(O)!==" "&&c.textContent.charAt(O)!=="	"){A=!1;break}if(S===0&&(A=!1),A){ze(t);return}if(n.inputType==="deleteContentBackward"){var L=(0,v.Th)(o,"data-type","code-block-open-marker")||(0,v.Th)(o,"data-type","code-block-close-marker");if(L){if(L.getAttribute("data-type")==="code-block-close-marker"){var $=J(o,"code-block-open-marker");if($){$.textContent=L.textContent,ze(t);return}}if(L.getAttribute("data-type")==="code-block-open-marker"){var $=J(o,"code-block-close-marker",!1);if($){$.textContent=L.textContent,ze(t);return}}}var K=(0,v.Th)(o,"data-type","math-block-open-marker");if(K){var ye=K.nextElementSibling.nextElementSibling;ye&&ye.getAttribute("data-type")==="math-block-close-marker"&&(ye.remove(),ze(t));return}c.querySelectorAll('[data-type="code-block-open-marker"]').forEach(function(fe){fe.textContent.length===1&&fe.remove()}),c.querySelectorAll('[data-type="code-block-close-marker"]').forEach(function(fe){fe.textContent.length===1&&fe.remove()});var be=(0,v.Th)(o,"data-type","heading-marker");if(be&&be.textContent.indexOf("#")===-1){ze(t);return}}if((n.data===" "||n.inputType==="deleteContentBackward")&&((0,v.Th)(o,"data-type","padding")||(0,v.Th)(o,"data-type","li-marker")||(0,v.Th)(o,"data-type","task-marker")||(0,v.Th)(o,"data-type","blockquote-marker"))){ze(t);return}}if(c&&c.textContent.trimRight()==="$$"){ze(t);return}c||(c=t.sv.element),((i=c.firstElementChild)===null||i===void 0?void 0:i.getAttribute("data-type"))==="link-ref-defs-block"&&(c=t.sv.element),(0,v.Th)(o,"data-type","footnotes-link")&&(c=t.sv.element),c.textContent.indexOf(Lute.Caret)===-1&&a.insertNode(document.createTextNode(Lute.Caret)),c.querySelectorAll("[style]").forEach(function(fe){fe.removeAttribute("style")}),c.querySelectorAll("font").forEach(function(fe){fe.outerHTML=fe.innerHTML});var me=c.textContent,$e=c.isEqualNode(t.sv.element);if($e)me=c.textContent;else{c.previousElementSibling&&(me=c.previousElementSibling.textContent+me,c.previousElementSibling.remove()),c.previousElementSibling&&me.indexOf(`---
`)===0&&(me=c.previousElementSibling.textContent+me,c.previousElementSibling.remove());var Te="";t.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(fe,Ke){fe&&!c.isEqualNode(fe.parentElement)&&(Te+=fe.parentElement.textContent+`
`,fe.parentElement.remove())}),t.sv.element.querySelectorAll("[data-type='footnotes-link']").forEach(function(fe,Ke){fe&&!c.isEqualNode(fe.parentElement)&&(Te+=fe.parentElement.textContent+`
`,fe.parentElement.remove())}),me=Te+me}me=xe(me,t),$e?c.innerHTML=me:c.outerHTML=me,t.sv.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(fe){t.sv.element.insertAdjacentElement("beforeend",fe.parentElement)}),ct(t.sv.element,function(fe){t.sv.element.insertAdjacentElement("beforeend",fe)}),(0,B.ir)(t.sv.element,a),Dt(t),ze(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},ot=function(t,n){var i,a,o,c,S;if(t.sv.composingLock=n.isComposing,n.isComposing||(n.key.indexOf("Arrow")===-1&&n.key!=="Meta"&&n.key!=="Control"&&n.key!=="Alt"&&n.key!=="Shift"&&n.key!=="CapsLock"&&n.key!=="Escape"&&!/^F\d{1,2}$/.test(n.key)&&t.undo.recordFirstPosition(t,n),n.key!=="Enter"&&n.key!=="Tab"&&n.key!=="Backspace"&&n.key.indexOf("Arrow")===-1&&!(0,f._0)(n)&&n.key!=="Escape"))return!1;var A=(0,B.RN)(t),O=A.startContainer;A.startContainer.nodeType!==3&&A.startContainer.tagName==="DIV"&&(O=A.startContainer.childNodes[A.startOffset-1]);var L=(0,v.Th)(O,"data-type","text"),$=(0,v.Th)(O,"data-type","blockquote-marker");if(!$&&A.startOffset===0&&L&&L.previousElementSibling&&L.previousElementSibling.getAttribute("data-type")==="blockquote-marker"&&($=L.previousElementSibling),$&&n.key==="Enter"&&!(0,f._0)(n)&&!n.altKey&&$.nextElementSibling.textContent.trim()===""&&(0,B.ED)($,t.sv.element,A).start===$.textContent.length)return((i=$.previousElementSibling)===null||i===void 0?void 0:i.getAttribute("data-type"))==="padding"&&$.previousElementSibling.setAttribute("data-action","enter-remove"),$.remove(),ze(t),n.preventDefault(),!0;var K=(0,v.Th)(O,"data-type","li-marker"),ye=(0,v.Th)(O,"data-type","task-marker"),be=K;if(be||ye&&ye.nextElementSibling.getAttribute("data-type")!=="task-marker"&&(be=ye),!be&&A.startOffset===0&&L&&L.previousElementSibling&&(L.previousElementSibling.getAttribute("data-type")==="li-marker"||L.previousElementSibling.getAttribute("data-type")==="task-marker")&&(be=L.previousElementSibling),be){var me=(0,B.ED)(be,t.sv.element,A).start,$e=be.getAttribute("data-type")==="task-marker",Te=be;if($e&&(Te=be.previousElementSibling.previousElementSibling.previousElementSibling),me===be.textContent.length){if(n.key==="Enter"&&!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&be.nextElementSibling.textContent.trim()==="")return((a=Te.previousElementSibling)===null||a===void 0?void 0:a.getAttribute("data-type"))==="padding"?(Te.previousElementSibling.remove(),Je(t)):($e&&(Te.remove(),be.previousElementSibling.previousElementSibling.remove(),be.previousElementSibling.remove()),be.nextElementSibling.remove(),be.remove(),ze(t)),n.preventDefault(),!0;if(n.key==="Tab")return n.shiftKey?Te.previousElementSibling.getAttribute("data-type")==="padding"&&Te.previousElementSibling.remove():Te.insertAdjacentHTML("beforebegin",'<span data-type="padding">'.concat(Te.textContent.replace(/\S/g," "),"</span>")),/^\d/.test(Te.textContent)&&(Te.textContent=Te.textContent.replace(/^\d{1,}/,"1"),A.selectNodeContents(be.firstChild),A.collapse(!1)),Je(t),n.preventDefault(),!0}}if(Ci(t,A,n))return!0;var fe=(0,v.Th)(O,"data-block","0"),Ke=(0,D.f)(O,"SPAN");if(n.key==="Enter"&&!(0,f._0)(n)&&!n.altKey&&!n.shiftKey&&fe){var He=!1,Xe=fe.textContent.match(/^\n+/);(0,B.ED)(fe,t.sv.element).start<=(Xe?Xe[0].length:0)&&(He=!0);var At=`
`;if(Ke){if(((o=Ke.previousElementSibling)===null||o===void 0?void 0:o.getAttribute("data-action"))==="enter-remove")return Ke.previousElementSibling.remove(),ze(t),n.preventDefault(),!0;At+=De(Ke)}return A.insertNode(document.createTextNode(At)),A.collapse(!1),fe&&fe.textContent.trim()!==""&&!He?Je(t):ze(t),n.preventDefault(),!0}if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.altKey&&!n.shiftKey){if(Ke&&((c=Ke.previousElementSibling)===null||c===void 0?void 0:c.getAttribute("data-type"))==="newline"&&(0,B.ED)(Ke,t.sv.element,A).start===1&&Ke.getAttribute("data-type").indexOf("code-block-")===-1)return A.setStart(Ke,0),A.extractContents(),Ke.textContent.trim()!==""?Je(t):ze(t),n.preventDefault(),!0;if(fe&&(0,B.ED)(fe,t.sv.element,A).start===0&&fe.previousElementSibling){A.extractContents();var _t=fe.previousElementSibling.lastElementChild;return _t.getAttribute("data-type")==="newline"&&(_t.remove(),_t=fe.previousElementSibling.lastElementChild),_t.getAttribute("data-type")!=="newline"&&(_t.insertAdjacentHTML("afterend",fe.innerHTML),fe.remove()),fe.textContent.trim()!==""&&!(!((S=fe.previousElementSibling)===null||S===void 0)&&S.querySelector('[data-type="code-block-open-marker"]'))?Je(t):(_t.getAttribute("data-type")!=="newline"&&(A.selectNodeContents(_t.lastChild),A.collapse(!1)),ze(t)),n.preventDefault(),!0}}return!1},_e=l(873),tt=function(t){t.options.theme==="dark"?t.element.classList.add("vditor--dark"):t.element.classList.remove("vditor--dark")},kt=function(t){t.element.innerHTML="",t.element.classList.add("vditor"),t.options.rtl&&t.element.setAttribute("dir","rtl"),tt(t),(0,_e.H)(t.options.preview.theme.current,t.options.preview.theme.path),typeof t.options.height=="number"?t.element.style.height=t.options.height+"px":t.element.style.height=t.options.height,typeof t.options.minHeight=="number"&&(t.element.style.minHeight=t.options.minHeight+"px"),typeof t.options.width=="number"?t.element.style.width=t.options.width+"px":t.element.style.width=t.options.width,t.element.appendChild(t.toolbar.element);var n=document.createElement("div");if(n.className="vditor-content",t.options.outline.position==="left"&&n.appendChild(t.outline.element),n.appendChild(t.wysiwyg.element.parentElement),n.appendChild(t.sv.element),n.appendChild(t.ir.element.parentElement),n.appendChild(t.preview.element),t.toolbar.elements.devtools&&n.appendChild(t.devtools.element),t.options.outline.position==="right"&&(t.outline.element.classList.add("vditor-outline--right"),n.appendChild(t.outline.element)),t.upload&&n.appendChild(t.upload.element),t.options.resize.enable&&n.appendChild(t.resize.element),n.appendChild(t.hint.element),n.appendChild(t.tip.element),t.element.appendChild(n),n.addEventListener("click",function(){T(t,["subToolbar"])}),t.toolbar.elements.export&&t.element.insertAdjacentHTML("beforeend",'<iframe id="vditorExportIframe" style="width: 100%;height: 0;border: 0"></iframe>'),wn(t,t.options.mode,Pt(t)),document.execCommand("DefaultParagraphSeparator",!1,"p"),navigator.userAgent.indexOf("iPhone")>-1&&typeof window.visualViewport<"u"){var i=!1,a=function(o){i||(i=!0,requestAnimationFrame(function(){i=!1;var c=t.toolbar.element;c.style.transform="none",c.getBoundingClientRect().top<0&&(c.style.transform="translate(0, ".concat(-c.getBoundingClientRect().top,"px)"))}))};window.visualViewport.addEventListener("scroll",a),window.visualViewport.addEventListener("resize",a)}},wt=function(t){var n=window.innerWidth<=u.Y.MOBILE_WIDTH?10:35;if(t.wysiwyg.element.parentElement.style.display!=="none"){var i=(t.wysiwyg.element.parentElement.clientWidth-t.options.preview.maxWidth)/2;t.wysiwyg.element.style.padding="10px ".concat(Math.max(n,i),"px")}if(t.ir.element.parentElement.style.display!=="none"){var i=(t.ir.element.parentElement.clientWidth-t.options.preview.maxWidth)/2;t.ir.element.style.padding="10px ".concat(Math.max(n,i),"px")}t.preview.element.style.display!=="block"?t.toolbar.element.style.paddingLeft=Math.max(5,parseInt(t[t.currentMode].element.style.paddingLeft||"0",10)+(t.options.outline.position==="left"?t.outline.element.offsetWidth:0))+"px":t.toolbar.element.style.paddingLeft=5+(t.options.outline.position==="left"?t.outline.element.offsetWidth:0)+"px"},nt=function(t){if(t.options.typewriterMode){var n=window.innerHeight;typeof t.options.height=="number"?(n=t.options.height,typeof t.options.minHeight=="number"&&(n=Math.max(n,t.options.minHeight)),n=Math.min(window.innerHeight,n)):n=t.element.clientHeight,t.element.classList.contains("vditor--fullscreen")&&(n=window.innerHeight),t[t.currentMode].element.style.setProperty("--editor-bottom",(n-t.toolbar.element.offsetHeight)/2+"px")}},Yt;function yn(){window.removeEventListener("resize",Yt)}var Pt=function(t){nt(t),yn(),window.addEventListener("resize",Yt=function(){wt(t),nt(t)});var n=(0,f.D)()&&localStorage.getItem(t.options.cache.id);return(!t.options.cache.enable||!n)&&(t.options.value?n=t.options.value:t.originalInnerHTML?n=t.lute.HTML2Md(t.originalInnerHTML):t.options.cache.enable||(n="")),n||""},an=function(t){clearTimeout(t[t.currentMode].hlToolbarTimeoutId),t[t.currentMode].hlToolbarTimeoutId=window.setTimeout(function(){if(t[t.currentMode].element.getAttribute("contenteditable")!=="false"&&(0,B.Co)(t[t.currentMode].element)){b(t.toolbar.elements,u.Y.EDIT_TOOLBARS),E(t.toolbar.elements,u.Y.EDIT_TOOLBARS);var n=(0,B.RN)(t),i=n.startContainer;n.startContainer.nodeType===3&&(i=n.startContainer.parentElement),i.classList.contains("vditor-reset")&&(i=i.childNodes[n.startOffset]);var a=t.currentMode==="sv"?(0,v.Th)(i,"data-type","heading"):(0,D.c)(i);a&&y(t.toolbar.elements,["headings"]);var o=t.currentMode==="sv"?(0,v.Th)(i,"data-type","blockquote"):(0,v._Y)(i,"BLOCKQUOTE");o&&y(t.toolbar.elements,["quote"]);var c=(0,v.Th)(i,"data-type","strong");c&&y(t.toolbar.elements,["bold"]);var S=(0,v.Th)(i,"data-type","em");S&&y(t.toolbar.elements,["italic"]);var A=(0,v.Th)(i,"data-type","s");A&&y(t.toolbar.elements,["strike"]);var O=(0,v.Th)(i,"data-type","a");O&&y(t.toolbar.elements,["link"]);var L=(0,v._Y)(i,"LI");L?(L.classList.contains("vditor-task")?y(t.toolbar.elements,["check"]):L.parentElement.tagName==="OL"?y(t.toolbar.elements,["ordered-list"]):L.parentElement.tagName==="UL"&&y(t.toolbar.elements,["list"]),E(t.toolbar.elements,["outdent","indent"])):w(t.toolbar.elements,["outdent","indent"]);var $=(0,v.Th)(i,"data-type","code-block");$&&(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),y(t.toolbar.elements,["code"]));var K=(0,v.Th)(i,"data-type","code");K&&(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),y(t.toolbar.elements,["inline-code"]));var ye=(0,v.Th)(i,"data-type","table");ye&&w(t.toolbar.elements,["headings","list","ordered-list","check","line","quote","code","table"])}},200)},ht=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),n.enableHint&&t.hint.render(t),clearTimeout(t.wysiwyg.afterRenderTimeoutId),t.wysiwyg.afterRenderTimeoutId=window.setTimeout(function(){if(!t.wysiwyg.composingLock){var i=x(t);typeof t.options.input=="function"&&n.enableInput&&t.options.input(i),t.options.counter.enable&&t.counter.render(t,i),t.options.cache.enable&&(0,f.D)()&&(localStorage.setItem(t.options.cache.id,i),t.options.cache.after&&t.options.cache.after(i)),t.devtools&&t.devtools.renderEchart(t),n.enableAddUndoStack&&t.undo.addToUndoStack(t)}},t.options.undoDelay)},In=function(t){for(var n=t.previousSibling;n;){if(n.nodeType!==3&&n.tagName==="A"&&!n.previousSibling&&n.innerHTML.replace(u.Y.ZWSP,"")===""&&n.nextSibling)return n;n=n.previousSibling}return!1},on=function(t){for(var n=t.startContainer.nextSibling;n&&n.textContent==="";)n=n.nextSibling;return!!(n&&n.nodeType!==3&&(n.tagName==="CODE"||n.getAttribute("data-type")==="math-inline"||n.getAttribute("data-type")==="html-entity"||n.getAttribute("data-type")==="html-inline"))},Vt=function(t){for(var n="",i=t.nextSibling;i;)i.nodeType===3?n+=i.textContent:n+=i.outerHTML,i=i.nextSibling;return n},Gt=function(t){for(var n="",i=t.previousSibling;i;)i.nodeType===3?n=i.textContent+n:n=i.outerHTML+n,i=i.previousSibling;return n},sn=function(t){for(var n=t;n&&!n.nextSibling;)n=n.parentElement;return n.nextSibling},fn=function(t){var n=Gt(t.startContainer),i=Vt(t.startContainer),a=t.startContainer.textContent,o=t.startOffset,c="",S="";return(a.substr(0,o)!==""&&a.substr(0,o)!==u.Y.ZWSP||n)&&(c="".concat(n).concat(a.substr(0,o))),(a.substr(o)!==""&&a.substr(o)!==u.Y.ZWSP||i)&&(S="".concat(a.substr(o)).concat(i)),{afterHTML:S,beforeHTML:c}},Wn=function(t,n){Array.from(t.wysiwyg.element.childNodes).find(function(i){if(i.nodeType===3){var a=document.createElement("p");a.setAttribute("data-block","0"),a.textContent=i.textContent;var o=n.startContainer.nodeType===3?n.startOffset:i.textContent.length;return i.parentNode.insertBefore(a,i),i.remove(),n.setStart(a.firstChild,Math.min(a.firstChild.textContent.length,o)),n.collapse(!0),(0,B.jl)(n),!0}else if(!i.getAttribute("data-block"))return i.tagName==="P"?i.remove():(i.tagName==="DIV"?(n.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>")):i.tagName==="BR"?i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"<wbr></p>"):(n.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.outerHTML,"</p>")),(0,B.ir)(t.wysiwyg.element,n),n=getSelection().getRangeAt(0)),!0})},hn=function(t,n){var i=(0,B.RN)(t),a=(0,v.pt)(i.startContainer);a||(a=i.startContainer.childNodes[i.startOffset]),!a&&t.wysiwyg.element.children.length===0&&(a=t.wysiwyg.element),a&&!a.classList.contains("vditor-wysiwyg__block")&&(i.insertNode(document.createElement("wbr")),a.innerHTML.trim()==="<wbr>"&&(a.innerHTML="<wbr><br>"),a.tagName==="BLOCKQUOTE"||a.classList.contains("vditor-reset")?a.innerHTML="<".concat(n,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(n,">"):a.outerHTML="<".concat(n,' data-block="0">').concat(a.innerHTML.trim(),"</").concat(n,">"),(0,B.ir)(t.wysiwyg.element,i),le(t))},Bt=function(t){var n=getSelection().getRangeAt(0),i=(0,v.pt)(n.startContainer);i||(i=n.startContainer.childNodes[n.startOffset]),i&&(n.insertNode(document.createElement("wbr")),i.outerHTML='<p data-block="0">'.concat(i.innerHTML,"</p>"),(0,B.ir)(t.wysiwyg.element,n)),t.wysiwyg.popover.style.display="none"},bt=function(t,n,i){i===void 0&&(i=!0);var a=t.previousElementSibling,o=a.ownerDocument.createRange();a.tagName==="CODE"?(a.style.display="inline-block",i?o.setStart(a.firstChild,1):o.selectNodeContents(a)):(a.style.display="block",a.firstChild.firstChild||a.firstChild.appendChild(document.createTextNode("")),o.selectNodeContents(a.firstChild)),i?o.collapse(!0):o.collapse(!1),(0,B.jl)(o),!t.firstElementChild.classList.contains("language-mindmap")&&Dt(n)},Nt=function(t,n){if(t.wysiwyg.composingLock=n.isComposing,n.isComposing)return!1;n.key.indexOf("Arrow")===-1&&n.key!=="Meta"&&n.key!=="Control"&&n.key!=="Alt"&&n.key!=="Shift"&&n.key!=="CapsLock"&&n.key!=="Escape"&&!/^F\d{1,2}$/.test(n.key)&&t.undo.recordFirstPosition(t,n);var i=(0,B.RN)(t),a=i.startContainer;if(!qi(n,t,a)||(pr(i,t,n),Qe(i),n.key!=="Enter"&&n.key!=="Tab"&&n.key!=="Backspace"&&n.key.indexOf("Arrow")===-1&&!(0,f._0)(n)&&n.key!=="Escape"&&n.key!=="Delete"))return!1;var o=(0,v.pt)(a),c=(0,v._Y)(a,"P");if(Ur(n,t,c,i)||yr(i,t,c,n)||P(t,n,i))return!0;var S=(0,v.KJ)(a,"vditor-wysiwyg__block");if(S){if(n.key==="Escape"&&S.children.length===2)return t.wysiwyg.popover.style.display="none",S.firstElementChild.style.display="none",t.wysiwyg.element.blur(),n.preventDefault(),!0;if(!(0,f._0)(n)&&!n.shiftKey&&n.altKey&&n.key==="Enter"&&S.getAttribute("data-type")==="code-block"){var A=t.wysiwyg.popover.querySelector(".vditor-input");return A.focus(),A.select(),n.preventDefault(),!0}if(S.getAttribute("data-block")==="0"&&(V(t,n,S.firstElementChild,i)||Ei(t,n,i,S.firstElementChild,S)||S.getAttribute("data-type")!=="yaml-front-matter"&&ri(t,n,i,S.firstElementChild,S)))return!0}if(ae(t,i,n,c))return!0;var O=(0,v.Ab)(a,"BLOCKQUOTE");if(O&&!n.shiftKey&&n.altKey&&n.key==="Enter"){(0,f._0)(n)?i.setStartBefore(O):i.setStartAfter(O),(0,B.jl)(i);var L=document.createElement("p");return L.setAttribute("data-block","0"),L.innerHTML=`
`,i.insertNode(L),i.collapse(!0),(0,B.jl)(i),ht(t),Dt(t),n.preventDefault(),!0}var $=(0,D.c)(a);if($){if($.tagName==="H6"&&a.textContent.length===i.startOffset&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&n.key==="Enter"){var K=document.createElement("p");return K.textContent=`
`,K.setAttribute("data-block","0"),a.parentElement.insertAdjacentElement("afterend",K),i.setStart(K,0),(0,B.jl)(i),ht(t),Dt(t),n.preventDefault(),!0}if(Q("⌘=",n)){var ye=parseInt($.tagName.substr(1),10)-1;return ye>0&&(hn(t,"h".concat(ye)),ht(t)),n.preventDefault(),!0}if(Q("⌘-",n)){var ye=parseInt($.tagName.substr(1),10)+1;return ye<7&&(hn(t,"h".concat(ye)),ht(t)),n.preventDefault(),!0}n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&$.textContent.length===1&&Bt(t)}if(de(t,i,n))return!0;if(n.altKey&&n.key==="Enter"&&!(0,f._0)(n)&&!n.shiftKey){var be=(0,v._Y)(a,"A"),me=(0,v.Th)(a,"data-type","link-ref"),$e=(0,v.Th)(a,"data-type","footnotes-ref");if(be||me||$e||$&&$.tagName.length===2){var Te=t.wysiwyg.popover.querySelector("input");Te.focus(),Te.select()}}if(Ut(t,n))return!0;if(Q("⇧⌘U",n)){var fe=t.wysiwyg.popover.querySelector('[data-type="up"]');if(fe)return fe.click(),n.preventDefault(),!0}if(Q("⇧⌘D",n)){var fe=t.wysiwyg.popover.querySelector('[data-type="down"]');if(fe)return fe.click(),n.preventDefault(),!0}if(Ci(t,i,n))return!0;if(!(0,f._0)(n)&&n.shiftKey&&!n.altKey&&n.key==="Enter"&&a.parentElement.tagName!=="LI"&&a.parentElement.tagName!=="P")return["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName)?i.insertNode(document.createTextNode(`
`+u.Y.ZWSP)):i.insertNode(document.createTextNode(`
`)),i.collapse(!1),(0,B.jl)(i),ht(t),Dt(t),n.preventDefault(),!0;if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&i.toString()===""){if(Ee(t,i,n,c))return!0;if(o){if(o.previousElementSibling&&o.previousElementSibling.classList.contains("vditor-wysiwyg__block")&&o.previousElementSibling.getAttribute("data-block")==="0"&&o.tagName!=="UL"&&o.tagName!=="OL"){var Ke=(0,B.ED)(o,t.wysiwyg.element,i).start;if(Ke===0&&i.startOffset===0||Ke===1&&o.innerText.startsWith(u.Y.ZWSP))return bt(o.previousElementSibling.lastElementChild,t,!1),o.innerHTML.trim().replace(u.Y.ZWSP,"")===""&&(o.remove(),ht(t)),n.preventDefault(),!0}var He=i.startOffset;if(i.toString()===""&&a.nodeType===3&&a.textContent.charAt(He-2)===`
`&&a.textContent.charAt(He-1)!==u.Y.ZWSP&&["STRONG","STRIKE","S","I","EM","B"].includes(a.parentElement.tagName))return a.textContent=a.textContent.substring(0,He-1)+u.Y.ZWSP,i.setStart(a,He),i.collapse(!0),ht(t),n.preventDefault(),!0;a.textContent===u.Y.ZWSP&&i.startOffset===1&&!a.previousSibling&&on(i)&&(a.textContent=""),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='math-inline']").forEach(function(At){At.firstElementChild.style.display="inline",At.lastElementChild.style.display="none"}),o.querySelectorAll("span.vditor-wysiwyg__block[data-type='html-entity']").forEach(function(At){At.firstElementChild.style.display="inline",At.lastElementChild.style.display="none"})}}if((0,f.gm)()&&i.startOffset===1&&a.textContent.indexOf(u.Y.ZWSP)>-1&&a.previousSibling&&a.previousSibling.nodeType!==3&&a.previousSibling.tagName==="CODE"&&(n.key==="Backspace"||n.key==="ArrowLeft"))return i.selectNodeContents(a.previousSibling),i.collapse(!1),n.preventDefault(),!0;if(Mt(n,o,i))return n.preventDefault(),!0;if(mr(i,n.key),n.key==="ArrowDown"){var Xe=a.nextSibling;Xe&&Xe.nodeType!==3&&Xe.getAttribute("data-type")==="math-inline"&&i.setStartAfter(Xe)}return o&&Re(o,t,n,i)?(n.preventDefault(),!0):!1},Ut=function(t,n){if(Q("⇧⌘X",n)){var i=t.wysiwyg.popover.querySelector('[data-type="remove"]');return i&&i.click(),n.preventDefault(),!0}},Qt=function(t){clearTimeout(t.wysiwyg.hlToolbarTimeoutId),t.wysiwyg.hlToolbarTimeoutId=window.setTimeout(function(){if(t.wysiwyg.element.getAttribute("contenteditable")!=="false"&&(0,B.Co)(t.wysiwyg.element)){b(t.toolbar.elements,u.Y.EDIT_TOOLBARS),E(t.toolbar.elements,u.Y.EDIT_TOOLBARS);var n=getSelection().getRangeAt(0),i=n.startContainer;n.startContainer.nodeType===3?i=n.startContainer.parentElement:i=i.childNodes[n.startOffset>=i.childNodes.length?i.childNodes.length-1:n.startOffset];var a=(0,v.Th)(i,"data-type","footnotes-block");if(a){t.wysiwyg.popover.innerHTML="",te(a,t),se(t,a);return}var o=(0,v._Y)(i,"LI");o?(o.classList.contains("vditor-task")?y(t.toolbar.elements,["check"]):o.parentElement.tagName==="OL"?y(t.toolbar.elements,["ordered-list"]):o.parentElement.tagName==="UL"&&y(t.toolbar.elements,["list"]),E(t.toolbar.elements,["outdent","indent"])):w(t.toolbar.elements,["outdent","indent"]),(0,v._Y)(i,"BLOCKQUOTE")&&y(t.toolbar.elements,["quote"]),((0,v._Y)(i,"B")||(0,v._Y)(i,"STRONG"))&&y(t.toolbar.elements,["bold"]),((0,v._Y)(i,"I")||(0,v._Y)(i,"EM"))&&y(t.toolbar.elements,["italic"]),((0,v._Y)(i,"STRIKE")||(0,v._Y)(i,"S"))&&y(t.toolbar.elements,["strike"]),t.wysiwyg.element.querySelectorAll(".vditor-comment--focus").forEach(function(Ne){Ne.classList.remove("vditor-comment--focus")});var c=(0,v.KJ)(i,"vditor-comment");if(c){var S=c.getAttribute("data-cmtids").split(" ");if(S.length>1&&c.nextSibling.isSameNode(c.nextElementSibling)){var A=c.nextElementSibling.getAttribute("data-cmtids").split(" ");S.find(function(Ne){if(A.includes(Ne))return S=[Ne],!0})}t.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(Ne){Ne.getAttribute("data-cmtids").indexOf(S[0])>-1&&Ne.classList.add("vditor-comment--focus")})}var O=(0,v._Y)(i,"A");O&&y(t.toolbar.elements,["link"]);var L=(0,v._Y)(i,"TABLE"),$=(0,D.c)(i);(0,v._Y)(i,"CODE")?(0,v._Y)(i,"PRE")?(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","inline-code","upload","link","table","record"]),y(t.toolbar.elements,["code"])):(w(t.toolbar.elements,["headings","bold","italic","strike","line","quote","list","ordered-list","check","code","upload","link","table","record"]),y(t.toolbar.elements,["inline-code"])):$?(w(t.toolbar.elements,["bold"]),y(t.toolbar.elements,["headings"])):L&&w(t.toolbar.elements,["table"]);var K=(0,v.KJ)(i,"vditor-toc");if(K){t.wysiwyg.popover.innerHTML="",te(K,t),se(t,K);return}var ye=(0,D.f)(i,"BLOCKQUOTE");if(ye&&(t.wysiwyg.popover.innerHTML="",q(n,ye,t),ee(n,ye,t),te(ye,t),se(t,ye)),o&&(t.wysiwyg.popover.innerHTML="",q(n,o,t),ee(n,o,t),te(o,t),se(t,o)),L){t.options.lang,t.options,t.wysiwyg.popover.innerHTML="";var be=function(){var Ne=L.rows.length,ft=L.rows[0].cells.length,mi=parseInt(qt.value,10)||Ne,gi=parseInt(Sn.value,10)||ft;if(!(mi===Ne&&ft===gi)){if(ft!==gi)for(var kr=gi-ft,Gn=0;Gn<L.rows.length;Gn++)if(kr>0)for(var vo=0;vo<kr;vo++)Gn===0?L.rows[Gn].lastElementChild.insertAdjacentHTML("afterend","<th> </th>"):L.rows[Gn].lastElementChild.insertAdjacentHTML("afterend","<td> </td>");else for(var ka=ft-1;ka>=gi;ka--)L.rows[Gn].cells[ka].remove();if(Ne!==mi){var bo=mi-Ne;if(bo>0){for(var Ea="<tr>",Qi=0;Qi<gi;Qi++)Ea+="<td> </td>";for(var yo=0;yo<bo;yo++)L.querySelector("tbody")?L.querySelector("tbody").insertAdjacentHTML("beforeend",Ea):L.querySelector("thead").insertAdjacentHTML("afterend",Ea+"</tr>")}else for(var Qi=Ne-1;Qi>=mi;Qi--)L.rows[Qi].remove(),L.rows.length===1&&L.querySelector("tbody").remove()}typeof t.options.input=="function"&&t.options.input(x(t))}},me=function(Ne){Si(L,Ne),Ne==="right"?(Ke.classList.remove("vditor-icon--current"),He.classList.remove("vditor-icon--current"),Xe.classList.add("vditor-icon--current")):Ne==="center"?(Ke.classList.remove("vditor-icon--current"),Xe.classList.remove("vditor-icon--current"),He.classList.add("vditor-icon--current")):(He.classList.remove("vditor-icon--current"),Xe.classList.remove("vditor-icon--current"),Ke.classList.add("vditor-icon--current")),(0,B.jl)(n),ht(t)},$e=(0,v._Y)(i,"TD"),Te=(0,v._Y)(i,"TH"),fe="left";$e?fe=$e.getAttribute("align")||"left":Te&&(fe=Te.getAttribute("align")||"center");var Ke=document.createElement("button");Ke.setAttribute("type","button"),Ke.setAttribute("aria-label",window.VditorI18n.alignLeft+"<"+(0,f.fG)("⇧⌘L")+">"),Ke.setAttribute("data-type","left"),Ke.innerHTML='<svg><use xlink:href="#vditor-icon-align-left"></use></svg>',Ke.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(fe==="left"?" vditor-icon--current":""),Ke.onclick=function(){me("left")};var He=document.createElement("button");He.setAttribute("type","button"),He.setAttribute("aria-label",window.VditorI18n.alignCenter+"<"+(0,f.fG)("⇧⌘C")+">"),He.setAttribute("data-type","center"),He.innerHTML='<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',He.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(fe==="center"?" vditor-icon--current":""),He.onclick=function(){me("center")};var Xe=document.createElement("button");Xe.setAttribute("type","button"),Xe.setAttribute("aria-label",window.VditorI18n.alignRight+"<"+(0,f.fG)("⇧⌘R")+">"),Xe.setAttribute("data-type","right"),Xe.innerHTML='<svg><use xlink:href="#vditor-icon-align-right"></use></svg>',Xe.className="vditor-icon vditor-tooltipped vditor-tooltipped__n"+(fe==="right"?" vditor-icon--current":""),Xe.onclick=function(){me("right")};var At=document.createElement("button");At.setAttribute("type","button"),At.setAttribute("aria-label",window.VditorI18n.insertRowBelow+"<"+(0,f.fG)("⌘=")+">"),At.setAttribute("data-type","insertRow"),At.innerHTML='<svg><use xlink:href="#vditor-icon-insert-row"></use></svg>',At.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",At.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ft=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ft&&Ki(t,n,ft)};var _t=document.createElement("button");_t.setAttribute("type","button"),_t.setAttribute("aria-label",window.VditorI18n.insertRowAbove+"<"+(0,f.fG)("⇧⌘F")+">"),_t.setAttribute("data-type","insertRow"),_t.innerHTML='<svg><use xlink:href="#vditor-icon-insert-rowb"></use></svg>',_t.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",_t.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ft=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ft&&_i(t,n,ft)};var Ot=document.createElement("button");Ot.setAttribute("type","button"),Ot.setAttribute("aria-label",window.VditorI18n.insertColumnRight+"<"+(0,f.fG)("⇧⌘=")+">"),Ot.setAttribute("data-type","insertColumn"),Ot.innerHTML='<svg><use xlink:href="#vditor-icon-insert-column"></use></svg>',Ot.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",Ot.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ft=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ft&&Gi(t,L,ft)};var pn=document.createElement("button");pn.setAttribute("type","button"),pn.setAttribute("aria-label",window.VditorI18n.insertColumnLeft+"<"+(0,f.fG)("⇧⌘G")+">"),pn.setAttribute("data-type","insertColumn"),pn.innerHTML='<svg><use xlink:href="#vditor-icon-insert-columnb"></use></svg>',pn.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",pn.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ft=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ft&&Gi(t,L,ft,"beforebegin")};var nn=document.createElement("button");nn.setAttribute("type","button"),nn.setAttribute("aria-label",window.VditorI18n["delete-row"]+"<"+(0,f.fG)("⌘-")+">"),nn.setAttribute("data-type","deleteRow"),nn.innerHTML='<svg><use xlink:href="#vditor-icon-delete-row"></use></svg>',nn.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",nn.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ft=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ft&&zr(t,n,ft)};var mn=document.createElement("button");mn.setAttribute("type","button"),mn.setAttribute("aria-label",window.VditorI18n["delete-column"]+"<"+(0,f.fG)("⇧⌘-")+">"),mn.setAttribute("data-type","deleteColumn"),mn.innerHTML='<svg><use xlink:href="#vditor-icon-delete-column"></use></svg>',mn.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",mn.onclick=function(){var Ne=getSelection().getRangeAt(0).startContainer,ft=(0,v._Y)(Ne,"TD")||(0,v._Y)(Ne,"TH");ft&&R(t,n,L,ft)};var lt=document.createElement("span");lt.setAttribute("aria-label",window.VditorI18n.row),lt.className="vditor-tooltipped vditor-tooltipped__n";var qt=document.createElement("input");lt.appendChild(qt),qt.type="number",qt.min="1",qt.className="vditor-input",qt.style.width="42px",qt.style.textAlign="center",qt.setAttribute("placeholder",window.VditorI18n.row),qt.value=L.rows.length.toString(),qt.oninput=function(){be()},qt.onkeydown=function(Ne){if(!Ne.isComposing){if(Ne.key==="Tab"){Sn.focus(),Sn.select(),Ne.preventDefault();return}Ut(t,Ne)||yt(Ne,n)}};var Fr=document.createElement("span");Fr.setAttribute("aria-label",window.VditorI18n.column),Fr.className="vditor-tooltipped vditor-tooltipped__n";var Sn=document.createElement("input");Fr.appendChild(Sn),Sn.type="number",Sn.min="1",Sn.className="vditor-input",Sn.style.width="42px",Sn.style.textAlign="center",Sn.setAttribute("placeholder",window.VditorI18n.column),Sn.value=L.rows[0].cells.length.toString(),Sn.oninput=function(){be()},Sn.onkeydown=function(Ne){if(!Ne.isComposing){if(Ne.key==="Tab"){qt.focus(),qt.select(),Ne.preventDefault();return}Ut(t,Ne)||yt(Ne,n)}},q(n,L,t),ee(n,L,t),te(L,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",Ke),t.wysiwyg.popover.insertAdjacentElement("beforeend",He),t.wysiwyg.popover.insertAdjacentElement("beforeend",Xe),t.wysiwyg.popover.insertAdjacentElement("beforeend",_t),t.wysiwyg.popover.insertAdjacentElement("beforeend",At),t.wysiwyg.popover.insertAdjacentElement("beforeend",pn),t.wysiwyg.popover.insertAdjacentElement("beforeend",Ot),t.wysiwyg.popover.insertAdjacentElement("beforeend",nn),t.wysiwyg.popover.insertAdjacentElement("beforeend",mn),t.wysiwyg.popover.insertAdjacentElement("beforeend",lt),t.wysiwyg.popover.insertAdjacentHTML("beforeend"," x "),t.wysiwyg.popover.insertAdjacentElement("beforeend",Fr),se(t,L)}var wa=(0,v.Th)(i,"data-type","link-ref");wa&&W(t,wa,n);var Zi=(0,v.Th)(i,"data-type","footnotes-ref");if(Zi){t.options.lang,t.options,t.wysiwyg.popover.innerHTML="";var lt=document.createElement("span");lt.setAttribute("aria-label",window.VditorI18n.footnoteRef+"<"+(0,f.fG)("⌥Enter")+">"),lt.className="vditor-tooltipped vditor-tooltipped__n";var ai=document.createElement("input");lt.appendChild(ai),ai.className="vditor-input",ai.setAttribute("placeholder",window.VditorI18n.footnoteRef+"<"+(0,f.fG)("⌥Enter")+">"),ai.style.width="120px",ai.value=Zi.getAttribute("data-footnotes-label"),ai.oninput=function(){ai.value.trim()!==""&&Zi.setAttribute("data-footnotes-label",ai.value),typeof t.options.input=="function"&&t.options.input(x(t))},ai.onkeydown=function(ft){ft.isComposing||Ut(t,ft)||yt(ft,n)},te(Zi,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",lt),se(t,Zi)}var Xt=(0,v.KJ)(i,"vditor-wysiwyg__block"),mo=Xt?Xt.getAttribute("data-type").indexOf("block")>-1:!1;if(t.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(Ne){if(!Xt||Xt&&mo&&!Xt.contains(Ne)){var ft=Ne.previousElementSibling;ft.style.display="none"}}),Xt&&mo){if(t.wysiwyg.popover.innerHTML="",q(n,Xt,t),ee(n,Xt,t),te(Xt,t),Xt.getAttribute("data-type")==="code-block"){var Vr=document.createElement("span");Vr.setAttribute("aria-label",window.VditorI18n.language+"<"+(0,f.fG)("⌥Enter")+">"),Vr.className="vditor-tooltipped vditor-tooltipped__n";var Un=document.createElement("input");Vr.appendChild(Un);var wr=Xt.firstElementChild.firstElementChild;Un.className="vditor-input",Un.setAttribute("placeholder",window.VditorI18n.language+"<"+(0,f.fG)("⌥Enter")+">"),Un.value=wr.className.indexOf("language-")>-1?wr.className.split("-")[1].split(" ")[0]:"",Un.oninput=function(Ne){Un.value.trim()!==""?wr.className="language-".concat(Un.value):(wr.className="",t.hint.recentLanguage=""),Xt.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&(Xt.lastElementChild.innerHTML=Xt.firstElementChild.innerHTML,rt(Xt.lastElementChild,t)),ht(t),Ne.detail===1&&(n.setStart(wr.firstChild,0),n.collapse(!0),(0,B.jl)(n))},Un.onkeydown=function(Ne){if(!Ne.isComposing&&!Ut(t,Ne)){if(Ne.key==="Escape"&&t.hint.element.style.display==="block"){t.hint.element.style.display="none",Ne.preventDefault();return}t.hint.select(Ne,t),yt(Ne,n)}},Un.onkeyup=function(Ne){var ft,mi;if(!(Ne.isComposing||Ne.key==="Enter"||Ne.key==="ArrowUp"||Ne.key==="Escape"||Ne.key==="ArrowDown")){var gi=[],kr=Un.value.substring(0,Un.selectionStart);(t.options.preview.hljs.langs||u.Y.ALIAS_CODE_LANGUAGES.concat(((mi=(ft=window.hljs)===null||ft===void 0?void 0:ft.listLanguages())!==null&&mi!==void 0?mi:[]).sort())).forEach(function(Gn){Gn.indexOf(kr.toLowerCase())>-1&&gi.push({html:Gn,value:Gn})}),t.hint.genHTML(gi,kr,t),Ne.preventDefault()}},t.wysiwyg.popover.insertAdjacentElement("beforeend",Vr)}se(t,Xt)}else Xt=void 0;if($){t.wysiwyg.popover.innerHTML="";var lt=document.createElement("span");lt.setAttribute("aria-label","ID<"+(0,f.fG)("⌥Enter")+">"),lt.className="vditor-tooltipped vditor-tooltipped__n";var pi=document.createElement("input");lt.appendChild(pi),pi.className="vditor-input",pi.setAttribute("placeholder","ID<"+(0,f.fG)("⌥Enter")+">"),pi.style.width="120px",pi.value=$.getAttribute("data-id")||"",pi.oninput=function(){$.setAttribute("data-id",pi.value),typeof t.options.input=="function"&&t.options.input(x(t))},pi.onkeydown=function(ft){ft.isComposing||Ut(t,ft)||yt(ft,n)},q(n,$,t),ee(n,$,t),te($,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",lt),se(t,$)}if(O&&Ye(t,O,n),!ye&&!o&&!L&&!Xt&&!O&&!wa&&!Zi&&!$&&!K){var Ji=(0,v.Th)(i,"data-block","0");Ji&&Ji.parentElement.isEqualNode(t.wysiwyg.element)?(t.wysiwyg.popover.innerHTML="",q(n,Ji,t),ee(n,Ji,t),te(Ji,t),se(t,Ji)):t.wysiwyg.popover.style.display="none"}t.wysiwyg.element.querySelectorAll('span[data-type="backslash"] > span').forEach(function(Ne){Ne.style.display="none"});var go=(0,v.Th)(n.startContainer,"data-type","backslash");go&&(go.querySelector("span").style.display="inline")}},200)},se=function(t,n){var i=n,a=(0,v._Y)(n,"TABLE");a&&(i=a),t.wysiwyg.popover.style.left="0",t.wysiwyg.popover.style.display="block",t.wysiwyg.popover.style.top=Math.max(-8,i.offsetTop-21-t.wysiwyg.element.scrollTop)+"px",t.wysiwyg.popover.style.left=Math.min(i.offsetLeft,t.wysiwyg.element.clientWidth-t.wysiwyg.popover.clientWidth)+"px",t.wysiwyg.popover.setAttribute("data-top",(i.offsetTop-21).toString())},W=function(t,n,i){i===void 0&&(i=getSelection().getRangeAt(0)),t.wysiwyg.popover.innerHTML="";var a=function(){c.value.trim()!==""&&(n.tagName==="IMG"?n.setAttribute("alt",c.value):n.textContent=c.value),A.value.trim()!==""&&n.setAttribute("data-link-label",A.value),typeof t.options.input=="function"&&t.options.input(x(t))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");o.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),c.style.width="120px",c.value=n.getAttribute("alt")||n.textContent,c.oninput=function(){a()},c.onkeydown=function(O){Ut(t,O)||yt(O,i)||je(t,n,O,A)};var S=document.createElement("span");S.setAttribute("aria-label",window.VditorI18n.linkRef),S.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");S.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.linkRef),A.value=n.getAttribute("data-link-label"),A.oninput=function(){a()},A.onkeydown=function(O){Ut(t,O)||yt(O,i)||je(t,n,O,c)},te(n,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",o),t.wysiwyg.popover.insertAdjacentElement("beforeend",S),se(t,n)},q=function(t,n,i){var a=n.previousElementSibling;if(!(!a||!n.parentElement.isEqualNode(i.wysiwyg.element)&&n.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","up"),o.setAttribute("aria-label",window.VditorI18n.up+"<"+(0,f.fG)("⇧⌘U")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-up"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){t.insertNode(document.createElement("wbr")),a.insertAdjacentElement("beforebegin",n),(0,B.ir)(i.wysiwyg.element,t),ht(i),Qt(i),Dt(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},ee=function(t,n,i){var a=n.nextElementSibling;if(!(!a||!n.parentElement.isEqualNode(i.wysiwyg.element)&&n.tagName!=="LI")){var o=document.createElement("button");o.setAttribute("type","button"),o.setAttribute("data-type","down"),o.setAttribute("aria-label",window.VditorI18n.down+"<"+(0,f.fG)("⇧⌘D")+">"),o.innerHTML='<svg><use xlink:href="#vditor-icon-down"></use></svg>',o.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",o.onclick=function(){t.insertNode(document.createElement("wbr")),a.insertAdjacentElement("afterend",n),(0,B.ir)(i.wysiwyg.element,t),ht(i),Qt(i),Dt(i)},i.wysiwyg.popover.insertAdjacentElement("beforeend",o)}},te=function(t,n){var i=document.createElement("button");i.setAttribute("type","button"),i.setAttribute("data-type","remove"),i.setAttribute("aria-label",window.VditorI18n.remove+"<"+(0,f.fG)("⇧⌘X")+">"),i.innerHTML='<svg><use xlink:href="#vditor-icon-trashcan"></use></svg>',i.className="vditor-icon vditor-tooltipped vditor-tooltipped__n",i.onclick=function(){var a=(0,B.RN)(n);a.setStartAfter(t),(0,B.jl)(a),t.remove(),ht(n),Qt(n),["H1","H2","H3","H4","H5","H6"].includes(t.tagName)&&le(n)},n.wysiwyg.popover.insertAdjacentElement("beforeend",i)},je=function(t,n,i,a){if(!i.isComposing){if(i.key==="Tab"){a.focus(),a.select(),i.preventDefault();return}if(!(0,f._0)(i)&&!i.shiftKey&&i.altKey&&i.key==="Enter"){var o=(0,B.RN)(t);n.insertAdjacentHTML("afterend",u.Y.ZWSP),o.setStartAfter(n.nextSibling),o.collapse(!0),(0,B.jl)(o),i.preventDefault()}}},Ye=function(t,n,i){t.wysiwyg.popover.innerHTML="";var a=function(){c.value.trim()!==""&&(n.innerHTML=c.value),n.setAttribute("href",A.value),n.setAttribute("title",L.value),ht(t)};n.querySelectorAll("[data-marker]").forEach(function($){$.removeAttribute("data-marker")});var o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.textIsNotEmpty),o.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");o.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.textIsNotEmpty),c.style.width="120px",c.value=n.innerHTML||"",c.oninput=function(){a()},c.onkeydown=function($){Ut(t,$)||yt($,i)||je(t,n,$,A)};var S=document.createElement("span");S.setAttribute("aria-label",window.VditorI18n.link),S.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");S.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.link),A.value=n.getAttribute("href")||"",A.oninput=function(){a()},A.onkeydown=function($){Ut(t,$)||yt($,i)||je(t,n,$,L)};var O=document.createElement("span");O.setAttribute("aria-label",window.VditorI18n.tooltipText),O.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");O.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.tooltipText),L.style.width="60px",L.value=n.getAttribute("title")||"",L.oninput=function(){a()},L.onkeydown=function($){Ut(t,$)||yt($,i)||je(t,n,$,c)},te(n,t),t.wysiwyg.popover.insertAdjacentElement("beforeend",o),t.wysiwyg.popover.insertAdjacentElement("beforeend",S),t.wysiwyg.popover.insertAdjacentElement("beforeend",O),se(t,n)},Ze=function(t,n){var i=t.target;n.wysiwyg.popover.innerHTML="";var a=function(){i.setAttribute("src",c.value),i.setAttribute("alt",A.value),i.setAttribute("title",L.value),typeof n.options.input=="function"&&n.options.input(x(n))},o=document.createElement("span");o.setAttribute("aria-label",window.VditorI18n.imageURL),o.className="vditor-tooltipped vditor-tooltipped__n";var c=document.createElement("input");o.appendChild(c),c.className="vditor-input",c.setAttribute("placeholder",window.VditorI18n.imageURL),c.value=i.getAttribute("src")||"",c.oninput=function(){a()},c.onkeydown=function($){Ut(n,$)};var S=document.createElement("span");S.setAttribute("aria-label",window.VditorI18n.alternateText),S.className="vditor-tooltipped vditor-tooltipped__n";var A=document.createElement("input");S.appendChild(A),A.className="vditor-input",A.setAttribute("placeholder",window.VditorI18n.alternateText),A.style.width="52px",A.value=i.getAttribute("alt")||"",A.oninput=function(){a()},A.onkeydown=function($){Ut(n,$)};var O=document.createElement("span");O.setAttribute("aria-label",window.VditorI18n.title),O.className="vditor-tooltipped vditor-tooltipped__n";var L=document.createElement("input");O.appendChild(L),L.className="vditor-input",L.setAttribute("placeholder",window.VditorI18n.title),L.value=i.getAttribute("title")||"",L.oninput=function(){a()},L.onkeydown=function($){Ut(n,$)},te(i,n),n.wysiwyg.popover.insertAdjacentElement("beforeend",o),n.wysiwyg.popover.insertAdjacentElement("beforeend",S),n.wysiwyg.popover.insertAdjacentElement("beforeend",O),se(n,i)},yt=function(t,n){if(!(0,f._0)(t)&&!t.shiftKey&&t.key==="Enter"||t.key==="Escape")return n&&(0,B.jl)(n),t.preventDefault(),t.stopPropagation(),!0},ve=function(t){t.currentMode==="wysiwyg"?Qt(t):t.currentMode==="ir"&&an(t)},Tt=function(t,n,i){i===void 0&&(i={enableAddUndoStack:!0,enableHint:!1,enableInput:!0});var a=t.wysiwyg.element;a.innerHTML=t.lute.Md2VditorDOM(n),a.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(o){rt(o,t),o.previousElementSibling.setAttribute("style","display:none")}),ht(t,i)},Et=function(t,n,i){for(var a=t.startContainer.parentElement,o=!1,c="",S="",A=fn(t),O=A.beforeHTML,L=A.afterHTML;a&&!o;){var $=a.tagName;if($==="STRIKE"&&($="S"),$==="I"&&($="EM"),$==="B"&&($="STRONG"),$==="S"||$==="STRONG"||$==="EM"){var K="",ye="",be="";a.parentElement.getAttribute("data-block")!=="0"&&(ye=Gt(a),be=Vt(a)),(O||ye)&&(K="".concat(ye,"<").concat($,">").concat(O,"</").concat($,">"),O=K),(i==="bold"&&$==="STRONG"||i==="italic"&&$==="EM"||i==="strikeThrough"&&$==="S")&&(K+="".concat(c).concat(u.Y.ZWSP,"<wbr>").concat(S),o=!0),(L||be)&&(L="<".concat($,">").concat(L,"</").concat($,">").concat(be),K+=L),a.parentElement.getAttribute("data-block")!=="0"?(a=a.parentElement,a.innerHTML=K):(a.outerHTML=K,a=a.parentElement),c="<".concat($,">")+c,S="</".concat($,">")+S}else o=!0}(0,B.ir)(n.wysiwyg.element,t)},it=function(t,n,i){if(!(t.wysiwyg.composingLock&&i instanceof CustomEvent)){var a=!0,o=!0;t.wysiwyg.element.querySelector("wbr")&&t.wysiwyg.element.querySelector("wbr").remove();var c=(0,B.RN)(t),S=n.getAttribute("data-type");if(n.classList.contains("vditor-menu--current"))if(S==="strike"&&(S="strikeThrough"),S==="quote"){var A=(0,v._Y)(c.startContainer,"BLOCKQUOTE");A||(A=c.startContainer.childNodes[c.startOffset]),A&&(a=!1,n.classList.remove("vditor-menu--current"),c.insertNode(document.createElement("wbr")),A.outerHTML=A.innerHTML.trim()===""?'<p data-block="0">'.concat(A.innerHTML,"</p>"):A.innerHTML,(0,B.ir)(t.wysiwyg.element,c))}else if(S==="inline-code"){var O=(0,v._Y)(c.startContainer,"CODE");O||(O=c.startContainer.childNodes[c.startOffset]),O&&(O.outerHTML=O.innerHTML.replace(u.Y.ZWSP,"")+"<wbr>",(0,B.ir)(t.wysiwyg.element,c))}else S==="link"?(c.collapsed&&c.selectNode(c.startContainer.parentElement),document.execCommand("unlink",!1,"")):S==="check"||S==="list"||S==="ordered-list"?(xi(t,c,S),(0,B.ir)(t.wysiwyg.element,c),a=!1,n.classList.remove("vditor-menu--current")):(a=!1,n.classList.remove("vditor-menu--current"),c.toString()===""?Et(c,t,S):document.execCommand(S,!1,""));else{t.wysiwyg.element.childNodes.length===0&&(t.wysiwyg.element.innerHTML='<p data-block="0"><wbr></p>',(0,B.ir)(t.wysiwyg.element,c));var L=(0,v.pt)(c.startContainer);if(S==="quote"){if(L||(L=c.startContainer.childNodes[c.startOffset]),L){a=!1,n.classList.add("vditor-menu--current"),c.insertNode(document.createElement("wbr"));var $=(0,v._Y)(c.startContainer,"LI");$&&L.contains($)?$.innerHTML='<blockquote data-block="0">'.concat($.innerHTML,"</blockquote>"):L.outerHTML='<blockquote data-block="0">'.concat(L.outerHTML,"</blockquote>"),(0,B.ir)(t.wysiwyg.element,c)}}else if(S==="check"||S==="list"||S==="ordered-list")xi(t,c,S,!1),(0,B.ir)(t.wysiwyg.element,c),a=!1,b(t.toolbar.elements,["check","list","ordered-list"]),n.classList.add("vditor-menu--current");else if(S==="inline-code"){if(c.toString()===""){var K=document.createElement("code");K.textContent=u.Y.ZWSP,c.insertNode(K),c.setStart(K.firstChild,1),c.collapse(!0),(0,B.jl)(c)}else if(c.startContainer.nodeType===3){var K=document.createElement("code");c.surroundContents(K),c.insertNode(K),(0,B.jl)(c)}n.classList.add("vditor-menu--current")}else if(S==="code"){var K=document.createElement("div");K.className="vditor-wysiwyg__block",K.setAttribute("data-type","code-block"),K.setAttribute("data-block","0"),K.setAttribute("data-marker","```"),c.toString()===""?K.innerHTML=`<pre><code><wbr>
</code></pre>`:(K.innerHTML="<pre><code>".concat(c.toString(),"<wbr></code></pre>"),c.deleteContents()),c.insertNode(K),L&&(L.outerHTML=t.lute.SpinVditorDOM(L.outerHTML)),(0,B.ir)(t.wysiwyg.element,c),t.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(At){rt(At,t)}),n.classList.add("vditor-menu--disabled")}else if(S==="link"){if(c.toString()===""){var ye=document.createElement("a");ye.innerText=u.Y.ZWSP,c.insertNode(ye),c.setStart(ye.firstChild,1),c.collapse(!0),Ye(t,ye,c);var be=t.wysiwyg.popover.querySelector("input");be.value="",be.focus(),o=!1}else{var K=document.createElement("a");K.setAttribute("href",""),K.innerHTML=c.toString(),c.surroundContents(K),c.insertNode(K),(0,B.jl)(c),Ye(t,K,c);var me=t.wysiwyg.popover.querySelectorAll("input");me[0].value=K.innerText,me[1].focus()}a=!1,n.classList.add("vditor-menu--current")}else if(S==="table"){var $e='<table data-block="0"><thead><tr><th>col1<wbr></th><th>col2</th><th>col3</th></tr></thead><tbody><tr><td> </td><td> </td><td> </td></tr><tr><td> </td><td> </td><td> </td></tr></tbody></table>';if(c.toString().trim()==="")L&&L.innerHTML.trim().replace(u.Y.ZWSP,"")===""?L.outerHTML=$e:document.execCommand("insertHTML",!1,$e),c.selectNode(t.wysiwyg.element.querySelector("wbr").previousSibling),t.wysiwyg.element.querySelector("wbr").remove(),(0,B.jl)(c);else{$e='<table data-block="0"><thead><tr>';var Te=c.toString().split(`
`),fe=Te[0].split(",").length>Te[0].split("	").length?",":"	";Te.forEach(function(Xe,At){At===0?(Xe.split(fe).forEach(function(_t,Ot){Ot===0?$e+="<th>".concat(_t,"<wbr></th>"):$e+="<th>".concat(_t,"</th>")}),$e+="</tr></thead>"):(At===1?$e+="<tbody><tr>":$e+="<tr>",Xe.split(fe).forEach(function(_t){$e+="<td>".concat(_t,"</td>")}),$e+="</tr>")}),$e+="</tbody></table>",document.execCommand("insertHTML",!1,$e),(0,B.ir)(t.wysiwyg.element,c)}a=!1,n.classList.add("vditor-menu--disabled")}else if(S==="line"){if(L){var Ke=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;L.innerHTML.trim()===""?L.outerHTML=Ke:L.insertAdjacentHTML("afterend",Ke),(0,B.ir)(t.wysiwyg.element,c)}}else if(a=!1,n.classList.add("vditor-menu--current"),S==="strike"&&(S="strikeThrough"),c.toString()===""&&(S==="bold"||S==="italic"||S==="strikeThrough")){var He="strong";S==="italic"?He="em":S==="strikeThrough"&&(He="s");var K=document.createElement(He);K.textContent=u.Y.ZWSP,c.insertNode(K),K.previousSibling&&K.previousSibling.textContent===u.Y.ZWSP&&(K.previousSibling.textContent=""),c.setStart(K.firstChild,1),c.collapse(!0),(0,B.jl)(c)}else document.execCommand(S,!1,"")}a&&Qt(t),o&&ht(t)}},dt=function(){function t(n,i){var a,o=this;this.element=document.createElement("div"),i.className&&(a=this.element.classList).add.apply(a,i.className.split(" "));var c=i.hotkey?" <".concat((0,f.fG)(i.hotkey),">"):"";i.level===2&&(c=i.hotkey?" &lt;".concat((0,f.fG)(i.hotkey),"&gt;"):"");var S=i.tip?i.tip+c:"".concat(window.VditorI18n[i.name]).concat(c),A=i.name==="upload"?"div":"button";if(i.level===2)this.element.innerHTML="<".concat(A,' data-type="').concat(i.name,'">').concat(S,"</").concat(A,">");else{this.element.classList.add("vditor-toolbar__item");var O=document.createElement(A);O.setAttribute("data-type",i.name),O.className="vditor-tooltipped vditor-tooltipped__".concat(i.tipPosition),O.setAttribute("aria-label",S),O.innerHTML=i.icon,this.element.appendChild(O)}i.prefix&&this.element.children[0].addEventListener((0,f.y3)(),function(L){L.preventDefault(),!o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)&&(n.currentMode==="wysiwyg"?it(n,o.element.children[0],L):n.currentMode==="ir"?Kt(n,o.element.children[0],i.prefix||"",i.suffix||""):Be(n,o.element.children[0],i.prefix||"",i.suffix||""))})}return t}(),Hn=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),wn=function(t,n,i){var a;if(typeof i!="string"?(T(t,["subToolbar","hint"]),i.preventDefault(),a=x(t)):a=i,!(t.currentMode===n&&typeof i!="string")){if(t.devtools&&t.devtools.renderEchart(t),t.options.preview.mode==="both"&&n==="sv"?t.preview.element.style.display="block":t.preview.element.style.display="none",E(t.toolbar.elements,u.Y.EDIT_TOOLBARS),b(t.toolbar.elements,u.Y.EDIT_TOOLBARS),w(t.toolbar.elements,["outdent","indent"]),n==="ir")C(t.toolbar.elements,["both"]),_(t.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),t.sv.element.style.display="none",t.wysiwyg.element.parentElement.style.display="none",t.ir.element.parentElement.style.display="block",t.lute.SetVditorIR(!0),t.lute.SetVditorWYSIWYG(!1),t.lute.SetVditorSV(!1),t.currentMode="ir",t.ir.element.innerHTML=t.lute.Md2VditorIRDOM(a),un(t,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),wt(t),t.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(c){rt(c,t)}),t.ir.element.querySelectorAll(".vditor-toc").forEach(function(c){(0,he.T)(c,{cdn:t.options.cdn,math:t.options.preview.math})});else if(n==="wysiwyg")C(t.toolbar.elements,["both"]),_(t.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),t.sv.element.style.display="none",t.wysiwyg.element.parentElement.style.display="block",t.ir.element.parentElement.style.display="none",t.lute.SetVditorIR(!1),t.lute.SetVditorWYSIWYG(!0),t.lute.SetVditorSV(!1),t.currentMode="wysiwyg",wt(t),Tt(t,a,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),t.wysiwyg.element.querySelectorAll(".vditor-toc").forEach(function(c){(0,he.T)(c,{cdn:t.options.cdn,math:t.options.preview.math})}),t.wysiwyg.popover.style.display="none";else if(n==="sv"){_(t.toolbar.elements,["both"]),C(t.toolbar.elements,["outdent","indent","outline","insert-before","insert-after"]),t.wysiwyg.element.parentElement.style.display="none",t.ir.element.parentElement.style.display="none",(t.options.preview.mode==="both"||t.options.preview.mode==="editor")&&(t.sv.element.style.display="block"),t.lute.SetVditorIR(!1),t.lute.SetVditorWYSIWYG(!1),t.lute.SetVditorSV(!0),t.currentMode="sv";var o=xe(a,t);o==="<div data-block='0'></div>"&&(o=""),t.sv.element.innerHTML=o,ct(t.sv.element),ze(t,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),wt(t)}t.undo.resetIcon(t),typeof i!="string"&&(t[t.currentMode].element.focus(),ve(t)),le(t),nt(t),t.toolbar.elements["edit-mode"]&&(t.toolbar.elements["edit-mode"].querySelectorAll("button").forEach(function(c){c.classList.remove("vditor-menu--current")}),t.toolbar.elements["edit-mode"].querySelector('button[data-mode="'.concat(t.currentMode,'"]')).classList.add("vditor-menu--current")),t.outline.toggle(t,t.currentMode!=="sv"&&t.options.outline.enable,typeof i!="string")}},jt=function(t){Hn(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=document.createElement("div");return c.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),c.innerHTML='<button data-mode="wysiwyg">'.concat(window.VditorI18n.wysiwyg," &lt;").concat((0,f.fG)("⌥⌘7"),`></button>
<button data-mode="ir">`).concat(window.VditorI18n.instantRendering," &lt;").concat((0,f.fG)("⌥⌘8"),`></button>
<button data-mode="sv">`).concat(window.VditorI18n.splitView," &lt;").concat((0,f.fG)("⌥⌘9"),"></button>"),o.element.appendChild(c),o._bindEvent(i,c,a),o}return n.prototype._bindEvent=function(i,a,o){var c=this.element.children[0];M(i,a,c,o.level),a.children.item(0).addEventListener((0,f.y3)(),function(S){wn(i,"wysiwyg",S),S.preventDefault(),S.stopPropagation()}),a.children.item(1).addEventListener((0,f.y3)(),function(S){wn(i,"ir",S),S.preventDefault(),S.stopPropagation()}),a.children.item(2).addEventListener((0,f.y3)(),function(S){wn(i,"sv",S),S.preventDefault(),S.stopPropagation()})},n}(dt),zt=function(t,n){return(0,B.Co)(t,n)?getSelection().toString():""},$t=function(t,n){n.addEventListener("focus",function(){t.options.focus&&t.options.focus(x(t)),T(t,["subToolbar","hint"])})},kn=function(t,n){n.addEventListener("dblclick",function(i){i.target.tagName==="IMG"&&(t.options.image.preview?t.options.image.preview(i.target):t.options.image.isPreview&&(0,pe.o)(i.target,t.options.lang,t.options.theme))})},En=function(t,n){n.addEventListener("blur",function(i){if(t.currentMode==="ir"){var a=t.ir.element.querySelector(".vditor-ir__node--expand");a&&a.classList.remove("vditor-ir__node--expand")}else t.currentMode==="wysiwyg"&&!t.wysiwyg.selectPopover.contains(i.relatedTarget)&&t.wysiwyg.hideComment();t[t.currentMode].range=(0,B.RN)(t),t.options.blur&&t.options.blur(x(t))})},ni=function(t,n){n.addEventListener("dragstart",function(i){i.dataTransfer.setData(u.Y.DROP_EDITOR,u.Y.DROP_EDITOR)}),n.addEventListener("drop",function(i){i.dataTransfer.getData(u.Y.DROP_EDITOR)?st(t):(i.dataTransfer.types.includes("Files")||i.dataTransfer.types.includes("text/html"))&&Ft(t,i,{pasteCode:function(a){document.execCommand("insertHTML",!1,a)}})})},ln=function(t,n,i){n.addEventListener("copy",function(a){return i(a,t)})},Nn=function(t,n,i){n.addEventListener("cut",function(a){i(a,t),t.options.comment.enable&&t.currentMode==="wysiwyg"&&t.wysiwyg.getComments(t),document.execCommand("delete")})},Dt=function(t){if(t.currentMode==="wysiwyg"&&t.options.comment.enable&&t.options.comment.adjustTop(t.wysiwyg.getComments(t,!0)),!!t.options.typewriterMode){var n=t[t.currentMode].element,i=(0,B.Ey)(n).top;t.options.height==="auto"&&!t.element.classList.contains("vditor--fullscreen")&&window.scrollTo(window.scrollX,i+t.element.offsetTop+t.toolbar.element.offsetHeight-window.innerHeight/2+10),(t.options.height!=="auto"||t.element.classList.contains("vditor--fullscreen"))&&(n.scrollTop=i+n.scrollTop-n.clientHeight/2+10)}},cn=function(t,n){n.addEventListener("keydown",function(i){if(!i.isComposing&&t.options.keydown&&t.options.keydown(i),!((t.options.hint.extend.length>1||t.toolbar.elements.emoji)&&t.hint.select(i,t))){if(t.options.comment.enable&&t.currentMode==="wysiwyg"&&(i.key==="Backspace"||Q("⌘X",i))&&t.wysiwyg.getComments(t),t.currentMode==="sv"){if(ot(t,i))return}else if(t.currentMode==="wysiwyg"){if(Nt(t,i))return}else if(t.currentMode==="ir"&&Ve(t,i))return;if(t.options.ctrlEnter&&Q("⌘Enter",i)){t.options.ctrlEnter(x(t)),i.preventDefault();return}if(Q("⌘Z",i)&&!t.toolbar.elements.undo){t.undo.undo(t),i.preventDefault();return}if(Q("⌘Y",i)&&!t.toolbar.elements.redo){t.undo.redo(t),i.preventDefault();return}if(i.key==="Escape"){t.hint.element.style.display==="block"?t.hint.element.style.display="none":t.options.esc&&!i.isComposing&&t.options.esc(x(t)),i.preventDefault();return}if((0,f._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[1-6]$/.test(i.code)){if(t.currentMode==="wysiwyg"){var a=i.code.replace("Digit","H");(0,v._Y)(getSelection().getRangeAt(0).startContainer,a)?Bt(t):hn(t,a),ht(t)}else t.currentMode==="sv"?ut(t,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" "):t.currentMode==="ir"&&An(t,"#".repeat(parseInt(i.code.replace("Digit",""),10))+" ");return i.preventDefault(),!0}if((0,f._0)(i)&&i.altKey&&!i.shiftKey&&/^Digit[7-9]$/.test(i.code))return i.code==="Digit7"?wn(t,"wysiwyg",i):i.code==="Digit8"?wn(t,"ir",i):i.code==="Digit9"&&wn(t,"sv",i),!0;t.options.toolbar.find(function(o){if(!o.hotkey||o.toolbar){if(o.toolbar){var c=o.toolbar.find(function(S){if(!S.hotkey)return!1;if(Q(S.hotkey,i))return t.toolbar.elements[S.name].children[0].dispatchEvent(new CustomEvent((0,f.y3)())),i.preventDefault(),!0});return!!c}return!1}if(Q(o.hotkey,i))return t.toolbar.elements[o.name].children[0].dispatchEvent(new CustomEvent((0,f.y3)())),i.preventDefault(),!0})}})},at=function(t,n){n.addEventListener("selectstart",function(i){n.onmouseup=function(){setTimeout(function(){var a=zt(t[t.currentMode].element);a.trim()?(t.currentMode==="wysiwyg"&&t.options.comment.enable&&(!(0,v.Th)(i.target,"data-type","footnotes-block")&&!(0,v.Th)(i.target,"data-type","link-ref-defs-block")?t.wysiwyg.showComment():t.wysiwyg.hideComment()),t.options.select&&t.options.select(a)):t.currentMode==="wysiwyg"&&t.options.comment.enable&&t.wysiwyg.hideComment()})}})},F=function(t,n){var i=(0,B.RN)(t);i.extractContents(),i.insertNode(document.createTextNode(Lute.Caret)),i.insertNode(document.createTextNode(n));var a=(0,v.Th)(i.startContainer,"data-block","0");a||(a=t.sv.element);var o=t.lute.SpinVditorSVDOM(a.textContent);o="<div data-block='0'>"+o.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",a.isEqualNode(t.sv.element)?a.innerHTML=o:a.outerHTML=o,ct(t.sv.element),(0,B.ir)(t.sv.element,i),Dt(t)},J=function(t,n,i){i===void 0&&(i=!0);var a=t;for(a.nodeType===3&&(a=a.parentElement);a;){if(a.getAttribute("data-type")===n)return a;i?a=a.previousElementSibling:a=a.nextElementSibling}return!1},xe=function(t,n){N("SpinVditorSVDOM",t,"argument",n.options.debugger);var i=n.lute.SpinVditorSVDOM(t);return t="<div data-block='0'>"+i.replace(/<span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span><span data-type="newline"><br \/><span style="display: none">\n<\/span><\/span></g,`<span data-type="newline"><br /><span style="display: none">
</span></span><span data-type="newline"><br /><span style="display: none">
</span></span></div><div data-block="0"><`)+"</div>",N("SpinVditorSVDOM",t,"result",n.options.debugger),t},De=function(t){var n=t.getAttribute("data-type"),i=t.previousElementSibling,a=n&&n!=="text"&&n!=="table"&&n!=="heading-marker"&&n!=="newline"&&n!=="yaml-front-matter-open-marker"&&n!=="yaml-front-matter-close-marker"&&n!=="code-block-info"&&n!=="code-block-close-marker"&&n!=="code-block-open-marker"?t.textContent:"",o=!1;for(n==="newline"&&(o=!0);i&&!o;){var c=i.getAttribute("data-type");if(c==="li-marker"||c==="blockquote-marker"||c==="task-marker"||c==="padding"){var S=i.textContent;if(c==="li-marker"&&(n==="code-block-open-marker"||n==="code-block-info"))a=S.replace(/\S/g," ")+a;else if(n==="code-block-close-marker"&&i.nextElementSibling.isSameNode(t)){var A=J(t,"code-block-open-marker");A&&A.previousElementSibling&&(i=A.previousElementSibling,a=S+a)}else a=S+a}else c==="newline"&&(o=!0);i=i.previousElementSibling}return a},ze=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),n.enableHint&&t.hint.render(t),t.preview.render(t);var i=x(t);typeof t.options.input=="function"&&n.enableInput&&t.options.input(i),t.options.counter.enable&&t.counter.render(t,i),t.options.cache.enable&&(0,f.D)()&&(localStorage.setItem(t.options.cache.id,i),t.options.cache.after&&t.options.cache.after(i)),t.devtools&&t.devtools.renderEchart(t),clearTimeout(t.sv.processTimeoutId),t.sv.processTimeoutId=window.setTimeout(function(){n.enableAddUndoStack&&!t.sv.composingLock&&t.undo.addToUndoStack(t)},t.options.undoDelay)},ut=function(t,n){var i=(0,B.RN)(t),a=(0,D.f)(i.startContainer,"SPAN");a&&a.textContent.trim()!==""&&(n=`
`+n),i.collapse(!0),document.execCommand("insertHTML",!1,n)},Be=function(t,n,i,a){var o=(0,B.RN)(t),c=n.getAttribute("data-type");t.sv.element.childNodes.length===0&&(t.sv.element.innerHTML=`<span data-type="p" data-block="0"><span data-type="text"><wbr></span></span><span data-type="newline"><br><span style="display: none">
</span></span>`,(0,B.ir)(t.sv.element,o));var S=(0,v.pt)(o.startContainer),A=(0,D.f)(o.startContainer,"SPAN");if(S){if(c==="link"){var O=void 0;o.toString()===""?O="".concat(i).concat(Lute.Caret).concat(a):O="".concat(i).concat(o.toString()).concat(a.replace(")",Lute.Caret+")")),document.execCommand("insertHTML",!1,O);return}else if(c==="italic"||c==="bold"||c==="strike"||c==="inline-code"||c==="code"||c==="table"||c==="line"){var O=void 0;o.toString()===""?O="".concat(i).concat(Lute.Caret).concat(c==="code"?"":a):O="".concat(i).concat(o.toString()).concat(Lute.Caret).concat(c==="code"?"":a),c==="table"||c==="code"&&A&&A.textContent!==""?O=`

`+O:c==="line"&&(O=`

`.concat(i,`
`).concat(Lute.Caret)),document.execCommand("insertHTML",!1,O);return}else if((c==="check"||c==="list"||c==="ordered-list"||c==="quote")&&A){var L="* ";c==="check"?L="* [ ] ":c==="ordered-list"?L="1. ":c==="quote"&&(L="> ");var $=J(A,"newline");$?$.insertAdjacentText("afterend",L):S.insertAdjacentText("afterbegin",L),Je(t);return}(0,B.ir)(t.sv.element,o),ze(t)}},Rt=function(t){switch(t.currentMode){case"ir":return t.ir.element;case"wysiwyg":return t.wysiwyg.element;case"sv":return t.sv.element}},en=function(t,n){t.options.upload.setHeaders&&(t.options.upload.headers=t.options.upload.setHeaders()),t.options.upload.headers&&Object.keys(t.options.upload.headers).forEach(function(i){n.setRequestHeader(i,t.options.upload.headers[i])})},pt=function(t,n,i,a){function o(c){return c instanceof i?c:new i(function(S){S(c)})}return new(i||(i=Promise))(function(c,S){function A($){try{L(a.next($))}catch(K){S(K)}}function O($){try{L(a.throw($))}catch(K){S(K)}}function L($){$.done?c($.value):o($.value).then(A,O)}L((a=a.apply(t,n||[])).next())})},xn=function(t,n){var i={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,o,c,S;return S={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function A(L){return function($){return O([L,$])}}function O(L){if(a)throw new TypeError("Generator is already executing.");for(;S&&(S=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(c=L[0]&2?o.return:L[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,L[1])).done)return c;switch(o=0,c&&(L=[L[0]&2,c.value]),L[0]){case 0:case 1:c=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(c=i.trys,!(c=c.length>0&&c[c.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!c||L[1]>c[0]&&L[1]<c[3])){i.label=L[1];break}if(L[0]===6&&i.label<c[1]){i.label=c[1],c=L;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(L);break}c[2]&&i.ops.pop(),i.trys.pop();continue}L=n.call(t,i)}catch($){L=[6,$],o=0}finally{a=c=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},Yn=function(){function t(){this.isUploading=!1,this.element=document.createElement("div"),this.element.className="vditor-upload"}return t}(),ii=function(t,n){t.tip.hide();var i=[],a="",o="";t.options.lang,t.options;for(var c=function(O,L){var $=n[L],K=!0;$.name||(a+="<li>".concat(window.VditorI18n.nameEmpty,"</li>"),K=!1),$.size>t.options.upload.max&&(a+="<li>".concat($.name," ").concat(window.VditorI18n.over," ").concat(t.options.upload.max/1024/1024,"M</li>"),K=!1);var ye=$.name.lastIndexOf("."),be=$.name.substr(ye),me=t.options.upload.filename($.name.substr(0,ye))+be;if(t.options.upload.accept){var $e=t.options.upload.accept.split(",").some(function(Te){var fe=Te.trim();if(fe.indexOf(".")===0){if(be.toLowerCase()===fe.toLowerCase())return!0}else if($.type.split("/")[0]===fe.split("/")[0])return!0;return!1});$e||(a+="<li>".concat($.name," ").concat(window.VditorI18n.fileTypeError,"</li>"),K=!1)}K&&(i.push($),o+="<li>".concat(me," ").concat(window.VditorI18n.uploading,"</li>"))},S=n.length,A=0;A<S;A++)c(S,A);return t.tip.show("<ul>".concat(a).concat(o,"</ul>")),i},jn=function(t,n){var i=Rt(n);i.focus();var a=JSON.parse(t),o="";a.code===1&&(o="".concat(a.msg)),a.data.errFiles&&a.data.errFiles.length>0&&(o="<ul><li>".concat(o,"</li>"),a.data.errFiles.forEach(function(S){var A=S.lastIndexOf("."),O=n.options.upload.filename(S.substr(0,A))+S.substr(A);o+="<li>".concat(O," ").concat(window.VditorI18n.uploadError,"</li>")}),o+="</ul>"),o?n.tip.show(o):n.tip.hide();var c="";Object.keys(a.data.succMap).forEach(function(S){var A=a.data.succMap[S],O=S.lastIndexOf("."),L=S.substr(O),$=n.options.upload.filename(S.substr(0,O))+L;L=L.toLowerCase(),L.indexOf(".wav")===0||L.indexOf(".mp3")===0||L.indexOf(".ogg")===0?n.currentMode==="wysiwyg"?c+=`<div class="vditor-wysiwyg__block" data-type="html-block"
 data-block="0"><pre><code>&lt;audio controls="controls" src="`.concat(A,'"&gt;&lt;/audio&gt;</code></pre><pre class="vditor-wysiwyg__preview" data-render="1"><audio controls="controls" src="').concat(A,`"></audio></pre></div>
`):n.currentMode==="ir"?c+='<audio controls="controls" src="'.concat(A,`"></audio>
`):c+="[".concat($,"](").concat(A,`)
`):L.indexOf(".apng")===0||L.indexOf(".bmp")===0||L.indexOf(".gif")===0||L.indexOf(".ico")===0||L.indexOf(".cur")===0||L.indexOf(".jpg")===0||L.indexOf(".jpeg")===0||L.indexOf(".jfif")===0||L.indexOf(".pjp")===0||L.indexOf(".pjpeg")===0||L.indexOf(".png")===0||L.indexOf(".svg")===0||L.indexOf(".webp")===0?n.currentMode==="wysiwyg"?c+='<img alt="'.concat($,'" src="').concat(A,`">
`):c+="![".concat($,"](").concat(A,`)
`):n.currentMode==="wysiwyg"?c+='<a href="'.concat(A,'">').concat($,`</a>
`):c+="[".concat($,"](").concat(A,`)
`)}),(0,B.jl)(n.upload.range),document.execCommand("insertHTML",!1,c),n.upload.range=getSelection().getRangeAt(0).cloneRange()},$n=function(t,n,i){return pt(void 0,void 0,void 0,function(){var a,o,me,c,S,S,A,O,L,$,K,ye,be,me,$e,Te;return xn(this,function(fe){switch(fe.label){case 0:for(a=[],o=t.options.upload.multiple===!0?n.length:1,me=0;me<o;me++)c=n[me],c instanceof DataTransferItem&&(c=c.getAsFile()),a.push(c);return t.options.upload.handler?[4,t.options.upload.handler(a)]:[3,2];case 1:return S=fe.sent(),i&&(i.value=""),typeof S=="string"?(t.tip.show(S),[2]):[2];case 2:return!t.options.upload.url||!t.upload?(i&&(i.value=""),t.tip.show("please config: options.upload.url"),[2]):t.options.upload.file?[4,t.options.upload.file(a)]:[3,4];case 3:a=fe.sent(),fe.label=4;case 4:if(t.options.upload.validate&&(S=t.options.upload.validate(a),typeof S=="string"))return t.tip.show(S),[2];if(A=Rt(t),t.upload.range=(0,B.RN)(t),O=ii(t,a),O.length===0)return i&&(i.value=""),[2];for(L=new FormData,$=t.options.upload.extraData,K=0,ye=Object.keys($);K<ye.length;K++)be=ye[K],L.append(be,$[be]);for(me=0,$e=O.length;me<$e;me++)L.append(t.options.upload.fieldName,O[me]);return Te=new XMLHttpRequest,Te.open("POST",t.options.upload.url),t.options.upload.token&&Te.setRequestHeader("X-Upload-Token",t.options.upload.token),t.options.upload.withCredentials&&(Te.withCredentials=!0),en(t,Te),t.upload.isUploading=!0,A.setAttribute("contenteditable","false"),Te.onreadystatechange=function(){if(Te.readyState===XMLHttpRequest.DONE){if(t.upload.isUploading=!1,A.setAttribute("contenteditable","true"),Te.status>=200&&Te.status<300)if(t.options.upload.success)t.options.upload.success(A,Te.responseText);else{var Ke=Te.responseText;t.options.upload.format&&(Ke=t.options.upload.format(n,Te.responseText)),jn(Ke,t)}else t.options.upload.error?t.options.upload.error(Te.responseText):t.tip.show(Te.responseText);i&&(i.value=""),t.upload.element.style.display="none"}},Te.upload.onprogress=function(Ke){if(Ke.lengthComputable){var He=Ke.loaded/Ke.total*100;t.upload.element.style.display="block";var Xe=t.upload.element;Xe.style.width=He+"%"}},Te.send(L),[2]}})})},Vi=function(t,n,i){var a,o=(0,v.pt)(n.startContainer);if(o||(o=t.wysiwyg.element),i&&i.inputType!=="formatItalic"&&i.inputType!=="deleteByDrag"&&i.inputType!=="insertFromDrop"&&i.inputType!=="formatBold"&&i.inputType!=="formatRemove"&&i.inputType!=="formatStrikeThrough"&&i.inputType!=="insertUnorderedList"&&i.inputType!=="insertOrderedList"&&i.inputType!=="formatOutdent"&&i.inputType!=="formatIndent"&&i.inputType!==""||!i){var c=In(n.startContainer);c&&c.remove(),t.wysiwyg.element.querySelectorAll("wbr").forEach(function(He){He.remove()}),n.insertNode(document.createElement("wbr")),o.querySelectorAll("[style]").forEach(function(He){He.removeAttribute("style")}),o.querySelectorAll(".vditor-comment").forEach(function(He){He.textContent.trim()===""&&(He.classList.remove("vditor-comment","vditor-comment--focus"),He.removeAttribute("data-cmtids"))}),(a=o.previousElementSibling)===null||a===void 0||a.querySelectorAll(".vditor-comment").forEach(function(He){He.textContent.trim()===""&&(He.classList.remove("vditor-comment","vditor-comment--focus"),He.removeAttribute("data-cmtids"))});var S="";o.getAttribute("data-type")==="link-ref-defs-block"&&(o=t.wysiwyg.element);var A=o.isEqualNode(t.wysiwyg.element),O=(0,v.Th)(o,"data-type","footnotes-block");if(A)S=o.innerHTML;else{var L=(0,v.KR)(n.startContainer);if(L&&!O){var $=(0,D.f)(n.startContainer,"BLOCKQUOTE");$?o=(0,v.pt)(n.startContainer)||o:o=L}if(O&&(o=O),S=o.outerHTML,o.tagName==="UL"||o.tagName==="OL"){var K=o.previousElementSibling,ye=o.nextElementSibling;K&&(K.tagName==="UL"||K.tagName==="OL")&&(S=K.outerHTML+S,K.remove()),ye&&(ye.tagName==="UL"||ye.tagName==="OL")&&(S=S+ye.outerHTML,ye.remove()),S=S.replace("<div><wbr><br></div>","<li><p><wbr><br></p></li>")}o.innerText.startsWith("```")||(t.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']").forEach(function(He){He&&!o.isEqualNode(He)&&(S+=He.outerHTML,He.remove())}),t.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']").forEach(function(He){He&&!o.isEqualNode(He)&&(S+=He.outerHTML,He.remove())}))}if(S=S.replace(/<\/(strong|b)><strong data-marker="\W{2}">/g,"").replace(/<\/(em|i)><em data-marker="\W{1}">/g,"").replace(/<\/(s|strike)><s data-marker="~{1,2}">/g,""),S==='<p data-block="0">```<wbr></p>'&&t.hint.recentLanguage&&(S='<p data-block="0">```<wbr></p>'.replace("```","```"+t.hint.recentLanguage)),N("SpinVditorDOM",S,"argument",t.options.debugger),S=t.lute.SpinVditorDOM(S),N("SpinVditorDOM",S,"result",t.options.debugger),A)o.innerHTML=S;else if(o.outerHTML=S,O){var be=(0,v.Ab)(t.wysiwyg.element.querySelector("wbr"),"LI");if(be){var me=t.wysiwyg.element.querySelector('sup[data-type="footnotes-ref"][data-footnotes-label="'.concat(be.getAttribute("data-marker"),'"]'));me&&me.setAttribute("aria-label",be.textContent.trim().substr(0,24))}}var $e,Te=t.wysiwyg.element.querySelectorAll("[data-type='link-ref-defs-block']");Te.forEach(function(He,Xe){Xe===0?$e=He:($e.insertAdjacentHTML("beforeend",He.innerHTML),He.remove())}),Te.length>0&&t.wysiwyg.element.insertAdjacentElement("beforeend",Te[0]);var fe,Ke=t.wysiwyg.element.querySelectorAll("[data-type='footnotes-block']");Ke.forEach(function(He,Xe){Xe===0?fe=He:(fe.insertAdjacentHTML("beforeend",He.innerHTML),He.remove())}),Ke.length>0&&t.wysiwyg.element.insertAdjacentElement("beforeend",Ke[0]),(0,B.ir)(t.wysiwyg.element,n),t.wysiwyg.element.querySelectorAll(".vditor-wysiwyg__preview[data-render='2']").forEach(function(He){rt(He,t)}),i&&(i.inputType==="deleteContentBackward"||i.inputType==="deleteContentForward")&&t.options.comment.enable&&(t.wysiwyg.triggerRemoveComment(t),t.options.comment.adjustTop(t.wysiwyg.getComments(t,!0)))}le(t),ht(t,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0})},ba=function(t,n){return Object.defineProperty?Object.defineProperty(t,"raw",{value:n}):t.raw=n,t},jr=function(t,n,i,a){function o(c){return c instanceof i?c:new i(function(S){S(c)})}return new(i||(i=Promise))(function(c,S){function A($){try{L(a.next($))}catch(K){S(K)}}function O($){try{L(a.throw($))}catch(K){S(K)}}function L($){$.done?c($.value):o($.value).then(A,O)}L((a=a.apply(t,n||[])).next())})},ki=function(t,n){var i={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,o,c,S;return S={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function A(L){return function($){return O([L,$])}}function O(L){if(a)throw new TypeError("Generator is already executing.");for(;S&&(S=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(c=L[0]&2?o.return:L[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,L[1])).done)return c;switch(o=0,c&&(L=[L[0]&2,c.value]),L[0]){case 0:case 1:c=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(c=i.trys,!(c=c.length>0&&c[c.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!c||L[1]>c[0]&&L[1]<c[3])){i.label=L[1];break}if(L[0]===6&&i.label<c[1]){i.label=c[1],c=L;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(L);break}c[2]&&i.ops.pop(),i.trys.pop();continue}L=n.call(t,i)}catch($){L=[6,$],o=0}finally{a=c=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},qi=function(t,n,i){if(t.keyCode===229&&t.code===""&&t.key==="Unidentified"&&n.currentMode!=="sv"){var a=(0,v.pt)(i);if(a&&a.textContent.trim()==="")return n[n.currentMode].composingLock=!0,!1}return!0},pr=function(t,n,i){if(!(i.key==="Enter"||i.key==="Tab"||i.key==="Backspace"||i.key.indexOf("Arrow")>-1||(0,f._0)(i)||i.key==="Escape"||i.shiftKey||i.altKey)){var a=(0,v._Y)(t.startContainer,"P")||(0,v._Y)(t.startContainer,"LI");if(a&&(0,B.ED)(a,n[n.currentMode].element,t).start===0){a.nodeValue&&(a.nodeValue=a.nodeValue.replace(/\u2006/g,""));var o=document.createTextNode(u.Y.ZWSP);t.insertNode(o),t.setStartAfter(o)}}},mr=function(t,n){if(n==="ArrowDown"||n==="ArrowUp"){var i=(0,v.Th)(t.startContainer,"data-type","math-inline")||(0,v.Th)(t.startContainer,"data-type","html-entity")||(0,v.Th)(t.startContainer,"data-type","html-inline");i&&(n==="ArrowDown"&&t.setStartAfter(i.parentElement),n==="ArrowUp"&&t.setStartBefore(i.parentElement))}},fi=function(t,n){var i=(0,B.RN)(t),a=(0,v.pt)(i.startContainer);a&&(a.insertAdjacentHTML(n,'<p data-block="0">'.concat(u.Y.ZWSP,`<wbr>
</p>`)),(0,B.ir)(t[t.currentMode].element,i),ve(t),st(t))},$r=function(t){var n=(0,v._Y)(t,"TABLE");return n&&n.rows[0].cells[0].isSameNode(t)?n:!1},gr=function(t){var n=(0,v._Y)(t,"TABLE");return n&&n.lastElementChild.lastElementChild.lastElementChild.isSameNode(t)?n:!1},Br=function(t,n,i){i===void 0&&(i=!0);var a=t.previousElementSibling;return a||(t.parentElement.previousElementSibling?a=t.parentElement.previousElementSibling.lastElementChild:t.parentElement.parentElement.tagName==="TBODY"&&t.parentElement.parentElement.previousElementSibling?a=t.parentElement.parentElement.previousElementSibling.lastElementChild.lastElementChild:a=null),a&&(n.selectNodeContents(a),i||n.collapse(!1),(0,B.jl)(n)),a},Ei=function(t,n,i,a,o){var c=(0,B.ED)(a,t[t.currentMode].element,i);if(n.key==="ArrowDown"&&a.textContent.trimRight().substr(c.start).indexOf(`
`)===-1||n.key==="ArrowRight"&&c.start>=a.textContent.trimRight().length){var S=o.nextElementSibling;return!S||S&&(S.tagName==="TABLE"||S.getAttribute("data-type"))?(o.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,B.ir)(t[t.currentMode].element,i)):(i.selectNodeContents(S),i.collapse(!0),(0,B.jl)(i)),n.preventDefault(),!0}return!1},ri=function(t,n,i,a,o){var c=(0,B.ED)(a,t[t.currentMode].element,i);if(n.key==="ArrowUp"&&a.textContent.substr(0,c.start).indexOf(`
`)===-1||(n.key==="ArrowLeft"||n.key==="Backspace"&&i.toString()==="")&&c.start===0){var S=o.previousElementSibling;return!S||S&&(S.tagName==="TABLE"||S.getAttribute("data-type"))?(o.insertAdjacentHTML("beforebegin",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,B.ir)(t[t.currentMode].element,i)):(i.selectNodeContents(S),i.collapse(!1),(0,B.jl)(i)),n.preventDefault(),!0}return!1},xi=function(t,n,i,a){a===void 0&&(a=!0);var o=(0,v._Y)(n.startContainer,"LI");if(t[t.currentMode].element.querySelectorAll("wbr").forEach(function($){$.remove()}),n.insertNode(document.createElement("wbr")),a&&o){for(var c="",S=0;S<o.parentElement.childElementCount;S++){var A=o.parentElement.children[S].querySelector("input");A&&A.remove(),c+='<p data-block="0">'.concat(o.parentElement.children[S].innerHTML.trimLeft(),"</p>")}o.parentElement.insertAdjacentHTML("beforebegin",c),o.parentElement.remove()}else if(o)if(i==="check")o.parentElement.querySelectorAll("li").forEach(function($){$.insertAdjacentHTML("afterbegin",'<input type="checkbox" />'.concat($.textContent.indexOf(" ")===0?"":" ")),$.classList.add("vditor-task")});else{o.querySelector("input")&&o.parentElement.querySelectorAll("li").forEach(function($){$.querySelector("input").remove(),$.classList.remove("vditor-task")});var L=void 0;i==="list"?(L=document.createElement("ul"),L.setAttribute("data-marker","*")):(L=document.createElement("ol"),L.setAttribute("data-marker","1.")),L.setAttribute("data-block","0"),L.setAttribute("data-tight",o.parentElement.getAttribute("data-tight")),L.innerHTML=o.parentElement.innerHTML,o.parentElement.parentNode.replaceChild(L,o.parentElement)}else{var O=(0,v.Th)(n.startContainer,"data-block","0");O||(t[t.currentMode].element.querySelector("wbr").remove(),O=t[t.currentMode].element.querySelector("p"),O.innerHTML="<wbr>"),i==="check"?(O.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li class="vditor-task"><input type="checkbox" /> '.concat(O.innerHTML,"</li></ul>")),O.remove()):i==="list"?(O.insertAdjacentHTML("beforebegin",'<ul data-block="0"><li>'.concat(O.innerHTML,"</li></ul>")),O.remove()):i==="ordered-list"&&(O.insertAdjacentHTML("beforebegin",'<ol data-block="0"><li>'.concat(O.innerHTML,"</li></ol>")),O.remove())}},vr=function(t,n,i){var a=n.previousElementSibling;if(n&&a){var o=[n];Array.from(i.cloneContents().children).forEach(function(O,L){O.nodeType!==3&&n&&O.textContent.trim()!==""&&n.getAttribute("data-node-id")===O.getAttribute("data-node-id")&&(L!==0&&o.push(n),n=n.nextElementSibling)}),t[t.currentMode].element.querySelectorAll("wbr").forEach(function(O){O.remove()}),i.insertNode(document.createElement("wbr"));var c=a.parentElement,S="";o.forEach(function(O){var L=O.getAttribute("data-marker");L.length!==1&&(L="1".concat(L.slice(-1))),S+='<li data-node-id="'.concat(O.getAttribute("data-node-id"),'" data-marker="').concat(L,'">').concat(O.innerHTML,"</li>"),O.remove()}),a.insertAdjacentHTML("beforeend","<".concat(c.tagName,' data-block="0">').concat(S,"</").concat(c.tagName,">")),t.currentMode==="wysiwyg"?c.outerHTML=t.lute.SpinVditorDOM(c.outerHTML):c.outerHTML=t.lute.SpinVditorIRDOM(c.outerHTML),(0,B.ir)(t[t.currentMode].element,i);var A=(0,v.KR)(i.startContainer);A&&A.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='2']")).forEach(function(O){rt(O,t),t.currentMode==="wysiwyg"&&O.previousElementSibling.setAttribute("style","display:none")}),st(t),ve(t)}else t[t.currentMode].element.focus()},Wi=function(t,n,i,a){var o=(0,v._Y)(n.parentElement,"LI");if(o){t[t.currentMode].element.querySelectorAll("wbr").forEach(function(K){K.remove()}),i.insertNode(document.createElement("wbr"));var c=n.parentElement,S=c.cloneNode(),A=[n];Array.from(i.cloneContents().children).forEach(function(K,ye){K.nodeType!==3&&n&&K.textContent.trim()!==""&&n.getAttribute("data-node-id")===K.getAttribute("data-node-id")&&(ye!==0&&A.push(n),n=n.nextElementSibling)});var O=!1,L="";c.querySelectorAll("li").forEach(function(K){O&&(L+=K.outerHTML,!K.nextElementSibling&&!K.previousElementSibling?K.parentElement.remove():K.remove()),K.isSameNode(A[A.length-1])&&(O=!0)}),A.reverse().forEach(function(K){o.insertAdjacentElement("afterend",K)}),L&&(S.innerHTML=L,A[0].insertAdjacentElement("beforeend",S)),t.currentMode==="wysiwyg"?a.outerHTML=t.lute.SpinVditorDOM(a.outerHTML):a.outerHTML=t.lute.SpinVditorIRDOM(a.outerHTML),(0,B.ir)(t[t.currentMode].element,i);var $=(0,v.KR)(i.startContainer);$&&$.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='2']")).forEach(function(K){rt(K,t),t.currentMode==="wysiwyg"&&K.previousElementSibling.setAttribute("style","display:none")}),st(t),ve(t)}else t[t.currentMode].element.focus()},Si=function(t,n){for(var i=getSelection().getRangeAt(0).startContainer.parentElement,a=t.rows[0].cells.length,o=t.rows.length,c=0,S=0;S<o;S++)for(var A=0;A<a;A++)if(t.rows[S].cells[A].isSameNode(i)){c=A;break}for(var O=0;O<o;O++)t.rows[O].cells[c].setAttribute("align",n)},Yi=function(t){var n=t.trimRight().split(`
`).pop();return n===""?!1:(n.replace(/ |-/g,"")===""||n.replace(/ |_/g,"")===""||n.replace(/ |\*/g,"")==="")&&n.replace(/ /g,"").length>2?!(n.indexOf("-")>-1&&n.trimLeft().indexOf(" ")===-1&&t.trimRight().split(`
`).length>1||n.indexOf("    ")===0||n.indexOf("	")===0):!1},br=function(t){var n=t.trimRight().split(`
`);return t=n.pop(),t.indexOf("    ")===0||t.indexOf("	")===0||(t=t.trimLeft(),t===""||n.length===0)?!1:t.replace(/-/g,"")===""||t.replace(/=/g,"")===""},st=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),t.currentMode==="wysiwyg"?ht(t,n):t.currentMode==="ir"?un(t,n):t.currentMode==="sv"&&ze(t,n)},yr=function(t,n,i,a){var o,c=t.startContainer,S=(0,v._Y)(c,"LI");if(S){if(!(0,f._0)(a)&&!a.altKey&&a.key==="Enter"&&!a.shiftKey&&i&&S.contains(i)&&i.nextElementSibling)return S&&!S.textContent.endsWith(`
`)&&S.insertAdjacentText("beforeend",`
`),t.insertNode(document.createTextNode(`

`)),t.collapse(!1),st(n),a.preventDefault(),!0;if(!(0,f._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&!S.previousElementSibling&&t.toString()===""&&(0,B.ED)(S,n[n.currentMode].element,t).start===0)return S.nextElementSibling?(S.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(S.innerHTML,"</p>")),S.remove()):S.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(S.innerHTML,"</p>"),(0,B.ir)(n[n.currentMode].element,t),st(n),a.preventDefault(),!0;if(!(0,f._0)(a)&&!a.shiftKey&&!a.altKey&&a.key==="Backspace"&&S.textContent.trim().replace(u.Y.ZWSP,"")===""&&t.toString()===""&&((o=S.previousElementSibling)===null||o===void 0?void 0:o.tagName)==="LI")return S.previousElementSibling.insertAdjacentText("beforeend",`

`),t.selectNodeContents(S.previousElementSibling),t.collapse(!1),S.remove(),(0,B.ir)(n[n.currentMode].element,t),st(n),a.preventDefault(),!0;if(!(0,f._0)(a)&&!a.altKey&&a.key==="Tab"){var A=!1;if((t.startOffset===0&&(c.nodeType===3&&!c.previousSibling||c.nodeType!==3&&c.nodeName==="LI")||S.classList.contains("vditor-task")&&t.startOffset===1&&c.previousSibling.nodeType!==3&&c.previousSibling.tagName==="INPUT")&&(A=!0),A||t.toString()!=="")return a.shiftKey?Wi(n,S,t,S.parentElement):vr(n,S,t),a.preventDefault(),!0}}return!1},Ci=function(t,n,i){if(t.options.tab&&i.key==="Tab")return i.shiftKey||(n.toString()===""?(n.insertNode(document.createTextNode(t.options.tab)),n.collapse(!1)):(n.extractContents(),n.insertNode(document.createTextNode(t.options.tab)),n.collapse(!1))),(0,B.jl)(n),st(t),i.preventDefault(),!0},Ur=function(t,n,i,a){if(i){if(!(0,f._0)(t)&&!t.altKey&&t.key==="Enter"){var o=String.raw(Bn||(Bn=ba(["",""],["",""])),i.textContent).replace(/\\\|/g,"").trim(),c=o.split("|");if(o.startsWith("|")&&o.endsWith("|")&&c.length>3){var S=c.map(function(){return"---"}).join("|");return S=i.textContent+`
`+S.substring(3,S.length-3)+`
|<wbr>`,i.outerHTML=n.lute.SpinVditorDOM(S),(0,B.ir)(n[n.currentMode].element,a),st(n),Dt(n),t.preventDefault(),!0}if(Yi(i.innerHTML)&&i.previousElementSibling){var A="",O=i.innerHTML.trimRight().split(`
`);return O.length>1&&(O.pop(),A='<p data-block="0">'.concat(O.join(`
`),"</p>")),i.insertAdjacentHTML("afterend","".concat(A,`<hr data-block="0"><p data-block="0"><wbr>
</p>`)),i.remove(),(0,B.ir)(n[n.currentMode].element,a),st(n),Dt(n),t.preventDefault(),!0}if(br(i.innerHTML))return n.currentMode==="wysiwyg"?i.outerHTML=n.lute.SpinVditorDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`):i.outerHTML=n.lute.SpinVditorIRDOM(i.innerHTML+`<p data-block="0"><wbr>
</p>`),(0,B.ir)(n[n.currentMode].element,a),st(n),Dt(n),t.preventDefault(),!0}if(a.collapsed&&i.previousElementSibling&&t.key==="Backspace"&&!(0,f._0)(t)&&!t.altKey&&!t.shiftKey&&i.textContent.trimRight().split(`
`).length>1&&(0,B.ED)(i,n[n.currentMode].element,a).start===0){var L=(0,v.Rp)(i.previousElementSibling);return L.textContent.endsWith(`
`)||(L.textContent=L.textContent+`
`),L.parentElement.insertAdjacentHTML("beforeend","<wbr>".concat(i.innerHTML)),i.remove(),(0,B.ir)(n[n.currentMode].element,a),!1}return!1}},Ki=function(t,n,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');i.tagName==="TH"?i.parentElement.parentElement.insertAdjacentHTML("afterend","<tbody><tr>".concat(a,"</tr></tbody>")):i.parentElement.insertAdjacentHTML("afterend","<tr>".concat(a,"</tr>")),st(t)},_i=function(t,n,i){for(var a="",o=0;o<i.parentElement.childElementCount;o++)i.tagName==="TH"?a+='<th align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </th>'):a+='<td align="'.concat(i.parentElement.children[o].getAttribute("align"),'"> </td>');if(i.tagName==="TH"){i.parentElement.parentElement.insertAdjacentHTML("beforebegin","<thead><tr>".concat(a,"</tr></thead>")),n.insertNode(document.createElement("wbr"));var c=i.parentElement.innerHTML.replace(/<th>/g,"<td>").replace(/<\/th>/g,"</td>");i.parentElement.parentElement.nextElementSibling.insertAdjacentHTML("afterbegin",c),i.parentElement.parentElement.remove(),(0,B.ir)(t.ir.element,n)}else i.parentElement.insertAdjacentHTML("beforebegin","<tr>".concat(a,"</tr>"));st(t)},Gi=function(t,n,i,a){a===void 0&&(a="afterend");for(var o=0,c=i.previousElementSibling;c;)o++,c=c.previousElementSibling;for(var S=0;S<n.rows.length;S++)S===0?n.rows[S].cells[o].insertAdjacentHTML(a,"<th> </th>"):n.rows[S].cells[o].insertAdjacentHTML(a,"<td> </td>");st(t)},zr=function(t,n,i){if(i.tagName==="TD"){var a=i.parentElement.parentElement;i.parentElement.previousElementSibling?n.selectNodeContents(i.parentElement.previousElementSibling.lastElementChild):n.selectNodeContents(a.previousElementSibling.lastElementChild.lastElementChild),a.childElementCount===1?a.remove():i.parentElement.remove(),n.collapse(!1),(0,B.jl)(n),st(t)}},R=function(t,n,i,a){for(var o=0,c=a.previousElementSibling;c;)o++,c=c.previousElementSibling;(a.previousElementSibling||a.nextElementSibling)&&(n.selectNodeContents(a.previousElementSibling||a.nextElementSibling),n.collapse(!0));for(var S=0;S<i.rows.length;S++){var A=i.rows[S].cells;if(A.length===1){i.remove(),ve(t);break}A[o].remove()}(0,B.jl)(n),st(t)},P=function(t,n,i){var a=i.startContainer,o=(0,v._Y)(a,"TD")||(0,v._Y)(a,"TH");if(o){if(!(0,f._0)(n)&&!n.altKey&&n.key==="Enter"){(!o.lastElementChild||o.lastElementChild&&(!o.lastElementChild.isSameNode(o.lastChild)||o.lastElementChild.tagName!=="BR"))&&o.insertAdjacentHTML("beforeend","<br>");var c=document.createElement("br");return i.insertNode(c),i.setStartAfter(c),st(t),Dt(t),n.preventDefault(),!0}if(n.key==="Tab"){if(n.shiftKey)return Br(o,i),n.preventDefault(),!0;var S=o.nextElementSibling;return S||(o.parentElement.nextElementSibling?S=o.parentElement.nextElementSibling.firstElementChild:o.parentElement.parentElement.tagName==="THEAD"&&o.parentElement.parentElement.nextElementSibling?S=o.parentElement.parentElement.nextElementSibling.firstElementChild.firstElementChild:S=null),S&&(i.selectNodeContents(S),(0,B.jl)(i)),n.preventDefault(),!0}var A=o.parentElement.parentElement.parentElement;if(n.key==="ArrowUp"){if(n.preventDefault(),o.tagName==="TH")return A.previousElementSibling?(i.selectNodeContents(A.previousElementSibling),i.collapse(!1),(0,B.jl)(i)):fi(t,"beforebegin"),!0;for(var O=0,L=o.parentElement;O<L.cells.length&&!L.cells[O].isSameNode(o);O++);var $=L.previousElementSibling;return $||($=L.parentElement.previousElementSibling.firstChild),i.selectNodeContents($.cells[O]),i.collapse(!1),(0,B.jl)(i),!0}if(n.key==="ArrowDown"){n.preventDefault();var L=o.parentElement;if(!L.nextElementSibling&&o.tagName==="TD")return A.nextElementSibling?(i.selectNodeContents(A.nextElementSibling),i.collapse(!0),(0,B.jl)(i)):fi(t,"afterend"),!0;for(var O=0;O<L.cells.length&&!L.cells[O].isSameNode(o);O++);var S=L.nextElementSibling;return S||(S=L.parentElement.nextElementSibling.firstChild),i.selectNodeContents(S.cells[O]),i.collapse(!0),(0,B.jl)(i),!0}if(t.currentMode==="wysiwyg"&&!(0,f._0)(n)&&n.key==="Enter"&&!n.shiftKey&&n.altKey){var K=t.wysiwyg.popover.querySelector(".vditor-input");return K.focus(),K.select(),n.preventDefault(),!0}if(!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&n.key==="Backspace"&&i.startOffset===0&&i.toString()===""){var ye=Br(o,i,!1);return!ye&&A&&(A.textContent.trim()===""?(A.outerHTML=`<p data-block="0"><wbr>
</p>`,(0,B.ir)(t[t.currentMode].element,i)):(i.setStartBefore(A),i.collapse(!0)),st(t)),n.preventDefault(),!0}if(Q("⇧⌘F",n))return _i(t,i,o),n.preventDefault(),!0;if(Q("⌘=",n))return Ki(t,i,o),n.preventDefault(),!0;if(Q("⇧⌘G",n))return Gi(t,A,o,"beforebegin"),n.preventDefault(),!0;if(Q("⇧⌘=",n))return Gi(t,A,o),n.preventDefault(),!0;if(Q("⌘-",n))return zr(t,i,o),n.preventDefault(),!0;if(Q("⇧⌘-",n))return R(t,i,A,o),n.preventDefault(),!0;if(Q("⇧⌘L",n)){if(t.currentMode==="ir")return Si(A,"left"),st(t),n.preventDefault(),!0;var be=t.wysiwyg.popover.querySelector('[data-type="left"]');if(be)return be.click(),n.preventDefault(),!0}if(Q("⇧⌘C",n)){if(t.currentMode==="ir")return Si(A,"center"),st(t),n.preventDefault(),!0;var be=t.wysiwyg.popover.querySelector('[data-type="center"]');if(be)return be.click(),n.preventDefault(),!0}if(Q("⇧⌘R",n)){if(t.currentMode==="ir")return Si(A,"right"),st(t),n.preventDefault(),!0;var be=t.wysiwyg.popover.querySelector('[data-type="right"]');if(be)return be.click(),n.preventDefault(),!0}}return!1},V=function(t,n,i,a){if(i.tagName==="PRE"&&Q("⌘A",n))return a.selectNodeContents(i.firstElementChild),n.preventDefault(),!0;if(t.options.tab&&n.key==="Tab"&&!n.shiftKey&&a.toString()==="")return a.insertNode(document.createTextNode(t.options.tab)),a.collapse(!1),st(t),n.preventDefault(),!0;if(n.key==="Backspace"&&!(0,f._0)(n)&&!n.shiftKey&&!n.altKey){var o=(0,B.ED)(i,t[t.currentMode].element,a);if((o.start===0||o.start===1&&i.innerText===`
`)&&a.toString()==="")return i.parentElement.outerHTML='<p data-block="0"><wbr>'.concat(i.firstElementChild.innerHTML,"</p>"),(0,B.ir)(t[t.currentMode].element,a),st(t),n.preventDefault(),!0}return!(0,f._0)(n)&&!n.altKey&&n.key==="Enter"?(i.firstElementChild.textContent.endsWith(`
`)||i.firstElementChild.insertAdjacentText("beforeend",`
`),a.extractContents(),a.insertNode(document.createTextNode(`
`)),a.collapse(!1),(0,B.jl)(a),(0,f.gm)()||(t.currentMode==="wysiwyg"?Vi(t,a):Ge(t,a)),Dt(t),n.preventDefault(),!0):!1},ae=function(t,n,i,a){var o=n.startContainer,c=(0,v._Y)(o,"BLOCKQUOTE");if(c&&n.toString()===""){if(i.key==="Backspace"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey&&(0,B.ED)(c,t[t.currentMode].element,n).start===0)return n.insertNode(document.createElement("wbr")),c.outerHTML=c.innerHTML,(0,B.ir)(t[t.currentMode].element,n),st(t),i.preventDefault(),!0;if(a&&i.key==="Enter"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey&&a.parentElement.tagName==="BLOCKQUOTE"){var S=!1;if(a.innerHTML.replace(u.Y.ZWSP,"")===`
`||a.innerHTML.replace(u.Y.ZWSP,"")===""?(S=!0,a.remove()):a.innerHTML.endsWith(`

`)&&(0,B.ED)(a,t[t.currentMode].element,n).start===a.textContent.length-1&&(a.innerHTML=a.innerHTML.substr(0,a.innerHTML.length-2),S=!0),S)return c.insertAdjacentHTML("afterend",'<p data-block="0">'.concat(u.Y.ZWSP,`<wbr>
</p>`)),(0,B.ir)(t[t.currentMode].element,n),st(t),i.preventDefault(),!0}var A=(0,v.pt)(o);if(t.currentMode==="wysiwyg"&&A&&Q("⇧⌘;",i))return n.insertNode(document.createElement("wbr")),A.outerHTML='<blockquote data-block="0">'.concat(A.outerHTML,"</blockquote>"),(0,B.ir)(t.wysiwyg.element,n),ht(t),i.preventDefault(),!0;if(Ei(t,i,n,c,c)||ri(t,i,n,c,c))return!0}return!1},de=function(t,n,i){var a=n.startContainer,o=(0,v._Y)(a,"li");if(o&&o.classList.contains("vditor-task")){if(Q("⇧⌘J",i)){var c=o.firstElementChild;return c.checked?c.removeAttribute("checked"):c.setAttribute("checked","checked"),st(t),i.preventDefault(),!0}if(i.key==="Backspace"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey&&n.toString()===""&&n.startOffset===1&&(a.nodeType===3&&a.previousSibling&&a.previousSibling.tagName==="INPUT"||a.nodeType!==3)){var S=o.previousElementSibling;if(o.querySelector("input").remove(),S){var A=(0,v.Rp)(S);A.parentElement.insertAdjacentHTML("beforeend","<wbr>"+o.innerHTML.trim()),o.remove()}else o.parentElement.insertAdjacentHTML("beforebegin",'<p data-block="0"><wbr>'.concat(o.innerHTML.trim()||`
`,"</p>")),o.nextElementSibling?o.remove():o.parentElement.remove();return(0,B.ir)(t[t.currentMode].element,n),st(t),i.preventDefault(),!0}if(i.key==="Enter"&&!(0,f._0)(i)&&!i.shiftKey&&!i.altKey){if(o.textContent.trim()==="")if((0,v.KJ)(o.parentElement,"vditor-task")){var O=(0,v.KR)(a);O&&Wi(t,o,n,O)}else if(o.nextElementSibling){var L="",$="",K=!1;Array.from(o.parentElement.children).forEach(function($e){o.isSameNode($e)?K=!0:K?L+=$e.outerHTML:$+=$e.outerHTML});var ye=o.parentElement.tagName,be=o.parentElement.tagName==="OL"?"":' data-marker="'.concat(o.parentElement.getAttribute("data-marker"),'"'),me="";$&&(me=o.parentElement.tagName==="UL"?"":' start="1"',$="<".concat(ye,' data-tight="true"').concat(be,' data-block="0">').concat($,"</").concat(ye,">")),o.parentElement.outerHTML="".concat($,`<p data-block="0"><wbr>
</p><`).concat(ye,`
 data-tight="true"`).concat(be,' data-block="0"').concat(me,">").concat(L,"</").concat(ye,">")}else o.parentElement.insertAdjacentHTML("afterend",`<p data-block="0"><wbr>
</p>`),o.parentElement.querySelectorAll("li").length===1?o.parentElement.remove():o.remove();else a.nodeType!==3&&n.startOffset===0&&a.firstChild.tagName==="INPUT"?n.setStart(a.childNodes[1],1):(n.setEndAfter(o.lastChild),o.insertAdjacentHTML("afterend",'<li class="vditor-task" data-marker="'.concat(o.getAttribute("data-marker"),'"><input type="checkbox"> <wbr></li>')),document.querySelector("wbr").after(n.extractContents()));return(0,B.ir)(t[t.currentMode].element,n),st(t),Dt(t),i.preventDefault(),!0}}return!1},Ee=function(t,n,i,a){if(n.startContainer.nodeType!==3){var o=n.startContainer.children[n.startOffset];if(o&&o.tagName==="HR")return n.selectNodeContents(o.previousElementSibling),n.collapse(!1),i.preventDefault(),!0}if(a){var c=a.previousElementSibling;if(c&&(0,B.ED)(a,t[t.currentMode].element,n).start===0&&((0,f.gm)()&&c.tagName==="HR"||c.tagName==="TABLE")){if(c.tagName==="TABLE"){var S=c.lastElementChild.lastElementChild.lastElementChild;S.innerHTML=S.innerHTML.trimLeft()+"<wbr>"+a.textContent.trim(),a.remove()}else c.remove();return(0,B.ir)(t[t.currentMode].element,n),st(t),i.preventDefault(),!0}}return!1},Qe=function(t){(0,f.gm)()&&t.startContainer.nodeType!==3&&t.startContainer.tagName==="HR"&&t.setStartBefore(t.startContainer)},Mt=function(t,n,i){var a,o;if(!(0,f.gm)())return!1;if(t.key==="ArrowUp"&&n&&((a=n.previousElementSibling)===null||a===void 0?void 0:a.tagName)==="TABLE"){var c=n.previousElementSibling;return i.selectNodeContents(c.rows[c.rows.length-1].lastElementChild),i.collapse(!1),t.preventDefault(),!0}return t.key==="ArrowDown"&&n&&((o=n.nextElementSibling)===null||o===void 0?void 0:o.tagName)==="TABLE"?(i.selectNodeContents(n.nextElementSibling.rows[0].cells[0]),i.collapse(!0),t.preventDefault(),!0):!1},Ft=function(t,n,i){return jr(void 0,void 0,void 0,function(){var a,o,c,S,A,O,L,$,K,ye,be,me,$e,fe,Te,fe,Ke;return ki(this,function(He){switch(He.label){case 0:return t[t.currentMode].element.getAttribute("contenteditable")!=="true"?[2]:(n.stopPropagation(),n.preventDefault(),"clipboardData"in n?(a=n.clipboardData.getData("text/html"),o=n.clipboardData.getData("text/plain"),c=n.clipboardData.files):(a=n.dataTransfer.getData("text/html"),o=n.dataTransfer.getData("text/plain"),n.dataTransfer.types.includes("Files")&&(c=n.dataTransfer.items)),S={},A=function(Xe,At){if(!At)return["",Lute.WalkContinue];if(t.options.upload.renderLinkDest)return t.options.upload.renderLinkDest(t,Xe,At);var _t=Xe.TokensStr();if(Xe.__internal_object__.Parent.Type===34&&_t&&_t.indexOf("file://")===-1&&t.options.upload.linkToImgUrl){var Ot=new XMLHttpRequest;Ot.open("POST",t.options.upload.linkToImgUrl),t.options.upload.token&&Ot.setRequestHeader("X-Upload-Token",t.options.upload.token),t.options.upload.withCredentials&&(Ot.withCredentials=!0),en(t,Ot),Ot.setRequestHeader("Content-Type","application/json; charset=utf-8"),Ot.onreadystatechange=function(){if(Ot.readyState===XMLHttpRequest.DONE){if(Ot.status===200){var pn=Ot.responseText;t.options.upload.linkToImgFormat&&(pn=t.options.upload.linkToImgFormat(Ot.responseText));var nn=JSON.parse(pn);if(nn.code!==0){t.tip.show(nn.msg);return}var mn=nn.data.originalURL;if(t.currentMode==="sv")t.sv.element.querySelectorAll(".vditor-sv__marker--link").forEach(function(qt){qt.textContent===mn&&(qt.textContent=nn.data.url)});else{var lt=t[t.currentMode].element.querySelector('img[src="'.concat(mn,'"]'));lt.src=nn.data.url,t.currentMode==="ir"&&(lt.previousElementSibling.previousElementSibling.innerHTML=nn.data.url)}st(t)}else t.tip.show(Ot.responseText);t.options.upload.linkToImgCallback&&t.options.upload.linkToImgCallback(Ot.responseText)}},Ot.send(JSON.stringify({url:_t}))}return t.currentMode==="ir"?['<span class="vditor-ir__marker vditor-ir__marker--link">'.concat(Lute.EscapeHTMLStr(_t),"</span>"),Lute.WalkContinue]:t.currentMode==="wysiwyg"?["",Lute.WalkContinue]:['<span class="vditor-sv__marker--link">'.concat(Lute.EscapeHTMLStr(_t),"</span>"),Lute.WalkContinue]},(a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<a href="'.concat(o,'">').concat(o,"</a>")||a.replace(/&amp;/g,"&").replace(/<(|\/)(html|body|meta)[^>]*?>/ig,"").trim()==='<!--StartFragment--><a href="'.concat(o,'">').concat(o,"</a><!--EndFragment-->"))&&(a=""),O=new DOMParser().parseFromString(a,"text/html"),O.body&&(a=O.body.innerHTML),a=Lute.Sanitize(a),t.wysiwyg.getComments(t),L=t[t.currentMode].element.scrollHeight,$=et(a,o,t.currentMode),K=t.currentMode==="sv"?(0,v.Th)(n.target,"data-type","code-block"):(0,v._Y)(n.target,"CODE"),K?(t.currentMode==="sv"?document.execCommand("insertHTML",!1,o.replace(/&/g,"&amp;").replace(/</g,"&lt;")):(ye=(0,B.ED)(n.target,t[t.currentMode].element),K.parentElement.tagName!=="PRE"&&(o+=u.Y.ZWSP),K.textContent=K.textContent.substring(0,ye.start)+o+K.textContent.substring(ye.end),(0,B.Fm)(ye.start+o.length,ye.start+o.length,K.parentElement),!((Ke=K.parentElement)===null||Ke===void 0)&&Ke.nextElementSibling.classList.contains("vditor-".concat(t.currentMode,"__preview"))&&(K.parentElement.nextElementSibling.innerHTML=K.outerHTML,rt(K.parentElement.nextElementSibling,t))),[3,8]):[3,1]);case 1:return $?(i.pasteCode($),[3,8]):[3,2];case 2:return a.trim()===""?[3,3]:(be=document.createElement("div"),be.innerHTML=a,be.querySelectorAll("[style]").forEach(function(Xe){Xe.removeAttribute("style")}),be.querySelectorAll(".vditor-copy").forEach(function(Xe){Xe.remove()}),t.currentMode==="ir"?(S.HTML2VditorIRDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:S}),(0,B.Z2)(t.lute.HTML2VditorIRDOM(be.innerHTML),t)):t.currentMode==="wysiwyg"?(S.HTML2VditorDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:S}),(0,B.Z2)(t.lute.HTML2VditorDOM(be.innerHTML),t)):(S.Md2VditorSVDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:S}),F(t,t.lute.HTML2Md(be.innerHTML).trimRight())),t.outline.render(t),[3,8]);case 3:return c.length>0?t.options.upload.url||t.options.upload.handler?[4,$n(t,c)]:[3,5]:[3,7];case 4:return He.sent(),[3,6];case 5:me=new FileReader,"clipboardData"in n?(c=n.clipboardData.files,$e=c[0]):n.dataTransfer.types.includes("Files")&&(c=n.dataTransfer.items,$e=c[0].getAsFile()),$e&&$e.type.startsWith("image")&&(me.readAsDataURL($e),me.onload=function(){var Xe="";t.currentMode==="wysiwyg"?Xe+='<img alt="'.concat($e.name,'" src="').concat(me.result.toString(),`">
`):Xe+="![".concat($e.name,"](").concat(me.result.toString(),`)
`),document.execCommand("insertHTML",!1,Xe)}),He.label=6;case 6:return[3,8];case 7:o.trim()!==""&&c.length===0&&(fe=(0,B.RN)(t),fe.toString()!==""&&t.lute.IsValidLinkDest(o)&&(o="[".concat(fe.toString(),"](").concat(o,")")),t.currentMode==="ir"?(S.Md2VditorIRDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:S}),(0,B.Z2)(t.lute.Md2VditorIRDOM(o),t)):t.currentMode==="wysiwyg"?(S.Md2VditorDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:S}),(0,B.Z2)(t.lute.Md2VditorDOM(o),t)):(S.Md2VditorSVDOM={renderLinkDest:A},t.lute.SetJSRenderers({renderers:S}),F(t,o)),t.outline.render(t)),He.label=8;case 8:return t.currentMode!=="sv"&&(Te=(0,v.pt)((0,B.RN)(t).startContainer),Te&&(fe=(0,B.RN)(t),t[t.currentMode].element.querySelectorAll("wbr").forEach(function(Xe){Xe.remove()}),fe.insertNode(document.createElement("wbr")),t.currentMode==="wysiwyg"?Te.outerHTML=t.lute.SpinVditorDOM(Te.outerHTML):Te.outerHTML=t.lute.SpinVditorIRDOM(Te.outerHTML),(0,B.ir)(t[t.currentMode].element,fe)),t[t.currentMode].element.querySelectorAll(".vditor-".concat(t.currentMode,"__preview[data-render='2']")).forEach(function(Xe){rt(Xe,t)})),t.wysiwyg.triggerRemoveComment(t),st(t),t[t.currentMode].element.scrollHeight-L>Math.min(t[t.currentMode].element.clientHeight,window.innerHeight)/2&&Dt(t),[2]}})})},Bn,Kn=function(t){var n,i;t.hint.render(t);var a=(0,B.RN)(t).startContainer,o=(0,v.Th)(a,"data-type","code-block-info");if(o)if(o.textContent.replace(u.Y.ZWSP,"")===""&&t.hint.recentLanguage){o.textContent=u.Y.ZWSP+t.hint.recentLanguage;var c=(0,B.RN)(t);c.selectNodeContents(o)}else{var S=[],A=o.textContent.substring(0,(0,B.ED)(o,t.ir.element).start).replace(u.Y.ZWSP,"");(t.options.preview.hljs.langs||u.Y.ALIAS_CODE_LANGUAGES.concat(((i=(n=window.hljs)===null||n===void 0?void 0:n.listLanguages())!==null&&i!==void 0?i:[]).sort())).forEach(function(O){O.indexOf(A.toLowerCase())>-1&&S.push({html:O,value:O})}),t.hint.genHTML(S,A,t)}},un=function(t,n){n===void 0&&(n={enableAddUndoStack:!0,enableHint:!1,enableInput:!0}),n.enableHint&&Kn(t),clearTimeout(t.ir.processTimeoutId),t.ir.processTimeoutId=window.setTimeout(function(){if(!t.ir.composingLock){var i=x(t);typeof t.options.input=="function"&&n.enableInput&&t.options.input(i),t.options.counter.enable&&t.counter.render(t,i),t.options.cache.enable&&(0,f.D)()&&(localStorage.setItem(t.options.cache.id,i),t.options.cache.after&&t.options.cache.after(i)),t.devtools&&t.devtools.renderEchart(t),n.enableAddUndoStack&&t.undo.addToUndoStack(t)}},t.options.undoDelay)},An=function(t,n){var i=(0,B.RN)(t),a=(0,v.pt)(i.startContainer)||i.startContainer;if(a){var o=a.querySelector(".vditor-ir__marker--heading");o?o.innerHTML=n:(a.insertAdjacentText("afterbegin",n),i.selectNodeContents(a),i.collapse(!1)),Ge(t,i.cloneRange()),an(t)}},ue=function(t,n,i){var a=(0,v.Th)(t.startContainer,"data-type",i);if(a){a.firstElementChild.remove(),a.lastElementChild.remove(),t.insertNode(document.createElement("wbr"));var o=document.createElement("div");o.innerHTML=n.lute.SpinVditorIRDOM(a.outerHTML),a.outerHTML=o.firstElementChild.innerHTML.trim()}},Kt=function(t,n,i,a){var o=(0,B.RN)(t),c=n.getAttribute("data-type"),S=o.startContainer;S.nodeType===3&&(S=S.parentElement);var A=!0;if(n.classList.contains("vditor-menu--current"))if(c==="quote"){var O=(0,v._Y)(S,"BLOCKQUOTE");O&&(o.insertNode(document.createElement("wbr")),O.outerHTML=O.innerHTML.trim()===""?'<p data-block="0">'.concat(O.innerHTML,"</p>"):O.innerHTML)}else if(c==="link"){var L=(0,v.Th)(o.startContainer,"data-type","a");if(L){var $=(0,v.KJ)(o.startContainer,"vditor-ir__link");$?(o.insertNode(document.createElement("wbr")),L.outerHTML=$.innerHTML):L.outerHTML=L.querySelector(".vditor-ir__link").innerHTML+"<wbr>"}}else c==="italic"?ue(o,t,"em"):c==="bold"?ue(o,t,"strong"):c==="strike"?ue(o,t,"s"):c==="inline-code"?ue(o,t,"code"):(c==="check"||c==="list"||c==="ordered-list")&&(xi(t,o,c),A=!1,n.classList.remove("vditor-menu--current"));else{t.ir.element.childNodes.length===0&&(t.ir.element.innerHTML='<p data-block="0"><wbr></p>',(0,B.ir)(t.ir.element,o));var K=(0,v.pt)(o.startContainer);if(c==="line"){if(K){var ye=`<hr data-block="0"><p data-block="0"><wbr>
</p>`;K.innerHTML.trim()===""?K.outerHTML=ye:K.insertAdjacentHTML("afterend",ye)}}else if(c==="quote")K&&(o.insertNode(document.createElement("wbr")),K.outerHTML='<blockquote data-block="0">'.concat(K.outerHTML,"</blockquote>"),A=!1,n.classList.add("vditor-menu--current"));else if(c==="link"){var be=void 0;o.toString()===""?be="".concat(i,"<wbr>").concat(a):be="".concat(i).concat(o.toString()).concat(a.replace(")","<wbr>)")),document.execCommand("insertHTML",!1,be),A=!1,n.classList.add("vditor-menu--current")}else if(c==="italic"||c==="bold"||c==="strike"||c==="inline-code"||c==="code"||c==="table"){var be=void 0;o.toString()===""?be="".concat(i,"<wbr>").concat(a):(c==="code"?be="".concat(i,`
`).concat(o.toString(),"<wbr>").concat(a):c==="table"?be="".concat(i).concat(o.toString(),"<wbr>").concat(a):be="".concat(i).concat(o.toString()).concat(a,"<wbr>"),o.deleteContents()),(c==="table"||c==="code")&&(be=`
`+be+`

`);var me=document.createElement("span");me.innerHTML=be,o.insertNode(me),Ge(t,o),c==="table"&&(o.selectNodeContents(getSelection().getRangeAt(0).startContainer.parentElement),(0,B.jl)(o))}else(c==="check"||c==="list"||c==="ordered-list")&&(xi(t,o,c,!1),A=!1,b(t.toolbar.elements,["check","list","ordered-list"]),n.classList.add("vditor-menu--current"))}(0,B.ir)(t.ir.element,o),un(t),A&&an(t)},tn=function(t,n,i,a){function o(c){return c instanceof i?c:new i(function(S){S(c)})}return new(i||(i=Promise))(function(c,S){function A($){try{L(a.next($))}catch(K){S(K)}}function O($){try{L(a.throw($))}catch(K){S(K)}}function L($){$.done?c($.value):o($.value).then(A,O)}L((a=a.apply(t,n||[])).next())})},Ti=function(t,n){var i={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},a,o,c,S;return S={next:A(0),throw:A(1),return:A(2)},typeof Symbol=="function"&&(S[Symbol.iterator]=function(){return this}),S;function A(L){return function($){return O([L,$])}}function O(L){if(a)throw new TypeError("Generator is already executing.");for(;S&&(S=0,L[0]&&(i=0)),i;)try{if(a=1,o&&(c=L[0]&2?o.return:L[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,L[1])).done)return c;switch(o=0,c&&(L=[L[0]&2,c.value]),L[0]){case 0:case 1:c=L;break;case 4:return i.label++,{value:L[1],done:!1};case 5:i.label++,o=L[1],L=[0];continue;case 7:L=i.ops.pop(),i.trys.pop();continue;default:if(c=i.trys,!(c=c.length>0&&c[c.length-1])&&(L[0]===6||L[0]===2)){i=0;continue}if(L[0]===3&&(!c||L[1]>c[0]&&L[1]<c[3])){i.label=L[1];break}if(L[0]===6&&i.label<c[1]){i.label=c[1],c=L;break}if(c&&i.label<c[2]){i.label=c[2],i.ops.push(L);break}c[2]&&i.ops.pop(),i.trys.pop();continue}L=n.call(t,i)}catch($){L=[6,$],o=0}finally{a=c=0}if(L[0]&5)throw L[1];return{value:L[0]?L[1]:void 0,done:!0}}},Xi=function(){function t(n){var i=this;this.splitChar="",this.lastIndex=-1,this.fillEmoji=function(a,o){i.element.style.display="none";var c=decodeURIComponent(a.getAttribute("data-value")),S=window.getSelection().getRangeAt(0);if(o.currentMode==="ir"){var A=(0,v.Th)(S.startContainer,"data-type","code-block-info");if(A){A.textContent=u.Y.ZWSP+c.trimRight(),S.selectNodeContents(A),S.collapse(!1),un(o),A.parentElement.querySelectorAll("code").forEach(function(K){K.className="language-"+c.trimRight()}),rt(A.parentElement.querySelector(".vditor-ir__preview"),o),i.recentLanguage=c.trimRight();return}}if(o.currentMode==="wysiwyg"&&S.startContainer.nodeType!==3){var O=S.startContainer,L=void 0;if(O.classList.contains("vditor-input")?L=O:L=O.firstElementChild,L&&L.classList.contains("vditor-input")){L.value=c.trimRight(),S.selectNodeContents(L),S.collapse(!1),L.dispatchEvent(new CustomEvent("input",{detail:1})),i.recentLanguage=c.trimRight();return}}if(S.setStart(S.startContainer,i.lastIndex),S.deleteContents(),o.options.hint.parse?o.currentMode==="sv"?(0,B.Z2)(o.lute.SpinVditorSVDOM(c),o):o.currentMode==="wysiwyg"?(0,B.Z2)(o.lute.SpinVditorDOM(c),o):(0,B.Z2)(o.lute.SpinVditorIRDOM(c),o):(0,B.Z2)(c,o),i.splitChar===":"&&c.indexOf(":")>-1&&o.currentMode!=="sv"&&S.insertNode(document.createTextNode(" ")),S.collapse(!1),(0,B.jl)(S),o.currentMode==="wysiwyg"){var $=(0,v.KJ)(S.startContainer,"vditor-wysiwyg__block");$&&$.lastElementChild.classList.contains("vditor-wysiwyg__preview")&&($.lastElementChild.innerHTML=$.firstElementChild.innerHTML,rt($.lastElementChild,o))}else if(o.currentMode==="ir"){var $=(0,v.KJ)(S.startContainer,"vditor-ir__marker--pre");$&&$.nextElementSibling.classList.contains("vditor-ir__preview")&&($.nextElementSibling.innerHTML=$.innerHTML,rt($.nextElementSibling,o))}st(o)},this.timeId=-1,this.element=document.createElement("div"),this.element.className="vditor-hint",this.recentLanguage="",n.push({key:":"})}return t.prototype.render=function(n){var i=this;if(window.getSelection().focusNode){var a,o=getSelection().getRangeAt(0);a=o.startContainer.textContent.substring(0,o.startOffset)||"";var c=this.getKey(a,n.options.hint.extend);if(typeof c>"u")this.element.style.display="none",clearTimeout(this.timeId);else if(this.splitChar===":"){var S=c===""?n.options.hint.emoji:n.lute.GetEmojis(),A=[];Object.keys(S).forEach(function(O){O.indexOf(c.toLowerCase())===0&&(S[O].indexOf(".")>-1?A.push({html:'<img src="'.concat(S[O],'" title=":').concat(O,':"/> :').concat(O,":"),value:":".concat(O,":")}):A.push({html:'<span class="vditor-hint__emoji">'.concat(S[O],"</span>").concat(O),value:S[O]}))}),this.genHTML(A,c,n)}else n.options.hint.extend.forEach(function(O){O.key===i.splitChar&&(clearTimeout(i.timeId),i.timeId=window.setTimeout(function(){return tn(i,void 0,void 0,function(){var L;return Ti(this,function($){switch($.label){case 0:return L=this.genHTML,[4,O.hint(c)];case 1:return L.apply(this,[$.sent(),c,n]),[2]}})})},n.options.hint.delay))})}},t.prototype.genHTML=function(n,i,a){var o=this;if(n.length===0){this.element.style.display="none";return}var c=a[a.currentMode].element,S=(0,B.Ey)(c),A=S.left+(a.options.outline.position==="left"?a.outline.element.offsetWidth:0),O=S.top,L="";n.forEach(function(K,ye){if(!(ye>7)){var be=K.html;if(i!==""){var me=be.lastIndexOf(">")+1,$e=be.substr(me),Te=$e.toLowerCase().indexOf(i.toLowerCase());Te>-1&&($e=$e.substring(0,Te)+"<b>"+$e.substring(Te,Te+i.length)+"</b>"+$e.substring(Te+i.length),be=be.substr(0,me)+$e)}L+='<button type="button" data-value="'.concat(encodeURIComponent(K.value),` "
`).concat(ye===0?"class='vditor-hint--current'":"","> ").concat(be,"</button>")}}),this.element.innerHTML=L;var $=parseInt(document.defaultView.getComputedStyle(c,null).getPropertyValue("line-height"),10);this.element.style.top="".concat(O+($||22),"px"),this.element.style.left="".concat(A,"px"),this.element.style.display="block",this.element.style.right="auto",this.element.querySelectorAll("button").forEach(function(K){K.addEventListener("click",function(ye){o.fillEmoji(K,a),ye.preventDefault()})}),this.element.getBoundingClientRect().bottom>window.innerHeight&&(this.element.style.top="".concat(O-this.element.offsetHeight,"px")),this.element.getBoundingClientRect().right>window.innerWidth&&(this.element.style.left="auto",this.element.style.right="0")},t.prototype.select=function(n,i){if(this.element.querySelectorAll("button").length===0||this.element.style.display==="none")return!1;var a=this.element.querySelector(".vditor-hint--current");if(n.key==="ArrowDown")return n.preventDefault(),n.stopPropagation(),a.removeAttribute("class"),a.nextElementSibling?a.nextElementSibling.className="vditor-hint--current":this.element.children[0].className="vditor-hint--current",!0;if(n.key==="ArrowUp"){if(n.preventDefault(),n.stopPropagation(),a.removeAttribute("class"),a.previousElementSibling)a.previousElementSibling.className="vditor-hint--current";else{var o=this.element.children.length;this.element.children[o-1].className="vditor-hint--current"}return!0}else if(!(0,f._0)(n)&&!n.shiftKey&&!n.altKey&&n.key==="Enter"&&!n.isComposing)return n.preventDefault(),n.stopPropagation(),this.fillEmoji(a,i),!0;return!1},t.prototype.getKey=function(n,i){var a=this;this.lastIndex=-1,this.splitChar="",i.forEach(function(L){var $=n.lastIndexOf(L.key);a.lastIndex<$&&(a.splitChar=L.key,a.lastIndex=$)});var o;if(this.lastIndex===-1)return o;var c=n.split(this.splitChar),S=c[c.length-1],A=32;if(c.length>1&&S.trim()===S)if(c.length===2&&c[0]===""&&c[1].length<A)o=c[1];else{var O=c[c.length-2].slice(-1);(0,g.p)(O)===" "&&S.length<A&&(o=S)}return o},t}(),co=function(){function t(n){this.composingLock=!1;var i=document.createElement("div");i.className="vditor-ir",i.innerHTML='<pre class="vditor-reset" placeholder="'.concat(n.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>`),this.element=i.firstElementChild,this.bindEvent(n),$t(n,this.element),kn(n,this.element),En(n,this.element),cn(n,this.element),at(n,this.element),ni(n,this.element),ln(n,this.element,this.copy),Nn(n,this.element,this.copy)}return t.prototype.copy=function(n,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){n.stopPropagation(),n.preventDefault();var o=document.createElement("div");o.appendChild(a.cloneContents()),n.clipboardData.setData("text/plain",i.lute.VditorIRDOM2Md(o.innerHTML).trim()),n.clipboardData.setData("text/html","")}},t.prototype.bindEvent=function(n){var i=this;this.element.addEventListener("paste",function(a){Ft(n,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){T(n,["hint"])}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,f.gm)()||Ge(n,getSelection().getRangeAt(0).cloneRange()),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,un(n,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"||Ge(n,getSelection().getRangeAt(0).cloneRange(),!1,a)}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){a.target.checked?a.target.setAttribute("checked","checked"):a.target.removeAttribute("checked"),i.preventInput=!0,un(n);return}var o=(0,B.RN)(n),c=(0,v.KJ)(a.target,"vditor-ir__preview");if(c||(c=(0,v.KJ)(o.startContainer,"vditor-ir__preview")),c&&(c.previousElementSibling.firstElementChild?o.selectNodeContents(c.previousElementSibling.firstElementChild):o.selectNodeContents(c.previousElementSibling),o.collapse(!0),(0,B.jl)(o),Dt(n)),a.target.tagName==="IMG"){var S=a.target.parentElement.querySelector(".vditor-ir__marker--link");S&&(o.selectNode(S),(0,B.jl)(o))}var A=(0,v.Th)(a.target,"data-type","a");if(A&&!A.classList.contains("vditor-ir__node--expand")){n.options.link.click?n.options.link.click(A.querySelector(":scope > .vditor-ir__marker--link")):n.options.link.isOpen&&window.open(A.querySelector(":scope > .vditor-ir__marker--link").textContent);return}if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&o.collapsed){var O=i.element.lastElementChild.getBoundingClientRect();a.y>O.top+O.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(u.Y.ZWSP,"")===""?(o.selectNodeContents(i.element.lastElementChild),o.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,B.ir)(i.element,o)))}o.toString()===""?ne(o,n):setTimeout(function(){ne((0,B.RN)(n),n)}),re(a,n),an(n)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,f._0)(a))){if(a.key==="Enter"&&Dt(n),an(n),(a.key==="Backspace"||a.key==="Delete")&&n.ir.element.innerHTML!==""&&n.ir.element.childNodes.length===1&&n.ir.element.firstElementChild&&n.ir.element.firstElementChild.tagName==="P"&&n.ir.element.firstElementChild.childElementCount===0&&(n.ir.element.textContent===""||n.ir.element.textContent===`
`)){n.ir.element.innerHTML="";return}var o=(0,B.RN)(n);a.key==="Backspace"?((0,f.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent="",ne(o,n)),i.element.querySelectorAll(".language-math").forEach(function(S){var A=S.querySelector("br");A&&A.remove()})):a.key.indexOf("Arrow")>-1?((a.key==="ArrowLeft"||a.key==="ArrowRight")&&Kn(n),ne(o,n)):a.keyCode===229&&a.code===""&&a.key==="Unidentified"&&ne(o,n);var c=(0,v.KJ)(o.startContainer,"vditor-ir__preview");if(c){if(a.key==="ArrowUp"||a.key==="ArrowLeft")return c.previousElementSibling.firstElementChild?o.selectNodeContents(c.previousElementSibling.firstElementChild):o.selectNodeContents(c.previousElementSibling),o.collapse(!1),a.preventDefault(),!0;if(c.tagName==="SPAN"&&(a.key==="ArrowDown"||a.key==="ArrowRight"))return c.parentElement.getAttribute("data-type")==="html-entity"?(c.parentElement.insertAdjacentText("afterend",u.Y.ZWSP),o.setStart(c.parentElement.nextSibling,1)):o.selectNodeContents(c.parentElement.lastElementChild),o.collapse(!1),a.preventDefault(),!0}}})},t}(),hi=function(t){if(t.currentMode==="sv")return t.lute.Md2HTML(x(t));if(t.currentMode==="wysiwyg")return t.lute.VditorDOM2HTML(t.wysiwyg.element.innerHTML);if(t.currentMode==="ir")return t.lute.VditorIRDOM2HTML(t.ir.element.innerHTML)},Js=l(796),uo=l(70),Qs=function(){function t(n){this.element=document.createElement("div"),this.element.className="vditor-outline",this.element.innerHTML='<div class="vditor-outline__title">'.concat(n,`</div>
<div class="vditor-outline__content"></div>`)}return t.prototype.render=function(n){var i="";return n.preview.element.style.display==="block"?i=(0,uo.N)(n.preview.previewElement,this.element.lastElementChild,n):i=(0,uo.N)(n[n.currentMode].element,this.element.lastElementChild,n),i},t.prototype.toggle=function(n,i,a){var o;i===void 0&&(i=!0),a===void 0&&(a=!0);var c=(o=n.toolbar.elements.outline)===null||o===void 0?void 0:o.firstElementChild;if(i&&window.innerWidth>=u.Y.MOBILE_WIDTH?(this.element.style.display="block",this.render(n),c==null||c.classList.add("vditor-menu--current")):(this.element.style.display="none",c==null||c.classList.remove("vditor-menu--current")),a&&getSelection().rangeCount>0){var S=getSelection().getRangeAt(0);n[n.currentMode].element.contains(S.startContainer)&&(0,B.jl)(S)}wt(n)},t}(),el=l(0),tl=function(){function t(n){var i=this;this.element=document.createElement("div"),this.element.className="vditor-preview",this.previewElement=document.createElement("div"),this.previewElement.className="vditor-reset",n.options.classes.preview&&this.previewElement.classList.add(n.options.classes.preview),this.previewElement.style.maxWidth=n.options.preview.maxWidth+"px",this.previewElement.addEventListener("copy",function(O){if(O.target.tagName!=="TEXTAREA"){var L=document.createElement("div");L.className="vditor-reset",L.appendChild(getSelection().getRangeAt(0).cloneContents()),i.copyToX(n,L,"default"),O.preventDefault()}}),this.previewElement.addEventListener("click",function(O){var L=(0,v._Y)(O.target,"SPAN");if(L&&(0,v.KJ)(L,"vditor-toc")){var $=i.previewElement.querySelector("#"+L.getAttribute("data-target-id"));$&&(i.element.scrollTop=$.offsetTop);return}if(O.target.tagName==="A"){n.options.link.click?n.options.link.click(O.target):n.options.link.isOpen&&window.open(O.target.getAttribute("href")),O.preventDefault();return}O.target.tagName==="IMG"&&(n.options.image.preview?n.options.image.preview(O.target):n.options.image.isPreview&&(0,pe.o)(O.target,n.options.lang,n.options.theme))}),this.element.appendChild(this.previewElement);var a=n.options.preview.actions;if(a.length!==0){var o=document.createElement("div");o.className="vditor-preview__action";for(var c=[],S=0;S<a.length;S++){var A=a[S];if(typeof A=="object"){c.push('<button type="button" data-type="'.concat(A.key,'" class="').concat(A.className,'"').concat(A.tooltip?' aria-label="'.concat(A.tooltip,'"'):"",'">').concat(A.text,"</button>"));continue}switch(A){case"desktop":c.push('<button type="button" class="vditor-preview__action--current" data-type="desktop">Desktop</button>');break;case"tablet":c.push('<button type="button" data-type="tablet">Tablet</button>');break;case"mobile":c.push('<button type="button" data-type="mobile">Mobile/Wechat</button>');break;case"mp-wechat":c.push('<button type="button" data-type="mp-wechat" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到公众号"><svg><use xlink:href="#vditor-icon-mp-wechat"></use></svg></button>');break;case"zhihu":c.push('<button type="button" data-type="zhihu" class="vditor-tooltipped vditor-tooltipped__w" aria-label="复制到知乎"><svg><use xlink:href="#vditor-icon-zhihu"></use></svg></button>');break}}o.innerHTML=c.join(""),o.addEventListener((0,f.y3)(),function(O){var L=(0,D.f)(O.target,"BUTTON");if(L){var $=L.getAttribute("data-type"),K=a.find(function(ye){return(ye==null?void 0:ye.key)===$});if(K){K.click($);return}if($==="mp-wechat"||$==="zhihu"){i.copyToX(n,i.previewElement.cloneNode(!0),$);return}$==="desktop"?i.previewElement.style.width="auto":$==="tablet"?i.previewElement.style.width="780px":i.previewElement.style.width="360px",i.previewElement.scrollWidth>i.previewElement.parentElement.clientWidth&&(i.previewElement.style.width="auto"),i.render(n),o.querySelectorAll("button").forEach(function(ye){ye.classList.remove("vditor-preview__action--current")}),L.classList.add("vditor-preview__action--current")}}),this.element.insertBefore(o,this.previewElement)}}return t.prototype.render=function(n,i){var a=this;if(clearTimeout(this.mdTimeoutId),this.element.style.display==="none"){this.element.getAttribute("data-type")==="renderPerformance"&&n.tip.hide();return}if(i){this.previewElement.innerHTML=i;return}if(x(n).replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")===""){this.previewElement.innerHTML="";return}var o=new Date().getTime(),c=x(n);this.mdTimeoutId=window.setTimeout(function(){if(n.options.preview.url){var S=new XMLHttpRequest;S.open("POST",n.options.preview.url),S.setRequestHeader("Content-Type","application/json;charset=UTF-8"),S.onreadystatechange=function(){if(S.readyState===XMLHttpRequest.DONE)if(S.status===200){var O=JSON.parse(S.responseText);if(O.code!==0){n.tip.show(O.msg);return}n.options.preview.transform&&(O.data=n.options.preview.transform(O.data)),a.previewElement.innerHTML=O.data,a.afterRender(n,o)}else{var L=n.lute.Md2HTML(c);n.options.preview.transform&&(L=n.options.preview.transform(L)),a.previewElement.innerHTML=L,a.afterRender(n,o)}},S.send(JSON.stringify({markdownText:c}))}else{var A=n.lute.Md2HTML(c);n.options.preview.transform&&(A=n.options.preview.transform(A)),a.previewElement.innerHTML=A,a.afterRender(n,o)}},n.options.preview.delay)},t.prototype.afterRender=function(n,i){n.options.preview.parse&&n.options.preview.parse(this.element);var a=new Date().getTime()-i;new Date().getTime()-i>2600?(n.tip.show(window.VditorI18n.performanceTip.replace("${x}",a.toString())),n.preview.element.setAttribute("data-type","renderPerformance")):n.preview.element.getAttribute("data-type")==="renderPerformance"&&(n.tip.hide(),n.preview.element.removeAttribute("data-type"));var o=n.preview.element.querySelector(".vditor-comment--focus");o&&o.classList.remove("vditor-comment--focus"),(0,Y.o)(n.preview.previewElement,n.options.preview.hljs),(0,X.$)(n.options.preview.hljs,n.preview.previewElement,n.options.cdn),(0,Se.e)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,Ue.K)(n.preview.previewElement,n.options.cdn),(0,Ie.Y)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,U.D)(n.preview.previewElement,n.options.cdn),(0,j.m)(n.preview.previewElement,n.options.cdn),(0,H.v)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,Le.l)(n.preview.previewElement,n.options.cdn,n.options.theme),(0,Pe.M)(n.preview.previewElement,n.options.cdn),(0,z.$)(n.preview.previewElement,n.options.cdn),n.options.preview.render.media.enable&&(0,el.l)(n.preview.previewElement),n.options.customRenders.forEach(function(A){A.render(n.preview.previewElement,n)});var c=n.preview.element,S=n.outline.render(n);S===""&&(S="[ToC]"),c.querySelectorAll('[data-type="toc-block"]').forEach(function(A){A.innerHTML=S,(0,he.T)(A,{cdn:n.options.cdn,math:n.options.preview.math})}),(0,he.T)(n.preview.previewElement,{cdn:n.options.cdn,math:n.options.preview.math})},t.prototype.copyToX=function(n,i,a){a===void 0&&(a="mp-wechat"),a!=="zhihu"?i.querySelectorAll(".katex-html .base").forEach(function(c){c.style.display="initial"}):i.querySelectorAll(".language-math").forEach(function(c){c.outerHTML='<img class="Formula-image" data-eeimg="true" src="//www.zhihu.com/equation?tex=" alt="'.concat(c.getAttribute("data-math"),'\\" style="display: block; margin: 0 auto; max-width: 100%;">')}),i.style.backgroundColor="#fff",i.querySelectorAll("code").forEach(function(c){c.style.backgroundImage="none"}),this.element.append(i);var o=i.ownerDocument.createRange();o.selectNode(i),(0,B.jl)(o),document.execCommand("copy"),i.remove(),n.tip.show(["zhihu","mp-wechat"].includes(a)?"已复制，可到".concat(a==="zhihu"?"知乎":"微信公众号平台","进行粘贴"):"已复制到剪切板")},t}(),nl=function(){function t(n){this.element=document.createElement("div"),this.element.className="vditor-resize vditor-resize--".concat(n.options.resize.position),this.element.innerHTML='<div><svg><use xlink:href="#vditor-icon-resize"></use></svg></div>',this.bindEvent(n)}return t.prototype.bindEvent=function(n){var i=this;this.element.addEventListener("mousedown",function(a){var o=document,c=a.clientY,S=n.element.offsetHeight,A=63+n.element.querySelector(".vditor-toolbar").clientHeight;o.ondragstart=function(){return!1},window.captureEvents&&window.captureEvents(),i.element.classList.add("vditor-resize--selected"),o.onmousemove=function(O){n.options.resize.position==="top"?n.element.style.height=Math.max(A,S+(c-O.clientY))+"px":n.element.style.height=Math.max(A,S+(O.clientY-c))+"px",n.options.typewriterMode&&(n.sv.element.style.paddingBottom=n.sv.element.parentElement.offsetHeight/2+"px")},o.onmouseup=function(){n.options.resize.after&&n.options.resize.after(n.element.offsetHeight-S),window.captureEvents&&window.captureEvents(),o.onmousemove=null,o.onmouseup=null,o.ondragstart=null,o.onselectstart=null,o.onselect=null,i.element.classList.remove("vditor-resize--selected")}})},t}(),il=function(){function t(n){this.composingLock=!1,this.element=document.createElement("pre"),this.element.className="vditor-sv vditor-reset",this.element.setAttribute("placeholder",n.options.placeholder),this.element.setAttribute("contenteditable","true"),this.element.setAttribute("spellcheck","false"),this.bindEvent(n),$t(n,this.element),En(n,this.element),cn(n,this.element),at(n,this.element),ni(n,this.element),ln(n,this.element,this.copy),Nn(n,this.element,this.copy)}return t.prototype.copy=function(n,i){n.stopPropagation(),n.preventDefault(),n.clipboardData.setData("text/plain",zt(i[i.currentMode].element))},t.prototype.bindEvent=function(n){var i=this;this.element.addEventListener("paste",function(a){Ft(n,a,{pasteCode:function(o){document.execCommand("insertHTML",!1,o)}})}),this.element.addEventListener("scroll",function(){if(n.preview.element.style.display==="block"){var a=i.element.scrollTop,o=i.element.clientHeight,c=i.element.scrollHeight-parseFloat(i.element.style.paddingBottom||"0"),S=n.preview.element;a/o>.5?S.scrollTop=(a+o)*S.scrollHeight/c-o:S.scrollTop=a*S.scrollHeight/c}}),this.element.addEventListener("compositionstart",function(a){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){(0,f.gm)()||Je(n,a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")&&!(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《")){if(i.preventInput){i.preventInput=!1,ze(n,{enableAddUndoStack:!0,enableHint:!0,enableInput:!0});return}Je(n,a)}}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,f._0)(a))){if((a.key==="Backspace"||a.key==="Delete")&&n.sv.element.innerHTML!==""&&n.sv.element.childNodes.length===1&&n.sv.element.firstElementChild&&n.sv.element.firstElementChild.tagName==="DIV"&&n.sv.element.firstElementChild.childElementCount===2&&(n.sv.element.firstElementChild.textContent===""||n.sv.element.textContent===`
`)){n.sv.element.innerHTML="";return}a.key==="Enter"&&Dt(n)}})},t}(),fo=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-tip"}return t.prototype.show=function(n,i){var a=this;i===void 0&&(i=6e3),this.element.className="vditor-tip vditor-tip--show",i===0?(this.element.innerHTML='<div class="vditor-tip__content">'.concat(n,`
<div class="vditor-tip__close">X</div></div>`),this.element.querySelector(".vditor-tip__close").addEventListener("click",function(){a.hide()})):(this.element.innerHTML='<div class="vditor-tip__content">'.concat(n,"</div>"),setTimeout(function(){a.hide()},i)),this.element.removeAttribute("style"),setTimeout(function(){var o=a.element.getBoundingClientRect();o.top<46&&(a.element.style.position="fixed",a.element.style.top="46px")},150)},t.prototype.hide=function(){this.element.className="vditor-messageElementtip",this.element.innerHTML=""},t}(),ya=function(t,n){if(n.options.preview.mode!==t){switch(n.options.preview.mode=t,t){case"both":n.sv.element.style.display="block",n.preview.element.style.display="block",n.preview.render(n),y(n.toolbar.elements,["both"]);break;case"editor":n.sv.element.style.display="block",n.preview.element.style.display="none",b(n.toolbar.elements,["both"]);break}n.devtools&&n.devtools.renderEchart(n)}},rl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),al=function(t){rl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return i.options.preview.mode==="both"&&o.element.children[0].classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,f.y3)(),function(c){var S=o.element.firstElementChild;S.classList.contains(u.Y.CLASS_MENU_DISABLED)||(c.preventDefault(),i.currentMode==="sv"&&(i.options.preview.mode==="both"?ya("editor",i):ya("both",i)))}),o}return n}(dt),ol=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__br"}return t}(),ho=l(13),sl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ll=function(t){sl(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=o.element.children[0],S=document.createElement("div");S.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var A="";return u.Y.CODE_THEME.forEach(function(O){A+="<button>".concat(O,"</button>")}),S.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(A,"</div>"),S.addEventListener((0,f.y3)(),function(O){O.target.tagName==="BUTTON"&&(T(i,["subToolbar"]),i.options.preview.hljs.style=O.target.textContent,(0,ho.h)(O.target.textContent,i.options.cdn),O.preventDefault(),O.stopPropagation())}),o.element.appendChild(S),M(i,S,c,a.level),o}return n}(dt),cl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ul=function(t){cl(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=o.element.children[0],S=document.createElement("div");S.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow");var A="";return Object.keys(i.options.preview.theme.list).forEach(function(O){A+='<button data-type="'.concat(O,'">').concat(i.options.preview.theme.list[O],"</button>")}),S.innerHTML='<div style="overflow: auto;max-height:'.concat(window.innerHeight/2,'px">').concat(A,"</div>"),S.addEventListener((0,f.y3)(),function(O){O.target.tagName==="BUTTON"&&(T(i,["subToolbar"]),i.options.preview.theme.current=O.target.getAttribute("data-type"),(0,_e.H)(i.options.preview.theme.current,i.options.preview.theme.path),O.preventDefault(),O.stopPropagation())}),o.element.appendChild(S),M(i,S,c,a.level),o}return n}(dt),dl=function(){function t(n){this.element=document.createElement("span"),this.element.className="vditor-counter vditor-tooltipped vditor-tooltipped__nw",this.render(n,"")}return t.prototype.render=function(n,i){var a=i.endsWith(`
`)?i.length-1:i.length;if(n.options.counter.type==="text"&&n[n.currentMode]){var o=n[n.currentMode].element.cloneNode(!0);o.querySelectorAll(".vditor-wysiwyg__preview").forEach(function(c){c.remove()}),a=o.textContent.length}typeof n.options.counter.max=="number"?(a>n.options.counter.max?this.element.className="vditor-counter vditor-counter--error":this.element.className="vditor-counter",this.element.innerHTML="".concat(a,"/").concat(n.options.counter.max)):this.element.innerHTML="".concat(a),this.element.setAttribute("aria-label",n.options.counter.type),n.options.counter.after&&n.options.counter.after(a,{enable:n.options.counter.enable,max:n.options.counter.max,type:n.options.counter.type})},t}(),fl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),hl=function(t){fl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].innerHTML=a.icon,o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!c.currentTarget.classList.contains(u.Y.CLASS_MENU_DISABLED)&&a.click(c,i)}),o}return n}(dt),pl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),ml=function(t){pl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.firstElementChild.addEventListener((0,f.y3)(),function(c){var S=o.element.firstElementChild;S.classList.contains(u.Y.CLASS_MENU_DISABLED)||(c.preventDefault(),S.classList.contains("vditor-menu--current")?(S.classList.remove("vditor-menu--current"),i.devtools.element.style.display="none",wt(i)):(S.classList.add("vditor-menu--current"),i.devtools.element.style.display="block",wt(i),i.devtools.renderEchart(i)))}),o}return n}(dt),gl=function(){function t(){this.element=document.createElement("div"),this.element.className="vditor-toolbar__divider"}return t}(),vl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),bl=function(t){vl(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=document.createElement("div");c.className="vditor-panel vditor-panel--arrow";var S="";return Object.keys(i.options.hint.emoji).forEach(function(A){var O=i.options.hint.emoji[A];O.indexOf(".")>-1?S+='<button data-value=":'.concat(A,': " data-key=":').concat(A,`:"><img
data-value=":`).concat(A,': " data-key=":').concat(A,':" class="vditor-emojis__icon" src="').concat(O,'"/></button>'):S+='<button data-value="'.concat(O,` "
 data-key="`).concat(A,'"><span class="vditor-emojis__icon">').concat(O,"</span></button>")}),c.innerHTML='<div class="vditor-emojis" style="max-height: '.concat(i.options.height==="auto"?"auto":i.options.height-80,'px">').concat(S,`</div><div class="vditor-emojis__tail">
    <span class="vditor-emojis__tip"></span><span>`).concat(i.options.hint.emojiTail||"",`</span>
</div>`),o.element.appendChild(c),M(i,c,o.element.firstElementChild,a.level),o.bindEvent(i),o}return n.prototype.bindEvent=function(i){var a=this;this.element.lastElementChild.addEventListener((0,f.y3)(),function(o){var c=(0,D.f)(o.target,"BUTTON");if(c){o.preventDefault();var S=c.getAttribute("data-value"),A=(0,B.RN)(i),O=S;if(i.currentMode==="wysiwyg"?O=i.lute.SpinVditorDOM(S):i.currentMode==="ir"&&(O=i.lute.SpinVditorIRDOM(S)),S.indexOf(":")>-1&&i.currentMode!=="sv"){var L=document.createElement("div");L.innerHTML=O,O=L.firstElementChild.firstElementChild.outerHTML+" ",(0,B.Z2)(O,i)}else A.extractContents(),A.insertNode(document.createTextNode(S)),(0,v.pt)(A.startContainer)||Wn(i,A);A.collapse(!1),(0,B.jl)(A),a.element.lastElementChild.style.display="none",st(i)}}),this.element.lastElementChild.addEventListener("mouseover",function(o){var c=(0,D.f)(o.target,"BUTTON");c&&(a.element.querySelector(".vditor-emojis__tip").innerHTML=c.getAttribute("data-key"))})},n}(dt),po=function(t,n,i){var a=document.createElement("a");"download"in a?(a.download=i,a.style.display="none",a.href=URL.createObjectURL(new Blob([n])),document.body.appendChild(a),a.click(),a.remove()):t.tip.show(window.VditorI18n.downloadTip,0)},yl=function(t){var n=x(t);po(t,n,n.substr(0,10)+".md")},wl=function(t){t.tip.show(window.VditorI18n.generate,3800);var n=document.querySelector("#vditorExportIframe");n.contentDocument.open(),n.contentDocument.write('<link rel="stylesheet" href="'.concat(t.options.cdn,`/dist/index.css"/>
<script src="`).concat(t.options.cdn,`/dist/method.min.js"><\/script>
<div id="preview" style="width: 800px"></div>
<script>
window.addEventListener("message", (e) => {
  if(!e.data) {
    return;
  }
  Vditor.preview(document.getElementById('preview'), e.data, {
    cdn: "`).concat(t.options.cdn,`",
    markdown: {
      theme: `).concat(JSON.stringify(t.options.preview.theme),`
    },
    hljs: {
      style: "`).concat(t.options.preview.hljs.style,`"
    }
  });
  setTimeout(() => {
        window.print();
    }, 3600);
}, false);
<\/script>`)),n.contentDocument.close(),setTimeout(function(){n.contentWindow.postMessage(x(t),"*")},200)},kl=function(t){var n=hi(t),i='<html><head><link rel="stylesheet" type="text/css" href="'.concat(t.options.cdn,`/dist/index.css"/>
<script src="`).concat(t.options.cdn,"/dist/js/i18n/").concat(t.options.lang,`.js"><\/script>
<script src="`).concat(t.options.cdn,`/dist/method.min.js"><\/script></head>
<body><div class="vditor-reset" id="preview">`).concat(n,`</div>
<script>
    const previewElement = document.getElementById('preview')
    Vditor.setContentTheme('`).concat(t.options.preview.theme.current,"', '").concat(t.options.preview.theme.path,`');
    Vditor.codeRender(previewElement);
    Vditor.highlightRender(`).concat(JSON.stringify(t.options.preview.hljs),", previewElement, '").concat(t.options.cdn,`');
    Vditor.mathRender(previewElement, {
        cdn: '`).concat(t.options.cdn,`',
        math: `).concat(JSON.stringify(t.options.preview.math),`,
    });
    Vditor.mermaidRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.SMILESRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.markmapRender(previewElement, '`).concat(t.options.cdn,`');
    Vditor.flowchartRender(previewElement, '`).concat(t.options.cdn,`');
    Vditor.graphvizRender(previewElement, '`).concat(t.options.cdn,`');
    Vditor.chartRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.mindmapRender(previewElement, '`).concat(t.options.cdn,"', '").concat(t.options.theme,`');
    Vditor.abcRender(previewElement, '`).concat(t.options.cdn,`');
    `).concat(t.options.preview.render.media.enable?"Vditor.mediaRender(previewElement);":"",`
    Vditor.speechRender(previewElement);
<\/script>
<script src="`).concat(t.options.cdn,"/dist/js/icons/").concat(t.options.icon,'.js"><\/script></body></html>');po(t,i,n.substr(0,10)+".html")},El=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),xl=function(t){El(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=o.element.children[0],S=document.createElement("div");return S.className="vditor-hint".concat(a.level===2?"":" vditor-panel--arrow"),S.innerHTML=`<button data-type="markdown">Markdown</button>
<button data-type="pdf">PDF</button>
<button data-type="html">HTML</button>`,S.addEventListener((0,f.y3)(),function(A){var O=A.target;if(O.tagName==="BUTTON"){switch(O.getAttribute("data-type")){case"markdown":yl(i);break;case"pdf":wl(i);break;case"html":kl(i);break}T(i,["subToolbar"]),A.preventDefault(),A.stopPropagation()}}),o.element.appendChild(S),M(i,S,c,a.level),o}return n}(dt),Sl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Cl=function(t){Sl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o._bindEvent(i,a),o}return n.prototype._bindEvent=function(i,a){this.element.children[0].addEventListener((0,f.y3)(),function(o){o.preventDefault(),i.element.className.includes("vditor--fullscreen")?(a.level||(this.innerHTML=a.icon),i.element.style.zIndex="",document.body.style.overflow="",i.element.classList.remove("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(c){var S=i.toolbar.elements[c].firstChild;S&&(S.className=S.className.replace("__s","__n"),i.options.toolbar.forEach(function(A){typeof A!="string"&&A.tipPosition&&A.name===S.dataset.type&&(S.className="vditor-tooltipped vditor-tooltipped__".concat(A.tipPosition))}))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__s","__n"))):(a.level||(this.innerHTML='<svg><use xlink:href="#vditor-icon-contract"></use></svg>'),i.element.style.zIndex=i.options.fullscreen.index.toString(),document.body.style.overflow="hidden",i.element.classList.add("vditor--fullscreen"),Object.keys(i.toolbar.elements).forEach(function(c){var S=i.toolbar.elements[c].firstChild;S&&(S.className=S.className.replace("__n","__s"))}),i.counter&&(i.counter.element.className=i.counter.element.className.replace("__n","__s"))),i.devtools&&i.devtools.renderEchart(i),a.click&&a.click(o,i),wt(i),nt(i)})},n}(dt),_l=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Tl=function(t){_l(n,t);function n(i,a){var o=t.call(this,i,a)||this,c=document.createElement("div");return c.className="vditor-hint vditor-panel--arrow",c.innerHTML='<button data-tag="h1" data-value="# ">'.concat(window.VditorI18n.heading1," ").concat((0,f.fG)("&lt;⌥⌘1>"),`</button>
<button data-tag="h2" data-value="## ">`).concat(window.VditorI18n.heading2," &lt;").concat((0,f.fG)("⌥⌘2"),`></button>
<button data-tag="h3" data-value="### ">`).concat(window.VditorI18n.heading3," &lt;").concat((0,f.fG)("⌥⌘3"),`></button>
<button data-tag="h4" data-value="#### ">`).concat(window.VditorI18n.heading4," &lt;").concat((0,f.fG)("⌥⌘4"),`></button>
<button data-tag="h5" data-value="##### ">`).concat(window.VditorI18n.heading5," &lt;").concat((0,f.fG)("⌥⌘5"),`></button>
<button data-tag="h6" data-value="###### ">`).concat(window.VditorI18n.heading6," &lt;").concat((0,f.fG)("⌥⌘6"),"></button>"),o.element.appendChild(c),o._bindEvent(i,c),o}return n.prototype._bindEvent=function(i,a){var o=this.element.children[0];o.addEventListener((0,f.y3)(),function(S){S.preventDefault(),clearTimeout(i.wysiwyg.afterRenderTimeoutId),clearTimeout(i.ir.processTimeoutId),clearTimeout(i.sv.processTimeoutId),!o.classList.contains(u.Y.CLASS_MENU_DISABLED)&&(o.blur(),o.classList.contains("vditor-menu--current")?(i.currentMode==="wysiwyg"?(Bt(i),ht(i)):i.currentMode==="ir"&&An(i,""),o.classList.remove("vditor-menu--current")):(T(i,["subToolbar"]),a.style.display="block"))});for(var c=0;c<6;c++)a.children.item(c).addEventListener((0,f.y3)(),function(S){S.preventDefault(),i.currentMode==="wysiwyg"?(hn(i,S.target.getAttribute("data-tag")),ht(i),o.classList.add("vditor-menu--current")):i.currentMode==="ir"?(An(i,S.target.getAttribute("data-value")),o.classList.add("vditor-menu--current")):ut(i,S.target.getAttribute("data-value")),a.style.display="none"})},n}(dt),Ml=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Al=function(t){Ml(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),i.tip.show(`<div style="margin-bottom:14px;font-size: 14px;line-height: 22px;min-width:300px;max-width: 360px;display: flex;">
<div style="margin-top: 14px;flex: 1">
    <div>Markdown 使用指南</div>
    <ul style="list-style: none">
        <li><a href="https://ld246.com/article/1583308420519" target="_blank">语法速查手册</a></li>
        <li><a href="https://ld246.com/article/1583129520165" target="_blank">基础语法</a></li>
        <li><a href="https://ld246.com/article/1583305480675" target="_blank">扩展语法</a></li>
        <li><a href="https://ld246.com/article/1582778815353" target="_blank">键盘快捷键</a></li>
    </ul>
</div>
<div style="margin-top: 14px;flex: 1">
    <div>Vditor 支持</div>
    <ul style="list-style: none">
        <li><a href="https://github.com/Vanessa219/vditor/issues" target="_blank">Issues</a></li>
        <li><a href="https://ld246.com/tag/vditor" target="_blank">官方讨论区</a></li>
        <li><a href="https://ld246.com/article/1549638745630" target="_blank">开发手册</a></li>
        <li><a href="https://ld246.com/guide/markdown" target="_blank">演示地址</a></li>
    </ul>
</div></div>`,0)}),o}return n}(dt),Ll=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Dl=function(t){Ll(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){if(c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var S=(0,B.RN)(i),A=(0,v._Y)(S.startContainer,"LI");A&&vr(i,A,S)}}),o}return n}(dt),Ol=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Pl=function(t){Ol(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),i.tip.show(`<div style="max-width: 520px; font-size: 14px;line-height: 22px;margin-bottom: 14px;">
<p style="text-align: center;margin: 14px 0">
    <em>下一代的 Markdown 编辑器，为未来而构建</em>
</p>
<div style="display: flex;margin-bottom: 14px;flex-wrap: wrap;align-items: center">
    <img src="https://unpkg.com/vditor/dist/images/logo.png" style="margin: 0 auto;height: 68px"/>
    <div>&nbsp;&nbsp;</div>
    <div style="flex: 1;min-width: 250px">
        Vditor 是一款浏览器端的 Markdown 编辑器，支持所见即所得、即时渲染（类似 Typora）和分屏预览模式。
        它使用 TypeScript 实现，支持原生 JavaScript 以及 Vue、React、Angular 和 Svelte 等框架。
    </div>
</div>
<div style="display: flex;flex-wrap: wrap;">
    <ul style="list-style: none;flex: 1;min-width:148px">
        <li>
        项目地址：<a href="https://b3log.org/vditor" target="_blank">b3log.org/vditor</a>
        </li>
        <li>
        开源协议：MIT
        </li>
    </ul>
    <ul style="list-style: none;margin-right: 18px">
        <li>
        组件版本：Vditor v`.concat(u.g," / Lute v").concat(Lute.Version,`
        </li>
        <li>
        赞助捐赠：<a href="https://ld246.com/sponsor" target="_blank">https://ld246.com/sponsor</a>
        </li>
    </ul>
</div>
</div>`),0)}),o}return n}(dt),Rl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Il=function(t){Rl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&fi(i,"afterend")}),o}return n}(dt),Hl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Nl=function(t){Hl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")&&fi(i,"beforebegin")}),o}return n}(dt),jl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),$l=function(t){jl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o.element.children[0].addEventListener((0,f.y3)(),function(c){if(c.preventDefault(),!(o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)||i.currentMode==="sv")){var S=(0,B.RN)(i),A=(0,v._Y)(S.startContainer,"LI");A&&Wi(i,A,S,A.parentElement)}}),o}return n}(dt),Bl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Ul=function(t){Bl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return i.options.outline&&o.element.firstElementChild.classList.add("vditor-menu--current"),o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault();var S=i.toolbar.elements.outline.firstElementChild;S.classList.contains(u.Y.CLASS_MENU_DISABLED)||(i.options.outline.enable=!o.element.firstElementChild.classList.contains("vditor-menu--current"),i.outline.toggle(i,i.options.outline.enable))}),o}return n}(dt),zl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Fl=function(t){zl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o._bindEvent(i),o}return n.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,f.y3)(),function(o){o.preventDefault();var c=a.element.firstElementChild;if(!c.classList.contains(u.Y.CLASS_MENU_DISABLED)){var S=u.Y.EDIT_TOOLBARS.concat(["both","edit-mode","devtools"]);c.classList.contains("vditor-menu--current")?(c.classList.remove("vditor-menu--current"),i.currentMode==="sv"?(i.sv.element.style.display="block",i.options.preview.mode==="both"?i.preview.element.style.display="block":i.preview.element.style.display="none"):(i[i.currentMode].element.parentElement.style.display="block",i.preview.element.style.display="none"),E(i.toolbar.elements,S),i.outline.render(i)):(w(i.toolbar.elements,S),i.preview.element.style.display="block",i.currentMode==="sv"?i.sv.element.style.display="none":i[i.currentMode].element.parentElement.style.display="none",i.preview.render(i),c.classList.add("vditor-menu--current"),T(i,["subToolbar","hint","popover"]),setTimeout(function(){i.outline.render(i)},i.options.preview.delay+10)),wt(i)}})},n}(dt),Vl=function(){function t(n){this.SAMPLE_RATE=5e3,this.isRecording=!1,this.readyFlag=!1,this.leftChannel=[],this.rightChannel=[],this.recordingLength=0;var i;if(typeof AudioContext<"u")i=new AudioContext;else if(webkitAudioContext)i=new webkitAudioContext;else return;this.DEFAULT_SAMPLE_RATE=i.sampleRate;var a=i.createGain(),o=i.createMediaStreamSource(n);o.connect(a),this.recorder=i.createScriptProcessor(2048,2,1),this.recorder.onaudioprocess=null,a.connect(this.recorder),this.recorder.connect(i.destination),this.readyFlag=!0}return t.prototype.cloneChannelData=function(n,i){this.leftChannel.push(new Float32Array(n)),this.rightChannel.push(new Float32Array(i)),this.recordingLength+=2048},t.prototype.startRecordingNewWavFile=function(){this.readyFlag&&(this.isRecording=!0,this.leftChannel.length=this.rightChannel.length=0,this.recordingLength=0)},t.prototype.stopRecording=function(){this.isRecording=!1},t.prototype.buildWavFileBlob=function(){for(var n=this.mergeBuffers(this.leftChannel),i=this.mergeBuffers(this.rightChannel),a=new Float32Array(n.length),o=0;o<n.length;++o)a[o]=.5*(n[o]+i[o]);this.DEFAULT_SAMPLE_RATE>this.SAMPLE_RATE&&(a=this.downSampleBuffer(a,this.SAMPLE_RATE));var c=44+a.length*2,S=new ArrayBuffer(c),A=new DataView(S);this.writeUTFBytes(A,0,"RIFF"),A.setUint32(4,c,!0),this.writeUTFBytes(A,8,"WAVE"),this.writeUTFBytes(A,12,"fmt "),A.setUint32(16,16,!0),A.setUint16(20,1,!0),A.setUint16(22,1,!0),A.setUint32(24,this.SAMPLE_RATE,!0),A.setUint32(28,this.SAMPLE_RATE*2,!0),A.setUint16(32,2,!0),A.setUint16(34,16,!0);var O=a.length*2;this.writeUTFBytes(A,36,"data"),A.setUint32(40,O,!0);for(var L=a.length,$=44,K=1,ye=0;ye<L;ye++)A.setInt16($,a[ye]*(32767*K),!0),$+=2;return new Blob([A],{type:"audio/wav"})},t.prototype.downSampleBuffer=function(n,i){if(i===this.DEFAULT_SAMPLE_RATE||i>this.DEFAULT_SAMPLE_RATE)return n;for(var a=this.DEFAULT_SAMPLE_RATE/i,o=Math.round(n.length/a),c=new Float32Array(o),S=0,A=0;S<c.length;){for(var O=Math.round((S+1)*a),L=0,$=0,K=A;K<O&&K<n.length;K++)L+=n[K],$++;c[S]=L/$,S++,A=O}return c},t.prototype.mergeBuffers=function(n){for(var i=new Float32Array(this.recordingLength),a=0,o=n.length,c=0;c<o;++c){var S=n[c];i.set(S,a),a+=S.length}return i},t.prototype.writeUTFBytes=function(n,i,a){for(var o=a.length,c=0;c<o;c++)n.setUint8(i+c,a.charCodeAt(c))},t}(),ql=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Wl=function(t){ql(n,t);function n(i,a){var o=t.call(this,i,a)||this;return o._bindEvent(i),o}return n.prototype._bindEvent=function(i){var a=this,o;this.element.children[0].addEventListener((0,f.y3)(),function(c){if(c.preventDefault(),!a.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)){var S=i[i.currentMode].element;if(!o){navigator.mediaDevices.getUserMedia({audio:!0}).then(function(O){o=new Vl(O),o.recorder.onaudioprocess=function(L){if(o.isRecording){var $=L.inputBuffer.getChannelData(0),K=L.inputBuffer.getChannelData(1);o.cloneChannelData($,K)}},o.startRecordingNewWavFile(),i.tip.show(window.VditorI18n.recording),S.setAttribute("contenteditable","false"),a.element.children[0].classList.add("vditor-menu--current")}).catch(function(){i.tip.show(window.VditorI18n["record-tip"])});return}if(o.isRecording){o.stopRecording(),i.tip.hide();var A=new File([o.buildWavFileBlob()],"record".concat(new Date().getTime(),".wav"),{type:"video/webm"});$n(i,[A]),a.element.children[0].classList.remove("vditor-menu--current")}else i.tip.show(window.VditorI18n.recording),S.setAttribute("contenteditable","false"),o.startRecordingNewWavFile(),a.element.children[0].classList.add("vditor-menu--current")}})},n}(dt),Yl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Kl=function(t){Yl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return w({redo:o.element},["redo"]),o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)&&i.undo.redo(i)}),o}return n}(dt),Gl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Xl=function(t){Gl(n,t);function n(i,a){var o=t.call(this,i,a)||this;return w({undo:o.element},["undo"]),o.element.children[0].addEventListener((0,f.y3)(),function(c){c.preventDefault(),!o.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)&&i.undo.undo(i)}),o}return n}(dt),Zl=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),Jl=function(t){Zl(n,t);function n(i,a){var o=t.call(this,i,a)||this,c='<input type="file"';return i.options.upload.multiple&&(c+=' multiple="multiple"'),i.options.upload.accept&&(c+=' accept="'.concat(i.options.upload.accept,'"')),o.element.children[0].innerHTML="".concat(a.icon||'<svg><use xlink:href="#vditor-icon-upload"></use></svg>').concat(c,">"),o._bindEvent(i),o}return n.prototype._bindEvent=function(i){var a=this;this.element.children[0].addEventListener((0,f.y3)(),function(o){if(a.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}}),this.element.querySelector("input").addEventListener("change",function(o){if(a.element.firstElementChild.classList.contains(u.Y.CLASS_MENU_DISABLED)){o.stopPropagation(),o.preventDefault();return}o.target.files.length!==0&&$n(i,o.target.files,o.target)})},n}(dt),Ql=function(){function t(n){var i=this,a=n.options;this.elements={},this.element=document.createElement("div"),this.element.className="vditor-toolbar",a.toolbar.forEach(function(o,c){var S=i.genItem(n,o,c);if(i.element.appendChild(S),o.toolbar){var A=document.createElement("div");A.className="vditor-hint vditor-panel--arrow",A.addEventListener((0,f.y3)(),function(O){A.style.display="none"}),o.toolbar.forEach(function(O,L){O.level=2,A.appendChild(i.genItem(n,O,c+L))}),S.appendChild(A),M(n,A,S.children[0])}}),n.options.toolbarConfig.hide&&this.element.classList.add("vditor-toolbar--hide"),n.options.toolbarConfig.pin&&this.element.classList.add("vditor-toolbar--pin"),n.options.counter.enable&&(n.counter=new dl(n),this.element.appendChild(n.counter.element))}return t.prototype.updateConfig=function(n,i){n.options.toolbarConfig=Object.assign({hide:!1,pin:!1},i),n.options.toolbarConfig.hide?this.element.classList.add("vditor-toolbar--hide"):this.element.classList.remove("vditor-toolbar--hide"),n.options.toolbarConfig.pin?this.element.classList.add("vditor-toolbar--pin"):this.element.classList.remove("vditor-toolbar--pin")},t.prototype.genItem=function(n,i,a){var o;switch(i.name){case"bold":case"italic":case"more":case"strike":case"line":case"quote":case"list":case"ordered-list":case"check":case"code":case"inline-code":case"link":case"table":o=new dt(n,i);break;case"emoji":o=new bl(n,i);break;case"headings":o=new Tl(n,i);break;case"|":o=new gl;break;case"br":o=new ol;break;case"undo":o=new Xl(n,i);break;case"redo":o=new Kl(n,i);break;case"help":o=new Al(n,i);break;case"both":o=new al(n,i);break;case"preview":o=new Fl(n,i);break;case"fullscreen":o=new Cl(n,i);break;case"upload":o=new Jl(n,i);break;case"record":o=new Wl(n,i);break;case"info":o=new Pl(n,i);break;case"edit-mode":o=new jt(n,i);break;case"devtools":o=new ml(n,i);break;case"outdent":o=new $l(n,i);break;case"indent":o=new Dl(n,i);break;case"outline":o=new Ul(n,i);break;case"insert-after":o=new Il(n,i);break;case"insert-before":o=new Nl(n,i);break;case"code-theme":o=new ll(n,i);break;case"content-theme":o=new ul(n,i);break;case"export":o=new xl(n,i);break;default:o=new hl(n,i);break}if(o){var c=i.name;return(c==="br"||c==="|")&&(c=c+a),this.elements[c]=o.element,o.element}},t}(),ec=l(192),tc=function(){function t(){this.stackSize=50,this.resetStack(),this.dmp=new ec}return t.prototype.clearStack=function(n){this.resetStack(),this.resetIcon(n)},t.prototype.resetIcon=function(n){n.toolbar&&(this[n.currentMode].undoStack.length>1?E(n.toolbar.elements,["undo"]):w(n.toolbar.elements,["undo"]),this[n.currentMode].redoStack.length!==0?E(n.toolbar.elements,["redo"]):w(n.toolbar.elements,["redo"]))},t.prototype.undo=function(n){if(n[n.currentMode].element.getAttribute("contenteditable")!=="false"&&!(this[n.currentMode].undoStack.length<2)){var i=this[n.currentMode].undoStack.pop();i&&(this[n.currentMode].redoStack.push(i),this.renderDiff(i,n),this[n.currentMode].hasUndo=!0,T(n,["hint"]))}},t.prototype.redo=function(n){if(n[n.currentMode].element.getAttribute("contenteditable")!=="false"){var i=this[n.currentMode].redoStack.pop();i&&(this[n.currentMode].undoStack.push(i),this.renderDiff(i,n,!0))}},t.prototype.recordFirstPosition=function(n,i){if(getSelection().rangeCount!==0&&!(this[n.currentMode].undoStack.length!==1||this[n.currentMode].undoStack[0].length===0||this[n.currentMode].redoStack.length>0)&&!((0,f.gm)()&&i.key==="Backspace")&&!(0,f.nr)()){var a=this.addCaret(n);a.replace("<wbr>","").replace(" vditor-ir__node--expand","")===this[n.currentMode].undoStack[0][0].diffs[0][1].replace("<wbr>","")&&(this[n.currentMode].undoStack[0][0].diffs[0][1]=a,this[n.currentMode].lastText=a)}},t.prototype.addToUndoStack=function(n){var i=this.addCaret(n,!0),a=this.dmp.diff_main(i,this[n.currentMode].lastText,!0),o=this.dmp.patch_make(i,this[n.currentMode].lastText,a);o.length===0&&this[n.currentMode].undoStack.length>0||(this[n.currentMode].lastText=i,this[n.currentMode].undoStack.push(o),this[n.currentMode].undoStack.length>this.stackSize&&this[n.currentMode].undoStack.shift(),this[n.currentMode].hasUndo&&(this[n.currentMode].redoStack=[],this[n.currentMode].hasUndo=!1,w(n.toolbar.elements,["redo"])),this[n.currentMode].undoStack.length>1&&E(n.toolbar.elements,["undo"]))},t.prototype.renderDiff=function(n,i,a){a===void 0&&(a=!1);var o;if(a){var c=this.dmp.patch_deepCopy(n).reverse();c.forEach(function(A){A.diffs.forEach(function(O){O[0]=-O[0]})}),o=this.dmp.patch_apply(c,this[i.currentMode].lastText)[0]}else o=this.dmp.patch_apply(n,this[i.currentMode].lastText)[0];if(this[i.currentMode].lastText=o,i[i.currentMode].element.innerHTML=o,i.currentMode!=="sv"&&(i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview")).forEach(function(A){A.parentElement.querySelector(".language-echarts")&&(i.currentMode==="ir"?A.parentElement.outerHTML=i.lute.SpinVditorIRDOM(A.parentElement.outerHTML):A.parentElement.outerHTML=i.lute.SpinVditorDOM(A.parentElement.outerHTML))}),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(A){rt(A,i)})),i[i.currentMode].element.querySelector("wbr"))(0,B.ir)(i[i.currentMode].element,i[i.currentMode].element.ownerDocument.createRange()),Dt(i);else{var S=getSelection().getRangeAt(0);S.setEndBefore(i[i.currentMode].element),S.collapse(!1)}le(i),st(i,{enableAddUndoStack:!1,enableHint:!1,enableInput:!0}),ve(i),i[i.currentMode].element.querySelectorAll(".vditor-".concat(i.currentMode,"__preview[data-render='2']")).forEach(function(A){rt(A,i)}),this[i.currentMode].undoStack.length>1?E(i.toolbar.elements,["undo"]):w(i.toolbar.elements,["undo"]),this[i.currentMode].redoStack.length!==0?E(i.toolbar.elements,["redo"]):w(i.toolbar.elements,["redo"])},t.prototype.resetStack=function(){this.ir={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.sv={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]},this.wysiwyg={hasUndo:!1,lastText:"",redoStack:[],undoStack:[]}},t.prototype.addCaret=function(n,i){i===void 0&&(i=!1);var a;if(getSelection().rangeCount!==0&&!n[n.currentMode].element.querySelector("wbr")){var o=getSelection().getRangeAt(0);if(n[n.currentMode].element.contains(o.startContainer)){a=o.cloneRange();var c=document.createElement("span");c.className="vditor-wbr",o.insertNode(c)}}var S=n[n.currentMode].element.cloneNode(!0);S.querySelectorAll(".vditor-".concat(n.currentMode,"__preview[data-render='1']")).forEach(function(O){O.firstElementChild&&(O.firstElementChild.classList.contains("language-echarts")||O.firstElementChild.classList.contains("language-plantuml")||O.firstElementChild.classList.contains("language-mindmap")?(O.firstElementChild.removeAttribute("_echarts_instance_"),O.firstElementChild.removeAttribute("data-processed"),O.firstElementChild.innerHTML=O.previousElementSibling.firstElementChild.innerHTML,O.setAttribute("data-render","2")):O.firstElementChild.classList.contains("language-math")&&(O.setAttribute("data-render","2"),O.firstElementChild.textContent=O.firstElementChild.getAttribute("data-math"),O.firstElementChild.removeAttribute("data-math")))});var A=S.innerHTML;return n[n.currentMode].element.querySelectorAll(".vditor-wbr").forEach(function(O){O.remove()}),i&&a&&(0,B.jl)(a),A.replace('<span class="vditor-wbr"></span>',"<wbr>")},t}(),nc=l(905),ic=function(){function t(n){this.defaultOptions={rtl:!1,after:void 0,cache:{enable:!0},cdn:u.Y.CDN,classes:{preview:""},comment:{enable:!1},counter:{enable:!1,type:"markdown"},customRenders:[],debugger:!1,fullscreen:{index:90},height:"auto",hint:{delay:200,emoji:{"+1":"👍","-1":"👎",confused:"😕",eyes:"👀️",heart:"❤️",rocket:"🚀️",smile:"😄",tada:"🎉️"},emojiPath:"".concat(u.Y.CDN,"/dist/images/emoji"),extend:[],parse:!0},icon:"ant",lang:"zh_CN",mode:"ir",outline:{enable:!1,position:"left"},placeholder:"",preview:{actions:["desktop","tablet","mobile","mp-wechat","zhihu"],delay:1e3,hljs:u.Y.HLJS_OPTIONS,markdown:u.Y.MARKDOWN_OPTIONS,math:u.Y.MATH_OPTIONS,maxWidth:800,mode:"both",theme:u.Y.THEME_OPTIONS,render:{media:{enable:!0}}},link:{isOpen:!0},image:{isPreview:!0},resize:{enable:!1,position:"bottom"},theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","outdent","indent","|","quote","line","code","inline-code","insert-before","insert-after","|","upload","record","table","|","undo","redo","|","fullscreen","edit-mode",{name:"more",toolbar:["both","code-theme","content-theme","export","outline","preview","devtools","info","help"]}],toolbarConfig:{hide:!1,pin:!1},typewriterMode:!1,undoDelay:800,upload:{extraData:{},fieldName:"file[]",filename:function(i){return i.replace(/\W/g,"")},linkToImgUrl:"",max:10*1024*1024,multiple:!0,url:"",withCredentials:!1},value:"",width:"auto"},this.options=n}return t.prototype.merge=function(){var n,i,a,o,c,S,A,O,L;this.options&&(this.options.toolbar?this.options.toolbar=this.mergeToolbar(this.options.toolbar):this.options.toolbar=this.mergeToolbar(this.defaultOptions.toolbar),!((i=(n=this.options.preview)===null||n===void 0?void 0:n.theme)===null||i===void 0)&&i.list&&(this.defaultOptions.preview.theme.list=this.options.preview.theme.list),!((c=(o=(a=this.options.preview)===null||a===void 0?void 0:a.render)===null||o===void 0?void 0:o.media)===null||c===void 0)&&c.enable&&(this.defaultOptions.preview.render.media.enable=this.options.preview.render.media.enable),!((S=this.options.hint)===null||S===void 0)&&S.emoji&&(this.defaultOptions.hint.emoji=this.options.hint.emoji),this.options.comment&&(this.defaultOptions.comment=this.options.comment),this.options.cdn&&(!((O=(A=this.options.preview)===null||A===void 0?void 0:A.theme)===null||O===void 0)&&O.path||(this.defaultOptions.preview.theme.path="".concat(this.options.cdn,"/dist/css/content-theme")),!((L=this.options.hint)===null||L===void 0)&&L.emojiPath||(this.defaultOptions.hint.emojiPath="".concat(this.options.cdn,"/dist/images/emoji"))));var $=(0,nc.h)(this.defaultOptions,this.options);if($.cache.enable&&!$.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");return $},t.prototype.mergeToolbar=function(n){var i=this,a=[{icon:'<svg><use xlink:href="#vditor-icon-export"></use></svg>',name:"export",tipPosition:"ne"},{hotkey:"⌘E",icon:'<svg><use xlink:href="#vditor-icon-emoji"></use></svg>',name:"emoji",tipPosition:"ne"},{hotkey:"⌘H",icon:'<svg><use xlink:href="#vditor-icon-headings"></use></svg>',name:"headings",tipPosition:"ne"},{hotkey:"⌘B",icon:'<svg><use xlink:href="#vditor-icon-bold"></use></svg>',name:"bold",prefix:"**",suffix:"**",tipPosition:"ne"},{hotkey:"⌘I",icon:'<svg><use xlink:href="#vditor-icon-italic"></use></svg>',name:"italic",prefix:"*",suffix:"*",tipPosition:"ne"},{hotkey:"⌘D",icon:'<svg><use xlink:href="#vditor-icon-strike"></use></svg>',name:"strike",prefix:"~~",suffix:"~~",tipPosition:"ne"},{hotkey:"⌘K",icon:'<svg><use xlink:href="#vditor-icon-link"></use></svg>',name:"link",prefix:"[",suffix:"](https://)",tipPosition:"n"},{name:"|"},{hotkey:"⌘L",icon:'<svg><use xlink:href="#vditor-icon-list"></use></svg>',name:"list",prefix:"* ",tipPosition:"n"},{hotkey:"⌘O",icon:'<svg><use xlink:href="#vditor-icon-ordered-list"></use></svg>',name:"ordered-list",prefix:"1. ",tipPosition:"n"},{hotkey:"⌘J",icon:'<svg><use xlink:href="#vditor-icon-check"></use></svg>',name:"check",prefix:"* [ ] ",tipPosition:"n"},{hotkey:"⇧⌘I",icon:'<svg><use xlink:href="#vditor-icon-outdent"></use></svg>',name:"outdent",tipPosition:"n"},{hotkey:"⇧⌘O",icon:'<svg><use xlink:href="#vditor-icon-indent"></use></svg>',name:"indent",tipPosition:"n"},{name:"|"},{hotkey:"⌘;",icon:'<svg><use xlink:href="#vditor-icon-quote"></use></svg>',name:"quote",prefix:"> ",tipPosition:"n"},{hotkey:"⇧⌘H",icon:'<svg><use xlink:href="#vditor-icon-line"></use></svg>',name:"line",prefix:"---",tipPosition:"n"},{hotkey:"⌘U",icon:'<svg><use xlink:href="#vditor-icon-code"></use></svg>',name:"code",prefix:"```",suffix:"\n```",tipPosition:"n"},{hotkey:"⌘G",icon:'<svg><use xlink:href="#vditor-icon-inline-code"></use></svg>',name:"inline-code",prefix:"`",suffix:"`",tipPosition:"n"},{hotkey:"⇧⌘B",icon:'<svg><use xlink:href="#vditor-icon-before"></use></svg>',name:"insert-before",tipPosition:"n"},{hotkey:"⇧⌘E",icon:'<svg><use xlink:href="#vditor-icon-after"></use></svg>',name:"insert-after",tipPosition:"n"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-upload"></use></svg>',name:"upload",tipPosition:"n"},{icon:'<svg><use xlink:href="#vditor-icon-record"></use></svg>',name:"record",tipPosition:"n"},{hotkey:"⌘M",icon:'<svg><use xlink:href="#vditor-icon-table"></use></svg>',name:"table",prefix:"| col1",suffix:` | col2 | col3 |
| --- | --- | --- |
|  |  |  |
|  |  |  |`,tipPosition:"n"},{name:"|"},{hotkey:"⌘Z",icon:'<svg><use xlink:href="#vditor-icon-undo"></use></svg>',name:"undo",tipPosition:"nw"},{hotkey:"⌘Y",icon:'<svg><use xlink:href="#vditor-icon-redo"></use></svg>',name:"redo",tipPosition:"nw"},{name:"|"},{icon:'<svg><use xlink:href="#vditor-icon-more"></use></svg>',name:"more",tipPosition:"e"},{hotkey:"⌘'",icon:'<svg><use xlink:href="#vditor-icon-fullscreen"></use></svg>',name:"fullscreen",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-edit"></use></svg>',name:"edit-mode",tipPosition:"nw"},{hotkey:"⌘P",icon:'<svg><use xlink:href="#vditor-icon-both"></use></svg>',name:"both",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-preview"></use></svg>',name:"preview",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-align-center"></use></svg>',name:"outline",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-theme"></use></svg>',name:"content-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-code-theme"></use></svg>',name:"code-theme",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-bug"></use></svg>',name:"devtools",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-info"></use></svg>',name:"info",tipPosition:"nw"},{icon:'<svg><use xlink:href="#vditor-icon-help"></use></svg>',name:"help",tipPosition:"nw"},{name:"br"}],o=[];return n.forEach(function(c){var S=c;a.forEach(function(A){typeof c=="string"&&A.name===c&&(S=A),typeof c=="object"&&A.name===c.name&&(S=Object.assign({},A,c))}),c.toolbar&&(S.toolbar=i.mergeToolbar(c.toolbar)),o.push(S)}),o},t}(),rc=function(){function t(n){var i=this;this.composingLock=!1,this.commentIds=[];var a=document.createElement("div");a.className="vditor-wysiwyg",a.innerHTML='<pre class="vditor-reset" placeholder="'.concat(n.options.placeholder,`"
 contenteditable="true" spellcheck="false"></pre>
<div class="vditor-panel vditor-panel--none"></div>
<div class="vditor-panel vditor-panel--none">
    <button type="button" aria-label="`).concat(window.VditorI18n.comment,`" class="vditor-icon vditor-tooltipped vditor-tooltipped__n">
        <svg><use xlink:href="#vditor-icon-comment"></use></svg>
    </button>
</div>`),this.element=a.firstElementChild,this.popover=a.firstElementChild.nextElementSibling,this.selectPopover=a.lastElementChild,this.bindEvent(n),$t(n,this.element),kn(n,this.element),En(n,this.element),cn(n,this.element),at(n,this.element),ni(n,this.element),ln(n,this.element,this.copy),Nn(n,this.element,this.copy),n.options.comment.enable&&(this.selectPopover.querySelector("button").onclick=function(){var o=Lute.NewNodeID(),c=getSelection().getRangeAt(0),S=c.cloneRange(),A=c.extractContents(),O,L,$=!1,K=!1;A.childNodes.forEach(function(me,$e){var Te=!1;if(me.nodeType===3?Te=!0:me.classList.contains("vditor-comment")?me.classList.contains("vditor-comment")&&me.setAttribute("data-cmtids",me.getAttribute("data-cmtids")+" "+o):Te=!0,Te)if(me.nodeType!==3&&me.getAttribute("data-block")==="0"&&$e===0&&S.startOffset>0)me.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(me.innerHTML,"</span>"),O=me;else if(me.nodeType!==3&&me.getAttribute("data-block")==="0"&&$e===A.childNodes.length-1&&S.endOffset<S.endContainer.textContent.length)me.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(me.innerHTML,"</span>"),L=me;else if(me.nodeType!==3&&me.getAttribute("data-block")==="0")$e===0?$=!0:$e===A.childNodes.length-1&&(K=!0),me.innerHTML='<span class="vditor-comment" data-cmtids="'.concat(o,'">').concat(me.innerHTML,"</span>");else{var fe=document.createElement("span");fe.classList.add("vditor-comment"),fe.setAttribute("data-cmtids",o),me.parentNode.insertBefore(fe,me),fe.appendChild(me)}});var ye=(0,v.pt)(S.startContainer);ye&&(O?(ye.insertAdjacentHTML("beforeend",O.innerHTML),O.remove()):ye.textContent.trim().replace(u.Y.ZWSP,"")===""&&$&&ye.remove());var be=(0,v.pt)(S.endContainer);be&&(L?(be.insertAdjacentHTML("afterbegin",L.innerHTML),L.remove()):be.textContent.trim().replace(u.Y.ZWSP,"")===""&&K&&be.remove()),c.insertNode(A),n.options.comment.add(o,c.toString(),i.getComments(n,!0)),ht(n,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}),i.hideComment()})}return t.prototype.getComments=function(n,i){var a=this;if(i===void 0&&(i=!1),n.currentMode==="wysiwyg"&&n.options.comment.enable){this.commentIds=[],this.element.querySelectorAll(".vditor-comment").forEach(function(c){a.commentIds=a.commentIds.concat(c.getAttribute("data-cmtids").split(" "))}),this.commentIds=Array.from(new Set(this.commentIds));var o=[];if(i)return this.commentIds.forEach(function(c){o.push({id:c,top:a.element.querySelector('.vditor-comment[data-cmtids="'.concat(c,'"]')).offsetTop})}),o}else return[]},t.prototype.triggerRemoveComment=function(n){var i=function(c,S){var A=new Set(S);return c.filter(function(O){return!A.has(O)})};if(n.currentMode==="wysiwyg"&&n.options.comment.enable&&n.wysiwyg.commentIds.length>0){var a=JSON.parse(JSON.stringify(this.commentIds));this.getComments(n);var o=i(a,this.commentIds);o.length>0&&n.options.comment.remove(o)}},t.prototype.showComment=function(){var n=(0,B.Ey)(this.element);this.selectPopover.setAttribute("style","left:".concat(n.left,"px;display:block;top:").concat(Math.max(-8,n.top-21),"px"))},t.prototype.hideComment=function(){this.selectPopover.setAttribute("style","display:none")},t.prototype.unbindListener=function(){window.removeEventListener("scroll",this.scrollListener)},t.prototype.copy=function(n,i){var a=getSelection().getRangeAt(0);if(a.toString()!==""){n.stopPropagation(),n.preventDefault();var o=(0,v._Y)(a.startContainer,"CODE"),c=(0,v._Y)(a.endContainer,"CODE");if(o&&c&&c.isSameNode(o)){var S="";o.parentElement.tagName==="PRE"?S=a.toString():S="`"+a.toString()+"`",n.clipboardData.setData("text/plain",S),n.clipboardData.setData("text/html","");return}var A=(0,v._Y)(a.startContainer,"A"),O=(0,v._Y)(a.endContainer,"A");if(A&&O&&O.isSameNode(A)){var L=A.getAttribute("title")||"";L&&(L=' "'.concat(L,'"')),n.clipboardData.setData("text/plain","[".concat(a.toString(),"](").concat(A.getAttribute("href")).concat(L,")")),n.clipboardData.setData("text/html","");return}var $=document.createElement("div");$.appendChild(a.cloneContents()),n.clipboardData.setData("text/plain",i.lute.VditorDOM2Md($.innerHTML).trim()),n.clipboardData.setData("text/html","")}},t.prototype.bindEvent=function(n){var i=this;this.unbindListener(),window.addEventListener("scroll",this.scrollListener=function(){if(T(n,["hint"]),!(i.popover.style.display!=="block"||i.selectPopover.style.display!=="block")){var a=parseInt(i.popover.getAttribute("data-top"),10);if(n.options.height!=="auto"){if(n.options.toolbarConfig.pin&&n.toolbar.element.getBoundingClientRect().top===0){var o=Math.max(window.scrollY-n.element.offsetTop-8,Math.min(a-n.wysiwyg.element.scrollTop,i.element.clientHeight-21))+"px";i.popover.style.display==="block"&&(i.popover.style.top=o),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=o)}return}else if(!n.options.toolbarConfig.pin)return;var c=Math.max(a,window.scrollY-n.element.offsetTop-8)+"px";i.popover.style.display==="block"&&(i.popover.style.top=c),i.selectPopover.style.display==="block"&&(i.selectPopover.style.top=c)}}),this.element.addEventListener("scroll",function(){if(T(n,["hint"]),n.options.comment&&n.options.comment.enable&&n.options.comment.scroll&&n.options.comment.scroll(n.wysiwyg.element.scrollTop),i.popover.style.display==="block"){var a=parseInt(i.popover.getAttribute("data-top"),10)-n.wysiwyg.element.scrollTop,o=-8;n.options.toolbarConfig.pin&&n.toolbar.element.getBoundingClientRect().top===0&&(o=window.scrollY-n.element.offsetTop+o);var c=Math.max(o,Math.min(a,i.element.clientHeight-21))+"px";i.popover.style.top=c,i.selectPopover.style.top=c}}),this.element.addEventListener("paste",function(a){Ft(n,a,{pasteCode:function(o){var c=(0,B.RN)(n),S=document.createElement("template");S.innerHTML=o,c.insertNode(S.content.cloneNode(!0));var A=(0,v.Th)(c.startContainer,"data-block","0");A?A.outerHTML=n.lute.SpinVditorDOM(A.outerHTML):n.wysiwyg.element.innerHTML=n.lute.SpinVditorDOM(n.wysiwyg.element.innerHTML),(0,B.ir)(n.wysiwyg.element,c)}})}),this.element.addEventListener("compositionstart",function(){i.composingLock=!0}),this.element.addEventListener("compositionend",function(a){var o=(0,D.c)(getSelection().getRangeAt(0).startContainer);if(o&&o.textContent===""){le(n);return}(0,f.gm)()||Vi(n,getSelection().getRangeAt(0).cloneRange(),a),i.composingLock=!1}),this.element.addEventListener("input",function(a){if(!(a.inputType==="deleteByDrag"||a.inputType==="insertFromDrop")){if(i.preventInput){i.preventInput=!1,ht(n);return}if(i.composingLock||a.data==="‘"||a.data==="“"||a.data==="《"){ht(n);return}var o=getSelection().getRangeAt(0),c=(0,v.pt)(o.startContainer);if(c||(Wn(n,o),c=(0,v.pt)(o.startContainer)),!!c){for(var S=(0,B.ED)(c,n.wysiwyg.element,o).start,A=!0,O=S-1;O>c.textContent.substr(0,S).lastIndexOf(`
`);O--)if(c.textContent.charAt(O)!==" "&&c.textContent.charAt(O)!=="	"){A=!1;break}S===0&&(A=!1);for(var L=!0,O=S-1;O<c.textContent.length;O++)if(c.textContent.charAt(O)!==" "&&c.textContent.charAt(O)!==`
`){L=!1;break}L&&/^#{1,6} $/.test(c.textContent)&&(L=!1);var $=(0,D.c)(getSelection().getRangeAt(0).startContainer);if($&&$.textContent===""&&(le(n),$.remove()),A&&c.getAttribute("data-type")!=="code-block"||L||br(c.innerHTML)||Yi(c.innerHTML)&&c.previousElementSibling){typeof n.options.input=="function"&&n.options.input(x(n));return}a.inputType==="insertParagraph"&&i.element.innerHTML==="<p><br></p><p><br></p>"&&c.previousElementSibling.remove(),Vi(n,o,a)}}}),this.element.addEventListener("click",function(a){if(a.target.tagName==="INPUT"){var o=a.target;o.checked?o.setAttribute("checked","checked"):o.removeAttribute("checked"),i.preventInput=!0,getSelection().rangeCount>0&&(0,B.jl)(getSelection().getRangeAt(0)),ht(n);return}if(a.target.tagName==="IMG"&&!a.target.parentElement.classList.contains("vditor-wysiwyg__preview")){a.target.getAttribute("data-type")==="link-ref"?W(n,a.target):Ze(a,n);return}var c=(0,v._Y)(a.target,"A");if(c){n.options.link.click?n.options.link.click(c):n.options.link.isOpen&&window.open(c.getAttribute("href")),a.preventDefault();return}var S=(0,B.RN)(n);if(a.target.isEqualNode(i.element)&&i.element.lastElementChild&&S.collapsed){var A=i.element.lastElementChild.getBoundingClientRect();a.y>A.top+A.height&&(i.element.lastElementChild.tagName==="P"&&i.element.lastElementChild.textContent.trim().replace(u.Y.ZWSP,"")===""?(S.selectNodeContents(i.element.lastElementChild),S.collapse(!1)):(i.element.insertAdjacentHTML("beforeend",'<p data-block="0">'.concat(u.Y.ZWSP,"<wbr></p>")),(0,B.ir)(i.element,S)))}Qt(n);var O=(0,v.KJ)(a.target,"vditor-wysiwyg__preview");O||(O=(0,v.KJ)((0,B.RN)(n).startContainer,"vditor-wysiwyg__preview")),O&&bt(O,n),re(a,n)}),this.element.addEventListener("keyup",function(a){if(!(a.isComposing||(0,f._0)(a))){a.key==="Enter"&&Dt(n),(a.key==="Backspace"||a.key==="Delete")&&n.wysiwyg.element.innerHTML!==""&&n.wysiwyg.element.childNodes.length===1&&n.wysiwyg.element.firstElementChild&&n.wysiwyg.element.firstElementChild.tagName==="P"&&n.wysiwyg.element.firstElementChild.childElementCount===0&&(n.wysiwyg.element.textContent===""||n.wysiwyg.element.textContent===`
`)&&(n.wysiwyg.element.innerHTML="");var o=(0,B.RN)(n);if(a.key==="Backspace"&&(0,f.gm)()&&o.startContainer.textContent===`
`&&o.startOffset===1&&(o.startContainer.textContent=""),Wn(n,o),Qt(n),!(a.key!=="ArrowDown"&&a.key!=="ArrowRight"&&a.key!=="Backspace"&&a.key!=="ArrowLeft"&&a.key!=="ArrowUp")){(a.key==="ArrowLeft"||a.key==="ArrowRight")&&n.hint.render(n);var c=(0,v.KJ)(o.startContainer,"vditor-wysiwyg__preview");if(!c&&o.startContainer.nodeType!==3&&o.startOffset>0){var S=o.startContainer;S.classList.contains("vditor-wysiwyg__block")&&(c=S.lastElementChild)}if(c){var A=c.previousElementSibling;if(A.style.display==="none"){a.key==="ArrowDown"||a.key==="ArrowRight"?bt(c,n):bt(c,n,!1);return}var O=c.previousElementSibling;if(O.tagName==="PRE"&&(O=O.firstElementChild),a.key==="ArrowDown"||a.key==="ArrowRight"){var S=c.parentElement,L=sn(S);if(L&&L.nodeType!==3){var $=L.querySelector(".vditor-wysiwyg__preview");if($){bt($,n);return}}if(L.nodeType===3){for(;L.textContent.length===0&&L.nextSibling;)L=L.nextSibling;o.setStart(L,1)}else o.setStart(L.firstChild,0)}else o.selectNodeContents(O),o.collapse(!1)}}}})},t}(),ac=function(){var t=function(n,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(a,o){a.__proto__=o}||function(a,o){for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(a[c]=o[c])},t(n,i)};return function(n,i){if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");t(n,i);function a(){this.constructor=n}n.prototype=i===null?Object.create(i):(a.prototype=i.prototype,new a)}}(),oc=function(t){ac(n,t);function n(i,a){var o=t.call(this)||this;if(o.version=u.g,typeof i=="string"){if(a?a.cache?a.cache.id||(a.cache.id="vditor".concat(i)):a.cache={id:"vditor".concat(i)}:a={cache:{id:"vditor".concat(i)}},!document.getElementById(i))return o.showErrorTip("Failed to get element by id: ".concat(i)),o;i=document.getElementById(i)}var c=new ic(a),S=c.merge();if(S.i18n)window.VditorI18n=S.i18n,o.init(i,S);else if(["en_US","fr_FR","pt_BR","ja_JP","ko_KR","ru_RU","sv_SE","zh_CN","zh_TW"].includes(S.lang)){var A="vditorI18nScript",O=A+S.lang;document.querySelectorAll('head script[id^="'.concat(A,'"]')).forEach(function(L){L.id!==O&&document.head.removeChild(L)}),(0,k.Z)("".concat(S.cdn,"/dist/js/i18n/").concat(S.lang,".js"),O).then(function(){o.init(i,S)}).catch(function(L){o.showErrorTip("GET ".concat(S.cdn,"/dist/js/i18n/").concat(S.lang,".js net::ERR_ABORTED 404 (Not Found)"))})}else throw new Error("options.lang error, see https://ld246.com/article/1549638745630#options");return o}return n.prototype.showErrorTip=function(i){var a=new fo;document.body.appendChild(a.element),a.show(i,0)},n.prototype.updateToolbarConfig=function(i){this.vditor.toolbar.updateConfig(this.vditor,i)},n.prototype.setTheme=function(i,a,o,c){this.vditor.options.theme=i,tt(this.vditor),a&&(this.vditor.options.preview.theme.current=a,(0,_e.H)(a,c||this.vditor.options.preview.theme.path)),o&&(this.vditor.options.preview.hljs.style=o,(0,ho.h)(o,this.vditor.options.cdn))},n.prototype.getValue=function(){return x(this.vditor)},n.prototype.getCurrentMode=function(){return this.vditor.currentMode},n.prototype.focus=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.focus():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.focus():this.vditor.currentMode==="ir"&&this.vditor.ir.element.focus()},n.prototype.blur=function(){this.vditor.currentMode==="sv"?this.vditor.sv.element.blur():this.vditor.currentMode==="wysiwyg"?this.vditor.wysiwyg.element.blur():this.vditor.currentMode==="ir"&&this.vditor.ir.element.blur()},n.prototype.disabled=function(){T(this.vditor,["subToolbar","hint","popover"]),w(this.vditor.toolbar.elements,u.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","false")},n.prototype.enable=function(){E(this.vditor.toolbar.elements,u.Y.EDIT_TOOLBARS.concat(["undo","redo","fullscreen","edit-mode"])),this.vditor.undo.resetIcon(this.vditor),this.vditor[this.vditor.currentMode].element.setAttribute("contenteditable","true")},n.prototype.getSelection=function(){if(this.vditor.currentMode==="wysiwyg")return zt(this.vditor.wysiwyg.element);if(this.vditor.currentMode==="sv")return zt(this.vditor.sv.element);if(this.vditor.currentMode==="ir")return zt(this.vditor.ir.element)},n.prototype.renderPreview=function(i){this.vditor.preview.render(this.vditor,i)},n.prototype.getCursorPosition=function(){return(0,B.Ey)(this.vditor[this.vditor.currentMode].element)},n.prototype.isUploading=function(){return this.vditor.upload.isUploading},n.prototype.clearCache=function(){this.vditor.options.cache.enable&&(0,f.D)()&&localStorage.removeItem(this.vditor.options.cache.id)},n.prototype.disabledCache=function(){this.vditor.options.cache.enable=!1},n.prototype.enableCache=function(){if(!this.vditor.options.cache.id)throw new Error("need options.cache.id, see https://ld246.com/article/1549638745630#options");this.vditor.options.cache.enable=!0},n.prototype.html2md=function(i){return this.vditor.lute.HTML2Md(i)},n.prototype.exportJSON=function(i){return this.vditor.lute.RenderJSON(i)},n.prototype.getHTML=function(){return hi(this.vditor)},n.prototype.tip=function(i,a){this.vditor.tip.show(i,a)},n.prototype.setPreviewMode=function(i){ya(i,this.vditor)},n.prototype.deleteValue=function(){window.getSelection().isCollapsed||document.execCommand("delete",!1)},n.prototype.updateValue=function(i){document.execCommand("insertHTML",!1,i)},n.prototype.insertValue=function(i,a){a===void 0&&(a=!0);var o=(0,B.RN)(this.vditor);o.collapse(!0);var c=document.createElement("template");c.innerHTML=i,o.insertNode(c.content.cloneNode(!0)),o.collapse(!1),this.vditor.currentMode==="sv"?(this.vditor.sv.preventInput=!0,a&&Je(this.vditor)):this.vditor.currentMode==="wysiwyg"?a&&Vi(this.vditor,getSelection().getRangeAt(0)):this.vditor.currentMode==="ir"&&(this.vditor.ir.preventInput=!0,a&&Ge(this.vditor,getSelection().getRangeAt(0),!0))},n.prototype.insertMD=function(i){this.vditor.currentMode==="ir"?(0,B.Z2)(this.vditor.lute.Md2VditorIRDOM(i),this.vditor):this.vditor.currentMode==="wysiwyg"?(0,B.Z2)(this.vditor.lute.Md2VditorDOM(i),this.vditor):F(this.vditor,i),this.vditor.outline.render(this.vditor),st(this.vditor)},n.prototype.setValue=function(i,a){var o=this;a===void 0&&(a=!1),this.vditor.currentMode==="sv"?(this.vditor.sv.element.innerHTML="<div data-block='0'>".concat(this.vditor.lute.SpinVditorSVDOM(i),"</div>"),ze(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})):this.vditor.currentMode==="wysiwyg"?Tt(this.vditor,i,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1}):(this.vditor.ir.element.innerHTML=this.vditor.lute.Md2VditorIRDOM(i),this.vditor.ir.element.querySelectorAll(".vditor-ir__preview[data-render='2']").forEach(function(c){rt(c,o.vditor)}),un(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})),this.vditor.outline.render(this.vditor),i||(T(this.vditor,["emoji","headings","submenu","hint"]),this.vditor.wysiwyg.popover&&(this.vditor.wysiwyg.popover.style.display="none"),this.clearCache()),a&&this.clearStack()},n.prototype.insertEmptyBlock=function(i){fi(this.vditor,i)},n.prototype.clearStack=function(){this.vditor.undo.clearStack(this.vditor),this.vditor.undo.addToUndoStack(this.vditor)},n.prototype.destroy=function(){this.vditor.element.innerHTML=this.vditor.originalInnerHTML,this.vditor.element.classList.remove("vditor"),this.vditor.element.removeAttribute("style");var i=document.getElementById("vditorIconScript");i&&i.remove(),this.clearCache(),yn(),this.vditor.wysiwyg.unbindListener()},n.prototype.getCommentIds=function(){return this.vditor.currentMode!=="wysiwyg"?[]:this.vditor.wysiwyg.getComments(this.vditor,!0)},n.prototype.hlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){o.classList.remove("vditor-comment--hover"),i.forEach(function(c){o.getAttribute("data-cmtids").indexOf(c)>-1&&o.classList.add("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},n.prototype.unHlCommentIds=function(i){if(this.vditor.currentMode==="wysiwyg"){var a=function(o){i.forEach(function(c){o.getAttribute("data-cmtids").indexOf(c)>-1&&o.classList.remove("vditor-comment--hover")})};this.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)}),this.vditor.preview.element.style.display!=="none"&&this.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(o){a(o)})}},n.prototype.removeCommentIds=function(i){var a=this;if(this.vditor.currentMode==="wysiwyg"){var o=function(c,S){var A=c.getAttribute("data-cmtids").split(" ");A.find(function(O,L){if(O===S)return A.splice(L,1),!0}),A.length===0?(c.outerHTML=c.innerHTML,(0,B.RN)(a.vditor).collapse(!0)):c.setAttribute("data-cmtids",A.join(" "))};i.forEach(function(c){a.vditor.wysiwyg.element.querySelectorAll(".vditor-comment").forEach(function(S){o(S,c)}),a.vditor.preview.element.style.display!=="none"&&a.vditor.preview.element.querySelectorAll(".vditor-comment").forEach(function(S){o(S,c)})}),ht(this.vditor,{enableAddUndoStack:!0,enableHint:!1,enableInput:!1})}},n.prototype.init=function(i,a){var o=this;this.vditor={currentMode:a.mode,element:i,hint:new Xi(a.hint.extend),lute:void 0,options:a,originalInnerHTML:i.innerHTML,outline:new Qs(window.VditorI18n.outline),tip:new fo},this.vditor.sv=new il(this.vditor),this.vditor.undo=new tc,this.vditor.wysiwyg=new rc(this.vditor),this.vditor.ir=new co(this.vditor),this.vditor.toolbar=new Ql(this.vditor),a.resize.enable&&(this.vditor.resize=new nl(this.vditor)),this.vditor.toolbar.elements.devtools&&(this.vditor.devtools=new h),(a.upload.url||a.upload.handler)&&(this.vditor.upload=new Yn),(0,k.Z)(a._lutePath||"".concat(a.cdn,"/dist/js/lute/lute.min.js"),"vditorLuteScript").then(function(){o.vditor.lute=(0,Js.X)({autoSpace:o.vditor.options.preview.markdown.autoSpace,gfmAutoLink:o.vditor.options.preview.markdown.gfmAutoLink,codeBlockPreview:o.vditor.options.preview.markdown.codeBlockPreview,emojiSite:o.vditor.options.hint.emojiPath,emojis:o.vditor.options.hint.emoji,fixTermTypo:o.vditor.options.preview.markdown.fixTermTypo,footnotes:o.vditor.options.preview.markdown.footnotes,headingAnchor:!1,inlineMathDigit:o.vditor.options.preview.math.inlineDigit,linkBase:o.vditor.options.preview.markdown.linkBase,linkPrefix:o.vditor.options.preview.markdown.linkPrefix,listStyle:o.vditor.options.preview.markdown.listStyle,mark:o.vditor.options.preview.markdown.mark,mathBlockPreview:o.vditor.options.preview.markdown.mathBlockPreview,paragraphBeginningSpace:o.vditor.options.preview.markdown.paragraphBeginningSpace,sanitize:o.vditor.options.preview.markdown.sanitize,toc:o.vditor.options.preview.markdown.toc}),o.vditor.preview=new tl(o.vditor),kt(o.vditor),a.after&&a.after(),a.icon&&(0,k.U)("".concat(a.cdn,"/dist/js/icons/").concat(a.icon,".js"),"vditorIconScript")})},n}(m.default);const sc=oc})(),d=d.default,d})())}(sa)),sa.exports}var xd=Ed();const Or=wd(xd),Sd=rn({__name:"VditorEditor",props:{modelValue:{type:String,default:""},theme:{type:String,default:"classic"}},emits:["update:modelValue"],setup(p,{expose:e,emit:r}){const s=p,l=r,d=G();let m=null,u=null,g=null,x=null,k=null;const h={mode:"ir",height:"auto",minHeight:150,resize:{enable:!0,position:"bottom"},icon:"ant",lang:"zh_CN",theme:"classic",toolbar:["emoji","headings","bold","italic","strike","link","|","list","ordered-list","check","|","quote","line","code","inline-code","table","upload","undo","redo","|","preview","fullscreen"],toolbarConfig:{pin:!0,hideTooltip:!0},counter:{enable:!1},cache:{enable:!0,id:"vue-vditor"},input:f=>{l("update:modelValue",f)},preview:{hljs:{style:"native"},markdown:{listStyle:!0,mark:!0},actions:[]},placeholder:"灵感记录~"};return Ht(async()=>{if(!d.value)return;const f={...h,theme:s.theme==="dark"?"dark":"classic",preview:{...h.preview,hljs:{style:s.theme==="dark"?"native":"github"}},after:()=>{m==null||m.setValue(s.modelValue),m==null||m.setTheme(s.theme==="dark"?"dark":"classic")}};m=new Or(d.value,f);const b=()=>{var C;const y=(C=d.value)==null?void 0:C.querySelector(".vditor");if(u=y==null?void 0:y.querySelector(".vditor-toolbar"),!y||!u)return;g=document.createElement("div"),g.style.width="100%",g.style.height=`${u.offsetHeight}px`,g.style.pointerEvents="none",y.insertBefore(g,u.nextSibling);const E=()=>{if(!y||!u)return;const _=y.classList.contains("vditor--fullscreen"),T=u.offsetHeight;if(_){u.style.position="fixed",u.style.top="0px",u.style.left="0px",u.style.width=`${window.innerWidth}px`,u.style.zIndex="1002",g&&(g.style.height=`${T}px`);return}y.style.position=y.style.position||"relative";const M=y.getBoundingClientRect(),v=M.top<0&&M.bottom>T,D=M.top>=0,N=M.bottom<=T;if(v)u.style.position="fixed",u.style.top="0px",u.style.left=`${M.left}px`,u.style.width=`${M.width}px`;else if(D)u.style.position="absolute",u.style.top="0px",u.style.left="0px",u.style.width="100%";else if(N){const z=y.offsetHeight;u.style.position="absolute",u.style.top=`${z-T}px`,u.style.left="0px",u.style.width="100%"}u.style.zIndex="1002",g&&(g.style.height=`${T}px`)},w=document.querySelector(".content-wrapper");w==null||w.addEventListener("scroll",E,{passive:!0}),window.addEventListener("resize",E),window.addEventListener("scroll",E,{passive:!0}),E(),x=new MutationObserver(()=>E()),x.observe(y,{attributes:!0,attributeFilter:["class"]}),k=()=>{w==null||w.removeEventListener("scroll",E),window.removeEventListener("resize",E),window.removeEventListener("scroll",E),x==null||x.disconnect(),x=null,u&&(u.style.position="",u.style.top="",u.style.left="",u.style.width="",u.style.zIndex=""),g&&(g.remove(),g=null)}};vt(()=>b())}),ji(()=>{try{m&&(m.destroy(),m=null),k&&(k(),k=null)}catch(f){console.warn("Vditor destroy error",f)}}),e({clear:()=>{m&&(m.setValue(""),l("update:modelValue",""))},insertValue:f=>{m&&(m.insertValue(f),l("update:modelValue",m.getValue()))}}),xt(()=>s.theme,f=>{m&&m.setTheme(f==="dark"?"dark":"classic")}),(f,b)=>(Z(),oe("div",{ref_key:"editorContainer",ref:d,class:"vditor-container"},null,512))}}),Cd={class:"flex items-center gap-2"},_d={class:"space-y-4"},Td={class:"relative"},Md={class:"flex justify-between items-center"},Ad={class:"flex justify-end gap-2"},Ld=rn({__name:"Searchmode",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue","search-result"],setup(p,{expose:e,emit:r}){const s=We(),d=gn().public.baseApi||"/api",m=p,u=r,g=ge({get:()=>m.modelValue,set:f=>u("update:modelValue",f)}),x=()=>{u("update:modelValue",!1)},k=G(""),h=async()=>{var f,b;if(!k.value.trim()){s.add({title:"提示",description:"请输入搜索关键词",color:"yellow"});return}try{const{data:y,error:E}=await Bc("/messages/search",{method:"GET",baseURL:d,params:{keyword:k.value,page:1,pageSize:10}},"$4cD5OWGgav");if(E.value)throw new Error(((f=E.value)==null?void 0:f.message)||"网络请求失败");if(!y.value)throw new Error("未收到服务器响应");if(y.value.code===1)u("search-result",y.value),u("update:modelValue",!1),k.value="",s.add({title:"成功",description:"搜索完成",color:"green"});else throw new Error(((b=y.value)==null?void 0:b.msg)||"搜索失败")}catch(y){console.error("Search error:",y),s.add({title:"错误",description:y instanceof Error?y.message:"搜索失败，请稍后重试",color:"red"})}};return e({handleSearch:h}),(f,b)=>{const y=di,E=ma,w=Ir,C=pa,_=ga;return Z(),Lt(_,{modelValue:g.value,"onUpdate:modelValue":b[1]||(b[1]=T=>g.value=T),ui:{container:"items-center",base:"backdrop-blur-sm"}},{default:Me(()=>[ie(C,{class:"search-card"},{header:Me(()=>[I("div",Cd,[ie(y,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5"}),b[2]||(b[2]=I("h3",{class:"text-base font-semibold"},"站内搜索",-1))])]),default:Me(()=>[I("div",_d,[I("div",Td,[ie(y,{name:"i-heroicons-magnifying-glass",class:"w-5 h-5 absolute left-3 top-1/2 -translate-y-1/2 opacity-70"}),ie(E,{modelValue:k.value,"onUpdate:modelValue":b[0]||(b[0]=T=>k.value=T),placeholder:"请输入关键词",class:"w-full pl-10",ui:{base:"rounded-xl"},onKeyup:hs(h,["enter"]),autofocus:""},null,8,["modelValue"])]),I("div",Md,[b[5]||(b[5]=I("div",{class:"text-xs opacity-70"},"按 Enter 搜索，Esc 关闭",-1)),I("div",Ad,[ie(w,{variant:"ghost",color:"gray",onClick:x},{default:Me(()=>b[3]||(b[3]=[mt("取消")])),_:1}),ie(w,{color:"orange",onClick:h},{default:Me(()=>b[4]||(b[4]=[mt("搜索")])),_:1})])])])]),_:1})]),_:1},8,["modelValue"])}}}),Xs=Mn(Ld,[["__scopeId","data-v-16a007f5"]]),Dd=ds("notify",{state:()=>({config:{webhookEnabled:!1,webhookURL:"",telegramEnabled:!1,telegramToken:"",telegramChatID:"",weworkEnabled:!1,weworkKey:"",feishuEnabled:!1,feishuWebhook:"",feishuSecret:"",twitterEnabled:!1,twitterApiKey:"",twitterApiSecret:"",twitterAccessToken:"",twitterAccessTokenSecret:"",customHttpEnabled:!1,customHttpUrl:"",customHttpMethod:"POST",customHttpHeaders:"",customHttpBody:'{"content":"{{content}}"}'}}),actions:{async fetchConfig(){try{const e=await(await fetch("/api/notify/config",{credentials:"include"})).json();e.code===1&&(this.config=e.data)}catch(p){console.error("获取推送配置失败:",p)}},async saveConfig(p){try{const r=await(await fetch("/api/notify/config",{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(p)})).json();if(r.code===1){const s=r.data||p;return Object.keys(this.config).forEach(l=>{l.endsWith("Enabled")?this.config[l]=!!s[l]&&s[l]!=="false":s[l]!==void 0&&(this.config[l]=s[l])}),!0}return!1}catch(e){return console.error("保存推送配置失败:",e),!1}},async testNotify(p){try{return(await(await fetch("/api/notify/test",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:p})})).json()).code===1}catch(e){return console.error("测试推送失败:",e),!1}},async sendNotify(p){try{let e=p.content;return p.images&&p.images.length>0&&(e+=`

`,p.images.forEach(l=>{e+=`![](${l})
`})),(await(await fetch("/api/notify/send",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({content:e,format:p.format||"markdown",config:this.config})})).json()).code===1}catch(e){return console.error("发送推送失败:",e),!1}}}}),Od=rn({__name:"VideoUpload",emits:["video-uploaded","upload-progress"],setup(p,{emit:e}){const r=e,s=G(null),l=We(),d=gn().public.baseApi||"/api",m=()=>{var g;(g=s.value)==null||g.click()},u=async g=>{const x=g.target,k=x.files?x.files[0]:null;if(!k){l.add({title:"错误",description:"未选择视频",color:"red"});return}const h=200*1024*1024;if(k.size>h){l.add({title:"错误",description:"视频不能超过200MB",color:"red"});return}const f=new FormData;f.append("video",k);const b=new XMLHttpRequest;b.open("POST",`${d}/video/upload`,!0),b.withCredentials=!0,b.upload.onprogress=y=>{if(y.lengthComputable){const E=Math.round(y.loaded/y.total*100);r("upload-progress",E)}},b.onload=()=>{if(b.status===200)try{const y=JSON.parse(b.responseText);if(y.code===1&&y.data)r("video-uploaded",y.data),l.add({title:"成功",description:"视频上传成功",color:"green"});else throw new Error(y.msg||"视频上传失败")}catch(y){l.add({title:"错误",description:y.message||"视频上传失败",color:"red"})}else l.add({title:"错误",description:"视频上传失败",color:"red"});r("upload-progress",0),s.value&&(s.value.value="")},b.onerror=()=>{l.add({title:"错误",description:"视频上传失败",color:"red"}),r("upload-progress",0),s.value&&(s.value.value="")},b.send(f)};return(g,x)=>{const k=di;return Z(),oe("div",null,[I("input",{ref_key:"videoInput",ref:s,type:"file",accept:"video/*",class:"hidden",onChange:u},null,544),I("button",{class:"tb-btn",onClick:m,title:"上传视频"},[ie(k,{name:"i-mdi-video",class:"w-5 h-5"})])])}}}),Pd=Mn(Od,[["__scopeId","data-v-8ae38874"]]),Rd={class:"flex justify-between items-center mb-3"},Id={class:"mb-4"},Hd={class:"flex gap-2 mb-3"},Nd={key:0,class:"space-y-2 mb-3"},jd={class:"flex items-center gap-2"},$d={class:"flex justify-end mt-2 mb-3"},Bd=["src"],Ud={key:3,class:"text-sm text-gray-300"},zd={key:4,class:"text-sm text-gray-300"},Fd={key:1,class:"flex justify-end mt-2"},Vd={key:2,class:"mt-2 text-red-400 text-sm"},qd={key:3,class:"mt-2"},Wd={class:"flex items-center gap-2 bg-gray-800 p-2 rounded"},Yd=["value"],Kd={class:"flex justify-end mt-2"},Gd=rn({__name:"ImageHostingUploader",props:{position:{type:Object,required:!0,default:()=>({x:0,y:0})},editorRef:{type:Object,required:!1,default:null}},emits:["close","upload-success"],setup(p,{emit:e}){const r=p,s=ge(()=>{if(typeof window>"u")return{};const le=window.innerWidth,re=window.innerHeight,Re=400,Ge=500;let Q=r.position.x,Ce=r.position.y;return Q+Re>le&&(Q=le-Re-20),Q<0&&(Q=20),Ce+Ge>re&&(Ce=re-Ge-20),Ce<0&&(Ce=20),le<1024&&(Q=(le-Re)/2,Ce=60),{position:"fixed",top:`${Ce}px`,left:`${Q}px`,maxWidth:`${Math.min(Re,le-40)}px`,width:"100%",cursor:"move",userSelect:"none",touchAction:"none"}}),l=G(!1),d=G({x:0,y:0}),m=le=>{l.value=!0;const re="touches"in le?le.touches[0].clientX:le.clientX,Re="touches"in le?le.touches[0].clientY:le.clientY;d.value={x:re-r.position.x,y:Re-r.position.y},document.addEventListener("mousemove",u),document.addEventListener("touchmove",u),document.addEventListener("mouseup",g),document.addEventListener("touchend",g)},u=le=>{if(!l.value)return;const re="touches"in le?le.touches[0].clientX:le.clientX,Re="touches"in le?le.touches[0].clientY:le.clientY;x("update:position",{x:re-d.value.x,y:Re-d.value.y})},g=()=>{l.value=!1,document.removeEventListener("mousemove",u),document.removeEventListener("touchmove",u),document.removeEventListener("mouseup",g),document.removeEventListener("touchend",g)},x=e,k=We(),h=G("smms"),f=G(null),b=G(!1),y=G(!1),E=G(0),w=G(""),C=G(""),_=G(""),T=G(""),M=G(""),v=G("main"),D=G("images/"),N=G(!1),z=G(""),H=G(""),Y=G(""),U=()=>{var le;(le=f.value)==null||le.click()},j=le=>{var Re;b.value=!1;const re=(Re=le.dataTransfer)==null?void 0:Re.files;re&&re.length>0&&Se(re[0])},X=le=>{const Re=le.target.files;Re&&Re.length>0&&Se(Re[0])},he=G(null),Se=async le=>{if(!le.type.startsWith("image/")){_.value="请选择图片文件";return}const re=5*1024*1024;if(le.size>re){_.value="图片大小不能超过 5MB";return}_.value="",he.value=le;const Re=new FileReader;Re.onload=Ge=>{var Q;w.value=(Q=Ge.target)==null?void 0:Q.result},Re.readAsDataURL(le)},Ue=()=>{if(!C.value){_.value="请先上传图片";return}const le=`![](${C.value})`;x("upload-success",le),x("close"),he.value=null,w.value="",C.value="",E.value=0,y.value=!1,_.value=""},Le=async le=>{try{await navigator.clipboard.writeText(le),k.add({title:"成功",description:"已复制到剪贴板",color:"green",timeout:2e3})}catch{k.add({title:"错误",description:"复制失败",color:"red",timeout:2e3})}},Pe=async()=>{if(!he.value){_.value="请先选择图片";return}y.value=!0,E.value=0,_.value="";try{switch(h.value){case"github":await Ie(he.value);break;default:throw new Error("未知的图床类型")}}catch(le){console.error("上传错误:",le),_.value=le.message||"上传失败",y.value=!1,le.name==="AbortError"?_.value="请求超时，请检查网络连接":le.message.includes("Failed to fetch")&&(_.value="网络请求失败，可能是跨域问题或API不可用")}},Ie=async le=>{if(!T.value||!M.value){_.value="请先配置 GitHub Token 和仓库名";return}try{E.value=30;const re=Date.now(),Re=le.name.split(".").pop(),Ge=`${re}.${Re}`,Q=`${D.value}${Ge}`.replace(/\/\//g,"/"),Ce=await et(le),ce={message:`Upload image ${Ge}`,content:Ce,branch:v.value||"main"};E.value=50;const ne=await fetch(`https://api.github.com/repos/${M.value}/contents/${Q}`,{method:"PUT",headers:{Authorization:`token ${T.value}`,"Content-Type":"application/json"},body:JSON.stringify(ce)});if(E.value=80,!ne.ok)throw new Error(`GitHub 上传失败: ${ne.status}`);const Ve=await ne.json();C.value=N.value&&z.value?`https://${z.value}/gh/${M.value}@${v.value||"main"}/${Q}`:Ve.content.download_url,E.value=100,y.value=!1,k.add({title:"成功",description:`图片已上传到 GitHub${N.value&&z.value?" (CDN加速)":""}`,color:"green",timeout:2e3})}catch(re){console.error("GitHub 上传错误:",re),_.value=re.message||"GitHub 上传失败",y.value=!1}},et=le=>new Promise((re,Re)=>{const Ge=new FileReader;Ge.onload=()=>re(Ge.result.split(",")[1]),Ge.onerror=Re,Ge.readAsDataURL(le)}),rt=()=>{try{const le={selectedHost:h.value,github:{token:T.value,repo:M.value,branch:v.value,path:D.value,enableCDN:N.value,cdnDomain:z.value},smms:{token:H.value},freeimage:{token:Y.value}};localStorage.setItem("imageHostingConfig",JSON.stringify(le)),k.add({title:"成功",description:"配置已保存",color:"green",timeout:2e3})}catch(le){console.error("保存配置失败:",le),k.add({title:"错误",description:"保存配置失败",color:"red",timeout:2e3})}},B=()=>{const le=localStorage.getItem("imageHostingConfig");if(le)try{const re=JSON.parse(le);h.value=re.selectedHost||"smms",re.github&&(T.value=re.github.token||"",M.value=re.github.repo||"",v.value=re.github.branch||"main",D.value=re.github.path||"images/",N.value=re.github.enableCDN||!1,z.value=re.github.cdnDomain||""),re.smms&&(H.value=re.smms.token||""),re.imgtp&&(imgtpToken.value=re.imgtp.token||""),re.freeimage&&(Y.value=re.freeimage.token||"")}catch(re){console.error("加载配置失败:",re)}};return xt([h,T,M,v,D,H],()=>{rt()},{deep:!0}),Ht(()=>{B()}),(le,re)=>{const Re=Ir,Ge=ma,Q=_c,Ce=di,ce=Tc;return Z(),oe("div",{class:"fixed z-[5000] bg-black/80 backdrop-blur-sm rounded-lg shadow-lg p-4 text-white",style:bi(s.value),onMousedown:m,onTouchstart:m},[I("div",Rd,[re[11]||(re[11]=I("h3",{class:"text-lg font-medium"},"图床上传",-1)),ie(Re,{icon:"i-heroicons-x-mark",color:"gray",variant:"ghost",size:"xs",onClick:re[0]||(re[0]=ne=>le.$emit("close"))})]),I("div",Id,[I("div",Hd,[ie(Re,{color:h.value==="github"?"blue":"gray",variant:"solid",size:"sm",onClick:re[1]||(re[1]=ne=>h.value="github")},{default:Me(()=>re[12]||(re[12]=[mt(" GitHub ")])),_:1},8,["color"])]),h.value==="github"?(Z(),oe("div",Nd,[ie(Ge,{modelValue:T.value,"onUpdate:modelValue":re[2]||(re[2]=ne=>T.value=ne),placeholder:"GitHub Token",size:"sm",type:"password"},null,8,["modelValue"]),ie(Ge,{modelValue:M.value,"onUpdate:modelValue":re[3]||(re[3]=ne=>M.value=ne),placeholder:"仓库名 (用户名/仓库)",size:"sm"},null,8,["modelValue"]),ie(Ge,{modelValue:v.value,"onUpdate:modelValue":re[4]||(re[4]=ne=>v.value=ne),placeholder:"分支名 (默认: main)",size:"sm"},null,8,["modelValue"]),ie(Ge,{modelValue:D.value,"onUpdate:modelValue":re[5]||(re[5]=ne=>D.value=ne),placeholder:"存储路径 (默认: images/)",size:"sm"},null,8,["modelValue"]),I("div",jd,[ie(Q,{modelValue:N.value,"onUpdate:modelValue":re[6]||(re[6]=ne=>N.value=ne)},null,8,["modelValue"]),re[13]||(re[13]=I("span",{class:"text-sm"},"启用CDN加速",-1))]),N.value?(Z(),Lt(Ge,{key:0,modelValue:z.value,"onUpdate:modelValue":re[7]||(re[7]=ne=>z.value=ne),placeholder:"输入CDN域名 (如: jsd.cdn.noisework.cn)",size:"sm"},null,8,["modelValue"])):Oe("",!0)])):Oe("",!0),I("div",$d,[ie(Re,{color:"green",variant:"solid",size:"sm",icon:"i-heroicons-check",onClick:rt},{default:Me(()=>re[14]||(re[14]=[mt(" 保存配置 ")])),_:1})]),I("div",{class:ke(["flex flex-col items-center justify-center border-2 border-dashed border-gray-500 rounded-lg p-4 cursor-pointer hover:border-blue-400 transition-colors",{"border-blue-400":b.value}]),onClick:U,onDragover:re[8]||(re[8]=lr(ne=>b.value=!0,["prevent"])),onDragleave:re[9]||(re[9]=lr(ne=>b.value=!1,["prevent"])),onDrop:lr(j,["prevent"])},[I("input",{ref_key:"fileInput",ref:f,type:"file",accept:"image/*",onChange:X,class:"hidden"},null,544),!y.value&&!w.value?(Z(),Lt(Ce,{key:0,name:"i-heroicons-cloud-arrow-up",class:"w-10 h-10 text-gray-400 mb-2"})):Oe("",!0),w.value&&!y.value?(Z(),oe("img",{key:1,src:w.value,class:"max-h-32 max-w-full mb-2 rounded"},null,8,Bd)):Oe("",!0),y.value?(Z(),Lt(ce,{key:2,value:E.value,color:"blue",class:"w-full mb-2"},null,8,["value"])):Oe("",!0),!y.value&&!w.value?(Z(),oe("p",Ud," 点击或拖拽图片到此处上传 ")):Oe("",!0),y.value?(Z(),oe("p",zd," 上传中... "+Fe(E.value)+"% ",1)):Oe("",!0)],34),w.value&&!y.value&&!C.value?(Z(),oe("div",Fd,[ie(Re,{color:"blue",variant:"solid",size:"sm",icon:"i-heroicons-cloud-arrow-up",onClick:Pe},{default:Me(()=>re[15]||(re[15]=[mt(" 开始上传 ")])),_:1})])):Oe("",!0),_.value?(Z(),oe("div",Vd,Fe(_.value),1)):Oe("",!0),C.value?(Z(),oe("div",qd,[I("div",Wd,[I("input",{type:"text",value:C.value,readonly:"",class:"bg-transparent flex-1 text-sm outline-none"},null,8,Yd),ie(Re,{icon:"i-heroicons-clipboard",color:"gray",variant:"ghost",size:"xs",onClick:re[10]||(re[10]=ne=>Le(C.value))})]),I("div",Kd,[ie(Re,{color:"blue",variant:"solid",size:"sm",onClick:Ue},{default:Me(()=>re[16]||(re[16]=[mt(" 插入图片 ")])),_:1})])])):Oe("",!0)])],36)}}}),Xd=Mn(Gd,[["__scopeId","data-v-9124ba85"]]),Zd={class:"editor-box"},Jd={class:"editor-toolbar"},Qd={class:"toolbar-left"},ef={key:0,class:"w-full mt-2"},tf={class:"bg-gray-700 rounded h-2"},nf={class:"text-xs text-gray-300 mt-1 text-right"},rf=["title"],af=["title"],of={class:"toolbar-right"},sf={key:0,class:"mx-auto sm:max-w-2xl mt-4 preview-card"},lf=["innerHTML"],cf=rn({__name:"AddForm",emits:["search-result","video-uploaded","before-upload","upload-progress"],setup(p,{emit:e}){const r=G(!1),s=G({x:400,y:320}),l=B=>{var le;(le=v.value)!=null&&le.insertValue&&v.value.insertValue(B),r.value=!1},d=B=>{s.value=B},m=G(0),u=B=>{m.value=B},g=G(!1),x=e,k=B=>{x("search-result",B)},h=We(),f=gn().public.baseApi||"/api",{save:b}=Ds(),y=$i("showHeatmap");Mr("showHeatmap",y);const E=G(""),w=G(""),C=G(""),_=G(typeof window<"u"&&localStorage.getItem("postPrivate")==="true"),T=$i("contentTheme");$i("toggleContentTheme");const M=G(null),v=G(null),D=ge(()=>_.value?"i-mdi-eye-off-outline":"i-mdi-eye-outline"),N=ge(()=>T.value==="dark"?"prose prose-invert":"prose");Dd();const z=G(localStorage.getItem("enableNotify")==="true"),H=()=>{E.value="",w.value="",C.value="",v.value&&v.value.clear()},Y=Zn(),U=()=>Y.isLogin?!0:(h.add({title:"提示",description:"请先登录",color:"orange",timeout:2e3}),!1),j=()=>{const B=document.getElementById("file-input");B&&B.click()},X=async B=>{var ce;if(!U())return;const le=B.target,re=le.files?le.files[0]:null;if(!re){h.add({title:"错误",description:"没有选择文件",color:"red",timeout:2e3});return}const Re=["image/jpeg","image/png","image/gif","image/webp"],Ge=[".jpg",".jpeg",".png",".gif",".webp"],Q=re.name.toLowerCase().substring(re.name.lastIndexOf("."));if(!Re.includes(re.type)||!Ge.includes(Q)){h.add({title:"错误",description:"仅支持 JPG、PNG、GIF、WEBP 格式的图片",color:"red",timeout:2e3});return}const Ce=5*1024*1024;if(re.size>Ce){h.add({title:"错误",description:"图片大小不能超过 5MB",color:"red",timeout:2e3});return}try{const ne=new FormData;ne.append("image",re);const Ve=await fetch(`${f}/images/upload`,{method:"POST",body:ne,credentials:"include"});if(!Ve.ok){const ct=await Ve.json();throw new Error(ct.msg||"图片上传失败")}const pe=await Ve.json();if(pe.code===1&&pe.data){if((ce=v.value)!=null&&ce.insertValue){const ct=typeof window<"u"?window.location.origin:"",Je=String(f||"/api"),ot=String(pe.data||"");let _e="";if(ot.startsWith("http"))_e=ot;else{const kt=ot.startsWith("/")?ot:`/${ot}`;/^https?:\/\//.test(Je)?_e=`${Je}${kt}`:_e=`${ct}${Je}${kt}`}const tt=`
![](${_e})
`;v.value.insertValue(tt)}h.add({title:"成功",description:"图片上传成功",color:"green",timeout:2e3})}else throw new Error(pe.msg||"图片上传失败")}catch(ne){console.error("上传错误:",ne),h.add({title:"错误",description:ne.message||"图片上传失败",color:"red",timeout:2e3})}finally{M.value&&(M.value.value="")}},he=B=>{var Q;const le=String(B||""),re=gn().public.baseApi||"/api";let Re=le;if(!/^https?:\/\//.test(le)){const Ce=le.startsWith("/")?le:`/${le}`;/^https?:\/\//.test(String(re))?Re=`${String(re).replace(/\/api$/,"")}${Ce}`:Re=`${typeof window<"u"?window.location.origin:""}${Ce}`}const Ge=`<video width="100%" height="100%" src="${Re}" controls loop></video>
`;(Q=v.value)!=null&&Q.insertValue&&v.value.insertValue(Ge)},Se=/!\s*(https?:\/\/[^\s!]+\.(?:png|jpe?g|gif|webp))(?:\?[^\s!]*)?/gi,Ue=B=>B.replace(Se,(le,re)=>`![](${re})`),Le=B=>{const re=new DOMParser().parseFromString(B,"text/html"),Re=ce=>{let ne=!0;const Ve=Array.from(ce.childNodes);if(Ve.length===0)return!1;for(const pe of Ve)if(pe.nodeType===Node.ELEMENT_NODE){const ct=pe,Je=ct.tagName.toLowerCase();if(Je==="img"||Je==="a"&&ct.childElementCount===1&&ct.querySelector("img"))continue;if(Je==="br"){ne=!1;break}ne=!1;break}else if(pe.nodeType===Node.TEXT_NODE&&(pe.textContent||"").trim()!==""){ne=!1;break}return ne},Ge=Array.from(re.body.querySelectorAll("p")),Q=[];let Ce=[];for(const ce of Ge)if(Re(ce)){const ne=Ce[Ce.length-1];!ne||ne.nextElementSibling===ce?Ce.push(ce):(Ce.length>=2&&Q.push(Ce),Ce=[ce])}else Ce.length>=2&&Q.push(Ce),Ce=[];Ce.length>=2&&Q.push(Ce);for(const ce of Q){const ne=re.createElement("div"),Ve=ce.length,pe=Ve===2||Ve===4?2:Math.min(3,Ve);ne.className=`image-grid cols-${pe}`;const ct=`grid-${Math.random().toString(36).slice(2)}`;for(const ot of ce){const _e=ot.querySelector("img"),tt=ot.querySelector("a");if(!_e&&!tt)continue;const kt=re.createElement("div");kt.className="image-grid-item";let wt;if(tt&&tt.querySelector("img")){if(wt=tt,wt.setAttribute("data-fancybox",ct),!wt.getAttribute("href")){const nt=tt.querySelector("img");wt.setAttribute("href",nt.src)}}else if(_e)wt=re.createElement("a"),wt.setAttribute("href",_e.src),wt.setAttribute("data-fancybox",ct),wt.appendChild(_e);else continue;kt.appendChild(wt),ne.appendChild(kt)}ce[0].replaceWith(ne);for(let ot=1;ot<ce.length;ot++)ce[ot].remove()}return re.body.innerHTML};xt(w,B=>{const le=Or.md2html(Ue(B||""));C.value=Le(le),vt(()=>{document.querySelectorAll(".editor-preview").forEach(Re=>{Re.querySelectorAll(".image-grid-item img").forEach(Ge=>{const Q=Ge,Ce=Q.parentElement,ce=()=>{const ne=Q.naturalWidth,Ve=Q.naturalHeight;Ce.classList.remove("ar-169","ar-34","ar-11"),ne>Ve?Ce.classList.add("ar-169"):Ve>ne?Ce.classList.add("ar-34"):Ce.classList.add("ar-11")};Q.complete&&Q.naturalWidth&&Q.naturalHeight?ce():Q.addEventListener("load",ce,{once:!0})})})})}),xt(()=>Y.isLogin,B=>{B&&(z.value=localStorage.getItem("enableNotify")==="true")},{immediate:!0}),Ht(async()=>{gt.bind("[data-fancybox]",{}),Y.isLogin||localStorage.getItem("token")&&Y.fetchUserInfo&&await Y.fetchUserInfo(),_.value=localStorage.getItem("postPrivate")==="true",T.value=localStorage.getItem("contentTheme")||T.value}),ji(()=>{gt.destroy()});const Pe=()=>{z.value=!z.value,localStorage.setItem("enableNotify",z.value.toString())},Ie=()=>{_.value=!_.value,localStorage.setItem("postPrivate",_.value?"true":"false")},et=B=>Y.isLogin?!0:(h.add({title:"提示",description:"请登录后操作",color:"orange",timeout:2e3}),B.preventDefault&&B.preventDefault(),!1),rt=async()=>{if(!U())return;if(!w.value.trim()){h.add({title:"错误",description:"请输入内容或上传图片/视频",color:"red",timeout:2e3});return}const B={username:E.value,content:w.value,private:_.value,notify:z.value};try{await b(B)&&H()}catch(le){console.error("发布错误:",le),h.add({title:"错误",description:le.message||"发布失败",color:"red",timeout:2e3})}};return(B,le)=>{const re=di;return Z(),oe(It,null,[I("div",{class:ke(B.containerClass)},[I("div",Zd,[ie(Sd,{ref_key:"vditorEditor",ref:v,modelValue:w.value,"onUpdate:modelValue":le[0]||(le[0]=Re=>w.value=Re),theme:we(T)},null,8,["modelValue","theme"]),I("div",Jd,[I("div",Qd,[I("input",{id:"file-input",ref_key:"fileInput",ref:M,type:"file",accept:"image/*",onChange:X,class:"hidden",placeholder:"选择图片"},null,544),ie(Pd,{onVideoUploaded:he,onBeforeUpload:et,onUploadProgress:u}),m.value>0&&m.value<100?(Z(),oe("div",ef,[I("div",tf,[I("div",{class:"bg-blue-500 h-2 rounded",style:bi({width:m.value+"%"})},null,4)]),I("div",nf,Fe(m.value)+"%",1)])):Oe("",!0),I("button",{class:"tb-btn",onClick:j,title:"插入图片"},[ie(re,{name:"i-fluent-image-20-regular",class:"w-5 h-5"})]),I("button",{class:"tb-btn",onClick:le[1]||(le[1]=Re=>r.value=!0),title:"图床上传"},[ie(re,{name:"i-mdi-cloud-upload-outline",class:"w-5 h-5"})]),I("button",{class:"tb-btn",onClick:Ie,title:_.value?"设为公开":"设为私密"},[ie(re,{name:D.value,class:"w-5 h-5"},null,8,["name"])],8,rf),I("button",{class:"tb-btn",onClick:Pe,title:z.value?"关闭推送":"开启推送"},[ie(re,{name:z.value?"i-mdi-bell":"i-mdi-bell-off",class:"w-5 h-5"},null,8,["name"])],8,af)]),I("div",of,[I("button",{class:"tb-btn",onClick:H,title:"清空"},[ie(re,{name:"i-fluent-broom-16-regular",class:"w-5 h-5"})]),I("button",{class:"tb-btn primary",onClick:rt,title:"发布"},[ie(re,{name:"i-fluent-add-12-filled",class:"w-5 h-5"})])])])])],2),C.value?(Z(),oe("div",sf,[I("div",{class:ke([N.value,"max-w-none editor-preview"])},[I("div",{innerHTML:C.value},null,8,lf)],2)])):Oe("",!0),ie(Xs,{modelValue:g.value,"onUpdate:modelValue":le[2]||(le[2]=Re=>g.value=Re),onSearchResult:k},null,8,["modelValue"]),r.value?(Z(),Lt(Xd,{key:1,position:s.value,onClose:le[3]||(le[3]=Re=>r.value=!1),onUploadSuccess:l,"onUpdate:position":d},null,8,["position"])):Oe("",!0)],64)}}}),uf=Mn(cf,[["__scopeId","data-v-086a1ad1"]]),yi=rn({__name:"MarkdownRenderer",props:{content:{type:String,required:!0},enableGithubCard:{type:Boolean,default:!0}},emits:["tagClick","rendered"],setup(p,{emit:e}){const r=/https:\/\/www\.bilibili\.com\/video\/(BV[\w]+)\/?$/,s=/https:\/\/(?:www\.)?youtube\.com\/watch\?v=([\w-]+)|https:\/\/youtu\.be\/([\w-]+)/,l=/https:\/\/music\.163\.com(?:\/#)?\/song\?id=(\d+)/,d=/https:\/\/y\.qq\.com\/n\/yqq\/song(\w+)\.html/,m=/https:\/\/v\.qq\.com\/x\/cover\/\w+\/(\w+)\.html/,u=/https:\/\/open\.spotify\.com\/(track|album|playlist)\/([a-zA-Z0-9]+)/,g=/https:\/\/v\.youku\.com\/v_show\/id_([a-zA-Z0-9]+)\.html/,x=e,k=G(null);let h=null;const f=p,b=$i("contentTheme"),y=()=>{if(!k.value)return;const D=b&&b.value==="dark";k.value.classList.toggle("theme-dark",!!D),k.value.classList.toggle("theme-light",!D)},E=()=>{var D;if(window.mediumZoom){h&&h.detach();const N=(D=k.value)==null?void 0:D.getElementsByTagName("img");N&&N.length>0&&(h=window.mediumZoom(N,{background:"rgba(0, 0, 0, 0.9)",margin:24,scrollOffset:0}))}},w=()=>{if(!k.value)return;const D=Y=>{let U=!0;const j=Array.from(Y.childNodes);if(j.length===0)return!1;for(const X of j)if(X.nodeType===Node.ELEMENT_NODE){const he=X,Se=he.tagName.toLowerCase();if(Se==="img"||Se==="a"&&he.childElementCount===1&&he.querySelector("img"))continue;if(Se==="br"){U=!1;break}U=!1;break}else if(X.nodeType===Node.TEXT_NODE&&(X.textContent||"").trim()!==""){U=!1;break}return U},N=Array.from(k.value.querySelectorAll("p")),z=[];let H=[];for(const Y of N)if(D(Y)){const U=H[H.length-1];!U||U.nextElementSibling===Y?H.push(Y):(H.length>=2&&z.push(H),H=[Y])}else H.length>=2&&z.push(H),H=[];H.length>=2&&z.push(H);for(const Y of z){const U=document.createElement("div"),j=Y.length,X=j===2||j===4?2:Math.min(3,j);U.className=`image-grid cols-${X}`;const he=`grid-${Math.random().toString(36).slice(2)}`;for(const Ue of Y){const Le=Ue.querySelector("img"),Pe=Ue.querySelector("a");if(!Le&&!Pe)continue;const Ie=document.createElement("div");Ie.className="image-grid-item";let et;if(Pe&&Pe.querySelector("img")){if(et=Pe,et.setAttribute("data-fancybox",he),!et.getAttribute("href")&&Pe.querySelector("img")){const rt=Pe.querySelector("img");et.setAttribute("href",rt.src)}}else if(Le)et=document.createElement("a"),et.setAttribute("href",Le.src),et.setAttribute("data-fancybox",he),et.appendChild(Le);else continue;Ie.appendChild(et),U.appendChild(Ie)}U.querySelectorAll("img").forEach(Ue=>{const Le=Ue,Pe=Le.closest(".image-grid-item"),Ie=()=>{const et=Le.naturalWidth,rt=Le.naturalHeight;Pe&&(Pe.classList.remove("ar-169","ar-34","ar-11"),et>rt?Pe.classList.add("ar-169"):rt>et?Pe.classList.add("ar-34"):Pe.classList.add("ar-11"))};Le.complete&&Le.naturalWidth&&Le.naturalHeight?Ie():Le.addEventListener("load",Ie,{once:!0})}),Y[0].replaceWith(U);for(let Ue=1;Ue<Y.length;Ue++)Y[Ue].remove()}},C=new RegExp("(?<!!)\\[([^\\]]+)\\]\\((https:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s)]*)?)\\)","g"),_=new RegExp(`(?<!["'\\(])\\bhttps:\\/\\/github\\.com\\/([\\w-]+)\\/([\\w.-]+)(?:\\/[^\\s<\\)]*)?\\b`,"g"),T=D=>{f.enableGithubCard&&(D=D.replace(C,(z,H,Y,U,j)=>`<div class="github-card" id="${`github-card-${U}-${j}`}" data-owner="${U}" data-repo="${j}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`),D=D.replace(_,(z,H,Y)=>`<div class="github-card" id="${`github-card-${H}-${Y}`}" data-owner="${H}" data-repo="${Y}">
        <div class="github-card-loading">Loading GitHub Repo...</div>
      </div>`));const N=new RegExp(`(?<!["'\\(])\\bhttps?:\\/\\/[^\\s<]+\\.(mp4|webm|mov|avi)(\\?[^\\s<\\)]*)?\\b`,"g");return D=D.replace(N,z=>`<video src="${z}" controls preload="metadata" style="width:100%;height:auto"></video>`),D.replace(r,"<div class='video-wrapper'><iframe src='https://www.bilibili.com/blackboard/html5mobileplayer.html?bvid=$1&as_wide=1&high_quality=1&danmaku=0' scrolling='no' border='0' frameborder='no' framespacing='0' allowfullscreen='true' style='position:absolute;height:100%;width:100%'></iframe></div>").replace(s,"<div class='video-wrapper'><iframe src='https://www.youtube.com/embed/$1$2' title='YouTube video player' frameborder='0' allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture' allowfullscreen></iframe></div>").replace(l,"<div class='music-wrapper'><meting-js auto='https://music.163.com/#/song?id=$1'></meting-js></div>").replace(d,"<meting-js auto='https://y.qq.com/n/yqq/song$1.html'></meting-js>").replace(m,"<div class='video-wrapper'><iframe src='//v.qq.com/iframe/player.html?vid=$1' allowFullScreen='true' frameborder='no'></iframe></div>").replace(u,"<div class='spotify-wrapper'><iframe style='border-radius:12px' src='https://open.spotify.com/embed/$1/$2?utm_source=generator&theme=0' width='100%' frameBorder='0' allowfullscreen='' allow='autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture' loading='lazy'></iframe></div>").replace(g,"<div class='video-wrapper'><iframe src='https://player.youku.com/embed/$1' frameborder=0 'allowfullscreen'></iframe></div>")},M=async(D,N,z)=>{try{const H=await fetch(`https://api.github.com/repos/${D}/${N}`);if(!H.ok)return;const Y=await H.json(),U=document.getElementById(z);U&&(U.innerHTML=`
        <div class="github-card-header">
          <img src="${Y.owner.avatar_url}" class="github-card-avatar" />
          <div>
            <a href="${Y.html_url}" target="_blank" class="github-card-title">${Y.full_name}</a>
            <div class="github-card-desc">${Y.description||""}</div>
          </div>
        </div>
        <div class="github-card-footer">
          <span>⭐ ${Y.stargazers_count}</span>
          <span>🍴 ${Y.forks_count}</span>
          <span>🛠️ ${Y.language||""}</span>
        </div>
      `)}catch{}},v=async D=>{if(k.value)try{if(typeof Or>"u"){console.error("Vditor is not loaded.");return}let N="";try{N=normalizeInlineImageLinks(D??"")}catch{N=D??""}const z=T(N),Y=(he=>he.replace(/(^|\s)(https?:\/\/[^\s<]+)/g,(Se,Ue,Le)=>`${Ue}<a href="${Le}" target="_blank" rel="noopener noreferrer">${Le}</a>`))(z);let U="";try{U=Y.replace(/<a /g,'<a target="_blank" ').replace(new RegExp("(?<!<[^>]*)#([^\\s#<>]+)(?![^<]*>)","g"),`<span class="clickable-tag" onclick="window.handleTagClick('$1')" style="cursor: pointer;">#$1</span>`)}catch{U=Y.replace(/<a /g,'<a target="_blank" ')}const j=b&&b.value==="dark"?"dark":"light",X=j==="dark"?"github-dark":"github";try{Or.preview(k.value,U,{mode:"light",lang:"zh_CN",theme:{current:j},hljs:{style:X,lineNumber:!0,enable:!0},markdown:{sanitize:!1},after:()=>{var Pe,Ie,et,rt;const he=(Pe=k.value)==null?void 0:Pe.querySelectorAll("a");he==null||he.forEach(B=>{B.hasAttribute("target")||(B.setAttribute("target","_blank"),B.setAttribute("rel","noopener noreferrer"))}),y(),w(),E(),(((Ie=k.value)==null?void 0:Ie.querySelectorAll("a[href]"))||[]).forEach(B=>{const le=B.getAttribute("href")||"";if(/\.(mp4|webm|mov|avi)(\?.*)?$/i.test(le)){const re=document.createElement("video");re.setAttribute("src",le),re.setAttribute("controls","true"),re.setAttribute("preload","metadata"),re.style.width="100%",re.style.height="auto",B.replaceWith(re)}}),console.log("Rendering complete."),x("rendered");const Ue=window.processNMPv2Shortcodes;Ue&&k.value&&Ue(k.value);const Le=(et=k.value)==null?void 0:et.querySelectorAll(".clickable-tag");if(Le==null||Le.forEach(B=>{B.addEventListener("click",le=>{var Re;le.preventDefault();const re=(Re=B.textContent)==null?void 0:Re.substring(1);re&&x("tagClick",re)})}),f.enableGithubCard){const B=(rt=k.value)==null?void 0:rt.querySelectorAll(".github-card");B==null||B.forEach(le=>{const re=le.getAttribute("data-owner"),Re=le.getAttribute("data-repo"),Ge=le.id;re&&Re&&Ge&&M(re,Re,Ge)})}}})}catch{try{k.value.innerHTML=Or.md2html(U),y()}catch{k.value.innerHTML=U}}}catch(N){console.error("Error rendering markdown:",N),k.value.innerHTML=""}};return xt(()=>f.content,async D=>{await v(D)},{immediate:!0}),Ht(()=>{v(f.content),window.APlayer&&window.MetingJSElement?console.log("MetingJS is ready"):console.error("MetingJS or APlayer is not loaded properly"),y()}),ji(()=>{h&&(h.detach(),h=null)}),xt(()=>b&&b.value,()=>{y(),v(f.content)}),(D,N)=>(Z(),oe("div",{ref_key:"previewElement",ref:k,class:"markdown-preview"},null,512))}}),df={class:"builtin-comments"},ff={key:0,class:"comments-list"},hf=["src","data-mail","onError"],pf={class:"comment-body"},mf={class:"comment-nick"},gf=["href"],vf={class:"comment-footer"},bf={class:"comment-time"},yf={class:"comment-replies"},wf={class:"comment-actions"},kf=["onClick"],Ef=["onClick"],xf={key:0,class:"mt-2 replies-list"},Sf=["src","data-mail","onError"],Cf={class:"comment-body"},_f={class:"comment-nick"},Tf=["href"],Mf={class:"comment-footer"},Af={class:"comment-time"},Lf={class:"comment-actions"},Df=["onClick"],Of=["onClick"],Pf={key:1,class:"flex justify-end w-full"},Rf=["onClick"],If={key:1,class:"flex justify-center"},Hf={key:4,class:"space-y-3 mt-3 md:mt-4"},Nf={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},jf={class:"flex flex-wrap items-center gap-2 mb-2"},$f={class:"relative"},Bf={class:"flex flex-wrap gap-1 w-56"},Uf=["onClick"],zf={class:"comment-input-card"},Ff=["src","data-mail"],Vf={class:"input-main"},qf={class:"input-actions"},Wf=["disabled"],Yf={class:"flex justify-between items-center"},Kf={class:"space-y-3"},Gf={class:"text-sm"},Xf={class:"text-sm"},Zf={class:"text-sm break-words"},Jf={class:"flex items-center gap-2 text-sm"},Qf={class:"flex justify-end gap-2"},za="w-full px-2 py-1 border rounded ring-0 focus:ring-0 outline-none",Fa="w-full px-2 py-1 bg-[rgba(24,28,32,0.85)] text-white border rounded focus:ring-0 outline-none placeholder:text-gray-400",eh=rn({__name:"BuiltinComments",props:{messageId:{},siteConfig:{},showInput:{type:Boolean}},setup(p){const e=p,r=G([]),s=G(""),l=G(""),d=G(!1),m=G(""),u=G(""),g=G(""),x=G(null),k=G(!1),h=G(null),f=G(!1),b=G(!1),y=G(null),E=Zn(),w=ge(()=>{var F;return!!((F=E.user)!=null&&F.is_admin)}),C=ge(()=>{const F=e.siteConfig||{};return!!(F&&(F.commentEnabled===!0||F.commentEnabled==="true"))}),_=ge(()=>{const F=e.siteConfig||{};return!!(F&&(F.commentLoginRequired===!0||F.commentLoginRequired==="true"))}),T=ge(()=>(!_.value||E.isLogin)&&C.value),M=$i("contentTheme",G("light")),v=ge(()=>{const F=M&&typeof M.value<"u"?M.value:M;return String(F||"light")==="dark"}),D=ge(()=>"bg-transparent"),N=ge(()=>v.value?"border-white/20":"border-black"),z=ge(()=>v.value?"text-gray-200":"text-black"),H=ge(()=>v.value?"text-gray-400":"text-gray-500");ge(()=>v.value?"bg-[rgba(24,28,32,0.7)]":"bg-white"),ge(()=>v.value?"border-white/20":"border-black");const Y=ge(()=>v.value?"rounded-md p-3 bg-transparent border border-white/20 shadow-[0_6px_16px_rgba(0,0,0,0.35)]":"rounded-md p-3 bg-transparent border border-black/10 shadow-[0_4px_12px_rgba(0,0,0,0.12)]"),U=ge(()=>v.value?"rounded-md p-2 bg-transparent border border-white/20":"rounded-md p-2 bg-transparent border border-black/10"),j=ge(()=>f.value?"ring-1 ring-red-500":v.value?`${Fa} border-white/20`:`bg-gray-50 ${za} border-black`),X=ge(()=>b.value?"ring-1 ring-red-500":v.value?`${Fa} border-white/20`:`bg-gray-50 ${za} border-black`),he=ge(()=>v.value?`${Fa} border-white/20`:`bg-white ${za} border-black`),Se=ge(()=>v.value?"w-full px-3 py-2 bg-[rgba(24,28,32,0.95)] text-white border border-blue-500 focus:border-blue-400 rounded-md ring-0 outline-none":"w-full px-3 py-2 bg-white text-black border border-blue-500 focus:border-blue-600 rounded-md ring-0 outline-none"),Ue=ge(()=>{const F=e.siteConfig||{},J=String(F.avatarURL||"").trim();return J?/^https?:\/\//i.test(J)?J:`${ce}${J}`:String(F.rssFaviconURL||"/favicon.svg").trim()}),Le=(F,J=60)=>{const xe=encodeURIComponent(String(F||"").trim());return xe?`https://api.dicebear.com/7.x/initials/svg?seed=${xe}&backgroundType=gradient&radius=50&scale=100&size=${J}`:""},Pe=F=>{const J=String(F||"").trim().match(/^([0-9]{5,12})@qq\.com$/i);return J?J[1]:""},Ie=(F,J=100)=>F?`https://q1.qlogo.cn/g?b=qq&nk=${F}&s=${J}`:"",et=F=>{var xn,Yn,ii,jn;const J=String((F==null?void 0:F.nick)||"").trim(),xe=String((F==null?void 0:F.mail)||"").trim(),De=Pe(xe),ze=Ie(De),ut=Zn(),Be=String(((xn=ut.user)==null?void 0:xn.username)||((Yn=ut.user)==null?void 0:Yn.Username)||"").trim(),Rt=String(((ii=ut.user)==null?void 0:ii.avatar_url)||((jn=ut.user)==null?void 0:jn.AvatarURL)||"").trim(),en=$n=>$n?/^https?:\/\//i.test($n)?$n:`${ce}${$n}`:"";return Be&&J&&Be===J&&Rt?en(Rt):ze||rt(J||xe||"anonymous")||Ue.value},rt=(F,J=60)=>{const xe=encodeURIComponent(String(F||"").trim());return xe?`https://i.pravatar.cc/${J}?u=${xe}`:""},B=(F=60)=>{const J=`<svg xmlns="http://www.w3.org/2000/svg" width="${F}" height="${F}" viewBox="0 0 64 64"><rect width="64" height="64" rx="32" fill="#9ca3af"/><circle cx="32" cy="24" r="12" fill="#e5e7eb"/><path d="M16 52c0-10 8-18 16-18s16 8 16 18" fill="#e5e7eb"/></svg>`;return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(J)},le=(F,J)=>{var Rt;const xe=F.target,De=((Rt=xe==null?void 0:xe.dataset)==null?void 0:Rt.mail)||"",ze=Pe(De),Be=Ie(ze)||rt(J||De||"anonymous")||B(60);xe&&Be&&(xe.src=Be)},re=ge(()=>{const F=!!Pe(String(m.value||"")),J=!!String(s.value||"").trim()&&d.value;return F||J}),Re=ge(()=>{const F=String(m.value||"").trim(),J=Pe(F);if(J)return Ie(J,100);const xe=String(s.value||"").trim();return xe?Le(xe):""}),Ge=G(!1),Q=()=>{Ge.value=!0};xt([s,m],()=>{Ge.value=!1});const Ce=()=>{d.value=!0};Ht(()=>{l.value=s.value});const ce=gn().public.baseApi||"/api",ne=G(!1),Ve=G(!1),pe=ge(()=>{const F=y.value;return F&&(r.value||[]).find(J=>Number(J.id)===Number(F))||null}),ct=ge(()=>{const F=pe.value,J=String(F&&F.content||"").trim();return J.length>120?J.slice(0,120)+"...":J}),Je=()=>{Ve.value=!1,ne.value=!1},ot=async()=>{try{const F=async ze=>{const ut=await fetch(ze,{credentials:"include",headers:{Accept:"application/json"}});if(!ut||!ut.ok)return null;const Be=await ut.json();return!Be||Be.code!==1||!Array.isArray(Be.data)?[]:Be.data},J=typeof window<"u"?window.location.origin:"",xe=[`${ce}/messages/${e.messageId}/comments`,`${J}/api/messages/${e.messageId}/comments`,`http://localhost:1315/api/messages/${e.messageId}/comments`,`http://127.0.0.1:1315/api/messages/${e.messageId}/comments`];let De=[];for(const ze of xe){const ut=await F(ze);if(ut&&ut.length>=0&&(De=ut,De.length>0))break}r.value=(De||[]).sort((ze,ut)=>new Date(ut.created_at).getTime()-new Date(ze.created_at).getTime());try{window.dispatchEvent(new CustomEvent("comment-count-updated",{detail:{messageId:e.messageId,count:r.value.length}}))}catch{}}catch{r.value=[]}},_e=async()=>{try{if(k.value)return;if(k.value=!0,f.value=!s.value.trim(),b.value=!m.value.trim(),f.value||b.value){We().add({title:"缺少必填字段",description:(s.value?"":"昵称 ")+(m.value?"":"邮箱"),color:"red"}),k.value=!1;return}const F=g.value.trim(),J={nick:s.value.trim(),mail:m.value.trim(),link:u.value.trim(),content:F};if(!J.content){We().add({title:"内容不能为空",color:"red"}),k.value=!1;return}if(J.mail&&!/^\S+@\S+\.\S+$/.test(J.mail)){We().add({title:"邮箱格式不正确",color:"red"}),k.value=!1;return}h.value&&(J.parent_id=h.value);const xe=await Hi(`messages/${e.messageId}/comments`,J,{credentials:"include"});if(xe&&xe.code===1){g.value="",h.value=null,r.value=[...r.value,xe.data],await ot(),await vt();const De=document.querySelector(`.content-container[data-msg-id="${e.messageId}"] .builtin-comments`),ze=De==null?void 0:De.querySelectorAll(".rounded-md"),ut=ze&&ze.length?ze[ze.length-1]:null;ut==null||ut.scrollIntoView({behavior:"smooth",block:"center"}),We().add({title:"已发布",color:"green"});try{window.dispatchEvent(new CustomEvent("comment-count-updated",{detail:{messageId:e.messageId,count:r.value.length}}))}catch{}}else We().add({title:"发布失败",description:xe==null?void 0:xe.msg,color:"red"})}catch{We().add({title:"发布失败",color:"red"})}finally{k.value=!1}},tt=F=>{const J=new Date(F),xe=J.getMonth()+1,De=J.getDate();return`${xe}月${De}日`},kt=F=>{const J=String(F||"").trim();return J&&/^https?:\/\//i.test(J)?J:""},wt=(F,J)=>{for(const xe of J){const De=String((F||{})[xe]||"").trim();if(De)return De}return""},nt=()=>{const F=E.user||{},J=wt(F,["nick","nickname","Nick","Nickname","username","Username","name","Name"]),xe=wt(F,["email","Email","mail","Mail"]),De=wt(F,["link","Link","website","Website","homepage","HomePage","url","Url"]);!s.value&&J&&(s.value=J),!m.value&&xe&&(m.value=xe),!u.value&&De&&(u.value=De)},Yt=G(!1),yn=ge(()=>(e.showInput&&!Yt.value||!!h.value)&&T.value);xt(()=>e.showInput,F=>{F&&(Yt.value=!1)}),xt([yn,()=>E.isLogin],()=>{yn.value&&E.isLogin&&nt()},{immediate:!0}),Ht(ot);const Pt=()=>ot();Ht(()=>{window.addEventListener(`refresh-comments-${e.messageId}`,Pt)}),ji(()=>{window.removeEventListener(`refresh-comments-${e.messageId}`,Pt)}),xt(()=>e.messageId,ot);const an=(F,J)=>{h.value=F,g.value.startsWith(`@${J} `)||(g.value=`@${J} `+g.value),nt()},ht=F=>{y.value=F,confirm("确认删除该评论吗？此操作不可恢复。")?(Ve.value=!1,ne.value=!0):y.value=null},In=async()=>{if(y.value)try{if(!Ve.value){We().add({title:"请先勾选确认",color:"orange"});return}const F=await fs(`messages/${e.messageId}/comments/${y.value}`,void 0,{credentials:"include"});F&&F.code===1?(r.value=r.value.filter(J=>J.id!==y.value),We().add({title:"已删除",color:"green"}),on()):We().add({title:"删除失败",description:F==null?void 0:F.msg,color:"red"})}catch{We().add({title:"删除失败",color:"red"})}finally{y.value=null,Je()}},on=()=>{const F=document.querySelector(`.content-container[data-msg-id="${e.messageId}"]`);F==null||F.scrollIntoView({behavior:"smooth",block:"start"})},Vt=ge(()=>{const F=Array.isArray(r.value)?r.value:[],J=new Set;return F.forEach(xe=>{const De=String((xe==null?void 0:xe.nick)||"").trim();De&&J.add(De)}),Array.from(J)}),Gt=G(!1),sn=G(""),fn=G(0),Wn=ge(()=>{const F=sn.value.toLowerCase();return Vt.value.filter(xe=>xe.toLowerCase().startsWith(F)).slice(0,20)}),hn=()=>{Gt.value=!1,fn.value=0,sn.value=""},Bt=()=>{Gt.value=!0,fn.value=0},bt=()=>{const F=x.value;return F?{start:F.selectionStart||0,end:F.selectionEnd||0}:{start:0,end:0}},Nt=(F,J,xe,De)=>{const ze=F.slice(0,J),ut=F.slice(xe);return ze+De+ut},Ut=()=>{const F=x.value;if(!F)return;const J=F.selectionStart||0,xe=g.value;let De=J-1;for(;De>=0&&xe[De]!==`
`&&xe[De]!==" ";)De--;const ze=De+1;if(xe[ze]!=="@"){hn();return}const ut=J,Be=xe.slice(ze+1,ut);sn.value=Be,Bt()},Qt=()=>{const F=x.value;F&&(F.style.height="auto",F.style.height=Math.max(80,F.scrollHeight)+"px")},se=()=>{Ut(),Qt()},W=F=>{if(F.key==="Enter"&&(F.ctrlKey||F.metaKey)){F.preventDefault(),g.value.trim()&&_e();return}if(F.key==="@"){vt(Ut);return}if(Gt.value)if(F.key==="ArrowDown")F.preventDefault(),fn.value=Math.min(fn.value+1,Wn.value.length-1);else if(F.key==="ArrowUp")F.preventDefault(),fn.value=Math.max(fn.value-1,0);else if(F.key==="Enter"){F.preventDefault();const J=Wn.value[fn.value];J&&Ye(J)}else F.key==="Escape"&&hn()};Ht(()=>{vt(Qt)});const q=ge(()=>(v.value,"bg-blue-500 text-white hover:bg-blue-600 disabled:opacity-60")),ee=ge(()=>v.value?"bg-gray-600 text-white hover:bg-gray-500":"bg-gray-200 text-black hover:bg-gray-300"),te=()=>{g.value="",hn(),vt(Qt)},je=()=>{var J;g.value="",h.value=null,Yt.value=!0,hn();const F=x.value;(J=F==null?void 0:F.blur)==null||J.call(F),vt(Qt),emit("cancel",{empty:(r.value||[]).length===0})},Ye=F=>{const J=x.value;if(!J)return;const xe=J.selectionStart||0,De=g.value;let ze=xe-1;for(;ze>=0&&De[ze]!==`
`&&De[ze]!==" ";)ze--;const ut=ze+1,Be=xe;g.value=Nt(De,ut,Be,`@${F} `),hn(),vt(()=>{const Rt=ut+F.length+2;J.setSelectionRange(Rt,Rt),J.focus()})},Ze=G(!1),yt=["😀","😄","😁","😆","😊","😍","🤔","👍","🔥","🎉","❤️","🥳","✨","🌟","🍀"],ve=()=>{Ze.value=!Ze.value},Tt=F=>{const J=x.value;if(!J){g.value+=F;return}const{start:xe,end:De}=bt();g.value=Nt(g.value,xe,De,F);const ze=xe+F.length;vt(()=>{J.setSelectionRange(ze,ze),J.focus()})},Et=F=>{Tt(F),Ze.value=!1},it=F=>{x.value;const{start:J,end:xe}=bt(),De=g.value.slice(J,xe);if(F==="bold")Tt(De?`**${De}**`:"**加粗**");else if(F==="italic")Tt(De?`*${De}*`:"*斜体*");else if(F==="link"){const ze=window.prompt("请输入链接地址","https://")||"";/^https?:\/\//i.test(ze)&&Tt(De?`[${De}](${ze})`:`[链接文本](${ze})`)}else if(F==="image"){const ze=window.prompt("请输入图片地址","https://")||"";/^https?:\/\//i.test(ze)&&Tt(`![图片](${ze})`)}},dt=ge(()=>(Array.isArray(r.value)?r.value:[]).filter(xe=>xe&&(xe.parent_id===null||Number(xe.parent_id||0)===0))),Hn=ge(()=>{const F={};return(Array.isArray(r.value)?r.value:[]).forEach(xe=>{F[Number(xe.id)]=xe}),F}),wn=ge(()=>{const F={},J={};return(Array.isArray(r.value)?r.value:[]).forEach(De=>{const ze=Number((De==null?void 0:De.parent_id)||0);if(ze>0){const ut=Hn.value[ze];if(!ut)return;J[Number(De.id)]=String(ut.nick||"");let Be=ut;for(;Number((Be==null?void 0:Be.parent_id)||0)>0;){const en=Hn.value[Number(Be.parent_id)];if(!en)break;Be=en}const Rt=Number(Be.id);F[Rt]||(F[Rt]=[]),F[Rt].push(De)}}),Object.keys(F).forEach(De=>{F[Number(De)]=(F[Number(De)]||[]).sort((ze,ut)=>new Date(ut.created_at).getTime()-new Date(ze.created_at).getTime())}),{map:F,targetMap:J}}),jt=ge(()=>wn.value.map);ge(()=>wn.value.targetMap);const zt=ge(()=>(Array.isArray(dt.value)?dt.value:[]).slice().sort((J,xe)=>new Date(xe.created_at).getTime()-new Date(J.created_at).getTime())),$t=G(3),kn=ge(()=>zt.value.slice(0,$t.value)),En=ge(()=>zt.value.length>$t.value),ni=()=>{$t.value+=3};xt(()=>e.messageId,()=>{$t.value=3});const ln=G({}),Nn=F=>{const J=ln.value[F]??3;return(jt.value[F]||[]).slice(0,J)},Dt=F=>{const J=(jt.value[F]||[]).length,xe=ln.value[F]??3;return J>xe},cn=F=>{const J=ln.value[F]??3;ln.value[F]=J+3};xt(jt,F=>{const J={...ln.value};Object.keys(F||{}).forEach(xe=>{const De=Number(xe);J[De]||(J[De]=3)}),ln.value=J}),xt(()=>e.messageId,()=>{ln.value={}});const at=F=>(jt.value[F]||[]).length;return(F,J)=>{var ut;const xe=Ir,De=pa,ze=ga;return Z(),oe("div",df,[I("div",{class:ke(["waline-wrapper px-2 py-2 rounded-lg",[D.value]])},[I("div",{class:ke(["text-sm mb-2",z.value])},"评论 ("+Fe(r.value.length)+")",3),zt.value.length?(Z(),oe("div",ff,[(Z(!0),oe(It,null,Jt(kn.value,(Be,Rt)=>{var en;return Z(),oe("div",{key:Be.id,class:ke(["comment-item",Y.value])},[I("img",{class:"comment-avatar avatar-img",src:et(Be),alt:"avatar","data-mail":Be.mail||"",onError:pt=>le(pt,Be.nick||"")},null,40,hf),I("div",pf,[I("div",{class:ke(["comment-header",z.value])},[I("span",mf,[kt(Be.link)?(Z(),oe("a",{key:0,href:kt(Be.link),target:"_blank",rel:"noopener noreferrer"},Fe(Be.nick||"匿名"),9,gf)):(Z(),oe(It,{key:1},[mt(Fe(Be.nick||"匿名"),1)],64))])],2),I("div",{class:ke(["comment-content",z.value])},[ie(yi,{content:Be.content},null,8,["content"])],2),I("div",vf,[I("span",bf,Fe(tt(Be.created_at)),1),I("span",yf,"回复 "+Fe(at(Be.id)),1)]),I("div",wf,[I("button",{class:"action-btn",onClick:pt=>an(Be.id,Be.nick||"匿名")},"回复",8,kf),w.value?(Z(),oe("button",{key:0,class:"action-btn text-red-500",onClick:pt=>ht(Be.id)},"删除",8,Ef)):Oe("",!0)]),(en=jt.value[Be.id])!=null&&en.length?(Z(),oe("div",xf,[(Z(!0),oe(It,null,Jt(Nn(Be.id),pt=>(Z(),oe("div",{key:pt.id,class:ke(["comment-item child",U.value])},[I("img",{class:"comment-avatar avatar-img",src:et(pt),alt:"avatar","data-mail":pt.mail||"",onError:xn=>le(xn,pt.nick||"")},null,40,Sf),I("div",Cf,[I("div",{class:ke(["comment-header",z.value])},[I("span",_f,[kt(pt.link)?(Z(),oe("a",{key:0,href:kt(pt.link),target:"_blank",rel:"noopener noreferrer"},Fe(pt.nick||"匿名"),9,Tf)):(Z(),oe(It,{key:1},[mt(Fe(pt.nick||"匿名"),1)],64))])],2),I("div",{class:ke(["comment-content",z.value])},[ie(yi,{content:pt.content},null,8,["content"])],2),I("div",Mf,[I("span",Af,Fe(tt(pt.created_at)),1)]),I("div",Lf,[I("button",{class:"action-btn",onClick:xn=>an(pt.id,pt.nick||"匿名")},"回复",8,Df),w.value?(Z(),oe("button",{key:0,class:"action-btn text-red-500",onClick:xn=>ht(pt.id)},"删除",8,Of)):Oe("",!0)])])],2))),128))])):Oe("",!0),Dt(Be.id)?(Z(),oe("div",Pf,[I("button",{class:ke(["text-xs px-2 py-1 rounded border",N.value]),onClick:pt=>cn(Be.id)},"加载更多回复",10,Rf)])):Oe("",!0)])],2)}),128))])):Oe("",!0),En.value?(Z(),oe("div",If,[I("button",{class:ke(["text-xs px-3 py-1 rounded border",N.value]),onClick:ni},"加载更多评论",2)])):Oe("",!0),zt.value.length?Oe("",!0):(Z(),oe("div",{key:2,class:ke(["text-xs mb-4",H.value])},"暂无评论",2)),(e.showInput||h.value)&&C.value&&((ut=F.siteConfig)!=null&&ut.commentEmailEnabled)&&T.value?(Z(),oe("div",{key:3,class:ke(["text-xs mb-2",H.value])},"新评论或回复会发送通知邮件",2)):Oe("",!0),(e.showInput||h.value)&&C.value&&T.value?(Z(),oe("div",Hf,[I("div",Nf,[Ri(I("input",{"onUpdate:modelValue":J[0]||(J[0]=Be=>s.value=Be),placeholder:"昵称",class:ke(j.value),onInput:Ce},null,34),[[qr,s.value]]),Ri(I("input",{"onUpdate:modelValue":J[1]||(J[1]=Be=>m.value=Be),placeholder:"邮箱",class:ke(X.value)},null,2),[[qr,m.value]]),Ri(I("input",{"onUpdate:modelValue":J[2]||(J[2]=Be=>u.value=Be),placeholder:"网址（可选）",class:ke(he.value)},null,2),[[qr,u.value]])]),I("div",jf,[I("button",{class:ke(["text-xs px-2 py-1 rounded border",N.value]),onClick:J[3]||(J[3]=Be=>it("bold"))},"加粗",2),I("button",{class:ke(["text-xs px-2 py-1 rounded border",N.value]),onClick:J[4]||(J[4]=Be=>it("italic"))},"斜体",2),I("button",{class:ke(["text-xs px-2 py-1 rounded border",N.value]),onClick:J[5]||(J[5]=Be=>it("link"))},"链接",2),I("button",{class:ke(["text-xs px-2 py-1 rounded border",N.value]),onClick:J[6]||(J[6]=Be=>it("image"))},"图片",2),I("div",$f,[I("button",{class:ke(["text-xs px-2 py-1 rounded border",N.value]),onClick:ve},"表情",2),Ze.value?(Z(),oe("div",{key:0,class:ke(["absolute z-10 mt-1 p-2 rounded border bg-white shadow",N.value])},[I("div",Bf,[(Z(),oe(It,null,Jt(yt,Be=>I("button",{key:Be,class:"px-2 py-1 text-sm",onClick:Rt=>Et(Be)},Fe(Be),9,Uf)),64))])],2)):Oe("",!0)])]),I("div",zf,[re.value&&!Ge.value?(Z(),oe("img",{key:0,class:"input-avatar avatar-img",src:Re.value,"data-mail":m.value,alt:"avatar",onError:Q},null,40,Ff)):Oe("",!0),I("div",Vf,[Ri(I("textarea",{ref_key:"taRef",ref:x,"onUpdate:modelValue":J[7]||(J[7]=Be=>g.value=Be),class:ke(Se.value),rows:"4",placeholder:"说说你的想法",onInput:se,onKeydown:W,onBlur:hn},null,34),[[qr,g.value]]),I("div",qf,[g.value.trim()?(Z(),oe("button",{key:0,class:ke(["cancel-btn",ee.value]),onClick:te},"清除",2)):Oe("",!0),I("button",{class:ke(["cancel-btn",ee.value]),onClick:je},"取消",2),I("button",{class:ke(["submit-btn",q.value]),disabled:k.value||!g.value.trim(),onClick:_e},"提交",10,Wf)])])])])):e.showInput&&!C.value?(Z(),oe("div",{key:5,class:ke(["text-xs text-center mt-4 mb-2",H.value])},"评论功能未开启",2)):e.showInput&&C.value&&!T.value?(Z(),oe("div",{key:6,class:ke(["text-xs text-center mt-4 mb-2",H.value])},"请登录后评论",2)):Oe("",!0)],2),ie(ze,{modelValue:ne.value,"onUpdate:modelValue":J[9]||(J[9]=Be=>ne.value=Be),ui:{width:"sm:max-w-md"}},{default:Me(()=>[ie(De,null,{header:Me(()=>[I("div",Yf,[J[10]||(J[10]=I("h3",{class:"text-lg font-medium"},"再次确认删除",-1)),ie(xe,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:Je})])]),footer:Me(()=>[I("div",Qf,[ie(xe,{color:"gray",variant:"outline",onClick:Je},{default:Me(()=>J[13]||(J[13]=[mt("取消")])),_:1}),ie(xe,{color:"red",disabled:!Ve.value,onClick:In},{default:Me(()=>J[14]||(J[14]=[mt("确认删除")])),_:1},8,["disabled"])])]),default:Me(()=>{var Be,Rt;return[I("div",Kf,[J[12]||(J[12]=I("div",{class:"text-sm"},"此操作不可恢复，确认删除该评论？",-1)),I("div",Gf,"评论ID："+Fe(((Be=pe.value)==null?void 0:Be.id)||y.value),1),I("div",Xf,"昵称："+Fe(((Rt=pe.value)==null?void 0:Rt.nick)||"匿名"),1),I("div",Zf,"内容片段："+Fe(ct.value),1),I("label",Jf,[Ri(I("input",{type:"checkbox","onUpdate:modelValue":J[8]||(J[8]=en=>Ve.value=en)},null,512),[[xc,Ve.value]]),J[11]||(J[11]=mt(" 我已知晓此操作不可恢复 "))])])]}),_:1})]),_:1},8,["modelValue"])])}}}),Zs=Mn(eh,[["__scopeId","data-v-2e994d72"]]),th={class:"min-h-screen flex flex-col"},nh={key:0,class:"text-center text-gray-500 py-8"},ih={key:0,class:"flex justify-between items-center mb-4 p-4 rounded-lg"},rh={class:"text-gray-400"},ah={class:"my-4"},oh={key:0,class:"text-center text-gray-500 py-8"},sh={class:"p-0"},lh=["data-msg-id"],ch={class:"flex items-center gap-2 mb-2 author-row"},uh=["src","onError"],dh={class:"min-w-0"},fh={class:"text-sm font-semibold leading-tight"},hh={class:"text-xs opacity-70"},ph={class:"ml-auto flex items-center gap-2 text-xs opacity-80"},mh=["href","data-fancybox"],gh=["src","fetchpriority"],vh={key:1,class:"border-t border-gray-600 my-4"},bh=["onClick"],yh={class:"message-socialbar"},wh=["onClick"],kh={class:"ml-1 text-xs opacity-80"},Eh=["onClick"],xh={class:"ml-1 text-xs opacity-80"},Sh={class:"toolbox-anchor"},Ch={class:"tool-icons"},_h=["onClick","title"],Th={key:1,class:"tool-icon"},Mh=["onClick","title"],Ah=["onClick"],Lh=["onClick"],Dh=["onClick"],Oh=["onClick"],Ph=["id"],Rh=["id"],Ih={key:1,class:"flex justify-center items-center space-x-4 w-full my-4 flex-wrap md:flex-nowrap"},Hh={class:"flex justify-center items-center space-x-4 w-full md:w-auto"},Nh={key:2,class:"ml-2 text-orange-400"},jh={class:"flex items-center justify-center space-x-2 w-full md:w-auto mt-3 md:mt-0"},$h={class:"text-gray-500 text-shadow-sm text-sm"},Bh={key:2,class:"text-center text-gray-500 mt-4"},Uh={class:"flex justify-between items-center"},zh={class:"flex flex-col space-y-4"},Fh={class:"border-t border-gray-200 my-2 pt-2"},Vh={class:"p-4 rounded-lg overflow-auto max-h-[300px] bg-[rgba(36,43,50,0.95)]"},qh={class:"text-white"},Wh={class:"flex justify-end space-x-2"},Yh=rn({__name:"MessageList",props:{siteConfig:{type:Object,required:!0},targetMessageId:{type:String,default:null},wide:{type:Boolean,default:!1}},setup(p,{expose:e}){const r=$i("contentTheme",G(typeof window<"u"&&localStorage.getItem("contentTheme")||"dark")),s=ge(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white":"bg-white text-black"),l=ge(()=>r.value==="dark"?"text-white":"text-black"),d=ge(()=>r.value==="dark"?"from-[rgba(36,43,50,1)] via-[rgba(36,43,50,0.8)] to-transparent":"from-[rgba(255,255,255,1)] via-[rgba(255,255,255,0.8)] to-transparent"),m=W=>{var Ye,Ze,yt,ve;const q=String(((Ye=Zn().user)==null?void 0:Ye.username)||"").trim(),ee=String(((Ze=Zn().user)==null?void 0:Ze.avatar_url)||((yt=Zn().user)==null?void 0:yt.AvatarURL)||"").trim(),te=String(((ve=v.siteConfig)==null?void 0:ve.avatarURL)||"").trim(),je=Tt=>Tt?/^https?:\/\//i.test(Tt)?Tt:`${H}${Tt}`:"";return q&&String((W==null?void 0:W.username)||"").trim()===q&&ee?je(ee):je(te)||`https://api.dicebear.com/7.x/initials/svg?seed=${encodeURIComponent(String((W==null?void 0:W.username)||"匿名"))}&backgroundType=gradient&radius=50&scale=100&size=64`},u=(W,q)=>{const ee=W.target,te=`https://i.pravatar.cc/64?u=${encodeURIComponent(q)}`;ee&&(ee.src=te)},g=ge(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.95)] text-white hover:text-white border-none shadow-sm rounded-full":"bg-white text-black hover:text-black border border-gray-300 shadow-sm rounded-full"),x=ge(()=>r.value==="dark"?"bg-[rgba(36,43,50,0.75)] text-white hover:text-white hover:bg-[rgba(36,43,50,0.85)] active:bg-[rgba(36,43,50,0.9)] focus:bg-[rgba(36,43,50,0.85)] border border-white/70":"bg-[rgba(24,28,32,0.6)] text-white hover:text-white hover:bg-[rgba(24,28,32,0.7)] active:bg-[rgba(24,28,32,0.75)] focus:bg-[rgba(24,28,32,0.7)] border border-white/70"),k=G(null),h=W=>{k.value=k.value===W?null:W},f=W=>{const q=W.target;if(!q){k.value=null;return}const ee=!!q.closest(".message-toolbox"),te=!!q.closest(".tool-open-btn");!ee&&!te&&(k.value=null)};Ht(()=>{window.addEventListener("scroll",()=>{k.value=null}),document.addEventListener("click",f,!0)}),ji(()=>{document.removeEventListener("click",f,!0)});const b=ge(()=>r.value==="dark"?"toolbox-dark":"toolbox-light"),y=G({}),E=G({}),w=G({}),C=async W=>{var q,ee;try{const te=await fetch(`${H}/messages/${W}/like/toggle`,{method:"POST",credentials:"include",headers:{Accept:"application/json"}});if(!te.ok)throw new Error("点赞失败");const je=await te.json(),Ye=((q=je==null?void 0:je.data)==null?void 0:q.like_count)??(y.value[W]||0),Ze=!!((ee=je==null?void 0:je.data)!=null&&ee.liked);y.value[W]=Ye,E.value[W]=Ze}catch{We().add({title:"点赞失败",color:"red",timeout:2e3})}},_=G(""),T=ge(()=>Math.ceil(j.total/15)),M=async()=>{const W=parseInt(_.value);if(!W||W<1||W>T.value||j.loading){We().add({title:"页码无效",description:`请输入 1-${T.value} 之间的数字`,color:"orange",timeout:2e3});return}try{const q=document.querySelector(".content-wrapper"),ee=q?q.scrollTop:window.scrollY,te=await j.getMessages({page:W,pageSize:15});if(!te)throw new Error("跳转页面失败");const je=te.items.filter(Ye=>!Ye.pinned);j.messages=[...pe.value,...je],j.page=te.page||W,_.value="",await vt(),q?q.scrollTo({top:ee,behavior:"instant"}):window.scrollTo({top:ee,behavior:"instant"})}catch(q){console.error("跳转页面失败:",q),We().add({title:"跳转失败",color:"red",timeout:2e3})}},v=p,D=ge(()=>v.wide?"flex-grow w-full px-1 sm:px-2":"flex-grow mx-auto w-full sm:max-w-4xl px-1 sm:px-2"),N=ge(()=>v.wide?"":"mx-auto sm:max-w-4xl"),z=ge(()=>!1);xt(()=>v.targetMessageId,async W=>{if(!W)return;await vt();const q=document.querySelector(`.content-container[data-msg-id="${W}"]`);q&&(q.scrollIntoView({behavior:"smooth",block:"center"}),q.classList.add("highlight-message"),setTimeout(()=>{q.classList.remove("highlight-message")},2e3))},{immediate:!0});const H=gn().public.baseApi||"/api",Y=G(!0),U=async()=>{try{const W=await fetch(`${H}/status`,{credentials:"include"});Y.value=!!W&&W.ok}catch{Y.value=!1}};Ds();const j=Ls(),X=G(null),he=G({}),Se=G({}),Ue=ge(()=>{var q;const W=(q=v.siteConfig)==null?void 0:q.commentEnabled;return W===!0||W==="true"}),Le=ge(()=>!0),Pe=G(null),Ie=W=>{if(!W)return!1;if(Pe.value&&W.id===Pe.value)return!0;const q=String(W.content||"").toLowerCase();return/#guestbook|#留言|留言板/.test(q)},et=async()=>{var W;try{const q=await fetch(`${H}/guestbook/message`,{credentials:"include",headers:{Accept:"application/json"}});if(q.ok){const ee=await q.json(),te=(W=ee==null?void 0:ee.data)==null?void 0:W.id;te&&(Pe.value=Number(te))}}catch{}},rt=W=>(j.messages||[]).find(q=>q.id===W),B=Zn(),le=ge(()=>B.isLogin),re=async W=>{try{const q=encodeURIComponent(W.trim()),ee=await fetch(`${H}/messages/tags/${q}`,{credentials:"include",headers:{Accept:"application/json"}});if(!ee.ok)throw new Error(`HTTP error! status: ${ee.status}`);const te=await ee.json();if(te.code===1&&Array.isArray(te.data))Bt.value=!0,bt.value=te.data,await vt(),nt(),Q();else throw new Error(te.msg||"获取标签内容失败")}catch(q){console.error("获取标签消息失败:",q),We().add({title:"获取标签消息失败",description:q.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},Re=async()=>{bt.value=[],Bt.value=!1,await j.getMessages({page:1,pageSize:15}),await vt(),nt(),Q()},Ge=async W=>{if(confirm("确定要删除这条消息吗？"))try{await j.deleteMessage(W),j.messages=j.messages.filter(ee=>ee.id!==W),We().add({title:"删除成功",color:"green",timeout:2e3})}catch(ee){console.error("删除失败:",ee),We().add({title:"删除失败",color:"red",timeout:2e3})}},Q=()=>{if(window.Fancybox){window.Fancybox.destroy();const W={Carousel:{infinite:!1},Toolbar:{display:[{id:"prev",position:"center"},{id:"counter",position:"center"},{id:"next",position:"center"},"zoom","slideshow","fullscreen","close"]},Image:{zoom:!0,click:!0,wheel:"slide"}};document.querySelectorAll(".markdown-preview img").forEach(ee=>{const te=ee.getAttribute("src")||"",je=/^https?:\/\//i.test(te),Ye=ee.parentElement;if(Ye&&Ye.tagName==="A"&&Ye.hasAttribute("data-fancybox")){je||Ye.replaceWith(ee);return}if(je){const Ze=document.createElement("a");Ze.href=te,Ze.setAttribute("data-fancybox","uploaded-image"),Ze.style.display="block",ee.parentNode.insertBefore(Ze,ee),Ze.appendChild(ee)}else Ye&&Ye.tagName==="A"&&Ye.hasAttribute("data-fancybox")&&Ye.replaceWith(ee)}),window.Fancybox.bind("[data-fancybox]",W)}},Ce=async W=>{var te,je;const q=rt(W);if(Ie(q))return;if(!!(Se.value[W]||X.value===W)){Se.value[W]=!1,X.value===W&&(X.value=null);return}if(X.value=W,await vt(),he.value[W]=(he.value[W]||0)+1,Se.value[W]=!0,(((te=v.siteConfig)==null?void 0:te.commentSystem)||"waline")==="builtin"){window.dispatchEvent(new Event(`refresh-comments-${W}`));const Ye=document.querySelector(`.content-container[data-msg-id="${W}"] .builtin-comments`);if(Ye){Ye.scrollIntoView({behavior:"smooth",block:"center"});const Ze=Ye.querySelector("textarea");(je=Ze==null?void 0:Ze.focus)==null||je.call(Ze)}return}if(z.value){if(await yn(),!window.Waline)return;document.querySelector(`#waline-${W}`)?window.Waline.init({el:`#waline-${W}`,serverURL:v.siteConfig.walineServerURL,path:`messages/${W}`,reaction:!1,meta:["nick","mail","link"],requiredMeta:["mail","nick"],pageview:!0,search:!1,wordLimit:200,pageSize:5,avatar:"monsterid",emoji:["https://unpkg.com/@waline/emojis@1.2.0/tieba"],imageUploader:!1,copyright:!1,dark:'html[class="dark"]'}):console.error(`评论容器 #waline-${W} 未找到`)}},ce=(W,q)=>{if(q&&q.empty===!0){Ce(W);return}X.value===W&&(X.value=null),he.value[W]=(he.value[W]||0)+1},ne=W=>{if(!le.value)return!1;const q=B.user;if(!q)return!1;const ee=!!(q.IsAdmin||q.is_admin),te=(q.ID||q.userid)===W.user_id;return ee||te},Ve=W=>{if(!le.value)return!1;const q=B.user;if(!q)return!1;const ee=!!(q.IsAdmin||q.is_admin),te=(q.ID||q.userid)===W.user_id;return ee||te},pe=G([]),ct=async W=>{try{const q=!W.pinned;await j.setPinned(W.id,q)&&(q?pe.value.some(te=>te.id===W.id)||(pe.value=[W,...pe.value]):pe.value=pe.value.filter(te=>te.id!==W.id),We().add({title:q?"已置顶":"已取消置顶",color:"green",timeout:1500}))}catch{We().add({title:"操作失败",color:"red",timeout:2e3})}},Je=async W=>{try{const q=!W.private;await j.setPrivate(W.id,q)&&We().add({title:q?"已设为私密":"已设为公开",color:"green",timeout:1500})}catch{We().add({title:"操作失败",color:"red",timeout:2e3})}},ot=W=>{const q=new Date(W),te=new Date().getTime()-q.getTime(),je=Math.floor(te/(1e3*60*60*24)),Ye=Math.floor(te/(1e3*60*60)),Ze=Math.floor(te/(1e3*60));return Math.floor(te/1e3)<60?"刚刚":Ze<60?`${Ze}分钟前`:Ye<24?`${Ye}小时前`:je<3?`${je}天前`:q.toLocaleString()},_e=G({}),tt=G({}),kt=G({}),wt=W=>{_e.value[W]=!_e.value[W]},nt=()=>{vt(()=>{(Bt.value?bt.value:j.messages).forEach(q=>{const ee=document.querySelector(`.content-container[data-msg-id="${q.id}"] .overflow-y-hidden`);if(!ee)return;const te=!!document.querySelector(`.content-container[data-msg-id="${q.id}"] .image-grid`);if(kt.value[q.id]=te,te){tt.value[q.id]=!1,_e.value[q.id]=!0;return}ee.scrollHeight>700?(tt.value[q.id]=!0,_e.value[q.id]===void 0&&(_e.value[q.id]=!1)):tt.value[q.id]=!1})})};xt(()=>j.messages,()=>{Yt.hash.includes("/messages/")||vt(()=>{requestAnimationFrame(()=>{nt(),Q()})})},{deep:!0});const Yt=ps(),yn=async()=>{if(z.value&&!window.Waline){const W=document.createElement("link");W.rel="stylesheet",W.href="https://unpkg.com/@waline/client@v2/dist/waline.css",document.head.appendChild(W),await new Promise((q,ee)=>{const te=document.createElement("script");te.src="https://unpkg.com/@waline/client@v2/dist/waline.js",te.crossOrigin="anonymous",te.onload=q,te.onerror=ee,document.head.appendChild(te)})}};Ht(async()=>{try{await U(),await et();const W=Yt.hash.split("/messages/").pop();if(await yn(),W){const q=await fetch(`${H}/messages/${W}`,{credentials:"include",headers:{Accept:"application/json"}});if(!q.ok)throw new Error("消息加载失败");const ee=await q.json();if(ee.code===1&&ee.data){const te=ee.data;Ie(te)?j.messages=[]:j.messages=[te],j.hasMore=!1,j.page=1,await vt();const je=document.querySelector(`.content-container[data-msg-id="${W}"]`);je&&je.scrollIntoView({behavior:"instant",block:"start"})}else throw new Error("消息不存在")}else if(!Yt.hash.includes("/messages/")){const q=await fetch(`${H}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:1,pageSize:15})});if(q.ok){const ee=await q.json();if(ee.code===1&&ee.data){const te=(ee.data.items||[]).filter(yt=>!Ie(yt));j.messages=te;const Ye=(ee.data.total||0)-(Pe.value?1:0);j.total=Math.max(0,Ye);const Ze=Math.max(1,Math.ceil((j.total||0)/15));j.page=1,j.hasMore=j.page<Ze}}}await vt(),nt(),Q();try{const q=(j.messages||[]).filter(ee=>!Ie(ee)).map(async ee=>{try{let te=null;const je=await fetch(`${H}/messages/${ee.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(je&&je.ok)te=await je.json();else{const Ze=await fetch(`http://localhost:1315/api/messages/${ee.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});Ze&&Ze.ok&&(te=await Ze.json())}const Ye=te&&Array.isArray(te.data)?te.data.length:0;w.value[ee.id]=Ye,Le.value&&Ye>0&&(Se.value[ee.id]=!0)}catch{}});await Promise.allSettled(q),await vt()}catch{}}catch(W){console.error("初始化失败:",W),W instanceof Error&&We().add({title:"加载失败",description:W.message||"请刷新重试",color:"red",timeout:2e3})}}),xt(()=>Yt.hash,async W=>{const q=W.split("/messages/").pop();if(!q){if(!Yt.hash.includes("/messages/")){const ee=await fetch(`${H}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:1,pageSize:15})});if(ee.ok){const te=await ee.json();if(te.code===1&&te.data){const je=(te.data.items||[]).filter(ve=>!Ie(ve));j.messages=je;const Ze=(te.data.total||0)-(Pe.value?1:0);j.total=Math.max(0,Ze);const yt=Math.max(1,Math.ceil((j.total||0)/15));j.page=1,j.hasMore=j.page<yt,Se.value={};try{const ve=(j.messages||[]).filter(Tt=>!Ie(Tt)).map(async Tt=>{try{const Et=await fetch(`${H}/messages/${Tt.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(Et.ok){const it=await Et.json(),dt=Array.isArray(it.data)?it.data.length:0;w.value[Tt.id]=dt,Le.value&&dt>0&&(Se.value[Tt.id]=!0)}}catch{}});await Promise.allSettled(ve)}catch{}}}}return}try{const ee=await fetch(`${H}/messages/${q}`,{credentials:"include",headers:{Accept:"application/json"}});if(!ee.ok)throw new Error("消息加载失败");const te=await ee.json();if(te.code===1&&te.data){j.messages=Ie(te.data)?[]:[te.data],j.hasMore=!1,j.page=1,await vt();const je=document.querySelector(`.content-container[data-msg-id="${q}"]`);je&&je.scrollIntoView({behavior:"instant",block:"start"})}}catch(ee){console.error("加载消息失败:",ee),We().add({title:"加载失败",color:"red",timeout:2e3})}},{immediate:!0});const Pt=G(!1),an=async()=>{if(!(Pt.value||j.page<=1)){Pt.value=!0;try{const W=document.querySelector(".content-wrapper"),q=W?W.scrollTop:window.scrollY,ee=j.page-1,te=await j.getMessages({page:ee,pageSize:15});if(te&&Array.isArray(te.items)){const je=te.items.filter(ve=>!ve.pinned&&!Ie(ve));j.messages=[...pe.value,...je];const Ze=(te.total||j.total||0)-(Pe.value?1:0);j.total=Math.max(0,Ze),j.page=te.page||ee;const yt=Math.max(1,Math.ceil((j.total||0)/15));j.hasMore=j.page<yt}else j.page=ee;await vt(),W?W.scrollTo({top:q,behavior:"instant"}):window.scrollTo({top:q,behavior:"instant"})}catch{We().add({title:"加载失败",color:"red",timeout:2e3})}finally{Pt.value=!1}}},ht=async()=>{if(!(Pt.value||!j.hasMore)){Pt.value=!0;try{const W=document.querySelector(".content-wrapper"),q=W?W.scrollTop:window.scrollY,ee=j.page+1,te=await j.getMessages({page:ee,pageSize:15});if(te&&Array.isArray(te.items)){const je=te.items.filter(ve=>!ve.pinned&&!Ie(ve));j.messages=[...pe.value,...je];const Ze=(te.total||j.total||0)-(Pe.value?1:0);j.total=Math.max(0,Ze),j.page=te.page||ee;const yt=Math.max(1,Math.ceil((j.total||0)/15));j.hasMore=j.page<yt}else j.page=ee;await vt(),W?W.scrollTo({top:q,behavior:"instant"}):window.scrollTo({top:q,behavior:"instant"})}catch{We().add({title:"加载失败",color:"red",timeout:2e3})}finally{Pt.value=!1}}};xt(()=>B.isLogin,W=>{W&&j.getMessages({page:1,pageSize:15})}),xt(()=>j.messages,async()=>{try{if(j.page===1){const q=(j.messages||[]).filter(ee=>ee.pinned&&!Ie(ee)).filter((ee,te,je)=>je.findIndex(Ye=>Ye.id===ee.id)===te);pe.value=q}try{const q=(j.messages||[]).filter(ee=>!Ie(ee)).map(async ee=>{try{const te=await fetch(`${H}/messages/${ee.id}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(te.ok){const je=await te.json(),Ye=Array.isArray(je.data)?je.data.length:0;w.value[ee.id]=Ye}}catch{}});await Promise.allSettled(q)}catch{}await vt(),nt(),Q()}catch(W){console.error("更新视图失败:",W)}},{deep:!0}),ji(()=>{window.Fancybox&&window.Fancybox.destroy()});const In=async W=>{try{await navigator.clipboard.writeText(W),We().add({title:"复制成功",color:"green",timeout:2e3})}catch(q){console.error("复制失败:",q),We().add({title:"复制失败",color:"red",timeout:2e3})}},on=G(!1),Vt=G(""),Gt=G(null),sn=G(!1),fn=W=>{if(Gt.value=W.id,Vt.value=W.content,W.image_url){const q=`

<!-- 附件图片(编辑时可删除) -->
![附件图片](${H}${W.image_url})
<!-- 附件图片结束 -->`;Vt.value+=q}on.value=!0},Wn=async()=>{if(Gt.value){sn.value=!0;try{const W=j.messages.find(je=>je.id===Gt.value);if(!W)return;let q=Vt.value;if(q=q.replace(/\n*<!-- 附件图片\(编辑时可删除\) -->\n!\[附件图片\]\(.*?\)\n<!-- 附件图片结束 -->\n*/g,""),q===W.content){We().add({title:"内容未修改",description:"请修改内容后再保存",color:"orange",timeout:2e3}),sn.value=!1;return}const ee=await fetch(`${H}/messages/${Gt.value}`,{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({content:q,image_url:W.image_url})});if(!ee.ok)throw new Error(`HTTP error! status: ${ee.status}`);const te=await ee.json();if(te.code===1){const je=j.messages.findIndex(Ye=>Ye.id===Gt.value);je!==-1&&(j.messages[je]={...j.messages[je],content:Vt.value,image_url:W.image_url}),on.value=!1,We().add({title:"更新成功",color:"green",timeout:2e3})}else throw new Error(te.msg||"保存失败")}catch(W){console.error("更新消息失败:",W),We().add({title:"更新失败",color:"red",timeout:2e3})}finally{sn.value=!1}}},hn=async W=>{var q,ee;try{const te=document.querySelector(`.content-container[data-msg-id="${W}"]`);if(!te)return;const je=(ee=(q=te.querySelector(".markdown-preview"))==null?void 0:q.textContent)==null?void 0:ee.trim(),Ye=te.querySelector("img"),Ze=te.querySelector("video"),yt=te.querySelector("audio");if(!je&&!Ye&&Ze||!je&&!Ye&&yt){We().add({title:"此内容不可生成卡片",color:"orange",timeout:2e3});return}const ve=setTimeout(()=>{We().add({title:"生成超时",description:"卡片生成时间过长，请稍后重试",color:"red",timeout:3e3})},1e4),Tt=_e.value[W];_e.value[W]=!0,await vt();const Et=document.createElement("div");Et.style.cssText=`
  padding: 16px;
  background: transparent;
  border-radius: 12px;
  width: ${Ye?"640px":"480px"};
  position: absolute;
  left: -9999px;
  top: 0;
  z-index: -1;
  overflow: visible;
  min-height: fit-content;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.1);
  border: none;
`,document.body.appendChild(Et);const it=te.cloneNode(!0),dt=window.getComputedStyle(te),Hn=dt.backgroundColor&&dt.backgroundColor!=="rgba(0, 0, 0, 0)"?dt.backgroundColor:"#ffffff",wn=dt.color||"#333";it.querySelectorAll('.text-center.mt-2, .bg-gradient-to-t, .expand-toggle-btn, .message-socialbar, .message-toolbox, .toolbox-anchor, .tool-open-btn, .builtin-comments, [id^="comment-container-"], [id^="waline-"]').forEach(at=>at.remove()),it.querySelectorAll(".i-mdi-pin, .i-mdi-pin-outline").forEach(at=>{const F=at.parentElement;F&&F.classList.contains("opacity-80")?F.remove():at.remove()}),it.querySelectorAll(".author-row .ml-auto").forEach(at=>at.remove()),it.style.cssText=`
      max-height: none;
      overflow: visible;
      padding: 0;
      margin: 0;
      background: ${Hn};
      border-radius: 12px;
    `;const jt=it.querySelector(".overflow-y-hidden");jt&&(jt.className="",jt.style.cssText=`
        overflow: visible;
        max-height: none !important;
        height: auto !important;
        padding: 4px 12px;
        line-height: 1.6;
        margin-top: 0;
        margin-bottom: 0;
        white-space: pre-wrap;
        background: ${Hn};
        border-radius: 12px;
        font-size: 14px;
        color: ${wn};
      `);const $t=Array.from(it.children).find(at=>at.tagName==="IMG");$t&&($t.style.margin="1px 0",$t.style.display="block"),it.querySelectorAll("img").forEach(at=>{at.style.margin="1px 0",at.style.display="block"});const kn=it.querySelector(".border-t");kn&&(kn.style.margin="1px 0");const En=it.querySelector(".markdown-preview");if(En){En.style.marginTop="1px";const at=En.firstElementChild;at&&(at.style.marginTop="1px"),En.querySelectorAll("p, h1, h2, h3, h4, h5, h6").forEach(F=>{F.style.marginTop=F.style.marginTop||"2px"})}it.querySelectorAll("video, audio, iframe").forEach(at=>{var J;const F=document.createElement("div");F.style.cssText=`
        padding: 15px;
        background: rgba(251, 146, 60, 0.1);
        border: 1px solid rgba(251, 146, 60, 0.3);
        border-radius: 8px;
        color: #fb923c;
        margin: 15px 0;
        word-break: break-all;
      `,at instanceof HTMLVideoElement?F.innerHTML=`🎬 视频链接：${at.src||"未知链接"}`:at instanceof HTMLAudioElement?F.innerHTML=`🎵 音频链接：${at.src||"未知链接"}`:at instanceof HTMLIFrameElement&&(F.innerHTML=`🔗 嵌入内容链接：${at.src||"未知链接"}`),(J=at.parentNode)==null||J.replaceChild(F,at)}),await(async()=>{const at=it.querySelectorAll("img");await Promise.all(Array.from(at).map(async F=>new Promise(J=>{const xe=F.src;F.crossOrigin="anonymous",xe.startsWith("/")?(F.src=`${H}${xe}`,fetch(F.src,{credentials:"include"}).then(De=>De.blob()).then(De=>{F.src=URL.createObjectURL(De),J()}).catch(()=>{var De;console.error("图片加载失败:",xe),(De=F.parentElement)==null||De.removeChild(F),J()})):F.complete?J():(F.onload=()=>J(),F.onerror=()=>{var De;console.error("图片加载失败:",xe),(De=F.parentElement)==null||De.removeChild(F),J()})})))})(),Et.appendChild(it);const Nn=document.createElement("div");Nn.style.cssText=`
    margin-top: 12px;
    padding-top: 12px;
    text-align: center;
    font-family: -apple-system, BlinkMacSystemFont, sans-serif;
    background: transparent;
  `,Nn.innerHTML=`
    <div style="color: #fb923c; font-size: 13px; margin-bottom: 4px; font-weight: 500;">
      ${v.siteConfig.cardFooterTitle}
    </div>
    <a href="https://note.noisework.cn" 
       target="_blank" 
       rel="noopener noreferrer" 
       style="color: rgba(255,255,255,0.5); text-decoration: none;">
      ${v.siteConfig.cardFooterSubtitle}
    </a>
  `,Et.appendChild(Nn),await vt();const Dt=await html2canvas(Et,{backgroundColor:Hn,scale:2,useCORS:!0,allowTaint:!0,logging:!1,width:Et.offsetWidth,height:Et.scrollHeight,borderRadius:"16px",onclone:at=>{const F=at.querySelector(".content-container");F&&(F.style.cssText=`
            overflow: visible !important;
            max-height: none !important;
            height: auto !important;
            padding: 0;
            min-height: ${(jt==null?void 0:jt.scrollHeight)||0}px;
            background: ${Hn};
            border-radius: 12px;
          `)}});clearTimeout(ve);const cn=document.createElement("a");cn.download=`message-${W}.png`,cn.href=Dt.toDataURL("image/png"),cn.click(),document.body.removeChild(Et),_e.value[W]=Tt,We().add({title:"下载成功",color:"green",timeout:2e3})}catch(te){console.error("下载失败:",te),We().add({title:"下载失败",color:"red",timeout:2e3})}},Bt=G(!1),bt=G([]),Nt=async W=>{var q;try{const ee=Bt.value?null:window.scrollY;if(console.debug("API返回的原始数据:",W),!W)throw new Error("API返回数据为空");let te=[],je=0;if(W.code===1?Array.isArray(W.data)?te=W.data:(q=W.data)!=null&&q.items&&(te=W.data.items):Array.isArray(W)&&(te=W),!Array.isArray(te))throw new Error("无效的数据格式");te=te.filter(Ye=>!Ie(Ye)),je=te.length,Bt.value=!0,bt.value=te,je===0?We().add({title:"未找到相关内容",color:"orange",timeout:2e3}):We().add({title:`找到 ${je} 条结果`,color:"green",timeout:2e3}),ee!==null&&window.scrollTo({top:0,behavior:"smooth"}),await vt(),nt(),Q()}catch(ee){console.error("处理搜索结果时出错:",ee),We().add({title:"搜索失败",description:ee.message||"处理搜索结果时发生错误",color:"red",timeout:2e3}),Ut()}},Ut=()=>{bt.value=[],Bt.value=!1,console.log("重置搜索 - searchResults:",bt.value),console.log("重置搜索 - isSearchMode:",Bt.value),vt(()=>{nt(),Q()})},Qt=ge(()=>{if(Bt.value&&Array.isArray(bt.value))return(bt.value||[]).filter(ee=>!Ie(ee));const W=(j.messages||[]).filter(ee=>!Ie(ee));if(!pe.value.length)return W;const q=W.filter(ee=>!pe.value.some(te=>te.id===ee.id));return[...pe.value,...q]});e({handleSearchResult:Nt}),xt(bt,W=>{console.log("searchResults变化:",W),vt(()=>{nt(),Q()})},{deep:!0,immediate:!0}),xt(Bt,W=>{console.log("isSearchMode变化:",W),vt(()=>{nt(),Q()})});const se=W=>{try{const q=(W==null?void 0:W.detail)||{},ee=Number((q==null?void 0:q.messageId)||0),te=Number((q==null?void 0:q.count)||0);ee&&(w.value[ee]=te)}catch{}};return Ht(()=>{try{window.addEventListener("comment-count-updated",se)}catch{}}),ji(()=>{try{window.removeEventListener("comment-count-updated",se)}catch{}}),ge(()=>({cardFooterTitle:v.siteConfig.cardFooterTitle,cardFooterSubtitle:v.siteConfig.cardFooterSubtitle,pageFooterHTML:v.siteConfig.pageFooterHTML,walineServerURL:v.siteConfig.walineServerURL})),(W,q)=>{const ee=di,te=Ir,je=ma,Ye=gs,Ze=pa,yt=ga;return Z(),oe(It,null,[I("div",th,[we(Qt).length?Oe("",!0):(Z(),oe("div",nh,[ie(ee,{name:"i-heroicons-inbox",class:"w-12 h-12 mx-auto mb-4"}),q[5]||(q[5]=I("p",null,"暂无消息内容",-1))])),I("div",{class:ke(we(D))},[we(Bt)?(Z(),oe("div",ih,[I("p",rh,"搜索结果 ("+Fe(we(bt).length)+" 条)",1),ie(te,{size:"sm",variant:"ghost",class:"text-gray-400 hover:text-orange-500",icon:"i-heroicons-arrow-left",onClick:Re},{default:Me(()=>q[6]||(q[6]=[mt(" 返回完整列表 ")])),_:1})])):Oe("",!0),I("div",ah,[we(Bt)&&we(bt).length===0?(Z(),oe("div",oh,[ie(ee,{name:"i-heroicons-magnifying-glass",class:"w-12 h-12 mx-auto mb-4"}),q[7]||(q[7]=I("p",null,"未找到相关内容",-1))])):Oe("",!0),(Z(!0),oe(It,null,Jt(we(Qt),ve=>{var Tt;return Z(),oe("div",{key:ve.id,class:"w-full h-auto overflow-hidden flex flex-col justify-between"},[I("div",sh,[ve.image_url||ve.content?(Z(),oe("div",{key:0,class:ke(["content-container",we(N),we(s)]),"data-msg-id":ve.id},[I("div",ch,[I("img",{src:m(ve),alt:"avatar",class:"avatar-img w-8 h-8 rounded-full object-cover",onError:Et=>u(Et,ve.username||"匿名")},null,40,uh),I("div",dh,[I("div",fh,Fe(ve.username||p.siteConfig.username||"匿名"),1),I("div",hh,Fe(ot(ve.created_at)),1)]),I("div",ph,[ve.private?(Z(),Lt(ee,{key:0,name:"i-mdi-lock-outline",class:"w-4 h-4"})):Oe("",!0),ve.pinned?(Z(),Lt(ee,{key:1,name:"i-mdi-pin",class:"w-4 h-4"})):Oe("",!0)])]),ve.image_url?(Z(),oe("a",{key:0,href:`${we(H)}${ve.image_url}`,"data-fancybox":`message-image-${ve.id}`,class:"block"},[I("img",{src:`${we(H)}${ve.image_url}`,alt:"Image",class:"message-image-box",loading:"lazy",fetchpriority:W.index<3?"high":"low"},null,8,gh)],8,mh)):Oe("",!0),ve.image_url&&ve.content?(Z(),oe("div",vh)):Oe("",!0),I("div",{class:ke(["overflow-y-hidden relative",[{"max-h-[700px]":!we(_e)[ve.id]&&!we(kt)[ve.id]},we(l)]])},[ie(yi,{content:ve.content,enableGithubCard:((Tt=p.siteConfig)==null?void 0:Tt.enableGithubCard)===!0,onTagClick:re,onRendered:nt,"link-target":"_blank"},null,8,["content","enableGithubCard"]),we(tt)[ve.id]&&!we(_e)[ve.id]?(Z(),oe("div",{key:0,class:ke(["absolute bottom-0 left-0 right-0 h-24 bg-gradient-to-t backdrop-blur-md pointer-events-none content-fade-mask",we(d)]),style:{"z-index":"20"}},null,2)):Oe("",!0)],2),we(tt)[ve.id]?(Z(),oe("button",{key:2,class:ke(["expand-toggle-btn absolute bottom-0 left-1/2 -translate-x-1/2 px-4 py-1.5 text-sm inline-flex items-center gap-1 z-30",we(g)]),onClick:Et=>wt(ve.id),"aria-label":"toggle-expand"},[mt(Fe(we(_e)[ve.id]?"收起全文":"展开全文")+" ",1),ie(ee,{name:we(_e)[ve.id]?"i-heroicons-chevron-up":"i-heroicons-chevron-down",class:"w-4 h-4"},null,8,["name"])],10,bh)):Oe("",!0),q[9]||(q[9]=I("div",{class:"border-t border-gray-300 dark:border-gray-700 my-3"},null,-1)),I("div",yh,[I("button",{class:"social-item",onClick:Et=>C(ve.id),title:"点赞"},[ie(ee,{name:we(E)[ve.id]?"i-mdi-heart":"i-mdi-heart-outline",style:{"font-size":"20px","line-height":"1"},class:ke([we(E)[ve.id]?"text-red-500":""])},null,8,["name","class"]),I("span",kh,Fe(we(y)[ve.id]??(ve.like_count||0)),1)],8,wh),Ie(ve)?Oe("",!0):(Z(),oe("button",{key:0,class:"social-item",onClick:Et=>Ce(ve.id),title:"评论"},[ie(ee,{name:"i-mdi-comment-outline",style:{"font-size":"20px","line-height":"1"}}),I("span",xh,Fe(we(w)[ve.id]||0),1)],8,Eh)),q[8]||(q[8]=I("div",{class:"flex-1"},null,-1)),I("div",Sh,[ie(te,{size:"xs",color:"gray",variant:"ghost",ui:{base:"rounded-full"},class:"tool-open-btn",onClick:Et=>h(ve.id),title:"展开工具"},{default:Me(()=>[ie(ee,{name:"i-heroicons-ellipsis-horizontal",style:{"font-size":"16px","line-height":"1"}})]),_:2},1032,["onClick"]),Ri(I("div",{class:ke(["message-toolbox overlay",we(b)])},[I("div",Ch,[Ve(ve)?(Z(),oe("div",{key:0,class:"tool-icon",onClick:Et=>Je(ve),title:ve.private?"设为公开":"设为私密"},[ie(ee,{name:ve.private?"i-mdi-lock-outline":"i-mdi-lock-open-outline"},null,8,["name"])],8,_h)):ve.private?(Z(),oe("div",Th,[ie(ee,{name:"i-mdi-lock-outline"})])):Oe("",!0),ne(ve)?(Z(),oe("div",{key:2,class:"tool-icon",onClick:Et=>ct(ve),title:ve.pinned?"取消置顶":"置顶内容"},[ie(ee,{name:ve.pinned?"i-mdi-pin":"i-mdi-pin-outline"},null,8,["name"])],8,Mh)):Oe("",!0),we(le)?(Z(),oe("div",{key:3,class:"tool-icon",onClick:Et=>fn(ve),title:"编辑"},[ie(ee,{name:"i-mdi-pencil-outline"})],8,Ah)):Oe("",!0),I("div",{class:"tool-icon",onClick:Et=>In(ve.content),title:"复制"},[ie(ee,{name:"i-mdi-content-copy"})],8,Lh),I("div",{class:"tool-icon",onClick:Et=>hn(ve.id),title:"下载卡片"},[ie(ee,{name:"i-mdi-image-outline"})],8,Dh),we(le)?(Z(),oe("div",{key:4,class:"tool-icon",onClick:Et=>Ge(ve.id),title:"删除"},[ie(ee,{name:"i-mdi-trash-can-outline"})],8,Oh)):Oe("",!0)])],2),[[ms,we(k)===ve.id]])])]),(we(Se)[ve.id]||we(X)===ve.id)&&we(Ue)&&!Ie(ve)?(Z(),oe("div",{key:3,id:`comment-container-${ve.id}`,class:"mt-2",style:{position:"relative"}},[we(Le)&&we(Y)?(Z(),Lt(Zs,{key:we(he)[ve.id]||0,"message-id":ve.id,"site-config":p.siteConfig,"show-input":we(X)===ve.id,onCancel:Et=>ce(ve.id,Et)},null,8,["message-id","site-config","show-input","onCancel"])):we(z)&&we(Y)?(Z(),oe("div",{key:1,id:`waline-${ve.id}`},null,8,Rh)):Oe("",!0)],8,Ph)):Oe("",!0)],10,lh)):Oe("",!0)])])}),128))]),we(Bt)?Oe("",!0):(Z(),oe("div",Ih,[I("div",Hh,[we(j).page>1?(Z(),Lt(te,{key:0,color:"gray",variant:"ghost",size:"xs",class:ke(["rounded-full px-4 py-1.5 shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",we(x)]),onClick:an,disabled:we(Pt)},{default:Me(()=>[ie(ee,{name:"i-heroicons-arrow-left",class:"mr-1 w-4 h-4"}),q[10]||(q[10]=mt(" 上一页 "))]),_:1},8,["class","disabled"])):Oe("",!0),we(j).hasMore?(Z(),Lt(te,{key:1,color:"gray",variant:"ghost",size:"xs",class:ke(["rounded-full px-4 py-1.5 shadow-lg hover:shadow-xl transition-all duration-300 backdrop-blur-sm",we(x)]),onClick:ht,disabled:we(Pt)},{default:Me(()=>[q[11]||(q[11]=mt(" 下一页 ")),ie(ee,{name:"i-heroicons-arrow-right",class:"ml-1 w-4 h-4"})]),_:1},8,["class","disabled"])):Oe("",!0),we(Pt)?(Z(),oe("span",Nh,"加载中...")):Oe("",!0)]),I("div",jh,[I("span",$h,"第 "+Fe(we(j).page)+" 页",1),ie(je,{modelValue:we(_),"onUpdate:modelValue":q[0]||(q[0]=ve=>xa(_)?_.value=ve:null),type:"number",min:"1",max:we(T),class:"w-12 text-center text-sm",placeholder:"#",onKeyup:hs(M,["enter"])},null,8,["modelValue","max"]),ie(te,{size:"xs",color:"gray",variant:"ghost",class:"text-gray-400 hover:text-orange-500 text-sm",onClick:M},{default:Me(()=>q[12]||(q[12]=[mt(" 跳转 ")])),_:1})])])),!we(Bt)&&we(j).messages.length>0&&!we(j).hasMore?(Z(),oe("div",Bh,[ie(ee,{name:"i-fluent-emoji-flat-confetti-ball",size:"lg"}),q[13]||(q[13]=mt(" 加载完毕~ "))])):Oe("",!0)],2)]),ie(yt,{modelValue:we(on),"onUpdate:modelValue":q[4]||(q[4]=ve=>xa(on)?on.value=ve:null),ui:{width:"sm:max-w-2xl"}},{default:Me(()=>[ie(Ze,null,{header:Me(()=>[I("div",Uh,[q[14]||(q[14]=I("h3",{class:"text-lg font-medium"},"编辑内容",-1)),ie(te,{color:"gray",variant:"ghost",icon:"i-mdi-close",class:"-my-1",onClick:q[1]||(q[1]=ve=>on.value=!1)})])]),footer:Me(()=>[I("div",Wh,[ie(te,{color:"gray",variant:"outline",onClick:q[3]||(q[3]=ve=>on.value=!1),class:"text-white"},{default:Me(()=>q[16]||(q[16]=[mt(" 取消 ")])),_:1}),ie(te,{color:"orange",onClick:Wn,loading:we(sn),class:"text-white"},{default:Me(()=>q[17]||(q[17]=[mt(" 保存 ")])),_:1},8,["loading"])])]),default:Me(()=>{var ve;return[I("div",zh,[ie(Ye,{modelValue:we(Vt),"onUpdate:modelValue":q[2]||(q[2]=Tt=>xa(Vt)?Vt.value=Tt:null),placeholder:"编辑内容...",rows:"10",class:"font-mono text-sm"},null,8,["modelValue"]),I("div",Fh,[q[15]||(q[15]=I("div",{class:"text-sm text-gray-500 mb-2"},"预览：",-1)),I("div",Vh,[I("div",qh,[ie(yi,{content:we(Vt),enableGithubCard:((ve=p.siteConfig)==null?void 0:ve.enableGithubCard)===!0},null,8,["content","enableGithubCard"])])])])])]}),_:1})]),_:1},8,["modelValue"])],64)}}}),Kh=Mn(Yh,[["__scopeId","data-v-11323442"]]),Gh={class:"calendar-wrapper"},Xh={class:"heatmap-grid"},Zh=["onMouseenter"],Jh=rn({__name:"heatmap",setup(p){const e=G([]),r=G([]),s=G(null),l=G({visible:!1,text:"",x:0,y:0}),d=$i("contentTheme",G("light")),m=ge(()=>String(d&&d.value!==void 0?d.value:d)==="dark");ge(()=>m.value?"text-white/70":"text-black/60"),ge(()=>{if(!e.value.length)return Array(12).fill("").map((D,N)=>`${N+1}月`);const C=e.value.map(D=>new Date(D.date)),_=new Date(Math.min(...C)),T=[];let M=new Date(_);M.setDate(1);let v=M.getFullYear();for(let D=0;D<12;D++){const N=M.getMonth(),z=M.getFullYear();z!==v||D===0?(T.push(`${z}年${N+1}月`),v=z):T.push(`${N+1}月`),M.setMonth(N+1)}return T});const u=C=>{const _=["#9be9a8","#40c463","#30a14e","#216e39","#0e4429"],T=["rgba(16, 185, 129, 0.28)","rgba(16, 185, 129, 0.45)","rgba(16, 185, 129, 0.62)","rgba(16, 185, 129, 0.80)","rgba(16, 185, 129, 0.98)"];return(m.value?T:_)[Math.min(Math.max(C-1,0),4)]||(m.value?"rgba(255,255,255,0.06)":"rgba(0,0,0,0.06)")},g=C=>C.count?u(C.level):m.value?"rgba(255, 255, 255, 0.10)":"#e5e7eb",x=async()=>{try{const _=await(await fetch("/api/messages/calendar")).json();_&&_.code===1&&_.data&&_.data.length>0?(e.value=_.data,E()):b()}catch(C){console.error("获取热力图数据失败:",C),b()}},k=(C,_)=>{var z;l.value.text=`${_.date} · ${_.count||0} 条`;const M=C.target.getBoundingClientRect(),v=(z=s.value)==null?void 0:z.getBoundingClientRect(),D=M.left-((v==null?void 0:v.left)||0)+M.width/2,N=M.top-((v==null?void 0:v.top)||0)-6;l.value.x=D,l.value.y=N,l.value.visible=!0},h=C=>{var N;const T=C.target.getBoundingClientRect(),M=(N=s.value)==null?void 0:N.getBoundingClientRect(),v=T.left-((M==null?void 0:M.left)||0)+T.width/2,D=T.top-((M==null?void 0:M.top)||0)-6;l.value.x=v,l.value.y=D},f=()=>{l.value.visible=!1},b=()=>{const C=new Date,_=new Date(C);_.setMonth(C.getMonth()-11),_.setDate(1);const T=[];let M=new Date(_);for(;M<=C;){const v=Math.random()>.7?Math.floor(Math.random()*10)+1:0;T.push({date:y(M),count:v}),M.setDate(M.getDate()+1)}e.value=T,E()},y=C=>{const _=C.getFullYear(),T=String(C.getMonth()+1).padStart(2,"0"),M=String(C.getDate()).padStart(2,"0");return`${_}-${T}-${M}`},E=()=>{if(!e.value.length)return;const C=e.value.map(z=>new Date(z.date)),_=new Date(Math.min(...C));new Date(Math.max(...C));const T=new Date(_);T.setDate(1);const M=new Date(T);M.setMonth(T.getMonth()+11),M.setDate(M.getDate()+(6-M.getDay()));const v=new Map;e.value.forEach(z=>{z&&z.date&&z.count!==void 0&&v.set(z.date,z.count)});const D=[];let N=new Date(T);for(N.setDate(N.getDate()-N.getDay());N<=M;){const z=[];for(let H=0;H<7;H++){const Y=y(N),U=v.get(Y)||0;z.push({date:Y,count:U,level:U?Math.min(Math.ceil(U/2),5):0}),N.setDate(N.getDate()+1)}D.push(z)}r.value=D},w=()=>{const C=new Date,_=new Date(C);_.setMonth(C.getMonth()-11),_.setDate(1);const T=new Date(_);T.setMonth(_.getMonth()+11),T.setDate(T.getDate()+(6-T.getDay()));const M=[];let v=new Date(_);for(v.setDate(v.getDate()-v.getDay());v<=T;){const D=[];for(let N=0;N<7;N++)D.push({date:y(v),count:0,level:0}),v.setDate(v.getDate()+1);M.push(D)}r.value=M};return Ht(()=>{w(),x()}),(C,_)=>(Z(),oe("div",Gh,[I("div",{class:ke(["calendar-container",m.value?"heatmap-dark":"heatmap-light"]),ref_key:"calendarContainer",ref:s},[I("div",Xh,[(Z(!0),oe(It,null,Jt(r.value,(T,M)=>(Z(),oe("div",{key:M,class:"heatmap-week"},[(Z(!0),oe(It,null,Jt(T,(v,D)=>(Z(),oe("div",{key:D,class:"heatmap-day",style:bi({backgroundColor:g(v)}),onMouseenter:N=>k(N,v),onMouseleave:f,onMousemove:h},null,44,Zh))),128))]))),128))]),l.value.visible?(Z(),oe("div",{key:0,class:ke(["heatmap-tooltip",m.value?"heatmap-tooltip-dark":"heatmap-tooltip-light"]),style:bi({left:l.value.x+"px",top:l.value.y+"px"})},Fe(l.value.text),7)):Oe("",!0)],2)]))}}),ss=Mn(Jh,[["__scopeId","data-v-d332f5cb"]]),Qh={class:"tags-container w-full"},ep={class:"relative"},tp={class:"tags-wrapper"},np={class:"tags-scroll"},ip=["onClick"],rp={class:"tag-count"},ap=rn({__name:"TagList",props:{tags:{type:Array,default:()=>[]}},emits:["tagClick","updateTags"],setup(p,{emit:e}){const r=e,s=G(!1),l=G(Date.now()),d=p,m=ge(()=>{const x=/[/?=&]/,k=/^(song|video|playlist)\?id=\d+$/,h=new Map;return d.tags.reduce((f,b)=>(h.has(b.name)||!x.test(b.name)&&!k.test(b.name)&&(h.set(b.name,!0),f.push(b)),f),[])},{}),u=x=>{r("tagClick",x)},g=async()=>{s.value||(s.value=!0,l.value=Date.now(),r("updateTags"),setTimeout(()=>{s.value=!1},1e3))};return(x,k)=>{const h=di;return Z(),oe("div",Qh,[I("div",ep,[I("div",tp,[I("div",np,[(Z(!0),oe(It,null,Jt(m.value,f=>(Z(),oe("span",{key:f.name+l.value,class:"tag-item",onClick:b=>u(f.name)},[mt(" #"+Fe(f.name)+" ",1),I("span",rp,"("+Fe(f.count)+")",1)],8,ip))),128))])]),I("div",{class:"absolute -right-1 top-1/2 -translate-y-1/2 p-2 cursor-pointer transition-all duration-200 hover:scale-110 z-10 refresh-toggle",onClick:g,title:"刷新标签"},[ie(h,{name:"i-mdi-refresh",class:ke(["w-5 h-5 refresh-icon",{"animate-spin":s.value}])},null,8,["class"])]),k[0]||(k[0]=I("div",{class:"scroll-fade"},null,-1))])])}}}),op=Mn(ap,[["__scopeId","data-v-0448707a"]]),sp={class:"announcement-container mx-auto w-full sm:max-w-2xl px-2"},lp={class:"announcement-wrapper"},cp=["title"],up={class:"marquee-item"},dp=60,fp=rn({__name:"AnnouncementBar",props:{text:{}},setup(p){const e=p,r=G(null),s=G(null),l=G(null),d=G(0),m=G(18),u=()=>{const g=l.value;if(!g)return;const x=g.scrollWidth,k=40;d.value=x+k,m.value=Math.max(Math.round(d.value/dp),12)};return Ht(()=>{vt(()=>{u(),window.addEventListener("resize",u)})}),li(()=>{window.removeEventListener("resize",u)}),xt(()=>e.text,()=>vt(u)),(g,x)=>{const k=di;return Z(),oe("div",sp,[I("div",lp,[ie(k,{name:"i-mdi-bell-outline",class:"w-4 h-4 mr-2 flex-shrink-0 text-orange-500"}),I("div",{class:"announcement-text",ref_key:"textContainer",ref:r,title:g.text},[I("div",{class:"marquee animate",ref_key:"marquee",ref:s,style:bi({"--distance":d.value+"px",animationDuration:m.value+"s"})},[I("div",{class:"marquee-item",ref_key:"firstItem",ref:l},[ie(yi,{content:g.text,enableGithubCard:!1},null,8,["content"])],512),I("div",up,[ie(yi,{content:g.text,enableGithubCard:!1},null,8,["content"])])],4)],8,cp)])])}}}),ls=Mn(fp,[["__scopeId","data-v-571a4c47"]]),hp=rn({__name:"FloatingToolSidebar",props:{contentTheme:{},layoutIcon:{}},setup(p){const e=p,r=ge(()=>e.contentTheme==="dark"),s=ge(()=>e.contentTheme==="dark"?"i-mdi-weather-night":"i-mdi-white-balance-sunny"),l=ge(()=>e.layoutIcon||"i-mdi-view-grid");return(d,m)=>{const u=di;return Z(),oe("div",{class:ke(["floating-sidebar",we(r)?"fs-dark":"fs-light"])},[I("button",{class:ke(["tool-btn btn-layout",we(r)?"btn-dark":"btn-light"]),onClick:m[0]||(m[0]=g=>d.$emit("toggle-layout")),"aria-label":"布局"},[ie(u,{name:we(l),class:"w-6 h-6"},null,8,["name"]),m[5]||(m[5]=I("span",{class:"btn-label"},"布局",-1))],2),I("button",{class:ke(["tool-btn",we(r)?"btn-dark":"btn-light"]),onClick:m[1]||(m[1]=g=>d.$emit("search")),"aria-label":"搜索"},[ie(u,{name:"i-heroicons-magnifying-glass",class:"w-6 h-6"}),m[6]||(m[6]=I("span",{class:"btn-label"},"搜索",-1))],2),I("button",{class:ke(["tool-btn",we(r)?"btn-dark":"btn-light"]),onClick:m[2]||(m[2]=g=>d.$emit("switch-background")),"aria-label":"背景"},[ie(u,{name:"i-mdi-image-outline",class:"w-6 h-6"}),m[7]||(m[7]=I("span",{class:"btn-label"},"背景",-1))],2),I("button",{class:ke(["tool-btn",we(r)?"btn-dark":"btn-light"]),onClick:m[3]||(m[3]=g=>d.$emit("toggle-theme")),"aria-label":"切换亮暗"},[ie(u,{name:we(s),class:"w-6 h-6"},null,8,["name"]),m[8]||(m[8]=I("span",{class:"btn-label"},"切换亮暗",-1))],2),I("a",{href:"/rss",target:"_blank",rel:"noopener noreferrer",class:ke(["tool-btn",we(r)?"btn-dark":"btn-light"]),"aria-label":"RSS"},[ie(u,{name:"i-mdi-rss",class:"w-6 h-6"}),m[9]||(m[9]=I("span",{class:"btn-label"},"RSS",-1))],2),I("button",{class:ke(["tool-btn",we(r)?"btn-dark":"btn-light"]),"aria-label":"后台",onClick:m[4]||(m[4]=g=>d.$emit("open-admin"))},[ie(u,{name:"i-mdi-server-outline",class:"w-6 h-6"}),m[10]||(m[10]=I("span",{class:"btn-label"},"后台",-1))],2)],2)}}}),pp=Mn(hp,[["__scopeId","data-v-e12f5ad6"]]),mp={key:0,class:"loading"},gp={key:0,class:"left-col"},vp={class:"profile-card"},bp={class:"avatar-wrap relative"},yp=["src","alt"],wp={class:"profile-name text-center"},kp={key:0,class:"mt-1"},Ep={class:"profile-desc"},xp={key:1,class:"auth-actions"},Sp={class:"p-0 grid grid-cols-3 gap-2 text-center text-sm"},Cp={class:"font-semibold"},_p={class:"font-semibold"},Tp={class:"font-semibold"},Mp={class:"social-list"},Ap=["href","data-label"],Lp=["src"],Dp={class:"p-0 text-center clock-card"},Op={class:"clock-display"},Pp={class:"clock-date"},Rp={key:0,class:"relative"},Ip=["href"],Hp=["src"],Np={class:"ad-overlay"},jp={key:0,class:"absolute bottom-2 left-0 right-0 flex justify-center gap-2"},$p=["onClick"],Bp={class:"hitokoto-container mx-auto w-full sm:max-w-2xl px-2"},Up=["title"],zp={key:3,class:"mt-2 space-y-3"},Fp={class:"scroll-tags mb-2"},Vp={class:"tag-grid"},qp=["onClick"],Wp={class:"ml-1 opacity-60"},Yp={class:"scroll-images"},Kp={class:"recommend-grid"},Gp=["href"],Xp=["src"],Zp={class:"scroll-list p-0"},Jp={class:"flex flex-wrap gap-2"},Qp=["src","data-mail","data-qq","onError"],em={class:"center-col"},tm={class:"moments-header"},nm={class:"header-title"},im={class:"hero-tabs"},rm=["onClick"],am={key:0,class:"links-page"},om={key:0,class:"section-subtitle"},sm={key:1,class:"mx-auto w-full max-w-3xl px-4 sm:px-6 mt-3 mb-3"},lm={class:"link-grid"},cm=["href"],um=["src"],dm={class:"link-content"},fm={class:"link-title"},hm={key:0,class:"text-xs opacity-75"},pm={key:2,class:"mt-2"},mm={class:"mt-4 mx-auto w-full max-w-2xl px-4 sm:px-6"},gm={class:"grid grid-cols-1 sm:grid-cols-2 gap-2"},vm={class:"flex justify-center mt-2"},bm={key:1,class:"comment-page"},ym={key:0,class:"section-subtitle"},wm={class:"max-w-3xl mx-auto"},km={key:1,class:"text-sm opacity-70"},Em={key:2,class:"about-page"},xm={key:0,class:"section-subtitle"},Sm={class:"mx-auto w-full max-w-3xl px-4 sm:px-6"},Cm={class:"mx-auto w-full sm:max-w-4xl mt-3"},_m=["innerHTML"],Tm={key:0,class:"right-col space-y-3"},Mm={class:"scroll-tags mb-2"},Am={class:"tag-grid"},Lm=["onClick"],Dm={class:"ml-1 opacity-60"},Om={class:"text-xs opacity-70 mb-2"},Pm={class:"scroll-images"},Rm={class:"recommend-grid"},Im=["href"],Hm=["src"],Nm={class:"scroll-list p-0"},jm={class:"flex flex-wrap gap-2"},$m=["src","data-mail","data-qq","onError"];const Bm=["data-playlist-id","data-song-id","data-position","data-theme","data-lyric","data-default-minimized","data-embed","data-autoplay"],Um={class:"flex justify-between items-center"},zm={class:"text-xl font-semibold"},Fm={class:"flex items-center gap-2"},Vm={class:"space-y-3"},qm={key:0},Wm={class:"space-y-3"},Ym={class:"flex items-center justify-between text-sm mt-2"},Km={key:0,class:"text-center text-sm opacity-80 mt-3"},Gm={key:1,class:"mt-2"},Xm={key:1},Zm={class:"space-y-3"},Jm={class:"flex items-center gap-2"},Qm=["src"],eg={class:"space-y-3"},tg={class:"flex justify-end gap-2"},Va="https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",ug=rn({__name:"index",setup(p){const e=Sc(),r=ps(),s=gn().public.baseApi||"/api",l=(()=>{if(typeof window>"u")return"three";const R=window.matchMedia("(max-width: 1024px)").matches,P=localStorage.getItem(R?"homeLayoutMobile":"homeLayoutDesktop");return P||(R?"single":"three")})(),d=G(l),m=typeof window<"u"?window.matchMedia("(max-width: 1024px)"):null,u=G(!!(m!=null&&m.matches)),g=()=>{u.value||(d.value=d.value==="three"?"two":d.value==="two"?"single":"three",typeof window<"u"&&localStorage.setItem("homeLayoutDesktop",d.value))},x=ge(()=>d.value==="three"?"grid-3":d.value==="two"?"grid-2":"grid-1"),k=ge(()=>d.value==="three"?"i-mdi-view-grid":d.value==="two"?"i-mdi-view-column":"i-mdi-view-stream"),h=ge(()=>d.value==="two"?"w-full max-w-none":d.value==="single"?"mx-auto w-full max-w-[640px] sm:max-w-3xl":"mx-auto w-full sm:max-w-4xl"),f=[{key:"latest",name:"最新"},{key:"links",name:"友链"},{key:"comment",name:"留言"},{key:"about",name:"关于"}],b=G("latest"),y=G(null),E=G(!1),w=G(!1),C=G("login"),_=_r({username:"",password:""}),T=_r({username:"",password:"",captcha:""}),M=G(!1),v=G(!1),D=G(!1),N=G(!1),z=G(""),H=G(0);let Y=null,U=null;const j=G(!1),X=_r({account:""}),he=G(0);let Se=null;const Ue=G(!0),Le=G(!1),Pe=async()=>{try{z.value=`${s}/captcha?ts=${Date.now()}`,Y=Date.now()+12e4,H.value=120,U&&clearInterval(U),U=er(()=>{const R=Math.max(0,Math.ceil(((Y||Date.now())-Date.now())/1e3));H.value=R,R<=0&&clearInterval(U)},1e3)}catch{H.value=0}},Ie=async()=>{var R;try{const V=await(await fetch(`${s}/frontend/config`,{credentials:"include"})).json();if(!!!((R=V==null?void 0:V.data)!=null&&R.allowRegistration)){We().add({title:"提示",description:"站点已关闭用户注册",color:"orange"});return}}catch{}C.value="register",Pe()},et=()=>{C.value="login"},rt=()=>{w.value=!1;const{login:R,...P}=r.query;e.replace({path:r.path,query:P})},B=async()=>{D.value=!0;try{if(await Zn().login({username:_.username,password:_.password})){We().add({title:"登录成功",color:"green"}),w.value=!1;const P=r.query.redirect||"/status";e.push(P)}}catch{We().add({title:"登录失败",color:"red"})}finally{D.value=!1}},le=async()=>{N.value=!0;try{if(!T.username||!T.password||!T.captcha)throw new Error("请完整填写用户名、密码与验证码");if((Y||0)<Date.now())throw new Error("验证码已过期，请刷新后再提交");const R=await fetch(`${s}/register`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(T)}),P=await R.json().catch(()=>({}));if(!R.ok||P.code!==1)throw new Error((P==null?void 0:P.msg)||"注册失败");We().add({title:"注册成功",color:"green"}),C.value="login"}catch(R){We().add({title:"注册失败",description:R.message||"请稍后重试",color:"red"}),Pe()}finally{N.value=!1}},re=async()=>{var P,V,ae;if(await Zn().checkLoginStatus())e.push("/status");else{C.value="login",w.value=!0;try{const Ee=await(await fetch(`${s}/frontend/config`,{credentials:"include"})).json();Le.value=!!((V=(P=Ee==null?void 0:Ee.data)==null?void 0:P.frontendSettings)!=null&&V.githubOAuthEnabled),Ue.value=!!((ae=Ee==null?void 0:Ee.data)!=null&&ae.smtpEnabled)}catch{}}};li(()=>{U&&clearInterval(U)}),xt(()=>r.query.login,R=>{R&&(C.value="login",w.value=!0)},{immediate:!0}),xt(w,R=>{if(!R&&r.query.login){const{login:P,...V}=r.query;e.replace({path:r.path,query:V})}});const Re=()=>{window.location.href=`${s}/oauth/github/login`},Ge=async()=>{try{const R=await fetch(`${s}/password/forgot`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({account:X.account})}),P=await R.json().catch(()=>({}));if(!R.ok||P.code!==1)throw new Error((P==null?void 0:P.msg)||"发送失败");We().add({title:(P==null?void 0:P.msg)||"已发送",description:"请查收重置邮件",color:"green"}),he.value=60,Se&&clearInterval(Se),Se=er(()=>{he.value>0?he.value--:clearInterval(Se)},1e3)}catch(R){We().add({title:"失败",description:R.message||"发送失败",color:"red"})}},Q=G(null),Ce=R=>{console.log("接收到搜索结果:",R),y.value&&y.value.handleSearchResult(R)},ce=G(null),ne=async()=>{var R;try{const V=await(await fetch((gn().public.baseApi||"/api")+"/guestbook/message",{method:"GET",headers:{Accept:"application/json"},credentials:"include"})).json().catch(()=>null),ae=(R=V==null?void 0:V.data)==null?void 0:R.id;ce.value=typeof ae=="number"?ae:null}catch{ce.value=null}};xt(()=>b.value,R=>{R==="comment"&&!ce.value&&ne()}),Ht(()=>{ne()});const Ve=Zn(),pe=ge(()=>!!Ve.isLogin),ct=ge(()=>{var V,ae;const R=((V=De.value)==null?void 0:V.users)||((ae=De.value)==null?void 0:ae.Users)||[];return(Array.isArray(R)?R.find(de=>!!((de==null?void 0:de.is_admin)??(de==null?void 0:de.IsAdmin))):null)||(Array.isArray(R)?R[0]:null)||null}),Je=ge(()=>{const R=Ve.user;if(R)return!!(R!=null&&R.is_admin||R!=null&&R.IsAdmin);const P=ct.value;return!!(P&&(P!=null&&P.is_admin||P!=null&&P.IsAdmin))}),ot=ge(()=>{var ae;const R=Ve.user,P=String((R==null?void 0:R.username)||(R==null?void 0:R.Username)||"").trim();return P||String(((ae=se.value)==null?void 0:ae.welcomeName)||"").trim()||"匿名"}),_e=ge(()=>{var de;const R=Ve.user,P=String((R==null?void 0:R.avatar_url)||(R==null?void 0:R.AvatarURL)||"").trim(),V=gn().public.baseApi||"/api";if(P)return P.startsWith("http")?P:`${V}${P}`;const ae=String(((de=se.value)==null?void 0:de.welcomeAvatarURL)||"").trim();return ae?ae.startsWith("http")?ae:`${V}${ae}`:Va}),tt=R=>{const P=R.target;P&&P.src!==Va&&(P.src=Va)},kt=ge(()=>{var ae;const R=Ve.user,P=String((R==null?void 0:R.description)||"").trim();return P||String(((ae=se.value)==null?void 0:ae.welcomeDescription)||"").trim()||"执迷不悟"}),wt=G(!0),nt=G(typeof window<"u"&&localStorage.getItem("contentTheme")||"light");ge(()=>nt.value==="dark"?"i-mdi-weather-night":"i-mdi-white-balance-sunny");const Yt=G(!1);Mr("showHeatmap",wt),Mr("contentTheme",nt),Mr("toggleContentTheme",()=>{nt.value=nt.value==="dark"?"light":"dark",typeof window<"u"&&(localStorage.setItem("contentTheme",nt.value),document.documentElement.classList.toggle("dark",nt.value==="dark"))}),xt(()=>nt.value,R=>{typeof window<"u"&&document.documentElement.classList.toggle("dark",R==="dark")},{immediate:!0});const yn=()=>{nt.value=nt.value==="dark"?"light":"dark",typeof window<"u"&&(localStorage.setItem("contentTheme",nt.value),document.documentElement.classList.toggle("dark",nt.value==="dark"))},Pt=G(null),an=()=>{const R=Pt.value;R?R.scrollTo({top:0,behavior:"smooth"}):window.scrollTo({top:0,behavior:"smooth"})},ht=()=>{const R=Pt.value;if(R)R.scrollTo({top:R.scrollHeight,behavior:"smooth"});else{const P=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);window.scrollTo({top:P,behavior:"smooth"})}},In=[],on=()=>{Array.from(document.querySelectorAll(".scroll-list, .scroll-images")).forEach(P=>{let V=0,ae=performance.now(),de=0;const Ee=P.classList.contains("scroll-list")?.25:.35,Qe=1200,Mt=Ft=>{V=requestAnimationFrame(Mt);const Bn=Ft-ae;ae=Ft,!(de&&Ft<de)&&(P.scrollTop+=Ee*Bn/16,P.scrollTop>=P.scrollHeight-P.clientHeight-1&&(P.scrollTop=0,de=Ft+Qe))};V=requestAnimationFrame(Mt),In.push(()=>cancelAnimationFrame(V))})},Vt=G(!1),Gt=G(!0),sn=G(!1),fn=()=>{const R=Pt.value;if(!R){const ae=window.scrollY||document.documentElement.scrollTop||0,de=Math.max(document.body.scrollHeight,document.documentElement.scrollHeight);Gt.value=ae<=2,sn.value=window.innerHeight+ae>=de-2;return}const P=R.scrollTop,V=R.scrollHeight;Gt.value=P<=2,sn.value=R.clientHeight+P>=V-2};Ht(()=>{var R;fn(),(R=Pt.value)==null||R.addEventListener("scroll",fn,{passive:!0}),Yt.value&&vt(()=>on())}),li(()=>{var R;(R=Pt.value)==null||R.removeEventListener("scroll",fn),In.forEach(P=>P())});const Wn=ge(()=>Gt.value||sn.value||Vt.value),hn=ge(()=>sn.value&&!Gt.value?"i-heroicons-arrow-up":"i-heroicons-arrow-down"),Bt=()=>{sn.value&&!Gt.value?an():ht()},bt=ge(()=>nt.value==="dark"),Nt=ge(()=>bt.value?"bg-[rgba(36,43,50,0.95)] text-white border border-white/20":"bg-white text-black border border-black/10"),Ut=ge(()=>bt.value?"scroll-button bg-[rgba(36,43,50,0.85)] hover:bg-[rgba(36,43,50,0.95)] text-white shadow-[0_6px_16px_rgba(0,0,0,0.35)]":"scroll-button bg-white/95 hover:bg-white text-gray-700 ring-1 ring-gray-200 shadow-[0_4px_12px_rgba(0,0,0,0.12)]"),Qt=ge(()=>bt.value?"text-white w-6 h-6":"text-gray-600 w-6 h-6");xt(wt,R=>{console.log("index.vue 中热力图状态变化:",R)}),ko({meta:[{name:"viewport",content:"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"}]}),xt(()=>r.hash,R=>{const P=(R||"").split("/messages/").pop();Q.value=P||null},{immediate:!0});const se=G({siteTitle:"",subtitleText:"",avatarURL:"",username:"",description:"",backgrounds:[],cardFooterTitle:"",cardFooterSubtitle:"",pageFooterHTML:"",rssTitle:"",rssDescription:"",rssAuthorName:"",rssFaviconURL:"",linksTitle:"",linksDescription:"",commentPageTitle:"",commentPageDescription:"",aboutPageTitle:"",aboutPageDescription:"",aboutMarkdown:"",friendLinks:[],enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",announcementText:"",announcementEnabled:!0,hitokotoEnabled:!0,commentEnabled:!0,commentSystem:"builtin",commentEmailEnabled:!1,commentLoginRequired:!1,musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:"",calendarEnabled:!0,timeEnabled:!0,leftAdEnabled:!0,leftAdImageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,leftAdLinkURL:"https://note.noisework.cn",leftAdDescription:"示例广告（单条配置）",leftAds:[{imageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,linkURL:"https://note.noisework.cn",description:"写作与记录，开启灵感之旅"},{imageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,linkURL:"https://noisework.cn",description:"探索新主题与小工具"},{imageURL:`https://picsum.photos/seed/${Math.random().toString(36).slice(2)}/640/640`,linkURL:"https://github.com",description:"开源项目，欢迎 Star"}],leftAdsIntervalMs:4e3}),W=async()=>{await vt();const R=window.NeteaseMiniPlayer;R&&typeof R.init=="function"&&R.init()},q=async()=>{if(typeof window>"u")return!1;if(window.NeteaseMiniPlayer)return!0;const R=document.head,P=document.body,V="nmp-css";if(!document.getElementById(V)){const de=document.createElement("link");de.id=V,de.rel="stylesheet";const Ee=se.value.musicCssCdnURL||"",Qe="/NeteaseMiniPlayer/netease-mini-player-v2.css";de.href=Ee&&Ee.trim()!==""?Ee.trim():Qe,de.onerror=()=>{de.href=Qe},R.appendChild(de)}const ae="nmp-js";return document.getElementById(ae)?!!window.NeteaseMiniPlayer:await new Promise(de=>{const Ee=document.createElement("script");Ee.id=ae;const Qe=se.value.musicJsCdnURL||"",Mt="/NeteaseMiniPlayer/netease-mini-player-v2.js";Ee.src=Qe&&Qe.trim()!==""?Qe.trim():Mt,Ee.defer=!0,Ee.onload=()=>de(!!window.NeteaseMiniPlayer),Ee.onerror=()=>{if(Ee.src!==Mt){Ee.src=Mt,Ee.onload=()=>de(!!window.NeteaseMiniPlayer),Ee.onerror=()=>de(!1);return}de(!1)},P.appendChild(Ee)})},ee=async(R,P=2500)=>{const V=new AbortController,ae=setTimeout(()=>V.abort(),P);try{const de=await fetch(R,{cache:"no-cache",signal:V.signal});return clearTimeout(ae),de}catch(de){throw clearTimeout(ae),de}},te=async()=>{if(typeof window>"u")return;await vt();try{const P=await ee("https://v1.hitokoto.cn/?encode=json",2500);if(P.ok){const V=await P.json(),ae=String((V==null?void 0:V.hitokoto)||"").trim();if(ae){jt.value=ae;return}}}catch{}try{const P=await ee("https://v1.hitokoto.cn/?encode=text",2500);if(P.ok){const V=String(await P.text()).trim();if(V){jt.value=V;return}}}catch{}try{if(!document.getElementById("hitokoto-script-left")){const P=document.createElement("script");P.id="hitokoto-script-left",P.src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto",P.defer=!0,P.onload=()=>{try{const V=document.getElementById("hitokoto"),ae=((V==null?void 0:V.textContent)||(V==null?void 0:V.innerText)||"").trim();ae&&(jt.value=ae)}catch{}},document.body.appendChild(P)}}catch{}String(jt.value||"").trim()||(jt.value="身为冒险者，如果安静的老死在床上，那简直就是耻辱！")};xt(()=>se.value.musicEnabled,async R=>{R&&await q()&&await W()}),xt(()=>se.value.hitokotoEnabled,async R=>{R&&await te()},{immediate:!0});const je=ge(()=>({"--bg-image":`url(${zt.value||se.value.backgrounds[0]})`})),Ye=ge(()=>({"background-image":`url(${zt.value||se.value.backgrounds[0]})`,"background-size":"cover","background-position":"center"})),Ze={siteTitle:"说说笔记",subtitleText:"欢迎访问，点击头像可更换封面背景！",avatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",username:"Noise",description:"执迷不悟",welcomeAvatarURL:"https://s2.loli.net/2025/03/24/HnSXKvibAQlosIW.png",welcomeName:"Noise",welcomeDescription:"执迷不悟",welcomeUseAdmin:!0,backgrounds:["https://s2.loli.net/2025/03/27/KJ1trnU2ksbFEYM.jpg","https://s2.loli.net/2025/03/27/MZqaLczCvwjSmW7.jpg","https://s2.loli.net/2025/03/27/UMijKXwJ9yTqSeE.jpg","https://s2.loli.net/2025/03/27/WJQIlkXvBg2afcR.jpg","https://s2.loli.net/2025/03/27/oHNQtf4spkq2iln.jpg","https://s2.loli.net/2025/03/27/PMRuX5loc6Uaimw.jpg","https://s2.loli.net/2025/03/27/U2WIslbNyTLt4rD.jpg","https://s2.loli.net/2025/03/27/xu1jZL5Og4pqT9d.jpg","https://s2.loli.net/2025/03/27/OXqwzZ6v3PVIns9.jpg","https://s2.loli.net/2025/03/27/HGuqlE6apgNywbh.jpg","https://s2.loli.net/2025/03/26/d7iyuPYA8cRqD1K.jpg","https://s2.loli.net/2025/03/27/wYy12qDMH6bGJOI.jpg","https://s2.loli.net/2025/03/27/y67m2k5xcSdTsHN.jpg"],cardFooterTitle:"Noise·说说·笔记~",cardFooterSubtitle:"note.noisework.cn",pageFooterHTML:'<div class="text-center text-xs text-gray-400 py-4">来自<a href="https://www.noisework.cn" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Noise</a> 使用<a href="https://github.com/rcy1314/echo-noise" target="_blank" rel="noopener noreferrer" class="text-orange-400 hover:text-orange-500">Ech0-Noise</a>发布</div>',rssTitle:"Noise的说说笔记",rssDescription:"一个说说笔记~",rssAuthorName:"Noise",rssFaviconURL:"/favicon.ico",aboutMarkdown:`# 关于我

这里是一个默认的个人简介示例：

- 喜欢记录与分享
- 热爱开源与学习
- 持续打磨产品体验

欢迎通过友链或留言与我交流！`,linksTitle:"友情链接",linksDescription:"推荐站点和朋友们的主页",linksApplyTitle:"申请友链须知",linksApplyText:"请提供站点名称、网址、图标（可选）、简介与有效邮箱。提交后需管理员审核，审核通过后展示。",commentPageTitle:"留言",commentPageDescription:"欢迎留下你的看法",aboutPageTitle:"关于本站",aboutPageDescription:"这里是站点的介绍与说明",enableGithubCard:!1,pwaEnabled:!0,pwaTitle:"",pwaDescription:"",pwaIconURL:"",announcementText:"欢迎访问我的说说笔记！",announcementEnabled:!0,hitokotoEnabled:!0,commentEnabled:!0,commentSystem:"builtin",commentEmailEnabled:!1,commentLoginRequired:!1,musicEnabled:!1,musicPlaylistId:"2141128031",musicSongId:"",musicPosition:"bottom-left",musicTheme:"auto",musicLyric:!0,musicAutoplay:!1,musicDefaultMinimized:!0,musicEmbed:!1,musicCssCdnURL:"",musicJsCdnURL:"",socialLinks:[{name:"GitHub",url:"https://github.com/rcy1314",icon:"i-mdi-github"},{name:"X",url:"https://x.com/liangwenhao3",icon:"i-mdi-twitter"},{name:"主页",url:"https://www.noisework.cn/",icon:"i-mdi-home"},{name:"博客",url:"https://www.noiseblogs.top/",icon:"i-mdi-notebook"}],friendLinks:[{title:"NoiseWork",link:"https://www.noisework.cn/",icon:"i-mdi-home",description:"个人主页与作品集合"},{title:"NoiseBlogs",link:"https://www.noiseblogs.top/",icon:"i-mdi-notebook",description:"技术随笔与学习记录"}],calendarEnabled:!0,timeEnabled:!0,leftAdEnabled:!0,leftAds:[],leftAdsIntervalMs:4e3},yt=async()=>{var R;try{se.value={...Ze};const P=await zn("frontend/config",void 0,{credentials:"include"});if(P&&P.code===1&&P.data&&P.data.frontendSettings){const V=P.data.frontendSettings,ae=["enableGithubCard","pwaEnabled","announcementEnabled","hitokotoEnabled","commentEnabled","commentEmailEnabled","commentLoginRequired","musicEnabled","musicLyric","musicAutoplay","musicDefaultMinimized","musicEmbed","calendarEnabled","timeEnabled","leftAdEnabled","welcomeUseAdmin"];Object.keys(se.value).forEach(Ee=>{if(V[Ee]!==null&&V[Ee]!==void 0)if(Ee==="backgrounds"&&Array.isArray(V[Ee]))se.value.backgrounds=[...V[Ee]];else if(Ee==="socialLinks"&&Array.isArray(V[Ee]))se.value.socialLinks=[...V[Ee]];else if(Ee==="leftAds"&&Array.isArray(V[Ee]))se.value.leftAds=[...V[Ee]];else if(Ee==="friendLinks"){const Qe=V[Ee];Array.isArray(Qe)&&Qe.length>0?se.value.friendLinks=[...Qe]:se.value.friendLinks=[...Ze.friendLinks]}else if(ae.includes(Ee)){const Qe=V[Ee];se.value[Ee]=Qe===!0||Qe==="true"}else{const Qe=V[Ee];se.value[Ee]=typeof Qe=="string"?Qe.trim():Qe}});const de=(V.defaultContentTheme||"light").trim();typeof window<"u"&&!localStorage.getItem("contentTheme")?(nt.value=de==="light"?"light":"dark",document.documentElement.className=nt.value==="dark"?"dark":""):typeof window<"u"&&(document.documentElement.className=nt.value==="dark"?"dark":"")}if((R=se.value.backgrounds)!=null&&R.length||(se.value.backgrounds=[...Ze.backgrounds]),se.value.backgrounds.length>0){const V=Math.floor(Math.random()*se.value.backgrounds.length);zt.value=se.value.backgrounds[V]}$t.value=!0}catch(P){console.error("获取配置失败:",P),se.value={...Ze},$t.value=!0}},ve=R=>{const P=R&&typeof R.icon=="string"?R.icon.trim():"";if(P)return P;const V=String((R==null?void 0:R.url)||"").trim();if(!V)return"i-mdi-link-variant";const ae=V.toLowerCase();if(ae.startsWith("mailto:"))return"i-mdi-email";let de="";try{de=new URL(ae).hostname.toLowerCase()}catch{}return de?de.includes("github.com")?"i-mdi-github":de.includes("twitter.com")||de.includes("x.com")?"i-mdi-twitter":de.includes("t.me")||de.includes("telegram.me")||de.includes("telegram.org")?"i-mdi-telegram":de.includes("discord.com")||de.includes("discord.gg")?"i-mdi-discord":de.includes("youtube.com")||de.includes("youtu.be")?"i-mdi-youtube":de.includes("linkedin.com")?"i-mdi-linkedin":de.includes("facebook.com")?"i-mdi-facebook":de.includes("instagram.com")?"i-mdi-instagram":de.includes("bilibili.com")?"i-mdi-bilibili":de.includes("zhihu.com")?"i-mdi-zhihu":de.includes("medium.com")?"i-mdi-medium":de.includes("tiktok.com")||de.includes("douyin.com")?"i-mdi-tiktok":de.includes("weibo.com")?"i-mdi-sina-weibo":de.includes("wechat")||de.includes("weixin")?"i-mdi-wechat":de.includes("rss")||de.endsWith("/rss")?"i-mdi-rss":"i-mdi-link-variant":"i-mdi-link-variant"},Tt=ge(()=>{var V;const R=((V=se.value)==null?void 0:V.socialLinks)??se.socialLinks;return(Array.isArray(R)?R:[]).filter(ae=>String((ae==null?void 0:ae.url)||"").trim()!=="").map(ae=>({...ae,name:(ae==null?void 0:ae.name)||(ae==null?void 0:ae.url)}))});ge(()=>Tt.value);const Et=ge(()=>{var ae;const R=((ae=se.value)==null?void 0:ae.friendLinks)??se.friendLinks,P=Array.isArray(R)?R:[],V=de=>{const Ee=String(de||"").trim().toLowerCase();return!!Ee&&(Ee.startsWith("http")||Ee.startsWith("data:image")||/\.(png|jpg|jpeg|webp|gif|ico)(\?.*)?$/.test(Ee))};return P.filter(de=>String((de==null?void 0:de.link)||"").trim()!=="").map(de=>{const Ee=String((de==null?void 0:de.icon)||"").trim(),Qe=V(Ee)?Ee:"";return{title:String((de==null?void 0:de.title)||(de==null?void 0:de.link)||"").trim(),link:String((de==null?void 0:de.link)||"").trim(),icon:Ee,imageURL:Qe,description:String((de==null?void 0:de.description)||"").trim()}})}),it=_r({title:"",link:"",icon:"",email:"",description:""}),dt=G(!1),Hn=async()=>{if(!String(it.link||"").trim()){We().add({title:"提示",description:"请填写网址（必填）",color:"orange"});return}const R=String(it.link||"").trim();if(!/^https?:\/\//i.test(R)){We().add({title:"提示",description:"网址需以 http(s):// 开头",color:"orange"});return}dt.value=!0;try{const P=await fetch(`${s}/friend-links/apply`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({title:String(it.title||"").trim(),link:R,icon:String(it.icon||"").trim(),description:String(it.description||"").trim(),email:String(it.email||"").trim()})}),V=await P.json().catch(()=>({}));P.ok&&((V==null?void 0:V.code)===1||V!=null&&V.data)?(We().add({title:"已提交，待审核",color:"green"}),it.title="",it.link="",it.icon="",it.email="",it.description=""):We().add({title:"提交失败",description:(V==null?void 0:V.msg)||"请稍后重试",color:"red"})}catch(P){We().add({title:"提交失败",description:(P==null?void 0:P.message)||"网络异常",color:"red"})}finally{dt.value=!1}},jt=G(["身为冒险者，如果安静的老死在床上，那简直就是耻辱！","愿你出走半生，归来仍是少年。","愿你眼里有光，心里有海。"][0]),zt=G(""),$t=G(!1),kn=G(!1),En=async R=>{const P=V=>new Promise(ae=>{const de=new Image;de.src=V,de.onload=()=>ae(V),de.onerror=()=>ae(null)});await Promise.all(R.map(V=>P(V)))};li(()=>{window.removeEventListener("frontend-config-updated",yt)});const ni=async()=>{if(kn.value)return;kn.value=!0;const R=Math.floor(Math.random()*se.value.backgrounds.length),P=se.value.backgrounds[R];if(P===zt.value){kn.value=!1;return}const V=`${P}?imageView2/2/w/10/blur/1/q/10`;zt.value=V,requestAnimationFrame(()=>{const ae=new Image;ae.src=P,ae.onload=()=>{requestAnimationFrame(()=>{zt.value=P,kn.value=!1})},ae.onerror=()=>{kn.value=!1}})};let ln=null;const Nn=()=>{ln&&clearTimeout(ln),ln=setTimeout(()=>Dt(),100)},Dt=()=>{const R=(se.value.pwaTitle||se.value.siteTitle||"说说笔记").trim(),P=(se.value.rssFaviconURL||"/favicon.ico").trim(),V=se.value.pwaIconURL&&se.value.pwaIconURL.trim()!==""?se.value.pwaIconURL.trim():P.toLowerCase().endsWith(".png")?P:"/android-chrome-192x192.png",ae=(se.value.pwaDescription||se.value.description||"").trim();ko({title:R,meta:[{key:"description",name:"description",content:ae},{key:"theme-color",name:"theme-color",content:"#000000"}],link:[{key:"icon-32",rel:"icon",type:"image/png",href:"/favicon-32x32.png",sizes:"32x32"},{key:"shortcut-icon-32",rel:"shortcut icon",type:"image/png",href:"/favicon-32x32.png",sizes:"32x32"},{key:"icon-fallback",rel:"icon",href:P},...se.value.pwaEnabled?[{key:"manifest",rel:"manifest",href:"/manifest.webmanifest"},{key:"apple-touch",rel:"apple-touch-icon",href:V,sizes:"180x180"},{key:"pwa-192",rel:"icon",href:V,sizes:"192x192"},{key:"pwa-512",rel:"icon",href:V.toLowerCase().endsWith(".png")?V:"/android-chrome-512x512.png",sizes:"512x512"}]:[]]})};xt(()=>[se.value.pwaEnabled,se.value.pwaTitle,se.value.pwaIconURL,se.value.pwaDescription,se.value.siteTitle,se.value.rssFaviconURL,se.value.description],()=>{Nn()},{immediate:!0});const cn=G(null),at=G([]),F=async()=>{await J()},J=async()=>{try{const R=await zn("messages/tags");R&&R.code===1?at.value=R.data||[]:at.value=[]}catch(R){console.error("获取标签失败:",R),at.value=[]}},xe=G([]),De=G(null),ze=async()=>{try{const R=await zn("messages/images");R&&R.code===1&&Array.isArray(R.data)&&(xe.value=R.data)}catch{}},ut=async()=>{try{const R=await zn("status");R&&R.code===1&&(De.value=R.data)}catch{}},Be=ge(()=>(Array.isArray(at.value)?[...at.value]:[]).sort((P,V)=>(V.count||0)-(P.count||0)).slice(0,8)),Rt=ge(()=>xe.value.slice(0,60)),en=R=>{const P=typeof R=="string"?R:(R==null?void 0:R.image_url)||(R==null?void 0:R.url),V=gn().public.baseApi||"/api";return P!=null&&P.startsWith("http")?P:`${V}${P}`},pt=ge(()=>Array.isArray(se.value.leftAds)?se.value.leftAds.filter(R=>String((R==null?void 0:R.imageURL)||"").trim()!==""):[]),xn=R=>{const P=gn().public.baseApi||"/api",V=String(R||"").trim();return V.startsWith("http")?V:V?`${P}${V}`:""},Yn=G(0),ii=ge(()=>pt.value[Math.max(0,Math.min(Yn.value,pt.value.length-1))]||{imageURL:"",linkURL:"",description:""});let jn;const $n=R=>new Promise(P=>{try{const V=xn((R==null?void 0:R.imageURL)||"");if(!V)return P(!1);const ae=new Image;ae.src=V,ae.onload=()=>P(!0),ae.onerror=()=>P(!1)}catch{P(!1)}}),Vi=async R=>{const P=pt.value[Math.max(0,Math.min(R,pt.value.length-1))];if(!P)return;await $n(P)&&(Yn.value=pt.value.indexOf(P))},ba=async()=>{if(pt.value.length<=1)return;const R=(Yn.value+1)%pt.value.length,P=pt.value[R];await $n(P)&&(Yn.value=R)},jr=()=>{var P;jn&&(clearInterval(jn),jn=null);const R=Number(((P=se.value)==null?void 0:P.leftAdsIntervalMs)??5e3);pt.value.length>1&&(jn=er(()=>{ba()},Math.max(1e3,R)))};Ht(()=>{jr()}),xt([pt,()=>{var R;return(R=se.value)==null?void 0:R.leftAdsIntervalMs}],()=>{jr()},{immediate:!0}),li(()=>{jn&&clearInterval(jn)});const ki=G([]),qi=G(0),pr=R=>/!\[[^\]]*\]\([^)]*\)/.test(String(R||""))||/<img[^>]*>/i.test(String(R||"")),mr=ge(()=>{const R=ki.value.filter(ae=>!pr((ae==null?void 0:ae.content)||""));if(R.length<=8)return R;const P=qi.value%R.length,V=(P+8)%R.length;return P<V?R.slice(P,V):[...R.slice(P),...R.slice(0,V)]}),fi=R=>{const ae=String(R||"").replace(/!\[[^\]]*\]\([^)]*\)/g,"").replace(/<img[^>]*>/gi,"").replace(/<[^>]+>/g,"").replace(/\s+/g," ").trim();return ae.length>20?ae.slice(0,20):ae||"评论"},$r=R=>`https://i.pravatar.cc/64?u=${encodeURIComponent(R||Math.random().toString(36).slice(2))}`,gr=R=>{const V=String(R||"").trim().match(/^(\d+)@qq\.com$/i);return V?V[1]:""},Br=R=>{let P=0;const V=String(R||"");for(let ae=0;ae<V.length;ae++)P=(P<<5)-P+V.charCodeAt(ae),P|=0;return Math.abs(P)},Ei=R=>{const P=String(R||"").trim();if(!P)return"U";if(/^[\u4e00-\u9fa5]/.test(P))return P.slice(0,1);const V=P.split(/\s+|[_.-]+/).filter(Boolean),ae=(V[0]||P)[0]||"U",de=(V[1]||"")[0]||"";return(ae+de).toUpperCase()},ri=(R,P=40)=>{const V=Ei(R),de=`hsl(${Br(R)%360},70%,50%)`,Ee=`<svg xmlns="http://www.w3.org/2000/svg" width="${P}" height="${P}"><rect width="${P}" height="${P}" rx="${P/2}" fill="${de}"/><text x="50%" y="55%" font-size="${Math.floor(P*.5)}" text-anchor="middle" fill="#fff" font-family="-apple-system,Segoe UI,Roboto,Helvetica,Arial">${V}</text></svg>`;return"data:image/svg+xml;charset=UTF-8,"+encodeURIComponent(Ee)},xi=ge(()=>{const R=String(se.value.avatarURL||"").trim(),P=gn().public.baseApi||"/api";return R?R.startsWith("http")?R:`${P}${R}`:String(se.value.rssFaviconURL||"/favicon.svg").trim()}),vr=(R,P=100)=>[R?`https://q1.qlogo.cn/g?b=qq&nk=${R}&s=${P}`:"",R?`https://q2.qlogo.cn/g?b=qq&nk=${R}&s=${P}`:"",R?`https://q.qlogo.cn/g?b=qq&nk=${R}&s=${P}`:""].filter(Boolean),Wi=R=>{const P=gr((R==null?void 0:R.mail)||""),V=String((R==null?void 0:R.nick)||"").trim();return vr(P)[0]||""||ri(V||(R==null?void 0:R.mail)||"anonymous")||xi.value||$r(V||(R==null?void 0:R.mail)||"")},Si=(R,P)=>{var Ft,Bn,Kn;const V=R.target,ae=((Ft=V==null?void 0:V.dataset)==null?void 0:Ft.mail)||"",de=String(((Bn=V==null?void 0:V.dataset)==null?void 0:Bn.qq)||""),Ee=Number(((Kn=V==null?void 0:V.dataset)==null?void 0:Kn.try)||0),Qe=vr(de);if(de&&Ee<Qe.length){const un=Math.min(Ee+1,Qe.length-1),An=Qe[un];V.dataset.try=String(un),V.src=An;return}const Mt=ri(P||ae||"anonymous")||xi.value||$r(P||ae||"anonymous");V&&Mt&&(V.src=Mt)},Yi=gn().public.baseApi||"/api",br=async()=>{var R,P;try{let V=1,ae=50,de=0;const Ee=[];for(let Qe=0;Qe<3;Qe++){const Mt=await fetch(`${Yi}/messages/page`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},credentials:"include",body:JSON.stringify({page:V,pageSize:ae})});if(!Mt.ok)break;const Ft=await Mt.json().catch(()=>null),Bn=((R=Ft==null?void 0:Ft.data)==null?void 0:R.items)||[];de=Number(((P=Ft==null?void 0:Ft.data)==null?void 0:P.total)||0);const un=Bn.map(tn=>tn.id).filter(tn=>tn!==ce.value).map(async tn=>{try{const Ti=await fetch(`${Yi}/messages/${tn}/comments`,{credentials:"include",headers:{Accept:"application/json"}});if(!Ti.ok)return[];const Xi=await Ti.json();return(Array.isArray(Xi==null?void 0:Xi.data)?Xi.data:[]).map(hi=>({id:hi.id,nick:hi.nick,mail:hi.mail,content:hi.content,created_at:hi.created_at,message_id:tn}))}catch{return[]}}),An=await Promise.all(un),ue=[].concat(...An);Ee.push(...ue);const Kt=Math.max(1,Math.ceil(de/ae));if(Ee.length>=24||V>=Kt)break;V+=1}if(Ee.sort((Qe,Mt)=>new Date(Mt.created_at||0).getTime()-new Date(Qe.created_at||0).getTime()),ki.value=Ee.filter(Qe=>Qe.message_id!==ce.value).filter(Qe=>!pr((Qe==null?void 0:Qe.content)||"")).map(Qe=>({id:Qe.id,nick:Qe.nick,mail:Qe.mail,content:Qe.content})).slice(0,24),ki.value.length>0)return}catch{}ki.value=["期待","对方的","发个","困难","路口提示","测试","你好","加油","真不错","赞同","有趣","哈哈","有用","收藏","不错","灵感","记录"].map((V,ae)=>({id:ae+1,nick:"匿名",mail:"",content:V}))};Ht(async()=>{await br(),er(()=>{qi.value=(qi.value+1)%Math.max(1,ki.value.length)},3e3)}),Ht(()=>{var R,P;try{(P=(R=window.Fancybox)==null?void 0:R.bind)==null||P.call(R,"[data-fancybox]",{})}catch{}});const st=ge(()=>bt.value?"bg-[rgba(36,43,50,0.75)] text-white":"bg-slate-100 text-slate-800"),yr=ge(()=>bt.value?"text-white":"text-slate-800");Ht(()=>{const R=()=>yt();window.addEventListener("frontend-config-updated",R),yt(),J(),ze(),ut(),li(()=>window.removeEventListener("frontend-config-updated",R))});const Ci=async R=>{try{const P=encodeURIComponent(R.trim()),V=await zn(`messages/tags/${P}`,void 0,{credentials:"include"});if(V&&V.code===1&&Array.isArray(V.data))y.value&&y.value.handleSearchResult(V.data);else throw new Error((V==null?void 0:V.msg)||"获取标签内容失败")}catch(P){console.error("获取标签消息失败:",P),We().add({title:"获取标签消息失败",description:P.message||"服务器错误，请稍后重试",color:"red",timeout:3e3})}},Ur=()=>{if(!cn.value)return;let R=0,P=!1,V=!1;const ae=er(()=>{if(!cn.value){clearInterval(ae);return}V||(P?(R--,cn.value.textContent=se.value.subtitleText.slice(0,R),R<=0&&(V=!0,cn.value.textContent="",setTimeout(()=>{P=!1,V=!1,R=0},1e3))):(cn.value.textContent=se.value.subtitleText.slice(0,R+1),R++,R>=se.value.subtitleText.length&&(V=!0,setTimeout(()=>{P=!0,V=!1},2e3))))},100);return ae};Ht(async()=>{try{if($t.value=!1,window.requestIdleCallback=window.requestIdleCallback||(P=>setTimeout(P,1)),await yt(),se.value.musicEnabled&&await W(),Eo(async()=>{await J(),await En(se.value.backgrounds)}),se.value.backgrounds.length>0){const P=se.value.backgrounds[Math.floor(Math.random()*se.value.backgrounds.length)],V=`${P}?imageView2/2/w/100/q/30`;zt.value=V,Eo(async()=>{await En(se.value.backgrounds)});const ae=new Image;ae.src=P,ae.onload=()=>{requestAnimationFrame(()=>{zt.value=P,$t.value=!0})},ae.onerror=()=>{$t.value=!0},setTimeout(()=>{$t.value||($t.value=!0)},2e3)}const R=Ur();li(()=>{R&&clearInterval(R)}),window.addEventListener("frontend-config-updated",async P=>{var V;if(await yt(),((V=se.value.backgrounds)==null?void 0:V.length)>0){const ae=Math.floor(Math.random()*se.value.backgrounds.length),de=se.value.backgrounds[ae];zt.value=de}})}catch(R){console.error("初始化失败:",R),$t.value=!0}}),G(new Date);const Ki=G(new Date);let _i=null;Ht(()=>{_i=er(()=>{Ki.value=new Date},1e3)}),li(()=>{_i&&(clearInterval(_i),_i=null)});const Gi=R=>{const P=String(R.getHours()).padStart(2,"0"),V=String(R.getMinutes()).padStart(2,"0"),ae=String(R.getSeconds()).padStart(2,"0");return`${P}:${V}:${ae}`},zr=R=>{const P=R.getFullYear(),V=String(R.getMonth()+1).padStart(2,"0"),ae=String(R.getDate()).padStart(2,"0"),de=["周日","周一","周二","周三","周四","周五","周六"][R.getDay()];return`${P}-${V}-${ae} ${de}`};return(R,P)=>{const V=di,ae=Ir,de=Qu,Ee=pa,Qe=td,Mt=ma,Ft=gs,Bn=ad,Kn=Cc,un=Ac,An=ga;return Z(),oe("div",{class:"background-container",style:bi(je.value)},[$t.value?Oe("",!0):(Z(),oe("div",mp,P[25]||(P[25]=[I("div",{class:"rainbow-spinner"},null,-1),I("div",{class:"loading-text"},"加载中...",-1)]))),I("div",{ref_key:"contentWrapper",ref:Pt,class:ke(["content-wrapper",{"gpu-accelerated":!0}])},[ie(Bn,{class:"container-fixed py-2 pb-4 my-4"},{default:Me(()=>[I("div",{class:ke(["layout-container",x.value])},[ie(Qe,null,{default:Me(()=>[!u.value&&d.value!=="single"?(Z(),oe("div",gp,[ie(Ee,{class:ke(["sidebar-card",Nt.value])},{default:Me(()=>[I("div",vp,[I("div",bp,[I("img",{class:"avatar-lg",src:_e.value,alt:ot.value,onClick:ni,onError:tt},null,40,yp),I("span",{class:ke(["avatar-status",pe.value?"bg-green-500":"bg-gray-400"])},null,2)]),I("div",wp,Fe(ot.value),1),Je.value?(Z(),oe("div",kp,P[26]||(P[26]=[I("span",{class:"px-1.5 py-0.5 rounded bg-orange-500 text-white text-[10px]"},"管理员",-1)]))):Oe("",!0),I("div",Ep,Fe(kt.value),1),pe.value?Oe("",!0):(Z(),oe("div",xp,[ie(de,{text:"登录"},{default:Me(()=>[ie(ae,{variant:"ghost",color:"indigo",class:"auth-btn",onClick:P[0]||(P[0]=ue=>{C.value="login",w.value=!0})},{default:Me(()=>[ie(V,{name:"i-heroicons-arrow-right-end-on-rectangle",class:"w-5 h-5"})]),_:1})]),_:1}),ie(de,{text:"注册"},{default:Me(()=>[ie(ae,{variant:"ghost",color:"orange",class:"auth-btn",onClick:P[1]||(P[1]=ue=>{Ie(),w.value=!0})},{default:Me(()=>[ie(V,{name:"i-heroicons-user-plus",class:"w-5 h-5"})]),_:1})]),_:1})]))])]),_:1},8,["class"]),ie(Ee,{class:ke(["sidebar-card no-padding-card mt-2",Nt.value])},{default:Me(()=>{var ue,Kt,tn,Ti;return[I("div",Sp,[I("div",null,[I("div",Cp,Fe(((ue=De.value)==null?void 0:ue.total_messages)??((Kt=De.value)==null?void 0:Kt.TotalMessages)??0),1),P[27]||(P[27]=I("div",{class:"opacity-70"},"笔记数",-1))]),I("div",null,[I("div",_p,Fe(((tn=at.value)==null?void 0:tn.length)||0),1),P[28]||(P[28]=I("div",{class:"opacity-70"},"标签",-1))]),I("div",null,[I("div",Tp,Fe(((Ti=xe.value)==null?void 0:Ti.length)||0),1),P[29]||(P[29]=I("div",{class:"opacity-70"},"图片",-1))])])]}),_:1},8,["class"]),ie(Ee,{class:ke(["sidebar-card no-padding-card mt-2",Nt.value])},{default:Me(()=>[I("div",Mp,[(Z(!0),oe(It,null,Jt(se.value.socialLinks||[],ue=>(Z(),oe("a",{key:ue.url||ue.name,class:"social-item",href:ue.url,target:"_blank",rel:"noopener noreferrer","data-label":ue.name||ue.url},[ue.imageURL?(Z(),oe("img",{key:0,src:ue.imageURL,alt:"icon",class:"social-icon-img"},null,8,Lp)):(Z(),Lt(V,{key:1,name:ve(ue),class:"w-7 h-7"},null,8,["name"]))],8,Ap))),128))])]),_:1},8,["class"]),se.value.timeEnabled?(Z(),Lt(Ee,{key:0,class:ke(["sidebar-card no-padding-card mt-2",Nt.value])},{default:Me(()=>[I("div",Dp,[I("div",Op,Fe(Gi(Ki.value)),1),I("div",Pp,Fe(zr(Ki.value)),1)])]),_:1},8,["class"])):Oe("",!0),se.value.leftAdEnabled&&pt.value.length>0?(Z(),Lt(Ee,{key:1,class:ke(["sidebar-card mt-2",Nt.value])},{default:Me(()=>[I("div",null,[pt.value.length>0?(Z(),oe("div",Rp,[I("a",{href:ii.value.linkURL||"#",target:"_blank",rel:"noopener noreferrer",class:"block ad-wrap group rounded-lg overflow-hidden",style:bi({"--ad-bg":`url(${xn(ii.value.imageURL)})`})},[I("img",{src:xn(ii.value.imageURL),alt:"ad",class:"ad-image w-full object-cover transition duration-200 rounded-lg"},null,8,Hp),I("div",Np,[I("div",{class:ke(["ad-overlay-box transition-colors duration-200",[bt.value?"":"group-hover:text-orange-500"]])},Fe((ii.value.description||"").trim()||"广告"),3)])],12,Ip),pt.value.length>1?(Z(),oe("div",jp,[(Z(!0),oe(It,null,Jt(pt.value,(ue,Kt)=>(Z(),oe("button",{key:Kt,onClick:tn=>Vi(Kt),class:ke(["w-2 h-2 rounded-full",Kt===Yn.value?"bg-white":"bg-white/40"]),"aria-label":"switch-ad"},null,10,$p))),128))])):Oe("",!0)])):Oe("",!0)])]),_:1},8,["class"])):Oe("",!0),se.value.hitokotoEnabled?(Z(),Lt(Ee,{key:2,class:ke(["sidebar-card mt-2",Nt.value])},{default:Me(()=>[P[30]||(P[30]=I("div",{class:"hidden"},[I("span",{id:"hitokoto"},"正在获取中...")],-1)),I("div",Bp,[I("div",{class:"hitokoto-text",title:jt.value||"正在获取中..."},[ie(yi,{content:jt.value||"正在获取中...",enableGithubCard:!1},null,8,["content"])],8,Up)])]),_:1},8,["class"])):Oe("",!0),d.value==="two"?(Z(),oe("div",zp,[se.value.announcementEnabled&&(se.value.announcementText||"").trim()!==""?(Z(),Lt(Ee,{key:0,class:ke(["sidebar-card",Nt.value])},{default:Me(()=>[ie(ls,{text:se.value.announcementText||"欢迎访问我的说说笔记！"},null,8,["text"])]),_:1},8,["class"])):Oe("",!0),ie(Ee,{class:ke(["sidebar-card no-padding-card",Nt.value])},{default:Me(()=>[I("div",null,[P[31]||(P[31]=I("div",{class:"text-xs opacity-70 mb-2"},"热门标签",-1)),I("div",Fp,[I("div",Vp,[(Z(!0),oe(It,null,Jt(Be.value,ue=>(Z(),oe("button",{key:ue.name,class:"px-2 py-1 rounded text-xs border opacity-80 hover:opacity-100",onClick:Kt=>Ci(ue.name)},[mt("#"+Fe(ue.name),1),I("span",Wp,Fe(ue.count),1)],8,qp))),128))])])])]),_:1},8,["class"]),ie(Ee,{class:ke(["sidebar-card no-padding-card",Nt.value])},{default:Me(()=>[I("div",null,[P[32]||(P[32]=I("div",{class:"text-xs opacity-70 mb-2"},"图集",-1)),I("div",Yp,[I("div",Kp,[(Z(!0),oe(It,null,Jt(Rt.value,ue=>(Z(),oe("a",{key:ue.id||ue,href:en(ue),"data-fancybox":"recommend-gallery",class:"block"},[I("img",{src:en(ue),class:"recommend-image-box",loading:"lazy",alt:"recommend"},null,8,Xp)],8,Gp))),128))])])])]),_:1},8,["class"]),ie(Ee,{class:ke(["sidebar-card no-padding-card",Nt.value])},{default:Me(()=>[ie(ss)]),_:1},8,["class"]),ie(Ee,{class:"sidebar-card no-padding-card"},{default:Me(()=>[P[33]||(P[33]=I("div",{class:"text-xs opacity-70 mb-1"},"最新评论",-1)),I("div",Zp,[I("div",Jp,[(Z(!0),oe(It,null,Jt(mr.value,(ue,Kt)=>(Z(),oe("div",{key:ue.id||Kt,class:ke(["inline-flex items-center gap-2 px-2 py-1 rounded-full",st.value])},[I("img",{src:Wi(ue),"data-mail":ue.mail||"","data-qq":gr((ue==null?void 0:ue.mail)||""),"data-try":"0",class:"w-5 h-5 rounded-full object-cover",alt:"avatar",onError:tn=>Si(tn,ue.nick||"")},null,40,Qp),I("span",{class:ke(["text-xs",yr.value])},Fe(fi(ue.content)),3)],2))),128))])])]),_:1})])):Oe("",!0)])):Oe("",!0)]),_:1}),I("div",em,[I("div",{class:ke(h.value)},[I("div",tm,[I("div",{class:"header-image",style:bi(Ye.value)},[I("h1",nm,Fe(se.value.siteTitle||"说说笔记"),1),I("div",{class:"header-subtitle",ref_key:"subtitleEl",ref:cn},null,512),I("div",im,[(Z(),oe(It,null,Jt(f,ue=>I("button",{key:ue.key,class:ke(["hero-tab",b.value===ue.key?"active":""]),onClick:Kt=>b.value=ue.key},Fe(ue.name),11,rm)),64))])],4)]),b.value==="links"?(Z(),oe("div",am,[ie(Ee,{class:"search-card mb-3",ui:{body:"p-3 md:p-4"}},{default:Me(()=>[I("div",{class:ke(["card-title text-center",bt.value?"text-white":"text-black"])},Fe(se.value.linksTitle||"友情链接"),3),(se.value.linksDescription||"").trim()!==""?(Z(),oe("div",om,Fe(se.value.linksDescription),1)):Oe("",!0),Et.value.length>0?(Z(),oe("div",sm,[I("div",lm,[(Z(!0),oe(It,null,Jt(Et.value,ue=>(Z(),oe("a",{key:ue.link||ue.title,href:ue.link,target:"_blank",rel:"noopener noreferrer",class:ke(["link-card",bt.value?"link-card-dark":"link-card-light"])},[I("div",{class:ke(["link-avatar",bt.value?"link-avatar-dark":"link-avatar-light"])},[ue.imageURL?(Z(),oe("img",{key:0,src:xn(ue.imageURL),alt:"avatar",class:"link-avatar-img"},null,8,um)):(Z(),Lt(V,{key:1,name:ve({url:ue.link,icon:ue.icon}),class:"w-6 h-6"},null,8,["name"]))],2),I("div",dm,[I("div",fm,Fe(ue.title),1),ue.description?(Z(),oe("div",hm,Fe(ue.description),1)):Oe("",!0)])],10,cm))),128))])])):Oe("",!0),(se.value.linksApplyTitle||"").trim()!==""||(se.value.linksApplyText||"").trim()!==""?(Z(),oe("div",pm,[I("div",{class:ke(["text-sm font-medium text-center mb-1",bt.value?"text-white":"text-black"])},Fe(se.value.linksApplyTitle||"申请友链须知"),3),I("div",{class:ke(["apply-text text-center",bt.value?"text-white/80":"text-black/70"])},Fe((se.value.linksApplyText||"").trim()),3)])):Oe("",!0),I("div",mm,[P[35]||(P[35]=I("div",{class:"text-center text-xs opacity-70 mb-2"},"提交后需管理员审核",-1)),I("div",gm,[ie(Mt,{modelValue:we(it).title,"onUpdate:modelValue":P[2]||(P[2]=ue=>we(it).title=ue),placeholder:"站点名称（可选）"},null,8,["modelValue"]),ie(Mt,{modelValue:we(it).link,"onUpdate:modelValue":P[3]||(P[3]=ue=>we(it).link=ue),placeholder:"网址（必填，如 https://example.com）"},null,8,["modelValue"]),ie(Mt,{modelValue:we(it).icon,"onUpdate:modelValue":P[4]||(P[4]=ue=>we(it).icon=ue),placeholder:"图标标识（可选，例如 i-mdi-home）"},null,8,["modelValue"]),ie(Mt,{modelValue:we(it).email,"onUpdate:modelValue":P[5]||(P[5]=ue=>we(it).email=ue),placeholder:"邮箱（用于通知，可选）"},null,8,["modelValue"]),ie(Ft,{modelValue:we(it).description,"onUpdate:modelValue":P[6]||(P[6]=ue=>we(it).description=ue),rows:2,placeholder:"简介（可选）",class:"sm:col-span-2"},null,8,["modelValue"])]),I("div",vm,[ie(ae,{loading:dt.value,color:"primary",onClick:Hn},{default:Me(()=>P[34]||(P[34]=[mt("提交申请")])),_:1},8,["loading"])])])]),_:1})])):b.value==="comment"?(Z(),oe("div",bm,[ie(Ee,{class:"search-card mb-3",ui:{body:"p-5"}},{default:Me(()=>[I("div",{class:ke(["card-title text-center mb-3",bt.value?"text-white":"text-black"])},Fe(se.value.commentPageTitle||"留言"),3),(se.value.commentPageDescription||"").trim()!==""?(Z(),oe("div",ym,Fe(se.value.commentPageDescription),1)):Oe("",!0),I("div",wm,[ce.value?(Z(),Lt(Zs,{key:0,"message-id":ce.value,"site-config":se.value,"show-input":!0},null,8,["message-id","site-config"])):(Z(),oe("div",km,"正在准备留言板..."))])]),_:1})])):b.value==="about"?(Z(),oe("div",Em,[ie(Ee,{class:"search-card mb-3",ui:{body:"p-6"}},{default:Me(()=>[I("div",{class:ke(["card-title text-center",bt.value?"text-white":"text-black"])},Fe(se.value.aboutPageTitle||"关于本站"),3),(se.value.aboutPageDescription||"").trim()!==""?(Z(),oe("div",xm,Fe(se.value.aboutPageDescription),1)):Oe("",!0),I("div",Sm,[ie(yi,{content:(se.value.aboutMarkdown||"").trim()||Ze.aboutMarkdown},null,8,["content"])])]),_:1})])):(Z(),oe(It,{key:3},[ie(uf,{onSearchResult:Ce,"hide-header-tools":d.value==="three",wide:d.value==="two"},null,8,["hide-header-tools","wide"]),I("div",Cm,[at.value&&at.value.length>0?(Z(),Lt(op,{key:0,tags:at.value,onTagClick:Ci,onUpdateTags:F},null,8,["tags"])):Oe("",!0)]),ie(Kh,{ref_key:"messageList",ref:y,class:"message-list-container","site-config":se.value,"target-message-id":Q.value,wide:d.value==="two"},null,8,["site-config","target-message-id","wide"])],64)),I("div",{class:"page-footer",innerHTML:se.value.pageFooterHTML||Ze.pageFooterHTML},null,8,_m)],2)]),ie(Qe,null,{default:Me(()=>[!u.value&&d.value==="three"?(Z(),oe("div",Tm,[se.value.announcementEnabled&&(se.value.announcementText||"").trim()!==""?(Z(),Lt(Ee,{key:0,class:ke(["sidebar-card",Nt.value])},{default:Me(()=>[ie(ls,{text:se.value.announcementText||"欢迎访问我的说说笔记！"},null,8,["text"])]),_:1},8,["class"])):Oe("",!0),ie(Ee,{class:ke(["sidebar-card no-padding-card",Nt.value])},{default:Me(()=>[I("div",null,[P[36]||(P[36]=I("div",{class:"text-xs opacity-70 mb-2"},"热门标签",-1)),I("div",Mm,[I("div",Am,[(Z(!0),oe(It,null,Jt(Be.value,ue=>(Z(),oe("button",{key:ue.name,class:"px-2 py-1 rounded text-xs border opacity-80 hover:opacity-100",onClick:Kt=>Ci(ue.name)},[mt("#"+Fe(ue.name),1),I("span",Dm,Fe(ue.count),1)],8,Lm))),128))])])])]),_:1},8,["class"]),ie(Ee,{class:ke(["sidebar-card no-padding-card",Nt.value])},{default:Me(()=>[I("div",null,[I("div",Om,"最新图集（"+Fe(Rt.value.length)+"）",1),I("div",Pm,[I("div",Rm,[(Z(!0),oe(It,null,Jt(Rt.value,ue=>(Z(),oe("a",{key:ue.id||ue,href:en(ue),"data-fancybox":"recommend-gallery",class:"block"},[I("img",{src:en(ue),class:"recommend-image-box",loading:"lazy",alt:"recommend"},null,8,Hm)],8,Im))),128))])])])]),_:1},8,["class"]),ie(Ee,{class:ke(["sidebar-card no-padding-card",Nt.value])},{default:Me(()=>[ie(ss)]),_:1},8,["class"]),ie(Ee,{class:ke(["sidebar-card mt-2 no-padding-card",Nt.value])},{default:Me(()=>[P[37]||(P[37]=I("div",{class:"text-xs opacity-70 mb-1"},"最新评论",-1)),I("div",Nm,[I("div",jm,[(Z(!0),oe(It,null,Jt(mr.value,(ue,Kt)=>(Z(),oe("div",{key:ue.id||Kt,class:ke(["inline-flex items-center gap-2 px-2 py-1 rounded-full",st.value])},[I("img",{src:Wi(ue),"data-mail":ue.mail||"","data-qq":gr((ue==null?void 0:ue.mail)||""),"data-try":"0",class:"w-5 h-5 rounded-full object-cover",alt:"avatar",onError:tn=>Si(tn,ue.nick||"")},null,40,$m),I("span",{class:ke(["text-xs",yr.value])},Fe(fi(ue.content)),3)],2))),128))])])]),_:1},8,["class"])])):Oe("",!0)]),_:1})],2),Oe("",!0),se.value.musicEnabled?(Z(),oe("div",{key:1,class:"netease-mini-player","data-playlist-id":se.value.musicPlaylistId||"","data-song-id":se.value.musicSongId||"","data-position":se.value.musicPosition||"bottom-left","data-theme":se.value.musicTheme||"auto","data-lyric":se.value.musicLyric?"true":"false","data-default-minimized":se.value.musicDefaultMinimized?"true":"false","data-embed":se.value.musicEmbed?"true":"false","data-autoplay":se.value.musicAutoplay?"true":"false"},null,8,Bm)):Oe("",!0)]),_:1}),ie(Mc),ie(Xs,{modelValue:E.value,"onUpdate:modelValue":P[7]||(P[7]=ue=>E.value=ue),onSearchResult:Ce},null,8,["modelValue"]),ie(pp,{"content-theme":nt.value,"layout-icon":k.value,onSearch:P[8]||(P[8]=ue=>E.value=!0),onSwitchBackground:ni,onToggleTheme:yn,onToggleLayout:g,onOpenAdmin:re},null,8,["content-theme","layout-icon"]),ie(An,{modelValue:w.value,"onUpdate:modelValue":P[19]||(P[19]=ue=>w.value=ue),ui:{width:"sm:max-w-md",container:"items-center",base:"backdrop-blur-sm"}},{default:Me(()=>[ie(Ee,{class:"search-card"},{header:Me(()=>[I("div",Um,[I("h3",zm,Fe(C.value==="login"?"欢迎回来":"创建账户"),1),I("div",Fm,[C.value==="login"?(Z(),Lt(ae,{key:0,variant:"link",color:"orange",onClick:Ie},{default:Me(()=>P[41]||(P[41]=[mt("去注册")])),_:1})):(Z(),Lt(ae,{key:1,variant:"link",color:"orange",onClick:et},{default:Me(()=>P[42]||(P[42]=[mt("去登录")])),_:1})),ie(ae,{icon:"i-mdi-close",variant:"ghost",color:"gray",onClick:rt})])])]),default:Me(()=>[I("div",Vm,[C.value==="login"?(Z(),oe("div",qm,[ie(Kn,{onSubmit:lr(B,["prevent"])},{default:Me(()=>[I("div",Wm,[ie(Mt,{modelValue:we(_).username,"onUpdate:modelValue":P[9]||(P[9]=ue=>we(_).username=ue),placeholder:"用户名或邮箱"},null,8,["modelValue"]),ie(Mt,{modelValue:we(_).password,"onUpdate:modelValue":P[12]||(P[12]=ue=>we(_).password=ue),type:M.value?"text":"password",placeholder:"密码",autocomplete:"current-password",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},{trailing:Me(()=>[M.value?(Z(),Lt(ae,{key:1,icon:"i-heroicons-eye-slash",variant:"ghost",color:"gray",onClick:P[11]||(P[11]=ue=>M.value=!1),ui:{rounded:"rounded-full"}})):(Z(),Lt(ae,{key:0,icon:"i-heroicons-eye",variant:"ghost",color:"gray",onClick:P[10]||(P[10]=ue=>M.value=!0),ui:{rounded:"rounded-full"}}))]),_:1},8,["modelValue","type"]),ie(ae,{class:"w-full",loading:D.value,disabled:D.value,type:"submit",color:"primary"},{default:Me(()=>P[43]||(P[43]=[mt("登录")])),_:1},8,["loading","disabled"])])]),_:1}),I("div",Ym,[ie(ae,{variant:"link",onClick:Ie},{default:Me(()=>P[44]||(P[44]=[mt("账号注册")])),_:1}),ie(ae,{variant:"link",onClick:P[13]||(P[13]=ue=>j.value=!0)},{default:Me(()=>P[45]||(P[45]=[mt("忘记密码？")])),_:1})]),Le.value?(Z(),oe("div",Km,"其他登录方式")):Oe("",!0),Le.value?(Z(),oe("div",Gm,[ie(ae,{class:"w-full h-10 px-3 gap-2 justify-center font-medium bg-[#24292f] hover:bg-[#1f2328] text-white ring-1 ring-black/20",onClick:Re},{default:Me(()=>[ie(V,{name:"i-mdi-github",class:"w-5 h-5"}),P[46]||(P[46]=I("span",null,"GitHub 一键登录",-1))]),_:1})])):Oe("",!0)])):(Z(),oe("div",Xm,[ie(Kn,{onSubmit:lr(le,["prevent"])},{default:Me(()=>[I("div",Zm,[ie(Mt,{modelValue:we(T).username,"onUpdate:modelValue":P[14]||(P[14]=ue=>we(T).username=ue),placeholder:"用户名"},null,8,["modelValue"]),ie(Mt,{modelValue:we(T).password,"onUpdate:modelValue":P[17]||(P[17]=ue=>we(T).password=ue),type:v.value?"text":"password",placeholder:"密码",autocomplete:"new-password",autocorrect:"off",autocapitalize:"off",spellcheck:"false"},{trailing:Me(()=>[v.value?(Z(),Lt(ae,{key:1,icon:"i-heroicons-eye-slash",variant:"ghost",color:"gray",onClick:P[16]||(P[16]=ue=>v.value=!1),ui:{rounded:"rounded-full"}})):(Z(),Lt(ae,{key:0,icon:"i-heroicons-eye",variant:"ghost",color:"gray",onClick:P[15]||(P[15]=ue=>v.value=!0),ui:{rounded:"rounded-full"}}))]),_:1},8,["modelValue","type"]),I("div",Jm,[ie(Mt,{modelValue:we(T).captcha,"onUpdate:modelValue":P[18]||(P[18]=ue=>we(T).captcha=ue),placeholder:"验证码"},null,8,["modelValue"]),I("img",{src:z.value,onClick:Pe,class:"h-10 w-24 rounded border cursor-pointer",alt:"captcha"},null,8,Qm),ie(un,{color:H.value>0?"primary":"red",variant:"soft"},{default:Me(()=>[mt(Fe(H.value>0?`有效 ${H.value}s`:"已过期"),1)]),_:1},8,["color"])]),ie(ae,{class:"w-full",loading:N.value,disabled:H.value<=0||N.value,type:"submit",color:"primary"},{default:Me(()=>[mt(Fe(H.value>0?"注册":"验证码已过期"),1)]),_:1},8,["loading","disabled"])])]),_:1})]))])]),_:1})]),_:1},8,["modelValue"]),ie(An,{modelValue:j.value,"onUpdate:modelValue":P[22]||(P[22]=ue=>j.value=ue),ui:{container:"items-center",base:"backdrop-blur-sm"}},{default:Me(()=>[ie(Ee,{class:"search-card"},{default:Me(()=>[P[48]||(P[48]=I("div",{class:"font-semibold mb-2"},"找回密码",-1)),ie(Kn,{onSubmit:lr(Ge,["prevent"])},{default:Me(()=>[I("div",eg,[ie(Mt,{modelValue:we(X).account,"onUpdate:modelValue":P[20]||(P[20]=ue=>we(X).account=ue),placeholder:"用户名或邮箱"},null,8,["modelValue"]),I("div",tg,[ie(ae,{variant:"ghost",onClick:P[21]||(P[21]=ue=>j.value=!1)},{default:Me(()=>P[47]||(P[47]=[mt("取消")])),_:1}),ie(ae,{disabled:he.value>0||!Ue.value,type:"submit",color:"primary"},{default:Me(()=>[mt(Fe(Ue.value?he.value>0?`请稍候(${he.value}s)`:"发送重置邮件":"邮件未开启"),1)]),_:1},8,["disabled"])])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),I("div",{class:"scroll-buttons",onMouseenter:P[23]||(P[23]=ue=>Vt.value=!0),onMouseleave:P[24]||(P[24]=ue=>Vt.value=!1)},[Ri(ie(ae,{class:ke(Ut.value),variant:"ghost",size:"sm",onClick:Bt},{default:Me(()=>[ie(V,{class:ke(Qt.value),name:hn.value},null,8,["class","name"])]),_:1},8,["class"]),[[ms,Wn.value]])],32)],512)],4)}}});export{ug as default};
